(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))l(h);new MutationObserver(h=>{for(const v of h)if(v.type==="childList")for(const w of v.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&l(w)}).observe(document,{childList:!0,subtree:!0});function o(h){const v={};return h.integrity&&(v.integrity=h.integrity),h.referrerPolicy&&(v.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?v.credentials="include":h.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function l(h){if(h.ep)return;h.ep=!0;const v=o(h);fetch(h.href,v)}})();var C2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ca(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var zE={exports:{}},O1={};var VB;function PH(){if(VB)return O1;VB=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function o(l,h,v){var w=null;if(v!==void 0&&(w=""+v),h.key!==void 0&&(w=""+h.key),"key"in h){v={};for(var a in h)a!=="key"&&(v[a]=h[a])}else v=h;return h=v.ref,{$$typeof:r,type:l,key:w,ref:h!==void 0?h:null,props:v}}return O1.Fragment=t,O1.jsx=o,O1.jsxs=o,O1}var GB;function DH(){return GB||(GB=1,zE.exports=PH()),zE.exports}var ee=DH(),LE={exports:{}},Wn={};var $B;function RH(){if($B)return Wn;$B=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),w=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),G=Symbol.iterator;function q(Ze){return Ze===null||typeof Ze!="object"?null:(Ze=G&&Ze[G]||Ze["@@iterator"],typeof Ze=="function"?Ze:null)}var Q={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},H=Object.assign,K={};function he(Ze,gt,Bt){this.props=Ze,this.context=gt,this.refs=K,this.updater=Bt||Q}he.prototype.isReactComponent={},he.prototype.setState=function(Ze,gt){if(typeof Ze!="object"&&typeof Ze!="function"&&Ze!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ze,gt,"setState")},he.prototype.forceUpdate=function(Ze){this.updater.enqueueForceUpdate(this,Ze,"forceUpdate")};function ue(){}ue.prototype=he.prototype;function me(Ze,gt,Bt){this.props=Ze,this.context=gt,this.refs=K,this.updater=Bt||Q}var ge=me.prototype=new ue;ge.constructor=me,H(ge,he.prototype),ge.isPureReactComponent=!0;var se=Array.isArray;function fe(){}var ve={H:null,A:null,T:null,S:null},Le=Object.prototype.hasOwnProperty;function Ue(Ze,gt,Bt){var ar=Bt.ref;return{$$typeof:r,type:Ze,key:gt,ref:ar!==void 0?ar:null,props:Bt}}function tt(Ze,gt){return Ue(Ze.type,gt,Ze.props)}function Ke(Ze){return typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===r}function nt(Ze){var gt={"=":"=0",":":"=2"};return"$"+Ze.replace(/[=:]/g,function(Bt){return gt[Bt]})}var st=/\/+/g;function Rt(Ze,gt){return typeof Ze=="object"&&Ze!==null&&Ze.key!=null?nt(""+Ze.key):gt.toString(36)}function Mt(Ze){switch(Ze.status){case"fulfilled":return Ze.value;case"rejected":throw Ze.reason;default:switch(typeof Ze.status=="string"?Ze.then(fe,fe):(Ze.status="pending",Ze.then(function(gt){Ze.status==="pending"&&(Ze.status="fulfilled",Ze.value=gt)},function(gt){Ze.status==="pending"&&(Ze.status="rejected",Ze.reason=gt)})),Ze.status){case"fulfilled":return Ze.value;case"rejected":throw Ze.reason}}throw Ze}function $e(Ze,gt,Bt,ar,Er){var jr=typeof Ze;(jr==="undefined"||jr==="boolean")&&(Ze=null);var Zr=!1;if(Ze===null)Zr=!0;else switch(jr){case"bigint":case"string":case"number":Zr=!0;break;case"object":switch(Ze.$$typeof){case r:case t:Zr=!0;break;case L:return Zr=Ze._init,$e(Zr(Ze._payload),gt,Bt,ar,Er)}}if(Zr)return Er=Er(Ze),Zr=ar===""?"."+Rt(Ze,0):ar,se(Er)?(Bt="",Zr!=null&&(Bt=Zr.replace(st,"$&/")+"/"),$e(Er,gt,Bt,"",function(Mr){return Mr})):Er!=null&&(Ke(Er)&&(Er=tt(Er,Bt+(Er.key==null||Ze&&Ze.key===Er.key?"":(""+Er.key).replace(st,"$&/")+"/")+Zr)),gt.push(Er)),1;Zr=0;var fn=ar===""?".":ar+":";if(se(Ze))for(var Xt=0;Xt<Ze.length;Xt++)ar=Ze[Xt],jr=fn+Rt(ar,Xt),Zr+=$e(ar,gt,Bt,jr,Er);else if(Xt=q(Ze),typeof Xt=="function")for(Ze=Xt.call(Ze),Xt=0;!(ar=Ze.next()).done;)ar=ar.value,jr=fn+Rt(ar,Xt++),Zr+=$e(ar,gt,Bt,jr,Er);else if(jr==="object"){if(typeof Ze.then=="function")return $e(Mt(Ze),gt,Bt,ar,Er);throw gt=String(Ze),Error("Objects are not valid as a React child (found: "+(gt==="[object Object]"?"object with keys {"+Object.keys(Ze).join(", ")+"}":gt)+"). If you meant to render a collection of children, use an array instead.")}return Zr}function rt(Ze,gt,Bt){if(Ze==null)return Ze;var ar=[],Er=0;return $e(Ze,ar,"","",function(jr){return gt.call(Bt,jr,Er++)}),ar}function Ct(Ze){if(Ze._status===-1){var gt=Ze._result;gt=gt(),gt.then(function(Bt){(Ze._status===0||Ze._status===-1)&&(Ze._status=1,Ze._result=Bt)},function(Bt){(Ze._status===0||Ze._status===-1)&&(Ze._status=2,Ze._result=Bt)}),Ze._status===-1&&(Ze._status=0,Ze._result=gt)}if(Ze._status===1)return Ze._result.default;throw Ze._result}var Kt=typeof reportError=="function"?reportError:function(Ze){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var gt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ze=="object"&&Ze!==null&&typeof Ze.message=="string"?String(Ze.message):String(Ze),error:Ze});if(!window.dispatchEvent(gt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ze);return}console.error(Ze)},Je={map:rt,forEach:function(Ze,gt,Bt){rt(Ze,function(){gt.apply(this,arguments)},Bt)},count:function(Ze){var gt=0;return rt(Ze,function(){gt++}),gt},toArray:function(Ze){return rt(Ze,function(gt){return gt})||[]},only:function(Ze){if(!Ke(Ze))throw Error("React.Children.only expected to receive a single React element child.");return Ze}};return Wn.Activity=k,Wn.Children=Je,Wn.Component=he,Wn.Fragment=o,Wn.Profiler=h,Wn.PureComponent=me,Wn.StrictMode=l,Wn.Suspense=C,Wn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ve,Wn.__COMPILER_RUNTIME={__proto__:null,c:function(Ze){return ve.H.useMemoCache(Ze)}},Wn.cache=function(Ze){return function(){return Ze.apply(null,arguments)}},Wn.cacheSignal=function(){return null},Wn.cloneElement=function(Ze,gt,Bt){if(Ze==null)throw Error("The argument must be a React element, but you passed "+Ze+".");var ar=H({},Ze.props),Er=Ze.key;if(gt!=null)for(jr in gt.key!==void 0&&(Er=""+gt.key),gt)!Le.call(gt,jr)||jr==="key"||jr==="__self"||jr==="__source"||jr==="ref"&&gt.ref===void 0||(ar[jr]=gt[jr]);var jr=arguments.length-2;if(jr===1)ar.children=Bt;else if(1<jr){for(var Zr=Array(jr),fn=0;fn<jr;fn++)Zr[fn]=arguments[fn+2];ar.children=Zr}return Ue(Ze.type,Er,ar)},Wn.createContext=function(Ze){return Ze={$$typeof:w,_currentValue:Ze,_currentValue2:Ze,_threadCount:0,Provider:null,Consumer:null},Ze.Provider=Ze,Ze.Consumer={$$typeof:v,_context:Ze},Ze},Wn.createElement=function(Ze,gt,Bt){var ar,Er={},jr=null;if(gt!=null)for(ar in gt.key!==void 0&&(jr=""+gt.key),gt)Le.call(gt,ar)&&ar!=="key"&&ar!=="__self"&&ar!=="__source"&&(Er[ar]=gt[ar]);var Zr=arguments.length-2;if(Zr===1)Er.children=Bt;else if(1<Zr){for(var fn=Array(Zr),Xt=0;Xt<Zr;Xt++)fn[Xt]=arguments[Xt+2];Er.children=fn}if(Ze&&Ze.defaultProps)for(ar in Zr=Ze.defaultProps,Zr)Er[ar]===void 0&&(Er[ar]=Zr[ar]);return Ue(Ze,jr,Er)},Wn.createRef=function(){return{current:null}},Wn.forwardRef=function(Ze){return{$$typeof:a,render:Ze}},Wn.isValidElement=Ke,Wn.lazy=function(Ze){return{$$typeof:L,_payload:{_status:-1,_result:Ze},_init:Ct}},Wn.memo=function(Ze,gt){return{$$typeof:I,type:Ze,compare:gt===void 0?null:gt}},Wn.startTransition=function(Ze){var gt=ve.T,Bt={};ve.T=Bt;try{var ar=Ze(),Er=ve.S;Er!==null&&Er(Bt,ar),typeof ar=="object"&&ar!==null&&typeof ar.then=="function"&&ar.then(fe,Kt)}catch(jr){Kt(jr)}finally{gt!==null&&Bt.types!==null&&(gt.types=Bt.types),ve.T=gt}},Wn.unstable_useCacheRefresh=function(){return ve.H.useCacheRefresh()},Wn.use=function(Ze){return ve.H.use(Ze)},Wn.useActionState=function(Ze,gt,Bt){return ve.H.useActionState(Ze,gt,Bt)},Wn.useCallback=function(Ze,gt){return ve.H.useCallback(Ze,gt)},Wn.useContext=function(Ze){return ve.H.useContext(Ze)},Wn.useDebugValue=function(){},Wn.useDeferredValue=function(Ze,gt){return ve.H.useDeferredValue(Ze,gt)},Wn.useEffect=function(Ze,gt){return ve.H.useEffect(Ze,gt)},Wn.useEffectEvent=function(Ze){return ve.H.useEffectEvent(Ze)},Wn.useId=function(){return ve.H.useId()},Wn.useImperativeHandle=function(Ze,gt,Bt){return ve.H.useImperativeHandle(Ze,gt,Bt)},Wn.useInsertionEffect=function(Ze,gt){return ve.H.useInsertionEffect(Ze,gt)},Wn.useLayoutEffect=function(Ze,gt){return ve.H.useLayoutEffect(Ze,gt)},Wn.useMemo=function(Ze,gt){return ve.H.useMemo(Ze,gt)},Wn.useOptimistic=function(Ze,gt){return ve.H.useOptimistic(Ze,gt)},Wn.useReducer=function(Ze,gt,Bt){return ve.H.useReducer(Ze,gt,Bt)},Wn.useRef=function(Ze){return ve.H.useRef(Ze)},Wn.useState=function(Ze){return ve.H.useState(Ze)},Wn.useSyncExternalStore=function(Ze,gt,Bt){return ve.H.useSyncExternalStore(Ze,gt,Bt)},Wn.useTransition=function(){return ve.H.useTransition()},Wn.version="19.2.3",Wn}var qB;function JP(){return qB||(qB=1,LE.exports=RH()),LE.exports}var Jt=JP();const ft=ca(Jt);var BE={exports:{}},C1={},kE={exports:{}},FE={};var HB;function zH(){return HB||(HB=1,(function(r){function t($e,rt){var Ct=$e.length;$e.push(rt);e:for(;0<Ct;){var Kt=Ct-1>>>1,Je=$e[Kt];if(0<h(Je,rt))$e[Kt]=rt,$e[Ct]=Je,Ct=Kt;else break e}}function o($e){return $e.length===0?null:$e[0]}function l($e){if($e.length===0)return null;var rt=$e[0],Ct=$e.pop();if(Ct!==rt){$e[0]=Ct;e:for(var Kt=0,Je=$e.length,Ze=Je>>>1;Kt<Ze;){var gt=2*(Kt+1)-1,Bt=$e[gt],ar=gt+1,Er=$e[ar];if(0>h(Bt,Ct))ar<Je&&0>h(Er,Bt)?($e[Kt]=Er,$e[ar]=Ct,Kt=ar):($e[Kt]=Bt,$e[gt]=Ct,Kt=gt);else if(ar<Je&&0>h(Er,Ct))$e[Kt]=Er,$e[ar]=Ct,Kt=ar;else break e}}return rt}function h($e,rt){var Ct=$e.sortIndex-rt.sortIndex;return Ct!==0?Ct:$e.id-rt.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var v=performance;r.unstable_now=function(){return v.now()}}else{var w=Date,a=w.now();r.unstable_now=function(){return w.now()-a}}var C=[],I=[],L=1,k=null,G=3,q=!1,Q=!1,H=!1,K=!1,he=typeof setTimeout=="function"?setTimeout:null,ue=typeof clearTimeout=="function"?clearTimeout:null,me=typeof setImmediate<"u"?setImmediate:null;function ge($e){for(var rt=o(I);rt!==null;){if(rt.callback===null)l(I);else if(rt.startTime<=$e)l(I),rt.sortIndex=rt.expirationTime,t(C,rt);else break;rt=o(I)}}function se($e){if(H=!1,ge($e),!Q)if(o(C)!==null)Q=!0,fe||(fe=!0,nt());else{var rt=o(I);rt!==null&&Mt(se,rt.startTime-$e)}}var fe=!1,ve=-1,Le=5,Ue=-1;function tt(){return K?!0:!(r.unstable_now()-Ue<Le)}function Ke(){if(K=!1,fe){var $e=r.unstable_now();Ue=$e;var rt=!0;try{e:{Q=!1,H&&(H=!1,ue(ve),ve=-1),q=!0;var Ct=G;try{t:{for(ge($e),k=o(C);k!==null&&!(k.expirationTime>$e&&tt());){var Kt=k.callback;if(typeof Kt=="function"){k.callback=null,G=k.priorityLevel;var Je=Kt(k.expirationTime<=$e);if($e=r.unstable_now(),typeof Je=="function"){k.callback=Je,ge($e),rt=!0;break t}k===o(C)&&l(C),ge($e)}else l(C);k=o(C)}if(k!==null)rt=!0;else{var Ze=o(I);Ze!==null&&Mt(se,Ze.startTime-$e),rt=!1}}break e}finally{k=null,G=Ct,q=!1}rt=void 0}}finally{rt?nt():fe=!1}}}var nt;if(typeof me=="function")nt=function(){me(Ke)};else if(typeof MessageChannel<"u"){var st=new MessageChannel,Rt=st.port2;st.port1.onmessage=Ke,nt=function(){Rt.postMessage(null)}}else nt=function(){he(Ke,0)};function Mt($e,rt){ve=he(function(){$e(r.unstable_now())},rt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function($e){$e.callback=null},r.unstable_forceFrameRate=function($e){0>$e||125<$e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Le=0<$e?Math.floor(1e3/$e):5},r.unstable_getCurrentPriorityLevel=function(){return G},r.unstable_next=function($e){switch(G){case 1:case 2:case 3:var rt=3;break;default:rt=G}var Ct=G;G=rt;try{return $e()}finally{G=Ct}},r.unstable_requestPaint=function(){K=!0},r.unstable_runWithPriority=function($e,rt){switch($e){case 1:case 2:case 3:case 4:case 5:break;default:$e=3}var Ct=G;G=$e;try{return rt()}finally{G=Ct}},r.unstable_scheduleCallback=function($e,rt,Ct){var Kt=r.unstable_now();switch(typeof Ct=="object"&&Ct!==null?(Ct=Ct.delay,Ct=typeof Ct=="number"&&0<Ct?Kt+Ct:Kt):Ct=Kt,$e){case 1:var Je=-1;break;case 2:Je=250;break;case 5:Je=1073741823;break;case 4:Je=1e4;break;default:Je=5e3}return Je=Ct+Je,$e={id:L++,callback:rt,priorityLevel:$e,startTime:Ct,expirationTime:Je,sortIndex:-1},Ct>Kt?($e.sortIndex=Ct,t(I,$e),o(C)===null&&$e===o(I)&&(H?(ue(ve),ve=-1):H=!0,Mt(se,Ct-Kt))):($e.sortIndex=Je,t(C,$e),Q||q||(Q=!0,fe||(fe=!0,nt()))),$e},r.unstable_shouldYield=tt,r.unstable_wrapCallback=function($e){var rt=G;return function(){var Ct=G;G=rt;try{return $e.apply(this,arguments)}finally{G=Ct}}}})(FE)),FE}var XB;function LH(){return XB||(XB=1,kE.exports=zH()),kE.exports}var NE={exports:{}},El={};var ZB;function BH(){if(ZB)return El;ZB=1;var r=JP();function t(C){var I="https://react.dev/errors/"+C;if(1<arguments.length){I+="?args[]="+encodeURIComponent(arguments[1]);for(var L=2;L<arguments.length;L++)I+="&args[]="+encodeURIComponent(arguments[L])}return"Minified React error #"+C+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var l={d:{f:o,r:function(){throw Error(t(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},h=Symbol.for("react.portal");function v(C,I,L){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:k==null?null:""+k,children:C,containerInfo:I,implementation:L}}var w=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(C,I){if(C==="font")return"";if(typeof I=="string")return I==="use-credentials"?I:""}return El.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,El.createPortal=function(C,I){var L=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I||I.nodeType!==1&&I.nodeType!==9&&I.nodeType!==11)throw Error(t(299));return v(C,I,null,L)},El.flushSync=function(C){var I=w.T,L=l.p;try{if(w.T=null,l.p=2,C)return C()}finally{w.T=I,l.p=L,l.d.f()}},El.preconnect=function(C,I){typeof C=="string"&&(I?(I=I.crossOrigin,I=typeof I=="string"?I==="use-credentials"?I:"":void 0):I=null,l.d.C(C,I))},El.prefetchDNS=function(C){typeof C=="string"&&l.d.D(C)},El.preinit=function(C,I){if(typeof C=="string"&&I&&typeof I.as=="string"){var L=I.as,k=a(L,I.crossOrigin),G=typeof I.integrity=="string"?I.integrity:void 0,q=typeof I.fetchPriority=="string"?I.fetchPriority:void 0;L==="style"?l.d.S(C,typeof I.precedence=="string"?I.precedence:void 0,{crossOrigin:k,integrity:G,fetchPriority:q}):L==="script"&&l.d.X(C,{crossOrigin:k,integrity:G,fetchPriority:q,nonce:typeof I.nonce=="string"?I.nonce:void 0})}},El.preinitModule=function(C,I){if(typeof C=="string")if(typeof I=="object"&&I!==null){if(I.as==null||I.as==="script"){var L=a(I.as,I.crossOrigin);l.d.M(C,{crossOrigin:L,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0})}}else I==null&&l.d.M(C)},El.preload=function(C,I){if(typeof C=="string"&&typeof I=="object"&&I!==null&&typeof I.as=="string"){var L=I.as,k=a(L,I.crossOrigin);l.d.L(C,L,{crossOrigin:k,integrity:typeof I.integrity=="string"?I.integrity:void 0,nonce:typeof I.nonce=="string"?I.nonce:void 0,type:typeof I.type=="string"?I.type:void 0,fetchPriority:typeof I.fetchPriority=="string"?I.fetchPriority:void 0,referrerPolicy:typeof I.referrerPolicy=="string"?I.referrerPolicy:void 0,imageSrcSet:typeof I.imageSrcSet=="string"?I.imageSrcSet:void 0,imageSizes:typeof I.imageSizes=="string"?I.imageSizes:void 0,media:typeof I.media=="string"?I.media:void 0})}},El.preloadModule=function(C,I){if(typeof C=="string")if(I){var L=a(I.as,I.crossOrigin);l.d.m(C,{as:typeof I.as=="string"&&I.as!=="script"?I.as:void 0,crossOrigin:L,integrity:typeof I.integrity=="string"?I.integrity:void 0})}else l.d.m(C)},El.requestFormReset=function(C){l.d.r(C)},El.unstable_batchedUpdates=function(C,I){return C(I)},El.useFormState=function(C,I,L){return w.H.useFormState(C,I,L)},El.useFormStatus=function(){return w.H.useHostTransitionStatus()},El.version="19.2.3",El}var WB;function kH(){if(WB)return NE.exports;WB=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),NE.exports=BH(),NE.exports}var YB;function FH(){if(YB)return C1;YB=1;var r=LH(),t=JP(),o=kH();function l(d){var _="https://react.dev/errors/"+d;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var T=2;T<arguments.length;T++)_+="&args[]="+encodeURIComponent(arguments[T])}return"Minified React error #"+d+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function h(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function v(d){var _=d,T=d;if(d.alternate)for(;_.return;)_=_.return;else{d=_;do _=d,(_.flags&4098)!==0&&(T=_.return),d=_.return;while(d)}return _.tag===3?T:null}function w(d){if(d.tag===13){var _=d.memoizedState;if(_===null&&(d=d.alternate,d!==null&&(_=d.memoizedState)),_!==null)return _.dehydrated}return null}function a(d){if(d.tag===31){var _=d.memoizedState;if(_===null&&(d=d.alternate,d!==null&&(_=d.memoizedState)),_!==null)return _.dehydrated}return null}function C(d){if(v(d)!==d)throw Error(l(188))}function I(d){var _=d.alternate;if(!_){if(_=v(d),_===null)throw Error(l(188));return _!==d?null:d}for(var T=d,P=_;;){var U=T.return;if(U===null)break;var X=U.alternate;if(X===null){if(P=U.return,P!==null){T=P;continue}break}if(U.child===X.child){for(X=U.child;X;){if(X===T)return C(U),d;if(X===P)return C(U),_;X=X.sibling}throw Error(l(188))}if(T.return!==P.return)T=U,P=X;else{for(var _e=!1,Be=U.child;Be;){if(Be===T){_e=!0,T=U,P=X;break}if(Be===P){_e=!0,P=U,T=X;break}Be=Be.sibling}if(!_e){for(Be=X.child;Be;){if(Be===T){_e=!0,T=X,P=U;break}if(Be===P){_e=!0,P=X,T=U;break}Be=Be.sibling}if(!_e)throw Error(l(189))}}if(T.alternate!==P)throw Error(l(190))}if(T.tag!==3)throw Error(l(188));return T.stateNode.current===T?d:_}function L(d){var _=d.tag;if(_===5||_===26||_===27||_===6)return d;for(d=d.child;d!==null;){if(_=L(d),_!==null)return _;d=d.sibling}return null}var k=Object.assign,G=Symbol.for("react.element"),q=Symbol.for("react.transitional.element"),Q=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),K=Symbol.for("react.strict_mode"),he=Symbol.for("react.profiler"),ue=Symbol.for("react.consumer"),me=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),Le=Symbol.for("react.lazy"),Ue=Symbol.for("react.activity"),tt=Symbol.for("react.memo_cache_sentinel"),Ke=Symbol.iterator;function nt(d){return d===null||typeof d!="object"?null:(d=Ke&&d[Ke]||d["@@iterator"],typeof d=="function"?d:null)}var st=Symbol.for("react.client.reference");function Rt(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===st?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case H:return"Fragment";case he:return"Profiler";case K:return"StrictMode";case se:return"Suspense";case fe:return"SuspenseList";case Ue:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case Q:return"Portal";case me:return d.displayName||"Context";case ue:return(d._context.displayName||"Context")+".Consumer";case ge:var _=d.render;return d=d.displayName,d||(d=_.displayName||_.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case ve:return _=d.displayName||null,_!==null?_:Rt(d.type)||"Memo";case Le:_=d._payload,d=d._init;try{return Rt(d(_))}catch{}}return null}var Mt=Array.isArray,$e=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rt=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ct={pending:!1,data:null,method:null,action:null},Kt=[],Je=-1;function Ze(d){return{current:d}}function gt(d){0>Je||(d.current=Kt[Je],Kt[Je]=null,Je--)}function Bt(d,_){Je++,Kt[Je]=d.current,d.current=_}var ar=Ze(null),Er=Ze(null),jr=Ze(null),Zr=Ze(null);function fn(d,_){switch(Bt(jr,_),Bt(Er,d),Bt(ar,null),_.nodeType){case 9:case 11:d=(d=_.documentElement)&&(d=d.namespaceURI)?Rx(d):0;break;default:if(d=_.tagName,_=_.namespaceURI)_=Rx(_),d=Dv(_,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}gt(ar),Bt(ar,d)}function Xt(){gt(ar),gt(Er),gt(jr)}function Mr(d){d.memoizedState!==null&&Bt(Zr,d);var _=ar.current,T=Dv(_,d.type);_!==T&&(Bt(Er,d),Bt(ar,T))}function kr(d){Er.current===d&&(gt(ar),gt(Er)),Zr.current===d&&(gt(Zr),Nc._currentValue=Ct)}var or,Tr;function Ur(d){if(or===void 0)try{throw Error()}catch(T){var _=T.stack.trim().match(/\n( *(at )?)/);or=_&&_[1]||"",Tr=-1<T.stack.indexOf(`
    at`)?" (<anonymous>)":-1<T.stack.indexOf("@")?"@unknown:0:0":""}return`
`+or+d+Tr}var zn=!1;function Fn(d,_){if(!d||zn)return"";zn=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var P={DetermineComponentFrameRoot:function(){try{if(_){var pr=function(){throw Error()};if(Object.defineProperty(pr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(pr,[])}catch(er){var $t=er}Reflect.construct(d,[],pr)}else{try{pr.call()}catch(er){$t=er}d.call(pr.prototype)}}else{try{throw Error()}catch(er){$t=er}(pr=d())&&typeof pr.catch=="function"&&pr.catch(function(){})}}catch(er){if(er&&$t&&typeof er.stack=="string")return[er.stack,$t.stack]}return[null,null]}};P.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var U=Object.getOwnPropertyDescriptor(P.DetermineComponentFrameRoot,"name");U&&U.configurable&&Object.defineProperty(P.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var X=P.DetermineComponentFrameRoot(),_e=X[0],Be=X[1];if(_e&&Be){var ht=_e.split(`
`),Vt=Be.split(`
`);for(U=P=0;P<ht.length&&!ht[P].includes("DetermineComponentFrameRoot");)P++;for(;U<Vt.length&&!Vt[U].includes("DetermineComponentFrameRoot");)U++;if(P===ht.length||U===Vt.length)for(P=ht.length-1,U=Vt.length-1;1<=P&&0<=U&&ht[P]!==Vt[U];)U--;for(;1<=P&&0<=U;P--,U--)if(ht[P]!==Vt[U]){if(P!==1||U!==1)do if(P--,U--,0>U||ht[P]!==Vt[U]){var ir=`
`+ht[P].replace(" at new "," at ");return d.displayName&&ir.includes("<anonymous>")&&(ir=ir.replace("<anonymous>",d.displayName)),ir}while(1<=P&&0<=U);break}}}finally{zn=!1,Error.prepareStackTrace=T}return(T=d?d.displayName||d.name:"")?Ur(T):""}function Ut(d,_){switch(d.tag){case 26:case 27:case 5:return Ur(d.type);case 16:return Ur("Lazy");case 13:return d.child!==_&&_!==null?Ur("Suspense Fallback"):Ur("Suspense");case 19:return Ur("SuspenseList");case 0:case 15:return Fn(d.type,!1);case 11:return Fn(d.type.render,!1);case 1:return Fn(d.type,!0);case 31:return Ur("Activity");default:return""}}function _n(d){try{var _="",T=null;do _+=Ut(d,T),T=d,d=d.return;while(d);return _}catch(P){return`
Error generating stack: `+P.message+`
`+P.stack}}var ua=Object.prototype.hasOwnProperty,da=r.unstable_scheduleCallback,Yn=r.unstable_cancelCallback,ha=r.unstable_shouldYield,go=r.unstable_requestPaint,ni=r.unstable_now,ii=r.unstable_getCurrentPriorityLevel,no=r.unstable_ImmediatePriority,Ai=r.unstable_UserBlockingPriority,ga=r.unstable_NormalPriority,Ha=r.unstable_LowPriority,Zi=r.unstable_IdlePriority,cl=r.log,fi=r.unstable_setDisableYieldValue,Cs=null,Ci=null;function Ti(d){if(typeof cl=="function"&&fi(d),Ci&&typeof Ci.setStrictMode=="function")try{Ci.setStrictMode(Cs,d)}catch{}}var qi=Math.clz32?Math.clz32:Mn,_o=Math.log,$o=Math.LN2;function Mn(d){return d>>>=0,d===0?32:31-(_o(d)/$o|0)|0}var io=256,_a=262144,La=4194304;function pn(d){var _=d&42;if(_!==0)return _;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Bi(d,_,T){var P=d.pendingLanes;if(P===0)return 0;var U=0,X=d.suspendedLanes,_e=d.pingedLanes;d=d.warmLanes;var Be=P&134217727;return Be!==0?(P=Be&~X,P!==0?U=pn(P):(_e&=Be,_e!==0?U=pn(_e):T||(T=Be&~d,T!==0&&(U=pn(T))))):(Be=P&~X,Be!==0?U=pn(Be):_e!==0?U=pn(_e):T||(T=P&~d,T!==0&&(U=pn(T)))),U===0?0:_!==0&&_!==U&&(_&X)===0&&(X=U&-U,T=_&-_,X>=T||X===32&&(T&4194048)!==0)?_:U}function as(d,_){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&_)===0}function qo(d,_){switch(d){case 1:case 2:case 4:case 8:case 64:return _+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xa(){var d=La;return La<<=1,(La&62914560)===0&&(La=4194304),d}function Tn(d){for(var _=[],T=0;31>T;T++)_.push(d);return _}function Jr(d,_){d.pendingLanes|=_,_!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function yt(d,_,T,P,U,X){var _e=d.pendingLanes;d.pendingLanes=T,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=T,d.entangledLanes&=T,d.errorRecoveryDisabledLanes&=T,d.shellSuspendCounter=0;var Be=d.entanglements,ht=d.expirationTimes,Vt=d.hiddenUpdates;for(T=_e&~T;0<T;){var ir=31-qi(T),pr=1<<ir;Be[ir]=0,ht[ir]=-1;var $t=Vt[ir];if($t!==null)for(Vt[ir]=null,ir=0;ir<$t.length;ir++){var er=$t[ir];er!==null&&(er.lane&=-536870913)}T&=~pr}P!==0&&Or(d,P,0),X!==0&&U===0&&d.tag!==0&&(d.suspendedLanes|=X&~(_e&~_))}function Or(d,_,T){d.pendingLanes|=_,d.suspendedLanes&=~_;var P=31-qi(_);d.entangledLanes|=_,d.entanglements[P]=d.entanglements[P]|1073741824|T&261930}function Sn(d,_){var T=d.entangledLanes|=_;for(d=d.entanglements;T;){var P=31-qi(T),U=1<<P;U&_|d[P]&_&&(d[P]|=_),T&=~U}}function an(d,_){var T=_&-_;return T=(T&42)!==0?1:yr(T),(T&(d.suspendedLanes|_))!==0?0:T}function yr(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Xe(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function ie(){var d=rt.p;return d!==0?d:(d=window.event,d===void 0?32:Fw(d.type))}function de(d,_){var T=rt.p;try{return rt.p=d,_()}finally{rt.p=T}}var Ae=Math.random().toString(36).slice(2),ze="__reactFiber$"+Ae,Ee="__reactProps$"+Ae,Fe="__reactContainer$"+Ae,it="__reactEvents$"+Ae,qe="__reactListeners$"+Ae,at="__reactHandles$"+Ae,Dt="__reactResources$"+Ae,vt="__reactMarker$"+Ae;function Wt(d){delete d[ze],delete d[Ee],delete d[it],delete d[qe],delete d[at]}function dr(d){var _=d[ze];if(_)return _;for(var T=d.parentNode;T;){if(_=T[Fe]||T[ze]){if(T=_.alternate,_.child!==null||T!==null&&T.child!==null)for(d=kx(d);d!==null;){if(T=d[ze])return T;d=kx(d)}return _}d=T,T=d.parentNode}return null}function vr(d){if(d=d[ze]||d[Fe]){var _=d.tag;if(_===5||_===6||_===13||_===31||_===26||_===27||_===3)return d}return null}function Br(d){var _=d.tag;if(_===5||_===26||_===27||_===6)return d.stateNode;throw Error(l(33))}function Sr(d){var _=d[Dt];return _||(_=d[Dt]={hoistableStyles:new Map,hoistableScripts:new Map}),_}function fr(d){d[vt]=!0}var br=new Set,Vn={};function yi(d,_){Xn(d,_),Xn(d+"Capture",_)}function Xn(d,_){for(Vn[d]=_,d=0;d<_.length;d++)br.add(_[d])}var Zn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qn={},on={};function Gn(d){return ua.call(on,d)?!0:ua.call(qn,d)?!1:Zn.test(d)?on[d]=!0:(qn[d]=!0,!1)}function Nn(d,_,T){if(Gn(_))if(T===null)d.removeAttribute(_);else{switch(typeof T){case"undefined":case"function":case"symbol":d.removeAttribute(_);return;case"boolean":var P=_.toLowerCase().slice(0,5);if(P!=="data-"&&P!=="aria-"){d.removeAttribute(_);return}}d.setAttribute(_,""+T)}}function jn(d,_,T){if(T===null)d.removeAttribute(_);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(_);return}d.setAttribute(_,""+T)}}function ti(d,_,T,P){if(P===null)d.removeAttribute(T);else{switch(typeof P){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(T);return}d.setAttributeNS(_,T,""+P)}}function ki(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Ba(d){var _=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function ya(d,_,T){var P=Object.getOwnPropertyDescriptor(d.constructor.prototype,_);if(!d.hasOwnProperty(_)&&typeof P<"u"&&typeof P.get=="function"&&typeof P.set=="function"){var U=P.get,X=P.set;return Object.defineProperty(d,_,{configurable:!0,get:function(){return U.call(this)},set:function(_e){T=""+_e,X.call(this,_e)}}),Object.defineProperty(d,_,{enumerable:P.enumerable}),{getValue:function(){return T},setValue:function(_e){T=""+_e},stopTracking:function(){d._valueTracker=null,delete d[_]}}}}function gc(d){if(!d._valueTracker){var _=Ba(d)?"checked":"value";d._valueTracker=ya(d,_,""+d[_])}}function yo(d){if(!d)return!1;var _=d._valueTracker;if(!_)return!0;var T=_.getValue(),P="";return d&&(P=Ba(d)?d.checked?"true":"false":d.value),d=P,d!==T?(_.setValue(d),!0):!1}function Io(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var ul=/[\n"\\]/g;function Sa(d){return d.replace(ul,function(_){return"\\"+_.charCodeAt(0).toString(16)+" "})}function Ho(d,_,T,P,U,X,_e,Be){d.name="",_e!=null&&typeof _e!="function"&&typeof _e!="symbol"&&typeof _e!="boolean"?d.type=_e:d.removeAttribute("type"),_!=null?_e==="number"?(_===0&&d.value===""||d.value!=_)&&(d.value=""+ki(_)):d.value!==""+ki(_)&&(d.value=""+ki(_)):_e!=="submit"&&_e!=="reset"||d.removeAttribute("value"),_!=null?zl(d,_e,ki(_)):T!=null?zl(d,_e,ki(T)):P!=null&&d.removeAttribute("value"),U==null&&X!=null&&(d.defaultChecked=!!X),U!=null&&(d.checked=U&&typeof U!="function"&&typeof U!="symbol"),Be!=null&&typeof Be!="function"&&typeof Be!="symbol"&&typeof Be!="boolean"?d.name=""+ki(Be):d.removeAttribute("name")}function Po(d,_,T,P,U,X,_e,Be){if(X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(d.type=X),_!=null||T!=null){if(!(X!=="submit"&&X!=="reset"||_!=null)){gc(d);return}T=T!=null?""+ki(T):"",_=_!=null?""+ki(_):T,Be||_===d.value||(d.value=_),d.defaultValue=_}P=P??U,P=typeof P!="function"&&typeof P!="symbol"&&!!P,d.checked=Be?d.checked:!!P,d.defaultChecked=!!P,_e!=null&&typeof _e!="function"&&typeof _e!="symbol"&&typeof _e!="boolean"&&(d.name=_e),gc(d)}function zl(d,_,T){_==="number"&&Io(d.ownerDocument)===d||d.defaultValue===""+T||(d.defaultValue=""+T)}function hl(d,_,T,P){if(d=d.options,_){_={};for(var U=0;U<T.length;U++)_["$"+T[U]]=!0;for(T=0;T<d.length;T++)U=_.hasOwnProperty("$"+d[T].value),d[T].selected!==U&&(d[T].selected=U),U&&P&&(d[T].defaultSelected=!0)}else{for(T=""+ki(T),_=null,U=0;U<d.length;U++){if(d[U].value===T){d[U].selected=!0,P&&(d[U].defaultSelected=!0);return}_!==null||d[U].disabled||(_=d[U])}_!==null&&(_.selected=!0)}}function Is(d,_,T){if(_!=null&&(_=""+ki(_),_!==d.value&&(d.value=_),T==null)){d.defaultValue!==_&&(d.defaultValue=_);return}d.defaultValue=T!=null?""+ki(T):""}function zd(d,_,T,P){if(_==null){if(P!=null){if(T!=null)throw Error(l(92));if(Mt(P)){if(1<P.length)throw Error(l(93));P=P[0]}T=P}T==null&&(T=""),_=T}T=ki(_),d.defaultValue=T,P=d.textContent,P===T&&P!==""&&P!==null&&(d.value=P),gc(d)}function _c(d,_){if(_){var T=d.firstChild;if(T&&T===d.lastChild&&T.nodeType===3){T.nodeValue=_;return}}d.textContent=_}var ov=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function t_(d,_,T){var P=_.indexOf("--")===0;T==null||typeof T=="boolean"||T===""?P?d.setProperty(_,""):_==="float"?d.cssFloat="":d[_]="":P?d.setProperty(_,T):typeof T!="number"||T===0||ov.has(_)?_==="float"?d.cssFloat=T:d[_]=(""+T).trim():d[_]=T+"px"}function Am(d,_,T){if(_!=null&&typeof _!="object")throw Error(l(62));if(d=d.style,T!=null){for(var P in T)!T.hasOwnProperty(P)||_!=null&&_.hasOwnProperty(P)||(P.indexOf("--")===0?d.setProperty(P,""):P==="float"?d.cssFloat="":d[P]="");for(var U in _)P=_[U],_.hasOwnProperty(U)&&T[U]!==P&&t_(d,U,P)}else for(var X in _)_.hasOwnProperty(X)&&t_(d,X,_[X])}function Kf(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Za=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dl(d){return Zs.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function ka(){}var fl=null;function Gu(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Ll=null,pl=null;function Wc(d){var _=vr(d);if(_&&(d=_.stateNode)){var T=d[Ee]||null;e:switch(d=_.stateNode,_.type){case"input":if(Ho(d,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name),_=T.name,T.type==="radio"&&_!=null){for(T=d;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll('input[name="'+Sa(""+_)+'"][type="radio"]'),_=0;_<T.length;_++){var P=T[_];if(P!==d&&P.form===d.form){var U=P[Ee]||null;if(!U)throw Error(l(90));Ho(P,U.value,U.defaultValue,U.defaultValue,U.checked,U.defaultChecked,U.type,U.name)}}for(_=0;_<T.length;_++)P=T[_],P.form===d.form&&yo(P)}break e;case"textarea":Is(d,T.value,T.defaultValue);break e;case"select":_=T.value,_!=null&&hl(d,!!T.multiple,_,!1)}}}var Ld=!1;function r_(d,_,T){if(Ld)return d(_,T);Ld=!0;try{var P=d(_);return P}finally{if(Ld=!1,(Ll!==null||pl!==null)&&(Qn(),Ll&&(_=Ll,d=pl,pl=Ll=null,Wc(_),d)))for(_=0;_<d.length;_++)Wc(d[_])}}function Bd(d,_){var T=d.stateNode;if(T===null)return null;var P=T[Ee]||null;if(P===null)return null;T=P[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(d=d.type,P=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!P;break e;default:d=!1}if(d)return null;if(T&&typeof T!="function")throw Error(l(231,_,typeof T));return T}var va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bh=!1;if(va)try{var Yc={};Object.defineProperty(Yc,"passive",{get:function(){Bh=!0}}),window.addEventListener("test",Yc,Yc),window.removeEventListener("test",Yc,Yc)}catch{Bh=!1}var Xo=null,kh=null,Tm=null;function Sm(){if(Tm)return Tm;var d,_=kh,T=_.length,P,U="value"in Xo?Xo.value:Xo.textContent,X=U.length;for(d=0;d<T&&_[d]===U[d];d++);var _e=T-d;for(P=1;P<=_e&&_[T-P]===U[X-P];P++);return Tm=U.slice(d,1<P?1-P:void 0)}function un(d){var _=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&_===13&&(d=13)):d=_,d===10&&(d=13),32<=d||d===13?d:0}function Kc(){return!0}function Qf(){return!1}function os(d){function _(T,P,U,X,_e){this._reactName=T,this._targetInst=U,this.type=P,this.nativeEvent=X,this.target=_e,this.currentTarget=null;for(var Be in d)d.hasOwnProperty(Be)&&(T=d[Be],this[Be]=T?T(X):X[Be]);return this.isDefaultPrevented=(X.defaultPrevented!=null?X.defaultPrevented:X.returnValue===!1)?Kc:Qf,this.isPropagationStopped=Qf,this}return k(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Kc)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Kc)},persist:function(){},isPersistent:Kc}),_}var $u={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qu=os($u),ml=k({},$u,{view:0,detail:0}),Jf=os(ml),kd,n_,yc,gl=k({},ml,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vo,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==yc&&(yc&&d.type==="mousemove"?(kd=d.screenX-yc.screenX,n_=d.screenY-yc.screenY):n_=kd=0,yc=d),kd)},movementY:function(d){return"movementY"in d?d.movementY:n_}}),Fd=os(gl),sv=k({},gl,{dataTransfer:0}),Fh=os(sv),Qc=k({},ml,{relatedTarget:0}),Do=os(Qc),_l=k({},$u,{animationName:0,elapsedTime:0,pseudoElement:0}),Em=os(_l),lv=k({},$u,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Cn=os(lv),i_=k({},$u,{data:0}),a_=os(i_),cv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nh(d){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(d):(d=o_[d])?!!_[d]:!1}function vo(){return Nh}var Mm=k({},ml,{key:function(d){if(d.key){var _=cv[d.key]||d.key;if(_!=="Unidentified")return _}return d.type==="keypress"?(d=un(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Dr[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vo,charCode:function(d){return d.type==="keypress"?un(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?un(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),ss=os(Mm),_r=k({},gl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),En=os(_r),bn=k({},ml,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vo}),Zo=os(bn),Nd=k({},$u,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ln=os(Nd),Om=k({},gl,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),jd=os(Om),jh=k({},$u,{newState:0,oldState:0}),Ro=os(jh),Wi=[9,13,27,32],s_=va&&"CompositionEvent"in window,Jc=null;va&&"documentMode"in document&&(Jc=document.documentMode);var l_=va&&"TextEvent"in window&&!Jc,Ud=va&&(!s_||Jc&&8<Jc&&11>=Jc),ep=" ",Cm=!1;function tp(d,_){switch(d){case"keyup":return Wi.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xo(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var Wa=!1;function ls(d,_){switch(d){case"compositionend":return xo(_);case"keypress":return _.which!==32?null:(Cm=!0,ep);case"textInput":return d=_.data,d===ep&&Cm?null:d;default:return null}}function c_(d,_){if(Wa)return d==="compositionend"||!s_&&tp(d,_)?(d=Sm(),Tm=kh=Xo=null,Wa=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return Ud&&_.locale!=="ko"?null:_.data;default:return null}}var Hu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xa(d){var _=d&&d.nodeName&&d.nodeName.toLowerCase();return _==="input"?!!Hu[d.type]:_==="textarea"}function Bl(d,_,T,P){Ll?pl?pl.push(P):pl=[P]:Ll=P,_=H_(_,"onChange"),0<_.length&&(T=new qu("onChange","change",null,T,P),d.push({event:T,listeners:_}))}var Ws=null,Yi=null;function Xu(d){G_(d,0)}function zr(d){var _=Br(d);if(yo(_))return d}function mr(d,_){if(d==="change")return _}var Uh=!1;if(va){var Rr;if(va){var Vd="oninput"in document;if(!Vd){var Gd=document.createElement("div");Gd.setAttribute("oninput","return;"),Vd=typeof Gd.oninput=="function"}Rr=Vd}else Rr=!1;Uh=Rr&&(!document.documentMode||9<document.documentMode)}function Cr(){Ws&&(Ws.detachEvent("onpropertychange",Im),Yi=Ws=null)}function Im(d){if(d.propertyName==="value"&&zr(Yi)){var _=[];Bl(_,Yi,d,Gu(d)),r_(Xu,_)}}function u_(d,_,T){d==="focusin"?(Cr(),Ws=_,Yi=T,Ws.attachEvent("onpropertychange",Im)):d==="focusout"&&Cr()}function vc(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return zr(Yi)}function uv(d,_){if(d==="click")return zr(_)}function $d(d,_){if(d==="input"||d==="change")return zr(_)}function cs(d,_){return d===_&&(d!==0||1/d===1/_)||d!==d&&_!==_}var us=typeof Object.is=="function"?Object.is:cs;function Ps(d,_){if(us(d,_))return!0;if(typeof d!="object"||d===null||typeof _!="object"||_===null)return!1;var T=Object.keys(d),P=Object.keys(_);if(T.length!==P.length)return!1;for(P=0;P<T.length;P++){var U=T[P];if(!ua.call(_,U)||!us(d[U],_[U]))return!1}return!0}function rp(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Ys(d,_){var T=rp(d);d=0;for(var P;T;){if(T.nodeType===3){if(P=d+T.textContent.length,d<=_&&P>=_)return{node:T,offset:_-d};d=P}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=rp(T)}}function eu(d,_){return d&&_?d===_?!0:d&&d.nodeType===3?!1:_&&_.nodeType===3?eu(d,_.parentNode):"contains"in d?d.contains(_):d.compareDocumentPosition?!!(d.compareDocumentPosition(_)&16):!1:!1}function hv(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var _=Io(d.document);_ instanceof d.HTMLIFrameElement;){try{var T=typeof _.contentWindow.location.href=="string"}catch{T=!1}if(T)d=_.contentWindow;else break;_=Io(d.document)}return _}function Vh(d){var _=d&&d.nodeName&&d.nodeName.toLowerCase();return _&&(_==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||_==="textarea"||d.contentEditable==="true")}var np=va&&"documentMode"in document&&11>=document.documentMode,tu=null,Pm=null,Wo=null,Dm=!1;function ip(d,_,T){var P=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;Dm||tu==null||tu!==Io(P)||(P=tu,"selectionStart"in P&&Vh(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),Wo&&Ps(Wo,P)||(Wo=P,P=H_(Pm,"onSelect"),0<P.length&&(_=new qu("onSelect","select",null,_,T),d.push({event:_,listeners:P}),_.target=tu)))}function kl(d,_){var T={};return T[d.toLowerCase()]=_.toLowerCase(),T["Webkit"+d]="webkit"+_,T["Moz"+d]="moz"+_,T}var Ks={animationend:kl("Animation","AnimationEnd"),animationiteration:kl("Animation","AnimationIteration"),animationstart:kl("Animation","AnimationStart"),transitionrun:kl("Transition","TransitionRun"),transitionstart:kl("Transition","TransitionStart"),transitioncancel:kl("Transition","TransitionCancel"),transitionend:kl("Transition","TransitionEnd")},h_={},d_={};va&&(d_=document.createElement("div").style,"AnimationEvent"in window||(delete Ks.animationend.animation,delete Ks.animationiteration.animation,delete Ks.animationstart.animation),"TransitionEvent"in window||delete Ks.transitionend.transition);function Gh(d){if(h_[d])return h_[d];if(!Ks[d])return d;var _=Ks[d],T;for(T in _)if(_.hasOwnProperty(T)&&T in d_)return h_[d]=_[T];return d}var Rm=Gh("animationend"),dv=Gh("animationiteration"),xc=Gh("animationstart"),fv=Gh("transitionrun"),pv=Gh("transitionstart"),zm=Gh("transitioncancel"),Lm=Gh("transitionend"),ru=new Map,Yo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Yo.push("scrollEnd");function Qs(d,_){ru.set(d,_),yi(_,[d])}var qd=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},zo=[],Fl=0,ap=0;function $h(){for(var d=Fl,_=ap=Fl=0;_<d;){var T=zo[_];zo[_++]=null;var P=zo[_];zo[_++]=null;var U=zo[_];zo[_++]=null;var X=zo[_];if(zo[_++]=null,P!==null&&U!==null){var _e=P.pending;_e===null?U.next=U:(U.next=_e.next,_e.next=U),P.pending=U}X!==0&&Bm(T,U,X)}}function Ko(d,_,T,P){zo[Fl++]=d,zo[Fl++]=_,zo[Fl++]=T,zo[Fl++]=P,ap|=P,d.lanes|=P,d=d.alternate,d!==null&&(d.lanes|=P)}function qh(d,_,T,P){return Ko(d,_,T,P),Hd(d)}function Gt(d,_){return Ko(d,null,null,_),Hd(d)}function Bm(d,_,T){d.lanes|=T;var P=d.alternate;P!==null&&(P.lanes|=T);for(var U=!1,X=d.return;X!==null;)X.childLanes|=T,P=X.alternate,P!==null&&(P.childLanes|=T),X.tag===22&&(d=X.stateNode,d===null||d._visibility&1||(U=!0)),d=X,X=X.return;return d.tag===3?(X=d.stateNode,U&&_!==null&&(U=31-qi(T),d=X.hiddenUpdates,P=d[U],P===null?d[U]=[_]:P.push(_),_.lane=T|536870912),X):null}function Hd(d){if(50<mn)throw mn=0,hi=null,Error(l(185));for(var _=d.return;_!==null;)d=_,_=d.return;return d.tag===3?d.stateNode:null}var bc={};function wc(d,_,T,P){this.tag=d,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hs(d,_,T,P){return new wc(d,_,T,P)}function nu(d){return d=d.prototype,!(!d||!d.isReactComponent)}function ds(d,_){var T=d.alternate;return T===null?(T=hs(d.tag,_,d.key,d.mode),T.elementType=d.elementType,T.type=d.type,T.stateNode=d.stateNode,T.alternate=d,d.alternate=T):(T.pendingProps=_,T.type=d.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=d.flags&65011712,T.childLanes=d.childLanes,T.lanes=d.lanes,T.child=d.child,T.memoizedProps=d.memoizedProps,T.memoizedState=d.memoizedState,T.updateQueue=d.updateQueue,_=d.dependencies,T.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},T.sibling=d.sibling,T.index=d.index,T.ref=d.ref,T.refCleanup=d.refCleanup,T}function iu(d,_){d.flags&=65011714;var T=d.alternate;return T===null?(d.childLanes=0,d.lanes=_,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=T.childLanes,d.lanes=T.lanes,d.child=T.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=T.memoizedProps,d.memoizedState=T.memoizedState,d.updateQueue=T.updateQueue,d.type=T.type,_=T.dependencies,d.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),d}function Hh(d,_,T,P,U,X){var _e=0;if(P=d,typeof d=="function")nu(d)&&(_e=1);else if(typeof d=="string")_e=Dw(d,T,ar.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case Ue:return d=hs(31,T,_,U),d.elementType=Ue,d.lanes=X,d;case H:return Zu(T.children,U,X,_);case K:_e=8,U|=24;break;case he:return d=hs(12,T,_,U|2),d.elementType=he,d.lanes=X,d;case se:return d=hs(13,T,_,U),d.elementType=se,d.lanes=X,d;case fe:return d=hs(19,T,_,U),d.elementType=fe,d.lanes=X,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case me:_e=10;break e;case ue:_e=9;break e;case ge:_e=11;break e;case ve:_e=14;break e;case Le:_e=16,P=null;break e}_e=29,T=Error(l(130,d===null?"null":typeof d,"")),P=null}return _=hs(_e,T,_,U),_.elementType=d,_.type=P,_.lanes=X,_}function Zu(d,_,T,P){return d=hs(7,d,P,_),d.lanes=T,d}function Xd(d,_,T){return d=hs(6,d,null,_),d.lanes=T,d}function mv(d){var _=hs(18,null,null,0);return _.stateNode=d,_}function km(d,_,T){return _=hs(4,d.children!==null?d.children:[],d.key,_),_.lanes=T,_.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},_}var Fm=new WeakMap;function ao(d,_){if(typeof d=="object"&&d!==null){var T=Fm.get(d);return T!==void 0?T:(_={value:d,source:_,stack:_n(_)},Fm.set(d,_),_)}return{value:d,source:_,stack:_n(_)}}var sn=[],Zd=0,Nm=null,op=0,Ds=[],yl=0,$n=null,Ac=1,Nl="";function jl(d,_){sn[Zd++]=op,sn[Zd++]=Nm,Nm=d,op=_}function sp(d,_,T){Ds[yl++]=Ac,Ds[yl++]=Nl,Ds[yl++]=$n,$n=d;var P=Ac;d=Nl;var U=32-qi(P)-1;P&=~(1<<U),T+=1;var X=32-qi(_)+U;if(30<X){var _e=U-U%5;X=(P&(1<<_e)-1).toString(32),P>>=_e,U-=_e,Ac=1<<32-qi(_)+U|T<<U|P,Nl=X+d}else Ac=1<<X|T<<U|P,Nl=d}function lp(d){d.return!==null&&(jl(d,1),sp(d,1,0))}function au(d){for(;d===Nm;)Nm=sn[--Zd],sn[Zd]=null,op=sn[--Zd],sn[Zd]=null;for(;d===$n;)$n=Ds[--yl],Ds[yl]=null,Nl=Ds[--yl],Ds[yl]=null,Ac=Ds[--yl],Ds[yl]=null}function Xh(d,_){Ds[yl++]=Ac,Ds[yl++]=Nl,Ds[yl++]=$n,Ac=_.id,Nl=_.overflow,$n=d}var Fa=null,Fi=null,ci=!1,Tc=null,Js=!1,Wu=Error(l(519));function Ul(d){var _=Error(l(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Wd(ao(_,d)),Wu}function cp(d){var _=d.stateNode,T=d.type,P=d.memoizedProps;switch(_[ze]=d,_[Ee]=P,T){case"dialog":si("cancel",_),si("close",_);break;case"iframe":case"object":case"embed":si("load",_);break;case"video":case"audio":for(T=0;T<Mf.length;T++)si(Mf[T],_);break;case"source":si("error",_);break;case"img":case"image":case"link":si("error",_),si("load",_);break;case"details":si("toggle",_);break;case"input":si("invalid",_),Po(_,P.value,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name,!0);break;case"select":si("invalid",_);break;case"textarea":si("invalid",_),zd(_,P.value,P.defaultValue,P.children)}T=P.children,typeof T!="string"&&typeof T!="number"&&typeof T!="bigint"||_.textContent===""+T||P.suppressHydrationWarning===!0||Aw(_.textContent,T)?(P.popover!=null&&(si("beforetoggle",_),si("toggle",_)),P.onScroll!=null&&si("scroll",_),P.onScrollEnd!=null&&si("scrollend",_),P.onClick!=null&&(_.onclick=ka),_=!0):_=!1,_||Ul(d,!0)}function jm(d){for(Fa=d.return;Fa;)switch(Fa.tag){case 5:case 31:case 13:Js=!1;return;case 27:case 3:Js=!0;return;default:Fa=Fa.return}}function ou(d){if(d!==Fa)return!1;if(!ci)return jm(d),ci=!0,!1;var _=d.tag,T;if((T=_!==3&&_!==27)&&((T=_===5)&&(T=d.type,T=!(T!=="form"&&T!=="button")||mh(d.type,d.memoizedProps)),T=!T),T&&Fi&&Ul(d),jm(d),_===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));Fi=Cw(d)}else if(_===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(317));Fi=Cw(d)}else _===27?(_=Fi,tc(d.type)?(d=Z_,Z_=null,Fi=d):Fi=_):Fi=Fa?kc(d.stateNode.nextSibling):null;return!0}function Vl(){Fi=Fa=null,ci=!1}function Um(){var d=Tc;return d!==null&&(Zt===null?Zt=d:Zt.push.apply(Zt,d),Tc=null),d}function Wd(d){Tc===null?Tc=[d]:Tc.push(d)}var Vm=Ze(null),vl=null,Sc=null;function Yu(d,_,T){Bt(Vm,_._currentValue),_._currentValue=T}function su(d){d._currentValue=Vm.current,gt(Vm)}function f_(d,_,T){for(;d!==null;){var P=d.alternate;if((d.childLanes&_)!==_?(d.childLanes|=_,P!==null&&(P.childLanes|=_)):P!==null&&(P.childLanes&_)!==_&&(P.childLanes|=_),d===T)break;d=d.return}}function up(d,_,T,P){var U=d.child;for(U!==null&&(U.return=d);U!==null;){var X=U.dependencies;if(X!==null){var _e=U.child;X=X.firstContext;e:for(;X!==null;){var Be=X;X=U;for(var ht=0;ht<_.length;ht++)if(Be.context===_[ht]){X.lanes|=T,Be=X.alternate,Be!==null&&(Be.lanes|=T),f_(X.return,T,d),P||(_e=null);break e}X=Be.next}}else if(U.tag===18){if(_e=U.return,_e===null)throw Error(l(341));_e.lanes|=T,X=_e.alternate,X!==null&&(X.lanes|=T),f_(_e,T,d),_e=null}else _e=U.child;if(_e!==null)_e.return=U;else for(_e=U;_e!==null;){if(_e===d){_e=null;break}if(U=_e.sibling,U!==null){U.return=_e.return,_e=U;break}_e=_e.return}U=_e}}function Ku(d,_,T,P){d=null;for(var U=_,X=!1;U!==null;){if(!X){if((U.flags&524288)!==0)X=!0;else if((U.flags&262144)!==0)break}if(U.tag===10){var _e=U.alternate;if(_e===null)throw Error(l(387));if(_e=_e.memoizedProps,_e!==null){var Be=U.type;us(U.pendingProps.value,_e.value)||(d!==null?d.push(Be):d=[Be])}}else if(U===Zr.current){if(_e=U.alternate,_e===null)throw Error(l(387));_e.memoizedState.memoizedState!==U.memoizedState.memoizedState&&(d!==null?d.push(Nc):d=[Nc])}U=U.return}d!==null&&up(_,d,T,P),_.flags|=262144}function Yd(d){for(d=d.firstContext;d!==null;){if(!us(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function lu(d){vl=d,Sc=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function bo(d){return hp(vl,d)}function Zh(d,_){return vl===null&&lu(d),hp(d,_)}function hp(d,_){var T=_._currentValue;if(_={context:_,memoizedValue:T,next:null},Sc===null){if(d===null)throw Error(l(308));Sc=_,d.dependencies={lanes:0,firstContext:_},d.flags|=524288}else Sc=Sc.next=_;return T}var Kd=typeof AbortController<"u"?AbortController:function(){var d=[],_=this.signal={aborted:!1,addEventListener:function(T,P){d.push(P)}};this.abort=function(){_.aborted=!0,d.forEach(function(T){return T()})}},dp=r.unstable_scheduleCallback,gv=r.unstable_NormalPriority,Si={$$typeof:me,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qd(){return{controller:new Kd,data:new Map,refCount:0}}function cu(d){d.refCount--,d.refCount===0&&dp(gv,function(){d.controller.abort()})}var el=null,Jd=0,uu=0,Qu=null;function ef(d,_){if(el===null){var T=el=[];Jd=0,uu=U_(),Qu={status:"pending",value:void 0,then:function(P){T.push(P)}}}return Jd++,_.then(tf,tf),_}function tf(){if(--Jd===0&&el!==null){Qu!==null&&(Qu.status="fulfilled");var d=el;el=null,uu=0,Qu=null;for(var _=0;_<d.length;_++)(0,d[_])()}}function fp(d,_){var T=[],P={status:"pending",value:null,reason:null,then:function(U){T.push(U)}};return d.then(function(){P.status="fulfilled",P.value=_;for(var U=0;U<T.length;U++)(0,T[U])(_)},function(U){for(P.status="rejected",P.reason=U,U=0;U<T.length;U++)(0,T[U])(void 0)}),P}var pp=$e.S;$e.S=function(d,_){Ir=ni(),typeof _=="object"&&_!==null&&typeof _.then=="function"&&ef(d,_),pp!==null&&pp(d,_)};var hu=Ze(null);function mp(){var d=hu.current;return d!==null?d:He.pooledCache}function rf(d,_){_===null?Bt(hu,hu.current):Bt(hu,_.pool)}function Wh(){var d=mp();return d===null?null:{parent:Si._currentValue,pool:d}}var nf=Error(l(460)),p_=Error(l(474)),gp=Error(l(542)),_p={then:function(){}};function yp(d){return d=d.status,d==="fulfilled"||d==="rejected"}function _v(d,_,T){switch(T=d[T],T===void 0?d.push(_):T!==_&&(_.then(ka,ka),_=T),_.status){case"fulfilled":return _.value;case"rejected":throw d=_.reason,Ju(d),d;default:if(typeof _.status=="string")_.then(ka,ka);else{if(d=He,d!==null&&100<d.shellSuspendCounter)throw Error(l(482));d=_,d.status="pending",d.then(function(P){if(_.status==="pending"){var U=_;U.status="fulfilled",U.value=P}},function(P){if(_.status==="pending"){var U=_;U.status="rejected",U.reason=P}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw d=_.reason,Ju(d),d}throw du=_,nf}}function Ec(d){try{var _=d._init;return _(d._payload)}catch(T){throw T!==null&&typeof T=="object"&&typeof T.then=="function"?(du=T,nf):T}}var du=null;function m_(){if(du===null)throw Error(l(459));var d=du;return du=null,d}function Ju(d){if(d===nf||d===gp)throw Error(l(483))}var eh=null,af=0;function vp(d){var _=af;return af+=1,eh===null&&(eh=[]),_v(eh,d,_)}function Yh(d,_){_=_.props.ref,d.ref=_!==void 0?_:null}function Gl(d,_){throw _.$$typeof===G?Error(l(525)):(d=Object.prototype.toString.call(_),Error(l(31,d==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":d)))}function th(d){function _(Pt,_t){if(d){var Nt=Pt.deletions;Nt===null?(Pt.deletions=[_t],Pt.flags|=16):Nt.push(_t)}}function T(Pt,_t){if(!d)return null;for(;_t!==null;)_(Pt,_t),_t=_t.sibling;return null}function P(Pt){for(var _t=new Map;Pt!==null;)Pt.key!==null?_t.set(Pt.key,Pt):_t.set(Pt.index,Pt),Pt=Pt.sibling;return _t}function U(Pt,_t){return Pt=ds(Pt,_t),Pt.index=0,Pt.sibling=null,Pt}function X(Pt,_t,Nt){return Pt.index=Nt,d?(Nt=Pt.alternate,Nt!==null?(Nt=Nt.index,Nt<_t?(Pt.flags|=67108866,_t):Nt):(Pt.flags|=67108866,_t)):(Pt.flags|=1048576,_t)}function _e(Pt){return d&&Pt.alternate===null&&(Pt.flags|=67108866),Pt}function Be(Pt,_t,Nt,ur){return _t===null||_t.tag!==6?(_t=Xd(Nt,Pt.mode,ur),_t.return=Pt,_t):(_t=U(_t,Nt),_t.return=Pt,_t)}function ht(Pt,_t,Nt,ur){var dn=Nt.type;return dn===H?ir(Pt,_t,Nt.props.children,ur,Nt.key):_t!==null&&(_t.elementType===dn||typeof dn=="object"&&dn!==null&&dn.$$typeof===Le&&Ec(dn)===_t.type)?(_t=U(_t,Nt.props),Yh(_t,Nt),_t.return=Pt,_t):(_t=Hh(Nt.type,Nt.key,Nt.props,null,Pt.mode,ur),Yh(_t,Nt),_t.return=Pt,_t)}function Vt(Pt,_t,Nt,ur){return _t===null||_t.tag!==4||_t.stateNode.containerInfo!==Nt.containerInfo||_t.stateNode.implementation!==Nt.implementation?(_t=km(Nt,Pt.mode,ur),_t.return=Pt,_t):(_t=U(_t,Nt.children||[]),_t.return=Pt,_t)}function ir(Pt,_t,Nt,ur,dn){return _t===null||_t.tag!==7?(_t=Zu(Nt,Pt.mode,ur,dn),_t.return=Pt,_t):(_t=U(_t,Nt),_t.return=Pt,_t)}function pr(Pt,_t,Nt){if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return _t=Xd(""+_t,Pt.mode,Nt),_t.return=Pt,_t;if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case q:return Nt=Hh(_t.type,_t.key,_t.props,null,Pt.mode,Nt),Yh(Nt,_t),Nt.return=Pt,Nt;case Q:return _t=km(_t,Pt.mode,Nt),_t.return=Pt,_t;case Le:return _t=Ec(_t),pr(Pt,_t,Nt)}if(Mt(_t)||nt(_t))return _t=Zu(_t,Pt.mode,Nt,null),_t.return=Pt,_t;if(typeof _t.then=="function")return pr(Pt,vp(_t),Nt);if(_t.$$typeof===me)return pr(Pt,Zh(Pt,_t),Nt);Gl(Pt,_t)}return null}function $t(Pt,_t,Nt,ur){var dn=_t!==null?_t.key:null;if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return dn!==null?null:Be(Pt,_t,""+Nt,ur);if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case q:return Nt.key===dn?ht(Pt,_t,Nt,ur):null;case Q:return Nt.key===dn?Vt(Pt,_t,Nt,ur):null;case Le:return Nt=Ec(Nt),$t(Pt,_t,Nt,ur)}if(Mt(Nt)||nt(Nt))return dn!==null?null:ir(Pt,_t,Nt,ur,null);if(typeof Nt.then=="function")return $t(Pt,_t,vp(Nt),ur);if(Nt.$$typeof===me)return $t(Pt,_t,Zh(Pt,Nt),ur);Gl(Pt,Nt)}return null}function er(Pt,_t,Nt,ur,dn){if(typeof ur=="string"&&ur!==""||typeof ur=="number"||typeof ur=="bigint")return Pt=Pt.get(Nt)||null,Be(_t,Pt,""+ur,dn);if(typeof ur=="object"&&ur!==null){switch(ur.$$typeof){case q:return Pt=Pt.get(ur.key===null?Nt:ur.key)||null,ht(_t,Pt,ur,dn);case Q:return Pt=Pt.get(ur.key===null?Nt:ur.key)||null,Vt(_t,Pt,ur,dn);case Le:return ur=Ec(ur),er(Pt,_t,Nt,ur,dn)}if(Mt(ur)||nt(ur))return Pt=Pt.get(Nt)||null,ir(_t,Pt,ur,dn,null);if(typeof ur.then=="function")return er(Pt,_t,Nt,vp(ur),dn);if(ur.$$typeof===me)return er(Pt,_t,Nt,Zh(_t,ur),dn);Gl(_t,ur)}return null}function Hr(Pt,_t,Nt,ur){for(var dn=null,Pi=null,rn=_t,Jn=_t=0,pi=null;rn!==null&&Jn<Nt.length;Jn++){rn.index>Jn?(pi=rn,rn=null):pi=rn.sibling;var Oi=$t(Pt,rn,Nt[Jn],ur);if(Oi===null){rn===null&&(rn=pi);break}d&&rn&&Oi.alternate===null&&_(Pt,rn),_t=X(Oi,_t,Jn),Pi===null?dn=Oi:Pi.sibling=Oi,Pi=Oi,rn=pi}if(Jn===Nt.length)return T(Pt,rn),ci&&jl(Pt,Jn),dn;if(rn===null){for(;Jn<Nt.length;Jn++)rn=pr(Pt,Nt[Jn],ur),rn!==null&&(_t=X(rn,_t,Jn),Pi===null?dn=rn:Pi.sibling=rn,Pi=rn);return ci&&jl(Pt,Jn),dn}for(rn=P(rn);Jn<Nt.length;Jn++)pi=er(rn,Pt,Jn,Nt[Jn],ur),pi!==null&&(d&&pi.alternate!==null&&rn.delete(pi.key===null?Jn:pi.key),_t=X(pi,_t,Jn),Pi===null?dn=pi:Pi.sibling=pi,Pi=pi);return d&&rn.forEach(function(Au){return _(Pt,Au)}),ci&&jl(Pt,Jn),dn}function cn(Pt,_t,Nt,ur){if(Nt==null)throw Error(l(151));for(var dn=null,Pi=null,rn=_t,Jn=_t=0,pi=null,Oi=Nt.next();rn!==null&&!Oi.done;Jn++,Oi=Nt.next()){rn.index>Jn?(pi=rn,rn=null):pi=rn.sibling;var Au=$t(Pt,rn,Oi.value,ur);if(Au===null){rn===null&&(rn=pi);break}d&&rn&&Au.alternate===null&&_(Pt,rn),_t=X(Au,_t,Jn),Pi===null?dn=Au:Pi.sibling=Au,Pi=Au,rn=pi}if(Oi.done)return T(Pt,rn),ci&&jl(Pt,Jn),dn;if(rn===null){for(;!Oi.done;Jn++,Oi=Nt.next())Oi=pr(Pt,Oi.value,ur),Oi!==null&&(_t=X(Oi,_t,Jn),Pi===null?dn=Oi:Pi.sibling=Oi,Pi=Oi);return ci&&jl(Pt,Jn),dn}for(rn=P(rn);!Oi.done;Jn++,Oi=Nt.next())Oi=er(rn,Pt,Jn,Oi.value,ur),Oi!==null&&(d&&Oi.alternate!==null&&rn.delete(Oi.key===null?Jn:Oi.key),_t=X(Oi,_t,Jn),Pi===null?dn=Oi:Pi.sibling=Oi,Pi=Oi);return d&&rn.forEach(function(qw){return _(Pt,qw)}),ci&&jl(Pt,Jn),dn}function Vi(Pt,_t,Nt,ur){if(typeof Nt=="object"&&Nt!==null&&Nt.type===H&&Nt.key===null&&(Nt=Nt.props.children),typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case q:e:{for(var dn=Nt.key;_t!==null;){if(_t.key===dn){if(dn=Nt.type,dn===H){if(_t.tag===7){T(Pt,_t.sibling),ur=U(_t,Nt.props.children),ur.return=Pt,Pt=ur;break e}}else if(_t.elementType===dn||typeof dn=="object"&&dn!==null&&dn.$$typeof===Le&&Ec(dn)===_t.type){T(Pt,_t.sibling),ur=U(_t,Nt.props),Yh(ur,Nt),ur.return=Pt,Pt=ur;break e}T(Pt,_t);break}else _(Pt,_t);_t=_t.sibling}Nt.type===H?(ur=Zu(Nt.props.children,Pt.mode,ur,Nt.key),ur.return=Pt,Pt=ur):(ur=Hh(Nt.type,Nt.key,Nt.props,null,Pt.mode,ur),Yh(ur,Nt),ur.return=Pt,Pt=ur)}return _e(Pt);case Q:e:{for(dn=Nt.key;_t!==null;){if(_t.key===dn)if(_t.tag===4&&_t.stateNode.containerInfo===Nt.containerInfo&&_t.stateNode.implementation===Nt.implementation){T(Pt,_t.sibling),ur=U(_t,Nt.children||[]),ur.return=Pt,Pt=ur;break e}else{T(Pt,_t);break}else _(Pt,_t);_t=_t.sibling}ur=km(Nt,Pt.mode,ur),ur.return=Pt,Pt=ur}return _e(Pt);case Le:return Nt=Ec(Nt),Vi(Pt,_t,Nt,ur)}if(Mt(Nt))return Hr(Pt,_t,Nt,ur);if(nt(Nt)){if(dn=nt(Nt),typeof dn!="function")throw Error(l(150));return Nt=dn.call(Nt),cn(Pt,_t,Nt,ur)}if(typeof Nt.then=="function")return Vi(Pt,_t,vp(Nt),ur);if(Nt.$$typeof===me)return Vi(Pt,_t,Zh(Pt,Nt),ur);Gl(Pt,Nt)}return typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint"?(Nt=""+Nt,_t!==null&&_t.tag===6?(T(Pt,_t.sibling),ur=U(_t,Nt),ur.return=Pt,Pt=ur):(T(Pt,_t),ur=Xd(Nt,Pt.mode,ur),ur.return=Pt,Pt=ur),_e(Pt)):T(Pt,_t)}return function(Pt,_t,Nt,ur){try{af=0;var dn=Vi(Pt,_t,Nt,ur);return eh=null,dn}catch(rn){if(rn===nf||rn===gp)throw rn;var Pi=hs(29,rn,null,Pt.mode);return Pi.lanes=ur,Pi.return=Pt,Pi}}}var Mc=th(!0),g_=th(!1),fs=!1;function xp(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function of(d,_){d=d.updateQueue,_.updateQueue===d&&(_.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function Oc(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function fu(d,_,T){var P=d.updateQueue;if(P===null)return null;if(P=P.shared,(Ve&2)!==0){var U=P.pending;return U===null?_.next=_:(_.next=U.next,U.next=_),P.pending=_,_=Hd(d),Bm(d,null,T),_}return Ko(d,P,_,T),Hd(d)}function Kh(d,_,T){if(_=_.updateQueue,_!==null&&(_=_.shared,(T&4194048)!==0)){var P=_.lanes;P&=d.pendingLanes,T|=P,_.lanes=T,Sn(d,T)}}function sf(d,_){var T=d.updateQueue,P=d.alternate;if(P!==null&&(P=P.updateQueue,T===P)){var U=null,X=null;if(T=T.firstBaseUpdate,T!==null){do{var _e={lane:T.lane,tag:T.tag,payload:T.payload,callback:null,next:null};X===null?U=X=_e:X=X.next=_e,T=T.next}while(T!==null);X===null?U=X=_:X=X.next=_}else U=X=_;T={baseState:P.baseState,firstBaseUpdate:U,lastBaseUpdate:X,shared:P.shared,callbacks:P.callbacks},d.updateQueue=T;return}d=T.lastBaseUpdate,d===null?T.firstBaseUpdate=_:d.next=_,T.lastBaseUpdate=_}var Gm=!1;function Qh(){if(Gm){var d=Qu;if(d!==null)throw d}}function pu(d,_,T,P){Gm=!1;var U=d.updateQueue;fs=!1;var X=U.firstBaseUpdate,_e=U.lastBaseUpdate,Be=U.shared.pending;if(Be!==null){U.shared.pending=null;var ht=Be,Vt=ht.next;ht.next=null,_e===null?X=Vt:_e.next=Vt,_e=ht;var ir=d.alternate;ir!==null&&(ir=ir.updateQueue,Be=ir.lastBaseUpdate,Be!==_e&&(Be===null?ir.firstBaseUpdate=Vt:Be.next=Vt,ir.lastBaseUpdate=ht))}if(X!==null){var pr=U.baseState;_e=0,ir=Vt=ht=null,Be=X;do{var $t=Be.lane&-536870913,er=$t!==Be.lane;if(er?(We&$t)===$t:(P&$t)===$t){$t!==0&&$t===uu&&(Gm=!0),ir!==null&&(ir=ir.next={lane:0,tag:Be.tag,payload:Be.payload,callback:null,next:null});e:{var Hr=d,cn=Be;$t=_;var Vi=T;switch(cn.tag){case 1:if(Hr=cn.payload,typeof Hr=="function"){pr=Hr.call(Vi,pr,$t);break e}pr=Hr;break e;case 3:Hr.flags=Hr.flags&-65537|128;case 0:if(Hr=cn.payload,$t=typeof Hr=="function"?Hr.call(Vi,pr,$t):Hr,$t==null)break e;pr=k({},pr,$t);break e;case 2:fs=!0}}$t=Be.callback,$t!==null&&(d.flags|=64,er&&(d.flags|=8192),er=U.callbacks,er===null?U.callbacks=[$t]:er.push($t))}else er={lane:$t,tag:Be.tag,payload:Be.payload,callback:Be.callback,next:null},ir===null?(Vt=ir=er,ht=pr):ir=ir.next=er,_e|=$t;if(Be=Be.next,Be===null){if(Be=U.shared.pending,Be===null)break;er=Be,Be=er.next,er.next=null,U.lastBaseUpdate=er,U.shared.pending=null}}while(!0);ir===null&&(ht=pr),U.baseState=ht,U.firstBaseUpdate=Vt,U.lastBaseUpdate=ir,X===null&&(U.shared.lanes=0),zt|=_e,d.lanes=_e,d.memoizedState=pr}}function Jh(d,_){if(typeof d!="function")throw Error(l(191,d));d.call(_)}function yv(d,_){var T=d.callbacks;if(T!==null)for(d.callbacks=null,d=0;d<T.length;d++)Jh(T[d],_)}var ed=Ze(null),$m=Ze(0);function bp(d,_){d=ot,Bt($m,d),Bt(ed,_),ot=d|_.baseLanes}function td(){Bt($m,ot),Bt(ed,ed.current)}function Cc(){ot=$m.current,gt(ed),gt($m)}var Lo=Ze(null),wo=null;function $l(d){var _=d.alternate;Bt(Na,Na.current&1),Bt(Lo,d),wo===null&&(_===null||ed.current!==null||_.memoizedState!==null)&&(wo=d)}function rd(d){Bt(Na,Na.current),Bt(Lo,d),wo===null&&(wo=d)}function wp(d){d.tag===22?(Bt(Na,Na.current),Bt(Lo,d),wo===null&&(wo=d)):Bo()}function Bo(){Bt(Na,Na.current),Bt(Lo,Lo.current)}function Rs(d){gt(Lo),wo===d&&(wo=null),gt(Na)}var Na=Ze(0);function Ic(d){for(var _=d;_!==null;){if(_.tag===13){var T=_.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||Lx(T)||Bx(T)))return _}else if(_.tag===19&&(_.memoizedProps.revealOrder==="forwards"||_.memoizedProps.revealOrder==="backwards"||_.memoizedProps.revealOrder==="unstable_legacy-backwards"||_.memoizedProps.revealOrder==="together")){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var xl=0,jt=null,Ni=null,ji=null,bl=!1,nd=!1,rh=!1,id=0,nh=0,ih=null,__=0;function Ki(){throw Error(l(321))}function ah(d,_){if(_===null)return!1;for(var T=0;T<_.length&&T<d.length;T++)if(!us(d[T],_[T]))return!1;return!0}function ad(d,_,T,P,U,X){return xl=X,jt=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,$e.H=d===null||d.memoizedState===null?ng:Rp,rh=!1,X=T(P,U),rh=!1,nd&&(X=y_(_,T,P,U)),ql(d),X}function ql(d){$e.H=Xl;var _=Ni!==null&&Ni.next!==null;if(xl=0,ji=Ni=jt=null,bl=!1,nh=0,ih=null,_)throw Error(l(300));d===null||Ea||(d=d.dependencies,d!==null&&Yd(d)&&(Ea=!0))}function y_(d,_,T,P){jt=d;var U=0;do{if(nd&&(ih=null),nh=0,nd=!1,25<=U)throw Error(l(301));if(U+=1,ji=Ni=null,d.updateQueue!=null){var X=d.updateQueue;X.lastEffect=null,X.events=null,X.stores=null,X.memoCache!=null&&(X.memoCache.index=0)}$e.H=I_,X=_(T,P)}while(nd);return X}function vv(){var d=$e.H,_=d.useState()[0];return _=typeof _.then=="function"?oh(_):_,d=d.useState()[0],(Ni!==null?Ni.memoizedState:null)!==d&&(jt.flags|=1024),_}function qm(){var d=id!==0;return id=0,d}function Hm(d,_,T){_.updateQueue=d.updateQueue,_.flags&=-2053,d.lanes&=~T}function Ap(d){if(bl){for(d=d.memoizedState;d!==null;){var _=d.queue;_!==null&&(_.pending=null),d=d.next}bl=!1}xl=0,ji=Ni=jt=null,nd=!1,nh=id=0,ih=null}function Ya(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ji===null?jt.memoizedState=ji=d:ji=ji.next=d,ji}function fa(){if(Ni===null){var d=jt.alternate;d=d!==null?d.memoizedState:null}else d=Ni.next;var _=ji===null?jt.memoizedState:ji.next;if(_!==null)ji=_,Ni=d;else{if(d===null)throw jt.alternate===null?Error(l(467)):Error(l(310));Ni=d,d={memoizedState:Ni.memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},ji===null?jt.memoizedState=ji=d:ji=ji.next=d}return ji}function lf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function oh(d){var _=nh;return nh+=1,ih===null&&(ih=[]),d=_v(ih,d,_),_=jt,(ji===null?_.memoizedState:ji.next)===null&&(_=_.alternate,$e.H=_===null||_.memoizedState===null?ng:Rp),d}function Tp(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return oh(d);if(d.$$typeof===me)return bo(d)}throw Error(l(438,String(d)))}function Xm(d){var _=null,T=jt.updateQueue;if(T!==null&&(_=T.memoCache),_==null){var P=jt.alternate;P!==null&&(P=P.updateQueue,P!==null&&(P=P.memoCache,P!=null&&(_={data:P.data.map(function(U){return U.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),T===null&&(T=lf(),jt.updateQueue=T),T.memoCache=_,T=_.data[_.index],T===void 0)for(T=_.data[_.index]=Array(d),P=0;P<d;P++)T[P]=tt;return _.index++,T}function Hl(d,_){return typeof _=="function"?_(d):_}function Sp(d){var _=fa();return Ep(_,Ni,d)}function Ep(d,_,T){var P=d.queue;if(P===null)throw Error(l(311));P.lastRenderedReducer=T;var U=d.baseQueue,X=P.pending;if(X!==null){if(U!==null){var _e=U.next;U.next=X.next,X.next=_e}_.baseQueue=U=X,P.pending=null}if(X=d.baseState,U===null)d.memoizedState=X;else{_=U.next;var Be=_e=null,ht=null,Vt=_,ir=!1;do{var pr=Vt.lane&-536870913;if(pr!==Vt.lane?(We&pr)===pr:(xl&pr)===pr){var $t=Vt.revertLane;if($t===0)ht!==null&&(ht=ht.next={lane:0,revertLane:0,gesture:null,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),pr===uu&&(ir=!0);else if((xl&$t)===$t){Vt=Vt.next,$t===uu&&(ir=!0);continue}else pr={lane:0,revertLane:Vt.revertLane,gesture:null,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null},ht===null?(Be=ht=pr,_e=X):ht=ht.next=pr,jt.lanes|=$t,zt|=$t;pr=Vt.action,rh&&T(X,pr),X=Vt.hasEagerState?Vt.eagerState:T(X,pr)}else $t={lane:pr,revertLane:Vt.revertLane,gesture:Vt.gesture,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null},ht===null?(Be=ht=$t,_e=X):ht=ht.next=$t,jt.lanes|=pr,zt|=pr;Vt=Vt.next}while(Vt!==null&&Vt!==_);if(ht===null?_e=X:ht.next=Be,!us(X,d.memoizedState)&&(Ea=!0,ir&&(T=Qu,T!==null)))throw T;d.memoizedState=X,d.baseState=_e,d.baseQueue=ht,P.lastRenderedState=X}return U===null&&(P.lanes=0),[d.memoizedState,P.dispatch]}function Zm(d){var _=fa(),T=_.queue;if(T===null)throw Error(l(311));T.lastRenderedReducer=d;var P=T.dispatch,U=T.pending,X=_.memoizedState;if(U!==null){T.pending=null;var _e=U=U.next;do X=d(X,_e.action),_e=_e.next;while(_e!==U);us(X,_.memoizedState)||(Ea=!0),_.memoizedState=X,_.baseQueue===null&&(_.baseState=X),T.lastRenderedState=X}return[X,P]}function Wm(d,_,T){var P=jt,U=fa(),X=ci;if(X){if(T===void 0)throw Error(l(407));T=T()}else T=_();var _e=!us((Ni||U).memoizedState,T);if(_e&&(U.memoizedState=T,Ea=!0),U=U.queue,od(xv.bind(null,P,U,d),[d]),U.getSnapshot!==_||_e||ji!==null&&ji.memoizedState.tag&1){if(P.flags|=2048,sh(9,{destroy:void 0},Km.bind(null,P,U,T,_),null),He===null)throw Error(l(349));X||(xl&127)!==0||Ym(P,_,T)}return T}function Ym(d,_,T){d.flags|=16384,d={getSnapshot:_,value:T},_=jt.updateQueue,_===null?(_=lf(),jt.updateQueue=_,_.stores=[d]):(T=_.stores,T===null?_.stores=[d]:T.push(d))}function Km(d,_,T,P){_.value=T,_.getSnapshot=P,bv(_)&&v_(d)}function xv(d,_,T){return T(function(){bv(_)&&v_(d)})}function bv(d){var _=d.getSnapshot;d=d.value;try{var T=_();return!us(d,T)}catch{return!0}}function v_(d){var _=Gt(d,2);_!==null&&Nr(_,d,2)}function Pc(d){var _=Ya();if(typeof d=="function"){var T=d;if(d=T(),rh){Ti(!0);try{T()}finally{Ti(!1)}}}return _.memoizedState=_.baseState=d,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:d},_}function x_(d,_,T,P){return d.baseState=T,Ep(d,Ni,typeof P=="function"?P:Hl)}function b_(d,_,T,P,U){if(Pp(d))throw Error(l(485));if(d=_.action,d!==null){var X={payload:U,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_e){X.listeners.push(_e)}};$e.T!==null?T(!0):X.isTransition=!1,P(X),T=_.pending,T===null?(X.next=_.pending=X,Mp(_,X)):(X.next=T.next,_.pending=T.next=X)}}function Mp(d,_){var T=_.action,P=_.payload,U=d.state;if(_.isTransition){var X=$e.T,_e={};$e.T=_e;try{var Be=T(U,P),ht=$e.S;ht!==null&&ht(_e,Be),w_(d,_,Be)}catch(Vt){Dc(d,_,Vt)}finally{X!==null&&_e.types!==null&&(X.types=_e.types),$e.T=X}}else try{X=T(U,P),w_(d,_,X)}catch(Vt){Dc(d,_,Vt)}}function w_(d,_,T){T!==null&&typeof T=="object"&&typeof T.then=="function"?T.then(function(P){wv(d,_,P)},function(P){return Dc(d,_,P)}):wv(d,_,T)}function wv(d,_,T){_.status="fulfilled",_.value=T,Qo(_),d.state=T,_=d.pending,_!==null&&(T=_.next,T===_?d.pending=null:(T=T.next,_.next=T,Mp(d,T)))}function Dc(d,_,T){var P=d.pending;if(d.pending=null,P!==null){P=P.next;do _.status="rejected",_.reason=T,Qo(_),_=_.next;while(_!==P)}d.action=null}function Qo(d){d=d.listeners;for(var _=0;_<d.length;_++)(0,d[_])()}function mu(d,_){return _}function ko(d,_){if(ci){var T=He.formState;if(T!==null){e:{var P=jt;if(ci){if(Fi){t:{for(var U=Fi,X=Js;U.nodeType!==8;){if(!X){U=null;break t}if(U=kc(U.nextSibling),U===null){U=null;break t}}X=U.data,U=X==="F!"||X==="F"?U:null}if(U){Fi=kc(U.nextSibling),P=U.data==="F!";break e}}Ul(P)}P=!1}P&&(_=T[0])}}return T=Ya(),T.memoizedState=T.baseState=_,P={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mu,lastRenderedState:_},T.queue=P,T=hf.bind(null,jt,P),P.dispatch=T,P=Pc(!1),X=Ip.bind(null,jt,!1,P.queue),P=Ya(),U={state:_,dispatch:null,action:d,pending:null},P.queue=U,T=b_.bind(null,jt,U,X,T),U.dispatch=T,P.memoizedState=d,[_,T,!1]}function gu(d){var _=fa();return A_(_,Ni,d)}function A_(d,_,T){if(_=Ep(d,_,mu)[0],d=Sp(Hl)[0],typeof _=="object"&&_!==null&&typeof _.then=="function")try{var P=oh(_)}catch(_e){throw _e===nf?gp:_e}else P=_;_=fa();var U=_.queue,X=U.dispatch;return T!==_.memoizedState&&(jt.flags|=2048,sh(9,{destroy:void 0},T_.bind(null,U,T),null)),[P,X,d]}function T_(d,_){d.action=_}function Qm(d){var _=fa(),T=Ni;if(T!==null)return A_(_,T,d);fa(),_=_.memoizedState,T=fa();var P=T.queue.dispatch;return T.memoizedState=d,[_,P,!1]}function sh(d,_,T,P){return d={tag:d,create:T,deps:P,inst:_,next:null},_=jt.updateQueue,_===null&&(_=lf(),jt.updateQueue=_),T=_.lastEffect,T===null?_.lastEffect=d.next=d:(P=T.next,T.next=d,d.next=P,_.lastEffect=d),d}function Jm(){return fa().memoizedState}function zs(d,_,T,P){var U=Ya();jt.flags|=d,U.memoizedState=sh(1|_,{destroy:void 0},T,P===void 0?null:P)}function In(d,_,T,P){var U=fa();P=P===void 0?null:P;var X=U.memoizedState.inst;Ni!==null&&P!==null&&ah(P,Ni.memoizedState.deps)?U.memoizedState=sh(_,X,T,P):(jt.flags|=d,U.memoizedState=sh(1|_,X,T,P))}function cf(d,_){zs(8390656,8,d,_)}function od(d,_){In(2048,8,d,_)}function uf(d){jt.flags|=4;var _=jt.updateQueue;if(_===null)_=lf(),jt.updateQueue=_,_.events=[d];else{var T=_.events;T===null?_.events=[d]:T.push(d)}}function S_(d){var _=fa().memoizedState;return uf({ref:_,nextImpl:d}),function(){if((Ve&2)!==0)throw Error(l(440));return _.impl.apply(void 0,arguments)}}function E_(d,_){return In(4,2,d,_)}function eg(d,_){return In(4,4,d,_)}function lh(d,_){if(typeof _=="function"){d=d();var T=_(d);return function(){typeof T=="function"?T():_(null)}}if(_!=null)return d=d(),_.current=d,function(){_.current=null}}function Fo(d,_,T){T=T!=null?T.concat([d]):null,In(4,4,lh.bind(null,_,d),T)}function Ft(){}function Qt(d,_){var T=fa();_=_===void 0?null:_;var P=T.memoizedState;return _!==null&&ah(_,P[1])?P[0]:(T.memoizedState=[d,_],d)}function sd(d,_){var T=fa();_=_===void 0?null:_;var P=T.memoizedState;if(_!==null&&ah(_,P[1]))return P[0];if(P=d(),rh){Ti(!0);try{d()}finally{Ti(!1)}}return T.memoizedState=[P,_],P}function vi(d,_,T){return T===void 0||(xl&1073741824)!==0&&(We&261930)===0?d.memoizedState=_:(d.memoizedState=T,d=wn(),jt.lanes|=d,zt|=d,T)}function Ye(d,_,T,P){return us(T,_)?T:ed.current!==null?(d=vi(d,T,P),us(d,_)||(Ea=!0),d):(xl&42)===0||(xl&1073741824)!==0&&(We&261930)===0?(Ea=!0,d.memoizedState=T):(d=wn(),jt.lanes|=d,zt|=d,_)}function M_(d,_,T,P,U){var X=rt.p;rt.p=X!==0&&8>X?X:8;var _e=$e.T,Be={};$e.T=Be,Ip(d,!1,_,T);try{var ht=U(),Vt=$e.S;if(Vt!==null&&Vt(Be,ht),ht!==null&&typeof ht=="object"&&typeof ht.then=="function"){var ir=fp(ht,P);Ls(d,_,ir,Dn(d))}else Ls(d,_,P,Dn(d))}catch(pr){Ls(d,_,{then:function(){},status:"rejected",reason:pr},Dn())}finally{rt.p=X,_e!==null&&Be.types!==null&&(_e.types=Be.types),$e.T=_e}}function tg(){}function Op(d,_,T,P){if(d.tag!==5)throw Error(l(476));var U=rg(d).queue;M_(d,U,_,Ct,T===null?tg:function(){return O_(d),T(P)})}function rg(d){var _=d.memoizedState;if(_!==null)return _;_={memoizedState:Ct,baseState:Ct,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:Ct},next:null};var T={};return _.next={memoizedState:T,baseState:T,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:T},next:null},d.memoizedState=_,d=d.alternate,d!==null&&(d.memoizedState=_),_}function O_(d){var _=rg(d);_.next===null&&(_=d.alternate.memoizedState),Ls(d,_.next.queue,{},Dn())}function Cp(){return bo(Nc)}function ld(){return fa().memoizedState}function Av(){return fa().memoizedState}function Tx(d){for(var _=d.return;_!==null;){switch(_.tag){case 24:case 3:var T=Dn();d=Oc(T);var P=fu(_,d,T);P!==null&&(Nr(P,_,T),Kh(P,_,T)),_={cache:Qd()},d.payload=_;return}_=_.return}}function C_(d,_,T){var P=Dn();T={lane:P,revertLane:0,gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null},Pp(d)?Dp(_,T):(T=qh(d,_,T,P),T!==null&&(Nr(T,d,P),df(T,_,P)))}function hf(d,_,T){var P=Dn();Ls(d,_,T,P)}function Ls(d,_,T,P){var U={lane:P,revertLane:0,gesture:null,action:T,hasEagerState:!1,eagerState:null,next:null};if(Pp(d))Dp(_,U);else{var X=d.alternate;if(d.lanes===0&&(X===null||X.lanes===0)&&(X=_.lastRenderedReducer,X!==null))try{var _e=_.lastRenderedState,Be=X(_e,T);if(U.hasEagerState=!0,U.eagerState=Be,us(Be,_e))return Ko(d,_,U,0),He===null&&$h(),!1}catch{}if(T=qh(d,_,U,P),T!==null)return Nr(T,d,P),df(T,_,P),!0}return!1}function Ip(d,_,T,P){if(P={lane:2,revertLane:U_(),gesture:null,action:P,hasEagerState:!1,eagerState:null,next:null},Pp(d)){if(_)throw Error(l(479))}else _=qh(d,T,P,2),_!==null&&Nr(_,d,2)}function Pp(d){var _=d.alternate;return d===jt||_!==null&&_===jt}function Dp(d,_){nd=bl=!0;var T=d.pending;T===null?_.next=_:(_.next=T.next,T.next=_),d.pending=_}function df(d,_,T){if((T&4194048)!==0){var P=_.lanes;P&=d.pendingLanes,T|=P,_.lanes=T,Sn(d,T)}}var Xl={readContext:bo,use:Tp,useCallback:Ki,useContext:Ki,useEffect:Ki,useImperativeHandle:Ki,useLayoutEffect:Ki,useInsertionEffect:Ki,useMemo:Ki,useReducer:Ki,useRef:Ki,useState:Ki,useDebugValue:Ki,useDeferredValue:Ki,useTransition:Ki,useSyncExternalStore:Ki,useId:Ki,useHostTransitionStatus:Ki,useFormState:Ki,useActionState:Ki,useOptimistic:Ki,useMemoCache:Ki,useCacheRefresh:Ki};Xl.useEffectEvent=Ki;var ng={readContext:bo,use:Tp,useCallback:function(d,_){return Ya().memoizedState=[d,_===void 0?null:_],d},useContext:bo,useEffect:cf,useImperativeHandle:function(d,_,T){T=T!=null?T.concat([d]):null,zs(4194308,4,lh.bind(null,_,d),T)},useLayoutEffect:function(d,_){return zs(4194308,4,d,_)},useInsertionEffect:function(d,_){zs(4,2,d,_)},useMemo:function(d,_){var T=Ya();_=_===void 0?null:_;var P=d();if(rh){Ti(!0);try{d()}finally{Ti(!1)}}return T.memoizedState=[P,_],P},useReducer:function(d,_,T){var P=Ya();if(T!==void 0){var U=T(_);if(rh){Ti(!0);try{T(_)}finally{Ti(!1)}}}else U=_;return P.memoizedState=P.baseState=U,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:U},P.queue=d,d=d.dispatch=C_.bind(null,jt,d),[P.memoizedState,d]},useRef:function(d){var _=Ya();return d={current:d},_.memoizedState=d},useState:function(d){d=Pc(d);var _=d.queue,T=hf.bind(null,jt,_);return _.dispatch=T,[d.memoizedState,T]},useDebugValue:Ft,useDeferredValue:function(d,_){var T=Ya();return vi(T,d,_)},useTransition:function(){var d=Pc(!1);return d=M_.bind(null,jt,d.queue,!0,!1),Ya().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,_,T){var P=jt,U=Ya();if(ci){if(T===void 0)throw Error(l(407));T=T()}else{if(T=_(),He===null)throw Error(l(349));(We&127)!==0||Ym(P,_,T)}U.memoizedState=T;var X={value:T,getSnapshot:_};return U.queue=X,cf(xv.bind(null,P,X,d),[d]),P.flags|=2048,sh(9,{destroy:void 0},Km.bind(null,P,X,T,_),null),T},useId:function(){var d=Ya(),_=He.identifierPrefix;if(ci){var T=Nl,P=Ac;T=(P&~(1<<32-qi(P)-1)).toString(32)+T,_="_"+_+"R_"+T,T=id++,0<T&&(_+="H"+T.toString(32)),_+="_"}else T=__++,_="_"+_+"r_"+T.toString(32)+"_";return d.memoizedState=_},useHostTransitionStatus:Cp,useFormState:ko,useActionState:ko,useOptimistic:function(d){var _=Ya();_.memoizedState=_.baseState=d;var T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=T,_=Ip.bind(null,jt,!0,T),T.dispatch=_,[d,_]},useMemoCache:Xm,useCacheRefresh:function(){return Ya().memoizedState=Tx.bind(null,jt)},useEffectEvent:function(d){var _=Ya(),T={impl:d};return _.memoizedState=T,function(){if((Ve&2)!==0)throw Error(l(440));return T.impl.apply(void 0,arguments)}}},Rp={readContext:bo,use:Tp,useCallback:Qt,useContext:bo,useEffect:od,useImperativeHandle:Fo,useInsertionEffect:E_,useLayoutEffect:eg,useMemo:sd,useReducer:Sp,useRef:Jm,useState:function(){return Sp(Hl)},useDebugValue:Ft,useDeferredValue:function(d,_){var T=fa();return Ye(T,Ni.memoizedState,d,_)},useTransition:function(){var d=Sp(Hl)[0],_=fa().memoizedState;return[typeof d=="boolean"?d:oh(d),_]},useSyncExternalStore:Wm,useId:ld,useHostTransitionStatus:Cp,useFormState:gu,useActionState:gu,useOptimistic:function(d,_){var T=fa();return x_(T,Ni,d,_)},useMemoCache:Xm,useCacheRefresh:Av};Rp.useEffectEvent=S_;var I_={readContext:bo,use:Tp,useCallback:Qt,useContext:bo,useEffect:od,useImperativeHandle:Fo,useInsertionEffect:E_,useLayoutEffect:eg,useMemo:sd,useReducer:Zm,useRef:Jm,useState:function(){return Zm(Hl)},useDebugValue:Ft,useDeferredValue:function(d,_){var T=fa();return Ni===null?vi(T,d,_):Ye(T,Ni.memoizedState,d,_)},useTransition:function(){var d=Zm(Hl)[0],_=fa().memoizedState;return[typeof d=="boolean"?d:oh(d),_]},useSyncExternalStore:Wm,useId:ld,useHostTransitionStatus:Cp,useFormState:Qm,useActionState:Qm,useOptimistic:function(d,_){var T=fa();return Ni!==null?x_(T,Ni,d,_):(T.baseState=d,[d,T.queue.dispatch])},useMemoCache:Xm,useCacheRefresh:Av};I_.useEffectEvent=S_;function ig(d,_,T,P){_=d.memoizedState,T=T(P,_),T=T==null?_:k({},_,T),d.memoizedState=T,d.lanes===0&&(d.updateQueue.baseState=T)}var ag={enqueueSetState:function(d,_,T){d=d._reactInternals;var P=Dn(),U=Oc(P);U.payload=_,T!=null&&(U.callback=T),_=fu(d,U,P),_!==null&&(Nr(_,d,P),Kh(_,d,P))},enqueueReplaceState:function(d,_,T){d=d._reactInternals;var P=Dn(),U=Oc(P);U.tag=1,U.payload=_,T!=null&&(U.callback=T),_=fu(d,U,P),_!==null&&(Nr(_,d,P),Kh(_,d,P))},enqueueForceUpdate:function(d,_){d=d._reactInternals;var T=Dn(),P=Oc(T);P.tag=2,_!=null&&(P.callback=_),_=fu(d,P,T),_!==null&&(Nr(_,d,T),Kh(_,d,T))}};function No(d,_,T,P,U,X,_e){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(P,X,_e):_.prototype&&_.prototype.isPureReactComponent?!Ps(T,P)||!Ps(U,X):!0}function P_(d,_,T,P){d=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(T,P),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(T,P),_.state!==d&&ag.enqueueReplaceState(_,_.state,null)}function Bs(d,_){var T=_;if("ref"in _){T={};for(var P in _)P!=="ref"&&(T[P]=_[P])}if(d=d.defaultProps){T===_&&(T=k({},T));for(var U in d)T[U]===void 0&&(T[U]=d[U])}return T}function Tv(d){qd(d)}function ai(d){console.error(d)}function en(d){qd(d)}function zp(d,_){try{var T=d.onUncaughtError;T(_.value,{componentStack:_.stack})}catch(P){setTimeout(function(){throw P})}}function _u(d,_,T){try{var P=d.onCaughtError;P(T.value,{componentStack:T.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(U){setTimeout(function(){throw U})}}function Zl(d,_,T){return T=Oc(T),T.tag=3,T.payload={element:null},T.callback=function(){zp(d,_)},T}function Rc(d){return d=Oc(d),d.tag=3,d}function ja(d,_,T,P){var U=T.type.getDerivedStateFromError;if(typeof U=="function"){var X=P.value;d.payload=function(){return U(X)},d.callback=function(){_u(_,T,P)}}var _e=T.stateNode;_e!==null&&typeof _e.componentDidCatch=="function"&&(d.callback=function(){_u(_,T,P),typeof U!="function"&&(Pr===null?Pr=new Set([this]):Pr.add(this));var Be=P.stack;this.componentDidCatch(P.value,{componentStack:Be!==null?Be:""})})}function ff(d,_,T,P,U){if(T.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){if(_=T.alternate,_!==null&&Ku(_,T,U,!0),T=Lo.current,T!==null){switch(T.tag){case 31:case 13:return wo===null?so():T.alternate===null&&bt===0&&(bt=3),T.flags&=-257,T.flags|=65536,T.lanes=U,P===_p?T.flags|=16384:(_=T.updateQueue,_===null?T.updateQueue=new Set([P]):_.add(P),bu(d,P,U)),!1;case 22:return T.flags|=65536,P===_p?T.flags|=16384:(_=T.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([P])},T.updateQueue=_):(T=_.retryQueue,T===null?_.retryQueue=new Set([P]):T.add(P)),bu(d,P,U)),!1}throw Error(l(435,T.tag))}return bu(d,P,U),so(),!1}if(ci)return _=Lo.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=U,P!==Wu&&(d=Error(l(422),{cause:P}),Wd(ao(d,T)))):(P!==Wu&&(_=Error(l(423),{cause:P}),Wd(ao(_,T))),d=d.current.alternate,d.flags|=65536,U&=-U,d.lanes|=U,P=ao(P,T),U=Zl(d.stateNode,P,U),sf(d,U),bt!==4&&(bt=2)),!1;var X=Error(l(520),{cause:P});if(X=ao(X,T),sr===null?sr=[X]:sr.push(X),bt!==4&&(bt=2),_===null)return!0;P=ao(P,T),T=_;do{switch(T.tag){case 3:return T.flags|=65536,d=U&-U,T.lanes|=d,d=Zl(T.stateNode,P,d),sf(T,d),!1;case 1:if(_=T.type,X=T.stateNode,(T.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Pr===null||!Pr.has(X))))return T.flags|=65536,U&=-U,T.lanes|=U,U=Rc(U),ja(U,d,T,P),sf(T,U),!1}T=T.return}while(T!==null);return!1}var Lp=Error(l(461)),Ea=!1;function oo(d,_,T,P){_.child=d===null?g_(_,null,T,P):Mc(_,d.child,T,P)}function tl(d,_,T,P,U){T=T.render;var X=_.ref;if("ref"in P){var _e={};for(var Be in P)Be!=="ref"&&(_e[Be]=P[Be])}else _e=P;return lu(_),P=ad(d,_,T,_e,X,U),Be=qm(),d!==null&&!Ea?(Hm(d,_,U),Kl(d,_,U)):(ci&&Be&&lp(_),_.flags|=1,oo(d,_,P,U),_.child)}function Wl(d,_,T,P,U){if(d===null){var X=T.type;return typeof X=="function"&&!nu(X)&&X.defaultProps===void 0&&T.compare===null?(_.tag=15,_.type=X,cd(d,_,X,P,U)):(d=Hh(T.type,null,P,_,_.mode,U),d.ref=_.ref,d.return=_,_.child=d)}if(X=d.child,!pd(d,U)){var _e=X.memoizedProps;if(T=T.compare,T=T!==null?T:Ps,T(_e,P)&&d.ref===_.ref)return Kl(d,_,U)}return _.flags|=1,d=ds(X,P),d.ref=_.ref,d.return=_,_.child=d}function cd(d,_,T,P,U){if(d!==null){var X=d.memoizedProps;if(Ps(X,P)&&d.ref===_.ref)if(Ea=!1,_.pendingProps=P=X,pd(d,U))(d.flags&131072)!==0&&(Ea=!0);else return _.lanes=d.lanes,Kl(d,_,U)}return pf(d,_,T,P,U)}function ud(d,_,T,P){var U=P.children,X=d!==null?d.memoizedState:null;if(d===null&&_.stateNode===null&&(_.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),P.mode==="hidden"){if((_.flags&128)!==0){if(X=X!==null?X.baseLanes|T:T,d!==null){for(P=_.child=d.child,U=0;P!==null;)U=U|P.lanes|P.childLanes,P=P.sibling;P=U&~X}else P=0,_.child=null;return og(d,_,X,T,P)}if((T&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},d!==null&&rf(_,X!==null?X.cachePool:null),X!==null?bp(_,X):td(),wp(_);else return P=_.lanes=536870912,og(d,_,X!==null?X.baseLanes|T:T,T,P)}else X!==null?(rf(_,X.cachePool),bp(_,X),Bo(),_.memoizedState=null):(d!==null&&rf(_,null),td(),Bo());return oo(d,_,U,T),_.child}function hd(d,_){return d!==null&&d.tag===22||_.stateNode!==null||(_.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),_.sibling}function og(d,_,T,P,U){var X=mp();return X=X===null?null:{parent:Si._currentValue,pool:X},_.memoizedState={baseLanes:T,cachePool:X},d!==null&&rf(_,null),td(),wp(_),d!==null&&Ku(d,_,P,!0),_.childLanes=U,null}function Yl(d,_){return _=_f({mode:_.mode,children:_.children},d.mode),_.ref=d.ref,d.child=_,_.return=d,_}function sg(d,_,T){return Mc(_,d.child,null,T),d=Yl(_,_.pendingProps),d.flags|=2,Rs(_),_.memoizedState=null,d}function rl(d,_,T){var P=_.pendingProps,U=(_.flags&128)!==0;if(_.flags&=-129,d===null){if(ci){if(P.mode==="hidden")return d=Yl(_,P),_.lanes=536870912,hd(null,d);if(rd(_),(d=Fi)?(d=Ow(d,Js),d=d!==null&&d.data==="&"?d:null,d!==null&&(_.memoizedState={dehydrated:d,treeContext:$n!==null?{id:Ac,overflow:Nl}:null,retryLane:536870912,hydrationErrors:null},T=mv(d),T.return=_,_.child=T,Fa=_,Fi=null)):d=null,d===null)throw Ul(_);return _.lanes=536870912,null}return Yl(_,P)}var X=d.memoizedState;if(X!==null){var _e=X.dehydrated;if(rd(_),U)if(_.flags&256)_.flags&=-257,_=sg(d,_,T);else if(_.memoizedState!==null)_.child=d.child,_.flags|=128,_=null;else throw Error(l(558));else if(Ea||Ku(d,_,T,!1),U=(T&d.childLanes)!==0,Ea||U){if(P=He,P!==null&&(_e=an(P,T),_e!==0&&_e!==X.retryLane))throw X.retryLane=_e,Gt(d,_e),Nr(P,d,_e),Lp;so(),_=sg(d,_,T)}else d=X.treeContext,Fi=kc(_e.nextSibling),Fa=_,ci=!0,Tc=null,Js=!1,d!==null&&Xh(_,d),_=Yl(_,P),_.flags|=4096;return _}return d=ds(d.child,{mode:P.mode,children:P.children}),d.ref=_.ref,_.child=d,d.return=_,d}function ch(d,_){var T=_.ref;if(T===null)d!==null&&d.ref!==null&&(_.flags|=4194816);else{if(typeof T!="function"&&typeof T!="object")throw Error(l(284));(d===null||d.ref!==T)&&(_.flags|=4194816)}}function pf(d,_,T,P,U){return lu(_),T=ad(d,_,T,P,void 0,U),P=qm(),d!==null&&!Ea?(Hm(d,_,U),Kl(d,_,U)):(ci&&P&&lp(_),_.flags|=1,oo(d,_,T,U),_.child)}function Bp(d,_,T,P,U,X){return lu(_),_.updateQueue=null,T=y_(_,P,T,U),ql(d),P=qm(),d!==null&&!Ea?(Hm(d,_,X),Kl(d,_,X)):(ci&&P&&lp(_),_.flags|=1,oo(d,_,T,X),_.child)}function kp(d,_,T,P,U){if(lu(_),_.stateNode===null){var X=bc,_e=T.contextType;typeof _e=="object"&&_e!==null&&(X=bo(_e)),X=new T(P,X),_.memoizedState=X.state!==null&&X.state!==void 0?X.state:null,X.updater=ag,_.stateNode=X,X._reactInternals=_,X=_.stateNode,X.props=P,X.state=_.memoizedState,X.refs={},xp(_),_e=T.contextType,X.context=typeof _e=="object"&&_e!==null?bo(_e):bc,X.state=_.memoizedState,_e=T.getDerivedStateFromProps,typeof _e=="function"&&(ig(_,T,_e,P),X.state=_.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof X.getSnapshotBeforeUpdate=="function"||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(_e=X.state,typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount(),_e!==X.state&&ag.enqueueReplaceState(X,X.state,null),pu(_,P,X,U),Qh(),X.state=_.memoizedState),typeof X.componentDidMount=="function"&&(_.flags|=4194308),P=!0}else if(d===null){X=_.stateNode;var Be=_.memoizedProps,ht=Bs(T,Be);X.props=ht;var Vt=X.context,ir=T.contextType;_e=bc,typeof ir=="object"&&ir!==null&&(_e=bo(ir));var pr=T.getDerivedStateFromProps;ir=typeof pr=="function"||typeof X.getSnapshotBeforeUpdate=="function",Be=_.pendingProps!==Be,ir||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(Be||Vt!==_e)&&P_(_,X,P,_e),fs=!1;var $t=_.memoizedState;X.state=$t,pu(_,P,X,U),Qh(),Vt=_.memoizedState,Be||$t!==Vt||fs?(typeof pr=="function"&&(ig(_,T,pr,P),Vt=_.memoizedState),(ht=fs||No(_,T,ht,P,$t,Vt,_e))?(ir||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(_.flags|=4194308)):(typeof X.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=P,_.memoizedState=Vt),X.props=P,X.state=Vt,X.context=_e,P=ht):(typeof X.componentDidMount=="function"&&(_.flags|=4194308),P=!1)}else{X=_.stateNode,of(d,_),_e=_.memoizedProps,ir=Bs(T,_e),X.props=ir,pr=_.pendingProps,$t=X.context,Vt=T.contextType,ht=bc,typeof Vt=="object"&&Vt!==null&&(ht=bo(Vt)),Be=T.getDerivedStateFromProps,(Vt=typeof Be=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(_e!==pr||$t!==ht)&&P_(_,X,P,ht),fs=!1,$t=_.memoizedState,X.state=$t,pu(_,P,X,U),Qh();var er=_.memoizedState;_e!==pr||$t!==er||fs||d!==null&&d.dependencies!==null&&Yd(d.dependencies)?(typeof Be=="function"&&(ig(_,T,Be,P),er=_.memoizedState),(ir=fs||No(_,T,ir,P,$t,er,ht)||d!==null&&d.dependencies!==null&&Yd(d.dependencies))?(Vt||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(P,er,ht),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(P,er,ht)),typeof X.componentDidUpdate=="function"&&(_.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof X.componentDidUpdate!="function"||_e===d.memoizedProps&&$t===d.memoizedState||(_.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||_e===d.memoizedProps&&$t===d.memoizedState||(_.flags|=1024),_.memoizedProps=P,_.memoizedState=er),X.props=P,X.state=er,X.context=ht,P=ir):(typeof X.componentDidUpdate!="function"||_e===d.memoizedProps&&$t===d.memoizedState||(_.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||_e===d.memoizedProps&&$t===d.memoizedState||(_.flags|=1024),P=!1)}return X=P,ch(d,_),P=(_.flags&128)!==0,X||P?(X=_.stateNode,T=P&&typeof T.getDerivedStateFromError!="function"?null:X.render(),_.flags|=1,d!==null&&P?(_.child=Mc(_,d.child,null,U),_.child=Mc(_,null,T,U)):oo(d,_,T,U),_.memoizedState=X.state,d=_.child):d=Kl(d,_,U),d}function pa(d,_,T,P){return Vl(),_.flags|=256,oo(d,_,T,P),_.child}var dd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function uh(d){return{baseLanes:d,cachePool:Wh()}}function mf(d,_,T){return d=d!==null?d.childLanes&~T:0,_&&(d|=Lt),d}function hh(d,_,T){var P=_.pendingProps,U=!1,X=(_.flags&128)!==0,_e;if((_e=X)||(_e=d!==null&&d.memoizedState===null?!1:(Na.current&2)!==0),_e&&(U=!0,_.flags&=-129),_e=(_.flags&32)!==0,_.flags&=-33,d===null){if(ci){if(U?$l(_):Bo(),(d=Fi)?(d=Ow(d,Js),d=d!==null&&d.data!=="&"?d:null,d!==null&&(_.memoizedState={dehydrated:d,treeContext:$n!==null?{id:Ac,overflow:Nl}:null,retryLane:536870912,hydrationErrors:null},T=mv(d),T.return=_,_.child=T,Fa=_,Fi=null)):d=null,d===null)throw Ul(_);return Bx(d)?_.lanes=32:_.lanes=536870912,null}var Be=P.children;return P=P.fallback,U?(Bo(),U=_.mode,Be=_f({mode:"hidden",children:Be},U),P=Zu(P,U,T,null),Be.return=_,P.return=_,Be.sibling=P,_.child=Be,P=_.child,P.memoizedState=uh(T),P.childLanes=mf(d,_e,T),_.memoizedState=dd,hd(null,P)):($l(_),gf(_,Be))}var ht=d.memoizedState;if(ht!==null&&(Be=ht.dehydrated,Be!==null)){if(X)_.flags&256?($l(_),_.flags&=-257,_=fd(d,_,T)):_.memoizedState!==null?(Bo(),_.child=d.child,_.flags|=128,_=null):(Bo(),Be=P.fallback,U=_.mode,P=_f({mode:"visible",children:P.children},U),Be=Zu(Be,U,T,null),Be.flags|=2,P.return=_,Be.return=_,P.sibling=Be,_.child=P,Mc(_,d.child,null,T),P=_.child,P.memoizedState=uh(T),P.childLanes=mf(d,_e,T),_.memoizedState=dd,_=hd(null,P));else if($l(_),Bx(Be)){if(_e=Be.nextSibling&&Be.nextSibling.dataset,_e)var Vt=_e.dgst;_e=Vt,P=Error(l(419)),P.stack="",P.digest=_e,Wd({value:P,source:null,stack:null}),_=fd(d,_,T)}else if(Ea||Ku(d,_,T,!1),_e=(T&d.childLanes)!==0,Ea||_e){if(_e=He,_e!==null&&(P=an(_e,T),P!==0&&P!==ht.retryLane))throw ht.retryLane=P,Gt(d,P),Nr(_e,d,P),Lp;Lx(Be)||so(),_=fd(d,_,T)}else Lx(Be)?(_.flags|=192,_.child=d.child,_=null):(d=ht.treeContext,Fi=kc(Be.nextSibling),Fa=_,ci=!0,Tc=null,Js=!1,d!==null&&Xh(_,d),_=gf(_,P.children),_.flags|=4096);return _}return U?(Bo(),Be=P.fallback,U=_.mode,ht=d.child,Vt=ht.sibling,P=ds(ht,{mode:"hidden",children:P.children}),P.subtreeFlags=ht.subtreeFlags&65011712,Vt!==null?Be=ds(Vt,Be):(Be=Zu(Be,U,T,null),Be.flags|=2),Be.return=_,P.return=_,P.sibling=Be,_.child=P,hd(null,P),P=_.child,Be=d.child.memoizedState,Be===null?Be=uh(T):(U=Be.cachePool,U!==null?(ht=Si._currentValue,U=U.parent!==ht?{parent:ht,pool:ht}:U):U=Wh(),Be={baseLanes:Be.baseLanes|T,cachePool:U}),P.memoizedState=Be,P.childLanes=mf(d,_e,T),_.memoizedState=dd,hd(d.child,P)):($l(_),T=d.child,d=T.sibling,T=ds(T,{mode:"visible",children:P.children}),T.return=_,T.sibling=null,d!==null&&(_e=_.deletions,_e===null?(_.deletions=[d],_.flags|=16):_e.push(d)),_.child=T,_.memoizedState=null,T)}function gf(d,_){return _=_f({mode:"visible",children:_},d.mode),_.return=d,d.child=_}function _f(d,_){return d=hs(22,d,null,_),d.lanes=0,d}function fd(d,_,T){return Mc(_,d.child,null,T),d=gf(_,_.pendingProps.children),d.flags|=2,_.memoizedState=null,d}function dh(d,_,T){d.lanes|=_;var P=d.alternate;P!==null&&(P.lanes|=_),f_(d.return,_,T)}function Fp(d,_,T,P,U,X){var _e=d.memoizedState;_e===null?d.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:P,tail:T,tailMode:U,treeForkCount:X}:(_e.isBackwards=_,_e.rendering=null,_e.renderingStartTime=0,_e.last=P,_e.tail=T,_e.tailMode=U,_e.treeForkCount=X)}function yf(d,_,T){var P=_.pendingProps,U=P.revealOrder,X=P.tail;P=P.children;var _e=Na.current,Be=(_e&2)!==0;if(Be?(_e=_e&1|2,_.flags|=128):_e&=1,Bt(Na,_e),oo(d,_,P,T),P=ci?op:0,!Be&&d!==null&&(d.flags&128)!==0)e:for(d=_.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&dh(d,T,_);else if(d.tag===19)dh(d,T,_);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===_)break e;for(;d.sibling===null;){if(d.return===null||d.return===_)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(U){case"forwards":for(T=_.child,U=null;T!==null;)d=T.alternate,d!==null&&Ic(d)===null&&(U=T),T=T.sibling;T=U,T===null?(U=_.child,_.child=null):(U=T.sibling,T.sibling=null),Fp(_,!1,U,T,X,P);break;case"backwards":case"unstable_legacy-backwards":for(T=null,U=_.child,_.child=null;U!==null;){if(d=U.alternate,d!==null&&Ic(d)===null){_.child=U;break}d=U.sibling,U.sibling=T,T=U,U=d}Fp(_,!0,T,null,X,P);break;case"together":Fp(_,!1,null,null,void 0,P);break;default:_.memoizedState=null}return _.child}function Kl(d,_,T){if(d!==null&&(_.dependencies=d.dependencies),zt|=_.lanes,(T&_.childLanes)===0)if(d!==null){if(Ku(d,_,T,!1),(T&_.childLanes)===0)return null}else return null;if(d!==null&&_.child!==d.child)throw Error(l(153));if(_.child!==null){for(d=_.child,T=ds(d,d.pendingProps),_.child=T,T.return=_;d.sibling!==null;)d=d.sibling,T=T.sibling=ds(d,d.pendingProps),T.return=_;T.sibling=null}return _.child}function pd(d,_){return(d.lanes&_)!==0?!0:(d=d.dependencies,!!(d!==null&&Yd(d)))}function D_(d,_,T){switch(_.tag){case 3:fn(_,_.stateNode.containerInfo),Yu(_,Si,d.memoizedState.cache),Vl();break;case 27:case 5:Mr(_);break;case 4:fn(_,_.stateNode.containerInfo);break;case 10:Yu(_,_.type,_.memoizedProps.value);break;case 31:if(_.memoizedState!==null)return _.flags|=128,rd(_),null;break;case 13:var P=_.memoizedState;if(P!==null)return P.dehydrated!==null?($l(_),_.flags|=128,null):(T&_.child.childLanes)!==0?hh(d,_,T):($l(_),d=Kl(d,_,T),d!==null?d.sibling:null);$l(_);break;case 19:var U=(d.flags&128)!==0;if(P=(T&_.childLanes)!==0,P||(Ku(d,_,T,!1),P=(T&_.childLanes)!==0),U){if(P)return yf(d,_,T);_.flags|=128}if(U=_.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),Bt(Na,Na.current),P)break;return null;case 22:return _.lanes=0,ud(d,_,T,_.pendingProps);case 24:Yu(_,Si,d.memoizedState.cache)}return Kl(d,_,T)}function Np(d,_,T){if(d!==null)if(d.memoizedProps!==_.pendingProps)Ea=!0;else{if(!pd(d,T)&&(_.flags&128)===0)return Ea=!1,D_(d,_,T);Ea=(d.flags&131072)!==0}else Ea=!1,ci&&(_.flags&1048576)!==0&&sp(_,op,_.index);switch(_.lanes=0,_.tag){case 16:e:{var P=_.pendingProps;if(d=Ec(_.elementType),_.type=d,typeof d=="function")nu(d)?(P=Bs(d,P),_.tag=1,_=kp(null,_,d,P,T)):(_.tag=0,_=pf(null,_,d,P,T));else{if(d!=null){var U=d.$$typeof;if(U===ge){_.tag=11,_=tl(null,_,d,P,T);break e}else if(U===ve){_.tag=14,_=Wl(null,_,d,P,T);break e}}throw _=Rt(d)||d,Error(l(306,_,""))}}return _;case 0:return pf(d,_,_.type,_.pendingProps,T);case 1:return P=_.type,U=Bs(P,_.pendingProps),kp(d,_,P,U,T);case 3:e:{if(fn(_,_.stateNode.containerInfo),d===null)throw Error(l(387));P=_.pendingProps;var X=_.memoizedState;U=X.element,of(d,_),pu(_,P,null,T);var _e=_.memoizedState;if(P=_e.cache,Yu(_,Si,P),P!==X.cache&&up(_,[Si],T,!0),Qh(),P=_e.element,X.isDehydrated)if(X={element:P,isDehydrated:!1,cache:_e.cache},_.updateQueue.baseState=X,_.memoizedState=X,_.flags&256){_=pa(d,_,P,T);break e}else if(P!==U){U=ao(Error(l(424)),_),Wd(U),_=pa(d,_,P,T);break e}else for(d=_.stateNode.containerInfo,d.nodeType===9?d=d.body:d=d.nodeName==="HTML"?d.ownerDocument.body:d,Fi=kc(d.firstChild),Fa=_,ci=!0,Tc=null,Js=!0,T=g_(_,null,P,T),_.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Vl(),P===U){_=Kl(d,_,T);break e}oo(d,_,P,T)}_=_.child}return _;case 26:return ch(d,_),d===null?(T=gh(_.type,null,_.pendingProps,null))?_.memoizedState=T:ci||(T=_.type,d=_.pendingProps,P=X_(jr.current).createElement(T),P[ze]=_,P[Ee]=d,ys(P,T,d),fr(P),_.stateNode=P):_.memoizedState=gh(_.type,d.memoizedProps,_.pendingProps,d.memoizedState),null;case 27:return Mr(_),d===null&&ci&&(P=_.stateNode=mg(_.type,_.pendingProps,jr.current),Fa=_,Js=!0,U=Fi,tc(_.type)?(Z_=U,Fi=kc(P.firstChild)):Fi=U),oo(d,_,_.pendingProps.children,T),ch(d,_),d===null&&(_.flags|=4194304),_.child;case 5:return d===null&&ci&&((U=P=Fi)&&(P=AS(P,_.type,_.pendingProps,Js),P!==null?(_.stateNode=P,Fa=_,Fi=kc(P.firstChild),Js=!1,U=!0):U=!1),U||Ul(_)),Mr(_),U=_.type,X=_.pendingProps,_e=d!==null?d.memoizedProps:null,P=X.children,mh(U,X)?P=null:_e!==null&&mh(U,_e)&&(_.flags|=32),_.memoizedState!==null&&(U=ad(d,_,vv,null,null,T),Nc._currentValue=U),ch(d,_),oo(d,_,P,T),_.child;case 6:return d===null&&ci&&((d=T=Fi)&&(T=TS(T,_.pendingProps,Js),T!==null?(_.stateNode=T,Fa=_,Fi=null,d=!0):d=!1),d||Ul(_)),null;case 13:return hh(d,_,T);case 4:return fn(_,_.stateNode.containerInfo),P=_.pendingProps,d===null?_.child=Mc(_,null,P,T):oo(d,_,P,T),_.child;case 11:return tl(d,_,_.type,_.pendingProps,T);case 7:return oo(d,_,_.pendingProps,T),_.child;case 8:return oo(d,_,_.pendingProps.children,T),_.child;case 12:return oo(d,_,_.pendingProps.children,T),_.child;case 10:return P=_.pendingProps,Yu(_,_.type,P.value),oo(d,_,P.children,T),_.child;case 9:return U=_.type._context,P=_.pendingProps.children,lu(_),U=bo(U),P=P(U),_.flags|=1,oo(d,_,P,T),_.child;case 14:return Wl(d,_,_.type,_.pendingProps,T);case 15:return cd(d,_,_.type,_.pendingProps,T);case 19:return yf(d,_,T);case 31:return rl(d,_,T);case 22:return ud(d,_,T,_.pendingProps);case 24:return lu(_),P=bo(Si),d===null?(U=mp(),U===null&&(U=He,X=Qd(),U.pooledCache=X,X.refCount++,X!==null&&(U.pooledCacheLanes|=T),U=X),_.memoizedState={parent:P,cache:U},xp(_),Yu(_,Si,U)):((d.lanes&T)!==0&&(of(d,_),pu(_,null,null,T),Qh()),U=d.memoizedState,X=_.memoizedState,U.parent!==P?(U={parent:P,cache:P},_.memoizedState=U,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=U),Yu(_,Si,P)):(P=X.cache,Yu(_,Si,P),P!==U.cache&&up(_,[Si],T,!0))),oo(d,_,_.pendingProps.children,T),_.child;case 29:throw _.pendingProps}throw Error(l(156,_.tag))}function zc(d){d.flags|=4}function lg(d,_,T,P,U){if((_=(d.mode&32)!==0)&&(_=!1),_){if(d.flags|=16777216,(U&335544128)===U)if(d.stateNode.complete)d.flags|=8192;else if(An())d.flags|=8192;else throw du=_p,p_}else d.flags&=-16777217}function R_(d,_){if(_.type!=="stylesheet"||(_.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!Hx(_))if(An())d.flags|=8192;else throw du=_p,p_}function jp(d,_){_!==null&&(d.flags|=4),d.flags&16384&&(_=d.tag!==22?Xa():536870912,d.lanes|=_,hr|=_)}function vf(d,_){if(!ci)switch(d.tailMode){case"hidden":_=d.tail;for(var T=null;_!==null;)_.alternate!==null&&(T=_),_=_.sibling;T===null?d.tail=null:T.sibling=null;break;case"collapsed":T=d.tail;for(var P=null;T!==null;)T.alternate!==null&&(P=T),T=T.sibling;P===null?_||d.tail===null?d.tail=null:d.tail.sibling=null:P.sibling=null}}function ia(d){var _=d.alternate!==null&&d.alternate.child===d.child,T=0,P=0;if(_)for(var U=d.child;U!==null;)T|=U.lanes|U.childLanes,P|=U.subtreeFlags&65011712,P|=U.flags&65011712,U.return=d,U=U.sibling;else for(U=d.child;U!==null;)T|=U.lanes|U.childLanes,P|=U.subtreeFlags,P|=U.flags,U.return=d,U=U.sibling;return d.subtreeFlags|=P,d.childLanes=T,_}function Up(d,_,T){var P=_.pendingProps;switch(au(_),_.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ia(_),null;case 1:return ia(_),null;case 3:return T=_.stateNode,P=null,d!==null&&(P=d.memoizedState.cache),_.memoizedState.cache!==P&&(_.flags|=2048),su(Si),Xt(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(d===null||d.child===null)&&(ou(_)?zc(_):d===null||d.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,Um())),ia(_),null;case 26:var U=_.type,X=_.memoizedState;return d===null?(zc(_),X!==null?(ia(_),R_(_,X)):(ia(_),lg(_,U,null,P,T))):X?X!==d.memoizedState?(zc(_),ia(_),R_(_,X)):(ia(_),_.flags&=-16777217):(d=d.memoizedProps,d!==P&&zc(_),ia(_),lg(_,U,d,P,T)),null;case 27:if(kr(_),T=jr.current,U=_.type,d!==null&&_.stateNode!=null)d.memoizedProps!==P&&zc(_);else{if(!P){if(_.stateNode===null)throw Error(l(166));return ia(_),null}d=ar.current,ou(_)?cp(_):(d=mg(U,P,T),_.stateNode=d,zc(_))}return ia(_),null;case 5:if(kr(_),U=_.type,d!==null&&_.stateNode!=null)d.memoizedProps!==P&&zc(_);else{if(!P){if(_.stateNode===null)throw Error(l(166));return ia(_),null}if(X=ar.current,ou(_))cp(_);else{var _e=X_(jr.current);switch(X){case 1:X=_e.createElementNS("http://www.w3.org/2000/svg",U);break;case 2:X=_e.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;default:switch(U){case"svg":X=_e.createElementNS("http://www.w3.org/2000/svg",U);break;case"math":X=_e.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;case"script":X=_e.createElement("div"),X.innerHTML="<script><\/script>",X=X.removeChild(X.firstChild);break;case"select":X=typeof P.is=="string"?_e.createElement("select",{is:P.is}):_e.createElement("select"),P.multiple?X.multiple=!0:P.size&&(X.size=P.size);break;default:X=typeof P.is=="string"?_e.createElement(U,{is:P.is}):_e.createElement(U)}}X[ze]=_,X[Ee]=P;e:for(_e=_.child;_e!==null;){if(_e.tag===5||_e.tag===6)X.appendChild(_e.stateNode);else if(_e.tag!==4&&_e.tag!==27&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===_)break e;for(;_e.sibling===null;){if(_e.return===null||_e.return===_)break e;_e=_e.return}_e.sibling.return=_e.return,_e=_e.sibling}_.stateNode=X;e:switch(ys(X,U,P),U){case"button":case"input":case"select":case"textarea":P=!!P.autoFocus;break e;case"img":P=!0;break e;default:P=!1}P&&zc(_)}}return ia(_),lg(_,_.type,d===null?null:d.memoizedProps,_.pendingProps,T),null;case 6:if(d&&_.stateNode!=null)d.memoizedProps!==P&&zc(_);else{if(typeof P!="string"&&_.stateNode===null)throw Error(l(166));if(d=jr.current,ou(_)){if(d=_.stateNode,T=_.memoizedProps,P=null,U=Fa,U!==null)switch(U.tag){case 27:case 5:P=U.memoizedProps}d[ze]=_,d=!!(d.nodeValue===T||P!==null&&P.suppressHydrationWarning===!0||Aw(d.nodeValue,T)),d||Ul(_,!0)}else d=X_(d).createTextNode(P),d[ze]=_,_.stateNode=d}return ia(_),null;case 31:if(T=_.memoizedState,d===null||d.memoizedState!==null){if(P=ou(_),T!==null){if(d===null){if(!P)throw Error(l(318));if(d=_.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(l(557));d[ze]=_}else Vl(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;ia(_),d=!1}else T=Um(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=T),d=!0;if(!d)return _.flags&256?(Rs(_),_):(Rs(_),null);if((_.flags&128)!==0)throw Error(l(558))}return ia(_),null;case 13:if(P=_.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(U=ou(_),P!==null&&P.dehydrated!==null){if(d===null){if(!U)throw Error(l(318));if(U=_.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(l(317));U[ze]=_}else Vl(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;ia(_),U=!1}else U=Um(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=U),U=!0;if(!U)return _.flags&256?(Rs(_),_):(Rs(_),null)}return Rs(_),(_.flags&128)!==0?(_.lanes=T,_):(T=P!==null,d=d!==null&&d.memoizedState!==null,T&&(P=_.child,U=null,P.alternate!==null&&P.alternate.memoizedState!==null&&P.alternate.memoizedState.cachePool!==null&&(U=P.alternate.memoizedState.cachePool.pool),X=null,P.memoizedState!==null&&P.memoizedState.cachePool!==null&&(X=P.memoizedState.cachePool.pool),X!==U&&(P.flags|=2048)),T!==d&&T&&(_.child.flags|=8192),jp(_,_.updateQueue),ia(_),null);case 4:return Xt(),d===null&&Ov(_.stateNode.containerInfo),ia(_),null;case 10:return su(_.type),ia(_),null;case 19:if(gt(Na),P=_.memoizedState,P===null)return ia(_),null;if(U=(_.flags&128)!==0,X=P.rendering,X===null)if(U)vf(P,!1);else{if(bt!==0||d!==null&&(d.flags&128)!==0)for(d=_.child;d!==null;){if(X=Ic(d),X!==null){for(_.flags|=128,vf(P,!1),d=X.updateQueue,_.updateQueue=d,jp(_,d),_.subtreeFlags=0,d=T,T=_.child;T!==null;)iu(T,d),T=T.sibling;return Bt(Na,Na.current&1|2),ci&&jl(_,P.treeForkCount),_.child}d=d.sibling}P.tail!==null&&ni()>Vr&&(_.flags|=128,U=!0,vf(P,!1),_.lanes=4194304)}else{if(!U)if(d=Ic(X),d!==null){if(_.flags|=128,U=!0,d=d.updateQueue,_.updateQueue=d,jp(_,d),vf(P,!0),P.tail===null&&P.tailMode==="hidden"&&!X.alternate&&!ci)return ia(_),null}else 2*ni()-P.renderingStartTime>Vr&&T!==536870912&&(_.flags|=128,U=!0,vf(P,!1),_.lanes=4194304);P.isBackwards?(X.sibling=_.child,_.child=X):(d=P.last,d!==null?d.sibling=X:_.child=X,P.last=X)}return P.tail!==null?(d=P.tail,P.rendering=d,P.tail=d.sibling,P.renderingStartTime=ni(),d.sibling=null,T=Na.current,Bt(Na,U?T&1|2:T&1),ci&&jl(_,P.treeForkCount),d):(ia(_),null);case 22:case 23:return Rs(_),Cc(),P=_.memoizedState!==null,d!==null?d.memoizedState!==null!==P&&(_.flags|=8192):P&&(_.flags|=8192),P?(T&536870912)!==0&&(_.flags&128)===0&&(ia(_),_.subtreeFlags&6&&(_.flags|=8192)):ia(_),T=_.updateQueue,T!==null&&jp(_,T.retryQueue),T=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(T=d.memoizedState.cachePool.pool),P=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(P=_.memoizedState.cachePool.pool),P!==T&&(_.flags|=2048),d!==null&&gt(hu),null;case 24:return T=null,d!==null&&(T=d.memoizedState.cache),_.memoizedState.cache!==T&&(_.flags|=2048),su(Si),ia(_),null;case 25:return null;case 30:return null}throw Error(l(156,_.tag))}function Sv(d,_){switch(au(_),_.tag){case 1:return d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 3:return su(Si),Xt(),d=_.flags,(d&65536)!==0&&(d&128)===0?(_.flags=d&-65537|128,_):null;case 26:case 27:case 5:return kr(_),null;case 31:if(_.memoizedState!==null){if(Rs(_),_.alternate===null)throw Error(l(340));Vl()}return d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 13:if(Rs(_),d=_.memoizedState,d!==null&&d.dehydrated!==null){if(_.alternate===null)throw Error(l(340));Vl()}return d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 19:return gt(Na),null;case 4:return Xt(),null;case 10:return su(_.type),null;case 22:case 23:return Rs(_),Cc(),d!==null&&gt(hu),d=_.flags,d&65536?(_.flags=d&-65537|128,_):null;case 24:return su(Si),null;case 25:return null;default:return null}}function z_(d,_){switch(au(_),_.tag){case 3:su(Si),Xt();break;case 26:case 27:case 5:kr(_);break;case 4:Xt();break;case 31:_.memoizedState!==null&&Rs(_);break;case 13:Rs(_);break;case 19:gt(Na);break;case 10:su(_.type);break;case 22:case 23:Rs(_),Cc(),d!==null&&gt(hu);break;case 24:su(Si)}}function yu(d,_){try{var T=_.updateQueue,P=T!==null?T.lastEffect:null;if(P!==null){var U=P.next;T=U;do{if((T.tag&d)===d){P=void 0;var X=T.create,_e=T.inst;P=X(),_e.destroy=P}T=T.next}while(T!==U)}}catch(Be){oi(_,_.return,Be)}}function vu(d,_,T){try{var P=_.updateQueue,U=P!==null?P.lastEffect:null;if(U!==null){var X=U.next;P=X;do{if((P.tag&d)===d){var _e=P.inst,Be=_e.destroy;if(Be!==void 0){_e.destroy=void 0,U=_;var ht=T,Vt=Be;try{Vt()}catch(ir){oi(U,ht,ir)}}}P=P.next}while(P!==X)}}catch(ir){oi(_,_.return,ir)}}function cg(d){var _=d.updateQueue;if(_!==null){var T=d.stateNode;try{yv(_,T)}catch(P){oi(d,d.return,P)}}}function L_(d,_,T){T.props=Bs(d.type,d.memoizedProps),T.state=d.memoizedState;try{T.componentWillUnmount()}catch(P){oi(d,_,P)}}function xf(d,_){try{var T=d.ref;if(T!==null){switch(d.tag){case 26:case 27:case 5:var P=d.stateNode;break;case 30:P=d.stateNode;break;default:P=d.stateNode}typeof T=="function"?d.refCleanup=T(P):T.current=P}}catch(U){oi(d,_,U)}}function Ql(d,_){var T=d.ref,P=d.refCleanup;if(T!==null)if(typeof P=="function")try{P()}catch(U){oi(d,_,U)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof T=="function")try{T(null)}catch(U){oi(d,_,U)}else T.current=null}function B_(d){var _=d.type,T=d.memoizedProps,P=d.stateNode;try{e:switch(_){case"button":case"input":case"select":case"textarea":T.autoFocus&&P.focus();break e;case"img":T.src?P.src=T.src:T.srcSet&&(P.srcset=T.srcSet)}}catch(U){oi(d,d.return,U)}}function ui(d,_,T){try{var P=d.stateNode;Tw(P,d.type,T,_),P[Ee]=_}catch(U){oi(d,d.return,U)}}function k_(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&tc(d.type)||d.tag===4}function ug(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||k_(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&tc(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function F_(d,_,T){var P=d.tag;if(P===5||P===6)d=d.stateNode,_?(T.nodeType===9?T.body:T.nodeName==="HTML"?T.ownerDocument.body:T).insertBefore(d,_):(_=T.nodeType===9?T.body:T.nodeName==="HTML"?T.ownerDocument.body:T,_.appendChild(d),T=T._reactRootContainer,T!=null||_.onclick!==null||(_.onclick=ka));else if(P!==4&&(P===27&&tc(d.type)&&(T=d.stateNode,_=null),d=d.child,d!==null))for(F_(d,_,T),d=d.sibling;d!==null;)F_(d,_,T),d=d.sibling}function hg(d,_,T){var P=d.tag;if(P===5||P===6)d=d.stateNode,_?T.insertBefore(d,_):T.appendChild(d);else if(P!==4&&(P===27&&tc(d.type)&&(T=d.stateNode),d=d.child,d!==null))for(hg(d,_,T),d=d.sibling;d!==null;)hg(d,_,T),d=d.sibling}function bf(d){var _=d.stateNode,T=d.memoizedProps;try{for(var P=d.type,U=_.attributes;U.length;)_.removeAttributeNode(U[0]);ys(_,P,T),_[ze]=d,_[Ee]=T}catch(X){oi(d,d.return,X)}}var Lc=!1,Ma=!1,md=!1,wl=typeof WeakSet=="function"?WeakSet:Set,Ui=null;function aa(d,_){if(d=d.containerInfo,Iv=ty,d=hv(d),Vh(d)){if("selectionStart"in d)var T={start:d.selectionStart,end:d.selectionEnd};else e:{T=(T=d.ownerDocument)&&T.defaultView||window;var P=T.getSelection&&T.getSelection();if(P&&P.rangeCount!==0){T=P.anchorNode;var U=P.anchorOffset,X=P.focusNode;P=P.focusOffset;try{T.nodeType,X.nodeType}catch{T=null;break e}var _e=0,Be=-1,ht=-1,Vt=0,ir=0,pr=d,$t=null;t:for(;;){for(var er;pr!==T||U!==0&&pr.nodeType!==3||(Be=_e+U),pr!==X||P!==0&&pr.nodeType!==3||(ht=_e+P),pr.nodeType===3&&(_e+=pr.nodeValue.length),(er=pr.firstChild)!==null;)$t=pr,pr=er;for(;;){if(pr===d)break t;if($t===T&&++Vt===U&&(Be=_e),$t===X&&++ir===P&&(ht=_e),(er=pr.nextSibling)!==null)break;pr=$t,$t=pr.parentNode}pr=er}T=Be===-1||ht===-1?null:{start:Be,end:ht}}else T=null}T=T||{start:0,end:0}}else T=null;for(Pv={focusedElem:d,selectionRange:T},ty=!1,Ui=_;Ui!==null;)if(_=Ui,d=_.child,(_.subtreeFlags&1028)!==0&&d!==null)d.return=_,Ui=d;else for(;Ui!==null;){switch(_=Ui,X=_.alternate,d=_.flags,_.tag){case 0:if((d&4)!==0&&(d=_.updateQueue,d=d!==null?d.events:null,d!==null))for(T=0;T<d.length;T++)U=d[T],U.ref.impl=U.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&X!==null){d=void 0,T=_,U=X.memoizedProps,X=X.memoizedState,P=T.stateNode;try{var Hr=Bs(T.type,U);d=P.getSnapshotBeforeUpdate(Hr,X),P.__reactInternalSnapshotBeforeUpdate=d}catch(cn){oi(T,T.return,cn)}}break;case 3:if((d&1024)!==0){if(d=_.stateNode.containerInfo,T=d.nodeType,T===9)Gp(d);else if(T===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":Gp(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(l(163))}if(d=_.sibling,d!==null){d.return=_.return,Ui=d;break}Ui=_.return}}function ks(d,_,T){var P=T.flags;switch(T.tag){case 0:case 11:case 15:D(d,T),P&4&&yu(5,T);break;case 1:if(D(d,T),P&4)if(d=T.stateNode,_===null)try{d.componentDidMount()}catch(_e){oi(T,T.return,_e)}else{var U=Bs(T.type,_.memoizedProps);_=_.memoizedState;try{d.componentDidUpdate(U,_,d.__reactInternalSnapshotBeforeUpdate)}catch(_e){oi(T,T.return,_e)}}P&64&&cg(T),P&512&&xf(T,T.return);break;case 3:if(D(d,T),P&64&&(d=T.updateQueue,d!==null)){if(_=null,T.child!==null)switch(T.child.tag){case 27:case 5:_=T.child.stateNode;break;case 1:_=T.child.stateNode}try{yv(d,_)}catch(_e){oi(T,T.return,_e)}}break;case 27:_===null&&P&4&&bf(T);case 26:case 5:D(d,T),_===null&&P&4&&B_(T),P&512&&xf(T,T.return);break;case 12:D(d,T);break;case 31:D(d,T),P&4&&Sx(d,T);break;case 13:D(d,T),P&4&&p(d,T),P&64&&(d=T.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(T=mw.bind(null,T),SS(d,T))));break;case 22:if(P=T.memoizedState!==null||Lc,!P){_=_!==null&&_.memoizedState!==null||Ma,U=Lc;var X=Ma;Lc=P,(Ma=_)&&!X?N(d,T,(T.subtreeFlags&8772)!==0):D(d,T),Lc=U,Ma=X}break;case 30:break;default:D(d,T)}}function wf(d){var _=d.alternate;_!==null&&(d.alternate=null,wf(_)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(_=d.stateNode,_!==null&&Wt(_)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Qi=null,ps=!1;function xu(d,_,T){for(T=T.child;T!==null;)gd(d,_,T),T=T.sibling}function gd(d,_,T){if(Ci&&typeof Ci.onCommitFiberUnmount=="function")try{Ci.onCommitFiberUnmount(Cs,T)}catch{}switch(T.tag){case 26:Ma||Ql(T,_),xu(d,_,T),T.memoizedState?T.memoizedState.count--:T.stateNode&&(T=T.stateNode,T.parentNode.removeChild(T));break;case 27:Ma||Ql(T,_);var P=Qi,U=ps;tc(T.type)&&(Qi=T.stateNode,ps=!1),xu(d,_,T),W_(T.stateNode),Qi=P,ps=U;break;case 5:Ma||Ql(T,_);case 6:if(P=Qi,U=ps,Qi=null,xu(d,_,T),Qi=P,ps=U,Qi!==null)if(ps)try{(Qi.nodeType===9?Qi.body:Qi.nodeName==="HTML"?Qi.ownerDocument.body:Qi).removeChild(T.stateNode)}catch(X){oi(T,_,X)}else try{Qi.removeChild(T.stateNode)}catch(X){oi(T,_,X)}break;case 18:Qi!==null&&(ps?(d=Qi,zx(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,T.stateNode),bg(d)):zx(Qi,T.stateNode));break;case 4:P=Qi,U=ps,Qi=T.stateNode.containerInfo,ps=!0,xu(d,_,T),Qi=P,ps=U;break;case 0:case 11:case 14:case 15:vu(2,T,_),Ma||vu(4,T,_),xu(d,_,T);break;case 1:Ma||(Ql(T,_),P=T.stateNode,typeof P.componentWillUnmount=="function"&&L_(T,_,P)),xu(d,_,T);break;case 21:xu(d,_,T);break;case 22:Ma=(P=Ma)||T.memoizedState!==null,xu(d,_,T),Ma=P;break;default:xu(d,_,T)}}function Sx(d,_){if(_.memoizedState===null&&(d=_.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{bg(d)}catch(T){oi(_,_.return,T)}}}function p(d,_){if(_.memoizedState===null&&(d=_.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{bg(d)}catch(T){oi(_,_.return,T)}}function n(d){switch(d.tag){case 31:case 13:case 19:var _=d.stateNode;return _===null&&(_=d.stateNode=new wl),_;case 22:return d=d.stateNode,_=d._retryCache,_===null&&(_=d._retryCache=new wl),_;default:throw Error(l(435,d.tag))}}function u(d,_){var T=n(d);_.forEach(function(P){if(!T.has(P)){T.add(P);var U=gw.bind(null,d,P);P.then(U,U)}})}function m(d,_){var T=_.deletions;if(T!==null)for(var P=0;P<T.length;P++){var U=T[P],X=d,_e=_,Be=_e;e:for(;Be!==null;){switch(Be.tag){case 27:if(tc(Be.type)){Qi=Be.stateNode,ps=!1;break e}break;case 5:Qi=Be.stateNode,ps=!1;break e;case 3:case 4:Qi=Be.stateNode.containerInfo,ps=!0;break e}Be=Be.return}if(Qi===null)throw Error(l(160));gd(X,_e,U),Qi=null,ps=!1,X=U.alternate,X!==null&&(X.return=null),U.return=null}if(_.subtreeFlags&13886)for(_=_.child;_!==null;)A(_,d),_=_.sibling}var x=null;function A(d,_){var T=d.alternate,P=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:m(_,d),S(d),P&4&&(vu(3,d,d.return),yu(3,d),vu(5,d,d.return));break;case 1:m(_,d),S(d),P&512&&(Ma||T===null||Ql(T,T.return)),P&64&&Lc&&(d=d.updateQueue,d!==null&&(P=d.callbacks,P!==null&&(T=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=T===null?P:T.concat(P))));break;case 26:var U=x;if(m(_,d),S(d),P&512&&(Ma||T===null||Ql(T,T.return)),P&4){var X=T!==null?T.memoizedState:null;if(P=d.memoizedState,T===null)if(P===null)if(d.stateNode===null){e:{P=d.type,T=d.memoizedProps,U=U.ownerDocument||U;t:switch(P){case"title":X=U.getElementsByTagName("title")[0],(!X||X[vt]||X[ze]||X.namespaceURI==="http://www.w3.org/2000/svg"||X.hasAttribute("itemprop"))&&(X=U.createElement(P),U.head.insertBefore(X,U.querySelector("head > title"))),ys(X,P,T),X[ze]=d,fr(X),P=X;break e;case"link":var _e=Xp("link","href",U).get(P+(T.href||""));if(_e){for(var Be=0;Be<_e.length;Be++)if(X=_e[Be],X.getAttribute("href")===(T.href==null||T.href===""?null:T.href)&&X.getAttribute("rel")===(T.rel==null?null:T.rel)&&X.getAttribute("title")===(T.title==null?null:T.title)&&X.getAttribute("crossorigin")===(T.crossOrigin==null?null:T.crossOrigin)){_e.splice(Be,1);break t}}X=U.createElement(P),ys(X,P,T),U.head.appendChild(X);break;case"meta":if(_e=Xp("meta","content",U).get(P+(T.content||""))){for(Be=0;Be<_e.length;Be++)if(X=_e[Be],X.getAttribute("content")===(T.content==null?null:""+T.content)&&X.getAttribute("name")===(T.name==null?null:T.name)&&X.getAttribute("property")===(T.property==null?null:T.property)&&X.getAttribute("http-equiv")===(T.httpEquiv==null?null:T.httpEquiv)&&X.getAttribute("charset")===(T.charSet==null?null:T.charSet)){_e.splice(Be,1);break t}}X=U.createElement(P),ys(X,P,T),U.head.appendChild(X);break;default:throw Error(l(468,P))}X[ze]=d,fr(X),P=X}d.stateNode=P}else qx(U,d.type,d.stateNode);else d.stateNode=Gx(U,P,d.memoizedProps);else X!==P?(X===null?T.stateNode!==null&&(T=T.stateNode,T.parentNode.removeChild(T)):X.count--,P===null?qx(U,d.type,d.stateNode):Gx(U,P,d.memoizedProps)):P===null&&d.stateNode!==null&&ui(d,d.memoizedProps,T.memoizedProps)}break;case 27:m(_,d),S(d),P&512&&(Ma||T===null||Ql(T,T.return)),T!==null&&P&4&&ui(d,d.memoizedProps,T.memoizedProps);break;case 5:if(m(_,d),S(d),P&512&&(Ma||T===null||Ql(T,T.return)),d.flags&32){U=d.stateNode;try{_c(U,"")}catch(Hr){oi(d,d.return,Hr)}}P&4&&d.stateNode!=null&&(U=d.memoizedProps,ui(d,U,T!==null?T.memoizedProps:U)),P&1024&&(md=!0);break;case 6:if(m(_,d),S(d),P&4){if(d.stateNode===null)throw Error(l(162));P=d.memoizedProps,T=d.stateNode;try{T.nodeValue=P}catch(Hr){oi(d,d.return,Hr)}}break;case 3:if(If=null,U=x,x=Y_(_.containerInfo),m(_,d),x=U,S(d),P&4&&T!==null&&T.memoizedState.isDehydrated)try{bg(_.containerInfo)}catch(Hr){oi(d,d.return,Hr)}md&&(md=!1,O(d));break;case 4:P=x,x=Y_(d.stateNode.containerInfo),m(_,d),S(d),x=P;break;case 12:m(_,d),S(d);break;case 31:m(_,d),S(d),P&4&&(P=d.updateQueue,P!==null&&(d.updateQueue=null,u(d,P)));break;case 13:m(_,d),S(d),d.child.flags&8192&&d.memoizedState!==null!=(T!==null&&T.memoizedState!==null)&&(xr=ni()),P&4&&(P=d.updateQueue,P!==null&&(d.updateQueue=null,u(d,P)));break;case 22:U=d.memoizedState!==null;var ht=T!==null&&T.memoizedState!==null,Vt=Lc,ir=Ma;if(Lc=Vt||U,Ma=ir||ht,m(_,d),Ma=ir,Lc=Vt,S(d),P&8192)e:for(_=d.stateNode,_._visibility=U?_._visibility&-2:_._visibility|1,U&&(T===null||ht||Lc||Ma||F(d)),T=null,_=d;;){if(_.tag===5||_.tag===26){if(T===null){ht=T=_;try{if(X=ht.stateNode,U)_e=X.style,typeof _e.setProperty=="function"?_e.setProperty("display","none","important"):_e.display="none";else{Be=ht.stateNode;var pr=ht.memoizedProps.style,$t=pr!=null&&pr.hasOwnProperty("display")?pr.display:null;Be.style.display=$t==null||typeof $t=="boolean"?"":(""+$t).trim()}}catch(Hr){oi(ht,ht.return,Hr)}}}else if(_.tag===6){if(T===null){ht=_;try{ht.stateNode.nodeValue=U?"":ht.memoizedProps}catch(Hr){oi(ht,ht.return,Hr)}}}else if(_.tag===18){if(T===null){ht=_;try{var er=ht.stateNode;U?Of(er,!0):Of(ht.stateNode,!1)}catch(Hr){oi(ht,ht.return,Hr)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===d)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break e;for(;_.sibling===null;){if(_.return===null||_.return===d)break e;T===_&&(T=null),_=_.return}T===_&&(T=null),_.sibling.return=_.return,_=_.sibling}P&4&&(P=d.updateQueue,P!==null&&(T=P.retryQueue,T!==null&&(P.retryQueue=null,u(d,T))));break;case 19:m(_,d),S(d),P&4&&(P=d.updateQueue,P!==null&&(d.updateQueue=null,u(d,P)));break;case 30:break;case 21:break;default:m(_,d),S(d)}}function S(d){var _=d.flags;if(_&2){try{for(var T,P=d.return;P!==null;){if(k_(P)){T=P;break}P=P.return}if(T==null)throw Error(l(160));switch(T.tag){case 27:var U=T.stateNode,X=ug(d);hg(d,X,U);break;case 5:var _e=T.stateNode;T.flags&32&&(_c(_e,""),T.flags&=-33);var Be=ug(d);hg(d,Be,_e);break;case 3:case 4:var ht=T.stateNode.containerInfo,Vt=ug(d);F_(d,Vt,ht);break;default:throw Error(l(161))}}catch(ir){oi(d,d.return,ir)}d.flags&=-3}_&4096&&(d.flags&=-4097)}function O(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var _=d;O(_),_.tag===5&&_.flags&1024&&_.stateNode.reset(),d=d.sibling}}function D(d,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)ks(d,_.alternate,_),_=_.sibling}function F(d){for(d=d.child;d!==null;){var _=d;switch(_.tag){case 0:case 11:case 14:case 15:vu(4,_,_.return),F(_);break;case 1:Ql(_,_.return);var T=_.stateNode;typeof T.componentWillUnmount=="function"&&L_(_,_.return,T),F(_);break;case 27:W_(_.stateNode);case 26:case 5:Ql(_,_.return),F(_);break;case 22:_.memoizedState===null&&F(_);break;case 30:F(_);break;default:F(_)}d=d.sibling}}function N(d,_,T){for(T=T&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var P=_.alternate,U=d,X=_,_e=X.flags;switch(X.tag){case 0:case 11:case 15:N(U,X,T),yu(4,X);break;case 1:if(N(U,X,T),P=X,U=P.stateNode,typeof U.componentDidMount=="function")try{U.componentDidMount()}catch(Vt){oi(P,P.return,Vt)}if(P=X,U=P.updateQueue,U!==null){var Be=P.stateNode;try{var ht=U.shared.hiddenCallbacks;if(ht!==null)for(U.shared.hiddenCallbacks=null,U=0;U<ht.length;U++)Jh(ht[U],Be)}catch(Vt){oi(P,P.return,Vt)}}T&&_e&64&&cg(X),xf(X,X.return);break;case 27:bf(X);case 26:case 5:N(U,X,T),T&&P===null&&_e&4&&B_(X),xf(X,X.return);break;case 12:N(U,X,T);break;case 31:N(U,X,T),T&&_e&4&&Sx(U,X);break;case 13:N(U,X,T),T&&_e&4&&p(U,X);break;case 22:X.memoizedState===null&&N(U,X,T),xf(X,X.return);break;case 30:break;default:N(U,X,T)}_=_.sibling}}function Z(d,_){var T=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(T=d.memoizedState.cachePool.pool),d=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(d=_.memoizedState.cachePool.pool),d!==T&&(d!=null&&d.refCount++,T!=null&&cu(T))}function $(d,_){d=null,_.alternate!==null&&(d=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==d&&(_.refCount++,d!=null&&cu(d))}function W(d,_,T,P){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)ne(d,_,T,P),_=_.sibling}function ne(d,_,T,P){var U=_.flags;switch(_.tag){case 0:case 11:case 15:W(d,_,T,P),U&2048&&yu(9,_);break;case 1:W(d,_,T,P);break;case 3:W(d,_,T,P),U&2048&&(d=null,_.alternate!==null&&(d=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==d&&(_.refCount++,d!=null&&cu(d)));break;case 12:if(U&2048){W(d,_,T,P),d=_.stateNode;try{var X=_.memoizedProps,_e=X.id,Be=X.onPostCommit;typeof Be=="function"&&Be(_e,_.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(ht){oi(_,_.return,ht)}}else W(d,_,T,P);break;case 31:W(d,_,T,P);break;case 13:W(d,_,T,P);break;case 23:break;case 22:X=_.stateNode,_e=_.alternate,_.memoizedState!==null?X._visibility&2?W(d,_,T,P):ae(d,_):X._visibility&2?W(d,_,T,P):(X._visibility|=2,te(d,_,T,P,(_.subtreeFlags&10256)!==0||!1)),U&2048&&Z(_e,_);break;case 24:W(d,_,T,P),U&2048&&$(_.alternate,_);break;default:W(d,_,T,P)}}function te(d,_,T,P,U){for(U=U&&((_.subtreeFlags&10256)!==0||!1),_=_.child;_!==null;){var X=d,_e=_,Be=T,ht=P,Vt=_e.flags;switch(_e.tag){case 0:case 11:case 15:te(X,_e,Be,ht,U),yu(8,_e);break;case 23:break;case 22:var ir=_e.stateNode;_e.memoizedState!==null?ir._visibility&2?te(X,_e,Be,ht,U):ae(X,_e):(ir._visibility|=2,te(X,_e,Be,ht,U)),U&&Vt&2048&&Z(_e.alternate,_e);break;case 24:te(X,_e,Be,ht,U),U&&Vt&2048&&$(_e.alternate,_e);break;default:te(X,_e,Be,ht,U)}_=_.sibling}}function ae(d,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var T=d,P=_,U=P.flags;switch(P.tag){case 22:ae(T,P),U&2048&&Z(P.alternate,P);break;case 24:ae(T,P),U&2048&&$(P.alternate,P);break;default:ae(T,P)}_=_.sibling}}var le=8192;function be(d,_,T){if(d.subtreeFlags&le)for(d=d.child;d!==null;)xe(d,_,T),d=d.sibling}function xe(d,_,T){switch(d.tag){case 26:be(d,_,T),d.flags&le&&d.memoizedState!==null&&il(T,x,d.memoizedState,d.memoizedProps);break;case 5:be(d,_,T);break;case 3:case 4:var P=x;x=Y_(d.stateNode.containerInfo),be(d,_,T),x=P;break;case 22:d.memoizedState===null&&(P=d.alternate,P!==null&&P.memoizedState!==null?(P=le,le=16777216,be(d,_,T),le=P):be(d,_,T));break;default:be(d,_,T)}}function ye(d){var _=d.alternate;if(_!==null&&(d=_.child,d!==null)){_.child=null;do _=d.sibling,d.sibling=null,d=_;while(d!==null)}}function Re(d){var _=d.deletions;if((d.flags&16)!==0){if(_!==null)for(var T=0;T<_.length;T++){var P=_[T];Ui=P,Me(P,d)}ye(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Ce(d),d=d.sibling}function Ce(d){switch(d.tag){case 0:case 11:case 15:Re(d),d.flags&2048&&vu(9,d,d.return);break;case 3:Re(d);break;case 12:Re(d);break;case 22:var _=d.stateNode;d.memoizedState!==null&&_._visibility&2&&(d.return===null||d.return.tag!==13)?(_._visibility&=-3,De(d)):Re(d);break;default:Re(d)}}function De(d){var _=d.deletions;if((d.flags&16)!==0){if(_!==null)for(var T=0;T<_.length;T++){var P=_[T];Ui=P,Me(P,d)}ye(d)}for(d=d.child;d!==null;){switch(_=d,_.tag){case 0:case 11:case 15:vu(8,_,_.return),De(_);break;case 22:T=_.stateNode,T._visibility&2&&(T._visibility&=-3,De(_));break;default:De(_)}d=d.sibling}}function Me(d,_){for(;Ui!==null;){var T=Ui;switch(T.tag){case 0:case 11:case 15:vu(8,T,_);break;case 23:case 22:if(T.memoizedState!==null&&T.memoizedState.cachePool!==null){var P=T.memoizedState.cachePool.pool;P!=null&&P.refCount++}break;case 24:cu(T.memoizedState.cache)}if(P=T.child,P!==null)P.return=T,Ui=P;else e:for(T=d;Ui!==null;){P=Ui;var U=P.sibling,X=P.return;if(wf(P),P===T){Ui=null;break e}if(U!==null){U.return=X,Ui=U;break e}Ui=X}}}var Te={getCacheForType:function(d){var _=bo(Si),T=_.data.get(d);return T===void 0&&(T=d(),_.data.set(d,T)),T},cacheSignal:function(){return bo(Si).controller.signal}},Ne=typeof WeakMap=="function"?WeakMap:Map,Ve=0,He=null,Qe=null,We=0,ut=0,wt=null,et=!1,je=!1,mt=!1,ot=0,bt=0,zt=0,qt=0,kt=0,Lt=0,hr=0,sr=null,Zt=null,lr=!1,xr=0,Ir=0,Vr=1/0,tn=null,Pr=null,Gr=0,Lr=null,yn=null,hn=0,Pn=0,ln=null,$r=null,mn=0,hi=null;function Dn(){return(Ve&2)!==0&&We!==0?We&-We:$e.T!==null?U_():ie()}function wn(){if(Lt===0)if((We&536870912)===0||ci){var d=_a;_a<<=1,(_a&3932160)===0&&(_a=262144),Lt=d}else Lt=536870912;return d=Lo.current,d!==null&&(d.flags|=32),Lt}function Nr(d,_,T){(d===He&&(ut===2||ut===9)||d.cancelPendingCommit!==null)&&(Ka(d,0),kn(d,We,Lt,!1)),Jr(d,T),((Ve&2)===0||d!==He)&&(d===He&&((Ve&2)===0&&(qt|=T),bt===4&&kn(d,We,Lt,!1)),fh(d))}function qr(d,_,T){if((Ve&6)!==0)throw Error(l(327));var P=!T&&(_&127)===0&&(_&d.expiredLanes)===0||as(d,_),U=P?xi(d,_):Fs(d,_,!0),X=P;do{if(U===0){je&&!P&&kn(d,_,0,!1);break}else{if(T=d.current.alternate,X&&!Ii(T)){U=Fs(d,_,!1),X=!1;continue}if(U===2){if(X=_,d.errorRecoveryDisabledLanes&X)var _e=0;else _e=d.pendingLanes&-536870913,_e=_e!==0?_e:_e&536870912?536870912:0;if(_e!==0){_=_e;e:{var Be=d;U=sr;var ht=Be.current.memoizedState.isDehydrated;if(ht&&(Ka(Be,_e).flags|=256),_e=Fs(Be,_e,!1),_e!==2){if(mt&&!ht){Be.errorRecoveryDisabledLanes|=X,qt|=X,U=4;break e}X=Zt,Zt=U,X!==null&&(Zt===null?Zt=X:Zt.push.apply(Zt,X))}U=_e}if(X=!1,U!==2)continue}}if(U===1){Ka(d,0),kn(d,_,0,!0);break}e:{switch(P=d,X=U,X){case 0:case 1:throw Error(l(345));case 4:if((_&4194048)!==_)break;case 6:kn(P,_,Lt,!et);break e;case 2:Zt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((_&62914560)===_&&(U=xr+300-ni(),10<U)){if(kn(P,_,Lt,!et),Bi(P,0,!0)!==0)break e;hn=_,P.timeoutHandle=pg(Kn.bind(null,P,T,Zt,tn,lr,_,Lt,qt,hr,et,X,"Throttled",-0,0),U);break e}Kn(P,T,Zt,tn,lr,_,Lt,qt,hr,et,X,null,-0,0)}}break}while(!0);fh(d)}function Kn(d,_,T,P,U,X,_e,Be,ht,Vt,ir,pr,$t,er){if(d.timeoutHandle=-1,pr=_.subtreeFlags,pr&8192||(pr&16785408)===16785408){pr={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ka},xe(_,X,pr);var Hr=(X&62914560)===X?xr-ni():(X&4194048)===X?Ir-ni():0;if(Hr=Rw(pr,Hr),Hr!==null){hn=X,d.cancelPendingCommit=Hr(Af.bind(null,d,_,X,T,P,U,_e,Be,ht,ir,pr,null,$t,er)),kn(d,X,_e,!Vt);return}}Af(d,_,X,T,P,U,_e,Be,ht)}function Ii(d){for(var _=d;;){var T=_.tag;if((T===0||T===11||T===15)&&_.flags&16384&&(T=_.updateQueue,T!==null&&(T=T.stores,T!==null)))for(var P=0;P<T.length;P++){var U=T[P],X=U.getSnapshot;U=U.value;try{if(!us(X(),U))return!1}catch{return!1}}if(T=_.child,_.subtreeFlags&16384&&T!==null)T.return=_,_=T;else{if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function kn(d,_,T,P){_&=~kt,_&=~qt,d.suspendedLanes|=_,d.pingedLanes&=~_,P&&(d.warmLanes|=_),P=d.expirationTimes;for(var U=_;0<U;){var X=31-qi(U),_e=1<<X;P[X]=-1,U&=~_e}T!==0&&Or(d,T,_)}function Qn(){return(Ve&6)===0?(Ef(0),!1):!0}function Ao(){if(Qe!==null){if(ut===0)var d=Qe.return;else d=Qe,Sc=vl=null,Ap(d),eh=null,af=0,d=Qe;for(;d!==null;)z_(d.alternate,d),d=d.return;Qe=null}}function Ka(d,_){var T=d.timeoutHandle;T!==-1&&(d.timeoutHandle=-1,xS(T)),T=d.cancelPendingCommit,T!==null&&(d.cancelPendingCommit=null,T()),hn=0,Ao(),He=d,Qe=T=ds(d.current,null),We=_,ut=0,wt=null,et=!1,je=as(d,_),mt=!1,hr=Lt=kt=qt=zt=bt=0,Zt=sr=null,lr=!1,(_&8)!==0&&(_|=_&32);var P=d.entangledLanes;if(P!==0)for(d=d.entanglements,P&=_;0<P;){var U=31-qi(P),X=1<<U;_|=d[U],P&=~X}return ot=_,$h(),T}function Oa(d,_){jt=null,$e.H=Xl,_===nf||_===gp?(_=m_(),ut=3):_===p_?(_=m_(),ut=4):ut=_===Lp?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,wt=_,Qe===null&&(bt=1,zp(d,ao(_,d.current)))}function An(){var d=Lo.current;return d===null?!0:(We&4194048)===We?wo===null:(We&62914560)===We||(We&536870912)!==0?d===wo:!1}function ms(){var d=$e.H;return $e.H=Xl,d===null?Xl:d}function Qa(){var d=$e.A;return $e.A=Te,d}function so(){bt=4,et||(We&4194048)!==We&&Lo.current!==null||(je=!0),(zt&134217727)===0&&(qt&134217727)===0||He===null||kn(He,We,Lt,!1)}function Fs(d,_,T){var P=Ve;Ve|=2;var U=ms(),X=Qa();(He!==d||We!==_)&&(tn=null,Ka(d,_)),_=!1;var _e=bt;e:do try{if(ut!==0&&Qe!==null){var Be=Qe,ht=wt;switch(ut){case 8:Ao(),_e=6;break e;case 3:case 2:case 9:case 6:Lo.current===null&&(_=!0);var Vt=ut;if(ut=0,wt=null,ba(d,Be,ht,Vt),T&&je){_e=0;break e}break;default:Vt=ut,ut=0,wt=null,ba(d,Be,ht,Vt)}}Jo(),_e=bt;break}catch(ir){Oa(d,ir)}while(!0);return _&&d.shellSuspendCounter++,Sc=vl=null,Ve=P,$e.H=U,$e.A=X,Qe===null&&(He=null,We=0,$h()),_e}function Jo(){for(;Qe!==null;)ri(Qe)}function xi(d,_){var T=Ve;Ve|=2;var P=ms(),U=Qa();He!==d||We!==_?(tn=null,Vr=ni()+500,Ka(d,_)):je=as(d,_);e:do try{if(ut!==0&&Qe!==null){_=Qe;var X=wt;t:switch(ut){case 1:ut=0,wt=null,ba(d,_,X,1);break;case 2:case 9:if(yp(X)){ut=0,wt=null,Ji(_);break}_=function(){ut!==2&&ut!==9||He!==d||(ut=7),fh(d)},X.then(_,_);break e;case 3:ut=7;break e;case 4:ut=5;break e;case 7:yp(X)?(ut=0,wt=null,Ji(_)):(ut=0,wt=null,ba(d,_,X,7));break;case 5:var _e=null;switch(Qe.tag){case 26:_e=Qe.memoizedState;case 5:case 27:var Be=Qe;if(_e?Hx(_e):Be.stateNode.complete){ut=0,wt=null;var ht=Be.sibling;if(ht!==null)Qe=ht;else{var Vt=Be.return;Vt!==null?(Qe=Vt,Ei(Vt)):Qe=null}break t}}ut=0,wt=null,ba(d,_,X,5);break;case 6:ut=0,wt=null,ba(d,_,X,6);break;case 8:Ao(),bt=6;break e;default:throw Error(l(462))}}Hi();break}catch(ir){Oa(d,ir)}while(!0);return Sc=vl=null,$e.H=P,$e.A=U,Ve=T,Qe!==null?0:(He=null,We=0,$h(),bt)}function Hi(){for(;Qe!==null&&!ha();)ri(Qe)}function ri(d){var _=Np(d.alternate,d,ot);d.memoizedProps=d.pendingProps,_===null?Ei(d):Qe=_}function Ji(d){var _=d,T=_.alternate;switch(_.tag){case 15:case 0:_=Bp(T,_,_.pendingProps,_.type,void 0,We);break;case 11:_=Bp(T,_,_.pendingProps,_.type.render,_.ref,We);break;case 5:Ap(_);default:z_(T,_),_=Qe=iu(_,ot),_=Np(T,_,ot)}d.memoizedProps=d.pendingProps,_===null?Ei(d):Qe=_}function ba(d,_,T,P){Sc=vl=null,Ap(_),eh=null,af=0;var U=_.return;try{if(ff(d,U,_,T,We)){bt=1,zp(d,ao(T,d.current)),Qe=null;return}}catch(X){if(U!==null)throw Qe=U,X;bt=1,zp(d,ao(T,d.current)),Qe=null;return}_.flags&32768?(ci||P===1?d=!0:je||(We&536870912)!==0?d=!1:(et=d=!0,(P===2||P===9||P===3||P===6)&&(P=Lo.current,P!==null&&P.tag===13&&(P.flags|=16384))),gs(_,d)):Ei(_)}function Ei(d){var _=d;do{if((_.flags&32768)!==0){gs(_,et);return}d=_.return;var T=Up(_.alternate,_,ot);if(T!==null){Qe=T;return}if(_=_.sibling,_!==null){Qe=_;return}Qe=_=d}while(_!==null);bt===0&&(bt=5)}function gs(d,_){do{var T=Sv(d.alternate,d);if(T!==null){T.flags&=32767,Qe=T;return}if(T=d.return,T!==null&&(T.flags|=32768,T.subtreeFlags=0,T.deletions=null),!_&&(d=d.sibling,d!==null)){Qe=d;return}Qe=d=T}while(d!==null);bt=6,Qe=null}function Af(d,_,T,P,U,X,_e,Be,ht){d.cancelPendingCommit=null;do nl();while(Gr!==0);if((Ve&6)!==0)throw Error(l(327));if(_!==null){if(_===d.current)throw Error(l(177));if(X=_.lanes|_.childLanes,X|=ap,yt(d,T,X,_e,Be,ht),d===He&&(Qe=He=null,We=0),yn=_,Lr=d,hn=T,Pn=X,ln=U,$r=P,(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,_w(ga,function(){return ec(),null})):(d.callbackNode=null,d.callbackPriority=0),P=(_.flags&13878)!==0,(_.subtreeFlags&13878)!==0||P){P=$e.T,$e.T=null,U=rt.p,rt.p=2,_e=Ve,Ve|=4;try{aa(d,_,T)}finally{Ve=_e,rt.p=U,$e.T=P}}Gr=1,Jl(),_d(),yd()}}function Jl(){if(Gr===1){Gr=0;var d=Lr,_=yn,T=(_.flags&13878)!==0;if((_.subtreeFlags&13878)!==0||T){T=$e.T,$e.T=null;var P=rt.p;rt.p=2;var U=Ve;Ve|=4;try{A(_,d);var X=Pv,_e=hv(d.containerInfo),Be=X.focusedElem,ht=X.selectionRange;if(_e!==Be&&Be&&Be.ownerDocument&&eu(Be.ownerDocument.documentElement,Be)){if(ht!==null&&Vh(Be)){var Vt=ht.start,ir=ht.end;if(ir===void 0&&(ir=Vt),"selectionStart"in Be)Be.selectionStart=Vt,Be.selectionEnd=Math.min(ir,Be.value.length);else{var pr=Be.ownerDocument||document,$t=pr&&pr.defaultView||window;if($t.getSelection){var er=$t.getSelection(),Hr=Be.textContent.length,cn=Math.min(ht.start,Hr),Vi=ht.end===void 0?cn:Math.min(ht.end,Hr);!er.extend&&cn>Vi&&(_e=Vi,Vi=cn,cn=_e);var Pt=Ys(Be,cn),_t=Ys(Be,Vi);if(Pt&&_t&&(er.rangeCount!==1||er.anchorNode!==Pt.node||er.anchorOffset!==Pt.offset||er.focusNode!==_t.node||er.focusOffset!==_t.offset)){var Nt=pr.createRange();Nt.setStart(Pt.node,Pt.offset),er.removeAllRanges(),cn>Vi?(er.addRange(Nt),er.extend(_t.node,_t.offset)):(Nt.setEnd(_t.node,_t.offset),er.addRange(Nt))}}}}for(pr=[],er=Be;er=er.parentNode;)er.nodeType===1&&pr.push({element:er,left:er.scrollLeft,top:er.scrollTop});for(typeof Be.focus=="function"&&Be.focus(),Be=0;Be<pr.length;Be++){var ur=pr[Be];ur.element.scrollLeft=ur.left,ur.element.scrollTop=ur.top}}ty=!!Iv,Pv=Iv=null}finally{Ve=U,rt.p=P,$e.T=T}}d.current=_,Gr=2}}function _d(){if(Gr===2){Gr=0;var d=Lr,_=yn,T=(_.flags&8772)!==0;if((_.subtreeFlags&8772)!==0||T){T=$e.T,$e.T=null;var P=rt.p;rt.p=2;var U=Ve;Ve|=4;try{ks(d,_.alternate,_)}finally{Ve=U,rt.p=P,$e.T=T}}Gr=3}}function yd(){if(Gr===4||Gr===3){Gr=0,go();var d=Lr,_=yn,T=hn,P=$r;(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?Gr=5:(Gr=0,yn=Lr=null,_s(d,d.pendingLanes));var U=d.pendingLanes;if(U===0&&(Pr=null),Xe(T),_=_.stateNode,Ci&&typeof Ci.onCommitFiberRoot=="function")try{Ci.onCommitFiberRoot(Cs,_,void 0,(_.current.flags&128)===128)}catch{}if(P!==null){_=$e.T,U=rt.p,rt.p=2,$e.T=null;try{for(var X=d.onRecoverableError,_e=0;_e<P.length;_e++){var Be=P[_e];X(Be.value,{componentStack:Be.stack})}}finally{$e.T=_,rt.p=U}}(hn&3)!==0&&nl(),fh(d),U=d.pendingLanes,(T&261930)!==0&&(U&42)!==0?d===hi?mn++:(mn=0,hi=d):mn=0,Ef(0)}}function _s(d,_){(d.pooledCacheLanes&=_)===0&&(_=d.pooledCache,_!=null&&(d.pooledCache=null,cu(_)))}function nl(){return Jl(),_d(),yd(),ec()}function ec(){if(Gr!==5)return!1;var d=Lr,_=Pn;Pn=0;var T=Xe(hn),P=$e.T,U=rt.p;try{rt.p=32>T?32:T,$e.T=null,T=ln,ln=null;var X=Lr,_e=hn;if(Gr=0,yn=Lr=null,hn=0,(Ve&6)!==0)throw Error(l(331));var Be=Ve;if(Ve|=4,Ce(X.current),ne(X,X.current,_e,T),Ve=Be,Ef(0,!1),Ci&&typeof Ci.onPostCommitFiberRoot=="function")try{Ci.onPostCommitFiberRoot(Cs,X)}catch{}return!0}finally{rt.p=U,$e.T=P,_s(d,_)}}function Ns(d,_,T){_=ao(T,_),_=Zl(d.stateNode,_,2),d=fu(d,_,2),d!==null&&(Jr(d,2),fh(d))}function oi(d,_,T){if(d.tag===3)Ns(d,d,T);else for(;_!==null;){if(_.tag===3){Ns(_,d,T);break}else if(_.tag===1){var P=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(Pr===null||!Pr.has(P))){d=ao(T,d),T=Rc(2),P=fu(_,T,2),P!==null&&(ja(T,P,_,d),Jr(P,2),fh(P));break}}_=_.return}}function bu(d,_,T){var P=d.pingCache;if(P===null){P=d.pingCache=new Ne;var U=new Set;P.set(_,U)}else U=P.get(_),U===void 0&&(U=new Set,P.set(_,U));U.has(T)||(mt=!0,U.add(T),d=dg.bind(null,d,_,T),_.then(d,d))}function dg(d,_,T){var P=d.pingCache;P!==null&&P.delete(_),d.pingedLanes|=d.suspendedLanes&T,d.warmLanes&=~T,He===d&&(We&T)===T&&(bt===4||bt===3&&(We&62914560)===We&&300>ni()-xr?(Ve&2)===0&&Ka(d,0):kt|=T,hr===We&&(hr=0)),fh(d)}function Ex(d,_){_===0&&(_=Xa()),d=Gt(d,_),d!==null&&(Jr(d,_),fh(d))}function mw(d){var _=d.memoizedState,T=0;_!==null&&(T=_.retryLane),Ex(d,T)}function gw(d,_){var T=0;switch(d.tag){case 31:case 13:var P=d.stateNode,U=d.memoizedState;U!==null&&(T=U.retryLane);break;case 19:P=d.stateNode;break;case 22:P=d.stateNode._retryCache;break;default:throw Error(l(314))}P!==null&&P.delete(_),Ex(d,T)}function _w(d,_){return da(d,_)}var N_=null,Bc=null,Ev=!1,lo=!1,Tf=!1,Sf=0;function fh(d){d!==Bc&&d.next===null&&(Bc===null?N_=Bc=d:Bc=Bc.next=d),lo=!0,Ev||(Ev=!0,_S())}function Ef(d,_){if(!Tf&&lo){Tf=!0;do for(var T=!1,P=N_;P!==null;){if(d!==0){var U=P.pendingLanes;if(U===0)var X=0;else{var _e=P.suspendedLanes,Be=P.pingedLanes;X=(1<<31-qi(42|d)+1)-1,X&=U&~(_e&~Be),X=X&201326741?X&201326741|1:X?X|2:0}X!==0&&(T=!0,Ox(P,X))}else X=We,X=Bi(P,P===He?X:0,P.cancelPendingCommit!==null||P.timeoutHandle!==-1),(X&3)===0||as(P,X)||(T=!0,Ox(P,X));P=P.next}while(T);Tf=!1}}function gS(){Mx()}function Mx(){lo=Ev=!1;var d=0;Sf!==0&&Ew()&&(d=Sf);for(var _=ni(),T=null,P=N_;P!==null;){var U=P.next,X=j_(P,_);X===0?(P.next=null,T===null?N_=U:T.next=U,U===null&&(Bc=T)):(T=P,(d!==0||(X&3)!==0)&&(lo=!0)),P=U}Gr!==0&&Gr!==5||Ef(d),Sf!==0&&(Sf=0)}function j_(d,_){for(var T=d.suspendedLanes,P=d.pingedLanes,U=d.expirationTimes,X=d.pendingLanes&-62914561;0<X;){var _e=31-qi(X),Be=1<<_e,ht=U[_e];ht===-1?((Be&T)===0||(Be&P)!==0)&&(U[_e]=qo(Be,_)):ht<=_&&(d.expiredLanes|=Be),X&=~Be}if(_=He,T=We,T=Bi(d,d===_?T:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),P=d.callbackNode,T===0||d===_&&(ut===2||ut===9)||d.cancelPendingCommit!==null)return P!==null&&P!==null&&Yn(P),d.callbackNode=null,d.callbackPriority=0;if((T&3)===0||as(d,T)){if(_=T&-T,_===d.callbackPriority)return _;switch(P!==null&&Yn(P),Xe(T)){case 2:case 8:T=Ai;break;case 32:T=ga;break;case 268435456:T=Zi;break;default:T=ga}return P=yw.bind(null,d),T=da(T,P),d.callbackPriority=_,d.callbackNode=T,_}return P!==null&&P!==null&&Yn(P),d.callbackPriority=2,d.callbackNode=null,2}function yw(d,_){if(Gr!==0&&Gr!==5)return d.callbackNode=null,d.callbackPriority=0,null;var T=d.callbackNode;if(nl()&&d.callbackNode!==T)return null;var P=We;return P=Bi(d,d===He?P:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),P===0?null:(qr(d,P,_),j_(d,ni()),d.callbackNode!=null&&d.callbackNode===T?yw.bind(null,d):null)}function Ox(d,_){if(nl())return null;qr(d,_,!0)}function _S(){bS(function(){(Ve&6)!==0?da(no,gS):Mx()})}function U_(){if(Sf===0){var d=uu;d===0&&(d=io,io<<=1,(io&261888)===0&&(io=256)),Sf=d}return Sf}function wu(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:dl(""+d)}function ph(d,_){var T=_.ownerDocument.createElement("input");return T.name=_.name,T.value=_.value,d.id&&T.setAttribute("form",d.id),_.parentNode.insertBefore(T,_),d=new FormData(d),T.parentNode.removeChild(T),d}function vw(d,_,T,P,U){if(_==="submit"&&T&&T.stateNode===U){var X=wu((U[Ee]||null).action),_e=P.submitter;_e&&(_=(_=_e[Ee]||null)?wu(_.formAction):_e.getAttribute("formAction"),_!==null&&(X=_,_e=null));var Be=new qu("action","action",null,P,U);d.push({event:Be,listeners:[{instance:null,listener:function(){if(P.defaultPrevented){if(Sf!==0){var ht=_e?ph(U,_e):new FormData(U);Op(T,{pending:!0,data:ht,method:U.method,action:X},null,ht)}}else typeof X=="function"&&(Be.preventDefault(),ht=_e?ph(U,_e):new FormData(U),Op(T,{pending:!0,data:ht,method:U.method,action:X},X,ht))},currentTarget:U}]})}}for(var Mv=0;Mv<Yo.length;Mv++){var fg=Yo[Mv],Cx=fg.toLowerCase(),V_=fg[0].toUpperCase()+fg.slice(1);Qs(Cx,"on"+V_)}Qs(Rm,"onAnimationEnd"),Qs(dv,"onAnimationIteration"),Qs(xc,"onAnimationStart"),Qs("dblclick","onDoubleClick"),Qs("focusin","onFocus"),Qs("focusout","onBlur"),Qs(fv,"onTransitionRun"),Qs(pv,"onTransitionStart"),Qs(zm,"onTransitionCancel"),Qs(Lm,"onTransitionEnd"),Xn("onMouseEnter",["mouseout","mouseover"]),Xn("onMouseLeave",["mouseout","mouseover"]),Xn("onPointerEnter",["pointerout","pointerover"]),Xn("onPointerLeave",["pointerout","pointerover"]),yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mf));function G_(d,_){_=(_&4)!==0;for(var T=0;T<d.length;T++){var P=d[T],U=P.event;P=P.listeners;e:{var X=void 0;if(_)for(var _e=P.length-1;0<=_e;_e--){var Be=P[_e],ht=Be.instance,Vt=Be.currentTarget;if(Be=Be.listener,ht!==X&&U.isPropagationStopped())break e;X=Be,U.currentTarget=Vt;try{X(U)}catch(ir){qd(ir)}U.currentTarget=null,X=ht}else for(_e=0;_e<P.length;_e++){if(Be=P[_e],ht=Be.instance,Vt=Be.currentTarget,Be=Be.listener,ht!==X&&U.isPropagationStopped())break e;X=Be,U.currentTarget=Vt;try{X(U)}catch(ir){qd(ir)}U.currentTarget=null,X=ht}}}}function si(d,_){var T=_[it];T===void 0&&(T=_[it]=new Set);var P=d+"__bubble";T.has(P)||(vd(_,d,2,!1),T.add(P))}function $_(d,_,T){var P=0;_&&(P|=4),vd(T,d,P,_)}var q_="_reactListening"+Math.random().toString(36).slice(2);function Ov(d){if(!d[q_]){d[q_]=!0,br.forEach(function(T){T!=="selectionchange"&&(xw.has(T)||$_(T,!1,d),$_(T,!0,d))});var _=d.nodeType===9?d:d.ownerDocument;_===null||_[q_]||(_[q_]=!0,$_("selectionchange",!1,_))}}function vd(d,_,T,P){switch(Fw(_)){case 2:var U=kv;break;case 8:U=kw;break;default:U=yg}T=U.bind(null,_,T,d),U=void 0,!Bh||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(U=!0),P?U!==void 0?d.addEventListener(_,T,{capture:!0,passive:U}):d.addEventListener(_,T,!0):U!==void 0?d.addEventListener(_,T,{passive:U}):d.addEventListener(_,T,!1)}function Cv(d,_,T,P,U){var X=P;if((_&1)===0&&(_&2)===0&&P!==null)e:for(;;){if(P===null)return;var _e=P.tag;if(_e===3||_e===4){var Be=P.stateNode.containerInfo;if(Be===U)break;if(_e===4)for(_e=P.return;_e!==null;){var ht=_e.tag;if((ht===3||ht===4)&&_e.stateNode.containerInfo===U)return;_e=_e.return}for(;Be!==null;){if(_e=dr(Be),_e===null)return;if(ht=_e.tag,ht===5||ht===6||ht===26||ht===27){P=X=_e;continue e}Be=Be.parentNode}}P=P.return}r_(function(){var Vt=X,ir=Gu(T),pr=[];e:{var $t=ru.get(d);if($t!==void 0){var er=qu,Hr=d;switch(d){case"keypress":if(un(T)===0)break e;case"keydown":case"keyup":er=ss;break;case"focusin":Hr="focus",er=Do;break;case"focusout":Hr="blur",er=Do;break;case"beforeblur":case"afterblur":er=Do;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":er=Fd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":er=Fh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":er=Zo;break;case Rm:case dv:case xc:er=Em;break;case Lm:er=Ln;break;case"scroll":case"scrollend":er=Jf;break;case"wheel":er=jd;break;case"copy":case"cut":case"paste":er=Cn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":er=En;break;case"toggle":case"beforetoggle":er=Ro}var cn=(_&4)!==0,Vi=!cn&&(d==="scroll"||d==="scrollend"),Pt=cn?$t!==null?$t+"Capture":null:$t;cn=[];for(var _t=Vt,Nt;_t!==null;){var ur=_t;if(Nt=ur.stateNode,ur=ur.tag,ur!==5&&ur!==26&&ur!==27||Nt===null||Pt===null||(ur=Bd(_t,Pt),ur!=null&&cn.push(Vp(_t,ur,Nt))),Vi)break;_t=_t.return}0<cn.length&&($t=new er($t,Hr,null,T,ir),pr.push({event:$t,listeners:cn}))}}if((_&7)===0){e:{if($t=d==="mouseover"||d==="pointerover",er=d==="mouseout"||d==="pointerout",$t&&T!==fl&&(Hr=T.relatedTarget||T.fromElement)&&(dr(Hr)||Hr[Fe]))break e;if((er||$t)&&($t=ir.window===ir?ir:($t=ir.ownerDocument)?$t.defaultView||$t.parentWindow:window,er?(Hr=T.relatedTarget||T.toElement,er=Vt,Hr=Hr?dr(Hr):null,Hr!==null&&(Vi=v(Hr),cn=Hr.tag,Hr!==Vi||cn!==5&&cn!==27&&cn!==6)&&(Hr=null)):(er=null,Hr=Vt),er!==Hr)){if(cn=Fd,ur="onMouseLeave",Pt="onMouseEnter",_t="mouse",(d==="pointerout"||d==="pointerover")&&(cn=En,ur="onPointerLeave",Pt="onPointerEnter",_t="pointer"),Vi=er==null?$t:Br(er),Nt=Hr==null?$t:Br(Hr),$t=new cn(ur,_t+"leave",er,T,ir),$t.target=Vi,$t.relatedTarget=Nt,ur=null,dr(ir)===Vt&&(cn=new cn(Pt,_t+"enter",Hr,T,ir),cn.target=Nt,cn.relatedTarget=Vi,ur=cn),Vi=ur,er&&Hr)t:{for(cn=yS,Pt=er,_t=Hr,Nt=0,ur=Pt;ur;ur=cn(ur))Nt++;ur=0;for(var dn=_t;dn;dn=cn(dn))ur++;for(;0<Nt-ur;)Pt=cn(Pt),Nt--;for(;0<ur-Nt;)_t=cn(_t),ur--;for(;Nt--;){if(Pt===_t||_t!==null&&Pt===_t.alternate){cn=Pt;break t}Pt=cn(Pt),_t=cn(_t)}cn=null}else cn=null;er!==null&&bw(pr,$t,er,cn,!1),Hr!==null&&Vi!==null&&bw(pr,Vi,Hr,cn,!0)}}e:{if($t=Vt?Br(Vt):window,er=$t.nodeName&&$t.nodeName.toLowerCase(),er==="select"||er==="input"&&$t.type==="file")var Pi=mr;else if(xa($t))if(Uh)Pi=$d;else{Pi=vc;var rn=u_}else er=$t.nodeName,!er||er.toLowerCase()!=="input"||$t.type!=="checkbox"&&$t.type!=="radio"?Vt&&Kf(Vt.elementType)&&(Pi=mr):Pi=uv;if(Pi&&(Pi=Pi(d,Vt))){Bl(pr,Pi,T,ir);break e}rn&&rn(d,$t,Vt),d==="focusout"&&Vt&&$t.type==="number"&&Vt.memoizedProps.value!=null&&zl($t,"number",$t.value)}switch(rn=Vt?Br(Vt):window,d){case"focusin":(xa(rn)||rn.contentEditable==="true")&&(tu=rn,Pm=Vt,Wo=null);break;case"focusout":Wo=Pm=tu=null;break;case"mousedown":Dm=!0;break;case"contextmenu":case"mouseup":case"dragend":Dm=!1,ip(pr,T,ir);break;case"selectionchange":if(np)break;case"keydown":case"keyup":ip(pr,T,ir)}var Jn;if(s_)e:{switch(d){case"compositionstart":var pi="onCompositionStart";break e;case"compositionend":pi="onCompositionEnd";break e;case"compositionupdate":pi="onCompositionUpdate";break e}pi=void 0}else Wa?tp(d,T)&&(pi="onCompositionEnd"):d==="keydown"&&T.keyCode===229&&(pi="onCompositionStart");pi&&(Ud&&T.locale!=="ko"&&(Wa||pi!=="onCompositionStart"?pi==="onCompositionEnd"&&Wa&&(Jn=Sm()):(Xo=ir,kh="value"in Xo?Xo.value:Xo.textContent,Wa=!0)),rn=H_(Vt,pi),0<rn.length&&(pi=new a_(pi,d,null,T,ir),pr.push({event:pi,listeners:rn}),Jn?pi.data=Jn:(Jn=xo(T),Jn!==null&&(pi.data=Jn)))),(Jn=l_?ls(d,T):c_(d,T))&&(pi=H_(Vt,"onBeforeInput"),0<pi.length&&(rn=new a_("onBeforeInput","beforeinput",null,T,ir),pr.push({event:rn,listeners:pi}),rn.data=Jn)),vw(pr,d,Vt,T,ir)}G_(pr,_)})}function Vp(d,_,T){return{instance:d,listener:_,currentTarget:T}}function H_(d,_){for(var T=_+"Capture",P=[];d!==null;){var U=d,X=U.stateNode;if(U=U.tag,U!==5&&U!==26&&U!==27||X===null||(U=Bd(d,T),U!=null&&P.unshift(Vp(d,U,X)),U=Bd(d,_),U!=null&&P.push(Vp(d,U,X))),d.tag===3)return P;d=d.return}return[]}function yS(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function bw(d,_,T,P,U){for(var X=_._reactName,_e=[];T!==null&&T!==P;){var Be=T,ht=Be.alternate,Vt=Be.stateNode;if(Be=Be.tag,ht!==null&&ht===P)break;Be!==5&&Be!==26&&Be!==27||Vt===null||(ht=Vt,U?(Vt=Bd(T,X),Vt!=null&&_e.unshift(Vp(T,Vt,ht))):U||(Vt=Bd(T,X),Vt!=null&&_e.push(Vp(T,Vt,ht)))),T=T.return}_e.length!==0&&d.push({event:_,listeners:_e})}var vS=/\r\n?/g,ww=/\u0000|\uFFFD/g;function Ix(d){return(typeof d=="string"?d:""+d).replace(vS,`
`).replace(ww,"")}function Aw(d,_){return _=Ix(_),Ix(d)===_}function ea(d,_,T,P,U,X){switch(T){case"children":typeof P=="string"?_==="body"||_==="textarea"&&P===""||_c(d,P):(typeof P=="number"||typeof P=="bigint")&&_!=="body"&&_c(d,""+P);break;case"className":jn(d,"class",P);break;case"tabIndex":jn(d,"tabindex",P);break;case"dir":case"role":case"viewBox":case"width":case"height":jn(d,T,P);break;case"style":Am(d,P,X);break;case"data":if(_!=="object"){jn(d,"data",P);break}case"src":case"href":if(P===""&&(_!=="a"||T!=="href")){d.removeAttribute(T);break}if(P==null||typeof P=="function"||typeof P=="symbol"||typeof P=="boolean"){d.removeAttribute(T);break}P=dl(""+P),d.setAttribute(T,P);break;case"action":case"formAction":if(typeof P=="function"){d.setAttribute(T,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof X=="function"&&(T==="formAction"?(_!=="input"&&ea(d,_,"name",U.name,U,null),ea(d,_,"formEncType",U.formEncType,U,null),ea(d,_,"formMethod",U.formMethod,U,null),ea(d,_,"formTarget",U.formTarget,U,null)):(ea(d,_,"encType",U.encType,U,null),ea(d,_,"method",U.method,U,null),ea(d,_,"target",U.target,U,null)));if(P==null||typeof P=="symbol"||typeof P=="boolean"){d.removeAttribute(T);break}P=dl(""+P),d.setAttribute(T,P);break;case"onClick":P!=null&&(d.onclick=ka);break;case"onScroll":P!=null&&si("scroll",d);break;case"onScrollEnd":P!=null&&si("scrollend",d);break;case"dangerouslySetInnerHTML":if(P!=null){if(typeof P!="object"||!("__html"in P))throw Error(l(61));if(T=P.__html,T!=null){if(U.children!=null)throw Error(l(60));d.innerHTML=T}}break;case"multiple":d.multiple=P&&typeof P!="function"&&typeof P!="symbol";break;case"muted":d.muted=P&&typeof P!="function"&&typeof P!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(P==null||typeof P=="function"||typeof P=="boolean"||typeof P=="symbol"){d.removeAttribute("xlink:href");break}T=dl(""+P),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",T);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":P!=null&&typeof P!="function"&&typeof P!="symbol"?d.setAttribute(T,""+P):d.removeAttribute(T);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":P&&typeof P!="function"&&typeof P!="symbol"?d.setAttribute(T,""):d.removeAttribute(T);break;case"capture":case"download":P===!0?d.setAttribute(T,""):P!==!1&&P!=null&&typeof P!="function"&&typeof P!="symbol"?d.setAttribute(T,P):d.removeAttribute(T);break;case"cols":case"rows":case"size":case"span":P!=null&&typeof P!="function"&&typeof P!="symbol"&&!isNaN(P)&&1<=P?d.setAttribute(T,P):d.removeAttribute(T);break;case"rowSpan":case"start":P==null||typeof P=="function"||typeof P=="symbol"||isNaN(P)?d.removeAttribute(T):d.setAttribute(T,P);break;case"popover":si("beforetoggle",d),si("toggle",d),Nn(d,"popover",P);break;case"xlinkActuate":ti(d,"http://www.w3.org/1999/xlink","xlink:actuate",P);break;case"xlinkArcrole":ti(d,"http://www.w3.org/1999/xlink","xlink:arcrole",P);break;case"xlinkRole":ti(d,"http://www.w3.org/1999/xlink","xlink:role",P);break;case"xlinkShow":ti(d,"http://www.w3.org/1999/xlink","xlink:show",P);break;case"xlinkTitle":ti(d,"http://www.w3.org/1999/xlink","xlink:title",P);break;case"xlinkType":ti(d,"http://www.w3.org/1999/xlink","xlink:type",P);break;case"xmlBase":ti(d,"http://www.w3.org/XML/1998/namespace","xml:base",P);break;case"xmlLang":ti(d,"http://www.w3.org/XML/1998/namespace","xml:lang",P);break;case"xmlSpace":ti(d,"http://www.w3.org/XML/1998/namespace","xml:space",P);break;case"is":Nn(d,"is",P);break;case"innerText":case"textContent":break;default:(!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&(T=Za.get(T)||T,Nn(d,T,P))}}function Px(d,_,T,P,U,X){switch(T){case"style":Am(d,P,X);break;case"dangerouslySetInnerHTML":if(P!=null){if(typeof P!="object"||!("__html"in P))throw Error(l(61));if(T=P.__html,T!=null){if(U.children!=null)throw Error(l(60));d.innerHTML=T}}break;case"children":typeof P=="string"?_c(d,P):(typeof P=="number"||typeof P=="bigint")&&_c(d,""+P);break;case"onScroll":P!=null&&si("scroll",d);break;case"onScrollEnd":P!=null&&si("scrollend",d);break;case"onClick":P!=null&&(d.onclick=ka);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vn.hasOwnProperty(T))e:{if(T[0]==="o"&&T[1]==="n"&&(U=T.endsWith("Capture"),_=T.slice(2,U?T.length-7:void 0),X=d[Ee]||null,X=X!=null?X[T]:null,typeof X=="function"&&d.removeEventListener(_,X,U),typeof P=="function")){typeof X!="function"&&X!==null&&(T in d?d[T]=null:d.hasAttribute(T)&&d.removeAttribute(T)),d.addEventListener(_,P,U);break e}T in d?d[T]=P:P===!0?d.setAttribute(T,""):Nn(d,T,P)}}}function ys(d,_,T){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":si("error",d),si("load",d);var P=!1,U=!1,X;for(X in T)if(T.hasOwnProperty(X)){var _e=T[X];if(_e!=null)switch(X){case"src":P=!0;break;case"srcSet":U=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,_));default:ea(d,_,X,_e,T,null)}}U&&ea(d,_,"srcSet",T.srcSet,T,null),P&&ea(d,_,"src",T.src,T,null);return;case"input":si("invalid",d);var Be=X=_e=U=null,ht=null,Vt=null;for(P in T)if(T.hasOwnProperty(P)){var ir=T[P];if(ir!=null)switch(P){case"name":U=ir;break;case"type":_e=ir;break;case"checked":ht=ir;break;case"defaultChecked":Vt=ir;break;case"value":X=ir;break;case"defaultValue":Be=ir;break;case"children":case"dangerouslySetInnerHTML":if(ir!=null)throw Error(l(137,_));break;default:ea(d,_,P,ir,T,null)}}Po(d,X,Be,ht,Vt,_e,U,!1);return;case"select":si("invalid",d),P=_e=X=null;for(U in T)if(T.hasOwnProperty(U)&&(Be=T[U],Be!=null))switch(U){case"value":X=Be;break;case"defaultValue":_e=Be;break;case"multiple":P=Be;default:ea(d,_,U,Be,T,null)}_=X,T=_e,d.multiple=!!P,_!=null?hl(d,!!P,_,!1):T!=null&&hl(d,!!P,T,!0);return;case"textarea":si("invalid",d),X=U=P=null;for(_e in T)if(T.hasOwnProperty(_e)&&(Be=T[_e],Be!=null))switch(_e){case"value":P=Be;break;case"defaultValue":U=Be;break;case"children":X=Be;break;case"dangerouslySetInnerHTML":if(Be!=null)throw Error(l(91));break;default:ea(d,_,_e,Be,T,null)}zd(d,P,U,X);return;case"option":for(ht in T)T.hasOwnProperty(ht)&&(P=T[ht],P!=null)&&(ht==="selected"?d.selected=P&&typeof P!="function"&&typeof P!="symbol":ea(d,_,ht,P,T,null));return;case"dialog":si("beforetoggle",d),si("toggle",d),si("cancel",d),si("close",d);break;case"iframe":case"object":si("load",d);break;case"video":case"audio":for(P=0;P<Mf.length;P++)si(Mf[P],d);break;case"image":si("error",d),si("load",d);break;case"details":si("toggle",d);break;case"embed":case"source":case"link":si("error",d),si("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Vt in T)if(T.hasOwnProperty(Vt)&&(P=T[Vt],P!=null))switch(Vt){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,_));default:ea(d,_,Vt,P,T,null)}return;default:if(Kf(_)){for(ir in T)T.hasOwnProperty(ir)&&(P=T[ir],P!==void 0&&Px(d,_,ir,P,T,void 0));return}}for(Be in T)T.hasOwnProperty(Be)&&(P=T[Be],P!=null&&ea(d,_,Be,P,T,null))}function Tw(d,_,T,P){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var U=null,X=null,_e=null,Be=null,ht=null,Vt=null,ir=null;for(er in T){var pr=T[er];if(T.hasOwnProperty(er)&&pr!=null)switch(er){case"checked":break;case"value":break;case"defaultValue":ht=pr;default:P.hasOwnProperty(er)||ea(d,_,er,null,P,pr)}}for(var $t in P){var er=P[$t];if(pr=T[$t],P.hasOwnProperty($t)&&(er!=null||pr!=null))switch($t){case"type":X=er;break;case"name":U=er;break;case"checked":Vt=er;break;case"defaultChecked":ir=er;break;case"value":_e=er;break;case"defaultValue":Be=er;break;case"children":case"dangerouslySetInnerHTML":if(er!=null)throw Error(l(137,_));break;default:er!==pr&&ea(d,_,$t,er,P,pr)}}Ho(d,_e,Be,ht,Vt,ir,X,U);return;case"select":er=_e=Be=$t=null;for(X in T)if(ht=T[X],T.hasOwnProperty(X)&&ht!=null)switch(X){case"value":break;case"multiple":er=ht;default:P.hasOwnProperty(X)||ea(d,_,X,null,P,ht)}for(U in P)if(X=P[U],ht=T[U],P.hasOwnProperty(U)&&(X!=null||ht!=null))switch(U){case"value":$t=X;break;case"defaultValue":Be=X;break;case"multiple":_e=X;default:X!==ht&&ea(d,_,U,X,P,ht)}_=Be,T=_e,P=er,$t!=null?hl(d,!!T,$t,!1):!!P!=!!T&&(_!=null?hl(d,!!T,_,!0):hl(d,!!T,T?[]:"",!1));return;case"textarea":er=$t=null;for(Be in T)if(U=T[Be],T.hasOwnProperty(Be)&&U!=null&&!P.hasOwnProperty(Be))switch(Be){case"value":break;case"children":break;default:ea(d,_,Be,null,P,U)}for(_e in P)if(U=P[_e],X=T[_e],P.hasOwnProperty(_e)&&(U!=null||X!=null))switch(_e){case"value":$t=U;break;case"defaultValue":er=U;break;case"children":break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(l(91));break;default:U!==X&&ea(d,_,_e,U,P,X)}Is(d,$t,er);return;case"option":for(var Hr in T)$t=T[Hr],T.hasOwnProperty(Hr)&&$t!=null&&!P.hasOwnProperty(Hr)&&(Hr==="selected"?d.selected=!1:ea(d,_,Hr,null,P,$t));for(ht in P)$t=P[ht],er=T[ht],P.hasOwnProperty(ht)&&$t!==er&&($t!=null||er!=null)&&(ht==="selected"?d.selected=$t&&typeof $t!="function"&&typeof $t!="symbol":ea(d,_,ht,$t,P,er));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var cn in T)$t=T[cn],T.hasOwnProperty(cn)&&$t!=null&&!P.hasOwnProperty(cn)&&ea(d,_,cn,null,P,$t);for(Vt in P)if($t=P[Vt],er=T[Vt],P.hasOwnProperty(Vt)&&$t!==er&&($t!=null||er!=null))switch(Vt){case"children":case"dangerouslySetInnerHTML":if($t!=null)throw Error(l(137,_));break;default:ea(d,_,Vt,$t,P,er)}return;default:if(Kf(_)){for(var Vi in T)$t=T[Vi],T.hasOwnProperty(Vi)&&$t!==void 0&&!P.hasOwnProperty(Vi)&&Px(d,_,Vi,void 0,P,$t);for(ir in P)$t=P[ir],er=T[ir],!P.hasOwnProperty(ir)||$t===er||$t===void 0&&er===void 0||Px(d,_,ir,$t,P,er);return}}for(var Pt in T)$t=T[Pt],T.hasOwnProperty(Pt)&&$t!=null&&!P.hasOwnProperty(Pt)&&ea(d,_,Pt,null,P,$t);for(pr in P)$t=P[pr],er=T[pr],!P.hasOwnProperty(pr)||$t===er||$t==null&&er==null||ea(d,_,pr,$t,P,er)}function Dx(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Sw(){if(typeof performance.getEntriesByType=="function"){for(var d=0,_=0,T=performance.getEntriesByType("resource"),P=0;P<T.length;P++){var U=T[P],X=U.transferSize,_e=U.initiatorType,Be=U.duration;if(X&&Be&&Dx(_e)){for(_e=0,Be=U.responseEnd,P+=1;P<T.length;P++){var ht=T[P],Vt=ht.startTime;if(Vt>Be)break;var ir=ht.transferSize,pr=ht.initiatorType;ir&&Dx(pr)&&(ht=ht.responseEnd,_e+=ir*(ht<Be?1:(Be-Vt)/(ht-Vt)))}if(--P,_+=8*(X+_e)/(U.duration/1e3),d++,10<d)break}}if(0<d)return _/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var Iv=null,Pv=null;function X_(d){return d.nodeType===9?d:d.ownerDocument}function Rx(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Dv(d,_){if(d===0)switch(_){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&_==="foreignObject"?0:d}function mh(d,_){return d==="textarea"||d==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.children=="bigint"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var Ja=null;function Ew(){var d=window.event;return d&&d.type==="popstate"?d===Ja?!1:(Ja=d,!0):(Ja=null,!1)}var pg=typeof setTimeout=="function"?setTimeout:void 0,xS=typeof clearTimeout=="function"?clearTimeout:void 0,Mw=typeof Promise=="function"?Promise:void 0,bS=typeof queueMicrotask=="function"?queueMicrotask:typeof Mw<"u"?function(d){return Mw.resolve(null).then(d).catch(wS)}:pg;function wS(d){setTimeout(function(){throw d})}function tc(d){return d==="head"}function zx(d,_){var T=_,P=0;do{var U=T.nextSibling;if(d.removeChild(T),U&&U.nodeType===8)if(T=U.data,T==="/$"||T==="/&"){if(P===0){d.removeChild(U),bg(_);return}P--}else if(T==="$"||T==="$?"||T==="$~"||T==="$!"||T==="&")P++;else if(T==="html")W_(d.ownerDocument.documentElement);else if(T==="head"){T=d.ownerDocument.head,W_(T);for(var X=T.firstChild;X;){var _e=X.nextSibling,Be=X.nodeName;X[vt]||Be==="SCRIPT"||Be==="STYLE"||Be==="LINK"&&X.rel.toLowerCase()==="stylesheet"||T.removeChild(X),X=_e}}else T==="body"&&W_(d.ownerDocument.body);T=U}while(T);bg(_)}function Of(d,_){var T=d;d=0;do{var P=T.nextSibling;if(T.nodeType===1?_?(T._stashedDisplay=T.style.display,T.style.display="none"):(T.style.display=T._stashedDisplay||"",T.getAttribute("style")===""&&T.removeAttribute("style")):T.nodeType===3&&(_?(T._stashedText=T.nodeValue,T.nodeValue=""):T.nodeValue=T._stashedText||""),P&&P.nodeType===8)if(T=P.data,T==="/$"){if(d===0)break;d--}else T!=="$"&&T!=="$?"&&T!=="$~"&&T!=="$!"||d++;T=P}while(T)}function Gp(d){var _=d.firstChild;for(_&&_.nodeType===10&&(_=_.nextSibling);_;){var T=_;switch(_=_.nextSibling,T.nodeName){case"HTML":case"HEAD":case"BODY":Gp(T),Wt(T);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(T.rel.toLowerCase()==="stylesheet")continue}d.removeChild(T)}}function AS(d,_,T,P){for(;d.nodeType===1;){var U=T;if(d.nodeName.toLowerCase()!==_.toLowerCase()){if(!P&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(P){if(!d[vt])switch(_){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(X=d.getAttribute("rel"),X==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(X!==U.rel||d.getAttribute("href")!==(U.href==null||U.href===""?null:U.href)||d.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin)||d.getAttribute("title")!==(U.title==null?null:U.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(X=d.getAttribute("src"),(X!==(U.src==null?null:U.src)||d.getAttribute("type")!==(U.type==null?null:U.type)||d.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin))&&X&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(_==="input"&&d.type==="hidden"){var X=U.name==null?null:""+U.name;if(U.type==="hidden"&&d.getAttribute("name")===X)return d}else return d;if(d=kc(d.nextSibling),d===null)break}return null}function TS(d,_,T){if(_==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!T||(d=kc(d.nextSibling),d===null))return null;return d}function Ow(d,_){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!_||(d=kc(d.nextSibling),d===null))return null;return d}function Lx(d){return d.data==="$?"||d.data==="$~"}function Bx(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function SS(d,_){var T=d.ownerDocument;if(d.data==="$~")d._reactRetry=_;else if(d.data!=="$?"||T.readyState!=="loading")_();else{var P=function(){_(),T.removeEventListener("DOMContentLoaded",P)};T.addEventListener("DOMContentLoaded",P),d._reactRetry=P}}function kc(d){for(;d!=null;d=d.nextSibling){var _=d.nodeType;if(_===1||_===3)break;if(_===8){if(_=d.data,_==="$"||_==="$!"||_==="$?"||_==="$~"||_==="&"||_==="F!"||_==="F")break;if(_==="/$"||_==="/&")return null}}return d}var Z_=null;function Cw(d){d=d.nextSibling;for(var _=0;d;){if(d.nodeType===8){var T=d.data;if(T==="/$"||T==="/&"){if(_===0)return kc(d.nextSibling);_--}else T!=="$"&&T!=="$!"&&T!=="$?"&&T!=="$~"&&T!=="&"||_++}d=d.nextSibling}return null}function kx(d){d=d.previousSibling;for(var _=0;d;){if(d.nodeType===8){var T=d.data;if(T==="$"||T==="$!"||T==="$?"||T==="$~"||T==="&"){if(_===0)return d;_--}else T!=="/$"&&T!=="/&"||_++}d=d.previousSibling}return null}function mg(d,_,T){switch(_=X_(T),d){case"html":if(d=_.documentElement,!d)throw Error(l(452));return d;case"head":if(d=_.head,!d)throw Error(l(453));return d;case"body":if(d=_.body,!d)throw Error(l(454));return d;default:throw Error(l(451))}}function W_(d){for(var _=d.attributes;_.length;)d.removeAttributeNode(_[0]);Wt(d)}var Mi=new Map,$p=new Set;function Y_(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var Fc=rt.d;rt.d={f:Rv,r:K_,D:Q_,C:Nx,L:J_,m:ES,X:jx,S:Iw,M:Ux};function Rv(){var d=Fc.f(),_=Qn();return d||_}function K_(d){var _=vr(d);_!==null&&_.tag===5&&_.type==="form"?O_(_):Fc.r(d)}var qp=typeof document>"u"?null:document;function Fx(d,_,T){var P=qp;if(P&&typeof _=="string"&&_){var U=Sa(_);U='link[rel="'+d+'"][href="'+U+'"]',typeof T=="string"&&(U+='[crossorigin="'+T+'"]'),$p.has(U)||($p.add(U),d={rel:d,crossOrigin:T,href:_},P.querySelector(U)===null&&(_=P.createElement("link"),ys(_,"link",d),fr(_),P.head.appendChild(_)))}}function Q_(d){Fc.D(d),Fx("dns-prefetch",d,null)}function Nx(d,_){Fc.C(d,_),Fx("preconnect",d,_)}function J_(d,_,T){Fc.L(d,_,T);var P=qp;if(P&&d&&_){var U='link[rel="preload"][as="'+Sa(_)+'"]';_==="image"&&T&&T.imageSrcSet?(U+='[imagesrcset="'+Sa(T.imageSrcSet)+'"]',typeof T.imageSizes=="string"&&(U+='[imagesizes="'+Sa(T.imageSizes)+'"]')):U+='[href="'+Sa(d)+'"]';var X=U;switch(_){case"style":X=gg(d);break;case"script":X=Cf(d)}Mi.has(X)||(d=k({rel:"preload",href:_==="image"&&T&&T.imageSrcSet?void 0:d,as:_},T),Mi.set(X,d),P.querySelector(U)!==null||_==="style"&&P.querySelector(jo(X))||_==="script"&&P.querySelector(Hp(X))||(_=P.createElement("link"),ys(_,"link",d),fr(_),P.head.appendChild(_)))}}function ES(d,_){Fc.m(d,_);var T=qp;if(T&&d){var P=_&&typeof _.as=="string"?_.as:"script",U='link[rel="modulepreload"][as="'+Sa(P)+'"][href="'+Sa(d)+'"]',X=U;switch(P){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":X=Cf(d)}if(!Mi.has(X)&&(d=k({rel:"modulepreload",href:d},_),Mi.set(X,d),T.querySelector(U)===null)){switch(P){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(T.querySelector(Hp(X)))return}P=T.createElement("link"),ys(P,"link",d),fr(P),T.head.appendChild(P)}}}function Iw(d,_,T){Fc.S(d,_,T);var P=qp;if(P&&d){var U=Sr(P).hoistableStyles,X=gg(d);_=_||"default";var _e=U.get(X);if(!_e){var Be={loading:0,preload:null};if(_e=P.querySelector(jo(X)))Be.loading=5;else{d=k({rel:"stylesheet",href:d,"data-precedence":_},T),(T=Mi.get(X))&&$x(d,T);var ht=_e=P.createElement("link");fr(ht),ys(ht,"link",d),ht._p=new Promise(function(Vt,ir){ht.onload=Vt,ht.onerror=ir}),ht.addEventListener("load",function(){Be.loading|=1}),ht.addEventListener("error",function(){Be.loading|=2}),Be.loading|=4,Uo(_e,_,P)}_e={type:"stylesheet",instance:_e,count:1,state:Be},U.set(X,_e)}}}function jx(d,_){Fc.X(d,_);var T=qp;if(T&&d){var P=Sr(T).hoistableScripts,U=Cf(d),X=P.get(U);X||(X=T.querySelector(Hp(U)),X||(d=k({src:d,async:!0},_),(_=Mi.get(U))&&ey(d,_),X=T.createElement("script"),fr(X),ys(X,"link",d),T.head.appendChild(X)),X={type:"script",instance:X,count:1,state:null},P.set(U,X))}}function Ux(d,_){Fc.M(d,_);var T=qp;if(T&&d){var P=Sr(T).hoistableScripts,U=Cf(d),X=P.get(U);X||(X=T.querySelector(Hp(U)),X||(d=k({src:d,async:!0,type:"module"},_),(_=Mi.get(U))&&ey(d,_),X=T.createElement("script"),fr(X),ys(X,"link",d),T.head.appendChild(X)),X={type:"script",instance:X,count:1,state:null},P.set(U,X))}}function gh(d,_,T,P){var U=(U=jr.current)?Y_(U):null;if(!U)throw Error(l(446));switch(d){case"meta":case"title":return null;case"style":return typeof T.precedence=="string"&&typeof T.href=="string"?(_=gg(T.href),T=Sr(U).hoistableStyles,P=T.get(_),P||(P={type:"style",instance:null,count:0,state:null},T.set(_,P)),P):{type:"void",instance:null,count:0,state:null};case"link":if(T.rel==="stylesheet"&&typeof T.href=="string"&&typeof T.precedence=="string"){d=gg(T.href);var X=Sr(U).hoistableStyles,_e=X.get(d);if(_e||(U=U.ownerDocument||U,_e={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},X.set(d,_e),(X=U.querySelector(jo(d)))&&!X._p&&(_e.instance=X,_e.state.loading=5),Mi.has(d)||(T={rel:"preload",as:"style",href:T.href,crossOrigin:T.crossOrigin,integrity:T.integrity,media:T.media,hrefLang:T.hrefLang,referrerPolicy:T.referrerPolicy},Mi.set(d,T),X||Vx(U,d,T,_e.state))),_&&P===null)throw Error(l(528,""));return _e}if(_&&P!==null)throw Error(l(529,""));return null;case"script":return _=T.async,T=T.src,typeof T=="string"&&_&&typeof _!="function"&&typeof _!="symbol"?(_=Cf(T),T=Sr(U).hoistableScripts,P=T.get(_),P||(P={type:"script",instance:null,count:0,state:null},T.set(_,P)),P):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,d))}}function gg(d){return'href="'+Sa(d)+'"'}function jo(d){return'link[rel="stylesheet"]['+d+"]"}function Pw(d){return k({},d,{"data-precedence":d.precedence,precedence:null})}function Vx(d,_,T,P){d.querySelector('link[rel="preload"][as="style"]['+_+"]")?P.loading=1:(_=d.createElement("link"),P.preload=_,_.addEventListener("load",function(){return P.loading|=1}),_.addEventListener("error",function(){return P.loading|=2}),ys(_,"link",T),fr(_),d.head.appendChild(_))}function Cf(d){return'[src="'+Sa(d)+'"]'}function Hp(d){return"script[async]"+d}function Gx(d,_,T){if(_.count++,_.instance===null)switch(_.type){case"style":var P=d.querySelector('style[data-href~="'+Sa(T.href)+'"]');if(P)return _.instance=P,fr(P),P;var U=k({},T,{"data-href":T.href,"data-precedence":T.precedence,href:null,precedence:null});return P=(d.ownerDocument||d).createElement("style"),fr(P),ys(P,"style",U),Uo(P,T.precedence,d),_.instance=P;case"stylesheet":U=gg(T.href);var X=d.querySelector(jo(U));if(X)return _.state.loading|=4,_.instance=X,fr(X),X;P=Pw(T),(U=Mi.get(U))&&$x(P,U),X=(d.ownerDocument||d).createElement("link"),fr(X);var _e=X;return _e._p=new Promise(function(Be,ht){_e.onload=Be,_e.onerror=ht}),ys(X,"link",P),_.state.loading|=4,Uo(X,T.precedence,d),_.instance=X;case"script":return X=Cf(T.src),(U=d.querySelector(Hp(X)))?(_.instance=U,fr(U),U):(P=T,(U=Mi.get(X))&&(P=k({},T),ey(P,U)),d=d.ownerDocument||d,U=d.createElement("script"),fr(U),ys(U,"link",P),d.head.appendChild(U),_.instance=U);case"void":return null;default:throw Error(l(443,_.type))}else _.type==="stylesheet"&&(_.state.loading&4)===0&&(P=_.instance,_.state.loading|=4,Uo(P,T.precedence,d));return _.instance}function Uo(d,_,T){for(var P=T.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),U=P.length?P[P.length-1]:null,X=U,_e=0;_e<P.length;_e++){var Be=P[_e];if(Be.dataset.precedence===_)X=Be;else if(X!==U)break}X?X.parentNode.insertBefore(d,X.nextSibling):(_=T.nodeType===9?T.head:T,_.insertBefore(d,_.firstChild))}function $x(d,_){d.crossOrigin==null&&(d.crossOrigin=_.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=_.referrerPolicy),d.title==null&&(d.title=_.title)}function ey(d,_){d.crossOrigin==null&&(d.crossOrigin=_.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=_.referrerPolicy),d.integrity==null&&(d.integrity=_.integrity)}var If=null;function Xp(d,_,T){if(If===null){var P=new Map,U=If=new Map;U.set(T,P)}else U=If,P=U.get(T),P||(P=new Map,U.set(T,P));if(P.has(d))return P;for(P.set(d,null),T=T.getElementsByTagName(d),U=0;U<T.length;U++){var X=T[U];if(!(X[vt]||X[ze]||d==="link"&&X.getAttribute("rel")==="stylesheet")&&X.namespaceURI!=="http://www.w3.org/2000/svg"){var _e=X.getAttribute(_)||"";_e=d+_e;var Be=P.get(_e);Be?Be.push(X):P.set(_e,[X])}}return P}function qx(d,_,T){d=d.ownerDocument||d,d.head.insertBefore(T,_==="title"?d.querySelector("head > title"):null)}function Dw(d,_,T){if(T===1||_.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof _.precedence!="string"||typeof _.href!="string"||_.href==="")break;return!0;case"link":if(typeof _.rel!="string"||typeof _.href!="string"||_.href===""||_.onLoad||_.onError)break;return _.rel==="stylesheet"?(d=_.disabled,typeof _.precedence=="string"&&d==null):!0;case"script":if(_.async&&typeof _.async!="function"&&typeof _.async!="symbol"&&!_.onLoad&&!_.onError&&_.src&&typeof _.src=="string")return!0}return!1}function Hx(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function il(d,_,T,P){if(T.type==="stylesheet"&&(typeof P.media!="string"||matchMedia(P.media).matches!==!1)&&(T.state.loading&4)===0){if(T.instance===null){var U=gg(P.href),X=_.querySelector(jo(U));if(X){_=X._p,_!==null&&typeof _=="object"&&typeof _.then=="function"&&(d.count++,d=xd.bind(d),_.then(d,d)),T.state.loading|=4,T.instance=X,fr(X);return}X=_.ownerDocument||_,P=Pw(P),(U=Mi.get(U))&&$x(P,U),X=X.createElement("link"),fr(X);var _e=X;_e._p=new Promise(function(Be,ht){_e.onload=Be,_e.onerror=ht}),ys(X,"link",P),T.instance=X}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(T,_),(_=T.state.preload)&&(T.state.loading&3)===0&&(d.count++,T=xd.bind(d),_.addEventListener("load",T),_.addEventListener("error",T))}}var Zp=0;function Rw(d,_){return d.stylesheets&&d.count===0&&_g(d,d.stylesheets),0<d.count||0<d.imgCount?function(T){var P=setTimeout(function(){if(d.stylesheets&&_g(d,d.stylesheets),d.unsuspend){var X=d.unsuspend;d.unsuspend=null,X()}},6e4+_);0<d.imgBytes&&Zp===0&&(Zp=62500*Sw());var U=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&_g(d,d.stylesheets),d.unsuspend)){var X=d.unsuspend;d.unsuspend=null,X()}},(d.imgBytes>Zp?50:800)+_);return d.unsuspend=T,function(){d.unsuspend=null,clearTimeout(P),clearTimeout(U)}}:null}function xd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_g(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var rc=null;function _g(d,_){d.stylesheets=null,d.unsuspend!==null&&(d.count++,rc=new Map,_.forEach(Pf,d),rc=null,xd.call(d))}function Pf(d,_){if(!(_.state.loading&4)){var T=rc.get(d);if(T)var P=T.get(null);else{T=new Map,rc.set(d,T);for(var U=d.querySelectorAll("link[data-precedence],style[data-precedence]"),X=0;X<U.length;X++){var _e=U[X];(_e.nodeName==="LINK"||_e.getAttribute("media")!=="not all")&&(T.set(_e.dataset.precedence,_e),P=_e)}P&&T.set(null,P)}U=_.instance,_e=U.getAttribute("data-precedence"),X=T.get(_e)||P,X===P&&T.set(null,U),T.set(_e,U),this.count++,P=xd.bind(this),U.addEventListener("load",P),U.addEventListener("error",P),X?X.parentNode.insertBefore(U,X.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(U,d.firstChild)),_.state.loading|=4}}var Nc={$$typeof:me,Provider:null,Consumer:null,_currentValue:Ct,_currentValue2:Ct,_threadCount:0};function zv(d,_,T,P,U,X,_e,Be,ht){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tn(0),this.hiddenUpdates=Tn(null),this.identifierPrefix=P,this.onUncaughtError=U,this.onCaughtError=X,this.onRecoverableError=_e,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ht,this.incompleteTransitions=new Map}function Lv(d,_,T,P,U,X,_e,Be,ht,Vt,ir,pr){return d=new zv(d,_,T,_e,ht,Vt,ir,pr,Be),_=1,X===!0&&(_|=24),X=hs(3,null,null,_),d.current=X,X.stateNode=d,_=Qd(),_.refCount++,d.pooledCache=_,_.refCount++,X.memoizedState={element:P,isDehydrated:T,cache:_},xp(X),d}function Bv(d){return d?(d=bc,d):bc}function zw(d,_,T,P,U,X){U=Bv(U),P.context===null?P.context=U:P.pendingContext=U,P=Oc(_),P.payload={element:T},X=X===void 0?null:X,X!==null&&(P.callback=X),T=fu(d,P,_),T!==null&&(Nr(T,d,_),Kh(T,d,_))}function Lw(d,_){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var T=d.retryLane;d.retryLane=T!==0&&T<_?T:_}}function Xx(d,_){Lw(d,_),(d=d.alternate)&&Lw(d,_)}function Bw(d){if(d.tag===13||d.tag===31){var _=Gt(d,67108864);_!==null&&Nr(_,d,67108864),Xx(d,67108864)}}function Zx(d){if(d.tag===13||d.tag===31){var _=Dn();_=yr(_);var T=Gt(d,_);T!==null&&Nr(T,d,_),Xx(d,_)}}var ty=!0;function kv(d,_,T,P){var U=$e.T;$e.T=null;var X=rt.p;try{rt.p=2,yg(d,_,T,P)}finally{rt.p=X,$e.T=U}}function kw(d,_,T,P){var U=$e.T;$e.T=null;var X=rt.p;try{rt.p=8,yg(d,_,T,P)}finally{rt.p=X,$e.T=U}}function yg(d,_,T,P){if(ty){var U=Fv(P);if(U===null)Cv(d,_,P,Wp,T),ny(d,P);else if(jw(U,d,_,T,P))P.stopPropagation();else if(ny(d,P),_&4&&-1<Nw.indexOf(d)){for(;U!==null;){var X=vr(U);if(X!==null)switch(X.tag){case 3:if(X=X.stateNode,X.current.memoizedState.isDehydrated){var _e=pn(X.pendingLanes);if(_e!==0){var Be=X;for(Be.pendingLanes|=2,Be.entangledLanes|=2;_e;){var ht=1<<31-qi(_e);Be.entanglements[1]|=ht,_e&=~ht}fh(X),(Ve&6)===0&&(Vr=ni()+500,Ef(0))}}break;case 31:case 13:Be=Gt(X,2),Be!==null&&Nr(Be,X,2),Qn(),Xx(X,2)}if(X=Fv(P),X===null&&Cv(d,_,P,Wp,T),X===U)break;U=X}U!==null&&P.stopPropagation()}else Cv(d,_,P,null,T)}}function Fv(d){return d=Gu(d),Wx(d)}var Wp=null;function Wx(d){if(Wp=null,d=dr(d),d!==null){var _=v(d);if(_===null)d=null;else{var T=_.tag;if(T===13){if(d=w(_),d!==null)return d;d=null}else if(T===31){if(d=a(_),d!==null)return d;d=null}else if(T===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;d=null}else _!==d&&(d=null)}}return Wp=d,null}function Fw(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ii()){case no:return 2;case Ai:return 8;case ga:case Ha:return 32;case Zi:return 268435456;default:return 32}default:return 32}}var ry=!1,bd=null,_h=null,yh=null,vg=new Map,xg=new Map,wd=[],Nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ny(d,_){switch(d){case"focusin":case"focusout":bd=null;break;case"dragenter":case"dragleave":_h=null;break;case"mouseover":case"mouseout":yh=null;break;case"pointerover":case"pointerout":vg.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":xg.delete(_.pointerId)}}function Al(d,_,T,P,U,X){return d===null||d.nativeEvent!==X?(d={blockedOn:_,domEventName:T,eventSystemFlags:P,nativeEvent:X,targetContainers:[U]},_!==null&&(_=vr(_),_!==null&&Bw(_)),d):(d.eventSystemFlags|=P,_=d.targetContainers,U!==null&&_.indexOf(U)===-1&&_.push(U),d)}function jw(d,_,T,P,U){switch(_){case"focusin":return bd=Al(bd,d,_,T,P,U),!0;case"dragenter":return _h=Al(_h,d,_,T,P,U),!0;case"mouseover":return yh=Al(yh,d,_,T,P,U),!0;case"pointerover":var X=U.pointerId;return vg.set(X,Al(vg.get(X)||null,d,_,T,P,U)),!0;case"gotpointercapture":return X=U.pointerId,xg.set(X,Al(xg.get(X)||null,d,_,T,P,U)),!0}return!1}function Uw(d){var _=dr(d.target);if(_!==null){var T=v(_);if(T!==null){if(_=T.tag,_===13){if(_=w(T),_!==null){d.blockedOn=_,de(d.priority,function(){Zx(T)});return}}else if(_===31){if(_=a(T),_!==null){d.blockedOn=_,de(d.priority,function(){Zx(T)});return}}else if(_===3&&T.stateNode.current.memoizedState.isDehydrated){d.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Nv(d){if(d.blockedOn!==null)return!1;for(var _=d.targetContainers;0<_.length;){var T=Fv(d.nativeEvent);if(T===null){T=d.nativeEvent;var P=new T.constructor(T.type,T);fl=P,T.target.dispatchEvent(P),fl=null}else return _=vr(T),_!==null&&Bw(_),d.blockedOn=T,!1;_.shift()}return!0}function Vw(d,_,T){Nv(d)&&T.delete(_)}function MS(){ry=!1,bd!==null&&Nv(bd)&&(bd=null),_h!==null&&Nv(_h)&&(_h=null),yh!==null&&Nv(yh)&&(yh=null),vg.forEach(Vw),xg.forEach(Vw)}function jv(d,_){d.blockedOn===_&&(d.blockedOn=null,ry||(ry=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,MS)))}var Uv=null;function Gw(d){Uv!==d&&(Uv=d,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Uv===d&&(Uv=null);for(var _=0;_<d.length;_+=3){var T=d[_],P=d[_+1],U=d[_+2];if(typeof P!="function"){if(Wx(P||T)===null)continue;break}var X=vr(T);X!==null&&(d.splice(_,3),_-=3,Op(X,{pending:!0,data:U,method:T.method,action:P},P,U))}}))}function bg(d){function _(ht){return jv(ht,d)}bd!==null&&jv(bd,d),_h!==null&&jv(_h,d),yh!==null&&jv(yh,d),vg.forEach(_),xg.forEach(_);for(var T=0;T<wd.length;T++){var P=wd[T];P.blockedOn===d&&(P.blockedOn=null)}for(;0<wd.length&&(T=wd[0],T.blockedOn===null);)Uw(T),T.blockedOn===null&&wd.shift();if(T=(d.ownerDocument||d).$$reactFormReplay,T!=null)for(P=0;P<T.length;P+=3){var U=T[P],X=T[P+1],_e=U[Ee]||null;if(typeof X=="function")_e||Gw(T);else if(_e){var Be=null;if(X&&X.hasAttribute("formAction")){if(U=X,_e=X[Ee]||null)Be=_e.formAction;else if(Wx(U)!==null)continue}else Be=_e.action;typeof Be=="function"?T[P+1]=Be:(T.splice(P,3),P-=3),Gw(T)}}}function wg(){function d(X){X.canIntercept&&X.info==="react-transition"&&X.intercept({handler:function(){return new Promise(function(_e){return U=_e})},focusReset:"manual",scroll:"manual"})}function _(){U!==null&&(U(),U=null),P||setTimeout(T,20)}function T(){if(!P&&!navigation.transition){var X=navigation.currentEntry;X&&X.url!=null&&navigation.navigate(X.url,{state:X.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var P=!1,U=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",_),navigation.addEventListener("navigateerror",_),setTimeout(T,100),function(){P=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",_),navigation.removeEventListener("navigateerror",_),U!==null&&(U(),U=null)}}}function Yx(d){this._internalRoot=d}iy.prototype.render=Yx.prototype.render=function(d){var _=this._internalRoot;if(_===null)throw Error(l(409));var T=_.current,P=Dn();zw(T,P,d,_,null,null)},iy.prototype.unmount=Yx.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var _=d.containerInfo;zw(d.current,2,null,d,null,null),Qn(),_[Fe]=null}};function iy(d){this._internalRoot=d}iy.prototype.unstable_scheduleHydration=function(d){if(d){var _=ie();d={blockedOn:null,target:d,priority:_};for(var T=0;T<wd.length&&_!==0&&_<wd[T].priority;T++);wd.splice(T,0,d),T===0&&Uw(d)}};var ay=t.version;if(ay!=="19.2.3")throw Error(l(527,ay,"19.2.3"));rt.findDOMNode=function(d){var _=d._reactInternals;if(_===void 0)throw typeof d.render=="function"?Error(l(188)):(d=Object.keys(d).join(","),Error(l(268,d)));return d=I(_),d=d!==null?L(d):null,d=d===null?null:d.stateNode,d};var $w={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:$e,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ag=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ag.isDisabled&&Ag.supportsFiber)try{Cs=Ag.inject($w),Ci=Ag}catch{}}return C1.createRoot=function(d,_){if(!h(d))throw Error(l(299));var T=!1,P="",U=Tv,X=ai,_e=en;return _!=null&&(_.unstable_strictMode===!0&&(T=!0),_.identifierPrefix!==void 0&&(P=_.identifierPrefix),_.onUncaughtError!==void 0&&(U=_.onUncaughtError),_.onCaughtError!==void 0&&(X=_.onCaughtError),_.onRecoverableError!==void 0&&(_e=_.onRecoverableError)),_=Lv(d,1,!1,null,null,T,P,null,U,X,_e,wg),d[Fe]=_.current,Ov(d),new Yx(_)},C1.hydrateRoot=function(d,_,T){if(!h(d))throw Error(l(299));var P=!1,U="",X=Tv,_e=ai,Be=en,ht=null;return T!=null&&(T.unstable_strictMode===!0&&(P=!0),T.identifierPrefix!==void 0&&(U=T.identifierPrefix),T.onUncaughtError!==void 0&&(X=T.onUncaughtError),T.onCaughtError!==void 0&&(_e=T.onCaughtError),T.onRecoverableError!==void 0&&(Be=T.onRecoverableError),T.formState!==void 0&&(ht=T.formState)),_=Lv(d,1,!0,_,T??null,P,U,ht,X,_e,Be,wg),_.context=Bv(null),T=_.current,P=Dn(),P=yr(P),U=Oc(P),U.callback=null,fu(T,U,P),T=P,_.current.lanes=T,Jr(_,T),fh(_),d[Fe]=_.current,Ov(d),new iy(_)},C1.version="19.2.3",C1}var KB;function NH(){if(KB)return BE.exports;KB=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),BE.exports=FH(),BE.exports}var jH=NH();function em(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function DU(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var Nu={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},B0={duration:.5,overwrite:!1,delay:0},eD,ll,to,Ch=1e8,Aa=1/Ch,iI=Math.PI*2,UH=iI/4,VH=0,RU=Math.sqrt,GH=Math.cos,$H=Math.sin,Hs=function(t){return typeof t=="string"},Co=function(t){return typeof t=="function"},fm=function(t){return typeof t=="number"},tD=function(t){return typeof t>"u"},Hf=function(t){return typeof t=="object"},Gc=function(t){return t!==!1},rD=function(){return typeof window<"u"},I2=function(t){return Co(t)||Hs(t)},zU=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Rl=Array.isArray,qH=/random\([^)]+\)/g,HH=/,\s*/g,QB=/(?:-?\.?\d|\.)+/gi,LU=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,g0=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,jE=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,BU=/[+-]=-?[.\d]+/,XH=/[^,'"\[\]\s]+/gi,ZH=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,po,Bf,aI,nD,Uu={},_A={},kU,FU=function(t){return(_A=k0(t,Uu))&&Xc},iD=function(t,o){return console.warn("Invalid property",t,"set to",o,"Missing plugin? gsap.registerPlugin()")},yb=function(t,o){return!o&&console.warn(t)},NU=function(t,o){return t&&(Uu[t]=o)&&_A&&(_A[t]=o)||Uu},vb=function(){return 0},WH={suppressEvents:!0,isStart:!0,kill:!1},iA={suppressEvents:!0,kill:!1},YH={suppressEvents:!0},aD={},Vg=[],oI={},jU,Pu={},UE={},JB=30,aA=[],oD="",sD=function(t){var o=t[0],l,h;if(Hf(o)||Co(o)||(t=[t]),!(l=(o._gsap||{}).harness)){for(h=aA.length;h--&&!aA[h].targetTest(o););l=aA[h]}for(h=t.length;h--;)t[h]&&(t[h]._gsap||(t[h]._gsap=new u8(t[h],l)))||t.splice(h,1);return t},zy=function(t){return t._gsap||sD(Ih(t))[0]._gsap},UU=function(t,o,l){return(l=t[o])&&Co(l)?t[o]():tD(l)&&t.getAttribute&&t.getAttribute(o)||l},$c=function(t,o){return(t=t.split(",")).forEach(o)||t},Vo=function(t){return Math.round(t*1e5)/1e5||0},fo=function(t){return Math.round(t*1e7)/1e7||0},S0=function(t,o){var l=o.charAt(0),h=parseFloat(o.substr(2));return t=parseFloat(t),l==="+"?t+h:l==="-"?t-h:l==="*"?t*h:t/h},KH=function(t,o){for(var l=o.length,h=0;t.indexOf(o[h])<0&&++h<l;);return h<l},yA=function(){var t=Vg.length,o=Vg.slice(0),l,h;for(oI={},Vg.length=0,l=0;l<t;l++)h=o[l],h&&h._lazy&&(h.render(h._lazy[0],h._lazy[1],!0)._lazy=0)},lD=function(t){return!!(t._initted||t._startAt||t.add)},VU=function(t,o,l,h){Vg.length&&!ll&&yA(),t.render(o,l,!!(ll&&o<0&&lD(t))),Vg.length&&!ll&&yA()},GU=function(t){var o=parseFloat(t);return(o||o===0)&&(t+"").match(XH).length<2?o:Hs(t)?t.trim():t},$U=function(t){return t},Vu=function(t,o){for(var l in o)l in t||(t[l]=o[l]);return t},QH=function(t){return function(o,l){for(var h in l)h in o||h==="duration"&&t||h==="ease"||(o[h]=l[h])}},k0=function(t,o){for(var l in o)t[l]=o[l];return t},e5=function r(t,o){for(var l in o)l!=="__proto__"&&l!=="constructor"&&l!=="prototype"&&(t[l]=Hf(o[l])?r(t[l]||(t[l]={}),o[l]):o[l]);return t},vA=function(t,o){var l={},h;for(h in t)h in o||(l[h]=t[h]);return l},Q1=function(t){var o=t.parent||po,l=t.keyframes?QH(Rl(t.keyframes)):Vu;if(Gc(t.inherit))for(;o;)l(t,o.vars.defaults),o=o.parent||o._dp;return t},JH=function(t,o){for(var l=t.length,h=l===o.length;h&&l--&&t[l]===o[l];);return l<0},qU=function(t,o,l,h,v){var w=t[h],a;if(v)for(a=o[v];w&&w[v]>a;)w=w._prev;return w?(o._next=w._next,w._next=o):(o._next=t[l],t[l]=o),o._next?o._next._prev=o:t[h]=o,o._prev=w,o.parent=o._dp=t,o},OT=function(t,o,l,h){l===void 0&&(l="_first"),h===void 0&&(h="_last");var v=o._prev,w=o._next;v?v._next=w:t[l]===o&&(t[l]=w),w?w._prev=v:t[h]===o&&(t[h]=v),o._next=o._prev=o.parent=null},Hg=function(t,o){t.parent&&(!o||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Ly=function(t,o){if(t&&(!o||o._end>t._dur||o._start<0))for(var l=t;l;)l._dirty=1,l=l.parent;return t},eX=function(t){for(var o=t.parent;o&&o.parent;)o._dirty=1,o.totalDuration(),o=o.parent;return t},sI=function(t,o,l,h){return t._startAt&&(ll?t._startAt.revert(iA):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(o,!0,h))},tX=function r(t){return!t||t._ts&&r(t.parent)},t5=function(t){return t._repeat?F0(t._tTime,t=t.duration()+t._rDelay)*t:0},F0=function(t,o){var l=Math.floor(t=fo(t/o));return t&&l===t?l-1:l},xA=function(t,o){return(t-o._start)*o._ts+(o._ts>=0?0:o._dirty?o.totalDuration():o._tDur)},CT=function(t){return t._end=fo(t._start+(t._tDur/Math.abs(t._ts||t._rts||Aa)||0))},IT=function(t,o){var l=t._dp;return l&&l.smoothChildTiming&&t._ts&&(t._start=fo(l._time-(t._ts>0?o/t._ts:((t._dirty?t.totalDuration():t._tDur)-o)/-t._ts)),CT(t),l._dirty||Ly(l,t)),t},HU=function(t,o){var l;if((o._time||!o._dur&&o._initted||o._start<t._time&&(o._dur||!o.add))&&(l=xA(t.rawTime(),o),(!o._dur||lw(0,o.totalDuration(),l)-o._tTime>Aa)&&o.render(l,!0)),Ly(t,o)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(l=t;l._dp;)l.rawTime()>=0&&l.totalTime(l._tTime),l=l._dp;t._zTime=-Aa}},Ff=function(t,o,l,h){return o.parent&&Hg(o),o._start=fo((fm(l)?l:l||t!==po?Sh(t,l,o):t._time)+o._delay),o._end=fo(o._start+(o.totalDuration()/Math.abs(o.timeScale())||0)),qU(t,o,"_first","_last",t._sort?"_start":0),lI(o)||(t._recent=o),h||HU(t,o),t._ts<0&&IT(t,t._tTime),t},XU=function(t,o){return(Uu.ScrollTrigger||iD("scrollTrigger",o))&&Uu.ScrollTrigger.create(o,t)},ZU=function(t,o,l,h,v){if(uD(t,o,v),!t._initted)return 1;if(!l&&t._pt&&!ll&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&jU!==zu.frame)return Vg.push(t),t._lazy=[v,h],1},rX=function r(t){var o=t.parent;return o&&o._ts&&o._initted&&!o._lock&&(o.rawTime()<0||r(o))},lI=function(t){var o=t.data;return o==="isFromStart"||o==="isStart"},nX=function(t,o,l,h){var v=t.ratio,w=o<0||!o&&(!t._start&&rX(t)&&!(!t._initted&&lI(t))||(t._ts<0||t._dp._ts<0)&&!lI(t))?0:1,a=t._rDelay,C=0,I,L,k;if(a&&t._repeat&&(C=lw(0,t._tDur,o),L=F0(C,a),t._yoyo&&L&1&&(w=1-w),L!==F0(t._tTime,a)&&(v=1-w,t.vars.repeatRefresh&&t._initted&&t.invalidate())),w!==v||ll||h||t._zTime===Aa||!o&&t._zTime){if(!t._initted&&ZU(t,o,h,l,C))return;for(k=t._zTime,t._zTime=o||(l?Aa:0),l||(l=o&&!k),t.ratio=w,t._from&&(w=1-w),t._time=0,t._tTime=C,I=t._pt;I;)I.r(w,I.d),I=I._next;o<0&&sI(t,o,l,!0),t._onUpdate&&!l&&ku(t,"onUpdate"),C&&t._repeat&&!l&&t.parent&&ku(t,"onRepeat"),(o>=t._tDur||o<0)&&t.ratio===w&&(w&&Hg(t,1),!l&&!ll&&(ku(t,w?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=o)},iX=function(t,o,l){var h;if(l>o)for(h=t._first;h&&h._start<=l;){if(h.data==="isPause"&&h._start>o)return h;h=h._next}else for(h=t._last;h&&h._start>=l;){if(h.data==="isPause"&&h._start<o)return h;h=h._prev}},N0=function(t,o,l,h){var v=t._repeat,w=fo(o)||0,a=t._tTime/t._tDur;return a&&!h&&(t._time*=w/t._dur),t._dur=w,t._tDur=v?v<0?1e10:fo(w*(v+1)+t._rDelay*v):w,a>0&&!h&&IT(t,t._tTime=t._tDur*a),t.parent&&CT(t),l||Ly(t.parent,t),t},r5=function(t){return t instanceof hc?Ly(t):N0(t,t._dur)},aX={_start:0,endTime:vb,totalDuration:vb},Sh=function r(t,o,l){var h=t.labels,v=t._recent||aX,w=t.duration()>=Ch?v.endTime(!1):t._dur,a,C,I;return Hs(o)&&(isNaN(o)||o in h)?(C=o.charAt(0),I=o.substr(-1)==="%",a=o.indexOf("="),C==="<"||C===">"?(a>=0&&(o=o.replace(/=/,"")),(C==="<"?v._start:v.endTime(v._repeat>=0))+(parseFloat(o.substr(1))||0)*(I?(a<0?v:l).totalDuration()/100:1)):a<0?(o in h||(h[o]=w),h[o]):(C=parseFloat(o.charAt(a-1)+o.substr(a+1)),I&&l&&(C=C/100*(Rl(l)?l[0]:l).totalDuration()),a>1?r(t,o.substr(0,a-1),l)+C:w+C)):o==null?w:+o},J1=function(t,o,l){var h=fm(o[1]),v=(h?2:1)+(t<2?0:1),w=o[v],a,C;if(h&&(w.duration=o[1]),w.parent=l,t){for(a=w,C=l;C&&!("immediateRender"in a);)a=C.vars.defaults||{},C=Gc(C.vars.inherit)&&C.parent;w.immediateRender=Gc(a.immediateRender),t<2?w.runBackwards=1:w.startAt=o[v-1]}return new ns(o[0],w,o[v+1])},Yg=function(t,o){return t||t===0?o(t):o},lw=function(t,o,l){return l<t?t:l>o?o:l},Pl=function(t,o){return!Hs(t)||!(o=ZH.exec(t))?"":o[1]},oX=function(t,o,l){return Yg(l,function(h){return lw(t,o,h)})},cI=[].slice,WU=function(t,o){return t&&Hf(t)&&"length"in t&&(!o&&!t.length||t.length-1 in t&&Hf(t[0]))&&!t.nodeType&&t!==Bf},sX=function(t,o,l){return l===void 0&&(l=[]),t.forEach(function(h){var v;return Hs(h)&&!o||WU(h,1)?(v=l).push.apply(v,Ih(h)):l.push(h)})||l},Ih=function(t,o,l){return to&&!o&&to.selector?to.selector(t):Hs(t)&&!l&&(aI||!j0())?cI.call((o||nD).querySelectorAll(t),0):Rl(t)?sX(t,l):WU(t)?cI.call(t,0):t?[t]:[]},uI=function(t){return t=Ih(t)[0]||yb("Invalid scope")||{},function(o){var l=t.current||t.nativeElement||t;return Ih(o,l.querySelectorAll?l:l===t?yb("Invalid scope")||nD.createElement("div"):t)}},YU=function(t){return t.sort(function(){return .5-Math.random()})},KU=function(t){if(Co(t))return t;var o=Hf(t)?t:{each:t},l=By(o.ease),h=o.from||0,v=parseFloat(o.base)||0,w={},a=h>0&&h<1,C=isNaN(h)||a,I=o.axis,L=h,k=h;return Hs(h)?L=k={center:.5,edges:.5,end:1}[h]||0:!a&&C&&(L=h[0],k=h[1]),function(G,q,Q){var H=(Q||o).length,K=w[H],he,ue,me,ge,se,fe,ve,Le,Ue;if(!K){if(Ue=o.grid==="auto"?0:(o.grid||[1,Ch])[1],!Ue){for(ve=-Ch;ve<(ve=Q[Ue++].getBoundingClientRect().left)&&Ue<H;);Ue<H&&Ue--}for(K=w[H]=[],he=C?Math.min(Ue,H)*L-.5:h%Ue,ue=Ue===Ch?0:C?H*k/Ue-.5:h/Ue|0,ve=0,Le=Ch,fe=0;fe<H;fe++)me=fe%Ue-he,ge=ue-(fe/Ue|0),K[fe]=se=I?Math.abs(I==="y"?ge:me):RU(me*me+ge*ge),se>ve&&(ve=se),se<Le&&(Le=se);h==="random"&&YU(K),K.max=ve-Le,K.min=Le,K.v=H=(parseFloat(o.amount)||parseFloat(o.each)*(Ue>H?H-1:I?I==="y"?H/Ue:Ue:Math.max(Ue,H/Ue))||0)*(h==="edges"?-1:1),K.b=H<0?v-H:v,K.u=Pl(o.amount||o.each)||0,l=l&&H<0?s8(l):l}return H=(K[G]-K.min)/K.max||0,fo(K.b+(l?l(H):H)*K.v)+K.u}},hI=function(t){var o=Math.pow(10,((t+"").split(".")[1]||"").length);return function(l){var h=fo(Math.round(parseFloat(l)/t)*t*o);return(h-h%1)/o+(fm(l)?0:Pl(l))}},QU=function(t,o){var l=Rl(t),h,v;return!l&&Hf(t)&&(h=l=t.radius||Ch,t.values?(t=Ih(t.values),(v=!fm(t[0]))&&(h*=h)):t=hI(t.increment)),Yg(o,l?Co(t)?function(w){return v=t(w),Math.abs(v-w)<=h?v:w}:function(w){for(var a=parseFloat(v?w.x:w),C=parseFloat(v?w.y:0),I=Ch,L=0,k=t.length,G,q;k--;)v?(G=t[k].x-a,q=t[k].y-C,G=G*G+q*q):G=Math.abs(t[k]-a),G<I&&(I=G,L=k);return L=!h||I<=h?t[L]:w,v||L===w||fm(w)?L:L+Pl(w)}:hI(t))},JU=function(t,o,l,h){return Yg(Rl(t)?!o:l===!0?!!(l=0):!h,function(){return Rl(t)?t[~~(Math.random()*t.length)]:(l=l||1e-5)&&(h=l<1?Math.pow(10,(l+"").length-2):1)&&Math.floor(Math.round((t-l/2+Math.random()*(o-t+l*.99))/l)*l*h)/h})},lX=function(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];return function(h){return o.reduce(function(v,w){return w(v)},h)}},cX=function(t,o){return function(l){return t(parseFloat(l))+(o||Pl(l))}},uX=function(t,o,l){return t8(t,o,0,1,l)},e8=function(t,o,l){return Yg(l,function(h){return t[~~o(h)]})},hX=function r(t,o,l){var h=o-t;return Rl(t)?e8(t,r(0,t.length),o):Yg(l,function(v){return(h+(v-t)%h)%h+t})},dX=function r(t,o,l){var h=o-t,v=h*2;return Rl(t)?e8(t,r(0,t.length-1),o):Yg(l,function(w){return w=(v+(w-t)%v)%v||0,t+(w>h?v-w:w)})},xb=function(t){return t.replace(qH,function(o){var l=o.indexOf("[")+1,h=o.substring(l||7,l?o.indexOf("]"):o.length-1).split(HH);return JU(l?h:+h[0],l?0:+h[1],+h[2]||1e-5)})},t8=function(t,o,l,h,v){var w=o-t,a=h-l;return Yg(v,function(C){return l+((C-t)/w*a||0)})},fX=function r(t,o,l,h){var v=isNaN(t+o)?0:function(q){return(1-q)*t+q*o};if(!v){var w=Hs(t),a={},C,I,L,k,G;if(l===!0&&(h=1)&&(l=null),w)t={p:t},o={p:o};else if(Rl(t)&&!Rl(o)){for(L=[],k=t.length,G=k-2,I=1;I<k;I++)L.push(r(t[I-1],t[I]));k--,v=function(Q){Q*=k;var H=Math.min(G,~~Q);return L[H](Q-H)},l=o}else h||(t=k0(Rl(t)?[]:{},t));if(!L){for(C in o)cD.call(a,t,C,"get",o[C]);v=function(Q){return fD(Q,a)||(w?t.p:t)}}}return Yg(l,v)},n5=function(t,o,l){var h=t.labels,v=Ch,w,a,C;for(w in h)a=h[w]-o,a<0==!!l&&a&&v>(a=Math.abs(a))&&(C=w,v=a);return C},ku=function(t,o,l){var h=t.vars,v=h[o],w=to,a=t._ctx,C,I,L;if(v)return C=h[o+"Params"],I=h.callbackScope||t,l&&Vg.length&&yA(),a&&(to=a),L=C?v.apply(I,C):v.call(I),to=w,L},V1=function(t){return Hg(t),t.scrollTrigger&&t.scrollTrigger.kill(!!ll),t.progress()<1&&ku(t,"onInterrupt"),t},_0,r8=[],n8=function(t){if(t)if(t=!t.name&&t.default||t,rD()||t.headless){var o=t.name,l=Co(t),h=o&&!l&&t.init?function(){this._props=[]}:t,v={init:vb,render:fD,add:cD,kill:CX,modifier:OX,rawVars:0},w={targetTest:0,get:0,getSetter:dD,aliases:{},register:0};if(j0(),t!==h){if(Pu[o])return;Vu(h,Vu(vA(t,v),w)),k0(h.prototype,k0(v,vA(t,w))),Pu[h.prop=o]=h,t.targetTest&&(aA.push(h),aD[o]=1),o=(o==="css"?"CSS":o.charAt(0).toUpperCase()+o.substr(1))+"Plugin"}NU(o,h),t.register&&t.register(Xc,h,qc)}else r8.push(t)},wa=255,G1={aqua:[0,wa,wa],lime:[0,wa,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,wa],navy:[0,0,128],white:[wa,wa,wa],olive:[128,128,0],yellow:[wa,wa,0],orange:[wa,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[wa,0,0],pink:[wa,192,203],cyan:[0,wa,wa],transparent:[wa,wa,wa,0]},VE=function(t,o,l){return t+=t<0?1:t>1?-1:0,(t*6<1?o+(l-o)*t*6:t<.5?l:t*3<2?o+(l-o)*(2/3-t)*6:o)*wa+.5|0},i8=function(t,o,l){var h=t?fm(t)?[t>>16,t>>8&wa,t&wa]:0:G1.black,v,w,a,C,I,L,k,G,q,Q;if(!h){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),G1[t])h=G1[t];else if(t.charAt(0)==="#"){if(t.length<6&&(v=t.charAt(1),w=t.charAt(2),a=t.charAt(3),t="#"+v+v+w+w+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return h=parseInt(t.substr(1,6),16),[h>>16,h>>8&wa,h&wa,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),h=[t>>16,t>>8&wa,t&wa]}else if(t.substr(0,3)==="hsl"){if(h=Q=t.match(QB),!o)C=+h[0]%360/360,I=+h[1]/100,L=+h[2]/100,w=L<=.5?L*(I+1):L+I-L*I,v=L*2-w,h.length>3&&(h[3]*=1),h[0]=VE(C+1/3,v,w),h[1]=VE(C,v,w),h[2]=VE(C-1/3,v,w);else if(~t.indexOf("="))return h=t.match(LU),l&&h.length<4&&(h[3]=1),h}else h=t.match(QB)||G1.transparent;h=h.map(Number)}return o&&!Q&&(v=h[0]/wa,w=h[1]/wa,a=h[2]/wa,k=Math.max(v,w,a),G=Math.min(v,w,a),L=(k+G)/2,k===G?C=I=0:(q=k-G,I=L>.5?q/(2-k-G):q/(k+G),C=k===v?(w-a)/q+(w<a?6:0):k===w?(a-v)/q+2:(v-w)/q+4,C*=60),h[0]=~~(C+.5),h[1]=~~(I*100+.5),h[2]=~~(L*100+.5)),l&&h.length<4&&(h[3]=1),h},a8=function(t){var o=[],l=[],h=-1;return t.split(Gg).forEach(function(v){var w=v.match(g0)||[];o.push.apply(o,w),l.push(h+=w.length+1)}),o.c=l,o},i5=function(t,o,l){var h="",v=(t+h).match(Gg),w=o?"hsla(":"rgba(",a=0,C,I,L,k;if(!v)return t;if(v=v.map(function(G){return(G=i8(G,o,1))&&w+(o?G[0]+","+G[1]+"%,"+G[2]+"%,"+G[3]:G.join(","))+")"}),l&&(L=a8(t),C=l.c,C.join(h)!==L.c.join(h)))for(I=t.replace(Gg,"1").split(g0),k=I.length-1;a<k;a++)h+=I[a]+(~C.indexOf(a)?v.shift()||w+"0,0,0,0)":(L.length?L:v.length?v:l).shift());if(!I)for(I=t.split(Gg),k=I.length-1;a<k;a++)h+=I[a]+v[a];return h+I[k]},Gg=(function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in G1)r+="|"+t+"\\b";return new RegExp(r+")","gi")})(),pX=/hsl[a]?\(/,o8=function(t){var o=t.join(" "),l;if(Gg.lastIndex=0,Gg.test(o))return l=pX.test(o),t[1]=i5(t[1],l),t[0]=i5(t[0],l,a8(t[1])),!0},bb,zu=(function(){var r=Date.now,t=500,o=33,l=r(),h=l,v=1e3/240,w=v,a=[],C,I,L,k,G,q,Q=function H(K){var he=r()-h,ue=K===!0,me,ge,se,fe;if((he>t||he<0)&&(l+=he-o),h+=he,se=h-l,me=se-w,(me>0||ue)&&(fe=++k.frame,G=se-k.time*1e3,k.time=se=se/1e3,w+=me+(me>=v?4:v-me),ge=1),ue||(C=I(H)),ge)for(q=0;q<a.length;q++)a[q](se,G,fe,K)};return k={time:0,frame:0,tick:function(){Q(!0)},deltaRatio:function(K){return G/(1e3/(K||60))},wake:function(){kU&&(!aI&&rD()&&(Bf=aI=window,nD=Bf.document||{},Uu.gsap=Xc,(Bf.gsapVersions||(Bf.gsapVersions=[])).push(Xc.version),FU(_A||Bf.GreenSockGlobals||!Bf.gsap&&Bf||{}),r8.forEach(n8)),L=typeof requestAnimationFrame<"u"&&requestAnimationFrame,C&&k.sleep(),I=L||function(K){return setTimeout(K,w-k.time*1e3+1|0)},bb=1,Q(2))},sleep:function(){(L?cancelAnimationFrame:clearTimeout)(C),bb=0,I=vb},lagSmoothing:function(K,he){t=K||1/0,o=Math.min(he||33,t)},fps:function(K){v=1e3/(K||240),w=k.time*1e3+v},add:function(K,he,ue){var me=he?function(ge,se,fe,ve){K(ge,se,fe,ve),k.remove(me)}:K;return k.remove(K),a[ue?"unshift":"push"](me),j0(),me},remove:function(K,he){~(he=a.indexOf(K))&&a.splice(he,1)&&q>=he&&q--},_listeners:a},k})(),j0=function(){return!bb&&zu.wake()},Li={},mX=/^[\d.\-M][\d.\-,\s]/,gX=/["']/g,_X=function(t){for(var o={},l=t.substr(1,t.length-3).split(":"),h=l[0],v=1,w=l.length,a,C,I;v<w;v++)C=l[v],a=v!==w-1?C.lastIndexOf(","):C.length,I=C.substr(0,a),o[h]=isNaN(I)?I.replace(gX,"").trim():+I,h=C.substr(a+1).trim();return o},yX=function(t){var o=t.indexOf("(")+1,l=t.indexOf(")"),h=t.indexOf("(",o);return t.substring(o,~h&&h<l?t.indexOf(")",l+1):l)},vX=function(t){var o=(t+"").split("("),l=Li[o[0]];return l&&o.length>1&&l.config?l.config.apply(null,~t.indexOf("{")?[_X(o[1])]:yX(t).split(",").map(GU)):Li._CE&&mX.test(t)?Li._CE("",t):l},s8=function(t){return function(o){return 1-t(1-o)}},l8=function r(t,o){for(var l=t._first,h;l;)l instanceof hc?r(l,o):l.vars.yoyoEase&&(!l._yoyo||!l._repeat)&&l._yoyo!==o&&(l.timeline?r(l.timeline,o):(h=l._ease,l._ease=l._yEase,l._yEase=h,l._yoyo=o)),l=l._next},By=function(t,o){return t&&(Co(t)?t:Li[t]||vX(t))||o},ev=function(t,o,l,h){l===void 0&&(l=function(C){return 1-o(1-C)}),h===void 0&&(h=function(C){return C<.5?o(C*2)/2:1-o((1-C)*2)/2});var v={easeIn:o,easeOut:l,easeInOut:h},w;return $c(t,function(a){Li[a]=Uu[a]=v,Li[w=a.toLowerCase()]=l;for(var C in v)Li[w+(C==="easeIn"?".in":C==="easeOut"?".out":".inOut")]=Li[a+"."+C]=v[C]}),v},c8=function(t){return function(o){return o<.5?(1-t(1-o*2))/2:.5+t((o-.5)*2)/2}},GE=function r(t,o,l){var h=o>=1?o:1,v=(l||(t?.3:.45))/(o<1?o:1),w=v/iI*(Math.asin(1/h)||0),a=function(L){return L===1?1:h*Math.pow(2,-10*L)*$H((L-w)*v)+1},C=t==="out"?a:t==="in"?function(I){return 1-a(1-I)}:c8(a);return v=iI/v,C.config=function(I,L){return r(t,I,L)},C},$E=function r(t,o){o===void 0&&(o=1.70158);var l=function(w){return w?--w*w*((o+1)*w+o)+1:0},h=t==="out"?l:t==="in"?function(v){return 1-l(1-v)}:c8(l);return h.config=function(v){return r(t,v)},h};$c("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,t){var o=t<5?t+1:t;ev(r+",Power"+(o-1),t?function(l){return Math.pow(l,o)}:function(l){return l},function(l){return 1-Math.pow(1-l,o)},function(l){return l<.5?Math.pow(l*2,o)/2:1-Math.pow((1-l)*2,o)/2})});Li.Linear.easeNone=Li.none=Li.Linear.easeIn;ev("Elastic",GE("in"),GE("out"),GE());(function(r,t){var o=1/t,l=2*o,h=2.5*o,v=function(a){return a<o?r*a*a:a<l?r*Math.pow(a-1.5/t,2)+.75:a<h?r*(a-=2.25/t)*a+.9375:r*Math.pow(a-2.625/t,2)+.984375};ev("Bounce",function(w){return 1-v(1-w)},v)})(7.5625,2.75);ev("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});ev("Circ",function(r){return-(RU(1-r*r)-1)});ev("Sine",function(r){return r===1?1:-GH(r*UH)+1});ev("Back",$E("in"),$E("out"),$E());Li.SteppedEase=Li.steps=Uu.SteppedEase={config:function(t,o){t===void 0&&(t=1);var l=1/t,h=t+(o?0:1),v=o?1:0,w=1-Aa;return function(a){return((h*lw(0,w,a)|0)+v)*l}}};B0.ease=Li["quad.out"];$c("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return oD+=r+","+r+"Params,"});var u8=function(t,o){this.id=VH++,t._gsap=this,this.target=t,this.harness=o,this.get=o?o.get:UU,this.set=o?o.getSetter:dD},wb=(function(){function r(o){this.vars=o,this._delay=+o.delay||0,(this._repeat=o.repeat===1/0?-2:o.repeat||0)&&(this._rDelay=o.repeatDelay||0,this._yoyo=!!o.yoyo||!!o.yoyoEase),this._ts=1,N0(this,+o.duration,1,1),this.data=o.data,to&&(this._ctx=to,to.data.push(this)),bb||zu.wake()}var t=r.prototype;return t.delay=function(l){return l||l===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+l-this._delay),this._delay=l,this):this._delay},t.duration=function(l){return arguments.length?this.totalDuration(this._repeat>0?l+(l+this._rDelay)*this._repeat:l):this.totalDuration()&&this._dur},t.totalDuration=function(l){return arguments.length?(this._dirty=0,N0(this,this._repeat<0?l:(l-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(l,h){if(j0(),!arguments.length)return this._tTime;var v=this._dp;if(v&&v.smoothChildTiming&&this._ts){for(IT(this,l),!v._dp||v.parent||HU(v,this);v&&v.parent;)v.parent._time!==v._start+(v._ts>=0?v._tTime/v._ts:(v.totalDuration()-v._tTime)/-v._ts)&&v.totalTime(v._tTime,!0),v=v.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&l<this._tDur||this._ts<0&&l>0||!this._tDur&&!l)&&Ff(this._dp,this,this._start-this._delay)}return(this._tTime!==l||!this._dur&&!h||this._initted&&Math.abs(this._zTime)===Aa||!this._initted&&this._dur&&l||!l&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=l),VU(this,l,h)),this},t.time=function(l,h){return arguments.length?this.totalTime(Math.min(this.totalDuration(),l+t5(this))%(this._dur+this._rDelay)||(l?this._dur:0),h):this._time},t.totalProgress=function(l,h){return arguments.length?this.totalTime(this.totalDuration()*l,h):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(l,h){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-l:l)+t5(this),h):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(l,h){var v=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(l-1)*v,h):this._repeat?F0(this._tTime,v)+1:1},t.timeScale=function(l,h){if(!arguments.length)return this._rts===-Aa?0:this._rts;if(this._rts===l)return this;var v=this.parent&&this._ts?xA(this.parent._time,this):this._tTime;return this._rts=+l||0,this._ts=this._ps||l===-Aa?0:this._rts,this.totalTime(lw(-Math.abs(this._delay),this.totalDuration(),v),h!==!1),CT(this),eX(this)},t.paused=function(l){return arguments.length?(this._ps!==l&&(this._ps=l,l?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(j0(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Aa&&(this._tTime-=Aa)))),this):this._ps},t.startTime=function(l){if(arguments.length){this._start=fo(l);var h=this.parent||this._dp;return h&&(h._sort||!this.parent)&&Ff(h,this,this._start-this._delay),this}return this._start},t.endTime=function(l){return this._start+(Gc(l)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(l){var h=this.parent||this._dp;return h?l&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?xA(h.rawTime(l),this):this._tTime:this._tTime},t.revert=function(l){l===void 0&&(l=YH);var h=ll;return ll=l,lD(this)&&(this.timeline&&this.timeline.revert(l),this.totalTime(-.01,l.suppressEvents)),this.data!=="nested"&&l.kill!==!1&&this.kill(),ll=h,this},t.globalTime=function(l){for(var h=this,v=arguments.length?l:h.rawTime();h;)v=h._start+v/(Math.abs(h._ts)||1),h=h._dp;return!this.parent&&this._sat?this._sat.globalTime(l):v},t.repeat=function(l){return arguments.length?(this._repeat=l===1/0?-2:l,r5(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(l){if(arguments.length){var h=this._time;return this._rDelay=l,r5(this),h?this.time(h):this}return this._rDelay},t.yoyo=function(l){return arguments.length?(this._yoyo=l,this):this._yoyo},t.seek=function(l,h){return this.totalTime(Sh(this,l),Gc(h))},t.restart=function(l,h){return this.play().totalTime(l?-this._delay:0,Gc(h)),this._dur||(this._zTime=-Aa),this},t.play=function(l,h){return l!=null&&this.seek(l,h),this.reversed(!1).paused(!1)},t.reverse=function(l,h){return l!=null&&this.seek(l||this.totalDuration(),h),this.reversed(!0).paused(!1)},t.pause=function(l,h){return l!=null&&this.seek(l,h),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(l){return arguments.length?(!!l!==this.reversed()&&this.timeScale(-this._rts||(l?-Aa:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-Aa,this},t.isActive=function(){var l=this.parent||this._dp,h=this._start,v;return!!(!l||this._ts&&this._initted&&l.isActive()&&(v=l.rawTime(!0))>=h&&v<this.endTime(!0)-Aa)},t.eventCallback=function(l,h,v){var w=this.vars;return arguments.length>1?(h?(w[l]=h,v&&(w[l+"Params"]=v),l==="onUpdate"&&(this._onUpdate=h)):delete w[l],this):w[l]},t.then=function(l){var h=this,v=h._prom;return new Promise(function(w){var a=Co(l)?l:$U,C=function(){var L=h.then;h.then=null,v&&v(),Co(a)&&(a=a(h))&&(a.then||a===h)&&(h.then=L),w(a),h.then=L};h._initted&&h.totalProgress()===1&&h._ts>=0||!h._tTime&&h._ts<0?C():h._prom=C})},t.kill=function(){V1(this)},r})();Vu(wb.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Aa,_prom:0,_ps:!1,_rts:1});var hc=(function(r){DU(t,r);function t(l,h){var v;return l===void 0&&(l={}),v=r.call(this,l)||this,v.labels={},v.smoothChildTiming=!!l.smoothChildTiming,v.autoRemoveChildren=!!l.autoRemoveChildren,v._sort=Gc(l.sortChildren),po&&Ff(l.parent||po,em(v),h),l.reversed&&v.reverse(),l.paused&&v.paused(!0),l.scrollTrigger&&XU(em(v),l.scrollTrigger),v}var o=t.prototype;return o.to=function(h,v,w){return J1(0,arguments,this),this},o.from=function(h,v,w){return J1(1,arguments,this),this},o.fromTo=function(h,v,w,a){return J1(2,arguments,this),this},o.set=function(h,v,w){return v.duration=0,v.parent=this,Q1(v).repeatDelay||(v.repeat=0),v.immediateRender=!!v.immediateRender,new ns(h,v,Sh(this,w),1),this},o.call=function(h,v,w){return Ff(this,ns.delayedCall(0,h,v),w)},o.staggerTo=function(h,v,w,a,C,I,L){return w.duration=v,w.stagger=w.stagger||a,w.onComplete=I,w.onCompleteParams=L,w.parent=this,new ns(h,w,Sh(this,C)),this},o.staggerFrom=function(h,v,w,a,C,I,L){return w.runBackwards=1,Q1(w).immediateRender=Gc(w.immediateRender),this.staggerTo(h,v,w,a,C,I,L)},o.staggerFromTo=function(h,v,w,a,C,I,L,k){return a.startAt=w,Q1(a).immediateRender=Gc(a.immediateRender),this.staggerTo(h,v,a,C,I,L,k)},o.render=function(h,v,w){var a=this._time,C=this._dirty?this.totalDuration():this._tDur,I=this._dur,L=h<=0?0:fo(h),k=this._zTime<0!=h<0&&(this._initted||!I),G,q,Q,H,K,he,ue,me,ge,se,fe,ve;if(this!==po&&L>C&&h>=0&&(L=C),L!==this._tTime||w||k){if(a!==this._time&&I&&(L+=this._time-a,h+=this._time-a),G=L,ge=this._start,me=this._ts,he=!me,k&&(I||(a=this._zTime),(h||!v)&&(this._zTime=h)),this._repeat){if(fe=this._yoyo,K=I+this._rDelay,this._repeat<-1&&h<0)return this.totalTime(K*100+h,v,w);if(G=fo(L%K),L===C?(H=this._repeat,G=I):(se=fo(L/K),H=~~se,H&&H===se&&(G=I,H--),G>I&&(G=I)),se=F0(this._tTime,K),!a&&this._tTime&&se!==H&&this._tTime-se*K-this._dur<=0&&(se=H),fe&&H&1&&(G=I-G,ve=1),H!==se&&!this._lock){var Le=fe&&se&1,Ue=Le===(fe&&H&1);if(H<se&&(Le=!Le),a=Le?0:L%I?I:L,this._lock=1,this.render(a||(ve?0:fo(H*K)),v,!I)._lock=0,this._tTime=L,!v&&this.parent&&ku(this,"onRepeat"),this.vars.repeatRefresh&&!ve&&(this.invalidate()._lock=1,se=H),a&&a!==this._time||he!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(I=this._dur,C=this._tDur,Ue&&(this._lock=2,a=Le?I:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!ve&&this.invalidate()),this._lock=0,!this._ts&&!he)return this;l8(this,ve)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(ue=iX(this,fo(a),fo(G)),ue&&(L-=G-(G=ue._start))),this._tTime=L,this._time=G,this._act=!me,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=h,a=0),!a&&L&&I&&!v&&!se&&(ku(this,"onStart"),this._tTime!==L))return this;if(G>=a&&h>=0)for(q=this._first;q;){if(Q=q._next,(q._act||G>=q._start)&&q._ts&&ue!==q){if(q.parent!==this)return this.render(h,v,w);if(q.render(q._ts>0?(G-q._start)*q._ts:(q._dirty?q.totalDuration():q._tDur)+(G-q._start)*q._ts,v,w),G!==this._time||!this._ts&&!he){ue=0,Q&&(L+=this._zTime=-Aa);break}}q=Q}else{q=this._last;for(var tt=h<0?h:G;q;){if(Q=q._prev,(q._act||tt<=q._end)&&q._ts&&ue!==q){if(q.parent!==this)return this.render(h,v,w);if(q.render(q._ts>0?(tt-q._start)*q._ts:(q._dirty?q.totalDuration():q._tDur)+(tt-q._start)*q._ts,v,w||ll&&lD(q)),G!==this._time||!this._ts&&!he){ue=0,Q&&(L+=this._zTime=tt?-Aa:Aa);break}}q=Q}}if(ue&&!v&&(this.pause(),ue.render(G>=a?0:-Aa)._zTime=G>=a?1:-1,this._ts))return this._start=ge,CT(this),this.render(h,v,w);this._onUpdate&&!v&&ku(this,"onUpdate",!0),(L===C&&this._tTime>=this.totalDuration()||!L&&a)&&(ge===this._start||Math.abs(me)!==Math.abs(this._ts))&&(this._lock||((h||!I)&&(L===C&&this._ts>0||!L&&this._ts<0)&&Hg(this,1),!v&&!(h<0&&!a)&&(L||a||!C)&&(ku(this,L===C&&h>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(L<C&&this.timeScale()>0)&&this._prom())))}return this},o.add=function(h,v){var w=this;if(fm(v)||(v=Sh(this,v,h)),!(h instanceof wb)){if(Rl(h))return h.forEach(function(a){return w.add(a,v)}),this;if(Hs(h))return this.addLabel(h,v);if(Co(h))h=ns.delayedCall(0,h);else return this}return this!==h?Ff(this,h,v):this},o.getChildren=function(h,v,w,a){h===void 0&&(h=!0),v===void 0&&(v=!0),w===void 0&&(w=!0),a===void 0&&(a=-Ch);for(var C=[],I=this._first;I;)I._start>=a&&(I instanceof ns?v&&C.push(I):(w&&C.push(I),h&&C.push.apply(C,I.getChildren(!0,v,w)))),I=I._next;return C},o.getById=function(h){for(var v=this.getChildren(1,1,1),w=v.length;w--;)if(v[w].vars.id===h)return v[w]},o.remove=function(h){return Hs(h)?this.removeLabel(h):Co(h)?this.killTweensOf(h):(h.parent===this&&OT(this,h),h===this._recent&&(this._recent=this._last),Ly(this))},o.totalTime=function(h,v){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=fo(zu.time-(this._ts>0?h/this._ts:(this.totalDuration()-h)/-this._ts))),r.prototype.totalTime.call(this,h,v),this._forcing=0,this):this._tTime},o.addLabel=function(h,v){return this.labels[h]=Sh(this,v),this},o.removeLabel=function(h){return delete this.labels[h],this},o.addPause=function(h,v,w){var a=ns.delayedCall(0,v||vb,w);return a.data="isPause",this._hasPause=1,Ff(this,a,Sh(this,h))},o.removePause=function(h){var v=this._first;for(h=Sh(this,h);v;)v._start===h&&v.data==="isPause"&&Hg(v),v=v._next},o.killTweensOf=function(h,v,w){for(var a=this.getTweensOf(h,w),C=a.length;C--;)Lg!==a[C]&&a[C].kill(h,v);return this},o.getTweensOf=function(h,v){for(var w=[],a=Ih(h),C=this._first,I=fm(v),L;C;)C instanceof ns?KH(C._targets,a)&&(I?(!Lg||C._initted&&C._ts)&&C.globalTime(0)<=v&&C.globalTime(C.totalDuration())>v:!v||C.isActive())&&w.push(C):(L=C.getTweensOf(a,v)).length&&w.push.apply(w,L),C=C._next;return w},o.tweenTo=function(h,v){v=v||{};var w=this,a=Sh(w,h),C=v,I=C.startAt,L=C.onStart,k=C.onStartParams,G=C.immediateRender,q,Q=ns.to(w,Vu({ease:v.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:v.duration||Math.abs((a-(I&&"time"in I?I.time:w._time))/w.timeScale())||Aa,onStart:function(){if(w.pause(),!q){var K=v.duration||Math.abs((a-(I&&"time"in I?I.time:w._time))/w.timeScale());Q._dur!==K&&N0(Q,K,0,1).render(Q._time,!0,!0),q=1}L&&L.apply(Q,k||[])}},v));return G?Q.render(0):Q},o.tweenFromTo=function(h,v,w){return this.tweenTo(v,Vu({startAt:{time:Sh(this,h)}},w))},o.recent=function(){return this._recent},o.nextLabel=function(h){return h===void 0&&(h=this._time),n5(this,Sh(this,h))},o.previousLabel=function(h){return h===void 0&&(h=this._time),n5(this,Sh(this,h),1)},o.currentLabel=function(h){return arguments.length?this.seek(h,!0):this.previousLabel(this._time+Aa)},o.shiftChildren=function(h,v,w){w===void 0&&(w=0);var a=this._first,C=this.labels,I;for(h=fo(h);a;)a._start>=w&&(a._start+=h,a._end+=h),a=a._next;if(v)for(I in C)C[I]>=w&&(C[I]+=h);return Ly(this)},o.invalidate=function(h){var v=this._first;for(this._lock=0;v;)v.invalidate(h),v=v._next;return r.prototype.invalidate.call(this,h)},o.clear=function(h){h===void 0&&(h=!0);for(var v=this._first,w;v;)w=v._next,this.remove(v),v=w;return this._dp&&(this._time=this._tTime=this._pTime=0),h&&(this.labels={}),Ly(this)},o.totalDuration=function(h){var v=0,w=this,a=w._last,C=Ch,I,L,k;if(arguments.length)return w.timeScale((w._repeat<0?w.duration():w.totalDuration())/(w.reversed()?-h:h));if(w._dirty){for(k=w.parent;a;)I=a._prev,a._dirty&&a.totalDuration(),L=a._start,L>C&&w._sort&&a._ts&&!w._lock?(w._lock=1,Ff(w,a,L-a._delay,1)._lock=0):C=L,L<0&&a._ts&&(v-=L,(!k&&!w._dp||k&&k.smoothChildTiming)&&(w._start+=fo(L/w._ts),w._time-=L,w._tTime-=L),w.shiftChildren(-L,!1,-1/0),C=0),a._end>v&&a._ts&&(v=a._end),a=I;N0(w,w===po&&w._time>v?w._time:v,1,1),w._dirty=0}return w._tDur},t.updateRoot=function(h){if(po._ts&&(VU(po,xA(h,po)),jU=zu.frame),zu.frame>=JB){JB+=Nu.autoSleep||120;var v=po._first;if((!v||!v._ts)&&Nu.autoSleep&&zu._listeners.length<2){for(;v&&!v._ts;)v=v._next;v||zu.sleep()}}},t})(wb);Vu(hc.prototype,{_lock:0,_hasPause:0,_forcing:0});var xX=function(t,o,l,h,v,w,a){var C=new qc(this._pt,t,o,0,1,g8,null,v),I=0,L=0,k,G,q,Q,H,K,he,ue;for(C.b=l,C.e=h,l+="",h+="",(he=~h.indexOf("random("))&&(h=xb(h)),w&&(ue=[l,h],w(ue,t,o),l=ue[0],h=ue[1]),G=l.match(jE)||[];k=jE.exec(h);)Q=k[0],H=h.substring(I,k.index),q?q=(q+1)%5:H.substr(-5)==="rgba("&&(q=1),Q!==G[L++]&&(K=parseFloat(G[L-1])||0,C._pt={_next:C._pt,p:H||L===1?H:",",s:K,c:Q.charAt(1)==="="?S0(K,Q)-K:parseFloat(Q)-K,m:q&&q<4?Math.round:0},I=jE.lastIndex);return C.c=I<h.length?h.substring(I,h.length):"",C.fp=a,(BU.test(h)||he)&&(C.e=0),this._pt=C,C},cD=function(t,o,l,h,v,w,a,C,I,L){Co(h)&&(h=h(v||0,t,w));var k=t[o],G=l!=="get"?l:Co(k)?I?t[o.indexOf("set")||!Co(t["get"+o.substr(3)])?o:"get"+o.substr(3)](I):t[o]():k,q=Co(k)?I?SX:p8:hD,Q;if(Hs(h)&&(~h.indexOf("random(")&&(h=xb(h)),h.charAt(1)==="="&&(Q=S0(G,h)+(Pl(G)||0),(Q||Q===0)&&(h=Q))),!L||G!==h||dI)return!isNaN(G*h)&&h!==""?(Q=new qc(this._pt,t,o,+G||0,h-(G||0),typeof k=="boolean"?MX:m8,0,q),I&&(Q.fp=I),a&&Q.modifier(a,this,t),this._pt=Q):(!k&&!(o in t)&&iD(o,h),xX.call(this,t,o,G,h,q,C||Nu.stringFilter,I))},bX=function(t,o,l,h,v){if(Co(t)&&(t=eb(t,v,o,l,h)),!Hf(t)||t.style&&t.nodeType||Rl(t)||zU(t))return Hs(t)?eb(t,v,o,l,h):t;var w={},a;for(a in t)w[a]=eb(t[a],v,o,l,h);return w},h8=function(t,o,l,h,v,w){var a,C,I,L;if(Pu[t]&&(a=new Pu[t]).init(v,a.rawVars?o[t]:bX(o[t],h,v,w,l),l,h,w)!==!1&&(l._pt=C=new qc(l._pt,v,t,0,1,a.render,a,0,a.priority),l!==_0))for(I=l._ptLookup[l._targets.indexOf(v)],L=a._props.length;L--;)I[a._props[L]]=C;return a},Lg,dI,uD=function r(t,o,l){var h=t.vars,v=h.ease,w=h.startAt,a=h.immediateRender,C=h.lazy,I=h.onUpdate,L=h.runBackwards,k=h.yoyoEase,G=h.keyframes,q=h.autoRevert,Q=t._dur,H=t._startAt,K=t._targets,he=t.parent,ue=he&&he.data==="nested"?he.vars.targets:K,me=t._overwrite==="auto"&&!eD,ge=t.timeline,se,fe,ve,Le,Ue,tt,Ke,nt,st,Rt,Mt,$e,rt;if(ge&&(!G||!v)&&(v="none"),t._ease=By(v,B0.ease),t._yEase=k?s8(By(k===!0?v:k,B0.ease)):0,k&&t._yoyo&&!t._repeat&&(k=t._yEase,t._yEase=t._ease,t._ease=k),t._from=!ge&&!!h.runBackwards,!ge||G&&!h.stagger){if(nt=K[0]?zy(K[0]).harness:0,$e=nt&&h[nt.prop],se=vA(h,aD),H&&(H._zTime<0&&H.progress(1),o<0&&L&&a&&!q?H.render(-1,!0):H.revert(L&&Q?iA:WH),H._lazy=0),w){if(Hg(t._startAt=ns.set(K,Vu({data:"isStart",overwrite:!1,parent:he,immediateRender:!0,lazy:!H&&Gc(C),startAt:null,delay:0,onUpdate:I&&function(){return ku(t,"onUpdate")},stagger:0},w))),t._startAt._dp=0,t._startAt._sat=t,o<0&&(ll||!a&&!q)&&t._startAt.revert(iA),a&&Q&&o<=0&&l<=0){o&&(t._zTime=o);return}}else if(L&&Q&&!H){if(o&&(a=!1),ve=Vu({overwrite:!1,data:"isFromStart",lazy:a&&!H&&Gc(C),immediateRender:a,stagger:0,parent:he},se),$e&&(ve[nt.prop]=$e),Hg(t._startAt=ns.set(K,ve)),t._startAt._dp=0,t._startAt._sat=t,o<0&&(ll?t._startAt.revert(iA):t._startAt.render(-1,!0)),t._zTime=o,!a)r(t._startAt,Aa,Aa);else if(!o)return}for(t._pt=t._ptCache=0,C=Q&&Gc(C)||C&&!Q,fe=0;fe<K.length;fe++){if(Ue=K[fe],Ke=Ue._gsap||sD(K)[fe]._gsap,t._ptLookup[fe]=Rt={},oI[Ke.id]&&Vg.length&&yA(),Mt=ue===K?fe:ue.indexOf(Ue),nt&&(st=new nt).init(Ue,$e||se,t,Mt,ue)!==!1&&(t._pt=Le=new qc(t._pt,Ue,st.name,0,1,st.render,st,0,st.priority),st._props.forEach(function(Ct){Rt[Ct]=Le}),st.priority&&(tt=1)),!nt||$e)for(ve in se)Pu[ve]&&(st=h8(ve,se,t,Mt,Ue,ue))?st.priority&&(tt=1):Rt[ve]=Le=cD.call(t,Ue,ve,"get",se[ve],Mt,ue,0,h.stringFilter);t._op&&t._op[fe]&&t.kill(Ue,t._op[fe]),me&&t._pt&&(Lg=t,po.killTweensOf(Ue,Rt,t.globalTime(o)),rt=!t.parent,Lg=0),t._pt&&C&&(oI[Ke.id]=1)}tt&&_8(t),t._onInit&&t._onInit(t)}t._onUpdate=I,t._initted=(!t._op||t._pt)&&!rt,G&&o<=0&&ge.render(Ch,!0,!0)},wX=function(t,o,l,h,v,w,a,C){var I=(t._pt&&t._ptCache||(t._ptCache={}))[o],L,k,G,q;if(!I)for(I=t._ptCache[o]=[],G=t._ptLookup,q=t._targets.length;q--;){if(L=G[q][o],L&&L.d&&L.d._pt)for(L=L.d._pt;L&&L.p!==o&&L.fp!==o;)L=L._next;if(!L)return dI=1,t.vars[o]="+=0",uD(t,a),dI=0,C?yb(o+" not eligible for reset"):1;I.push(L)}for(q=I.length;q--;)k=I[q],L=k._pt||k,L.s=(h||h===0)&&!v?h:L.s+(h||0)+w*L.c,L.c=l-L.s,k.e&&(k.e=Vo(l)+Pl(k.e)),k.b&&(k.b=L.s+Pl(k.b))},AX=function(t,o){var l=t[0]?zy(t[0]).harness:0,h=l&&l.aliases,v,w,a,C;if(!h)return o;v=k0({},o);for(w in h)if(w in v)for(C=h[w].split(","),a=C.length;a--;)v[C[a]]=v[w];return v},TX=function(t,o,l,h){var v=o.ease||h||"power1.inOut",w,a;if(Rl(o))a=l[t]||(l[t]=[]),o.forEach(function(C,I){return a.push({t:I/(o.length-1)*100,v:C,e:v})});else for(w in o)a=l[w]||(l[w]=[]),w==="ease"||a.push({t:parseFloat(t),v:o[w],e:v})},eb=function(t,o,l,h,v){return Co(t)?t.call(o,l,h,v):Hs(t)&&~t.indexOf("random(")?xb(t):t},d8=oD+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",f8={};$c(d8+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return f8[r]=1});var ns=(function(r){DU(t,r);function t(l,h,v,w){var a;typeof h=="number"&&(v.duration=h,h=v,v=null),a=r.call(this,w?h:Q1(h))||this;var C=a.vars,I=C.duration,L=C.delay,k=C.immediateRender,G=C.stagger,q=C.overwrite,Q=C.keyframes,H=C.defaults,K=C.scrollTrigger,he=C.yoyoEase,ue=h.parent||po,me=(Rl(l)||zU(l)?fm(l[0]):"length"in h)?[l]:Ih(l),ge,se,fe,ve,Le,Ue,tt,Ke;if(a._targets=me.length?sD(me):yb("GSAP target "+l+" not found. https://gsap.com",!Nu.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=q,Q||G||I2(I)||I2(L)){if(h=a.vars,ge=a.timeline=new hc({data:"nested",defaults:H||{},targets:ue&&ue.data==="nested"?ue.vars.targets:me}),ge.kill(),ge.parent=ge._dp=em(a),ge._start=0,G||I2(I)||I2(L)){if(ve=me.length,tt=G&&KU(G),Hf(G))for(Le in G)~d8.indexOf(Le)&&(Ke||(Ke={}),Ke[Le]=G[Le]);for(se=0;se<ve;se++)fe=vA(h,f8),fe.stagger=0,he&&(fe.yoyoEase=he),Ke&&k0(fe,Ke),Ue=me[se],fe.duration=+eb(I,em(a),se,Ue,me),fe.delay=(+eb(L,em(a),se,Ue,me)||0)-a._delay,!G&&ve===1&&fe.delay&&(a._delay=L=fe.delay,a._start+=L,fe.delay=0),ge.to(Ue,fe,tt?tt(se,Ue,me):0),ge._ease=Li.none;ge.duration()?I=L=0:a.timeline=0}else if(Q){Q1(Vu(ge.vars.defaults,{ease:"none"})),ge._ease=By(Q.ease||h.ease||"none");var nt=0,st,Rt,Mt;if(Rl(Q))Q.forEach(function($e){return ge.to(me,$e,">")}),ge.duration();else{fe={};for(Le in Q)Le==="ease"||Le==="easeEach"||TX(Le,Q[Le],fe,Q.easeEach);for(Le in fe)for(st=fe[Le].sort(function($e,rt){return $e.t-rt.t}),nt=0,se=0;se<st.length;se++)Rt=st[se],Mt={ease:Rt.e,duration:(Rt.t-(se?st[se-1].t:0))/100*I},Mt[Le]=Rt.v,ge.to(me,Mt,nt),nt+=Mt.duration;ge.duration()<I&&ge.to({},{duration:I-ge.duration()})}}I||a.duration(I=ge.duration())}else a.timeline=0;return q===!0&&!eD&&(Lg=em(a),po.killTweensOf(me),Lg=0),Ff(ue,em(a),v),h.reversed&&a.reverse(),h.paused&&a.paused(!0),(k||!I&&!Q&&a._start===fo(ue._time)&&Gc(k)&&tX(em(a))&&ue.data!=="nested")&&(a._tTime=-Aa,a.render(Math.max(0,-L)||0)),K&&XU(em(a),K),a}var o=t.prototype;return o.render=function(h,v,w){var a=this._time,C=this._tDur,I=this._dur,L=h<0,k=h>C-Aa&&!L?C:h<Aa?0:h,G,q,Q,H,K,he,ue,me,ge;if(!I)nX(this,h,v,w);else if(k!==this._tTime||!h||w||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==L||this._lazy){if(G=k,me=this.timeline,this._repeat){if(H=I+this._rDelay,this._repeat<-1&&L)return this.totalTime(H*100+h,v,w);if(G=fo(k%H),k===C?(Q=this._repeat,G=I):(K=fo(k/H),Q=~~K,Q&&Q===K?(G=I,Q--):G>I&&(G=I)),he=this._yoyo&&Q&1,he&&(ge=this._yEase,G=I-G),K=F0(this._tTime,H),G===a&&!w&&this._initted&&Q===K)return this._tTime=k,this;Q!==K&&(me&&this._yEase&&l8(me,he),this.vars.repeatRefresh&&!he&&!this._lock&&G!==H&&this._initted&&(this._lock=w=1,this.render(fo(H*Q),!0).invalidate()._lock=0))}if(!this._initted){if(ZU(this,L?h:G,w,v,k))return this._tTime=0,this;if(a!==this._time&&!(w&&this.vars.repeatRefresh&&Q!==K))return this;if(I!==this._dur)return this.render(h,v,w)}if(this._tTime=k,this._time=G,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=ue=(ge||this._ease)(G/I),this._from&&(this.ratio=ue=1-ue),!a&&k&&!v&&!K&&(ku(this,"onStart"),this._tTime!==k))return this;for(q=this._pt;q;)q.r(ue,q.d),q=q._next;me&&me.render(h<0?h:me._dur*me._ease(G/this._dur),v,w)||this._startAt&&(this._zTime=h),this._onUpdate&&!v&&(L&&sI(this,h,v,w),ku(this,"onUpdate")),this._repeat&&Q!==K&&this.vars.onRepeat&&!v&&this.parent&&ku(this,"onRepeat"),(k===this._tDur||!k)&&this._tTime===k&&(L&&!this._onUpdate&&sI(this,h,!0,!0),(h||!I)&&(k===this._tDur&&this._ts>0||!k&&this._ts<0)&&Hg(this,1),!v&&!(L&&!a)&&(k||a||he)&&(ku(this,k===C?"onComplete":"onReverseComplete",!0),this._prom&&!(k<C&&this.timeScale()>0)&&this._prom()))}return this},o.targets=function(){return this._targets},o.invalidate=function(h){return(!h||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(h),r.prototype.invalidate.call(this,h)},o.resetTo=function(h,v,w,a,C){bb||zu.wake(),this._ts||this.play();var I=Math.min(this._dur,(this._dp._time-this._start)*this._ts),L;return this._initted||uD(this,I),L=this._ease(I/this._dur),wX(this,h,v,w,a,L,I,C)?this.resetTo(h,v,w,a,1):(IT(this,0),this.parent||qU(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},o.kill=function(h,v){if(v===void 0&&(v="all"),!h&&(!v||v==="all"))return this._lazy=this._pt=0,this.parent?V1(this):this.scrollTrigger&&this.scrollTrigger.kill(!!ll),this;if(this.timeline){var w=this.timeline.totalDuration();return this.timeline.killTweensOf(h,v,Lg&&Lg.vars.overwrite!==!0)._first||V1(this),this.parent&&w!==this.timeline.totalDuration()&&N0(this,this._dur*this.timeline._tDur/w,0,1),this}var a=this._targets,C=h?Ih(h):a,I=this._ptLookup,L=this._pt,k,G,q,Q,H,K,he;if((!v||v==="all")&&JH(a,C))return v==="all"&&(this._pt=0),V1(this);for(k=this._op=this._op||[],v!=="all"&&(Hs(v)&&(H={},$c(v,function(ue){return H[ue]=1}),v=H),v=AX(a,v)),he=a.length;he--;)if(~C.indexOf(a[he])){G=I[he],v==="all"?(k[he]=v,Q=G,q={}):(q=k[he]=k[he]||{},Q=v);for(H in Q)K=G&&G[H],K&&((!("kill"in K.d)||K.d.kill(H)===!0)&&OT(this,K,"_pt"),delete G[H]),q!=="all"&&(q[H]=1)}return this._initted&&!this._pt&&L&&V1(this),this},t.to=function(h,v){return new t(h,v,arguments[2])},t.from=function(h,v){return J1(1,arguments)},t.delayedCall=function(h,v,w,a){return new t(v,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:h,onComplete:v,onReverseComplete:v,onCompleteParams:w,onReverseCompleteParams:w,callbackScope:a})},t.fromTo=function(h,v,w){return J1(2,arguments)},t.set=function(h,v){return v.duration=0,v.repeatDelay||(v.repeat=0),new t(h,v)},t.killTweensOf=function(h,v,w){return po.killTweensOf(h,v,w)},t})(wb);Vu(ns.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});$c("staggerTo,staggerFrom,staggerFromTo",function(r){ns[r]=function(){var t=new hc,o=cI.call(arguments,0);return o.splice(r==="staggerFromTo"?5:4,0,0),t[r].apply(t,o)}});var hD=function(t,o,l){return t[o]=l},p8=function(t,o,l){return t[o](l)},SX=function(t,o,l,h){return t[o](h.fp,l)},EX=function(t,o,l){return t.setAttribute(o,l)},dD=function(t,o){return Co(t[o])?p8:tD(t[o])&&t.setAttribute?EX:hD},m8=function(t,o){return o.set(o.t,o.p,Math.round((o.s+o.c*t)*1e6)/1e6,o)},MX=function(t,o){return o.set(o.t,o.p,!!(o.s+o.c*t),o)},g8=function(t,o){var l=o._pt,h="";if(!t&&o.b)h=o.b;else if(t===1&&o.e)h=o.e;else{for(;l;)h=l.p+(l.m?l.m(l.s+l.c*t):Math.round((l.s+l.c*t)*1e4)/1e4)+h,l=l._next;h+=o.c}o.set(o.t,o.p,h,o)},fD=function(t,o){for(var l=o._pt;l;)l.r(t,l.d),l=l._next},OX=function(t,o,l,h){for(var v=this._pt,w;v;)w=v._next,v.p===h&&v.modifier(t,o,l),v=w},CX=function(t){for(var o=this._pt,l,h;o;)h=o._next,o.p===t&&!o.op||o.op===t?OT(this,o,"_pt"):o.dep||(l=1),o=h;return!l},IX=function(t,o,l,h){h.mSet(t,o,h.m.call(h.tween,l,h.mt),h)},_8=function(t){for(var o=t._pt,l,h,v,w;o;){for(l=o._next,h=v;h&&h.pr>o.pr;)h=h._next;(o._prev=h?h._prev:w)?o._prev._next=o:v=o,(o._next=h)?h._prev=o:w=o,o=l}t._pt=v},qc=(function(){function r(o,l,h,v,w,a,C,I,L){this.t=l,this.s=v,this.c=w,this.p=h,this.r=a||m8,this.d=C||this,this.set=I||hD,this.pr=L||0,this._next=o,o&&(o._prev=this)}var t=r.prototype;return t.modifier=function(l,h,v){this.mSet=this.mSet||this.set,this.set=IX,this.m=l,this.mt=v,this.tween=h},r})();$c(oD+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return aD[r]=1});Uu.TweenMax=Uu.TweenLite=ns;Uu.TimelineLite=Uu.TimelineMax=hc;po=new hc({sortChildren:!1,defaults:B0,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Nu.stringFilter=o8;var ky=[],oA={},PX=[],a5=0,DX=0,qE=function(t){return(oA[t]||PX).map(function(o){return o()})},fI=function(){var t=Date.now(),o=[];t-a5>2&&(qE("matchMediaInit"),ky.forEach(function(l){var h=l.queries,v=l.conditions,w,a,C,I;for(a in h)w=Bf.matchMedia(h[a]).matches,w&&(C=1),w!==v[a]&&(v[a]=w,I=1);I&&(l.revert(),C&&o.push(l))}),qE("matchMediaRevert"),o.forEach(function(l){return l.onMatch(l,function(h){return l.add(null,h)})}),a5=t,qE("matchMedia"))},y8=(function(){function r(o,l){this.selector=l&&uI(l),this.data=[],this._r=[],this.isReverted=!1,this.id=DX++,o&&this.add(o)}var t=r.prototype;return t.add=function(l,h,v){Co(l)&&(v=h,h=l,l=Co);var w=this,a=function(){var I=to,L=w.selector,k;return I&&I!==w&&I.data.push(w),v&&(w.selector=uI(v)),to=w,k=h.apply(w,arguments),Co(k)&&w._r.push(k),to=I,w.selector=L,w.isReverted=!1,k};return w.last=a,l===Co?a(w,function(C){return w.add(null,C)}):l?w[l]=a:a},t.ignore=function(l){var h=to;to=null,l(this),to=h},t.getTweens=function(){var l=[];return this.data.forEach(function(h){return h instanceof r?l.push.apply(l,h.getTweens()):h instanceof ns&&!(h.parent&&h.parent.data==="nested")&&l.push(h)}),l},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(l,h){var v=this;if(l?(function(){for(var a=v.getTweens(),C=v.data.length,I;C--;)I=v.data[C],I.data==="isFlip"&&(I.revert(),I.getChildren(!0,!0,!1).forEach(function(L){return a.splice(a.indexOf(L),1)}));for(a.map(function(L){return{g:L._dur||L._delay||L._sat&&!L._sat.vars.immediateRender?L.globalTime(0):-1/0,t:L}}).sort(function(L,k){return k.g-L.g||-1/0}).forEach(function(L){return L.t.revert(l)}),C=v.data.length;C--;)I=v.data[C],I instanceof hc?I.data!=="nested"&&(I.scrollTrigger&&I.scrollTrigger.revert(),I.kill()):!(I instanceof ns)&&I.revert&&I.revert(l);v._r.forEach(function(L){return L(l,v)}),v.isReverted=!0})():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),h)for(var w=ky.length;w--;)ky[w].id===this.id&&ky.splice(w,1)},t.revert=function(l){this.kill(l||{})},r})(),RX=(function(){function r(o){this.contexts=[],this.scope=o,to&&to.data.push(this)}var t=r.prototype;return t.add=function(l,h,v){Hf(l)||(l={matches:l});var w=new y8(0,v||this.scope),a=w.conditions={},C,I,L;to&&!w.selector&&(w.selector=to.selector),this.contexts.push(w),h=w.add("onMatch",h),w.queries=l;for(I in l)I==="all"?L=1:(C=Bf.matchMedia(l[I]),C&&(ky.indexOf(w)<0&&ky.push(w),(a[I]=C.matches)&&(L=1),C.addListener?C.addListener(fI):C.addEventListener("change",fI)));return L&&h(w,function(k){return w.add(null,k)}),this},t.revert=function(l){this.kill(l||{})},t.kill=function(l){this.contexts.forEach(function(h){return h.kill(l,!0)})},r})(),bA={registerPlugin:function(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];o.forEach(function(h){return n8(h)})},timeline:function(t){return new hc(t)},getTweensOf:function(t,o){return po.getTweensOf(t,o)},getProperty:function(t,o,l,h){Hs(t)&&(t=Ih(t)[0]);var v=zy(t||{}).get,w=l?$U:GU;return l==="native"&&(l=""),t&&(o?w((Pu[o]&&Pu[o].get||v)(t,o,l,h)):function(a,C,I){return w((Pu[a]&&Pu[a].get||v)(t,a,C,I))})},quickSetter:function(t,o,l){if(t=Ih(t),t.length>1){var h=t.map(function(L){return Xc.quickSetter(L,o,l)}),v=h.length;return function(L){for(var k=v;k--;)h[k](L)}}t=t[0]||{};var w=Pu[o],a=zy(t),C=a.harness&&(a.harness.aliases||{})[o]||o,I=w?function(L){var k=new w;_0._pt=0,k.init(t,l?L+l:L,_0,0,[t]),k.render(1,k),_0._pt&&fD(1,_0)}:a.set(t,C);return w?I:function(L){return I(t,C,l?L+l:L,a,1)}},quickTo:function(t,o,l){var h,v=Xc.to(t,Vu((h={},h[o]="+=0.1",h.paused=!0,h.stagger=0,h),l||{})),w=function(C,I,L){return v.resetTo(o,C,I,L)};return w.tween=v,w},isTweening:function(t){return po.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=By(t.ease,B0.ease)),e5(B0,t||{})},config:function(t){return e5(Nu,t||{})},registerEffect:function(t){var o=t.name,l=t.effect,h=t.plugins,v=t.defaults,w=t.extendTimeline;(h||"").split(",").forEach(function(a){return a&&!Pu[a]&&!Uu[a]&&yb(o+" effect requires "+a+" plugin.")}),UE[o]=function(a,C,I){return l(Ih(a),Vu(C||{},v),I)},w&&(hc.prototype[o]=function(a,C,I){return this.add(UE[o](a,Hf(C)?C:(I=C)&&{},this),I)})},registerEase:function(t,o){Li[t]=By(o)},parseEase:function(t,o){return arguments.length?By(t,o):Li},getById:function(t){return po.getById(t)},exportRoot:function(t,o){t===void 0&&(t={});var l=new hc(t),h,v;for(l.smoothChildTiming=Gc(t.smoothChildTiming),po.remove(l),l._dp=0,l._time=l._tTime=po._time,h=po._first;h;)v=h._next,(o||!(!h._dur&&h instanceof ns&&h.vars.onComplete===h._targets[0]))&&Ff(l,h,h._start-h._delay),h=v;return Ff(po,l,0),l},context:function(t,o){return t?new y8(t,o):to},matchMedia:function(t){return new RX(t)},matchMediaRefresh:function(){return ky.forEach(function(t){var o=t.conditions,l,h;for(h in o)o[h]&&(o[h]=!1,l=1);l&&t.revert()})||fI()},addEventListener:function(t,o){var l=oA[t]||(oA[t]=[]);~l.indexOf(o)||l.push(o)},removeEventListener:function(t,o){var l=oA[t],h=l&&l.indexOf(o);h>=0&&l.splice(h,1)},utils:{wrap:hX,wrapYoyo:dX,distribute:KU,random:JU,snap:QU,normalize:uX,getUnit:Pl,clamp:oX,splitColor:i8,toArray:Ih,selector:uI,mapRange:t8,pipe:lX,unitize:cX,interpolate:fX,shuffle:YU},install:FU,effects:UE,ticker:zu,updateRoot:hc.updateRoot,plugins:Pu,globalTimeline:po,core:{PropTween:qc,globals:NU,Tween:ns,Timeline:hc,Animation:wb,getCache:zy,_removeLinkedListItem:OT,reverting:function(){return ll},context:function(t){return t&&to&&(to.data.push(t),t._ctx=to),to},suppressOverwrites:function(t){return eD=t}}};$c("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return bA[r]=ns[r]});zu.add(hc.updateRoot);_0=bA.to({},{duration:0});var zX=function(t,o){for(var l=t._pt;l&&l.p!==o&&l.op!==o&&l.fp!==o;)l=l._next;return l},LX=function(t,o){var l=t._targets,h,v,w;for(h in o)for(v=l.length;v--;)w=t._ptLookup[v][h],w&&(w=w.d)&&(w._pt&&(w=zX(w,h)),w&&w.modifier&&w.modifier(o[h],t,l[v],h))},HE=function(t,o){return{name:t,headless:1,rawVars:1,init:function(h,v,w){w._onInit=function(a){var C,I;if(Hs(v)&&(C={},$c(v,function(L){return C[L]=1}),v=C),o){C={};for(I in v)C[I]=o(v[I]);v=C}LX(a,v)}}}},Xc=bA.registerPlugin({name:"attr",init:function(t,o,l,h,v){var w,a,C;this.tween=l;for(w in o)C=t.getAttribute(w)||"",a=this.add(t,"setAttribute",(C||0)+"",o[w],h,v,0,0,w),a.op=w,a.b=C,this._props.push(w)},render:function(t,o){for(var l=o._pt;l;)ll?l.set(l.t,l.p,l.b,l):l.r(t,l.d),l=l._next}},{name:"endArray",headless:1,init:function(t,o){for(var l=o.length;l--;)this.add(t,l,t[l]||0,o[l],0,0,0,0,0,1)}},HE("roundProps",hI),HE("modifiers"),HE("snap",QU))||bA;ns.version=hc.version=Xc.version="3.14.2";kU=1;rD()&&j0();Li.Power0;Li.Power1;Li.Power2;Li.Power3;Li.Power4;Li.Linear;Li.Quad;Li.Cubic;Li.Quart;Li.Quint;Li.Strong;Li.Elastic;Li.Back;Li.SteppedEase;Li.Bounce;Li.Sine;Li.Expo;Li.Circ;var o5,Bg,E0,pD,My,s5,mD,BX=function(){return typeof window<"u"},pm={},by=180/Math.PI,M0=Math.PI/180,l0=Math.atan2,l5=1e8,gD=/([A-Z])/g,kX=/(left|right|width|margin|padding|x)/i,FX=/[\s,\(]\S/,Nf={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},pI=function(t,o){return o.set(o.t,o.p,Math.round((o.s+o.c*t)*1e4)/1e4+o.u,o)},NX=function(t,o){return o.set(o.t,o.p,t===1?o.e:Math.round((o.s+o.c*t)*1e4)/1e4+o.u,o)},jX=function(t,o){return o.set(o.t,o.p,t?Math.round((o.s+o.c*t)*1e4)/1e4+o.u:o.b,o)},UX=function(t,o){return o.set(o.t,o.p,t===1?o.e:t?Math.round((o.s+o.c*t)*1e4)/1e4+o.u:o.b,o)},VX=function(t,o){var l=o.s+o.c*t;o.set(o.t,o.p,~~(l+(l<0?-.5:.5))+o.u,o)},v8=function(t,o){return o.set(o.t,o.p,t?o.e:o.b,o)},x8=function(t,o){return o.set(o.t,o.p,t!==1?o.b:o.e,o)},GX=function(t,o,l){return t.style[o]=l},$X=function(t,o,l){return t.style.setProperty(o,l)},qX=function(t,o,l){return t._gsap[o]=l},HX=function(t,o,l){return t._gsap.scaleX=t._gsap.scaleY=l},XX=function(t,o,l,h,v){var w=t._gsap;w.scaleX=w.scaleY=l,w.renderTransform(v,w)},ZX=function(t,o,l,h,v){var w=t._gsap;w[o]=l,w.renderTransform(v,w)},mo="transform",Hc=mo+"Origin",WX=function r(t,o){var l=this,h=this.target,v=h.style,w=h._gsap;if(t in pm&&v){if(this.tfm=this.tfm||{},t!=="transform")t=Nf[t]||t,~t.indexOf(",")?t.split(",").forEach(function(a){return l.tfm[a]=rm(h,a)}):this.tfm[t]=w.x?w[t]:rm(h,t),t===Hc&&(this.tfm.zOrigin=w.zOrigin);else return Nf.transform.split(",").forEach(function(a){return r.call(l,a,o)});if(this.props.indexOf(mo)>=0)return;w.svg&&(this.svgo=h.getAttribute("data-svg-origin"),this.props.push(Hc,o,"")),t=mo}(v||o)&&this.props.push(t,o,v[t])},b8=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},YX=function(){var t=this.props,o=this.target,l=o.style,h=o._gsap,v,w;for(v=0;v<t.length;v+=3)t[v+1]?t[v+1]===2?o[t[v]](t[v+2]):o[t[v]]=t[v+2]:t[v+2]?l[t[v]]=t[v+2]:l.removeProperty(t[v].substr(0,2)==="--"?t[v]:t[v].replace(gD,"-$1").toLowerCase());if(this.tfm){for(w in this.tfm)h[w]=this.tfm[w];h.svg&&(h.renderTransform(),o.setAttribute("data-svg-origin",this.svgo||"")),v=mD(),(!v||!v.isStart)&&!l[mo]&&(b8(l),h.zOrigin&&l[Hc]&&(l[Hc]+=" "+h.zOrigin+"px",h.zOrigin=0,h.renderTransform()),h.uncache=1)}},w8=function(t,o){var l={target:t,props:[],revert:YX,save:WX};return t._gsap||Xc.core.getCache(t),o&&t.style&&t.nodeType&&o.split(",").forEach(function(h){return l.save(h)}),l},A8,mI=function(t,o){var l=Bg.createElementNS?Bg.createElementNS((o||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Bg.createElement(t);return l&&l.style?l:Bg.createElement(t)},Fu=function r(t,o,l){var h=getComputedStyle(t);return h[o]||h.getPropertyValue(o.replace(gD,"-$1").toLowerCase())||h.getPropertyValue(o)||!l&&r(t,U0(o)||o,1)||""},c5="O,Moz,ms,Ms,Webkit".split(","),U0=function(t,o,l){var h=o||My,v=h.style,w=5;if(t in v&&!l)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);w--&&!(c5[w]+t in v););return w<0?null:(w===3?"ms":w>=0?c5[w]:"")+t},gI=function(){BX()&&window.document&&(o5=window,Bg=o5.document,E0=Bg.documentElement,My=mI("div")||{style:{}},mI("div"),mo=U0(mo),Hc=mo+"Origin",My.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",A8=!!U0("perspective"),mD=Xc.core.reverting,pD=1)},u5=function(t){var o=t.ownerSVGElement,l=mI("svg",o&&o.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),h=t.cloneNode(!0),v;h.style.display="block",l.appendChild(h),E0.appendChild(l);try{v=h.getBBox()}catch{}return l.removeChild(h),E0.removeChild(l),v},h5=function(t,o){for(var l=o.length;l--;)if(t.hasAttribute(o[l]))return t.getAttribute(o[l])},T8=function(t){var o,l;try{o=t.getBBox()}catch{o=u5(t),l=1}return o&&(o.width||o.height)||l||(o=u5(t)),o&&!o.width&&!o.x&&!o.y?{x:+h5(t,["x","cx","x1"])||0,y:+h5(t,["y","cy","y1"])||0,width:0,height:0}:o},S8=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&T8(t))},Xg=function(t,o){if(o){var l=t.style,h;o in pm&&o!==Hc&&(o=mo),l.removeProperty?(h=o.substr(0,2),(h==="ms"||o.substr(0,6)==="webkit")&&(o="-"+o),l.removeProperty(h==="--"?o:o.replace(gD,"-$1").toLowerCase())):l.removeAttribute(o)}},kg=function(t,o,l,h,v,w){var a=new qc(t._pt,o,l,0,1,w?x8:v8);return t._pt=a,a.b=h,a.e=v,t._props.push(l),a},d5={deg:1,rad:1,turn:1},KX={grid:1,flex:1},Zg=function r(t,o,l,h){var v=parseFloat(l)||0,w=(l+"").trim().substr((v+"").length)||"px",a=My.style,C=kX.test(o),I=t.tagName.toLowerCase()==="svg",L=(I?"client":"offset")+(C?"Width":"Height"),k=100,G=h==="px",q=h==="%",Q,H,K,he;if(h===w||!v||d5[h]||d5[w])return v;if(w!=="px"&&!G&&(v=r(t,o,l,"px")),he=t.getCTM&&S8(t),(q||w==="%")&&(pm[o]||~o.indexOf("adius")))return Q=he?t.getBBox()[C?"width":"height"]:t[L],Vo(q?v/Q*k:v/100*Q);if(a[C?"width":"height"]=k+(G?w:h),H=h!=="rem"&&~o.indexOf("adius")||h==="em"&&t.appendChild&&!I?t:t.parentNode,he&&(H=(t.ownerSVGElement||{}).parentNode),(!H||H===Bg||!H.appendChild)&&(H=Bg.body),K=H._gsap,K&&q&&K.width&&C&&K.time===zu.time&&!K.uncache)return Vo(v/K.width*k);if(q&&(o==="height"||o==="width")){var ue=t.style[o];t.style[o]=k+h,Q=t[L],ue?t.style[o]=ue:Xg(t,o)}else(q||w==="%")&&!KX[Fu(H,"display")]&&(a.position=Fu(t,"position")),H===t&&(a.position="static"),H.appendChild(My),Q=My[L],H.removeChild(My),a.position="absolute";return C&&q&&(K=zy(H),K.time=zu.time,K.width=H[L]),Vo(G?Q*v/k:Q&&v?k/Q*v:0)},rm=function(t,o,l,h){var v;return pD||gI(),o in Nf&&o!=="transform"&&(o=Nf[o],~o.indexOf(",")&&(o=o.split(",")[0])),pm[o]&&o!=="transform"?(v=Tb(t,h),v=o!=="transformOrigin"?v[o]:v.svg?v.origin:AA(Fu(t,Hc))+" "+v.zOrigin+"px"):(v=t.style[o],(!v||v==="auto"||h||~(v+"").indexOf("calc("))&&(v=wA[o]&&wA[o](t,o,l)||Fu(t,o)||UU(t,o)||(o==="opacity"?1:0))),l&&!~(v+"").trim().indexOf(" ")?Zg(t,o,v,l)+l:v},QX=function(t,o,l,h){if(!l||l==="none"){var v=U0(o,t,1),w=v&&Fu(t,v,1);w&&w!==l?(o=v,l=w):o==="borderColor"&&(l=Fu(t,"borderTopColor"))}var a=new qc(this._pt,t.style,o,0,1,g8),C=0,I=0,L,k,G,q,Q,H,K,he,ue,me,ge,se;if(a.b=l,a.e=h,l+="",h+="",h.substring(0,6)==="var(--"&&(h=Fu(t,h.substring(4,h.indexOf(")")))),h==="auto"&&(H=t.style[o],t.style[o]=h,h=Fu(t,o)||h,H?t.style[o]=H:Xg(t,o)),L=[l,h],o8(L),l=L[0],h=L[1],G=l.match(g0)||[],se=h.match(g0)||[],se.length){for(;k=g0.exec(h);)K=k[0],ue=h.substring(C,k.index),Q?Q=(Q+1)%5:(ue.substr(-5)==="rgba("||ue.substr(-5)==="hsla(")&&(Q=1),K!==(H=G[I++]||"")&&(q=parseFloat(H)||0,ge=H.substr((q+"").length),K.charAt(1)==="="&&(K=S0(q,K)+ge),he=parseFloat(K),me=K.substr((he+"").length),C=g0.lastIndex-me.length,me||(me=me||Nu.units[o]||ge,C===h.length&&(h+=me,a.e+=me)),ge!==me&&(q=Zg(t,o,H,me)||0),a._pt={_next:a._pt,p:ue||I===1?ue:",",s:q,c:he-q,m:Q&&Q<4||o==="zIndex"?Math.round:0});a.c=C<h.length?h.substring(C,h.length):""}else a.r=o==="display"&&h==="none"?x8:v8;return BU.test(h)&&(a.e=0),this._pt=a,a},f5={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},JX=function(t){var o=t.split(" "),l=o[0],h=o[1]||"50%";return(l==="top"||l==="bottom"||h==="left"||h==="right")&&(t=l,l=h,h=t),o[0]=f5[l]||l,o[1]=f5[h]||h,o.join(" ")},eZ=function(t,o){if(o.tween&&o.tween._time===o.tween._dur){var l=o.t,h=l.style,v=o.u,w=l._gsap,a,C,I;if(v==="all"||v===!0)h.cssText="",C=1;else for(v=v.split(","),I=v.length;--I>-1;)a=v[I],pm[a]&&(C=1,a=a==="transformOrigin"?Hc:mo),Xg(l,a);C&&(Xg(l,mo),w&&(w.svg&&l.removeAttribute("transform"),h.scale=h.rotate=h.translate="none",Tb(l,1),w.uncache=1,b8(h)))}},wA={clearProps:function(t,o,l,h,v){if(v.data!=="isFromStart"){var w=t._pt=new qc(t._pt,o,l,0,0,eZ);return w.u=h,w.pr=-10,w.tween=v,t._props.push(l),1}}},Ab=[1,0,0,1,0,0],E8={},M8=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},p5=function(t){var o=Fu(t,mo);return M8(o)?Ab:o.substr(7).match(LU).map(Vo)},_D=function(t,o){var l=t._gsap||zy(t),h=t.style,v=p5(t),w,a,C,I;return l.svg&&t.getAttribute("transform")?(C=t.transform.baseVal.consolidate().matrix,v=[C.a,C.b,C.c,C.d,C.e,C.f],v.join(",")==="1,0,0,1,0,0"?Ab:v):(v===Ab&&!t.offsetParent&&t!==E0&&!l.svg&&(C=h.display,h.display="block",w=t.parentNode,(!w||!t.offsetParent&&!t.getBoundingClientRect().width)&&(I=1,a=t.nextElementSibling,E0.appendChild(t)),v=p5(t),C?h.display=C:Xg(t,"display"),I&&(a?w.insertBefore(t,a):w?w.appendChild(t):E0.removeChild(t))),o&&v.length>6?[v[0],v[1],v[4],v[5],v[12],v[13]]:v)},_I=function(t,o,l,h,v,w){var a=t._gsap,C=v||_D(t,!0),I=a.xOrigin||0,L=a.yOrigin||0,k=a.xOffset||0,G=a.yOffset||0,q=C[0],Q=C[1],H=C[2],K=C[3],he=C[4],ue=C[5],me=o.split(" "),ge=parseFloat(me[0])||0,se=parseFloat(me[1])||0,fe,ve,Le,Ue;l?C!==Ab&&(ve=q*K-Q*H)&&(Le=ge*(K/ve)+se*(-H/ve)+(H*ue-K*he)/ve,Ue=ge*(-Q/ve)+se*(q/ve)-(q*ue-Q*he)/ve,ge=Le,se=Ue):(fe=T8(t),ge=fe.x+(~me[0].indexOf("%")?ge/100*fe.width:ge),se=fe.y+(~(me[1]||me[0]).indexOf("%")?se/100*fe.height:se)),h||h!==!1&&a.smooth?(he=ge-I,ue=se-L,a.xOffset=k+(he*q+ue*H)-he,a.yOffset=G+(he*Q+ue*K)-ue):a.xOffset=a.yOffset=0,a.xOrigin=ge,a.yOrigin=se,a.smooth=!!h,a.origin=o,a.originIsAbsolute=!!l,t.style[Hc]="0px 0px",w&&(kg(w,a,"xOrigin",I,ge),kg(w,a,"yOrigin",L,se),kg(w,a,"xOffset",k,a.xOffset),kg(w,a,"yOffset",G,a.yOffset)),t.setAttribute("data-svg-origin",ge+" "+se)},Tb=function(t,o){var l=t._gsap||new u8(t);if("x"in l&&!o&&!l.uncache)return l;var h=t.style,v=l.scaleX<0,w="px",a="deg",C=getComputedStyle(t),I=Fu(t,Hc)||"0",L,k,G,q,Q,H,K,he,ue,me,ge,se,fe,ve,Le,Ue,tt,Ke,nt,st,Rt,Mt,$e,rt,Ct,Kt,Je,Ze,gt,Bt,ar,Er;return L=k=G=H=K=he=ue=me=ge=0,q=Q=1,l.svg=!!(t.getCTM&&S8(t)),C.translate&&((C.translate!=="none"||C.scale!=="none"||C.rotate!=="none")&&(h[mo]=(C.translate!=="none"?"translate3d("+(C.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(C.rotate!=="none"?"rotate("+C.rotate+") ":"")+(C.scale!=="none"?"scale("+C.scale.split(" ").join(",")+") ":"")+(C[mo]!=="none"?C[mo]:"")),h.scale=h.rotate=h.translate="none"),ve=_D(t,l.svg),l.svg&&(l.uncache?(Ct=t.getBBox(),I=l.xOrigin-Ct.x+"px "+(l.yOrigin-Ct.y)+"px",rt=""):rt=!o&&t.getAttribute("data-svg-origin"),_I(t,rt||I,!!rt||l.originIsAbsolute,l.smooth!==!1,ve)),se=l.xOrigin||0,fe=l.yOrigin||0,ve!==Ab&&(Ke=ve[0],nt=ve[1],st=ve[2],Rt=ve[3],L=Mt=ve[4],k=$e=ve[5],ve.length===6?(q=Math.sqrt(Ke*Ke+nt*nt),Q=Math.sqrt(Rt*Rt+st*st),H=Ke||nt?l0(nt,Ke)*by:0,ue=st||Rt?l0(st,Rt)*by+H:0,ue&&(Q*=Math.abs(Math.cos(ue*M0))),l.svg&&(L-=se-(se*Ke+fe*st),k-=fe-(se*nt+fe*Rt))):(Er=ve[6],Bt=ve[7],Je=ve[8],Ze=ve[9],gt=ve[10],ar=ve[11],L=ve[12],k=ve[13],G=ve[14],Le=l0(Er,gt),K=Le*by,Le&&(Ue=Math.cos(-Le),tt=Math.sin(-Le),rt=Mt*Ue+Je*tt,Ct=$e*Ue+Ze*tt,Kt=Er*Ue+gt*tt,Je=Mt*-tt+Je*Ue,Ze=$e*-tt+Ze*Ue,gt=Er*-tt+gt*Ue,ar=Bt*-tt+ar*Ue,Mt=rt,$e=Ct,Er=Kt),Le=l0(-st,gt),he=Le*by,Le&&(Ue=Math.cos(-Le),tt=Math.sin(-Le),rt=Ke*Ue-Je*tt,Ct=nt*Ue-Ze*tt,Kt=st*Ue-gt*tt,ar=Rt*tt+ar*Ue,Ke=rt,nt=Ct,st=Kt),Le=l0(nt,Ke),H=Le*by,Le&&(Ue=Math.cos(Le),tt=Math.sin(Le),rt=Ke*Ue+nt*tt,Ct=Mt*Ue+$e*tt,nt=nt*Ue-Ke*tt,$e=$e*Ue-Mt*tt,Ke=rt,Mt=Ct),K&&Math.abs(K)+Math.abs(H)>359.9&&(K=H=0,he=180-he),q=Vo(Math.sqrt(Ke*Ke+nt*nt+st*st)),Q=Vo(Math.sqrt($e*$e+Er*Er)),Le=l0(Mt,$e),ue=Math.abs(Le)>2e-4?Le*by:0,ge=ar?1/(ar<0?-ar:ar):0),l.svg&&(rt=t.getAttribute("transform"),l.forceCSS=t.setAttribute("transform","")||!M8(Fu(t,mo)),rt&&t.setAttribute("transform",rt))),Math.abs(ue)>90&&Math.abs(ue)<270&&(v?(q*=-1,ue+=H<=0?180:-180,H+=H<=0?180:-180):(Q*=-1,ue+=ue<=0?180:-180)),o=o||l.uncache,l.x=L-((l.xPercent=L&&(!o&&l.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-L)?-50:0)))?t.offsetWidth*l.xPercent/100:0)+w,l.y=k-((l.yPercent=k&&(!o&&l.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-k)?-50:0)))?t.offsetHeight*l.yPercent/100:0)+w,l.z=G+w,l.scaleX=Vo(q),l.scaleY=Vo(Q),l.rotation=Vo(H)+a,l.rotationX=Vo(K)+a,l.rotationY=Vo(he)+a,l.skewX=ue+a,l.skewY=me+a,l.transformPerspective=ge+w,(l.zOrigin=parseFloat(I.split(" ")[2])||!o&&l.zOrigin||0)&&(h[Hc]=AA(I)),l.xOffset=l.yOffset=0,l.force3D=Nu.force3D,l.renderTransform=l.svg?rZ:A8?O8:tZ,l.uncache=0,l},AA=function(t){return(t=t.split(" "))[0]+" "+t[1]},XE=function(t,o,l){var h=Pl(o);return Vo(parseFloat(o)+parseFloat(Zg(t,"x",l+"px",h)))+h},tZ=function(t,o){o.z="0px",o.rotationY=o.rotationX="0deg",o.force3D=0,O8(t,o)},my="0deg",I1="0px",gy=") ",O8=function(t,o){var l=o||this,h=l.xPercent,v=l.yPercent,w=l.x,a=l.y,C=l.z,I=l.rotation,L=l.rotationY,k=l.rotationX,G=l.skewX,q=l.skewY,Q=l.scaleX,H=l.scaleY,K=l.transformPerspective,he=l.force3D,ue=l.target,me=l.zOrigin,ge="",se=he==="auto"&&t&&t!==1||he===!0;if(me&&(k!==my||L!==my)){var fe=parseFloat(L)*M0,ve=Math.sin(fe),Le=Math.cos(fe),Ue;fe=parseFloat(k)*M0,Ue=Math.cos(fe),w=XE(ue,w,ve*Ue*-me),a=XE(ue,a,-Math.sin(fe)*-me),C=XE(ue,C,Le*Ue*-me+me)}K!==I1&&(ge+="perspective("+K+gy),(h||v)&&(ge+="translate("+h+"%, "+v+"%) "),(se||w!==I1||a!==I1||C!==I1)&&(ge+=C!==I1||se?"translate3d("+w+", "+a+", "+C+") ":"translate("+w+", "+a+gy),I!==my&&(ge+="rotate("+I+gy),L!==my&&(ge+="rotateY("+L+gy),k!==my&&(ge+="rotateX("+k+gy),(G!==my||q!==my)&&(ge+="skew("+G+", "+q+gy),(Q!==1||H!==1)&&(ge+="scale("+Q+", "+H+gy),ue.style[mo]=ge||"translate(0, 0)"},rZ=function(t,o){var l=o||this,h=l.xPercent,v=l.yPercent,w=l.x,a=l.y,C=l.rotation,I=l.skewX,L=l.skewY,k=l.scaleX,G=l.scaleY,q=l.target,Q=l.xOrigin,H=l.yOrigin,K=l.xOffset,he=l.yOffset,ue=l.forceCSS,me=parseFloat(w),ge=parseFloat(a),se,fe,ve,Le,Ue;C=parseFloat(C),I=parseFloat(I),L=parseFloat(L),L&&(L=parseFloat(L),I+=L,C+=L),C||I?(C*=M0,I*=M0,se=Math.cos(C)*k,fe=Math.sin(C)*k,ve=Math.sin(C-I)*-G,Le=Math.cos(C-I)*G,I&&(L*=M0,Ue=Math.tan(I-L),Ue=Math.sqrt(1+Ue*Ue),ve*=Ue,Le*=Ue,L&&(Ue=Math.tan(L),Ue=Math.sqrt(1+Ue*Ue),se*=Ue,fe*=Ue)),se=Vo(se),fe=Vo(fe),ve=Vo(ve),Le=Vo(Le)):(se=k,Le=G,fe=ve=0),(me&&!~(w+"").indexOf("px")||ge&&!~(a+"").indexOf("px"))&&(me=Zg(q,"x",w,"px"),ge=Zg(q,"y",a,"px")),(Q||H||K||he)&&(me=Vo(me+Q-(Q*se+H*ve)+K),ge=Vo(ge+H-(Q*fe+H*Le)+he)),(h||v)&&(Ue=q.getBBox(),me=Vo(me+h/100*Ue.width),ge=Vo(ge+v/100*Ue.height)),Ue="matrix("+se+","+fe+","+ve+","+Le+","+me+","+ge+")",q.setAttribute("transform",Ue),ue&&(q.style[mo]=Ue)},nZ=function(t,o,l,h,v){var w=360,a=Hs(v),C=parseFloat(v)*(a&&~v.indexOf("rad")?by:1),I=C-h,L=h+I+"deg",k,G;return a&&(k=v.split("_")[1],k==="short"&&(I%=w,I!==I%(w/2)&&(I+=I<0?w:-w)),k==="cw"&&I<0?I=(I+w*l5)%w-~~(I/w)*w:k==="ccw"&&I>0&&(I=(I-w*l5)%w-~~(I/w)*w)),t._pt=G=new qc(t._pt,o,l,h,I,NX),G.e=L,G.u="deg",t._props.push(l),G},m5=function(t,o){for(var l in o)t[l]=o[l];return t},iZ=function(t,o,l){var h=m5({},l._gsap),v="perspective,force3D,transformOrigin,svgOrigin",w=l.style,a,C,I,L,k,G,q,Q;h.svg?(I=l.getAttribute("transform"),l.setAttribute("transform",""),w[mo]=o,a=Tb(l,1),Xg(l,mo),l.setAttribute("transform",I)):(I=getComputedStyle(l)[mo],w[mo]=o,a=Tb(l,1),w[mo]=I);for(C in pm)I=h[C],L=a[C],I!==L&&v.indexOf(C)<0&&(q=Pl(I),Q=Pl(L),k=q!==Q?Zg(l,C,I,Q):parseFloat(I),G=parseFloat(L),t._pt=new qc(t._pt,a,C,k,G-k,pI),t._pt.u=Q||0,t._props.push(C));m5(a,h)};$c("padding,margin,Width,Radius",function(r,t){var o="Top",l="Right",h="Bottom",v="Left",w=(t<3?[o,l,h,v]:[o+v,o+l,h+l,h+v]).map(function(a){return t<2?r+a:"border"+a+r});wA[t>1?"border"+r:r]=function(a,C,I,L,k){var G,q;if(arguments.length<4)return G=w.map(function(Q){return rm(a,Q,I)}),q=G.join(" "),q.split(G[0]).length===5?G[0]:q;G=(L+"").split(" "),q={},w.forEach(function(Q,H){return q[Q]=G[H]=G[H]||G[(H-1)/2|0]}),a.init(C,q,k)}});var C8={name:"css",register:gI,targetTest:function(t){return t.style&&t.nodeType},init:function(t,o,l,h,v){var w=this._props,a=t.style,C=l.vars.startAt,I,L,k,G,q,Q,H,K,he,ue,me,ge,se,fe,ve,Le,Ue;pD||gI(),this.styles=this.styles||w8(t),Le=this.styles.props,this.tween=l;for(H in o)if(H!=="autoRound"&&(L=o[H],!(Pu[H]&&h8(H,o,l,h,t,v)))){if(q=typeof L,Q=wA[H],q==="function"&&(L=L.call(l,h,t,v),q=typeof L),q==="string"&&~L.indexOf("random(")&&(L=xb(L)),Q)Q(this,t,H,L,l)&&(ve=1);else if(H.substr(0,2)==="--")I=(getComputedStyle(t).getPropertyValue(H)+"").trim(),L+="",Gg.lastIndex=0,Gg.test(I)||(K=Pl(I),he=Pl(L),he?K!==he&&(I=Zg(t,H,I,he)+he):K&&(L+=K)),this.add(a,"setProperty",I,L,h,v,0,0,H),w.push(H),Le.push(H,0,a[H]);else if(q!=="undefined"){if(C&&H in C?(I=typeof C[H]=="function"?C[H].call(l,h,t,v):C[H],Hs(I)&&~I.indexOf("random(")&&(I=xb(I)),Pl(I+"")||I==="auto"||(I+=Nu.units[H]||Pl(rm(t,H))||""),(I+"").charAt(1)==="="&&(I=rm(t,H))):I=rm(t,H),G=parseFloat(I),ue=q==="string"&&L.charAt(1)==="="&&L.substr(0,2),ue&&(L=L.substr(2)),k=parseFloat(L),H in Nf&&(H==="autoAlpha"&&(G===1&&rm(t,"visibility")==="hidden"&&k&&(G=0),Le.push("visibility",0,a.visibility),kg(this,a,"visibility",G?"inherit":"hidden",k?"inherit":"hidden",!k)),H!=="scale"&&H!=="transform"&&(H=Nf[H],~H.indexOf(",")&&(H=H.split(",")[0]))),me=H in pm,me){if(this.styles.save(H),Ue=L,q==="string"&&L.substring(0,6)==="var(--"){if(L=Fu(t,L.substring(4,L.indexOf(")"))),L.substring(0,5)==="calc("){var tt=t.style.perspective;t.style.perspective=L,L=Fu(t,"perspective"),tt?t.style.perspective=tt:Xg(t,"perspective")}k=parseFloat(L)}if(ge||(se=t._gsap,se.renderTransform&&!o.parseTransform||Tb(t,o.parseTransform),fe=o.smoothOrigin!==!1&&se.smooth,ge=this._pt=new qc(this._pt,a,mo,0,1,se.renderTransform,se,0,-1),ge.dep=1),H==="scale")this._pt=new qc(this._pt,se,"scaleY",se.scaleY,(ue?S0(se.scaleY,ue+k):k)-se.scaleY||0,pI),this._pt.u=0,w.push("scaleY",H),H+="X";else if(H==="transformOrigin"){Le.push(Hc,0,a[Hc]),L=JX(L),se.svg?_I(t,L,0,fe,0,this):(he=parseFloat(L.split(" ")[2])||0,he!==se.zOrigin&&kg(this,se,"zOrigin",se.zOrigin,he),kg(this,a,H,AA(I),AA(L)));continue}else if(H==="svgOrigin"){_I(t,L,1,fe,0,this);continue}else if(H in E8){nZ(this,se,H,G,ue?S0(G,ue+L):L);continue}else if(H==="smoothOrigin"){kg(this,se,"smooth",se.smooth,L);continue}else if(H==="force3D"){se[H]=L;continue}else if(H==="transform"){iZ(this,L,t);continue}}else H in a||(H=U0(H)||H);if(me||(k||k===0)&&(G||G===0)&&!FX.test(L)&&H in a)K=(I+"").substr((G+"").length),k||(k=0),he=Pl(L)||(H in Nu.units?Nu.units[H]:K),K!==he&&(G=Zg(t,H,I,he)),this._pt=new qc(this._pt,me?se:a,H,G,(ue?S0(G,ue+k):k)-G,!me&&(he==="px"||H==="zIndex")&&o.autoRound!==!1?VX:pI),this._pt.u=he||0,me&&Ue!==L?(this._pt.b=I,this._pt.e=Ue,this._pt.r=UX):K!==he&&he!=="%"&&(this._pt.b=I,this._pt.r=jX);else if(H in a)QX.call(this,t,H,I,ue?ue+L:L);else if(H in t)this.add(t,H,I||t[H],ue?ue+L:L,h,v);else if(H!=="parseTransform"){iD(H,L);continue}me||(H in a?Le.push(H,0,a[H]):typeof t[H]=="function"?Le.push(H,2,t[H]()):Le.push(H,1,I||t[H])),w.push(H)}}ve&&_8(this)},render:function(t,o){if(o.tween._time||!mD())for(var l=o._pt;l;)l.r(t,l.d),l=l._next;else o.styles.revert()},get:rm,aliases:Nf,getSetter:function(t,o,l){var h=Nf[o];return h&&h.indexOf(",")<0&&(o=h),o in pm&&o!==Hc&&(t._gsap.x||rm(t,"x"))?l&&s5===l?o==="scale"?HX:qX:(s5=l||{})&&(o==="scale"?XX:ZX):t.style&&!tD(t.style[o])?GX:~o.indexOf("-")?$X:dD(t,o)},core:{_removeProperty:Xg,_getMatrix:_D}};Xc.utils.checkPrefix=U0;Xc.core.getStyleSaver=w8;(function(r,t,o,l){var h=$c(r+","+t+","+o,function(v){pm[v]=1});$c(t,function(v){Nu.units[v]="deg",E8[v]=1}),Nf[h[13]]=r+","+t,$c(l,function(v){var w=v.split(":");Nf[w[1]]=h[w[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");$c("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){Nu.units[r]="px"});Xc.registerPlugin(C8);var Dg=Xc.registerPlugin(C8)||Xc;Dg.core.Tween;function aZ(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,l.key,l)}}function oZ(r,t,o){return t&&aZ(r.prototype,t),r}var sl,sA,Lu,Fg,Ng,O0,I8,wy,tb,P8,im,Od,D8,R8=function(){return sl||typeof window<"u"&&(sl=window.gsap)&&sl.registerPlugin&&sl},z8=1,y0=[],gi=[],Gf=[],rb=Date.now,yI=function(t,o){return o},sZ=function(){var t=tb.core,o=t.bridge||{},l=t._scrollers,h=t._proxies;l.push.apply(l,gi),h.push.apply(h,Gf),gi=l,Gf=h,yI=function(w,a){return o[w](a)}},$g=function(t,o){return~Gf.indexOf(t)&&Gf[Gf.indexOf(t)+1][o]},nb=function(t){return!!~P8.indexOf(t)},sc=function(t,o,l,h,v){return t.addEventListener(o,l,{passive:h!==!1,capture:!!v})},oc=function(t,o,l,h){return t.removeEventListener(o,l,!!h)},P2="scrollLeft",D2="scrollTop",vI=function(){return im&&im.isPressed||gi.cache++},TA=function(t,o){var l=function h(v){if(v||v===0){z8&&(Lu.history.scrollRestoration="manual");var w=im&&im.isPressed;v=h.v=Math.round(v)||(im&&im.iOS?1:0),t(v),h.cacheID=gi.cache,w&&yI("ss",v)}else(o||gi.cache!==h.cacheID||yI("ref"))&&(h.cacheID=gi.cache,h.v=t());return h.v+h.offset};return l.offset=0,t&&l},dc={s:P2,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:TA(function(r){return arguments.length?Lu.scrollTo(r,Ss.sc()):Lu.pageXOffset||Fg[P2]||Ng[P2]||O0[P2]||0})},Ss={s:D2,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:dc,sc:TA(function(r){return arguments.length?Lu.scrollTo(dc.sc(),r):Lu.pageYOffset||Fg[D2]||Ng[D2]||O0[D2]||0})},jc=function(t,o){return(o&&o._ctx&&o._ctx.selector||sl.utils.toArray)(t)[0]||(typeof t=="string"&&sl.config().nullTargetWarn!==!1?console.warn("Element not found:",t):null)},lZ=function(t,o){for(var l=o.length;l--;)if(o[l]===t||o[l].contains(t))return!0;return!1},Wg=function(t,o){var l=o.s,h=o.sc;nb(t)&&(t=Fg.scrollingElement||Ng);var v=gi.indexOf(t),w=h===Ss.sc?1:2;!~v&&(v=gi.push(t)-1),gi[v+w]||sc(t,"scroll",vI);var a=gi[v+w],C=a||(gi[v+w]=TA($g(t,l),!0)||(nb(t)?h:TA(function(I){return arguments.length?t[l]=I:t[l]})));return C.target=t,a||(C.smooth=sl.getProperty(t,"scrollBehavior")==="smooth"),C},xI=function(t,o,l){var h=t,v=t,w=rb(),a=w,C=o||50,I=Math.max(500,C*3),L=function(Q,H){var K=rb();H||K-w>C?(v=h,h=Q,a=w,w=K):l?h+=Q:h=v+(Q-v)/(K-a)*(w-a)},k=function(){v=h=l?0:h,a=w=0},G=function(Q){var H=a,K=v,he=rb();return(Q||Q===0)&&Q!==h&&L(Q),w===a||he-a>I?0:(h+(l?K:-K))/((l?he:w)-H)*1e3};return{update:L,reset:k,getVelocity:G}},P1=function(t,o){return o&&!t._gsapAllow&&t.preventDefault(),t.changedTouches?t.changedTouches[0]:t},g5=function(t){var o=Math.max.apply(Math,t),l=Math.min.apply(Math,t);return Math.abs(o)>=Math.abs(l)?o:l},L8=function(){tb=sl.core.globals().ScrollTrigger,tb&&tb.core&&sZ()},B8=function(t){return sl=t||R8(),!sA&&sl&&typeof document<"u"&&document.body&&(Lu=window,Fg=document,Ng=Fg.documentElement,O0=Fg.body,P8=[Lu,Fg,Ng,O0],sl.utils.clamp,D8=sl.core.context||function(){},wy="onpointerenter"in O0?"pointer":"mouse",I8=Go.isTouch=Lu.matchMedia&&Lu.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Lu||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,Od=Go.eventTypes=("ontouchstart"in Ng?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Ng?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return z8=0},500),L8(),sA=1),sA};dc.op=Ss;gi.cache=0;var Go=(function(){function r(o){this.init(o)}var t=r.prototype;return t.init=function(l){sA||B8(sl)||console.warn("Please gsap.registerPlugin(Observer)"),tb||L8();var h=l.tolerance,v=l.dragMinimum,w=l.type,a=l.target,C=l.lineHeight,I=l.debounce,L=l.preventDefault,k=l.onStop,G=l.onStopDelay,q=l.ignore,Q=l.wheelSpeed,H=l.event,K=l.onDragStart,he=l.onDragEnd,ue=l.onDrag,me=l.onPress,ge=l.onRelease,se=l.onRight,fe=l.onLeft,ve=l.onUp,Le=l.onDown,Ue=l.onChangeX,tt=l.onChangeY,Ke=l.onChange,nt=l.onToggleX,st=l.onToggleY,Rt=l.onHover,Mt=l.onHoverEnd,$e=l.onMove,rt=l.ignoreCheck,Ct=l.isNormalizer,Kt=l.onGestureStart,Je=l.onGestureEnd,Ze=l.onWheel,gt=l.onEnable,Bt=l.onDisable,ar=l.onClick,Er=l.scrollSpeed,jr=l.capture,Zr=l.allowClicks,fn=l.lockAxis,Xt=l.onLockAxis;this.target=a=jc(a)||Ng,this.vars=l,q&&(q=sl.utils.toArray(q)),h=h||1e-9,v=v||0,Q=Q||1,Er=Er||1,w=w||"wheel,touch,pointer",I=I!==!1,C||(C=parseFloat(Lu.getComputedStyle(O0).lineHeight)||22);var Mr,kr,or,Tr,Ur,zn,Fn,Ut=this,_n=0,ua=0,da=l.passive||!L&&l.passive!==!1,Yn=Wg(a,dc),ha=Wg(a,Ss),go=Yn(),ni=ha(),ii=~w.indexOf("touch")&&!~w.indexOf("pointer")&&Od[0]==="pointerdown",no=nb(a),Ai=a.ownerDocument||Fg,ga=[0,0,0],Ha=[0,0,0],Zi=0,cl=function(){return Zi=rb()},fi=function(Jr,yt){return(Ut.event=Jr)&&q&&lZ(Jr.target,q)||yt&&ii&&Jr.pointerType!=="touch"||rt&&rt(Jr,yt)},Cs=function(){Ut._vx.reset(),Ut._vy.reset(),kr.pause(),k&&k(Ut)},Ci=function(){var Jr=Ut.deltaX=g5(ga),yt=Ut.deltaY=g5(Ha),Or=Math.abs(Jr)>=h,Sn=Math.abs(yt)>=h;Ke&&(Or||Sn)&&Ke(Ut,Jr,yt,ga,Ha),Or&&(se&&Ut.deltaX>0&&se(Ut),fe&&Ut.deltaX<0&&fe(Ut),Ue&&Ue(Ut),nt&&Ut.deltaX<0!=_n<0&&nt(Ut),_n=Ut.deltaX,ga[0]=ga[1]=ga[2]=0),Sn&&(Le&&Ut.deltaY>0&&Le(Ut),ve&&Ut.deltaY<0&&ve(Ut),tt&&tt(Ut),st&&Ut.deltaY<0!=ua<0&&st(Ut),ua=Ut.deltaY,Ha[0]=Ha[1]=Ha[2]=0),(Tr||or)&&($e&&$e(Ut),or&&(K&&or===1&&K(Ut),ue&&ue(Ut),or=0),Tr=!1),zn&&!(zn=!1)&&Xt&&Xt(Ut),Ur&&(Ze(Ut),Ur=!1),Mr=0},Ti=function(Jr,yt,Or){ga[Or]+=Jr,Ha[Or]+=yt,Ut._vx.update(Jr),Ut._vy.update(yt),I?Mr||(Mr=requestAnimationFrame(Ci)):Ci()},qi=function(Jr,yt){fn&&!Fn&&(Ut.axis=Fn=Math.abs(Jr)>Math.abs(yt)?"x":"y",zn=!0),Fn!=="y"&&(ga[2]+=Jr,Ut._vx.update(Jr,!0)),Fn!=="x"&&(Ha[2]+=yt,Ut._vy.update(yt,!0)),I?Mr||(Mr=requestAnimationFrame(Ci)):Ci()},_o=function(Jr){if(!fi(Jr,1)){Jr=P1(Jr,L);var yt=Jr.clientX,Or=Jr.clientY,Sn=yt-Ut.x,an=Or-Ut.y,yr=Ut.isDragging;Ut.x=yt,Ut.y=Or,(yr||(Sn||an)&&(Math.abs(Ut.startX-yt)>=v||Math.abs(Ut.startY-Or)>=v))&&(or||(or=yr?2:1),yr||(Ut.isDragging=!0),qi(Sn,an))}},$o=Ut.onPress=function(Tn){fi(Tn,1)||Tn&&Tn.button||(Ut.axis=Fn=null,kr.pause(),Ut.isPressed=!0,Tn=P1(Tn),_n=ua=0,Ut.startX=Ut.x=Tn.clientX,Ut.startY=Ut.y=Tn.clientY,Ut._vx.reset(),Ut._vy.reset(),sc(Ct?a:Ai,Od[1],_o,da,!0),Ut.deltaX=Ut.deltaY=0,me&&me(Ut))},Mn=Ut.onRelease=function(Tn){if(!fi(Tn,1)){oc(Ct?a:Ai,Od[1],_o,!0);var Jr=!isNaN(Ut.y-Ut.startY),yt=Ut.isDragging,Or=yt&&(Math.abs(Ut.x-Ut.startX)>3||Math.abs(Ut.y-Ut.startY)>3),Sn=P1(Tn);!Or&&Jr&&(Ut._vx.reset(),Ut._vy.reset(),L&&Zr&&sl.delayedCall(.08,function(){if(rb()-Zi>300&&!Tn.defaultPrevented){if(Tn.target.click)Tn.target.click();else if(Ai.createEvent){var an=Ai.createEvent("MouseEvents");an.initMouseEvent("click",!0,!0,Lu,1,Sn.screenX,Sn.screenY,Sn.clientX,Sn.clientY,!1,!1,!1,!1,0,null),Tn.target.dispatchEvent(an)}}})),Ut.isDragging=Ut.isGesturing=Ut.isPressed=!1,k&&yt&&!Ct&&kr.restart(!0),or&&Ci(),he&&yt&&he(Ut),ge&&ge(Ut,Or)}},io=function(Jr){return Jr.touches&&Jr.touches.length>1&&(Ut.isGesturing=!0)&&Kt(Jr,Ut.isDragging)},_a=function(){return(Ut.isGesturing=!1)||Je(Ut)},La=function(Jr){if(!fi(Jr)){var yt=Yn(),Or=ha();Ti((yt-go)*Er,(Or-ni)*Er,1),go=yt,ni=Or,k&&kr.restart(!0)}},pn=function(Jr){if(!fi(Jr)){Jr=P1(Jr,L),Ze&&(Ur=!0);var yt=(Jr.deltaMode===1?C:Jr.deltaMode===2?Lu.innerHeight:1)*Q;Ti(Jr.deltaX*yt,Jr.deltaY*yt,0),k&&!Ct&&kr.restart(!0)}},Bi=function(Jr){if(!fi(Jr)){var yt=Jr.clientX,Or=Jr.clientY,Sn=yt-Ut.x,an=Or-Ut.y;Ut.x=yt,Ut.y=Or,Tr=!0,k&&kr.restart(!0),(Sn||an)&&qi(Sn,an)}},as=function(Jr){Ut.event=Jr,Rt(Ut)},qo=function(Jr){Ut.event=Jr,Mt(Ut)},Xa=function(Jr){return fi(Jr)||P1(Jr,L)&&ar(Ut)};kr=Ut._dc=sl.delayedCall(G||.25,Cs).pause(),Ut.deltaX=Ut.deltaY=0,Ut._vx=xI(0,50,!0),Ut._vy=xI(0,50,!0),Ut.scrollX=Yn,Ut.scrollY=ha,Ut.isDragging=Ut.isGesturing=Ut.isPressed=!1,D8(this),Ut.enable=function(Tn){return Ut.isEnabled||(sc(no?Ai:a,"scroll",vI),w.indexOf("scroll")>=0&&sc(no?Ai:a,"scroll",La,da,jr),w.indexOf("wheel")>=0&&sc(a,"wheel",pn,da,jr),(w.indexOf("touch")>=0&&I8||w.indexOf("pointer")>=0)&&(sc(a,Od[0],$o,da,jr),sc(Ai,Od[2],Mn),sc(Ai,Od[3],Mn),Zr&&sc(a,"click",cl,!0,!0),ar&&sc(a,"click",Xa),Kt&&sc(Ai,"gesturestart",io),Je&&sc(Ai,"gestureend",_a),Rt&&sc(a,wy+"enter",as),Mt&&sc(a,wy+"leave",qo),$e&&sc(a,wy+"move",Bi)),Ut.isEnabled=!0,Ut.isDragging=Ut.isGesturing=Ut.isPressed=Tr=or=!1,Ut._vx.reset(),Ut._vy.reset(),go=Yn(),ni=ha(),Tn&&Tn.type&&$o(Tn),gt&&gt(Ut)),Ut},Ut.disable=function(){Ut.isEnabled&&(y0.filter(function(Tn){return Tn!==Ut&&nb(Tn.target)}).length||oc(no?Ai:a,"scroll",vI),Ut.isPressed&&(Ut._vx.reset(),Ut._vy.reset(),oc(Ct?a:Ai,Od[1],_o,!0)),oc(no?Ai:a,"scroll",La,jr),oc(a,"wheel",pn,jr),oc(a,Od[0],$o,jr),oc(Ai,Od[2],Mn),oc(Ai,Od[3],Mn),oc(a,"click",cl,!0),oc(a,"click",Xa),oc(Ai,"gesturestart",io),oc(Ai,"gestureend",_a),oc(a,wy+"enter",as),oc(a,wy+"leave",qo),oc(a,wy+"move",Bi),Ut.isEnabled=Ut.isPressed=Ut.isDragging=!1,Bt&&Bt(Ut))},Ut.kill=Ut.revert=function(){Ut.disable();var Tn=y0.indexOf(Ut);Tn>=0&&y0.splice(Tn,1),im===Ut&&(im=0)},y0.push(Ut),Ct&&nb(a)&&(im=Ut),Ut.enable(H)},oZ(r,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),r})();Go.version="3.14.2";Go.create=function(r){return new Go(r)};Go.register=B8;Go.getAll=function(){return y0.slice()};Go.getById=function(r){return y0.filter(function(t){return t.vars.id===r})[0]};R8()&&sl.registerPlugin(Go);var Qr,p0,mi,Pa,Ru,la,yD,SA,Sb,ib,$1,R2,Ml,PT,bI,cc,_5,y5,m0,k8,ZE,F8,lc,wI,N8,j8,Ig,AI,vD,C0,xD,ab,TI,WE,z2=1,Cl=Date.now,YE=Cl(),Dh=0,q1=0,v5=function(t,o,l){var h=Cu(t)&&(t.substr(0,6)==="clamp("||t.indexOf("max")>-1);return l["_"+o+"Clamp"]=h,h?t.substr(6,t.length-7):t},x5=function(t,o){return o&&(!Cu(t)||t.substr(0,6)!=="clamp(")?"clamp("+t+")":t},cZ=function r(){return q1&&requestAnimationFrame(r)},b5=function(){return PT=1},w5=function(){return PT=0},kf=function(t){return t},H1=function(t){return Math.round(t*1e5)/1e5||0},U8=function(){return typeof window<"u"},V8=function(){return Qr||U8()&&(Qr=window.gsap)&&Qr.registerPlugin&&Qr},qy=function(t){return!!~yD.indexOf(t)},G8=function(t){return(t==="Height"?xD:mi["inner"+t])||Ru["client"+t]||la["client"+t]},$8=function(t){return $g(t,"getBoundingClientRect")||(qy(t)?function(){return dA.width=mi.innerWidth,dA.height=xD,dA}:function(){return nm(t)})},uZ=function(t,o,l){var h=l.d,v=l.d2,w=l.a;return(w=$g(t,"getBoundingClientRect"))?function(){return w()[h]}:function(){return(o?G8(v):t["client"+v])||0}},hZ=function(t,o){return!o||~Gf.indexOf(t)?$8(t):function(){return dA}},jf=function(t,o){var l=o.s,h=o.d2,v=o.d,w=o.a;return Math.max(0,(l="scroll"+h)&&(w=$g(t,l))?w()-$8(t)()[v]:qy(t)?(Ru[l]||la[l])-G8(h):t[l]-t["offset"+h])},L2=function(t,o){for(var l=0;l<m0.length;l+=3)(!o||~o.indexOf(m0[l+1]))&&t(m0[l],m0[l+1],m0[l+2])},Cu=function(t){return typeof t=="string"},Dl=function(t){return typeof t=="function"},X1=function(t){return typeof t=="number"},Ay=function(t){return typeof t=="object"},D1=function(t,o,l){return t&&t.progress(o?0:1)&&l&&t.pause()},KE=function(t,o){if(t.enabled){var l=t._ctx?t._ctx.add(function(){return o(t)}):o(t);l&&l.totalTime&&(t.callbackAnimation=l)}},c0=Math.abs,q8="left",H8="top",bD="right",wD="bottom",Fy="width",Ny="height",ob="Right",sb="Left",lb="Top",cb="Bottom",rs="padding",Eh="margin",V0="Width",AD="Height",Ts="px",Mh=function(t){return mi.getComputedStyle(t)},dZ=function(t){var o=Mh(t).position;t.style.position=o==="absolute"||o==="fixed"?o:"relative"},A5=function(t,o){for(var l in o)l in t||(t[l]=o[l]);return t},nm=function(t,o){var l=o&&Mh(t)[bI]!=="matrix(1, 0, 0, 1, 0, 0)"&&Qr.to(t,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),h=t.getBoundingClientRect();return l&&l.progress(0).kill(),h},EA=function(t,o){var l=o.d2;return t["offset"+l]||t["client"+l]||0},X8=function(t){var o=[],l=t.labels,h=t.duration(),v;for(v in l)o.push(l[v]/h);return o},fZ=function(t){return function(o){return Qr.utils.snap(X8(t),o)}},TD=function(t){var o=Qr.utils.snap(t),l=Array.isArray(t)&&t.slice(0).sort(function(h,v){return h-v});return l?function(h,v,w){w===void 0&&(w=.001);var a;if(!v)return o(h);if(v>0){for(h-=w,a=0;a<l.length;a++)if(l[a]>=h)return l[a];return l[a-1]}else for(a=l.length,h+=w;a--;)if(l[a]<=h)return l[a];return l[0]}:function(h,v,w){w===void 0&&(w=.001);var a=o(h);return!v||Math.abs(a-h)<w||a-h<0==v<0?a:o(v<0?h-t:h+t)}},pZ=function(t){return function(o,l){return TD(X8(t))(o,l.direction)}},B2=function(t,o,l,h){return l.split(",").forEach(function(v){return t(o,v,h)})},Gs=function(t,o,l,h,v){return t.addEventListener(o,l,{passive:!h,capture:!!v})},Vs=function(t,o,l,h){return t.removeEventListener(o,l,!!h)},k2=function(t,o,l){l=l&&l.wheelHandler,l&&(t(o,"wheel",l),t(o,"touchmove",l))},T5={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},F2={toggleActions:"play",anticipatePin:0},MA={top:0,left:0,center:.5,bottom:1,right:1},lA=function(t,o){if(Cu(t)){var l=t.indexOf("="),h=~l?+(t.charAt(l-1)+1)*parseFloat(t.substr(l+1)):0;~l&&(t.indexOf("%")>l&&(h*=o/100),t=t.substr(0,l-1)),t=h+(t in MA?MA[t]*o:~t.indexOf("%")?parseFloat(t)*o/100:parseFloat(t)||0)}return t},N2=function(t,o,l,h,v,w,a,C){var I=v.startColor,L=v.endColor,k=v.fontSize,G=v.indent,q=v.fontWeight,Q=Pa.createElement("div"),H=qy(l)||$g(l,"pinType")==="fixed",K=t.indexOf("scroller")!==-1,he=H?la:l,ue=t.indexOf("start")!==-1,me=ue?I:L,ge="border-color:"+me+";font-size:"+k+";color:"+me+";font-weight:"+q+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return ge+="position:"+((K||C)&&H?"fixed;":"absolute;"),(K||C||!H)&&(ge+=(h===Ss?bD:wD)+":"+(w+parseFloat(G))+"px;"),a&&(ge+="box-sizing:border-box;text-align:left;width:"+a.offsetWidth+"px;"),Q._isStart=ue,Q.setAttribute("class","gsap-marker-"+t+(o?" marker-"+o:"")),Q.style.cssText=ge,Q.innerText=o||o===0?t+"-"+o:t,he.children[0]?he.insertBefore(Q,he.children[0]):he.appendChild(Q),Q._offset=Q["offset"+h.op.d2],cA(Q,0,h,ue),Q},cA=function(t,o,l,h){var v={display:"block"},w=l[h?"os2":"p2"],a=l[h?"p2":"os2"];t._isFlipped=h,v[l.a+"Percent"]=h?-100:0,v[l.a]=h?"1px":0,v["border"+w+V0]=1,v["border"+a+V0]=0,v[l.p]=o+"px",Qr.set(t,v)},di=[],SI={},Eb,S5=function(){return Cl()-Dh>34&&(Eb||(Eb=requestAnimationFrame(lm)))},u0=function(){(!lc||!lc.isPressed||lc.startX>la.clientWidth)&&(gi.cache++,lc?Eb||(Eb=requestAnimationFrame(lm)):lm(),Dh||Xy("scrollStart"),Dh=Cl())},QE=function(){j8=mi.innerWidth,N8=mi.innerHeight},Z1=function(t){gi.cache++,(t===!0||!Ml&&!F8&&!Pa.fullscreenElement&&!Pa.webkitFullscreenElement&&(!wI||j8!==mi.innerWidth||Math.abs(mi.innerHeight-N8)>mi.innerHeight*.25))&&SA.restart(!0)},Hy={},mZ=[],Z8=function r(){return Vs(wi,"scrollEnd",r)||Oy(!0)},Xy=function(t){return Hy[t]&&Hy[t].map(function(o){return o()})||mZ},Ou=[],W8=function(t){for(var o=0;o<Ou.length;o+=5)(!t||Ou[o+4]&&Ou[o+4].query===t)&&(Ou[o].style.cssText=Ou[o+1],Ou[o].getBBox&&Ou[o].setAttribute("transform",Ou[o+2]||""),Ou[o+3].uncache=1)},Y8=function(){return gi.forEach(function(t){return Dl(t)&&++t.cacheID&&(t.rec=t())})},SD=function(t,o){var l;for(cc=0;cc<di.length;cc++)l=di[cc],l&&(!o||l._ctx===o)&&(t?l.kill(1):l.revert(!0,!0));ab=!0,o&&W8(o),o||Xy("revert")},K8=function(t,o){gi.cache++,(o||!uc)&&gi.forEach(function(l){return Dl(l)&&l.cacheID++&&(l.rec=0)}),Cu(t)&&(mi.history.scrollRestoration=vD=t)},uc,jy=0,E5,gZ=function(){if(E5!==jy){var t=E5=jy;requestAnimationFrame(function(){return t===jy&&Oy(!0)})}},Q8=function(){la.appendChild(C0),xD=!lc&&C0.offsetHeight||mi.innerHeight,la.removeChild(C0)},M5=function(t){return Sb(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(o){return o.style.display=t?"none":"block"})},Oy=function(t,o){if(Ru=Pa.documentElement,la=Pa.body,yD=[mi,Pa,Ru,la],Dh&&!t&&!ab){Gs(wi,"scrollEnd",Z8);return}Q8(),uc=wi.isRefreshing=!0,ab||Y8();var l=Xy("refreshInit");k8&&wi.sort(),o||SD(),gi.forEach(function(h){Dl(h)&&(h.smooth&&(h.target.style.scrollBehavior="auto"),h(0))}),di.slice(0).forEach(function(h){return h.refresh()}),ab=!1,di.forEach(function(h){if(h._subPinOffset&&h.pin){var v=h.vars.horizontal?"offsetWidth":"offsetHeight",w=h.pin[v];h.revert(!0,1),h.adjustPinSpacing(h.pin[v]-w),h.refresh()}}),TI=1,M5(!0),di.forEach(function(h){var v=jf(h.scroller,h._dir),w=h.vars.end==="max"||h._endClamp&&h.end>v,a=h._startClamp&&h.start>=v;(w||a)&&h.setPositions(a?v-1:h.start,w?Math.max(a?v:h.start+1,v):h.end,!0)}),M5(!1),TI=0,l.forEach(function(h){return h&&h.render&&h.render(-1)}),gi.forEach(function(h){Dl(h)&&(h.smooth&&requestAnimationFrame(function(){return h.target.style.scrollBehavior="smooth"}),h.rec&&h(h.rec))}),K8(vD,1),SA.pause(),jy++,uc=2,lm(2),di.forEach(function(h){return Dl(h.vars.onRefresh)&&h.vars.onRefresh(h)}),uc=wi.isRefreshing=!1,Xy("refresh")},EI=0,uA=1,ub,lm=function(t){if(t===2||!uc&&!ab){wi.isUpdating=!0,ub&&ub.update(0);var o=di.length,l=Cl(),h=l-YE>=50,v=o&&di[0].scroll();if(uA=EI>v?-1:1,uc||(EI=v),h&&(Dh&&!PT&&l-Dh>200&&(Dh=0,Xy("scrollEnd")),$1=YE,YE=l),uA<0){for(cc=o;cc-- >0;)di[cc]&&di[cc].update(0,h);uA=1}else for(cc=0;cc<o;cc++)di[cc]&&di[cc].update(0,h);wi.isUpdating=!1}Eb=0},MI=[q8,H8,wD,bD,Eh+cb,Eh+ob,Eh+lb,Eh+sb,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],hA=MI.concat([Fy,Ny,"boxSizing","max"+V0,"max"+AD,"position",Eh,rs,rs+lb,rs+ob,rs+cb,rs+sb]),_Z=function(t,o,l){I0(l);var h=t._gsap;if(h.spacerIsNative)I0(h.spacerState);else if(t._gsap.swappedIn){var v=o.parentNode;v&&(v.insertBefore(t,o),v.removeChild(o))}t._gsap.swappedIn=!1},JE=function(t,o,l,h){if(!t._gsap.swappedIn){for(var v=MI.length,w=o.style,a=t.style,C;v--;)C=MI[v],w[C]=l[C];w.position=l.position==="absolute"?"absolute":"relative",l.display==="inline"&&(w.display="inline-block"),a[wD]=a[bD]="auto",w.flexBasis=l.flexBasis||"auto",w.overflow="visible",w.boxSizing="border-box",w[Fy]=EA(t,dc)+Ts,w[Ny]=EA(t,Ss)+Ts,w[rs]=a[Eh]=a[H8]=a[q8]="0",I0(h),a[Fy]=a["max"+V0]=l[Fy],a[Ny]=a["max"+AD]=l[Ny],a[rs]=l[rs],t.parentNode!==o&&(t.parentNode.insertBefore(o,t),o.appendChild(t)),t._gsap.swappedIn=!0}},yZ=/([A-Z])/g,I0=function(t){if(t){var o=t.t.style,l=t.length,h=0,v,w;for((t.t._gsap||Qr.core.getCache(t.t)).uncache=1;h<l;h+=2)w=t[h+1],v=t[h],w?o[v]=w:o[v]&&o.removeProperty(v.replace(yZ,"-$1").toLowerCase())}},j2=function(t){for(var o=hA.length,l=t.style,h=[],v=0;v<o;v++)h.push(hA[v],l[hA[v]]);return h.t=t,h},vZ=function(t,o,l){for(var h=[],v=t.length,w=l?8:0,a;w<v;w+=2)a=t[w],h.push(a,a in o?o[a]:t[w+1]);return h.t=t.t,h},dA={left:0,top:0},O5=function(t,o,l,h,v,w,a,C,I,L,k,G,q,Q){Dl(t)&&(t=t(C)),Cu(t)&&t.substr(0,3)==="max"&&(t=G+(t.charAt(4)==="="?lA("0"+t.substr(3),l):0));var H=q?q.time():0,K,he,ue;if(q&&q.seek(0),isNaN(t)||(t=+t),X1(t))q&&(t=Qr.utils.mapRange(q.scrollTrigger.start,q.scrollTrigger.end,0,G,t)),a&&cA(a,l,h,!0);else{Dl(o)&&(o=o(C));var me=(t||"0").split(" "),ge,se,fe,ve;ue=jc(o,C)||la,ge=nm(ue)||{},(!ge||!ge.left&&!ge.top)&&Mh(ue).display==="none"&&(ve=ue.style.display,ue.style.display="block",ge=nm(ue),ve?ue.style.display=ve:ue.style.removeProperty("display")),se=lA(me[0],ge[h.d]),fe=lA(me[1]||"0",l),t=ge[h.p]-I[h.p]-L+se+v-fe,a&&cA(a,fe,h,l-fe<20||a._isStart&&fe>20),l-=l-fe}if(Q&&(C[Q]=t||-.001,t<0&&(t=0)),w){var Le=t+l,Ue=w._isStart;K="scroll"+h.d2,cA(w,Le,h,Ue&&Le>20||!Ue&&(k?Math.max(la[K],Ru[K]):w.parentNode[K])<=Le+1),k&&(I=nm(a),k&&(w.style[h.op.p]=I[h.op.p]-h.op.m-w._offset+Ts))}return q&&ue&&(K=nm(ue),q.seek(G),he=nm(ue),q._caScrollDist=K[h.p]-he[h.p],t=t/q._caScrollDist*G),q&&q.seek(H),q?t:Math.round(t)},xZ=/(webkit|moz|length|cssText|inset)/i,C5=function(t,o,l,h){if(t.parentNode!==o){var v=t.style,w,a;if(o===la){t._stOrig=v.cssText,a=Mh(t);for(w in a)!+w&&!xZ.test(w)&&a[w]&&typeof v[w]=="string"&&w!=="0"&&(v[w]=a[w]);v.top=l,v.left=h}else v.cssText=t._stOrig;Qr.core.getCache(t).uncache=1,o.appendChild(t)}},J8=function(t,o,l){var h=o,v=h;return function(w){var a=Math.round(t());return a!==h&&a!==v&&Math.abs(a-h)>3&&Math.abs(a-v)>3&&(w=a,l&&l()),v=h,h=Math.round(w),h}},U2=function(t,o,l){var h={};h[o.p]="+="+l,Qr.set(t,h)},I5=function(t,o){var l=Wg(t,o),h="_scroll"+o.p2,v=function w(a,C,I,L,k){var G=w.tween,q=C.onComplete,Q={};I=I||l();var H=J8(l,I,function(){G.kill(),w.tween=0});return k=L&&k||0,L=L||a-I,G&&G.kill(),C[h]=a,C.inherit=!1,C.modifiers=Q,Q[h]=function(){return H(I+L*G.ratio+k*G.ratio*G.ratio)},C.onUpdate=function(){gi.cache++,w.tween&&lm()},C.onComplete=function(){w.tween=0,q&&q.call(G)},G=w.tween=Qr.to(t,C),G};return t[h]=l,l.wheelHandler=function(){return v.tween&&v.tween.kill()&&(v.tween=0)},Gs(t,"wheel",l.wheelHandler),wi.isTouch&&Gs(t,"touchmove",l.wheelHandler),v},wi=(function(){function r(o,l){p0||r.register(Qr)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),AI(this),this.init(o,l)}var t=r.prototype;return t.init=function(l,h){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!q1){this.update=this.refresh=this.kill=kf;return}l=A5(Cu(l)||X1(l)||l.nodeType?{trigger:l}:l,F2);var v=l,w=v.onUpdate,a=v.toggleClass,C=v.id,I=v.onToggle,L=v.onRefresh,k=v.scrub,G=v.trigger,q=v.pin,Q=v.pinSpacing,H=v.invalidateOnRefresh,K=v.anticipatePin,he=v.onScrubComplete,ue=v.onSnapComplete,me=v.once,ge=v.snap,se=v.pinReparent,fe=v.pinSpacer,ve=v.containerAnimation,Le=v.fastScrollEnd,Ue=v.preventOverlaps,tt=l.horizontal||l.containerAnimation&&l.horizontal!==!1?dc:Ss,Ke=!k&&k!==0,nt=jc(l.scroller||mi),st=Qr.core.getCache(nt),Rt=qy(nt),Mt=("pinType"in l?l.pinType:$g(nt,"pinType")||Rt&&"fixed")==="fixed",$e=[l.onEnter,l.onLeave,l.onEnterBack,l.onLeaveBack],rt=Ke&&l.toggleActions.split(" "),Ct="markers"in l?l.markers:F2.markers,Kt=Rt?0:parseFloat(Mh(nt)["border"+tt.p2+V0])||0,Je=this,Ze=l.onRefreshInit&&function(){return l.onRefreshInit(Je)},gt=uZ(nt,Rt,tt),Bt=hZ(nt,Rt),ar=0,Er=0,jr=0,Zr=Wg(nt,tt),fn,Xt,Mr,kr,or,Tr,Ur,zn,Fn,Ut,_n,ua,da,Yn,ha,go,ni,ii,no,Ai,ga,Ha,Zi,cl,fi,Cs,Ci,Ti,qi,_o,$o,Mn,io,_a,La,pn,Bi,as,qo;if(Je._startClamp=Je._endClamp=!1,Je._dir=tt,K*=45,Je.scroller=nt,Je.scroll=ve?ve.time.bind(ve):Zr,kr=Zr(),Je.vars=l,h=h||l.animation,"refreshPriority"in l&&(k8=1,l.refreshPriority===-9999&&(ub=Je)),st.tweenScroll=st.tweenScroll||{top:I5(nt,Ss),left:I5(nt,dc)},Je.tweenTo=fn=st.tweenScroll[tt.p],Je.scrubDuration=function(Or){io=X1(Or)&&Or,io?Mn?Mn.duration(Or):Mn=Qr.to(h,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:io,paused:!0,onComplete:function(){return he&&he(Je)}}):(Mn&&Mn.progress(1).kill(),Mn=0)},h&&(h.vars.lazy=!1,h._initted&&!Je.isReverted||h.vars.immediateRender!==!1&&l.immediateRender!==!1&&h.duration()&&h.render(0,!0,!0),Je.animation=h.pause(),h.scrollTrigger=Je,Je.scrubDuration(k),_o=0,C||(C=h.vars.id)),ge&&((!Ay(ge)||ge.push)&&(ge={snapTo:ge}),"scrollBehavior"in la.style&&Qr.set(Rt?[la,Ru]:nt,{scrollBehavior:"auto"}),gi.forEach(function(Or){return Dl(Or)&&Or.target===(Rt?Pa.scrollingElement||Ru:nt)&&(Or.smooth=!1)}),Mr=Dl(ge.snapTo)?ge.snapTo:ge.snapTo==="labels"?fZ(h):ge.snapTo==="labelsDirectional"?pZ(h):ge.directional!==!1?function(Or,Sn){return TD(ge.snapTo)(Or,Cl()-Er<500?0:Sn.direction)}:Qr.utils.snap(ge.snapTo),_a=ge.duration||{min:.1,max:2},_a=Ay(_a)?ib(_a.min,_a.max):ib(_a,_a),La=Qr.delayedCall(ge.delay||io/2||.1,function(){var Or=Zr(),Sn=Cl()-Er<500,an=fn.tween;if((Sn||Math.abs(Je.getVelocity())<10)&&!an&&!PT&&ar!==Or){var yr=(Or-Tr)/Yn,Xe=h&&!Ke?h.totalProgress():yr,ie=Sn?0:(Xe-$o)/(Cl()-$1)*1e3||0,de=Qr.utils.clamp(-yr,1-yr,c0(ie/2)*ie/.185),Ae=yr+(ge.inertia===!1?0:de),ze,Ee,Fe=ge,it=Fe.onStart,qe=Fe.onInterrupt,at=Fe.onComplete;if(ze=Mr(Ae,Je),X1(ze)||(ze=Ae),Ee=Math.max(0,Math.round(Tr+ze*Yn)),Or<=Ur&&Or>=Tr&&Ee!==Or){if(an&&!an._initted&&an.data<=c0(Ee-Or))return;ge.inertia===!1&&(de=ze-yr),fn(Ee,{duration:_a(c0(Math.max(c0(Ae-Xe),c0(ze-Xe))*.185/ie/.05||0)),ease:ge.ease||"power3",data:c0(Ee-Or),onInterrupt:function(){return La.restart(!0)&&qe&&qe(Je)},onComplete:function(){Je.update(),ar=Zr(),h&&!Ke&&(Mn?Mn.resetTo("totalProgress",ze,h._tTime/h._tDur):h.progress(ze)),_o=$o=h&&!Ke?h.totalProgress():Je.progress,ue&&ue(Je),at&&at(Je)}},Or,de*Yn,Ee-Or-de*Yn),it&&it(Je,fn.tween)}}else Je.isActive&&ar!==Or&&La.restart(!0)}).pause()),C&&(SI[C]=Je),G=Je.trigger=jc(G||q!==!0&&q),qo=G&&G._gsap&&G._gsap.stRevert,qo&&(qo=qo(Je)),q=q===!0?G:jc(q),Cu(a)&&(a={targets:G,className:a}),q&&(Q===!1||Q===Eh||(Q=!Q&&q.parentNode&&q.parentNode.style&&Mh(q.parentNode).display==="flex"?!1:rs),Je.pin=q,Xt=Qr.core.getCache(q),Xt.spacer?ha=Xt.pinState:(fe&&(fe=jc(fe),fe&&!fe.nodeType&&(fe=fe.current||fe.nativeElement),Xt.spacerIsNative=!!fe,fe&&(Xt.spacerState=j2(fe))),Xt.spacer=ii=fe||Pa.createElement("div"),ii.classList.add("pin-spacer"),C&&ii.classList.add("pin-spacer-"+C),Xt.pinState=ha=j2(q)),l.force3D!==!1&&Qr.set(q,{force3D:!0}),Je.spacer=ii=Xt.spacer,qi=Mh(q),cl=qi[Q+tt.os2],Ai=Qr.getProperty(q),ga=Qr.quickSetter(q,tt.a,Ts),JE(q,ii,qi),ni=j2(q)),Ct){ua=Ay(Ct)?A5(Ct,T5):T5,Ut=N2("scroller-start",C,nt,tt,ua,0),_n=N2("scroller-end",C,nt,tt,ua,0,Ut),no=Ut["offset"+tt.op.d2];var Xa=jc($g(nt,"content")||nt);zn=this.markerStart=N2("start",C,Xa,tt,ua,no,0,ve),Fn=this.markerEnd=N2("end",C,Xa,tt,ua,no,0,ve),ve&&(as=Qr.quickSetter([zn,Fn],tt.a,Ts)),!Mt&&!(Gf.length&&$g(nt,"fixedMarkers")===!0)&&(dZ(Rt?la:nt),Qr.set([Ut,_n],{force3D:!0}),Cs=Qr.quickSetter(Ut,tt.a,Ts),Ti=Qr.quickSetter(_n,tt.a,Ts))}if(ve){var Tn=ve.vars.onUpdate,Jr=ve.vars.onUpdateParams;ve.eventCallback("onUpdate",function(){Je.update(0,0,1),Tn&&Tn.apply(ve,Jr||[])})}if(Je.previous=function(){return di[di.indexOf(Je)-1]},Je.next=function(){return di[di.indexOf(Je)+1]},Je.revert=function(Or,Sn){if(!Sn)return Je.kill(!0);var an=Or!==!1||!Je.enabled,yr=Ml;an!==Je.isReverted&&(an&&(pn=Math.max(Zr(),Je.scroll.rec||0),jr=Je.progress,Bi=h&&h.progress()),zn&&[zn,Fn,Ut,_n].forEach(function(Xe){return Xe.style.display=an?"none":"block"}),an&&(Ml=Je,Je.update(an)),q&&(!se||!Je.isActive)&&(an?_Z(q,ii,ha):JE(q,ii,Mh(q),fi)),an||Je.update(an),Ml=yr,Je.isReverted=an)},Je.refresh=function(Or,Sn,an,yr){if(!((Ml||!Je.enabled)&&!Sn)){if(q&&Or&&Dh){Gs(r,"scrollEnd",Z8);return}!uc&&Ze&&Ze(Je),Ml=Je,fn.tween&&!an&&(fn.tween.kill(),fn.tween=0),Mn&&Mn.pause(),H&&h&&(h.revert({kill:!1}).invalidate(),h.getChildren?h.getChildren(!0,!0,!1).forEach(function(Gn){return Gn.vars.immediateRender&&Gn.render(0,!0,!0)}):h.vars.immediateRender&&h.render(0,!0,!0)),Je.isReverted||Je.revert(!0,!0),Je._subPinOffset=!1;var Xe=gt(),ie=Bt(),de=ve?ve.duration():jf(nt,tt),Ae=Yn<=.01||!Yn,ze=0,Ee=yr||0,Fe=Ay(an)?an.end:l.end,it=l.endTrigger||G,qe=Ay(an)?an.start:l.start||(l.start===0||!G?0:q?"0 0":"0 100%"),at=Je.pinnedContainer=l.pinnedContainer&&jc(l.pinnedContainer,Je),Dt=G&&Math.max(0,di.indexOf(Je))||0,vt=Dt,Wt,dr,vr,Br,Sr,fr,br,Vn,yi,Xn,Zn,qn,on;for(Ct&&Ay(an)&&(qn=Qr.getProperty(Ut,tt.p),on=Qr.getProperty(_n,tt.p));vt-- >0;)fr=di[vt],fr.end||fr.refresh(0,1)||(Ml=Je),br=fr.pin,br&&(br===G||br===q||br===at)&&!fr.isReverted&&(Xn||(Xn=[]),Xn.unshift(fr),fr.revert(!0,!0)),fr!==di[vt]&&(Dt--,vt--);for(Dl(qe)&&(qe=qe(Je)),qe=v5(qe,"start",Je),Tr=O5(qe,G,Xe,tt,Zr(),zn,Ut,Je,ie,Kt,Mt,de,ve,Je._startClamp&&"_startClamp")||(q?-.001:0),Dl(Fe)&&(Fe=Fe(Je)),Cu(Fe)&&!Fe.indexOf("+=")&&(~Fe.indexOf(" ")?Fe=(Cu(qe)?qe.split(" ")[0]:"")+Fe:(ze=lA(Fe.substr(2),Xe),Fe=Cu(qe)?qe:(ve?Qr.utils.mapRange(0,ve.duration(),ve.scrollTrigger.start,ve.scrollTrigger.end,Tr):Tr)+ze,it=G)),Fe=v5(Fe,"end",Je),Ur=Math.max(Tr,O5(Fe||(it?"100% 0":de),it,Xe,tt,Zr()+ze,Fn,_n,Je,ie,Kt,Mt,de,ve,Je._endClamp&&"_endClamp"))||-.001,ze=0,vt=Dt;vt--;)fr=di[vt]||{},br=fr.pin,br&&fr.start-fr._pinPush<=Tr&&!ve&&fr.end>0&&(Wt=fr.end-(Je._startClamp?Math.max(0,fr.start):fr.start),(br===G&&fr.start-fr._pinPush<Tr||br===at)&&isNaN(qe)&&(ze+=Wt*(1-fr.progress)),br===q&&(Ee+=Wt));if(Tr+=ze,Ur+=ze,Je._startClamp&&(Je._startClamp+=ze),Je._endClamp&&!uc&&(Je._endClamp=Ur||-.001,Ur=Math.min(Ur,jf(nt,tt))),Yn=Ur-Tr||(Tr-=.01)&&.001,Ae&&(jr=Qr.utils.clamp(0,1,Qr.utils.normalize(Tr,Ur,pn))),Je._pinPush=Ee,zn&&ze&&(Wt={},Wt[tt.a]="+="+ze,at&&(Wt[tt.p]="-="+Zr()),Qr.set([zn,Fn],Wt)),q&&!(TI&&Je.end>=jf(nt,tt)))Wt=Mh(q),Br=tt===Ss,vr=Zr(),Ha=parseFloat(Ai(tt.a))+Ee,!de&&Ur>1&&(Zn=(Rt?Pa.scrollingElement||Ru:nt).style,Zn={style:Zn,value:Zn["overflow"+tt.a.toUpperCase()]},Rt&&Mh(la)["overflow"+tt.a.toUpperCase()]!=="scroll"&&(Zn.style["overflow"+tt.a.toUpperCase()]="scroll")),JE(q,ii,Wt),ni=j2(q),dr=nm(q,!0),Vn=Mt&&Wg(nt,Br?dc:Ss)(),Q?(fi=[Q+tt.os2,Yn+Ee+Ts],fi.t=ii,vt=Q===rs?EA(q,tt)+Yn+Ee:0,vt&&(fi.push(tt.d,vt+Ts),ii.style.flexBasis!=="auto"&&(ii.style.flexBasis=vt+Ts)),I0(fi),at&&di.forEach(function(Gn){Gn.pin===at&&Gn.vars.pinSpacing!==!1&&(Gn._subPinOffset=!0)}),Mt&&Zr(pn)):(vt=EA(q,tt),vt&&ii.style.flexBasis!=="auto"&&(ii.style.flexBasis=vt+Ts)),Mt&&(Sr={top:dr.top+(Br?vr-Tr:Vn)+Ts,left:dr.left+(Br?Vn:vr-Tr)+Ts,boxSizing:"border-box",position:"fixed"},Sr[Fy]=Sr["max"+V0]=Math.ceil(dr.width)+Ts,Sr[Ny]=Sr["max"+AD]=Math.ceil(dr.height)+Ts,Sr[Eh]=Sr[Eh+lb]=Sr[Eh+ob]=Sr[Eh+cb]=Sr[Eh+sb]="0",Sr[rs]=Wt[rs],Sr[rs+lb]=Wt[rs+lb],Sr[rs+ob]=Wt[rs+ob],Sr[rs+cb]=Wt[rs+cb],Sr[rs+sb]=Wt[rs+sb],go=vZ(ha,Sr,se),uc&&Zr(0)),h?(yi=h._initted,ZE(1),h.render(h.duration(),!0,!0),Zi=Ai(tt.a)-Ha+Yn+Ee,Ci=Math.abs(Yn-Zi)>1,Mt&&Ci&&go.splice(go.length-2,2),h.render(0,!0,!0),yi||h.invalidate(!0),h.parent||h.totalTime(h.totalTime()),ZE(0)):Zi=Yn,Zn&&(Zn.value?Zn.style["overflow"+tt.a.toUpperCase()]=Zn.value:Zn.style.removeProperty("overflow-"+tt.a));else if(G&&Zr()&&!ve)for(dr=G.parentNode;dr&&dr!==la;)dr._pinOffset&&(Tr-=dr._pinOffset,Ur-=dr._pinOffset),dr=dr.parentNode;Xn&&Xn.forEach(function(Gn){return Gn.revert(!1,!0)}),Je.start=Tr,Je.end=Ur,kr=or=uc?pn:Zr(),!ve&&!uc&&(kr<pn&&Zr(pn),Je.scroll.rec=0),Je.revert(!1,!0),Er=Cl(),La&&(ar=-1,La.restart(!0)),Ml=0,h&&Ke&&(h._initted||Bi)&&h.progress()!==Bi&&h.progress(Bi||0,!0).render(h.time(),!0,!0),(Ae||jr!==Je.progress||ve||H||h&&!h._initted)&&(h&&!Ke&&(h._initted||jr||h.vars.immediateRender!==!1)&&h.totalProgress(ve&&Tr<-.001&&!jr?Qr.utils.normalize(Tr,Ur,0):jr,!0),Je.progress=Ae||(kr-Tr)/Yn===jr?0:jr),q&&Q&&(ii._pinOffset=Math.round(Je.progress*Zi)),Mn&&Mn.invalidate(),isNaN(qn)||(qn-=Qr.getProperty(Ut,tt.p),on-=Qr.getProperty(_n,tt.p),U2(Ut,tt,qn),U2(zn,tt,qn-(yr||0)),U2(_n,tt,on),U2(Fn,tt,on-(yr||0))),Ae&&!uc&&Je.update(),L&&!uc&&!da&&(da=!0,L(Je),da=!1)}},Je.getVelocity=function(){return(Zr()-or)/(Cl()-$1)*1e3||0},Je.endAnimation=function(){D1(Je.callbackAnimation),h&&(Mn?Mn.progress(1):h.paused()?Ke||D1(h,Je.direction<0,1):D1(h,h.reversed()))},Je.labelToScroll=function(Or){return h&&h.labels&&(Tr||Je.refresh()||Tr)+h.labels[Or]/h.duration()*Yn||0},Je.getTrailing=function(Or){var Sn=di.indexOf(Je),an=Je.direction>0?di.slice(0,Sn).reverse():di.slice(Sn+1);return(Cu(Or)?an.filter(function(yr){return yr.vars.preventOverlaps===Or}):an).filter(function(yr){return Je.direction>0?yr.end<=Tr:yr.start>=Ur})},Je.update=function(Or,Sn,an){if(!(ve&&!an&&!Or)){var yr=uc===!0?pn:Je.scroll(),Xe=Or?0:(yr-Tr)/Yn,ie=Xe<0?0:Xe>1?1:Xe||0,de=Je.progress,Ae,ze,Ee,Fe,it,qe,at,Dt;if(Sn&&(or=kr,kr=ve?Zr():yr,ge&&($o=_o,_o=h&&!Ke?h.totalProgress():ie)),K&&q&&!Ml&&!z2&&Dh&&(!ie&&Tr<yr+(yr-or)/(Cl()-$1)*K?ie=1e-4:ie===1&&Ur>yr+(yr-or)/(Cl()-$1)*K&&(ie=.9999)),ie!==de&&Je.enabled){if(Ae=Je.isActive=!!ie&&ie<1,ze=!!de&&de<1,qe=Ae!==ze,it=qe||!!ie!=!!de,Je.direction=ie>de?1:-1,Je.progress=ie,it&&!Ml&&(Ee=ie&&!de?0:ie===1?1:de===1?2:3,Ke&&(Fe=!qe&&rt[Ee+1]!=="none"&&rt[Ee+1]||rt[Ee],Dt=h&&(Fe==="complete"||Fe==="reset"||Fe in h))),Ue&&(qe||Dt)&&(Dt||k||!h)&&(Dl(Ue)?Ue(Je):Je.getTrailing(Ue).forEach(function(vr){return vr.endAnimation()})),Ke||(Mn&&!Ml&&!z2?(Mn._dp._time-Mn._start!==Mn._time&&Mn.render(Mn._dp._time-Mn._start),Mn.resetTo?Mn.resetTo("totalProgress",ie,h._tTime/h._tDur):(Mn.vars.totalProgress=ie,Mn.invalidate().restart())):h&&h.totalProgress(ie,!!(Ml&&(Er||Or)))),q){if(Or&&Q&&(ii.style[Q+tt.os2]=cl),!Mt)ga(H1(Ha+Zi*ie));else if(it){if(at=!Or&&ie>de&&Ur+1>yr&&yr+1>=jf(nt,tt),se)if(!Or&&(Ae||at)){var vt=nm(q,!0),Wt=yr-Tr;C5(q,la,vt.top+(tt===Ss?Wt:0)+Ts,vt.left+(tt===Ss?0:Wt)+Ts)}else C5(q,ii);I0(Ae||at?go:ni),Ci&&ie<1&&Ae||ga(Ha+(ie===1&&!at?Zi:0))}}ge&&!fn.tween&&!Ml&&!z2&&La.restart(!0),a&&(qe||me&&ie&&(ie<1||!WE))&&Sb(a.targets).forEach(function(vr){return vr.classList[Ae||me?"add":"remove"](a.className)}),w&&!Ke&&!Or&&w(Je),it&&!Ml?(Ke&&(Dt&&(Fe==="complete"?h.pause().totalProgress(1):Fe==="reset"?h.restart(!0).pause():Fe==="restart"?h.restart(!0):h[Fe]()),w&&w(Je)),(qe||!WE)&&(I&&qe&&KE(Je,I),$e[Ee]&&KE(Je,$e[Ee]),me&&(ie===1?Je.kill(!1,1):$e[Ee]=0),qe||(Ee=ie===1?1:3,$e[Ee]&&KE(Je,$e[Ee]))),Le&&!Ae&&Math.abs(Je.getVelocity())>(X1(Le)?Le:2500)&&(D1(Je.callbackAnimation),Mn?Mn.progress(1):D1(h,Fe==="reverse"?1:!ie,1))):Ke&&w&&!Ml&&w(Je)}if(Ti){var dr=ve?yr/ve.duration()*(ve._caScrollDist||0):yr;Cs(dr+(Ut._isFlipped?1:0)),Ti(dr)}as&&as(-yr/ve.duration()*(ve._caScrollDist||0))}},Je.enable=function(Or,Sn){Je.enabled||(Je.enabled=!0,Gs(nt,"resize",Z1),Rt||Gs(nt,"scroll",u0),Ze&&Gs(r,"refreshInit",Ze),Or!==!1&&(Je.progress=jr=0,kr=or=ar=Zr()),Sn!==!1&&Je.refresh())},Je.getTween=function(Or){return Or&&fn?fn.tween:Mn},Je.setPositions=function(Or,Sn,an,yr){if(ve){var Xe=ve.scrollTrigger,ie=ve.duration(),de=Xe.end-Xe.start;Or=Xe.start+de*Or/ie,Sn=Xe.start+de*Sn/ie}Je.refresh(!1,!1,{start:x5(Or,an&&!!Je._startClamp),end:x5(Sn,an&&!!Je._endClamp)},yr),Je.update()},Je.adjustPinSpacing=function(Or){if(fi&&Or){var Sn=fi.indexOf(tt.d)+1;fi[Sn]=parseFloat(fi[Sn])+Or+Ts,fi[1]=parseFloat(fi[1])+Or+Ts,I0(fi)}},Je.disable=function(Or,Sn){if(Or!==!1&&Je.revert(!0,!0),Je.enabled&&(Je.enabled=Je.isActive=!1,Sn||Mn&&Mn.pause(),pn=0,Xt&&(Xt.uncache=1),Ze&&Vs(r,"refreshInit",Ze),La&&(La.pause(),fn.tween&&fn.tween.kill()&&(fn.tween=0)),!Rt)){for(var an=di.length;an--;)if(di[an].scroller===nt&&di[an]!==Je)return;Vs(nt,"resize",Z1),Rt||Vs(nt,"scroll",u0)}},Je.kill=function(Or,Sn){Je.disable(Or,Sn),Mn&&!Sn&&Mn.kill(),C&&delete SI[C];var an=di.indexOf(Je);an>=0&&di.splice(an,1),an===cc&&uA>0&&cc--,an=0,di.forEach(function(yr){return yr.scroller===Je.scroller&&(an=1)}),an||uc||(Je.scroll.rec=0),h&&(h.scrollTrigger=null,Or&&h.revert({kill:!1}),Sn||h.kill()),zn&&[zn,Fn,Ut,_n].forEach(function(yr){return yr.parentNode&&yr.parentNode.removeChild(yr)}),ub===Je&&(ub=0),q&&(Xt&&(Xt.uncache=1),an=0,di.forEach(function(yr){return yr.pin===q&&an++}),an||(Xt.spacer=0)),l.onKill&&l.onKill(Je)},di.push(Je),Je.enable(!1,!1),qo&&qo(Je),h&&h.add&&!Yn){var yt=Je.update;Je.update=function(){Je.update=yt,gi.cache++,Tr||Ur||Je.refresh()},Qr.delayedCall(.01,Je.update),Yn=.01,Tr=Ur=0}else Je.refresh();q&&gZ()},r.register=function(l){return p0||(Qr=l||V8(),U8()&&window.document&&r.enable(),p0=q1),p0},r.defaults=function(l){if(l)for(var h in l)F2[h]=l[h];return F2},r.disable=function(l,h){q1=0,di.forEach(function(w){return w[h?"kill":"disable"](l)}),Vs(mi,"wheel",u0),Vs(Pa,"scroll",u0),clearInterval(R2),Vs(Pa,"touchcancel",kf),Vs(la,"touchstart",kf),B2(Vs,Pa,"pointerdown,touchstart,mousedown",b5),B2(Vs,Pa,"pointerup,touchend,mouseup",w5),SA.kill(),L2(Vs);for(var v=0;v<gi.length;v+=3)k2(Vs,gi[v],gi[v+1]),k2(Vs,gi[v],gi[v+2])},r.enable=function(){if(mi=window,Pa=document,Ru=Pa.documentElement,la=Pa.body,Qr&&(Sb=Qr.utils.toArray,ib=Qr.utils.clamp,AI=Qr.core.context||kf,ZE=Qr.core.suppressOverwrites||kf,vD=mi.history.scrollRestoration||"auto",EI=mi.pageYOffset||0,Qr.core.globals("ScrollTrigger",r),la)){q1=1,C0=document.createElement("div"),C0.style.height="100vh",C0.style.position="absolute",Q8(),cZ(),Go.register(Qr),r.isTouch=Go.isTouch,Ig=Go.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),wI=Go.isTouch===1,Gs(mi,"wheel",u0),yD=[mi,Pa,Ru,la],Qr.matchMedia?(r.matchMedia=function(I){var L=Qr.matchMedia(),k;for(k in I)L.add(k,I[k]);return L},Qr.addEventListener("matchMediaInit",function(){Y8(),SD()}),Qr.addEventListener("matchMediaRevert",function(){return W8()}),Qr.addEventListener("matchMedia",function(){Oy(0,1),Xy("matchMedia")}),Qr.matchMedia().add("(orientation: portrait)",function(){return QE(),QE})):console.warn("Requires GSAP 3.11.0 or later"),QE(),Gs(Pa,"scroll",u0);var l=la.hasAttribute("style"),h=la.style,v=h.borderTopStyle,w=Qr.core.Animation.prototype,a,C;for(w.revert||Object.defineProperty(w,"revert",{value:function(){return this.time(-.01,!0)}}),h.borderTopStyle="solid",a=nm(la),Ss.m=Math.round(a.top+Ss.sc())||0,dc.m=Math.round(a.left+dc.sc())||0,v?h.borderTopStyle=v:h.removeProperty("border-top-style"),l||(la.setAttribute("style",""),la.removeAttribute("style")),R2=setInterval(S5,250),Qr.delayedCall(.5,function(){return z2=0}),Gs(Pa,"touchcancel",kf),Gs(la,"touchstart",kf),B2(Gs,Pa,"pointerdown,touchstart,mousedown",b5),B2(Gs,Pa,"pointerup,touchend,mouseup",w5),bI=Qr.utils.checkPrefix("transform"),hA.push(bI),p0=Cl(),SA=Qr.delayedCall(.2,Oy).pause(),m0=[Pa,"visibilitychange",function(){var I=mi.innerWidth,L=mi.innerHeight;Pa.hidden?(_5=I,y5=L):(_5!==I||y5!==L)&&Z1()},Pa,"DOMContentLoaded",Oy,mi,"load",Oy,mi,"resize",Z1],L2(Gs),di.forEach(function(I){return I.enable(0,1)}),C=0;C<gi.length;C+=3)k2(Vs,gi[C],gi[C+1]),k2(Vs,gi[C],gi[C+2])}},r.config=function(l){"limitCallbacks"in l&&(WE=!!l.limitCallbacks);var h=l.syncInterval;h&&clearInterval(R2)||(R2=h)&&setInterval(S5,h),"ignoreMobileResize"in l&&(wI=r.isTouch===1&&l.ignoreMobileResize),"autoRefreshEvents"in l&&(L2(Vs)||L2(Gs,l.autoRefreshEvents||"none"),F8=(l.autoRefreshEvents+"").indexOf("resize")===-1)},r.scrollerProxy=function(l,h){var v=jc(l),w=gi.indexOf(v),a=qy(v);~w&&gi.splice(w,a?6:2),h&&(a?Gf.unshift(mi,h,la,h,Ru,h):Gf.unshift(v,h))},r.clearMatchMedia=function(l){di.forEach(function(h){return h._ctx&&h._ctx.query===l&&h._ctx.kill(!0,!0)})},r.isInViewport=function(l,h,v){var w=(Cu(l)?jc(l):l).getBoundingClientRect(),a=w[v?Fy:Ny]*h||0;return v?w.right-a>0&&w.left+a<mi.innerWidth:w.bottom-a>0&&w.top+a<mi.innerHeight},r.positionInViewport=function(l,h,v){Cu(l)&&(l=jc(l));var w=l.getBoundingClientRect(),a=w[v?Fy:Ny],C=h==null?a/2:h in MA?MA[h]*a:~h.indexOf("%")?parseFloat(h)*a/100:parseFloat(h)||0;return v?(w.left+C)/mi.innerWidth:(w.top+C)/mi.innerHeight},r.killAll=function(l){if(di.slice(0).forEach(function(v){return v.vars.id!=="ScrollSmoother"&&v.kill()}),l!==!0){var h=Hy.killAll||[];Hy={},h.forEach(function(v){return v()})}},r})();wi.version="3.14.2";wi.saveStyles=function(r){return r?Sb(r).forEach(function(t){if(t&&t.style){var o=Ou.indexOf(t);o>=0&&Ou.splice(o,5),Ou.push(t,t.style.cssText,t.getBBox&&t.getAttribute("transform"),Qr.core.getCache(t),AI())}}):Ou};wi.revert=function(r,t){return SD(!r,t)};wi.create=function(r,t){return new wi(r,t)};wi.refresh=function(r){return r?Z1(!0):(p0||wi.register())&&Oy(!0)};wi.update=function(r){return++gi.cache&&lm(r===!0?2:0)};wi.clearScrollMemory=K8;wi.maxScroll=function(r,t){return jf(r,t?dc:Ss)};wi.getScrollFunc=function(r,t){return Wg(jc(r),t?dc:Ss)};wi.getById=function(r){return SI[r]};wi.getAll=function(){return di.filter(function(r){return r.vars.id!=="ScrollSmoother"})};wi.isScrolling=function(){return!!Dh};wi.snapDirectional=TD;wi.addEventListener=function(r,t){var o=Hy[r]||(Hy[r]=[]);~o.indexOf(t)||o.push(t)};wi.removeEventListener=function(r,t){var o=Hy[r],l=o&&o.indexOf(t);l>=0&&o.splice(l,1)};wi.batch=function(r,t){var o=[],l={},h=t.interval||.016,v=t.batchMax||1e9,w=function(I,L){var k=[],G=[],q=Qr.delayedCall(h,function(){L(k,G),k=[],G=[]}).pause();return function(Q){k.length||q.restart(!0),k.push(Q.trigger),G.push(Q),v<=k.length&&q.progress(1)}},a;for(a in t)l[a]=a.substr(0,2)==="on"&&Dl(t[a])&&a!=="onRefreshInit"?w(a,t[a]):t[a];return Dl(v)&&(v=v(),Gs(wi,"refresh",function(){return v=t.batchMax()})),Sb(r).forEach(function(C){var I={};for(a in l)I[a]=l[a];I.trigger=C,o.push(wi.create(I))}),o};var P5=function(t,o,l,h){return o>h?t(h):o<0&&t(0),l>h?(h-o)/(l-o):l<0?o/(o-l):1},eM=function r(t,o){o===!0?t.style.removeProperty("touch-action"):t.style.touchAction=o===!0?"auto":o?"pan-"+o+(Go.isTouch?" pinch-zoom":""):"none",t===Ru&&r(la,o)},V2={auto:1,scroll:1},bZ=function(t){var o=t.event,l=t.target,h=t.axis,v=(o.changedTouches?o.changedTouches[0]:o).target,w=v._gsap||Qr.core.getCache(v),a=Cl(),C;if(!w._isScrollT||a-w._isScrollT>2e3){for(;v&&v!==la&&(v.scrollHeight<=v.clientHeight&&v.scrollWidth<=v.clientWidth||!(V2[(C=Mh(v)).overflowY]||V2[C.overflowX]));)v=v.parentNode;w._isScroll=v&&v!==l&&!qy(v)&&(V2[(C=Mh(v)).overflowY]||V2[C.overflowX]),w._isScrollT=a}(w._isScroll||h==="x")&&(o.stopPropagation(),o._gsapAllow=!0)},eV=function(t,o,l,h){return Go.create({target:t,capture:!0,debounce:!1,lockAxis:!0,type:o,onWheel:h=h&&bZ,onPress:h,onDrag:h,onScroll:h,onEnable:function(){return l&&Gs(Pa,Go.eventTypes[0],R5,!1,!0)},onDisable:function(){return Vs(Pa,Go.eventTypes[0],R5,!0)}})},wZ=/(input|label|select|textarea)/i,D5,R5=function(t){var o=wZ.test(t.target.tagName);(o||D5)&&(t._gsapAllow=!0,D5=o)},AZ=function(t){Ay(t)||(t={}),t.preventDefault=t.isNormalizer=t.allowClicks=!0,t.type||(t.type="wheel,touch"),t.debounce=!!t.debounce,t.id=t.id||"normalizer";var o=t,l=o.normalizeScrollX,h=o.momentum,v=o.allowNestedScroll,w=o.onRelease,a,C,I=jc(t.target)||Ru,L=Qr.core.globals().ScrollSmoother,k=L&&L.get(),G=Ig&&(t.content&&jc(t.content)||k&&t.content!==!1&&!k.smooth()&&k.content()),q=Wg(I,Ss),Q=Wg(I,dc),H=1,K=(Go.isTouch&&mi.visualViewport?mi.visualViewport.scale*mi.visualViewport.width:mi.outerWidth)/mi.innerWidth,he=0,ue=Dl(h)?function(){return h(a)}:function(){return h||2.8},me,ge,se=eV(I,t.type,!0,v),fe=function(){return ge=!1},ve=kf,Le=kf,Ue=function(){C=jf(I,Ss),Le=ib(Ig?1:0,C),l&&(ve=ib(0,jf(I,dc))),me=jy},tt=function(){G._gsap.y=H1(parseFloat(G._gsap.y)+q.offset)+"px",G.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(G._gsap.y)+", 0, 1)",q.offset=q.cacheID=0},Ke=function(){if(ge){requestAnimationFrame(fe);var Ct=H1(a.deltaY/2),Kt=Le(q.v-Ct);if(G&&Kt!==q.v+q.offset){q.offset=Kt-q.v;var Je=H1((parseFloat(G&&G._gsap.y)||0)-q.offset);G.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+Je+", 0, 1)",G._gsap.y=Je+"px",q.cacheID=gi.cache,lm()}return!0}q.offset&&tt(),ge=!0},nt,st,Rt,Mt,$e=function(){Ue(),nt.isActive()&&nt.vars.scrollY>C&&(q()>C?nt.progress(1)&&q(C):nt.resetTo("scrollY",C))};return G&&Qr.set(G,{y:"+=0"}),t.ignoreCheck=function(rt){return Ig&&rt.type==="touchmove"&&Ke()||H>1.05&&rt.type!=="touchstart"||a.isGesturing||rt.touches&&rt.touches.length>1},t.onPress=function(){ge=!1;var rt=H;H=H1((mi.visualViewport&&mi.visualViewport.scale||1)/K),nt.pause(),rt!==H&&eM(I,H>1.01?!0:l?!1:"x"),st=Q(),Rt=q(),Ue(),me=jy},t.onRelease=t.onGestureStart=function(rt,Ct){if(q.offset&&tt(),!Ct)Mt.restart(!0);else{gi.cache++;var Kt=ue(),Je,Ze;l&&(Je=Q(),Ze=Je+Kt*.05*-rt.velocityX/.227,Kt*=P5(Q,Je,Ze,jf(I,dc)),nt.vars.scrollX=ve(Ze)),Je=q(),Ze=Je+Kt*.05*-rt.velocityY/.227,Kt*=P5(q,Je,Ze,jf(I,Ss)),nt.vars.scrollY=Le(Ze),nt.invalidate().duration(Kt).play(.01),(Ig&&nt.vars.scrollY>=C||Je>=C-1)&&Qr.to({},{onUpdate:$e,duration:Kt})}w&&w(rt)},t.onWheel=function(){nt._ts&&nt.pause(),Cl()-he>1e3&&(me=0,he=Cl())},t.onChange=function(rt,Ct,Kt,Je,Ze){if(jy!==me&&Ue(),Ct&&l&&Q(ve(Je[2]===Ct?st+(rt.startX-rt.x):Q()+Ct-Je[1])),Kt){q.offset&&tt();var gt=Ze[2]===Kt,Bt=gt?Rt+rt.startY-rt.y:q()+Kt-Ze[1],ar=Le(Bt);gt&&Bt!==ar&&(Rt+=ar-Bt),q(ar)}(Kt||Ct)&&lm()},t.onEnable=function(){eM(I,l?!1:"x"),wi.addEventListener("refresh",$e),Gs(mi,"resize",$e),q.smooth&&(q.target.style.scrollBehavior="auto",q.smooth=Q.smooth=!1),se.enable()},t.onDisable=function(){eM(I,!0),Vs(mi,"resize",$e),wi.removeEventListener("refresh",$e),se.kill()},t.lockAxis=t.lockAxis!==!1,a=new Go(t),a.iOS=Ig,Ig&&!q()&&q(1),Ig&&Qr.ticker.add(kf),Mt=a._dc,nt=Qr.to(a,{ease:"power4",paused:!0,inherit:!1,scrollX:l?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:J8(q,q(),function(){return nt.pause()})},onUpdate:lm,onComplete:Mt.vars.onComplete}),a};wi.sort=function(r){if(Dl(r))return di.sort(r);var t=mi.pageYOffset||0;return wi.getAll().forEach(function(o){return o._sortY=o.trigger?t+o.trigger.getBoundingClientRect().top:o.start+mi.innerHeight}),di.sort(r||function(o,l){return(o.vars.refreshPriority||0)*-1e6+(o.vars.containerAnimation?1e6:o._sortY)-((l.vars.containerAnimation?1e6:l._sortY)+(l.vars.refreshPriority||0)*-1e6)})};wi.observe=function(r){return new Go(r)};wi.normalizeScroll=function(r){if(typeof r>"u")return lc;if(r===!0&&lc)return lc.enable();if(r===!1){lc&&lc.kill(),lc=r;return}var t=r instanceof Go?r:AZ(r);return lc&&lc.target===t.target&&lc.kill(),qy(t.target)&&(lc=t),t};wi.core={_getVelocityProp:xI,_inputObserver:eV,_scrollers:gi,_proxies:Gf,bridge:{ss:function(){Dh||Xy("scrollStart"),Dh=Cl()},ref:function(){return Ml}}};V8()&&Qr.registerPlugin(wi);const TZ=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),SZ=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,o,l)=>l?l.toUpperCase():o.toLowerCase()),z5=r=>{const t=SZ(r);return t.charAt(0).toUpperCase()+t.slice(1)},tV=(...r)=>r.filter((t,o,l)=>!!t&&t.trim()!==""&&l.indexOf(t)===o).join(" ").trim(),EZ=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var MZ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const OZ=Jt.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:h="",children:v,iconNode:w,...a},C)=>Jt.createElement("svg",{ref:C,...MZ,width:t,height:t,stroke:r,strokeWidth:l?Number(o)*24/Number(t):o,className:tV("lucide",h),...!v&&!EZ(a)&&{"aria-hidden":"true"},...a},[...w.map(([I,L])=>Jt.createElement(I,L)),...Array.isArray(v)?v:[v]]));const _i=(r,t)=>{const o=Jt.forwardRef(({className:l,...h},v)=>Jt.createElement(OZ,{ref:v,iconNode:t,className:tV(`lucide-${TZ(z5(r))}`,`lucide-${r}`,l),...h}));return o.displayName=z5(r),o};const CZ=[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]],IZ=_i("accessibility",CZ);const PZ=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],DZ=_i("activity",PZ);const RZ=[["path",{d:"M19 9V6a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v3",key:"irtipd"}],["path",{d:"M3 16a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5a2 2 0 0 0-4 0v1.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V11a2 2 0 0 0-4 0z",key:"1qyhux"}],["path",{d:"M5 18v2",key:"ppbyun"}],["path",{d:"M19 18v2",key:"gy7782"}]],OA=_i("armchair",RZ);const zZ=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],LZ=_i("arrow-right",zZ);const BZ=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],G2=_i("arrow-up-right",BZ);const kZ=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],FZ=_i("building-2",kZ);const NZ=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],CA=_i("chart-column",NZ);const jZ=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],rV=_i("chevron-right",jZ);const UZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],nV=_i("circle-alert",UZ);const VZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ED=_i("circle-check",VZ);const GZ=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$Z=_i("circle-x",GZ);const qZ=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],DT=_i("clock",qZ);const HZ=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],OI=_i("coffee",HZ);const XZ=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],ZZ=_i("ellipsis",XZ);const WZ=[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]],tM=_i("footprints",WZ);const YZ=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],KZ=_i("layers",YZ);const QZ=[["path",{d:"M6 20a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2",key:"1m57jg"}],["path",{d:"M8 18V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v14",key:"1l99gc"}],["path",{d:"M10 20h4",key:"ni2waw"}],["circle",{cx:"16",cy:"20",r:"2",key:"1vifvg"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]],JZ=_i("luggage",QZ);const eW=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],hb=_i("map-pin",eW);const tW=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],rW=_i("map",tW);const nW=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],iW=_i("menu",nW);const aW=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],oW=_i("monitor",aW);const sW=[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]],MD=_i("navigation",sW);const lW=[["path",{d:"M2 22h20",key:"272qi7"}],["path",{d:"M3.77 10.77 2 9l2-4.5 1.1.55c.55.28.9.84.9 1.45s.35 1.17.9 1.45L8 8.5l3-6 1.05.53a2 2 0 0 1 1.09 1.52l.72 5.4a2 2 0 0 0 1.09 1.52l4.4 2.2c.42.22.78.55 1.01.96l.6 1.03c.49.88-.06 1.98-1.06 2.1l-1.18.15c-.47.06-.95-.02-1.37-.24L4.29 11.15a2 2 0 0 1-.52-.38Z",key:"1ma21e"}]],cW=_i("plane-landing",lW);const uW=[["path",{d:"M2 22h20",key:"272qi7"}],["path",{d:"M6.36 17.4 4 17l-2-4 1.1-.55a2 2 0 0 1 1.8 0l.17.1a2 2 0 0 0 1.8 0L8 12 5 6l.9-.45a2 2 0 0 1 2.09.2l4.02 3a2 2 0 0 0 2.1.2l4.19-2.06a2.41 2.41 0 0 1 1.73-.17L21 7a1.4 1.4 0 0 1 .87 1.99l-.38.76c-.23.46-.6.84-1.07 1.08L7.58 17.2a2 2 0 0 1-1.22.18Z",key:"fkigj9"}]],hW=_i("plane-takeoff",uW);const dW=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],fA=_i("plane",dW);const fW=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],OD=_i("search",fW);const pW=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],mW=_i("shield",pW);const gW=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],CI=_i("shopping-bag",gW);const _W=[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]],yW=_i("store",_W);const vW=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],xW=_i("trending-up",vW);const bW=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],L5=_i("triangle-alert",bW);const wW=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],II=_i("users",wW);const AW=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],TW=_i("utensils",AW);const SW=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],PI=_i("wifi",SW);const EW=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],MW=_i("x",EW);const OW=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],CD=_i("zap",OW);const CW=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],IW=_i("zoom-in",CW);const PW=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],DW=_i("zoom-out",PW),RW={id:"atl",code:"ATL",name:"Hartsfield-Jackson Atlanta International Airport",city:"Atlanta",country:"USA",coordinates:[-84.4281,33.6407],terminals:[{id:"domestic",name:"Domestic Terminal",gates:[{id:"T1",number:"T1",coordinates:[-84.4285,33.6405],status:"available"},{id:"T2",number:"T2",coordinates:[-84.4283,33.6406],status:"occupied"},{id:"T3",number:"T3",coordinates:[-84.4281,33.6407],status:"boarding"},{id:"T4",number:"T4",coordinates:[-84.4279,33.6408],status:"available"},{id:"T5",number:"T5",coordinates:[-84.4277,33.6409],status:"occupied"},{id:"T6",number:"T6",coordinates:[-84.4275,33.641],status:"available"},{id:"T7",number:"T7",coordinates:[-84.4273,33.6411],status:"closed"},{id:"T8",number:"T8",coordinates:[-84.4271,33.6412],status:"available"}],floors:[{id:"domestic-l1",level:1,name:"Baggage Claim",features:[{id:"bag1",type:"baggage",name:"Baggage Claim North",coordinates:[-84.4285,33.6405],hours:"24 hours"},{id:"bag2",type:"baggage",name:"Baggage Claim South",coordinates:[-84.4275,33.641],hours:"24 hours"},{id:"atm1",type:"atm",name:"Truist ATM",coordinates:[-84.4283,33.6406],hours:"24 hours"},{id:"rest1",type:"restroom",name:"Restrooms",coordinates:[-84.4281,33.6407],hours:"24 hours"}]},{id:"domestic-l2",level:2,name:"Check-in & Security",features:[{id:"sec1",type:"security",name:"North Security Checkpoint",coordinates:[-84.4285,33.6405],hours:"24 hours",description:"Main TSA checkpoint"},{id:"sec2",type:"security",name:"South Security Checkpoint",coordinates:[-84.4275,33.641],hours:"24 hours",description:"Main TSA checkpoint"},{id:"sec3",type:"security",name:"Lower North Security",coordinates:[-84.4283,33.6406],hours:"4:00 AM - 10:00 PM"},{id:"check1",type:"checkpoint",name:"Check-in Counters North",coordinates:[-84.4281,33.6407],hours:"24 hours"},{id:"check2",type:"checkpoint",name:"Check-in Counters South",coordinates:[-84.4279,33.6408],hours:"24 hours"}]}]},{id:"concourse-a",name:"Concourse A",gates:[{id:"A1",number:"A1",coordinates:[-84.426,33.6415],status:"boarding"},{id:"A2",number:"A2",coordinates:[-84.4258,33.6416],status:"occupied"},{id:"A3",number:"A3",coordinates:[-84.4256,33.6417],status:"available"},{id:"A4",number:"A4",coordinates:[-84.4254,33.6418],status:"occupied"},{id:"A5",number:"A5",coordinates:[-84.4252,33.6419],status:"available"},{id:"A6",number:"A6",coordinates:[-84.425,33.642],status:"boarding"},{id:"A7",number:"A7",coordinates:[-84.4248,33.6421],status:"occupied"},{id:"A8",number:"A8",coordinates:[-84.4246,33.6422],status:"available"},{id:"A9",number:"A9",coordinates:[-84.4244,33.6423],status:"closed"},{id:"A10",number:"A10",coordinates:[-84.4242,33.6424],status:"available"},{id:"A11",number:"A11",coordinates:[-84.424,33.6425],status:"occupied"},{id:"A12",number:"A12",coordinates:[-84.4238,33.6426],status:"available"}],floors:[{id:"a-l1",level:1,name:"Main Level",features:[{id:"a-food1",type:"food",name:"Chick-fil-A",coordinates:[-84.426,33.6415],hours:"5:00 AM - 10:00 PM"},{id:"a-retail1",type:"retail",name:"Atlanta Braves All-Star Grill",coordinates:[-84.4258,33.6416],hours:"6:00 AM - 11:00 PM"},{id:"a-lounge1",type:"lounge",name:"Delta Sky Club",coordinates:[-84.4256,33.6417],hours:"4:30 AM - 11:30 PM",description:"Premium lounge access"},{id:"a-rest1",type:"restroom",name:"Restrooms",coordinates:[-84.4254,33.6418],hours:"24 hours"},{id:"a-charge1",type:"charging",name:"Charging Station",coordinates:[-84.4252,33.6419],hours:"24 hours"}]}]},{id:"concourse-b",name:"Concourse B",gates:[{id:"B1",number:"B1",coordinates:[-84.422,33.643],status:"available"},{id:"B2",number:"B2",coordinates:[-84.4218,33.6431],status:"occupied"},{id:"B3",number:"B3",coordinates:[-84.4216,33.6432],status:"boarding"},{id:"B4",number:"B4",coordinates:[-84.4214,33.6433],status:"available"},{id:"B5",number:"B5",coordinates:[-84.4212,33.6434],status:"occupied"},{id:"B6",number:"B6",coordinates:[-84.421,33.6435],status:"available"},{id:"B7",number:"B7",coordinates:[-84.4208,33.6436],status:"closed"},{id:"B8",number:"B8",coordinates:[-84.4206,33.6437],status:"occupied"},{id:"B9",number:"B9",coordinates:[-84.4204,33.6438],status:"available"},{id:"B10",number:"B10",coordinates:[-84.4202,33.6439],status:"boarding"}],floors:[{id:"b-l1",level:1,name:"Main Level",features:[{id:"b-food1",type:"food",name:"Popeyes",coordinates:[-84.422,33.643],hours:"5:00 AM - 11:00 PM"},{id:"b-food2",type:"food",name:"Five Guys",coordinates:[-84.4218,33.6431],hours:"6:00 AM - 10:00 PM"},{id:"b-retail1",type:"retail",name:"Best Buy Express",coordinates:[-84.4216,33.6432],hours:"6:00 AM - 10:00 PM"},{id:"b-lounge1",type:"lounge",name:"Delta Sky Club",coordinates:[-84.4214,33.6433],hours:"4:30 AM - 11:30 PM"},{id:"b-spa1",type:"medical",name:"Be Relax Spa",coordinates:[-84.4212,33.6434],hours:"7:00 AM - 10:00 PM",description:"Massage and relaxation services"}]}]},{id:"concourse-c",name:"Concourse C",gates:[{id:"C1",number:"C1",coordinates:[-84.418,33.6445],status:"occupied"},{id:"C2",number:"C2",coordinates:[-84.4178,33.6446],status:"available"},{id:"C3",number:"C3",coordinates:[-84.4176,33.6447],status:"boarding"},{id:"C4",number:"C4",coordinates:[-84.4174,33.6448],status:"occupied"},{id:"C5",number:"C5",coordinates:[-84.4172,33.6449],status:"available"},{id:"C6",number:"C6",coordinates:[-84.417,33.645],status:"closed"},{id:"C7",number:"C7",coordinates:[-84.4168,33.6451],status:"occupied"},{id:"C8",number:"C8",coordinates:[-84.4166,33.6452],status:"available"}],floors:[{id:"c-l1",level:1,name:"Main Level",features:[{id:"c-food1",type:"food",name:"Corner Bakery Cafe",coordinates:[-84.418,33.6445],hours:"5:00 AM - 10:00 PM"},{id:"c-retail1",type:"retail",name:"Buckhead Books",coordinates:[-84.4178,33.6446],hours:"6:00 AM - 10:00 PM"},{id:"c-lounge1",type:"lounge",name:"Delta Sky Club",coordinates:[-84.4176,33.6447],hours:"4:30 AM - 11:30 PM"}]}]},{id:"concourse-d",name:"Concourse D",gates:[{id:"D1",number:"D1",coordinates:[-84.414,33.646],status:"available"},{id:"D2",number:"D2",coordinates:[-84.4138,33.6461],status:"occupied"},{id:"D3",number:"D3",coordinates:[-84.4136,33.6462],status:"boarding"},{id:"D4",number:"D4",coordinates:[-84.4134,33.6463],status:"available"},{id:"D5",number:"D5",coordinates:[-84.4132,33.6464],status:"occupied"},{id:"D6",number:"D6",coordinates:[-84.413,33.6465],status:"available"},{id:"D7",number:"D7",coordinates:[-84.4128,33.6466],status:"closed"},{id:"D8",number:"D8",coordinates:[-84.4126,33.6467],status:"occupied"}],floors:[{id:"d-l1",level:1,name:"Main Level",features:[{id:"d-food1",type:"food",name:"Buffalo Wild Wings",coordinates:[-84.414,33.646],hours:"10:00 AM - 12:00 AM"},{id:"d-retail1",type:"retail",name:"Luxe International",coordinates:[-84.4138,33.6461],hours:"6:00 AM - 10:00 PM"},{id:"d-shoe1",type:"service",name:"Shoeshine Service",coordinates:[-84.4136,33.6462],hours:"7:00 AM - 9:00 PM"}]}]},{id:"concourse-e",name:"Concourse E",gates:[{id:"E1",number:"E1",coordinates:[-84.41,33.6475],status:"boarding"},{id:"E2",number:"E2",coordinates:[-84.4098,33.6476],status:"occupied"},{id:"E3",number:"E3",coordinates:[-84.4096,33.6477],status:"available"},{id:"E4",number:"E4",coordinates:[-84.4094,33.6478],status:"occupied"},{id:"E5",number:"E5",coordinates:[-84.4092,33.6479],status:"available"},{id:"E6",number:"E6",coordinates:[-84.409,33.648],status:"closed"}],floors:[{id:"e-l1",level:1,name:"Main Level",features:[{id:"e-food1",type:"food",name:"Das Waffle Haus",coordinates:[-84.41,33.6475],hours:"6:00 AM - 10:00 PM"},{id:"e-retail1",type:"retail",name:"Michael Kors",coordinates:[-84.4098,33.6476],hours:"6:00 AM - 10:00 PM"},{id:"e-lounge1",type:"lounge",name:"Centurion Lounge",coordinates:[-84.4096,33.6477],hours:"5:00 AM - 11:00 PM",description:"American Express premium lounge"}]}]},{id:"concourse-f",name:"Concourse F (International)",gates:[{id:"F1",number:"F1",coordinates:[-84.406,33.649],status:"occupied"},{id:"F2",number:"F2",coordinates:[-84.4058,33.6491],status:"boarding"},{id:"F3",number:"F3",coordinates:[-84.4056,33.6492],status:"available"},{id:"F4",number:"F4",coordinates:[-84.4054,33.6493],status:"occupied"},{id:"F5",number:"F5",coordinates:[-84.4052,33.6494],status:"available"},{id:"F6",number:"F6",coordinates:[-84.405,33.6495],status:"closed"},{id:"F7",number:"F7",coordinates:[-84.4048,33.6496],status:"occupied"},{id:"F8",number:"F8",coordinates:[-84.4046,33.6497],status:"available"},{id:"F9",number:"F9",coordinates:[-84.4044,33.6498],status:"boarding"},{id:"F10",number:"F10",coordinates:[-84.4042,33.6499],status:"occupied"},{id:"F11",number:"F11",coordinates:[-84.404,33.65],status:"available"},{id:"F12",number:"F12",coordinates:[-84.4038,33.6501],status:"occupied"}],floors:[{id:"f-l1",level:1,name:"Main Level",features:[{id:"f-food1",type:"food",name:"The Coffee Bean & Tea Leaf",coordinates:[-84.406,33.649],hours:"5:00 AM - 11:00 PM"},{id:"f-retail1",type:"retail",name:"Duty Free Americas",coordinates:[-84.4058,33.6491],hours:"24 hours"},{id:"f-retail2",type:"retail",name:"Harrods",coordinates:[-84.4056,33.6492],hours:"6:00 AM - 11:00 PM"},{id:"f-retail3",type:"retail",name:"Coach",coordinates:[-84.4054,33.6493],hours:"6:00 AM - 10:00 PM"},{id:"f-retail4",type:"retail",name:"MAC Cosmetics",coordinates:[-84.4052,33.6494],hours:"6:00 AM - 10:00 PM"},{id:"f-lounge1",type:"lounge",name:"The Club at ATL",coordinates:[-84.405,33.6495],hours:"6:00 AM - 10:00 PM"},{id:"f-lounge2",type:"lounge",name:"Delta Sky Club",coordinates:[-84.4048,33.6496],hours:"4:30 AM - 11:30 PM"},{id:"f-customs",type:"checkpoint",name:"Customs & Immigration",coordinates:[-84.4046,33.6497],hours:"24 hours"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All terminals",hours:"24 hours",description:"ATL Free WiFi - up to 45 minutes free"},{id:"pet",type:"service",name:"Pet Relief Areas",location:"Ground Transportation Area",hours:"24 hours",description:"1,000 sq ft dog park facility"},{id:"nursing",type:"service",name:"Mamava Lactation Pods",location:"Concourses B, C, F",hours:"24 hours"},{id:"medical",type:"service",name:"Medical Center",location:"Domestic Terminal",hours:"24 hours"},{id:"prayer",type:"service",name:"Interfaith Chapel",location:"Concourse E",hours:"24 hours"}],services:[{id:"currency",type:"financial",name:"Currency Exchange",provider:"Travelex",location:"All concourses",hours:"6:00 AM - 10:00 PM"},{id:"atm",type:"financial",name:"ATMs",provider:"Truist",location:"All terminals",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Ground Transportation Center",hours:"24 hours"},{id:"taxi",type:"transport",name:"Taxi Service",provider:"Atlanta Taxi",location:"West End between exits W-1 and W-2",hours:"24 hours"},{id:"rideshare",type:"transport",name:"Rideshare Pickup",provider:"Uber/Lyft",location:"North Economy parking lot",hours:"24 hours"}]},zW={id:"lhr",code:"LHR",name:"London Heathrow Airport",city:"London",country:"UK",coordinates:[-.4614,51.47],terminals:[{id:"t5a",name:"Terminal 5A",gates:[{id:"T5-A1",number:"A1",coordinates:[-.461,51.4705],status:"boarding"},{id:"T5-A2",number:"A2",coordinates:[-.4608,51.4706],status:"occupied"},{id:"T5-A3",number:"A3",coordinates:[-.4606,51.4707],status:"available"},{id:"T5-A4",number:"A4",coordinates:[-.4604,51.4708],status:"occupied"},{id:"T5-A5",number:"A5",coordinates:[-.4602,51.4709],status:"available"},{id:"T5-A6",number:"A6",coordinates:[-.46,51.471],status:"boarding"},{id:"T5-A7",number:"A7",coordinates:[-.4598,51.4711],status:"occupied"},{id:"T5-A8",number:"A8",coordinates:[-.4596,51.4712],status:"available"},{id:"T5-A9",number:"A9",coordinates:[-.4594,51.4713],status:"closed"},{id:"T5-A10",number:"A10",coordinates:[-.4592,51.4714],status:"occupied"},{id:"T5-A11",number:"A11",coordinates:[-.459,51.4715],status:"available"},{id:"T5-A12",number:"A12",coordinates:[-.4588,51.4716],status:"boarding"}],floors:[{id:"t5a-l0",level:0,name:"Arrivals",features:[{id:"t5a-bag1",type:"baggage",name:"Baggage Reclaim",coordinates:[-.461,51.4705],hours:"24 hours"},{id:"t5a-customs",type:"checkpoint",name:"Customs",coordinates:[-.4608,51.4706],hours:"24 hours"}]},{id:"t5a-l1",level:1,name:"Departures",features:[{id:"t5a-check1",type:"checkpoint",name:"Check-in Hall",coordinates:[-.461,51.4705],hours:"24 hours"},{id:"t5a-sec1",type:"security",name:"North Security",coordinates:[-.4608,51.4706],hours:"24 hours"},{id:"t5a-sec2",type:"security",name:"South Security",coordinates:[-.4606,51.4707],hours:"24 hours"},{id:"t5a-fast",type:"security",name:"Fast Track Security",coordinates:[-.4604,51.4708],hours:"5:00 AM - 10:00 PM"}]},{id:"t5a-l2",level:2,name:"Gates & Shopping",features:[{id:"t5a-food1",type:"food",name:"Gordon Ramsay Plane Food",coordinates:[-.461,51.4705],hours:"5:00 AM - 10:00 PM"},{id:"t5a-food2",type:"food",name:"Huxleys",coordinates:[-.4608,51.4706],hours:"6:00 AM - 11:00 PM"},{id:"t5a-food3",type:"food",name:"Costa Coffee",coordinates:[-.4606,51.4707],hours:"5:00 AM - 10:00 PM"},{id:"t5a-retail1",type:"retail",name:"Harrods",coordinates:[-.4604,51.4708],hours:"6:00 AM - 10:00 PM"},{id:"t5a-retail2",type:"retail",name:"World Duty Free",coordinates:[-.4602,51.4709],hours:"5:00 AM - 11:00 PM"},{id:"t5a-lounge1",type:"lounge",name:"British Airways Galleries Club",coordinates:[-.46,51.471],hours:"5:00 AM - 10:00 PM"},{id:"t5a-lounge2",type:"lounge",name:"British Airways First Lounge",coordinates:[-.4598,51.4711],hours:"5:00 AM - 10:00 PM"}]}]},{id:"t5b",name:"Terminal 5B",gates:[{id:"T5-B32",number:"B32",coordinates:[-.456,51.4725],status:"boarding"},{id:"T5-B33",number:"B33",coordinates:[-.4558,51.4726],status:"occupied"},{id:"T5-B34",number:"B34",coordinates:[-.4556,51.4727],status:"available"},{id:"T5-B35",number:"B35",coordinates:[-.4554,51.4728],status:"occupied"},{id:"T5-B36",number:"B36",coordinates:[-.4552,51.4729],status:"available"},{id:"T5-B37",number:"B37",coordinates:[-.455,51.473],status:"boarding"},{id:"T5-B38",number:"B38",coordinates:[-.4548,51.4731],status:"occupied"},{id:"T5-B39",number:"B39",coordinates:[-.4546,51.4732],status:"available"},{id:"T5-B40",number:"B40",coordinates:[-.4544,51.4733],status:"closed"},{id:"T5-B41",number:"B41",coordinates:[-.4542,51.4734],status:"occupied"},{id:"T5-B42",number:"B42",coordinates:[-.454,51.4735],status:"available"},{id:"T5-B43",number:"B43",coordinates:[-.4538,51.4736],status:"boarding"}],floors:[{id:"t5b-l1",level:1,name:"Gates Level",features:[{id:"t5b-food1",type:"food",name:"Costa",coordinates:[-.456,51.4725],hours:"5:00 AM - 10:00 PM"},{id:"t5b-retail1",type:"retail",name:"World Duty Free",coordinates:[-.4558,51.4726],hours:"5:00 AM - 11:00 PM"},{id:"t5b-lounge1",type:"lounge",name:"British Airways Club Lounge",coordinates:[-.4556,51.4727],hours:"5:00 AM - 10:00 PM"}]}]},{id:"t5c",name:"Terminal 5C",gates:[{id:"T5-C52",number:"C52",coordinates:[-.451,51.4745],status:"occupied"},{id:"T5-C53",number:"C53",coordinates:[-.4508,51.4746],status:"available"},{id:"T5-C54",number:"C54",coordinates:[-.4506,51.4747],status:"boarding"},{id:"T5-C55",number:"C55",coordinates:[-.4504,51.4748],status:"occupied"},{id:"T5-C56",number:"C56",coordinates:[-.4502,51.4749],status:"available"},{id:"T5-C57",number:"C57",coordinates:[-.45,51.475],status:"closed"},{id:"T5-C58",number:"C58",coordinates:[-.4498,51.4751],status:"occupied"},{id:"T5-C59",number:"C59",coordinates:[-.4496,51.4752],status:"available"},{id:"T5-C60",number:"C60",coordinates:[-.4494,51.4753],status:"boarding"},{id:"T5-C61",number:"C61",coordinates:[-.4492,51.4754],status:"occupied"},{id:"T5-C62",number:"C62",coordinates:[-.449,51.4755],status:"available"},{id:"T5-C63",number:"C63",coordinates:[-.4488,51.4756],status:"occupied"}],floors:[{id:"t5c-l1",level:1,name:"Gates Level",features:[{id:"t5c-food1",type:"food",name:"Kelly Deli",coordinates:[-.451,51.4745],hours:"6:00 AM - 10:00 PM"},{id:"t5c-retail1",type:"retail",name:"World Duty Free",coordinates:[-.4508,51.4746],hours:"5:00 AM - 11:00 PM"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All terminals",hours:"24 hours",description:"_Heathrow Free WiFi"},{id:"prayer",type:"service",name:"Multi-Faith Prayer Rooms",location:"All terminals",hours:"24 hours"},{id:"medical",type:"service",name:"Medical Centre",location:"Terminal 5",hours:"24 hours"},{id:"shower",type:"service",name:"Shower Facilities",location:"Lounges and arrivals",hours:"24 hours"},{id:"currency",type:"service",name:"Currency Exchange",location:"All terminals",hours:"5:00 AM - 11:00 PM"}],services:[{id:"express",type:"transport",name:"Heathrow Express",provider:"Heathrow Express",location:"Terminal 5 Station",hours:"5:00 AM - 11:30 PM"},{id:"tube",type:"transport",name:"London Underground",provider:"TfL",location:"Terminal 5 Station",hours:"24 hours"},{id:"taxi",type:"transport",name:"Black Cabs",provider:"London Taxis",location:"Rank outside terminal",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Terminal 5",hours:"6:00 AM - 11:00 PM"}]},LW={id:"dxb",code:"DXB",name:"Dubai International Airport",city:"Dubai",country:"UAE",coordinates:[55.3644,25.2532],terminals:[{id:"t1",name:"Terminal 1",gates:[{id:"DXB-T1-D1",number:"D1",coordinates:[55.364,25.2535],status:"boarding"},{id:"DXB-T1-D2",number:"D2",coordinates:[55.3638,25.2536],status:"occupied"},{id:"DXB-T1-D3",number:"D3",coordinates:[55.3636,25.2537],status:"available"},{id:"DXB-T1-D4",number:"D4",coordinates:[55.3634,25.2538],status:"occupied"},{id:"DXB-T1-D5",number:"D5",coordinates:[55.3632,25.2539],status:"available"},{id:"DXB-T1-D6",number:"D6",coordinates:[55.363,25.254],status:"boarding"},{id:"DXB-T1-D7",number:"D7",coordinates:[55.3628,25.2541],status:"occupied"},{id:"DXB-T1-D8",number:"D8",coordinates:[55.3626,25.2542],status:"available"},{id:"DXB-T1-D9",number:"D9",coordinates:[55.3624,25.2543],status:"closed"},{id:"DXB-T1-D10",number:"D10",coordinates:[55.3622,25.2544],status:"occupied"}],floors:[{id:"t1-l1",level:1,name:"Departures",features:[{id:"t1-check1",type:"checkpoint",name:"Check-in Counters",coordinates:[55.364,25.2535],hours:"24 hours"},{id:"t1-sec1",type:"security",name:"Security Checkpoint",coordinates:[55.3638,25.2536],hours:"24 hours"},{id:"t1-food1",type:"food",name:"Dubai Duty Free Cafe",coordinates:[55.3636,25.2537],hours:"24 hours"},{id:"t1-retail1",type:"retail",name:"Dubai Duty Free",coordinates:[55.3634,25.2538],hours:"24 hours"},{id:"t1-lounge1",type:"lounge",name:"Marhaba Lounge",coordinates:[55.3632,25.2539],hours:"24 hours"}]}]},{id:"t3",name:"Terminal 3 (Emirates)",gates:[{id:"DXB-T3-A1",number:"A1",coordinates:[55.368,25.251],status:"boarding"},{id:"DXB-T3-A2",number:"A2",coordinates:[55.3678,25.2511],status:"occupied"},{id:"DXB-T3-A3",number:"A3",coordinates:[55.3676,25.2512],status:"available"},{id:"DXB-T3-A4",number:"A4",coordinates:[55.3674,25.2513],status:"occupied"},{id:"DXB-T3-A5",number:"A5",coordinates:[55.3672,25.2514],status:"available"},{id:"DXB-T3-A6",number:"A6",coordinates:[55.367,25.2515],status:"boarding"},{id:"DXB-T3-A7",number:"A7",coordinates:[55.3668,25.2516],status:"occupied"},{id:"DXB-T3-A8",number:"A8",coordinates:[55.3666,25.2517],status:"available"},{id:"DXB-T3-B1",number:"B1",coordinates:[55.3664,25.2518],status:"closed"},{id:"DXB-T3-B2",number:"B2",coordinates:[55.3662,25.2519],status:"occupied"},{id:"DXB-T3-B3",number:"B3",coordinates:[55.366,25.252],status:"available"},{id:"DXB-T3-B4",number:"B4",coordinates:[55.3658,25.2521],status:"boarding"},{id:"DXB-T3-B5",number:"B5",coordinates:[55.3656,25.2522],status:"occupied"},{id:"DXB-T3-B6",number:"B6",coordinates:[55.3654,25.2523],status:"available"},{id:"DXB-T3-B7",number:"B7",coordinates:[55.3652,25.2524],status:"occupied"},{id:"DXB-T3-B8",number:"B8",coordinates:[55.365,25.2525],status:"available"},{id:"DXB-T3-C1",number:"C1",coordinates:[55.3648,25.2526],status:"boarding"},{id:"DXB-T3-C2",number:"C2",coordinates:[55.3646,25.2527],status:"occupied"},{id:"DXB-T3-C3",number:"C3",coordinates:[55.3644,25.2528],status:"available"},{id:"DXB-T3-C4",number:"C4",coordinates:[55.3642,25.2529],status:"occupied"},{id:"DXB-T3-C5",number:"C5",coordinates:[55.364,25.253],status:"available"},{id:"DXB-T3-C6",number:"C6",coordinates:[55.3638,25.2531],status:"boarding"}],floors:[{id:"t3-l1",level:1,name:"Departures & Lounges",features:[{id:"t3-check1",type:"checkpoint",name:"Emirates Check-in",coordinates:[55.368,25.251],hours:"24 hours"},{id:"t3-sec1",type:"security",name:"Security Checkpoint",coordinates:[55.3678,25.2511],hours:"24 hours"},{id:"t3-food1",type:"food",name:"Emirates Business Class Lounge",coordinates:[55.3676,25.2512],hours:"24 hours"},{id:"t3-lounge1",type:"lounge",name:"Emirates First Class Lounge",coordinates:[55.3674,25.2513],hours:"24 hours",description:"Premium lounge with spa and dining"},{id:"t3-lounge2",type:"lounge",name:"Emirates Business Lounge Concourse B",coordinates:[55.3672,25.2514],hours:"24 hours",description:"Moet & Chandon Champagne bar"},{id:"t3-retail1",type:"retail",name:"Dubai Duty Free",coordinates:[55.367,25.2515],hours:"24 hours"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All terminals",hours:"24 hours",description:"DXB Free WiFi"},{id:"prayer",type:"service",name:"Prayer Rooms",location:"All terminals",hours:"24 hours"},{id:"medical",type:"service",name:"Medical Centre",location:"All terminals",hours:"24 hours"},{id:"spa",type:"service",name:"Spa Facilities",location:"Lounges",hours:"24 hours"},{id:"shower",type:"service",name:"Shower Facilities",location:"Lounges",hours:"24 hours"}],services:[{id:"metro",type:"transport",name:"Dubai Metro",provider:"RTA",location:"Terminal 1 & 3",hours:"6:00 AM - 11:00 PM"},{id:"taxi",type:"transport",name:"Dubai Taxi",provider:"Dubai Taxi Agency",location:"All terminals",hours:"24 hours"},{id:"bus",type:"transport",name:"Public Bus",provider:"RTA",location:"Terminal 1 & 3",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Arrivals Hall",hours:"24 hours"},{id:"currency",type:"financial",name:"Currency Exchange",provider:"Multiple",location:"All terminals",hours:"24 hours"}]},BW={id:"sin",code:"SIN",name:"Singapore Changi Airport",city:"Singapore",country:"Singapore",coordinates:[103.9915,1.3644],terminals:[{id:"t1",name:"Terminal 1",gates:[{id:"SIN-T1-C1",number:"C1",coordinates:[103.991,1.3648],status:"boarding"},{id:"SIN-T1-C2",number:"C2",coordinates:[103.9908,1.3649],status:"occupied"},{id:"SIN-T1-C3",number:"C3",coordinates:[103.9906,1.365],status:"available"},{id:"SIN-T1-C4",number:"C4",coordinates:[103.9904,1.3651],status:"occupied"},{id:"SIN-T1-C5",number:"C5",coordinates:[103.9902,1.3652],status:"available"},{id:"SIN-T1-C6",number:"C6",coordinates:[103.99,1.3653],status:"boarding"},{id:"SIN-T1-C7",number:"C7",coordinates:[103.9898,1.3654],status:"occupied"},{id:"SIN-T1-C8",number:"C8",coordinates:[103.9896,1.3655],status:"available"},{id:"SIN-T1-C9",number:"C9",coordinates:[103.9894,1.3656],status:"closed"},{id:"SIN-T1-C10",number:"C10",coordinates:[103.9892,1.3657],status:"occupied"}],floors:[{id:"t1-l1",level:1,name:"Departures",features:[{id:"t1-check1",type:"checkpoint",name:"Check-in Hall",coordinates:[103.991,1.3648],hours:"24 hours"},{id:"t1-sec1",type:"security",name:"North Security",coordinates:[103.9908,1.3649],hours:"24 hours"},{id:"t1-sec2",type:"security",name:"South Security",coordinates:[103.9906,1.365],hours:"24 hours"},{id:"t1-fast",type:"security",name:"Fast Track Lane",coordinates:[103.9904,1.3651],hours:"5:00 AM - 11:00 PM"},{id:"t1-food1",type:"food",name:"Food Court",coordinates:[103.9902,1.3652],hours:"24 hours"},{id:"t1-retail1",type:"retail",name:"Duty Free Shop",coordinates:[103.99,1.3653],hours:"24 hours"},{id:"t1-lounge1",type:"lounge",name:"SilverKris Lounge",coordinates:[103.9898,1.3654],hours:"5:00 AM - 11:00 PM"}]}]},{id:"t2",name:"Terminal 2",gates:[{id:"SIN-T2-E1",number:"E1",coordinates:[103.995,1.363],status:"boarding"},{id:"SIN-T2-E2",number:"E2",coordinates:[103.9948,1.3631],status:"occupied"},{id:"SIN-T2-E3",number:"E3",coordinates:[103.9946,1.3632],status:"available"},{id:"SIN-T2-E4",number:"E4",coordinates:[103.9944,1.3633],status:"occupied"},{id:"SIN-T2-E5",number:"E5",coordinates:[103.9942,1.3634],status:"available"},{id:"SIN-T2-E6",number:"E6",coordinates:[103.994,1.3635],status:"boarding"},{id:"SIN-T2-E7",number:"E7",coordinates:[103.9938,1.3636],status:"occupied"},{id:"SIN-T2-E8",number:"E8",coordinates:[103.9936,1.3637],status:"available"},{id:"SIN-T2-F1",number:"F1",coordinates:[103.9934,1.3638],status:"closed"},{id:"SIN-T2-F2",number:"F2",coordinates:[103.9932,1.3639],status:"occupied"},{id:"SIN-T2-F3",number:"F3",coordinates:[103.993,1.364],status:"available"},{id:"SIN-T2-F4",number:"F4",coordinates:[103.9928,1.3641],status:"boarding"}],floors:[{id:"t2-l1",level:1,name:"Departures",features:[{id:"t2-check1",type:"checkpoint",name:"Check-in Hall",coordinates:[103.995,1.363],hours:"24 hours"},{id:"t2-sec1",type:"security",name:"North Security",coordinates:[103.9948,1.3631],hours:"24 hours"},{id:"t2-sec2",type:"security",name:"South Security",coordinates:[103.9946,1.3632],hours:"24 hours"},{id:"t2-sec3",type:"security",name:"Level 2 Departure Transit",coordinates:[103.9944,1.3633],hours:"24 hours"},{id:"t2-garden",type:"amenity",name:"Sunflower Garden",coordinates:[103.9942,1.3634],hours:"24 hours",description:"Outdoor garden with sunflower displays"},{id:"t2-food1",type:"food",name:"Food Court",coordinates:[103.994,1.3635],hours:"24 hours"},{id:"t2-retail1",type:"retail",name:"Duty Free Shop",coordinates:[103.9938,1.3636],hours:"24 hours"}]}]},{id:"t3",name:"Terminal 3",gates:[{id:"SIN-T3-A1",number:"A1",coordinates:[103.998,1.362],status:"boarding"},{id:"SIN-T3-A2",number:"A2",coordinates:[103.9978,1.3621],status:"occupied"},{id:"SIN-T3-A3",number:"A3",coordinates:[103.9976,1.3622],status:"available"},{id:"SIN-T3-A4",number:"A4",coordinates:[103.9974,1.3623],status:"occupied"},{id:"SIN-T3-A5",number:"A5",coordinates:[103.9972,1.3624],status:"available"},{id:"SIN-T3-A6",number:"A6",coordinates:[103.997,1.3625],status:"boarding"},{id:"SIN-T3-A7",number:"A7",coordinates:[103.9968,1.3626],status:"occupied"},{id:"SIN-T3-A8",number:"A8",coordinates:[103.9966,1.3627],status:"available"},{id:"SIN-T3-B1",number:"B1",coordinates:[103.9964,1.3628],status:"closed"},{id:"SIN-T3-B2",number:"B2",coordinates:[103.9962,1.3629],status:"occupied"},{id:"SIN-T3-B3",number:"B3",coordinates:[103.996,1.363],status:"available"},{id:"SIN-T3-B4",number:"B4",coordinates:[103.9958,1.3631],status:"boarding"}],floors:[{id:"t3-l1",level:1,name:"Departures",features:[{id:"t3-check1",type:"checkpoint",name:"Check-in Hall",coordinates:[103.998,1.362],hours:"24 hours"},{id:"t3-sec1",type:"security",name:"North Security",coordinates:[103.9978,1.3621],hours:"24 hours"},{id:"t3-sec2",type:"security",name:"South Security",coordinates:[103.9976,1.3622],hours:"24 hours"},{id:"t3-garden",type:"amenity",name:"Butterfly Garden",coordinates:[103.9974,1.3623],hours:"24 hours",description:"Indoor butterfly habitat"},{id:"t3-food1",type:"food",name:"Food Court",coordinates:[103.9972,1.3624],hours:"24 hours"},{id:"t3-retail1",type:"retail",name:"Duty Free Shop",coordinates:[103.997,1.3625],hours:"24 hours"},{id:"t3-lounge1",type:"lounge",name:"SilverKris Lounge",coordinates:[103.9968,1.3626],hours:"5:00 AM - 11:00 PM"}]}]},{id:"t4",name:"Terminal 4",gates:[{id:"SIN-T4-G1",number:"G1",coordinates:[104.001,1.361],status:"boarding"},{id:"SIN-T4-G2",number:"G2",coordinates:[104.0008,1.3611],status:"occupied"},{id:"SIN-T4-G3",number:"G3",coordinates:[104.0006,1.3612],status:"available"},{id:"SIN-T4-G4",number:"G4",coordinates:[104.0004,1.3613],status:"occupied"},{id:"SIN-T4-G5",number:"G5",coordinates:[104.0002,1.3614],status:"available"},{id:"SIN-T4-G6",number:"G6",coordinates:[104,1.3615],status:"boarding"},{id:"SIN-T4-G7",number:"G7",coordinates:[103.9998,1.3616],status:"occupied"},{id:"SIN-T4-G8",number:"G8",coordinates:[103.9996,1.3617],status:"available"}],floors:[{id:"t4-l1",level:1,name:"Departures",features:[{id:"t4-check1",type:"checkpoint",name:"FAST Check-in",coordinates:[104.001,1.361],hours:"24 hours",description:"Self-service check-in system"},{id:"t4-sec1",type:"security",name:"Security Checkpoint",coordinates:[104.0008,1.3611],hours:"24 hours"},{id:"t4-art1",type:"amenity",name:"Heritage Zone",coordinates:[104.0006,1.3612],hours:"24 hours",description:"Immersive cultural display"},{id:"t4-art2",type:"amenity",name:"Petalclouds",coordinates:[104.0004,1.3613],hours:"24 hours",description:"Kinetic sculpture"},{id:"t4-food1",type:"food",name:"Food Court",coordinates:[104.0002,1.3614],hours:"24 hours"},{id:"t4-retail1",type:"retail",name:"Duty Free Shop",coordinates:[104,1.3615],hours:"24 hours"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All terminals",hours:"24 hours",description:"Changi Free WiFi"},{id:"garden",type:"attraction",name:"Butterfly Garden",location:"Terminal 3",hours:"24 hours",description:"Indoor butterfly habitat"},{id:"sunflower",type:"attraction",name:"Sunflower Garden",location:"Terminal 2",hours:"24 hours",description:"Outdoor garden"},{id:"cinema",type:"entertainment",name:"Free Movie Theatre",location:"Terminals 2 & 3",hours:"24 hours"},{id:"pool",type:"recreation",name:"Rooftop Pool",location:"Terminal 1",hours:"6:00 AM - 12:00 AM"},{id:"spa",type:"service",name:"Spa Facilities",location:"All terminals",hours:"24 hours"}],services:[{id:"mrt",type:"transport",name:"MRT (Mass Rapid Transit)",provider:"SMRT",location:"Terminals 2 & 3",hours:"5:30 AM - 12:00 AM"},{id:"bus",type:"transport",name:"Public Bus",provider:"SBS Transit",location:"All terminals",hours:"24 hours"},{id:"taxi",type:"transport",name:"Taxi",provider:"ComfortDelGro",location:"All terminals",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Arrivals",hours:"24 hours"},{id:"skytrain",type:"transport",name:"Skytrain",provider:"Changi Airport",location:"Terminals 1, 2, 3",hours:"24 hours"},{id:"shuttle",type:"transport",name:"Shuttle Bus to T4",provider:"Changi Airport",location:"All terminals",hours:"24 hours"}]},kW={id:"ams",code:"AMS",name:"Amsterdam Airport Schiphol",city:"Amsterdam",country:"Netherlands",coordinates:[4.7683,52.3105],terminals:[{id:"main",name:"Main Terminal",gates:[{id:"AMS-B1",number:"B1",coordinates:[4.767,52.311],status:"boarding"},{id:"AMS-B2",number:"B2",coordinates:[4.7668,52.3111],status:"occupied"},{id:"AMS-B3",number:"B3",coordinates:[4.7666,52.3112],status:"available"},{id:"AMS-B4",number:"B4",coordinates:[4.7664,52.3113],status:"occupied"},{id:"AMS-B5",number:"B5",coordinates:[4.7662,52.3114],status:"available"},{id:"AMS-C1",number:"C1",coordinates:[4.766,52.3115],status:"boarding"},{id:"AMS-C2",number:"C2",coordinates:[4.7658,52.3116],status:"occupied"},{id:"AMS-C3",number:"C3",coordinates:[4.7656,52.3117],status:"available"},{id:"AMS-C4",number:"C4",coordinates:[4.7654,52.3118],status:"occupied"},{id:"AMS-C5",number:"C5",coordinates:[4.7652,52.3119],status:"available"},{id:"AMS-D1",number:"D1",coordinates:[4.769,52.31],status:"boarding"},{id:"AMS-D2",number:"D2",coordinates:[4.7688,52.3101],status:"occupied"},{id:"AMS-D3",number:"D3",coordinates:[4.7686,52.3102],status:"available"},{id:"AMS-D4",number:"D4",coordinates:[4.7684,52.3103],status:"occupied"},{id:"AMS-D5",number:"D5",coordinates:[4.7682,52.3104],status:"available"},{id:"AMS-E1",number:"E1",coordinates:[4.77,52.309],status:"boarding"},{id:"AMS-E2",number:"E2",coordinates:[4.7698,52.3091],status:"occupied"},{id:"AMS-E3",number:"E3",coordinates:[4.7696,52.3092],status:"available"},{id:"AMS-E4",number:"E4",coordinates:[4.7694,52.3093],status:"occupied"},{id:"AMS-E5",number:"E5",coordinates:[4.7692,52.3094],status:"available"},{id:"AMS-F1",number:"F1",coordinates:[4.771,52.308],status:"boarding"},{id:"AMS-F2",number:"F2",coordinates:[4.7708,52.3081],status:"occupied"},{id:"AMS-F3",number:"F3",coordinates:[4.7706,52.3082],status:"available"},{id:"AMS-F4",number:"F4",coordinates:[4.7704,52.3083],status:"occupied"},{id:"AMS-F5",number:"F5",coordinates:[4.7702,52.3084],status:"available"},{id:"AMS-G1",number:"G1",coordinates:[4.772,52.307],status:"boarding"},{id:"AMS-G2",number:"G2",coordinates:[4.7718,52.3071],status:"occupied"},{id:"AMS-G3",number:"G3",coordinates:[4.7716,52.3072],status:"available"},{id:"AMS-G4",number:"G4",coordinates:[4.7714,52.3073],status:"occupied"},{id:"AMS-G5",number:"G5",coordinates:[4.7712,52.3074],status:"available"},{id:"AMS-H1",number:"H1",coordinates:[4.773,52.306],status:"boarding"},{id:"AMS-H2",number:"H2",coordinates:[4.7728,52.3061],status:"occupied"},{id:"AMS-H3",number:"H3",coordinates:[4.7726,52.3062],status:"available"},{id:"AMS-H4",number:"H4",coordinates:[4.7724,52.3063],status:"occupied"},{id:"AMS-H5",number:"H5",coordinates:[4.7722,52.3064],status:"available"},{id:"AMS-M1",number:"M1",coordinates:[4.774,52.305],status:"boarding"},{id:"AMS-M2",number:"M2",coordinates:[4.7738,52.3051],status:"occupied"},{id:"AMS-M3",number:"M3",coordinates:[4.7736,52.3052],status:"available"},{id:"AMS-M4",number:"M4",coordinates:[4.7734,52.3053],status:"occupied"},{id:"AMS-M5",number:"M5",coordinates:[4.7732,52.3054],status:"available"}],floors:[{id:"main-l1",level:1,name:"Arrivals",features:[{id:"ams-bag1",type:"baggage",name:"Baggage Claim Hall 1",coordinates:[4.7683,52.3105],hours:"24 hours"},{id:"ams-bag2",type:"baggage",name:"Baggage Claim Hall 2",coordinates:[4.7685,52.3106],hours:"24 hours"},{id:"ams-bag3",type:"baggage",name:"Baggage Claim Hall 3",coordinates:[4.7687,52.3107],hours:"24 hours"},{id:"ams-customs",type:"checkpoint",name:"Customs",coordinates:[4.7689,52.3108],hours:"24 hours"}]},{id:"main-l2",level:2,name:"Departures",features:[{id:"ams-check1",type:"checkpoint",name:"Departure Hall 1",coordinates:[4.7683,52.3105],hours:"24 hours"},{id:"ams-check2",type:"checkpoint",name:"Departure Hall 2",coordinates:[4.7685,52.3106],hours:"24 hours"},{id:"ams-check3",type:"checkpoint",name:"Departure Hall 3",coordinates:[4.7687,52.3107],hours:"24 hours"},{id:"ams-sec1",type:"security",name:"Security Checkpoint",coordinates:[4.7689,52.3108],hours:"24 hours"},{id:"ams-fast1",type:"security",name:"Fast Track Lane",coordinates:[4.7691,52.3109],hours:"5:00 AM - 10:00 PM"},{id:"ams-passport",type:"checkpoint",name:"Passport Control",coordinates:[4.7693,52.311],hours:"24 hours"}]},{id:"main-l3",level:3,name:"Lounges & Shopping",features:[{id:"ams-food1",type:"food",name:"Burger King",coordinates:[4.7683,52.3105],hours:"5:00 AM - 11:00 PM"},{id:"ams-food2",type:"food",name:"Dutch Kitchen & Bar",coordinates:[4.7685,52.3106],hours:"6:00 AM - 10:00 PM"},{id:"ams-retail1",type:"retail",name:"Gucci",coordinates:[4.7687,52.3107],hours:"6:00 AM - 10:00 PM"},{id:"ams-retail2",type:"retail",name:"H&M",coordinates:[4.7689,52.3108],hours:"6:00 AM - 10:00 PM"},{id:"ams-lounge1",type:"lounge",name:"KLM Crown Lounge",coordinates:[4.7691,52.3109],hours:"4:30 AM - 11:00 PM"},{id:"ams-lounge2",type:"lounge",name:"oneworld Lounge",coordinates:[4.7693,52.311],hours:"5:00 AM - 10:00 PM"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All areas",hours:"24 hours",description:"Schiphol Free WiFi"},{id:"medical",type:"service",name:"Medical Centre",location:"Main Terminal",hours:"24 hours"},{id:"pharmacy",type:"service",name:"Pharmacy",location:"Main Terminal",hours:"6:00 AM - 10:00 PM"},{id:"prayer",type:"service",name:"Prayer Room",location:"Main Terminal",hours:"24 hours"},{id:"shower",type:"service",name:"Shower Facilities",location:"Lounges",hours:"24 hours"}],services:[{id:"train",type:"transport",name:"NS Dutch Railways",provider:"NS",location:"Schiphol Plaza",hours:"24 hours"},{id:"bus",type:"transport",name:"Airport Express Bus 397",provider:"Connexxion",location:"Schiphol Plaza",hours:"24 hours"},{id:"taxi",type:"transport",name:"Taxi",provider:"Schiphol Taxi",location:"Outside arrivals",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Schiphol Plaza",hours:"24 hours"},{id:"currency",type:"financial",name:"Currency Exchange",provider:"GWK Travelex",location:"All areas",hours:"6:00 AM - 11:00 PM"}]},FW={id:"fra",code:"FRA",name:"Frankfurt Airport",city:"Frankfurt",country:"Germany",coordinates:[8.5706,50.0379],terminals:[{id:"t1",name:"Terminal 1",gates:[{id:"FRA-A1",number:"A1",coordinates:[8.569,50.0385],status:"boarding"},{id:"FRA-A2",number:"A2",coordinates:[8.5688,50.0386],status:"occupied"},{id:"FRA-A3",number:"A3",coordinates:[8.5686,50.0387],status:"available"},{id:"FRA-A4",number:"A4",coordinates:[8.5684,50.0388],status:"occupied"},{id:"FRA-A5",number:"A5",coordinates:[8.5682,50.0389],status:"available"},{id:"FRA-B1",number:"B1",coordinates:[8.568,50.039],status:"boarding"},{id:"FRA-B2",number:"B2",coordinates:[8.5678,50.0391],status:"occupied"},{id:"FRA-B3",number:"B3",coordinates:[8.5676,50.0392],status:"available"},{id:"FRA-B4",number:"B4",coordinates:[8.5674,50.0393],status:"occupied"},{id:"FRA-B5",number:"B5",coordinates:[8.5672,50.0394],status:"available"},{id:"FRA-C1",number:"C1",coordinates:[8.567,50.0395],status:"boarding"},{id:"FRA-C2",number:"C2",coordinates:[8.5668,50.0396],status:"occupied"},{id:"FRA-C3",number:"C3",coordinates:[8.5666,50.0397],status:"available"},{id:"FRA-C4",number:"C4",coordinates:[8.5664,50.0398],status:"occupied"},{id:"FRA-C5",number:"C5",coordinates:[8.5662,50.0399],status:"available"},{id:"FRA-Z1",number:"Z1",coordinates:[8.566,50.04],status:"boarding"},{id:"FRA-Z2",number:"Z2",coordinates:[8.5658,50.0401],status:"occupied"},{id:"FRA-Z3",number:"Z3",coordinates:[8.5656,50.0402],status:"available"},{id:"FRA-Z4",number:"Z4",coordinates:[8.5654,50.0403],status:"occupied"},{id:"FRA-Z5",number:"Z5",coordinates:[8.5652,50.0404],status:"available"}],floors:[{id:"t1-l1",level:1,name:"Arrivals",features:[{id:"fra-bag1",type:"baggage",name:"Baggage Claim",coordinates:[8.5706,50.0379],hours:"24 hours"},{id:"fra-customs",type:"checkpoint",name:"Customs",coordinates:[8.5708,50.038],hours:"24 hours"}]},{id:"t1-l2",level:2,name:"Departures",features:[{id:"fra-check1",type:"checkpoint",name:"Check-in Hall A",coordinates:[8.569,50.0385],hours:"24 hours"},{id:"fra-check2",type:"checkpoint",name:"Check-in Hall B",coordinates:[8.568,50.039],hours:"24 hours"},{id:"fra-sec1",type:"security",name:"Security Checkpoint A",coordinates:[8.5688,50.0386],hours:"24 hours"},{id:"fra-sec2",type:"security",name:"Security Checkpoint B",coordinates:[8.5678,50.0391],hours:"24 hours"},{id:"fra-sec3",type:"security",name:"Security Checkpoint C",coordinates:[8.5668,50.0396],hours:"24 hours"},{id:"fra-fast1",type:"security",name:"Fast Track Lane",coordinates:[8.5706,50.0379],hours:"5:00 AM - 10:00 PM"},{id:"fra-passport",type:"checkpoint",name:"Passport Control",coordinates:[8.5708,50.038],hours:"24 hours"}]},{id:"t1-l3",level:3,name:"Lounges & Shopping",features:[{id:"fra-food1",type:"food",name:"Hans Im Gluck",coordinates:[8.5706,50.0379],hours:"5:00 AM - 11:00 PM"},{id:"fra-retail1",type:"retail",name:"Duty Free Shop",coordinates:[8.5708,50.038],hours:"24 hours"},{id:"fra-lounge1",type:"lounge",name:"Lufthansa First Class Lounge",coordinates:[8.571,50.0381],hours:"5:00 AM - 10:00 PM"},{id:"fra-lounge2",type:"lounge",name:"Lufthansa Business Lounge",coordinates:[8.5712,50.0382],hours:"5:00 AM - 10:00 PM"},{id:"fra-lounge3",type:"lounge",name:"Star Alliance Lounge",coordinates:[8.5714,50.0383],hours:"5:00 AM - 10:00 PM"}]}]},{id:"t2",name:"Terminal 2",gates:[{id:"FRA-D1",number:"D1",coordinates:[8.575,50.035],status:"boarding"},{id:"FRA-D2",number:"D2",coordinates:[8.5748,50.0351],status:"occupied"},{id:"FRA-D3",number:"D3",coordinates:[8.5746,50.0352],status:"available"},{id:"FRA-D4",number:"D4",coordinates:[8.5744,50.0353],status:"occupied"},{id:"FRA-D5",number:"D5",coordinates:[8.5742,50.0354],status:"available"},{id:"FRA-E1",number:"E1",coordinates:[8.574,50.0355],status:"boarding"},{id:"FRA-E2",number:"E2",coordinates:[8.5738,50.0356],status:"occupied"},{id:"FRA-E3",number:"E3",coordinates:[8.5736,50.0357],status:"available"},{id:"FRA-E4",number:"E4",coordinates:[8.5734,50.0358],status:"occupied"},{id:"FRA-E5",number:"E5",coordinates:[8.5732,50.0359],status:"available"}],floors:[{id:"t2-l1",level:1,name:"Main Level",features:[{id:"t2-check1",type:"checkpoint",name:"Check-in Hall",coordinates:[8.575,50.035],hours:"24 hours"},{id:"t2-sec1",type:"security",name:"Security Checkpoint",coordinates:[8.5748,50.0351],hours:"24 hours"},{id:"t2-food1",type:"food",name:"Food Court",coordinates:[8.5746,50.0352],hours:"5:00 AM - 11:00 PM"},{id:"t2-retail1",type:"retail",name:"Duty Free Shop",coordinates:[8.5744,50.0353],hours:"24 hours"}]}]}],amenities:[{id:"wifi",type:"connectivity",name:"Free WiFi",location:"All terminals",hours:"24 hours",description:"FRA Free WiFi"},{id:"medical",type:"service",name:"Medical Centre",location:"Terminal 1",hours:"24 hours"},{id:"pharmacy",type:"service",name:"Pharmacy",location:"Terminal 1",hours:"6:00 AM - 10:00 PM"},{id:"prayer",type:"service",name:"Prayer Room",location:"All terminals",hours:"24 hours"},{id:"shower",type:"service",name:"Shower Facilities",location:"Lounges",hours:"24 hours"}],services:[{id:"train",type:"transport",name:"S-Bahn / Regional Train",provider:"DB",location:"Airport Regional Station",hours:"24 hours"},{id:"ice",type:"transport",name:"ICE High-Speed Train",provider:"DB",location:"Airport Long-Distance Station",hours:"5:00 AM - 12:00 AM"},{id:"skyline",type:"transport",name:"SkyLine People Mover",provider:"Fraport",location:"Between T1 and T2",hours:"24 hours"},{id:"bus",type:"transport",name:"Public Bus",provider:"RMV",location:"Terminal 1",hours:"24 hours"},{id:"taxi",type:"transport",name:"Taxi",provider:"Taxi Frankfurt",location:"Both terminals",hours:"24 hours"},{id:"car",type:"transport",name:"Car Rental",provider:"Multiple",location:"Terminal 1",hours:"24 hours"},{id:"currency",type:"financial",name:"Currency Exchange",provider:"ReiseBank",location:"All terminals",hours:"6:00 AM - 11:00 PM"}]},v0=[RW,zW,LW,BW,kW,FW],DI=r=>v0.find(t=>t.code===r.toUpperCase()),NW="demo",jW="http://api.aviationstack.com/v1",UW=r=>{const t=DI(r);if(!t)return[];const o=[{code:"DL",name:"Delta Air Lines"},{code:"AA",name:"American Airlines"},{code:"UA",name:"United Airlines"},{code:"BA",name:"British Airways"},{code:"LH",name:"Lufthansa"},{code:"AF",name:"Air France"},{code:"KL",name:"KLM Royal Dutch Airlines"},{code:"EK",name:"Emirates"},{code:"SQ",name:"Singapore Airlines"},{code:"VS",name:"Virgin Atlantic"},{code:"IB",name:"Iberia"},{code:"LX",name:"SWISS"},{code:"OS",name:"Austrian Airlines"},{code:"AY",name:"Finnair"},{code:"EI",name:"Aer Lingus"}],l=[{code:"JFK",name:"John F. Kennedy International Airport",city:"New York",country:"USA"},{code:"LAX",name:"Los Angeles International Airport",city:"Los Angeles",country:"USA"},{code:"ORD",name:"O'Hare International Airport",city:"Chicago",country:"USA"},{code:"MIA",name:"Miami International Airport",city:"Miami",country:"USA"},{code:"SFO",name:"San Francisco International Airport",city:"San Francisco",country:"USA"},{code:"DFW",name:"Dallas/Fort Worth International Airport",city:"Dallas",country:"USA"},{code:"DEN",name:"Denver International Airport",city:"Denver",country:"USA"},{code:"SEA",name:"Seattle-Tacoma International Airport",city:"Seattle",country:"USA"},{code:"BOS",name:"Boston Logan International Airport",city:"Boston",country:"USA"},{code:"LAS",name:"Harry Reid International Airport",city:"Las Vegas",country:"USA"},{code:"LHR",name:"London Heathrow Airport",city:"London",country:"UK"},{code:"CDG",name:"Charles de Gaulle Airport",city:"Paris",country:"France"},{code:"FRA",name:"Frankfurt Airport",city:"Frankfurt",country:"Germany"},{code:"AMS",name:"Amsterdam Airport Schiphol",city:"Amsterdam",country:"Netherlands"},{code:"MAD",name:"Adolfo Suarez Madrid-Barajas Airport",city:"Madrid",country:"Spain"},{code:"FCO",name:"Leonardo da Vinci International Airport",city:"Rome",country:"Italy"},{code:"MUC",name:"Munich Airport",city:"Munich",country:"Germany"},{code:"ZRH",name:"Zurich Airport",city:"Zurich",country:"Switzerland"},{code:"VIE",name:"Vienna International Airport",city:"Vienna",country:"Austria"},{code:"BRU",name:"Brussels Airport",city:"Brussels",country:"Belgium"},{code:"DXB",name:"Dubai International Airport",city:"Dubai",country:"UAE"},{code:"SIN",name:"Singapore Changi Airport",city:"Singapore",country:"Singapore"},{code:"HKG",name:"Hong Kong International Airport",city:"Hong Kong",country:"China"},{code:"NRT",name:"Narita International Airport",city:"Tokyo",country:"Japan"},{code:"ICN",name:"Incheon International Airport",city:"Seoul",country:"South Korea"},{code:"BKK",name:"Suvarnabhumi Airport",city:"Bangkok",country:"Thailand"},{code:"SYD",name:"Sydney Kingsford Smith Airport",city:"Sydney",country:"Australia"},{code:"AKL",name:"Auckland Airport",city:"Auckland",country:"New Zealand"},{code:"GRU",name:"Sao Paulo/Guarulhos International Airport",city:"Sao Paulo",country:"Brazil"},{code:"EZE",name:"Ministro Pistarini International Airport",city:"Buenos Aires",country:"Argentina"}],h=["scheduled","active","delayed","cancelled","boarding","departed","arrived","on-time"],v=["Boeing 737-800","Boeing 777-300ER","Boeing 787-9","Airbus A320","Airbus A321","Airbus A330-300","Airbus A350-900","Airbus A380-800"],w=[],a=new Date;for(let C=0;C<40;C++){const I=o[Math.floor(Math.random()*o.length)],L=l[Math.floor(Math.random()*l.length)],k=h[Math.floor(Math.random()*h.length)],G=`${I.code}${Math.floor(100+Math.random()*8999)}`,q=new Date(a.getTime()+Math.random()*24*60*60*1e3),Q=Math.random()>.7?Math.floor(Math.random()*120):0,H=Q>0?new Date(q.getTime()+Q*6e4):void 0,K=120+Math.floor(Math.random()*600),he=new Date(q.getTime()+K*6e4),ue=H?new Date(H.getTime()+K*6e4):void 0,me=t.terminals[Math.floor(Math.random()*t.terminals.length)],ge=me.gates[Math.floor(Math.random()*me.gates.length)];w.push({id:`dep-${G}-${C}`,flightNumber:G,airline:I,origin:{code:t.code,name:t.name,city:t.city,country:t.country,terminal:me.name,gate:ge?.number},destination:L,scheduledDeparture:q.toISOString(),actualDeparture:H?.toISOString(),scheduledArrival:he.toISOString(),actualArrival:ue?.toISOString(),gate:ge?.number,terminal:me.name,status:k,aircraft:v[Math.floor(Math.random()*v.length)],delay:Q>0?Q:void 0})}for(let C=0;C<35;C++){const I=o[Math.floor(Math.random()*o.length)],L=l[Math.floor(Math.random()*l.length)],k=h[Math.floor(Math.random()*h.length)],G=`${I.code}${Math.floor(100+Math.random()*8999)}`,q=new Date(a.getTime()+Math.random()*24*60*60*1e3),Q=Math.random()>.7?Math.floor(Math.random()*120):0,H=Q>0?new Date(q.getTime()+Q*6e4):void 0,K=120+Math.floor(Math.random()*600),he=new Date(q.getTime()-K*6e4),ue=H?new Date(H.getTime()-K*6e4):void 0,me=t.terminals[Math.floor(Math.random()*t.terminals.length)],ge=me.gates[Math.floor(Math.random()*me.gates.length)],se=`${String.fromCharCode(65+Math.floor(Math.random()*8))}${Math.floor(1+Math.random()*20)}`;w.push({id:`arr-${G}-${C}`,flightNumber:G,airline:I,origin:L,destination:{code:t.code,name:t.name,city:t.city,country:t.country,terminal:me.name,gate:ge?.number,baggage:se},scheduledDeparture:he.toISOString(),actualDeparture:ue?.toISOString(),scheduledArrival:q.toISOString(),actualArrival:H?.toISOString(),gate:ge?.number,terminal:me.name,baggageClaim:se,status:k,aircraft:v[Math.floor(Math.random()*v.length)],delay:Q>0?Q:void 0})}return w.sort((C,I)=>new Date(C.scheduledDeparture).getTime()-new Date(I.scheduledDeparture).getTime())};class VW{flights=new Map;updateInterval=null;subscribers=new Set;constructor(){this.initializeMockData(),this.startRealTimeUpdates()}initializeMockData(){v0.forEach(t=>{this.flights.set(t.code,UW(t.code))})}startRealTimeUpdates(){this.updateInterval=setInterval(()=>{this.flights.forEach((t,o)=>{const l=t.map(h=>{if(Math.random()>.9){const v=["scheduled","active","delayed","cancelled","boarding","departed","arrived","on-time"],w=v[Math.floor(Math.random()*v.length)];return{...h,status:w}}return h});this.flights.set(o,l),this.notifySubscribers(l,o)})},3e4)}subscribe(t){return this.subscribers.add(t),()=>this.subscribers.delete(t)}notifySubscribers(t,o){this.subscribers.forEach(l=>l(t,o))}async fetchFlightsFromAPI(t){try{const o=await fetch(`${jW}/flights?access_key=${NW}&dep_iata=${t}`);if(!o.ok)throw new Error("Failed to fetch flights");const l=await o.json();return l.error?(console.warn("API Error:",l.error),this.getMockFlights(t)):this.transformAPIData(l.data)}catch(o){return console.warn("Using mock data due to API error:",o),this.getMockFlights(t)}}transformAPIData(t){return t.map(o=>({id:`${o.flight?.iata||o.flight?.icao||"unknown"}-${o.flight_date||""}`,flightNumber:o.flight?.iata||o.flight?.icao||"Unknown",airline:{code:o.airline?.iata||"",name:o.airline?.name||"Unknown Airline"},origin:{code:o.departure?.iata||"",name:o.departure?.airport||"",city:o.departure?.timezone?.split("/")[1]||"",country:"",terminal:o.departure?.terminal,gate:o.departure?.gate},destination:{code:o.arrival?.iata||"",name:o.arrival?.airport||"",city:o.arrival?.timezone?.split("/")[1]||"",country:"",terminal:o.arrival?.terminal,gate:o.arrival?.gate,baggage:o.arrival?.baggage},scheduledDeparture:o.departure?.scheduled||"",actualDeparture:o.departure?.actual,scheduledArrival:o.arrival?.scheduled||"",actualArrival:o.arrival?.actual,gate:o.departure?.gate,terminal:o.departure?.terminal,baggageClaim:o.arrival?.baggage,status:this.mapAPIStatus(o.flight_status||""),aircraft:o.aircraft?.iata,delay:o.departure?.delay}))}mapAPIStatus(t){return{scheduled:"scheduled",active:"active",landed:"arrived",delayed:"delayed",cancelled:"cancelled",diverted:"diverted"}[t]||"scheduled"}getMockFlights(t){return this.flights.get(t.toUpperCase())||[]}getDepartures(t,o){let l=this.flights.get(t.toUpperCase())||[];return l=l.filter(h=>h.origin.code===t.toUpperCase()),o&&(l=this.applyFilters(l,o)),l.sort((h,v)=>new Date(h.scheduledDeparture).getTime()-new Date(v.scheduledDeparture).getTime())}getArrivals(t,o){let l=this.flights.get(t.toUpperCase())||[];return l=l.filter(h=>h.destination.code===t.toUpperCase()),o&&(l=this.applyFilters(l,o)),l.sort((h,v)=>new Date(h.scheduledArrival).getTime()-new Date(v.scheduledArrival).getTime())}getFlightByNumber(t,o){return(this.flights.get(o.toUpperCase())||[]).find(h=>h.flightNumber===t.toUpperCase())}getFlightsByGate(t,o){return(this.flights.get(o.toUpperCase())||[]).filter(h=>h.gate===t)}getGateInfo(t,o){const l=this.getFlightsByGate(t,o),h=DI(o);if(!h)return null;let v="",w="available";for(const I of h.terminals){const L=I.gates.find(k=>k.number===t);if(L){v=I.name,w=L.status;break}}const a=l.find(I=>I.status==="boarding"||I.status==="active"),C=l.filter(I=>I.status==="scheduled").sort((I,L)=>new Date(I.scheduledDeparture).getTime()-new Date(L.scheduledDeparture).getTime()).slice(0,3);return{gate:t,terminal:v,currentFlight:a,nextFlights:C,status:w,amenities:[]}}getConnectionInfo(t,o,l){const h=DI(l),v={fromGate:t,toGate:o,walkingTime:10,distance:500,path:[],minimumConnectionTime:45,riskLevel:"low"};if(!h)return v;let w="",a="",C=null,I=null;for(const q of h.terminals){const Q=q.gates.find(K=>K.number===t),H=q.gates.find(K=>K.number===o);Q&&(w=q.name,C=Q.coordinates),H&&(a=q.name,I=H.coordinates)}let L=10,k=500,G="low";if(C&&I){const q=Math.abs(C[1]-I[1]),Q=Math.abs(C[0]-I[0]);k=Math.sqrt(q*q+Q*Q)*111e3,L=Math.max(5,Math.ceil(k/80))}return w!==a&&(L+=15,k+=1e3),L>20?G="high":L>12&&(G="medium"),{fromGate:t,toGate:o,walkingTime:L,distance:k,path:C&&I?[C,I]:[],minimumConnectionTime:w===a?45:60,riskLevel:G}}applyFilters(t,o){return t.filter(l=>!(o.airline&&!l.airline.code.toLowerCase().includes(o.airline.toLowerCase())&&!l.airline.name.toLowerCase().includes(o.airline.toLowerCase())||o.destination&&!l.destination.city.toLowerCase().includes(o.destination.toLowerCase())&&!l.destination.code.toLowerCase().includes(o.destination.toLowerCase())||o.origin&&!l.origin.city.toLowerCase().includes(o.origin.toLowerCase())&&!l.origin.code.toLowerCase().includes(o.origin.toLowerCase())||o.status&&l.status!==o.status||o.gate&&l.gate!==o.gate||o.terminal&&l.terminal!==o.terminal))}getStatusColor(t){return{scheduled:"#9AA3B2",active:"#22D3EE",landed:"#39FF14",delayed:"#F59E0B",cancelled:"#F43F5E",diverted:"#8B5CF6",boarding:"#39FF14",departed:"#22D3EE",arrived:"#39FF14","on-time":"#39FF14"}[t]||"#9AA3B2"}formatTime(t){return new Date(t).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}formatDuration(t){const o=Math.floor(t/60),l=t%60;return`${o}h ${l}m`}destroy(){this.updateInterval&&clearInterval(this.updateInterval)}}const Pd=new VW;var pA={exports:{}},GW=pA.exports,B5;function $W(){return B5||(B5=1,(function(r,t){(function(o,l){r.exports=l()})(GW,(function(){var o,l,h;function v(a,C){if(!o)o=C;else if(!l)l=C;else{var I="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+o+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",L={};o(L),h=C(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}v(["exports"],function(a){var C=1e-6,I=typeof Float32Array<"u"?Float32Array:Array;function L(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=i*g-f*c;return y?(s[0]=g*(y=1/y),s[1]=-c*y,s[2]=-f*y,s[3]=i*y,s):null}function k(){var s=new I(9);return I!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function G(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=e[4],b=e[5],E=e[6],M=e[7],R=e[8];return s[0]=y*R-b*M,s[1]=f*M-c*R,s[2]=c*b-f*y,s[3]=b*E-g*R,s[4]=i*R-f*E,s[5]=f*g-i*b,s[6]=g*M-y*E,s[7]=c*E-i*M,s[8]=i*y-c*g,s}function q(s,e,i){var c=e[0],f=e[1],g=e[2],y=e[3],b=e[4],E=e[5],M=e[6],R=e[7],z=e[8],B=i[0],j=i[1],V=i[2],Y=i[3],re=i[4],J=i[5],oe=i[6],ce=i[7],pe=i[8];return s[0]=B*c+j*y+V*M,s[1]=B*f+j*b+V*R,s[2]=B*g+j*E+V*z,s[3]=Y*c+re*y+J*M,s[4]=Y*f+re*b+J*R,s[5]=Y*g+re*E+J*z,s[6]=oe*c+ce*y+pe*M,s[7]=oe*f+ce*b+pe*R,s[8]=oe*g+ce*E+pe*z,s}function Q(){var s=new I(16);return I!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s}function H(s){var e=new I(16);return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],e}function K(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function he(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=e[4],b=e[5],E=e[6],M=e[7],R=e[8],z=e[9],B=e[10],j=e[11],V=e[12],Y=e[13],re=e[14],J=e[15],oe=i*b-c*y,ce=i*E-f*y,pe=i*M-g*y,Se=c*E-f*b,we=c*M-g*b,Ie=f*M-g*E,Pe=R*Y-z*V,Oe=R*re-B*V,ke=R*J-j*V,Ge=z*re-B*Y,pt=z*J-j*Y,ct=B*J-j*re,dt=oe*ct-ce*pt+pe*Ge+Se*ke-we*Oe+Ie*Pe;return dt?(s[0]=(b*ct-E*pt+M*Ge)*(dt=1/dt),s[1]=(f*pt-c*ct-g*Ge)*dt,s[2]=(Y*Ie-re*we+J*Se)*dt,s[3]=(B*we-z*Ie-j*Se)*dt,s[4]=(E*ke-y*ct-M*Oe)*dt,s[5]=(i*ct-f*ke+g*Oe)*dt,s[6]=(re*pe-V*Ie-J*ce)*dt,s[7]=(R*Ie-B*pe+j*ce)*dt,s[8]=(y*pt-b*ke+M*Pe)*dt,s[9]=(c*ke-i*pt-g*Pe)*dt,s[10]=(V*we-Y*pe+J*oe)*dt,s[11]=(z*pe-R*we-j*oe)*dt,s[12]=(b*Oe-y*Ge-E*Pe)*dt,s[13]=(i*Ge-c*Oe+f*Pe)*dt,s[14]=(Y*ce-V*Se-re*oe)*dt,s[15]=(R*Se-z*ce+B*oe)*dt,s):null}function ue(s,e,i){var c=e[0],f=e[1],g=e[2],y=e[3],b=e[4],E=e[5],M=e[6],R=e[7],z=e[8],B=e[9],j=e[10],V=e[11],Y=e[12],re=e[13],J=e[14],oe=e[15],ce=i[0],pe=i[1],Se=i[2],we=i[3];return s[0]=ce*c+pe*b+Se*z+we*Y,s[1]=ce*f+pe*E+Se*B+we*re,s[2]=ce*g+pe*M+Se*j+we*J,s[3]=ce*y+pe*R+Se*V+we*oe,s[4]=(ce=i[4])*c+(pe=i[5])*b+(Se=i[6])*z+(we=i[7])*Y,s[5]=ce*f+pe*E+Se*B+we*re,s[6]=ce*g+pe*M+Se*j+we*J,s[7]=ce*y+pe*R+Se*V+we*oe,s[8]=(ce=i[8])*c+(pe=i[9])*b+(Se=i[10])*z+(we=i[11])*Y,s[9]=ce*f+pe*E+Se*B+we*re,s[10]=ce*g+pe*M+Se*j+we*J,s[11]=ce*y+pe*R+Se*V+we*oe,s[12]=(ce=i[12])*c+(pe=i[13])*b+(Se=i[14])*z+(we=i[15])*Y,s[13]=ce*f+pe*E+Se*B+we*re,s[14]=ce*g+pe*M+Se*j+we*J,s[15]=ce*y+pe*R+Se*V+we*oe,s}function me(s,e,i){var c,f,g,y,b,E,M,R,z,B,j,V,Y=i[0],re=i[1],J=i[2];return e===s?(s[12]=e[0]*Y+e[4]*re+e[8]*J+e[12],s[13]=e[1]*Y+e[5]*re+e[9]*J+e[13],s[14]=e[2]*Y+e[6]*re+e[10]*J+e[14],s[15]=e[3]*Y+e[7]*re+e[11]*J+e[15]):(f=e[1],g=e[2],y=e[3],b=e[4],E=e[5],M=e[6],R=e[7],z=e[8],B=e[9],j=e[10],V=e[11],s[0]=c=e[0],s[1]=f,s[2]=g,s[3]=y,s[4]=b,s[5]=E,s[6]=M,s[7]=R,s[8]=z,s[9]=B,s[10]=j,s[11]=V,s[12]=c*Y+b*re+z*J+e[12],s[13]=f*Y+E*re+B*J+e[13],s[14]=g*Y+M*re+j*J+e[14],s[15]=y*Y+R*re+V*J+e[15]),s}function ge(s,e,i){var c=i[0],f=i[1],g=i[2];return s[0]=e[0]*c,s[1]=e[1]*c,s[2]=e[2]*c,s[3]=e[3]*c,s[4]=e[4]*f,s[5]=e[5]*f,s[6]=e[6]*f,s[7]=e[7]*f,s[8]=e[8]*g,s[9]=e[9]*g,s[10]=e[10]*g,s[11]=e[11]*g,s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15],s}function se(s,e,i){var c=Math.sin(i),f=Math.cos(i),g=e[4],y=e[5],b=e[6],E=e[7],M=e[8],R=e[9],z=e[10],B=e[11];return e!==s&&(s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[4]=g*f+M*c,s[5]=y*f+R*c,s[6]=b*f+z*c,s[7]=E*f+B*c,s[8]=M*f-g*c,s[9]=R*f-y*c,s[10]=z*f-b*c,s[11]=B*f-E*c,s}function fe(s,e,i){var c=Math.sin(i),f=Math.cos(i),g=e[0],y=e[1],b=e[2],E=e[3],M=e[8],R=e[9],z=e[10],B=e[11];return e!==s&&(s[4]=e[4],s[5]=e[5],s[6]=e[6],s[7]=e[7],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[0]=g*f-M*c,s[1]=y*f-R*c,s[2]=b*f-z*c,s[3]=E*f-B*c,s[8]=g*c+M*f,s[9]=y*c+R*f,s[10]=b*c+z*f,s[11]=E*c+B*f,s}function ve(s,e,i){var c=Math.sin(i),f=Math.cos(i),g=e[0],y=e[1],b=e[2],E=e[3],M=e[4],R=e[5],z=e[6],B=e[7];return e!==s&&(s[8]=e[8],s[9]=e[9],s[10]=e[10],s[11]=e[11],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[0]=g*f+M*c,s[1]=y*f+R*c,s[2]=b*f+z*c,s[3]=E*f+B*c,s[4]=M*f-g*c,s[5]=R*f-y*c,s[6]=z*f-b*c,s[7]=B*f-E*c,s}function Le(s,e){return s[0]=e[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=e[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=e[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Ue(s,e,i){var c,f,g,y=i[0],b=i[1],E=i[2],M=Math.sqrt(y*y+b*b+E*E);return M<C?null:(y*=M=1/M,b*=M,E*=M,c=Math.sin(e),f=Math.cos(e),s[0]=y*y*(g=1-f)+f,s[1]=b*y*g+E*c,s[2]=E*y*g-b*c,s[3]=0,s[4]=y*b*g-E*c,s[5]=b*b*g+f,s[6]=E*b*g+y*c,s[7]=0,s[8]=y*E*g+b*c,s[9]=b*E*g-y*c,s[10]=E*E*g+f,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}function tt(s,e){var i=e[0],c=e[1],f=e[2],g=e[4],y=e[5],b=e[6],E=e[8],M=e[9],R=e[10];return s[0]=Math.sqrt(i*i+c*c+f*f),s[1]=Math.sqrt(g*g+y*y+b*b),s[2]=Math.sqrt(E*E+M*M+R*R),s}function Ke(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=i+i,b=c+c,E=f+f,M=i*y,R=c*y,z=c*b,B=f*y,j=f*b,V=f*E,Y=g*y,re=g*b,J=g*E;return s[0]=1-z-V,s[1]=R+J,s[2]=B-re,s[3]=0,s[4]=R-J,s[5]=1-M-V,s[6]=j+Y,s[7]=0,s[8]=B+re,s[9]=j-Y,s[10]=1-M-z,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}var nt=ue;function st(){var s=new I(3);return I!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Rt(s){var e=new I(3);return e[0]=s[0],e[1]=s[1],e[2]=s[2],e}function Mt(s){var e=s[0],i=s[1],c=s[2];return Math.sqrt(e*e+i*i+c*c)}function $e(s,e,i){var c=new I(3);return c[0]=s,c[1]=e,c[2]=i,c}function rt(s,e,i,c){return s[0]=e,s[1]=i,s[2]=c,s}function Ct(s,e,i){return s[0]=e[0]+i[0],s[1]=e[1]+i[1],s[2]=e[2]+i[2],s}function Kt(s,e,i){return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s[2]=e[2]-i[2],s}function Je(s,e,i){return s[0]=e[0]*i[0],s[1]=e[1]*i[1],s[2]=e[2]*i[2],s}function Ze(s,e,i){return s[0]=Math.min(e[0],i[0]),s[1]=Math.min(e[1],i[1]),s[2]=Math.min(e[2],i[2]),s}function gt(s,e,i){return s[0]=Math.max(e[0],i[0]),s[1]=Math.max(e[1],i[1]),s[2]=Math.max(e[2],i[2]),s}function Bt(s,e,i){return s[0]=e[0]*i,s[1]=e[1]*i,s[2]=e[2]*i,s}function ar(s,e,i,c){return s[0]=e[0]+i[0]*c,s[1]=e[1]+i[1]*c,s[2]=e[2]+i[2]*c,s}function Er(s,e){var i=e[0]-s[0],c=e[1]-s[1],f=e[2]-s[2];return Math.sqrt(i*i+c*c+f*f)}function jr(s,e){var i=e[0]-s[0],c=e[1]-s[1],f=e[2]-s[2];return i*i+c*c+f*f}function Zr(s){var e=s[0],i=s[1],c=s[2];return e*e+i*i+c*c}function fn(s,e){return s[0]=-e[0],s[1]=-e[1],s[2]=-e[2],s}function Xt(s,e){var i=e[0],c=e[1],f=e[2],g=i*i+c*c+f*f;return g>0&&(g=1/Math.sqrt(g)),s[0]=e[0]*g,s[1]=e[1]*g,s[2]=e[2]*g,s}function Mr(s,e){return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]}function kr(s,e,i){var c=e[0],f=e[1],g=e[2],y=i[0],b=i[1],E=i[2];return s[0]=f*E-g*b,s[1]=g*y-c*E,s[2]=c*b-f*y,s}function or(s,e,i,c){var f=e[0],g=e[1],y=e[2];return s[0]=f+c*(i[0]-f),s[1]=g+c*(i[1]-g),s[2]=y+c*(i[2]-y),s}function Tr(s,e,i){var c=e[0],f=e[1],g=e[2],y=i[3]*c+i[7]*f+i[11]*g+i[15];return s[0]=(i[0]*c+i[4]*f+i[8]*g+i[12])/(y=y||1),s[1]=(i[1]*c+i[5]*f+i[9]*g+i[13])/y,s[2]=(i[2]*c+i[6]*f+i[10]*g+i[14])/y,s}function Ur(s,e,i){var c=e[0],f=e[1],g=e[2];return s[0]=c*i[0]+f*i[3]+g*i[6],s[1]=c*i[1]+f*i[4]+g*i[7],s[2]=c*i[2]+f*i[5]+g*i[8],s}function zn(s,e,i){var c=i[0],f=i[1],g=i[2],y=i[3],b=e[0],E=e[1],M=e[2],R=f*M-g*E,z=g*b-c*M,B=c*E-f*b;return s[0]=b+y*(R+=R)+f*(B+=B)-g*(z+=z),s[1]=E+y*z+g*R-c*B,s[2]=M+y*B+c*z-f*R,s}function Fn(s){return s[0]=0,s[1]=0,s[2]=0,s}function Ut(s,e){return s[0]===e[0]&&s[1]===e[1]&&s[2]===e[2]}var _n=Kt,ua=Je,da=Mt;function Yn(){var s=new I(4);return I!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0),s}function ha(s,e,i){return s[0]=e[0]*i,s[1]=e[1]*i,s[2]=e[2]*i,s[3]=e[3]*i,s}function go(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=i*i+c*c+f*f+g*g;return y>0&&(y=1/Math.sqrt(y)),s[0]=i*y,s[1]=c*y,s[2]=f*y,s[3]=g*y,s}function ni(s,e){return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]+s[3]*e[3]}function ii(s,e,i){var c=e[0],f=e[1],g=e[2],y=e[3];return s[0]=i[0]*c+i[4]*f+i[8]*g+i[12]*y,s[1]=i[1]*c+i[5]*f+i[9]*g+i[13]*y,s[2]=i[2]*c+i[6]*f+i[10]*g+i[14]*y,s[3]=i[3]*c+i[7]*f+i[11]*g+i[15]*y,s}function no(){var s=new I(4);return I!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ai(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function ga(s,e,i){i*=.5;var c=e[0],f=e[1],g=e[2],y=e[3],b=Math.sin(i),E=Math.cos(i);return s[0]=c*E+y*b,s[1]=f*E+g*b,s[2]=g*E-f*b,s[3]=y*E-c*b,s}function Ha(s,e,i){i*=.5;var c=e[0],f=e[1],g=e[2],y=e[3],b=Math.sin(i),E=Math.cos(i);return s[0]=c*E-g*b,s[1]=f*E+y*b,s[2]=g*E+c*b,s[3]=y*E-f*b,s}st(),Yn();var Zi,cl,fi,Cs=go,Ci=(Zi=st(),cl=$e(1,0,0),fi=$e(0,1,0),function(s,e,i){var c=Mr(e,i);return c<-.999999?(kr(Zi,cl,e),da(Zi)<1e-6&&kr(Zi,fi,e),Xt(Zi,Zi),(function(f,g,y){y*=.5;var b=Math.sin(y);f[0]=b*g[0],f[1]=b*g[1],f[2]=b*g[2],f[3]=Math.cos(y)})(s,Zi,Math.PI),s):c>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(kr(Zi,e,i),s[0]=Zi[0],s[1]=Zi[1],s[2]=Zi[2],s[3]=1+c,Cs(s,s))});function Ti(){var s=new I(2);return I!=Float32Array&&(s[0]=0,s[1]=0),s}function qi(s,e){var i=new I(2);return i[0]=s,i[1]=e,i}function _o(s,e,i){return s[0]=e,s[1]=i,s}function $o(s,e,i){return s[0]=e[0]+i[0],s[1]=e[1]+i[1],s}function Mn(s,e,i){return s[0]=e[0]-i[0],s[1]=e[1]-i[1],s}function io(s,e,i){return s[0]=e[0]*i,s[1]=e[1]*i,s}function _a(s){var e=s[0],i=s[1];return Math.sqrt(e*e+i*i)}function La(s,e){var i=e[0],c=e[1],f=i*i+c*c;return f>0&&(f=1/Math.sqrt(f)),s[0]=e[0]*f,s[1]=e[1]*f,s}function pn(s,e){return s[0]*e[0]+s[1]*e[1]}no(),no(),k();var Bi,as,qo=Mn;function Xa(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}Ti();var Tn=(function(){if(as)return Bi;function s(e,i,c,f){this.cx=3*e,this.bx=3*(c-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(f-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=i,this.p2x=c,this.p2y=f}return as=1,Bi=s,s.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,i){if(i===void 0&&(i=1e-6),e<0)return 0;if(e>1)return 1;for(var c=e,f=0;f<8;f++){var g=this.sampleCurveX(c)-e;if(Math.abs(g)<i)return c;var y=this.sampleCurveDerivativeX(c);if(Math.abs(y)<1e-6)break;c-=g/y}var b=0,E=1;for(c=e,f=0;f<20&&(g=this.sampleCurveX(c),!(Math.abs(g-e)<i));f++)e>g?b=c:E=c,c=.5*(E-b)+b;return c},solve:function(e,i){return this.sampleCurveY(this.solveCurveX(e,i))}},Bi})(),Jr=Xa(Tn);function yt(s,e){this.x=s,this.y=e}function Or(s,e){if(Array.isArray(s)){if(!Array.isArray(e)||s.length!==e.length)return!1;for(let i=0;i<s.length;i++)if(!Or(s[i],e[i]))return!1;return!0}if(typeof s=="object"&&s!==null&&e!==null){if(typeof e!="object"||Object.keys(s).length!==Object.keys(e).length)return!1;for(const i in s)if(!Or(s[i],e[i]))return!1;return!0}return s===e}yt.prototype={clone(){return new yt(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,e){return this.clone()._rotateAround(s,e)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const e=s.x-this.x,i=s.y-this.y;return e*e+i*i},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,e){return Math.atan2(this.x*e-this.y*s,this.x*s+this.y*e)},_matMult(s){const e=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=e,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const e=Math.cos(s),i=Math.sin(s),c=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=c,this},_rotateAround(s,e){const i=Math.cos(s),c=Math.sin(s),f=e.y+c*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-c*(this.y-e.y),this.y=f,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:yt},yt.convert=function(s){if(s instanceof yt)return s;if(Array.isArray(s))return new yt(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new yt(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};const Sn=Math.PI/180,an=180/Math.PI;function yr(s){return s*Sn}function Xe(s){return s*an}const ie=[[0,0],[1,0],[1,1],[0,1]];function de(s){if(s<=0)return 0;if(s>=1)return 1;const e=s*s,i=e*s;return 4*(s<.5?i:3*(s-e)+i-.75)}function Ae(s,e,i,c){const f=new Jr(s,e,i,c);return function(g){return f.solve(g)}}const ze=Ae(.25,.1,.25,1);function Ee(s,e,i){return Math.min(i,Math.max(e,s))}function Fe(s,e,i){return(i=Ee((i-s)/(e-s),0,1))*i*(3-2*i)}function it(s,e,i){const c=i-e,f=((s-e)%c+c)%c+e;return f===e?i:f}function qe(s,e,i){if(!s.length)return i(null,[]);let c=s.length;const f=new Array(s.length);let g=null;s.forEach((y,b)=>{e(y,(E,M)=>{E&&(g=E),f[b]=M,--c===0&&i(g,f)})})}let at=1;function Dt(){return at++}function vt(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log2(s)))}function Wt(s,e){s.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function dr(s,e,i){const c={};for(const f in s)c[f]=e.call(this,s[f],f,s);return c}function vr(s,e,i){const c={};for(const f in s)e.call(this,s[f],f,s)&&(c[f]=s[f]);return c}function Br(s){return Array.isArray(s)?s.map(Br):typeof s=="object"&&s?dr(s,Br):s}function Sr(s,e){for(let i=0;i<s.length;i++)if(e.indexOf(s[i])>=0)return!0;return!1}const fr={};function br(s){fr[s]||(typeof console<"u"&&console.warn(s),fr[s]=!0)}function Vn(s,e,i){return(i.y-s.y)*(e.x-s.x)>(e.y-s.y)*(i.x-s.x)}function yi(s){let e=0;for(let i,c,f=0,g=s.length,y=g-1;f<g;y=f++)i=s[f],c=s[y],e+=(c.x-i.x)*(i.y+c.y);return e}function Xn([s,e,i]){const c=yr(e+90),f=yr(i);return{x:s*Math.cos(c)*Math.sin(f),y:s*Math.sin(c)*Math.sin(f),z:s*Math.cos(f),azimuthal:e,polar:i}}function Zn(s){return(typeof self<"u"||s!==void 0)&&typeof WorkerGlobalScope<"u"&&(s!==void 0?s:self)instanceof WorkerGlobalScope}function qn(s){const e={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,c,f,g)=>{const y=f||g;return e[c]=!y||y.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let on=null;function Gn(s,e){return[s[4*e],s[4*e+1],s[4*e+2],s[4*e+3]]}function Nn(s,e,i,c){for(;e<i;){const f=e+i>>1;s[f]<c?e=f+1:i=f}return e}function jn(s,e,i,c){for(;e<i;){const f=e+i>>1;s[f]<=c?e=f+1:i=f}return e}function ti(s){return s>0?1/(1.001-s):1+s}function ki(s){return s>0?1-1/(1.001-s):-s}function Ba(s,e,i){return(s-e.min)*(i.max-i.min)/(e.max-e.min)+i.min}const ya={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ya.API_URL)return null;try{const s=new URL(ya.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.4.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function gc(s){return ya.API_URL_REGEX.test(s)}function yo(s){return ya.API_SPRITE_REGEX.test(s)}let Io,ul,Sa,Ho,Po,zl;function hl(){return Io==null&&(Io=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Io}const Is={now:()=>Ho!==void 0?Ho:performance.now(),setNow(s){Ho=s},restoreNow(){Ho=void 0},frame(s){const e=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(s,e=0){const{width:i,height:c}=s;Po||(Po=document.createElement("canvas"));const f=Po.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(i>Po.width||c>Po.height)&&(Po.width=i,Po.height=c),f.clearRect(-e,-e,i+2*e,c+2*e),f.drawImage(s,0,0,i,c),f.getImageData(-e,-e,i+2*e,c+2*e)},resolveURL:s=>(ul||(ul=document.createElement("a")),ul.href=s,ul.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Sa==null&&(Sa=window.matchMedia("(prefers-reduced-motion: reduce)")),Sa.matches)},hasCanvasFingerprintNoise(){if(zl!==void 0)return zl;if(!hl())return zl=!1,!1;const s=new OffscreenCanvas(85,1),e=s.getContext("2d",{willReadFrequently:!0});let i=0;for(let f=0;f<s.width;++f)e.fillStyle=`rgba(${i++},${i++},${i++}, 255)`,e.fillRect(f,0,1,1);const c=e.getImageData(0,0,s.width,s.height);i=0;for(let f=0;f<c.data.length;++f)if(f%4!=3&&i++!==c.data[f])return zl=!0,!0;return zl=!1,!1}};function zd(s,e){const i=s.indexOf("?");if(i<0)return`${s}?${new URLSearchParams(e).toString()}`;const c=new URLSearchParams(s.slice(i));for(const f in e)c.set(f,e[f]);return`${s.slice(0,i)}?${c.toString()}`}function _c(s,e={persistentParams:[]}){const i=s.indexOf("?");if(i<0)return s;const c=new URLSearchParams,f=new URLSearchParams(s.slice(i));for(const y of e.persistentParams){const b=f.get(y);b&&c.set(y,b)}const g=c.toString();return`${s.slice(0,i)}${g.length>0?`?${g}`:""}`}const ov="mapbox-tiles";let t_=500,Am=50;const Kf=["language","worldview","jobid"];let Za,Zs;function dl(){try{return caches}catch{}}function ka(){const s=dl();s&&Za==null&&(Za=s.open(ov))}let fl=1/0;const Gu={supported:!1,testSupport:function(s){!Wc&&pl&&(Ld?Bd(s):Ll=s)}};let Ll,pl,Wc=!1,Ld=!1;const r_=typeof self<"u"?self:{};function Bd(s){const e=s.createTexture();s.bindTexture(s.TEXTURE_2D,e);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,pl),s.isContextLost())return;Gu.supported=!0}catch{}s.deleteTexture(e),Wc=!0}r_.document&&(pl=r_.document.createElement("img"),pl.onload=function(){Ll&&Bd(Ll),Ll=null,Ld=!0},pl.onerror=function(){Wc=!0,Ll=null},pl.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const va={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(va);class Bh extends Error{constructor(e,i,c){i===401&&gc(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Yc=Zn()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Xo=function(s,e){if(!(/^file:/.test(i=s.url)||/^file:/.test(Yc())&&!/^\w+:/.test(i))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(c,f){const g=new AbortController,y=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Yc(),referrerPolicy:c.referrerPolicy,signal:g.signal});let b=!1,E=!1;const M=(R=y.url).indexOf("sku=")>0&&gc(R);var R;c.type==="json"&&y.headers.set("Accept","application/json");const z=(j,V,Y)=>{if(E)return;if(j&&j.message!=="SecurityError"&&br(j.toString()),V&&Y)return B(V);const re=Date.now();fetch(y).then(J=>{if(J.ok){const oe=M?J.clone():null;return B(J,oe,re)}return f(new Bh(J.statusText,J.status,c.url))}).catch(J=>{J.name!=="AbortError"&&f(new Error(`${J.message} ${c.url}`))})},B=(j,V,Y)=>{(c.type==="arrayBuffer"?j.arrayBuffer():c.type==="json"?j.json():j.text()).then(re=>{E||(V&&Y&&(function(J,oe,ce){if(ka(),Za==null)return;const pe=qn(oe.headers.get("Cache-Control")||"");if(pe["no-store"])return;const Se={status:oe.status,statusText:oe.statusText,headers:new Headers};oe.headers.forEach((Pe,Oe)=>Se.headers.set(Oe,Pe)),pe["max-age"]&&Se.headers.set("Expires",new Date(ce+1e3*pe["max-age"]).toUTCString());const we=Se.headers.get("Expires");if(!we||new Date(we).getTime()-ce<42e4)return;let Ie=_c(J.url,{persistentParams:Kf});if(oe.status===206){const Pe=J.headers.get("Range");if(!Pe)return;Se.status=200,Ie=zd(Ie,{range:Pe})}(function(Pe,Oe){if(Zs===void 0)try{new Response(new ReadableStream),Zs=!0}catch{Zs=!1}Zs?Oe(Pe.body):Pe.blob().then(Oe).catch(ke=>br(ke.message))})(oe,Pe=>{const Oe=new Response((ke=oe.status)!==200&&ke!==404&&[101,103,204,205,304].includes(ke)?null:Pe,Se);var ke;ka(),Za?.then(Ge=>Ge.put(Ie,Oe)).catch(Ge=>br(Ge.message))})})(y,V,Y),b=!0,f(null,re,j.headers))}).catch(re=>{E||f(new Error(re.message))})};return M?(function(j,V){if(ka(),Za==null)return V(null);Za.then(Y=>{let re=_c(j.url,{persistentParams:Kf});const J=j.headers.get("Range");J&&(re=zd(re,{range:J})),Y.match(re).then(oe=>{const ce=(function(pe){if(!pe)return!1;const Se=new Date(pe.headers.get("Expires")||0),we=qn(pe.headers.get("Cache-Control")||"");return Number(Se)>Date.now()&&!we["no-cache"]})(oe);Y.delete(re).catch(V),ce&&Y.put(re,oe.clone()).catch(V),V(null,oe,ce)}).catch(V)}).catch(V)})(y,z):z(null,null),{cancel:()=>{E=!0,b||g.abort()}}})(s,e);if(Zn(self)&&self.worker.actor)return self.worker.actor.send("getResource",s,e,void 0,!0)}var i;return(function(c,f){const g=new XMLHttpRequest;g.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const y in c.headers)g.setRequestHeader(y,c.headers[y]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=()=>{f(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let y=g.response;if(c.type==="json")try{y=JSON.parse(g.response)}catch(E){return f(E)}const b=new Headers;g.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach(E=>{const M=E.split(": "),R=M.shift(),z=M.join(": ");b.append(R,z)}),f(null,y,b)}else f(new Bh(g.statusText,g.status,c.url))},g.send(c.body),{cancel:()=>g.abort()}})(s,e)},kh=function(s,e){return Xo(Object.assign(s,{type:"arrayBuffer"}),e)};function Tm(s){const e=document.createElement("a");return e.href=s,e.protocol===location.protocol&&e.host===location.host}const Sm="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let un,Kc;un=[],Kc=0;const Qf=function(s,e){if(Gu.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),Kc>=ya.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:s,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return un.push(g),g}Kc++;let i=!1;const c=()=>{if(!i)for(i=!0,Kc--;un.length&&Kc<ya.MAX_PARALLEL_IMAGE_REQUESTS;){const g=un.shift(),{requestParameters:y,callback:b,cancelled:E}=g;E||(g.cancel=Qf(y,b).cancel)}},f=kh(s,(g,y,b)=>{c(),g?e(g):y&&(self.createImageBitmap?(function(E,M){const R=new Blob([new Uint8Array(E)],{type:"image/png"});createImageBitmap(R).then(z=>{M(null,z)}).catch(z=>{M(new Error(`Could not load image because of ${z.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})})(y,(E,M)=>e(E,M,b)):(function(E,M){const R=new Image;R.onload=()=>{M(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame(()=>{R.src=Sm})},R.onerror=()=>M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Blob([new Uint8Array(E)],{type:"image/png"});R.src=E.byteLength?URL.createObjectURL(z):Sm})(y,(E,M)=>e(E,M,b)))});return{cancel:()=>{f.cancel(),c()}}};var os,$u,qu,ml={exports:{}},Jf={exports:{}},kd={exports:{}},n_=(function(){if(qu)return ml.exports;qu=1;var s=(os||(os=1,Jf.exports=function(i,c){var f,g,y,b,E,M,R,z;for(g=i.length-(f=3&i.length),y=c,E=3432918353,M=461845907,z=0;z<g;)R=255&i.charCodeAt(z)|(255&i.charCodeAt(++z))<<8|(255&i.charCodeAt(++z))<<16|(255&i.charCodeAt(++z))<<24,++z,y=27492+(65535&(b=5*(65535&(y=(y^=R=(65535&(R=(R=(65535&R)*E+(((R>>>16)*E&65535)<<16)&4294967295)<<15|R>>>17))*M+(((R>>>16)*M&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+(((b>>>16)+58964&65535)<<16);switch(R=0,f){case 3:R^=(255&i.charCodeAt(z+2))<<16;case 2:R^=(255&i.charCodeAt(z+1))<<8;case 1:y^=R=(65535&(R=(R=(65535&(R^=255&i.charCodeAt(z)))*E+(((R>>>16)*E&65535)<<16)&4294967295)<<15|R>>>17))*M+(((R>>>16)*M&65535)<<16)&4294967295}return y^=i.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),Jf.exports),e=($u||($u=1,kd.exports=function(i,c){for(var f,g=i.length,y=c^g,b=0;g>=4;)f=1540483477*(65535&(f=255&i.charCodeAt(b)|(255&i.charCodeAt(++b))<<8|(255&i.charCodeAt(++b))<<16|(255&i.charCodeAt(++b))<<24))+((1540483477*(f>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),g-=4,++b;switch(g){case 3:y^=(255&i.charCodeAt(b+2))<<16;case 2:y^=(255&i.charCodeAt(b+1))<<8;case 1:y=1540483477*(65535&(y^=255&i.charCodeAt(b)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),kd.exports);return ml.exports=s,ml.exports.murmur3=s,ml.exports.murmur2=e,ml.exports})(),yc=Xa(n_);class gl{constructor(e,...i){Object.assign(this,i[0]||{}),this.type=e}}class Fd extends gl{constructor(e,i={}){super("error",Object.assign({error:e},i))}}function sv(s,e,i){i[s]&&i[s].indexOf(e)!==-1||(i[s]=i[s]||[],i[s].push(e))}function Fh(s,e,i){if(i&&i[s]){const c=i[s].indexOf(e);c!==-1&&i[s].splice(c,1)}}class Qc{on(e,i){return this._listeners=this._listeners||{},sv(e,i,this._listeners),this}off(e,i){return Fh(e,i,this._listeners),Fh(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},sv(e,i,this._oneTimeListeners),this):new Promise(c=>{this.once(e,c)})}fire(e,i){const c=typeof e=="string"?new gl(e,i):e,f=c.type;if(this.listens(f)){c.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const E of g)E.call(this,c);const y=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const E of y)Fh(f,E,this._oneTimeListeners),E.call(this,c);const b=this._eventedParent;if(b){const E=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(c,E),b.fire(c)}}else c instanceof Fd&&console.error(c.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}class Do{constructor(e){typeof e=="string"?this.name=e:(this.name=e.name,this.iconsetId=e.iconsetId)}static from(e){return new Do(e)}static toString(e){return e.iconsetId?`${e.name}${e.iconsetId}`:e.name}static parse(e){const[i,c]=e.split("");return new Do({name:i,iconsetId:c})}static isEqual(e,i){return e.name===i.name&&e.iconsetId===i.iconsetId}toString(){return Do.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var _l,Em={},lv=(function(){if(_l)return Em;_l=1;var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function e(g){return(g=Math.round(g))<0?0:g>255?255:g}function i(g){return e(g[g.length-1]==="%"?parseFloat(g)/100*255:parseInt(g))}function c(g){return(y=g[g.length-1]==="%"?parseFloat(g)/100:parseFloat(g))<0?0:y>1?1:y;var y}function f(g,y,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?g+(y-g)*b*6:2*b<1?y:3*b<2?g+(y-g)*(2/3-b)*6:g}try{Em.parseCSSColor=function(g){var y,b=g.replace(/ /g,"").toLowerCase();if(b in s)return s[b].slice();if(b[0]==="#")return b.length===4?(y=parseInt(b.substr(1),16))>=0&&y<=4095?[(3840&y)>>4|(3840&y)>>8,240&y|(240&y)>>4,15&y|(15&y)<<4,1]:null:b.length===7&&(y=parseInt(b.substr(1),16))>=0&&y<=16777215?[(16711680&y)>>16,(65280&y)>>8,255&y,1]:null;var E=b.indexOf("("),M=b.indexOf(")");if(E!==-1&&M+1===b.length){var R=b.substr(0,E),z=b.substr(E+1,M-(E+1)).split(","),B=1;switch(R){case"rgba":if(z.length!==4)return null;B=c(z.pop());case"rgb":return z.length!==3?null:[i(z[0]),i(z[1]),i(z[2]),B];case"hsla":if(z.length!==4)return null;B=c(z.pop());case"hsl":if(z.length!==3)return null;var j=(parseFloat(z[0])%360+360)%360/360,V=c(z[1]),Y=c(z[2]),re=Y<=.5?Y*(V+1):Y+V-Y*V,J=2*Y-re;return[e(255*f(J,re,j+1/3)),e(255*f(J,re,j)),e(255*f(J,re,j-1/3)),B];default:return null}}return null}}catch{}return Em})();class Cn{constructor(e,i,c,f=1){this.r=e,this.g=i,this.b=c,this.a=f}static parse(e){if(!e)return;if(e instanceof Cn)return e;if(typeof e!="string")return;const i=lv.parseCSSColor(e);return i?new Cn(i[0]/255,i[1]/255,i[2]/255,i[3]):void 0}toString(){const[e,i,c,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*e)},${Math.round(255*i)},${Math.round(255*c)},${f})`}toNonPremultipliedRenderColor(e){const{r:i,g:c,b:f,a:g}=this;return new a_(e,i,c,f,g)}toPremultipliedRenderColor(e){const{r:i,g:c,b:f,a:g}=this;return new cv(e,i*g,c*g,f*g,g)}clone(){return new Cn(this.r,this.g,this.b,this.a)}}class i_{constructor(e,i,c,f,g,y=!1){if(this.premultiplied=!1,this.premultiplied=y,e){const b=e.image.height,E=b*b;this.premultiplied?(i=g===0?0:i/g*(b-1),c=g===0?0:c/g*(b-1),f=g===0?0:f/g*(b-1)):(i*=b-1,c*=b-1,f*=b-1),i=Math.max(0,Math.min(b-1,i)),c=Math.max(0,Math.min(b-1,c)),f=Math.max(0,Math.min(b-1,f));const M=Math.floor(i),R=Math.floor(c),z=Math.floor(f),B=Math.ceil(i),j=Math.ceil(c),V=Math.ceil(f),Y=i-M,re=c-R,J=f-z,oe=e.image.data,ce=4*(M+R*E+z*b),pe=4*(M+R*E+V*b),Se=4*(M+j*E+z*b),we=4*(M+j*E+V*b),Ie=4*(B+R*E+z*b),Pe=4*(B+R*E+V*b),Oe=4*(B+j*E+z*b),ke=4*(B+j*E+V*b);this.r=Dr(Dr(Dr(oe[ce],oe[pe],J),Dr(oe[Se],oe[we],J),re),Dr(Dr(oe[Ie],oe[Pe],J),Dr(oe[Oe],oe[ke],J),re),Y)/255*(this.premultiplied?g:1),this.g=Dr(Dr(Dr(oe[ce+1],oe[pe+1],J),Dr(oe[Se+1],oe[we+1],J),re),Dr(Dr(oe[Ie+1],oe[Pe+1],J),Dr(oe[Oe+1],oe[ke+1],J),re),Y)/255*(this.premultiplied?g:1),this.b=Dr(Dr(Dr(oe[ce+2],oe[pe+2],J),Dr(oe[Se+2],oe[we+2],J),re),Dr(Dr(oe[Ie+2],oe[Pe+2],J),Dr(oe[Oe+2],oe[ke+2],J),re),Y)/255*(this.premultiplied?g:1),this.a=g}else this.r=i,this.g=c,this.b=f,this.a=g}toArray(){const{r:e,g:i,b:c,a:f}=this;return[255*e,255*i,255*c,f]}toHslaArray(){let{r:e,g:i,b:c,a:f}=this;if(this.premultiplied){if(f===0)return[0,0,0,0];const V=1/f;e*=V,i*=V,c*=V}const g=Math.min(Math.max(e,0),1),y=Math.min(Math.max(i,0),1),b=Math.min(Math.max(c,0),1),E=Math.min(g,y,b),M=Math.max(g,y,b),R=M-E,z=.5*(E+M);if(R===0)return[0,0,100*z,f];const B=z>.5?R/(2-M-E):R/(M+E);let j;switch(M){case g:j=60*((y-b)/R+(y<b?6:0));break;case y:j=60*((b-g)/R+2);break;default:j=60*((g-y)/R+4)}return[j,100*B,100*z,f]}toArray01(){const{r:e,g:i,b:c,a:f}=this;return[e,i,c,f]}toArray01Scaled(e){const{r:i,g:c,b:f}=this;return[i*e,c*e,f*e]}toArray01Linear(){const{r:e,g:i,b:c,a:f}=this;return[Math.pow(e,2.2),Math.pow(i,2.2),Math.pow(c,2.2),f]}}class a_ extends i_{constructor(e,i,c,f,g){super(e,i,c,f,g,!1)}}class cv extends i_{constructor(e,i,c,f,g){super(e,i,c,f,g,!0)}}function Dr(s,e,i){return s*(1-i)+e*i}function o_(s,e,i){return s.map((c,f)=>Dr(c,e[f],i))}Cn.black=new Cn(0,0,0,1),Cn.white=new Cn(1,1,1,1),Cn.transparent=new Cn(0,0,0,0),Cn.red=new Cn(1,0,0,1),Cn.blue=new Cn(0,0,1,1);var Nh=Object.freeze({__proto__:null,array:o_,color:function(s,e,i){return new Cn(Dr(s.r,e.r,i),Dr(s.g,e.g,i),Dr(s.b,e.b,i),Dr(s.a,e.a,i))},number:Dr});class vo extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class Mm{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[c,f]of i)this.bindings[c]=f}concat(e){return new Mm(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ss={kind:"null"},_r={kind:"number"},En={kind:"string"},bn={kind:"boolean"},Zo={kind:"color"},Nd={kind:"object"},Ln={kind:"value"},Om={kind:"collator"},jd={kind:"formatted"},jh={kind:"resolvedImage"};function Ro(s,e){return{kind:"array",itemType:s,N:e}}function Wi(s){if(s.kind==="array"){const e=Wi(s.itemType);return typeof s.N=="number"?`array<${e}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${e}>`}return s.kind}const s_=[ss,_r,En,bn,Zo,jd,Nd,Ro(Ln),jh];function Jc(s,e){if(e.kind==="error")return null;if(s.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Jc(s.itemType,e.itemType))&&(typeof s.N!="number"||s.N===e.N))return null}else{if(s.kind===e.kind)return null;if(s.kind==="value"){for(const i of s_)if(!Jc(i,e))return null}}return`Expected ${Wi(s)} but found ${Wi(e)} instead.`}function l_(s,e){return e.some(i=>i.kind===s.kind)}function Ud(s,e){return e.some(i=>i==="null"?s===null:i==="array"?Array.isArray(s):i==="object"?s&&!Array.isArray(s)&&typeof s=="object":i===typeof s)}function ep(s,e){return s.kind==="array"&&e.kind==="array"?s.N===e.N&&ep(s.itemType,e.itemType):s.kind===e.kind}class Cm{constructor(e,i,c){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class tp{constructor(e,i,c,f,g){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=c,this.fontStack=f,this.textColor=g}}class xo{constructor(e){this.sections=e}static fromString(e){return new xo([new tp(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||!!e.image&&e.image.hasPrimary())}static factory(e){return e instanceof xo?e:xo.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){const f=i.image.getPrimary().id.toString();e.push(["image",f]);continue}e.push(i.text);const c={};i.fontStack&&(c["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(c["font-scale"]=i.scale),i.textColor&&(c["text-color"]=["rgba"].concat(i.textColor.toNonPremultipliedRenderColor(null).toArray())),e.push(c)}return e}}class Wa{constructor(e,i={}){this.id=Do.from(e),this.params=i.params,this.sx=i.sx||1,this.sy=i.sy||1}toString(){return JSON.stringify(this)}static parse(e){let i,c,f,g;try{({id:i,params:c,sx:f,sy:g}=JSON.parse(e)||{})}catch{return null}return i?new Wa(i,{params:c,sx:f,sy:g}):null}scaleSelf(e,i=e){return this.sx*=e,this.sy*=i,this}}class ls{constructor(e,i,c,f,g=!1){this.primaryId=Do.from(e),this.primaryOptions=i,c&&(this.secondaryId=Do.from(c)),this.secondaryOptions=f,this.available=g}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Wa(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Wa(this.secondaryId,this.secondaryOptions):null}static from(e){return typeof e=="string"?ls.build({name:e}):e}static build(e,i,c,f){return!e||typeof e=="object"&&!("name"in e)?null:new ls(e,c,i,f)}}function c_(s,e,i,c){return typeof s=="number"&&s>=0&&s<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[s,e,i,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[s,e,i,c]:[s,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Hu(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Cn||s instanceof Cm||s instanceof xo||s instanceof ls)return!0;if(Array.isArray(s)){for(const e of s)if(!Hu(e))return!1;return!0}if(typeof s=="object"){for(const e in s)if(!Hu(s[e]))return!1;return!0}return!1}function xa(s){if(s===null)return ss;if(typeof s=="string")return En;if(typeof s=="boolean")return bn;if(typeof s=="number")return _r;if(s instanceof Cn)return Zo;if(s instanceof Cm)return Om;if(s instanceof xo)return jd;if(s instanceof ls)return jh;if(Array.isArray(s)){const e=s.length;let i;for(const c of s){const f=xa(c);if(i){if(i===f)continue;i=Ln;break}i=f}return Ro(i||Ln,e)}return Nd}function Bl(s){const e=typeof s;return s===null?"":e==="string"||e==="number"||e==="boolean"?String(s):s instanceof xo||s instanceof ls||s instanceof Cn?s.toString():JSON.stringify(s)}class Ws{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(e.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Hu(e[1]))return i.error("invalid value");const c=e[1];let f=xa(c);const g=i.expectedType;return f.kind!=="array"||f.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(f=g),new Ws(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Cn?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof xo?this.value.serialize():this.value}}class Yi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Xu={string:En,number:_r,boolean:bn,object:Nd};class zr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let c,f=1;const g=e[0];if(g==="array"){let b,E;if(e.length>2){const M=e[1];if(typeof M!="string"||!(M in Xu)||M==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);b=Xu[M],f++}else b=Ln;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);E=e[2],f++}c=Ro(b,E)}else c=Xu[g];const y=[];for(;f<e.length;f++){const b=i.parse(e[f],f,Ln);if(!b)return null;y.push(b)}return new zr(c,y)}evaluate(e){for(let i=0;i<this.args.length;i++){const c=this.args[i].evaluate(e);if(!Jc(this.type,xa(c)))return c;if(i===this.args.length-1)throw new Yi(`The expression ${JSON.stringify(this.args[i].serialize())} evaluated to ${Wi(xa(c))} but was expected to be of type ${Wi(this.type)}.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if(e.kind==="array"){const c=e.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){i.push(c.kind);const f=e.N;(typeof f=="number"||this.args.length>1)&&i.push(f)}}return i.concat(this.args.map(c=>c.serialize()))}}class mr{constructor(e){this.type=jd,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&typeof c=="object")return i.error("First argument must be an image or text section.");const f=[];let g=!1;for(let y=1;y<=e.length-1;++y){const b=e[y];if(g&&typeof b=="object"&&!Array.isArray(b)){g=!1;let E=null;if(b["font-scale"]&&(E=i.parseObjectValue(b["font-scale"],y,"font-scale",_r),!E))return null;let M=null;if(b["text-font"]&&(M=i.parseObjectValue(b["text-font"],y,"text-font",Ro(En)),!M))return null;let R=null;if(b["text-color"]&&(R=i.parseObjectValue(b["text-color"],y,"text-color",Zo),!R))return null;const z=f[f.length-1];z.scale=E,z.font=M,z.textColor=R}else{const E=i.parse(e[y],y,Ln);if(!E)return null;const M=E.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,f.push({content:E,scale:null,font:null,textColor:null})}}return new mr(f)}evaluate(e){return new xo(this.sections.map(i=>{const c=i.content.evaluate(e);return ep(xa(c),jh)?new tp("",c,null,null,null):new tp(Bl(c),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const c={};i.scale&&(c["font-scale"]=i.scale.serialize()),i.font&&(c["text-font"]=i.font.serialize()),i.textColor&&(c["text-color"]=i.textColor.serialize()),e.push(c)}return e}}class Uh{constructor(e,i,c,f){this._imageWarnHistory={},this.type=jh,this.namePrimary=e,this.nameSecondary=i,c&&(this.paramsPrimary=c.params,this.iconsetIdPrimary=c.iconset?c.iconset.id:void 0),f&&(this.paramsSecondary=f.params,this.iconsetIdSecondary=f.iconset?f.iconset.id:void 0)}static parse(e,i){if(e.length<2)return i.error("Expected two or more arguments.");let c=1;const f=[];function g(){if(c<e.length){const b=i.parse(e[c],c++,En);return b?(f.push({image:b,options:{}}),!0):(i.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function y(){if(c<e.length){const E=e[c];if((b=E)===null||typeof b!="object"||Array.isArray(b))return!0;const M=E.params,R=E.iconset,z=i.concat(c);if(!M&&!R)return c++,!0;if(M){if(typeof M!="object"||M.constructor!==Object)return z.error('Image options "params" should be an object'),!1;const B={},j=z.concat(void 0,"params");for(const V in M){if(!V)return j.error("Image parameter name should be non-empty"),!1;const Y=j.concat(void 0,V).parse(M[V],void 0,Zo,void 0,{typeAnnotation:"coerce"});if(!Y)return!1;B[V]=Y}f[f.length-1].options.params=B}if(R){if(typeof R!="object"||R.constructor!==Object)return z.error('Image options "iconset" should be an object'),!1;if(!R.id)return z.error('Image options "iconset" should have an "id" property'),!1;f[f.length-1].options.iconset=R}return c++,!0}var b;return!0}for(let b=0;b<2;b++)if(!g()||!y())return;return new Uh(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(e,i){const c={};if(i){for(const f in i)if(i[f])try{c[f]=i[f].evaluate(e)}catch{continue}if(Object.keys(c).length!==0)return{params:c}}}evaluate(e){const i={name:this.namePrimary.evaluate(e),iconsetId:this.iconsetIdPrimary},c=this.nameSecondary?{name:this.nameSecondary.evaluate(e),iconsetId:this.iconsetIdSecondary}:void 0,f=ls.build(i,c,this.paramsPrimary?this.evaluateParams(e,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(e,this.paramsSecondary):void 0);if(f&&e.availableImages){const g=f.getPrimary().id;if(f.available=e.availableImages.some(y=>Do.isEqual(y,g)),f.available){const y=f.getSecondary()?f.getSecondary().id:null;y&&(f.available=e.availableImages.some(b=>Do.isEqual(b,y)))}}return f}eachChild(e){if(e(this.namePrimary),this.paramsPrimary)for(const i in this.paramsPrimary)this.paramsPrimary[i]&&e(this.paramsPrimary[i]);if(this.nameSecondary&&(e(this.nameSecondary),this.paramsSecondary))for(const i in this.paramsSecondary)this.paramsSecondary[i]&&e(this.paramsSecondary[i])}outputDefined(){return!1}serializeOptions(e,i){const c={};if(i&&(c.iconset={id:i}),e){c.params={};for(const f in e)e[f]&&(c.params[f]=e[f].serialize())}return Object.keys(c).length>0?c:void 0}serialize(){const e=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const i=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);i&&e.push(i)}if(this.nameSecondary&&(e.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const i=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);i&&e.push(i)}return e}}function Rr(s){return Gd(s)?"string":Cr(s)?"number":Im(s)?"boolean":Array.isArray(s)?"array":s===null?"null":Vd(s)?"object":typeof s}function Vd(s){return s!=null&&!Array.isArray(s)&&typeof s!="function"&&!(s instanceof String||s instanceof Number||s instanceof Boolean)&&typeof s=="object"}function Gd(s){return typeof s=="string"||s instanceof String}function Cr(s){return typeof s=="number"||s instanceof Number}function Im(s){return typeof s=="boolean"||s instanceof Boolean}const u_={"to-boolean":bn,"to-color":Zo,"to-number":_r,"to-string":En};class vc{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const c=e[0],f=[];let g=ss;if(c==="to-array"){if(!Array.isArray(e[1]))return null;const y=e[1].length;if(i.expectedType){if(i.expectedType.kind!=="array")return i.error(`Expected ${i.expectedType.kind} but found array.`);g=Ro(i.expectedType.itemType,y)}else{if(!(y>0&&Hu(e[1][0])))return null;g=Ro(xa(e[1][0]),y)}for(let b=0;b<y;b++){const E=e[1][b];let M;if(Array.isArray(E))M=i.parse(E,void 0,g.itemType);else{const R=Rr(E);if(R!==g.itemType.kind)return i.error(`Expected ${g.itemType.kind} but found ${R}.`);M=i.registry.literal.parse(["literal",E===void 0?null:E],i)}if(!M)return null;f.push(M)}}else{if((c==="to-boolean"||c==="to-string")&&e.length!==2)return i.error("Expected one argument.");g=u_[c];for(let y=1;y<e.length;y++){const b=i.parse(e[y],y,Ln);if(!b)return null;f.push(b)}}return new vc(g,f)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let i,c;for(const f of this.args){if(i=f.evaluate(e),c=null,i instanceof Cn)return i;if(typeof i=="string"){const g=e.parseColor(i);if(g)return g}else if(Array.isArray(i)&&(c=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:c_(i[0],i[1],i[2],i[3]),!c))return new Cn(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Yi(c||`Could not parse color from value '${typeof i=="string"?i:String(JSON.stringify(i))}'`)}if(this.type.kind==="number"){let i=null;for(const c of this.args){if(i=c.evaluate(e),i===null)return 0;const f=Number(i);if(!isNaN(f))return f}throw new Yi(`Could not convert ${JSON.stringify(i)} to number.`)}return this.type.kind==="formatted"?xo.fromString(Bl(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?ls.build(Bl(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(i=>i.evaluate(e)):Bl(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new mr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Uh(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}const uv=["Unknown","Point","LineString","Polygon"];class $d{constructor(e,i,c){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=e,this.options=i,this.iconImageUseTheme=c}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?uv[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(e){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*i-e[0])+this.featureDistanceData.bearing[1]*(f*i-e[1])}return 0}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=Cn.parse(e)),i}getConfig(e){return this.options?this.options.get(e):null}}class cs{constructor(e,i,c,f,g){this.name=e,this.type=i,this._evaluate=c,this.args=f,this._overloadIndex=g}evaluate(e){if(!this._evaluate){const i=cs.definitions[this.name];this._evaluate=Array.isArray(i)?i[2]:i.overloads[this._overloadIndex][1]}return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const c=e[0],f=cs.definitions[c];if(!f)return i.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(f)?f[0]:f.type,y=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,b=[];let E=null,M=-1;for(const[R,z]of y){if(Array.isArray(R)&&R.length!==e.length-1)continue;b.push(R),M++,E=new cp(i.registry,i.path,null,i.scope,void 0,i._scope,i.options,i.iconImageUseTheme);const B=[];let j=!1;for(let V=1;V<e.length;V++){const Y=e[V],re=Array.isArray(R)?R[V-1]:R.type,J=E.parse(Y,1+B.length,re);if(!J){j=!0;break}B.push(J)}if(!j)if(Array.isArray(R)&&R.length!==B.length)E.error(`Expected ${R.length} arguments, but found ${B.length} instead.`);else{for(let V=0;V<B.length;V++){const Y=Array.isArray(R)?R[V]:R.type,re=B[V];E.concat(V+1).checkSubtype(Y,re.type)}if(E.errors.length===0)return new cs(c,g,z,B,M)}}if(b.length===1)i.errors.push(...E.errors);else{const R=(b.length?b:y.map(([B])=>B)).map(us).join(" | "),z=[];for(let B=1;B<e.length;B++){const j=i.parse(e[B],1+z.length);if(!j)return null;z.push(Wi(j.type))}i.error(`Expected arguments of type ${R}, but found (${z.join(", ")}) instead.`)}return null}static register(e,i){cs.definitions=i;for(const c in i)e[c]=cs}}function us(s){return Array.isArray(s)?`(${s.map(Wi).join(", ")})`:`(${Wi(s.type)}...)`}class Ps{constructor(e,i,c){this.type=Om,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(e.length!==2)return i.error("Expected one argument.");const c=e[1];if(typeof c!="object"||Array.isArray(c))return i.error("Collator options argument must be an object.");const f=c["case-sensitive"]===void 0?i.parse(!1,1,bn):i.parseObjectValue(c["case-sensitive"],1,"case-sensitive",bn);if(!f)return null;const g=c["diacritic-sensitive"]===void 0?i.parse(!1,1,bn):i.parseObjectValue(c["diacritic-sensitive"],1,"diacritic-sensitive",bn);if(!g)return null;let y=null;return c.locale&&(y=i.parseObjectValue(c.locale,1,"locale",En),!y)?null:new Ps(f,g,y)}evaluate(e){return new Cm(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}function rp(s,e,i=0,c=s.length-1,f=eu){for(;c>i;){if(c-i>600){const E=c-i+1,M=e-i+1,R=Math.log(E),z=.5*Math.exp(2*R/3),B=.5*Math.sqrt(R*z*(E-z)/E)*(M-E/2<0?-1:1);rp(s,e,Math.max(i,Math.floor(e-M*z/E+B)),Math.min(c,Math.floor(e+(E-M)*z/E+B)),f)}const g=s[e];let y=i,b=c;for(Ys(s,i,e),f(s[c],g)>0&&Ys(s,i,c);y<b;){for(Ys(s,y,b),y++,b--;f(s[y],g)<0;)y++;for(;f(s[b],g)>0;)b--}f(s[i],g)===0?Ys(s,i,b):(b++,Ys(s,b,c)),b<=e&&(i=b+1),e<=b&&(c=b-1)}}function Ys(s,e,i){const c=s[e];s[e]=s[i],s[i]=c}function eu(s,e){return s<e?-1:s>e?1:0}function hv(s){let e=0;for(let i,c,f=0,g=s.length,y=g-1;f<g;y=f++)i=s[f],c=s[y],e+=(c.x-i.x)*(i.y+c.y);return e}function Vh(s,e){s[0]=Math.min(s[0],e[0]),s[1]=Math.min(s[1],e[1]),s[2]=Math.max(s[2],e[0]),s[3]=Math.max(s[3],e[1])}function np(s,e){return!(s[0]<=e[0]||s[2]>=e[2]||s[1]<=e[1]||s[3]>=e[3])}function tu(s,e,i){const c=s[0]-e[0],f=s[1]-e[1],g=s[0]-i[0],y=s[1]-i[1];return c*y-g*f===0&&c*g<=0&&f*y<=0}function Pm(s,e,i){return e[1]>s[1]!=i[1]>s[1]&&s[0]<(i[0]-e[0])*(s[1]-e[1])/(i[1]-e[1])+e[0]}function Wo(s,e,i=!1){let c=!1;for(let f=0,g=e.length;f<g;f++){const y=e[f];for(let b=0,E=y.length,M=E-1;b<E;M=b++){const R=y[M],z=y[b];if(tu(s,R,z))return i;Pm(s,R,z)&&(c=!c)}}return c}function Dm(s,e,i,c){const f=c[0]-i[0],g=c[1]-i[1],y=(s[0]-i[0])*g-f*(s[1]-i[1]),b=(e[0]-i[0])*g-f*(e[1]-i[1]);return y>0&&b<0||y<0&&b>0}function ip(s,e,i,c){return(f=[c[0]-i[0],c[1]-i[1]])[0]*(g=[e[0]-s[0],e[1]-s[1]])[1]-f[1]*g[0]!==0&&!(!Dm(s,e,i,c)||!Dm(i,c,s,e));var f,g}function kl(s){const e=new yt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i=new yt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const c of s[0])e.x>c.x&&(e.x=c.x),e.y>c.y&&(e.y=c.y),i.x<c.x&&(i.x=c.x),i.y<c.y&&(i.y=c.y);return{min:e,max:i}}const Ks=8192;function h_(s,e){const i=(180+s[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(i*f*Ks),Math.round(c*f*Ks)]}function d_(s,e){for(let i=0;i<e.length;i++)if(Wo(s,e[i]))return!0;return!1}function Gh(s,e,i){for(const c of i)for(let f=0,g=c.length,y=g-1;f<g;y=f++)if(ip(s,e,c[y],c[f]))return!0;return!1}function Rm(s,e){for(let i=0;i<s.length;++i)if(!Wo(s[i],e))return!1;for(let i=0;i<s.length-1;++i)if(Gh(s[i],s[i+1],e))return!1;return!0}function dv(s,e){for(let i=0;i<e.length;i++)if(Rm(s,e[i]))return!0;return!1}function xc(s,e,i){const c=[];for(let f=0;f<s.length;f++){const g=[];for(let y=0;y<s[f].length;y++){const b=h_(s[f][y],i);Vh(e,b),g.push(b)}c.push(g)}return c}function fv(s,e,i){const c=[];for(let f=0;f<s.length;f++){const g=xc(s[f],e,i);c.push(g)}return c}function pv(s,e,i,c){if(s[0]<i[0]||s[0]>i[2]){const f=.5*c;let g=s[0]-i[0]>f?-c:i[0]-s[0]>f?c:0;g===0&&(g=s[0]-i[2]>f?-c:i[2]-s[0]>f?c:0),s[0]+=g}Vh(e,s)}function zm(s,e,i,c){const f=Math.pow(2,c.z)*Ks,g=[c.x*Ks,c.y*Ks],y=[];if(!s)return y;for(const b of s)for(const E of b){const M=[E.x+g[0],E.y+g[1]];pv(M,e,i,f),y.push(M)}return y}function Lm(s,e,i,c){const f=Math.pow(2,c.z)*Ks,g=[c.x*Ks,c.y*Ks],y=[];if(!s)return y;for(const E of s){const M=[];for(const R of E){const z=[R.x+g[0],R.y+g[1]];Vh(e,z),M.push(z)}y.push(M)}if(e[2]-e[0]<=f/2){(b=e)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of y)for(const M of E)pv(M,e,i,f)}var b;return y}class ru{constructor(e,i){this.type=bn,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Hu(e[1])){const c=e[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const g=c.features[f].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new ru(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new ru(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new ru(c,c)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(i,c){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const b=xc(c.coordinates,g,y),E=zm(i.geometry(),f,g,y);if(!np(f,g))return!1;for(const M of E)if(!Wo(M,b))return!1}if(c.type==="MultiPolygon"){const b=fv(c.coordinates,g,y),E=zm(i.geometry(),f,g,y);if(!np(f,g))return!1;for(const M of E)if(!d_(M,b))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(i,c){const f=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if(!y)return!1;if(c.type==="Polygon"){const b=xc(c.coordinates,g,y),E=Lm(i.geometry(),f,g,y);if(!np(f,g))return!1;for(const M of E)if(!Rm(M,b))return!1}if(c.type==="MultiPolygon"){const b=fv(c.coordinates,g,y),E=Lm(i.geometry(),f,g,y);if(!np(f,g))return!1;for(const M of E)if(!dv(M,b))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Yo={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Qs=1/298.257223563,qd=Qs*(2-Qs),zo=Math.PI/180;class Fl{static fromTile(e,i,c){const f=Math.PI*(1-2*(e+.5)/Math.pow(2,i)),g=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/zo;return new Fl(g,c)}static get units(){return Yo}constructor(e,i){if(e===void 0)throw new Error("No latitude given.");if(i&&!Yo[i])throw new Error(`Unknown unit ${i}. Use one of: ${Object.keys(Yo).join(", ")}`);const c=6378.137*zo*(i?Yo[i]:1),f=Math.cos(e*zo),g=1/(1-qd*(1-f*f)),y=Math.sqrt(g);this.kx=c*y*f,this.ky=c*y*g*(1-qd)}distance(e,i){const c=Ko(e[0]-i[0])*this.kx,f=(e[1]-i[1])*this.ky;return Math.sqrt(c*c+f*f)}bearing(e,i){const c=Ko(i[0]-e[0])*this.kx;return Math.atan2(c,(i[1]-e[1])*this.ky)/zo}destination(e,i,c){const f=c*zo;return this.offset(e,Math.sin(f)*i,Math.cos(f)*i)}offset(e,i,c){return[e[0]+i/this.kx,e[1]+c/this.ky]}lineDistance(e){let i=0;for(let c=0;c<e.length-1;c++)i+=this.distance(e[c],e[c+1]);return i}area(e){let i=0;for(let c=0;c<e.length;c++){const f=e[c];for(let g=0,y=f.length,b=y-1;g<y;b=g++)i+=Ko(f[g][0]-f[b][0])*(f[g][1]+f[b][1])*(c?-1:1)}return Math.abs(i)/2*this.kx*this.ky}along(e,i){let c=0;if(i<=0)return e[0];for(let f=0;f<e.length-1;f++){const g=e[f],y=e[f+1],b=this.distance(g,y);if(c+=b,c>i)return $h(g,y,(i-(c-b))/b)}return e[e.length-1]}pointToSegmentDistance(e,i,c){let[f,g]=i,y=Ko(c[0]-f)*this.kx,b=(c[1]-g)*this.ky;if(y!==0||b!==0){const E=(Ko(e[0]-f)*this.kx*y+(e[1]-g)*this.ky*b)/(y*y+b*b);E>1?(f=c[0],g=c[1]):E>0&&(f+=y/this.kx*E,g+=b/this.ky*E)}return y=Ko(e[0]-f)*this.kx,b=(e[1]-g)*this.ky,Math.sqrt(y*y+b*b)}pointOnLine(e,i){let c=1/0,f=e[0][0],g=e[0][1],y=0,b=0;for(let E=0;E<e.length-1;E++){let M=e[E][0],R=e[E][1],z=Ko(e[E+1][0]-M)*this.kx,B=(e[E+1][1]-R)*this.ky,j=0;z===0&&B===0||(j=(Ko(i[0]-M)*this.kx*z+(i[1]-R)*this.ky*B)/(z*z+B*B),j>1?(M=e[E+1][0],R=e[E+1][1]):j>0&&(M+=z/this.kx*j,R+=B/this.ky*j)),z=Ko(i[0]-M)*this.kx,B=(i[1]-R)*this.ky;const V=z*z+B*B;V<c&&(c=V,f=M,g=R,y=E,b=j)}return{point:[f,g],index:y,t:Math.max(0,Math.min(1,b))}}lineSlice(e,i,c){let f=this.pointOnLine(c,e),g=this.pointOnLine(c,i);if(f.index>g.index||f.index===g.index&&f.t>g.t){const M=f;f=g,g=M}const y=[f.point],b=f.index+1,E=g.index;!ap(c[b],y[0])&&b<=E&&y.push(c[b]);for(let M=b+1;M<=E;M++)y.push(c[M]);return ap(c[E],g.point)||y.push(g.point),y}lineSliceAlong(e,i,c){let f=0;const g=[];for(let y=0;y<c.length-1;y++){const b=c[y],E=c[y+1],M=this.distance(b,E);if(f+=M,f>e&&g.length===0&&g.push($h(b,E,(e-(f-M))/M)),f>=i)return g.push($h(b,E,(i-(f-M))/M)),g;f>e&&g.push(E)}return g}bufferPoint(e,i){const c=i/this.ky,f=i/this.kx;return[e[0]-f,e[1]-c,e[0]+f,e[1]+c]}bufferBBox(e,i){const c=i/this.ky,f=i/this.kx;return[e[0]-f,e[1]-c,e[2]+f,e[3]+c]}insideBBox(e,i){return Ko(e[0]-i[0])>=0&&Ko(e[0]-i[2])<=0&&e[1]>=i[1]&&e[1]<=i[3]}}function ap(s,e){return s[0]===e[0]&&s[1]===e[1]}function $h(s,e,i){const c=Ko(e[0]-s[0]);return[s[0]+c*i,s[1]+(e[1]-s[1])*i]}function Ko(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}class qh{constructor(e=[],i=(c,f)=>c<f?-1:c>f?1:0){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:c}=this,f=i[e];for(;e>0;){const g=e-1>>1,y=i[g];if(c(f,y)>=0)break;i[e]=y,e=g}i[e]=f}_down(e){const{data:i,compare:c}=this,f=this.length>>1,g=i[e];for(;e<f;){let y=1+(e<<1);const b=y+1;if(b<this.length&&c(i[b],i[y])<0&&(y=b),c(i[y],g)>=0)break;i[e]=i[y],e=y}i[e]=g}}var Gt=8192;function Bm(s,e){return e.dist-s.dist}function Hd(s){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==s.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==s[i])return!1;return!0}function bc(s){return s[1]-s[0]+1}function wc(s,e){const i=s[1]>=s[0]&&s[1]<e;return i||console.warn("Distance Expression: Index is out of range"),i}function hs(s,e){if(s[0]>s[1])return[null,null];const i=bc(s);if(e){if(i===2)return[s,null];const c=Math.floor(i/2);return[[s[0],s[0]+c],[s[0]+c,s[1]]]}{if(i===1)return[s,null];const c=Math.floor(i/2)-1;return[[s[0],s[0]+c],[s[0]+c+1,s[1]]]}}function nu(s,e){const i=[1/0,1/0,-1/0,-1/0];if(!wc(e,s.length))return i;for(let c=e[0];c<=e[1];++c)Vh(i,s[c]);return i}function ds(s){const e=[1/0,1/0,-1/0,-1/0];for(let i=0;i<s.length;++i)for(let c=0;c<s[i].length;++c)Vh(e,s[i][c]);return e}function iu(s,e,i){if(Hd(s)||Hd(e))return NaN;let c=0,f=0;return s[2]<e[0]&&(c=e[0]-s[2]),s[0]>e[2]&&(c=s[0]-e[2]),s[1]>e[3]&&(f=s[1]-e[3]),s[3]<e[1]&&(f=e[1]-s[3]),i.distance([0,0],[c,f])}function Hh(s){return 360*s-180}function Zu(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Xd(s,e){const i=Math.pow(2,e.z),c=(s.y/Gt+e.y)/i;return[Hh((s.x/Gt+e.x)/i),Zu(c)]}function mv(s,e){const i=[];for(let c=0;c<s.length;++c)i.push(Xd(s[c],e));return i}function km(s,e,i){const c=i.pointOnLine(e,s).point;return i.distance(s,c)}function Fm(s,e,i,c,f){const g=i.slice(c[0],c[1]+1);let y=1/0;for(let b=e[0];b<=e[1];++b)if((y=Math.min(y,km(s[b],g,f)))===0)return 0;return y}function ao(s,e,i,c,f){const g=Math.min(f.pointToSegmentDistance(s,i,c),f.pointToSegmentDistance(e,i,c)),y=Math.min(f.pointToSegmentDistance(i,s,e),f.pointToSegmentDistance(c,s,e));return Math.min(g,y)}function sn(s,e,i,c,f){if(!wc(e,s.length)||!wc(c,i.length))return NaN;let g=1/0;for(let y=e[0];y<e[1];++y)for(let b=c[0];b<c[1];++b){if(ip(s[y],s[y+1],i[b],i[b+1]))return 0;g=Math.min(g,ao(s[y],s[y+1],i[b],i[b+1],f))}return g}function Zd(s,e,i,c,f){if(!wc(e,s.length)||!wc(c,i.length))return NaN;let g=1/0;for(let y=e[0];y<=e[1];++y)for(let b=c[0];b<=c[1];++b)if((g=Math.min(g,f.distance(s[y],i[b])))===0)return g;return g}function Nm(s,e,i){if(Wo(s,e,!0))return 0;let c=1/0;for(const f of e){const g=f.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[g-1]&&(c=Math.min(c,i.pointToSegmentDistance(s,f[g-1],f[0])))===0||(c=Math.min(c,km(s,f,i)))===0)return c}return c}function op(s,e,i,c){if(!wc(e,s.length))return NaN;for(let g=e[0];g<=e[1];++g)if(Wo(s[g],i,!0))return 0;let f=1/0;for(let g=e[0];g<e[1];++g)for(const y of i)for(let b=0,E=y.length,M=E-1;b<E;M=b++){if(ip(s[g],s[g+1],y[M],y[b]))return 0;f=Math.min(f,ao(s[g],s[g+1],y[M],y[b],c))}return f}function Ds(s,e){for(const i of s)for(let c=0;c<=i.length-1;++c)if(Wo(i[c],e,!0))return!0;return!1}function yl(s,e,i,c=1/0){const f=ds(s),g=ds(e);if(c!==1/0&&iu(f,g,i)>=c)return c;if(np(f,g)){if(Ds(s,e))return 0}else if(Ds(e,s))return 0;let y=c;for(const b of s)for(let E=0,M=b.length,R=M-1;E<M;R=E++)for(const z of e)for(let B=0,j=z.length,V=j-1;B<j;V=B++){if(ip(b[R],b[E],z[V],z[B]))return 0;y=Math.min(y,ao(b[R],b[E],z[V],z[B],i))}return y}function $n(s,e,i,c,f,g,y){if(g===null||y===null)return;const b=iu(nu(c,g),nu(f,y),i);b<e&&s.push({dist:b,range1:g,range2:y})}function Ac(s,e,i,c,f=1/0){let g=Math.min(c.distance(s[0],i[0][0]),f);if(g===0)return g;const y=new qh([{dist:0,range1:[0,s.length-1],range2:[0,0]}],Bm),b=e?50:100,E=ds(i);for(;y.length;){const M=y.pop();if(M.dist>=g)continue;const R=M.range1;if(bc(R)<=b){if(!wc(R,s.length))return NaN;if(e){const z=op(s,R,i,c);if((g=Math.min(g,z))===0)return g}else for(let z=R[0];z<=R[1];++z){const B=Nm(s[z],i,c);if((g=Math.min(g,B))===0)return g}}else{const z=hs(R,e);if(z[0]!==null){const B=iu(nu(s,z[0]),E,c);B<g&&y.push({dist:B,range1:z[0],range2:[0,0]})}if(z[1]!==null){const B=iu(nu(s,z[1]),E,c);B<g&&y.push({dist:B,range1:z[1],range2:[0,0]})}}}return g}function Nl(s,e,i,c,f,g=1/0){let y=Math.min(g,f.distance(s[0],i[0]));if(y===0)return y;const b=new qh([{dist:0,range1:[0,s.length-1],range2:[0,i.length-1]}],Bm),E=e?50:100,M=c?50:100;for(;b.length;){const R=b.pop();if(R.dist>=y)continue;const z=R.range1,B=R.range2;if(bc(z)<=E&&bc(B)<=M){if(!wc(z,s.length)||!wc(B,i.length))return NaN;if(e&&c?y=Math.min(y,sn(s,z,i,B,f)):e||c?e&&!c?y=Math.min(y,Fm(i,B,s,z,f)):!e&&c&&(y=Math.min(y,Fm(s,z,i,B,f))):y=Math.min(y,Zd(s,z,i,B,f)),y===0)return y}else{const j=hs(z,e),V=hs(B,c);$n(b,y,f,s,i,j[0],V[0]),$n(b,y,f,s,i,j[0],V[1]),$n(b,y,f,s,i,j[1],V[0]),$n(b,y,f,s,i,j[1],V[1])}}return y}function jl(s,e,i,c,f=1/0){let g=f;const y=nu(s,[0,s.length-1]);for(const b of i)if(!(g!==1/0&&iu(y,nu(b,[0,b.length-1]),c)>=g)&&(g=Math.min(g,Nl(s,e,b,!0,c,g)),g===0))return g;return g}function sp(s,e,i,c,f=1/0){let g=f;const y=nu(s,[0,s.length-1]);for(const b of i){if(g!==1/0&&iu(y,ds(b),c)>=g)continue;const E=Ac(s,e,b,c,g);if(isNaN(E))return E;if((g=Math.min(g,E))===0)return g}return g}function lp(s){return s==="Point"||s==="MultiPoint"||s==="LineString"||s==="MultiLineString"||s==="Polygon"||s==="MultiPolygon"}class au{constructor(e,i){this.type=_r,this.geojson=e,this.geometries=i}static parse(e,i){if(e.length!==2)return i.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(Hu(e[1])){const c=e[1];if(c.type==="FeatureCollection"){for(let f=0;f<c.features.length;++f)if(lp(c.features[f].geometry.type))return new au(c,c.features[f].geometry)}else if(c.type==="Feature"){if(lp(c.geometry.type))return new au(c,c.geometry)}else if(lp(c.type))return new au(c,c)}return i.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const i=e.geometry(),c=e.canonicalID();if(i!=null&&c!=null){if(e.geometryType()==="Point")return(function(f,g,y){const b=[];for(const M of f)for(const R of M)b.push(Xd(R,g));const E=new Fl(b[0][1],"meters");return y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString"?Nl(b,!1,y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",E):y.type==="MultiLineString"?jl(b,!1,y.coordinates,E):y.type==="Polygon"||y.type==="MultiPolygon"?sp(b,!1,y.type==="Polygon"?[y.coordinates]:y.coordinates,E):null})(i,c,this.geometries);if(e.geometryType()==="LineString")return(function(f,g,y){const b=[];for(const M of f){const R=[];for(const z of M)R.push(Xd(z,g));b.push(R)}const E=new Fl(b[0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return jl(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",b,E);if(y.type==="MultiLineString"){let M=1/0;for(let R=0;R<y.coordinates.length;R++){const z=jl(y.coordinates[R],!0,b,E,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}if(y.type==="Polygon"||y.type==="MultiPolygon"){let M=1/0;for(let R=0;R<b.length;R++){const z=sp(b[R],!0,y.type==="Polygon"?[y.coordinates]:y.coordinates,E,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return null})(i,c,this.geometries);if(e.geometryType()==="Polygon")return(function(f,g,y){const b=[];for(const M of(function(R){const z=R.length;if(z<=1)return[R];const B=[];let j,V;for(let Y=0;Y<z;Y++){const re=hv(R[Y]);re!==0&&(R[Y].area=Math.abs(re),V===void 0&&(V=re<0),V===re<0?(j&&B.push(j),j=[R[Y]]):j.push(R[Y]))}return j&&B.push(j),B})(f)){const R=[];for(let z=0;z<M.length;++z)R.push(mv(M[z],g));b.push(R)}const E=new Fl(b[0][0][0][1],"meters");if(y.type==="Point"||y.type==="MultiPoint"||y.type==="LineString")return sp(y.type==="Point"?[y.coordinates]:y.coordinates,y.type==="LineString",b,E);if(y.type==="MultiLineString"){let M=1/0;for(let R=0;R<y.coordinates.length;R++){const z=sp(y.coordinates[R],!0,b,E,M);if(isNaN(z))return z;if((M=Math.min(M,z))===0)return M}return M}return y.type==="Polygon"||y.type==="MultiPolygon"?(function(M,R,z){let B=1/0;for(const j of M)for(const V of R){const Y=yl(j,V,z,B);if(isNaN(Y))return Y;if((B=Math.min(B,Y))===0)return B}return B})(y.type==="Polygon"?[y.coordinates]:y.coordinates,b,E):null})(i,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Xh(s){if(s instanceof cs&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof ru||s instanceof au)return!1;if(s instanceof Wu)return s.featureConstant;let e=!0;return s.eachChild(i=>{e&&!Xh(i)&&(e=!1)}),e}function Fa(s){if(s instanceof cs&&s.name==="feature-state")return!1;let e=!0;return s.eachChild(i=>{e&&!Fa(i)&&(e=!1)}),e}function Fi(s,e){if(s instanceof cs&&e.indexOf(s.name)>=0)return!1;let i=!0;return s.eachChild(c=>{i&&!Fi(c,e)&&(i=!1)}),i}function ci(s,e,i){return[s,e,i].filter(Boolean).join("")}function Tc(s,e){switch(s){case"string":return Bl(e);case"number":return+e;case"boolean":return!!e;case"color":return Cn.parse(e);case"formatted":return xo.fromString(Bl(e));case"resolvedImage":return ls.build(Bl(e))}return e}function Js(s,e,i,c){return c!==void 0&&(s=c*Math.round(s/c)),e!==void 0&&s<e&&(s=e),i!==void 0&&s>i&&(s=i),s}class Wu{constructor(e,i,c,f=!1){this.type=e,this.key=i,this.scope=c,this.featureConstant=f}static parse(e,i){let c=i.expectedType;if(c==null&&(c=Ln),e.length<2||e.length>3)return i.error("Invalid number of arguments for 'config' expression.");const f=i.parse(e[1],1);if(!(f instanceof Ws))return i.error("Key name of 'config' expression must be a string literal.");let g,y=!0;const b=Bl(f.value);if(e.length>=3){const E=i.parse(e[2],2);if(!(E instanceof Ws))return i.error("Scope of 'config' expression must be a string literal.");g=Bl(E.value)}if(i.options){const E=ci(b,g,i._scope),M=i.options.get(E);M&&(y=Xh(M.value||M.default))}return new Wu(c,b,g,y)}evaluate(e){const i=ci(this.key,this.scope,e.scope),c=e.getConfig(i);if(!c)return null;const{type:f,value:g,values:y,minValue:b,maxValue:E,stepValue:M}=c,R=c.default.evaluate(e);let z=R;if(g){const B=e.scope;e.scope=(B||"").split("").slice(1).join(""),z=g.evaluate(e),e.scope=B}return f&&(z=Tc(f,z)),z===void 0||b===void 0&&E===void 0&&M===void 0||(typeof z=="number"?z=Js(z,b,E,M):Array.isArray(z)&&(z=z.map(B=>typeof B=="number"?Js(B,b,E,M):B))),g!==void 0&&z!==void 0&&y&&!y.includes(z)&&(z=R,f&&(z=Tc(f,z))),(f&&f!==this.type||z!==void 0&&!ep(xa(z),this.type))&&(z=Tc(this.type.kind,z)),z}eachChild(){}outputDefined(){return!1}serialize(){const e=["config",this.key];return this.scope&&e.concat(this.scope),e}}class Ul{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(e.length!==2||typeof e[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const c=e[1];return i.scope.has(c)?new Ul(c,i.scope.get(c)):i.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class cp{constructor(e,i=[],c,f=new Mm,g=[],y,b,E){this.registry=e,this.path=i,this.key=i.map(M=>typeof M=="string"?`['${M}']`:`[${M}]`).join(""),this.scope=f,this.errors=g,this.expectedType=c,this._scope=y,this.options=b,this.iconImageUseTheme=E}parse(e,i,c,f,g={}){return i||c?this.concat(i,null,c,f)._parse(e,g):this._parse(e,g)}parseObjectValue(e,i,c,f,g,y={}){return this.concat(i,c,f,g)._parse(e,y)}_parse(e,i){function c(f,g,y){return y==="assert"?new zr(g,[f]):y==="coerce"?new vc(g,[f]):f}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(f){let g=f.parse(e,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,b=g.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||b.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(y,b))return null}else g=c(g,y,i.typeAnnotation||"coerce");else g=c(g,y,i.typeAnnotation||"assert")}if(!(g instanceof Ws)&&g.type.kind!=="resolvedImage"&&jm(g)){const y=new $d(this._scope,this.options,this.iconImageUseTheme);try{g=new Ws(g.type,g.evaluate(y))}catch(b){return this.error(b.message),null}}return g}return vc.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,c,f){let g=typeof e=="number"?this.path.concat(e):this.path;g=typeof i=="string"?g.concat(i):g;const y=f?this.scope.concat(f):this.scope;return new cp(this.registry,g,c||null,y,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(e,...i){const c=`${this.key}${i.map(f=>`[${f}]`).join("")}`;this.errors.push(new vo(c,e))}checkSubtype(e,i){const c=Jc(e,i);return c&&this.error(c),c}}function jm(s){if(s instanceof Ul)return jm(s.boundExpression);if(s instanceof cs&&s.name==="error"||s instanceof Ps||s instanceof ru||s instanceof au||s instanceof Wu)return!1;const e=s instanceof vc||s instanceof zr;let i=!0;return s.eachChild(c=>{i=e?i&&jm(c):i&&c instanceof Ws}),!!i&&Xh(s)&&Fi(s,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function ou(s,e){const i=s.length-1;let c,f,g=0,y=i,b=0;for(;g<=y;)if(b=Math.floor((g+y)/2),c=s[b],f=s[b+1],c<=e){if(b===i||e<f)return b;g=b+1}else{if(!(c>e))throw new Yi("Input is not a number.");y=b-1}return 0}class Vl{constructor(e,i,c){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[f,g]of c)this.labels.push(f),this.outputs.push(g)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const c=i.parse(e[1],1,_r);if(!c)return null;const f=[];let g=null;i.expectedType&&i.expectedType.kind!=="value"&&(g=i.expectedType);for(let y=1;y<e.length;y+=2){const b=y===1?-1/0:e[y],E=e[y+1],M=y,R=y+1;if(typeof b!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(f.length&&f[f.length-1][0]>=b)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const z=i.parse(E,R,g);if(!z)return null;g=g||z.type,f.push([b,z])}return new Vl(g,c,f)}evaluate(e){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=i[0])return c[0].evaluate(e);const g=i.length;return f>=i[g-1]?c[g-1].evaluate(e):c[ou(i,f)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}const Um=.95047,Wd=1.08883,Vm=4/29,vl=6/29,Sc=3*vl*vl,Yu=vl*vl*vl,su=Math.PI/180,f_=180/Math.PI;function up(s){return s>Yu?Math.pow(s,1/3):s/Sc+Vm}function Ku(s){return s>vl?s*s*s:Sc*(s-Vm)}function Yd(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function lu(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function bo(s){const e=lu(s.r),i=lu(s.g),c=lu(s.b),f=up((.4124564*e+.3575761*i+.1804375*c)/Um),g=up((.2126729*e+.7151522*i+.072175*c)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-up((.0193339*e+.119192*i+.9503041*c)/Wd)),alpha:s.a}}function Zh(s){let e=(s.l+16)/116,i=isNaN(s.a)?e:e+s.a/500,c=isNaN(s.b)?e:e-s.b/200;return e=1*Ku(e),i=Um*Ku(i),c=Wd*Ku(c),new Cn(Yd(3.2404542*i-1.5371385*e-.4985314*c),Yd(-.969266*i+1.8760108*e+.041556*c),Yd(.0556434*i-.2040259*e+1.0572252*c),s.alpha)}function hp(s,e,i){const c=e-s;return s+i*(c>180||c<-180?c-360*Math.round(c/360):c)}const Kd={forward:bo,reverse:Zh,interpolate:function(s,e,i){return{l:Dr(s.l,e.l,i),a:Dr(s.a,e.a,i),b:Dr(s.b,e.b,i),alpha:Dr(s.alpha,e.alpha,i)}}},dp={forward:function(s){const{l:e,a:i,b:c}=bo(s),f=Math.atan2(c,i)*f_;return{h:f<0?f+360:f,c:Math.sqrt(i*i+c*c),l:e,alpha:s.a}},reverse:function(s){const e=s.h*su,i=s.c;return Zh({l:s.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:s.alpha})},interpolate:function(s,e,i){return{h:hp(s.h,e.h,i),c:Dr(s.c,e.c,i),l:Dr(s.l,e.l,i),alpha:Dr(s.alpha,e.alpha,i)}}};var gv=Object.freeze({__proto__:null,hcl:dp,lab:Kd});class Si{constructor(e,i,c,f,g){this.type=e,this.operator=i,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[y,b]of g)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(e,i,c,f){let g=0;if(e.name==="exponential")g=Qd(i,e.base,c,f);else if(e.name==="linear")g=Qd(i,1,c,f);else if(e.name==="cubic-bezier"){const y=e.controlPoints;g=new Jr(y[0],y[1],y[2],y[3]).solve(Qd(i,1,c,f))}return g}static parse(e,i){let[c,f,g,...y]=e;if(!Array.isArray(f)||f.length===0)return i.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const M=f[1];if(typeof M!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:M}}else{if(f[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const M=f.slice(1);if(M.length!==4||M.some(R=>typeof R!="number"||R<0||R>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length-1>3&&(e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(g=i.parse(g,2,_r),!g)return null;const b=[];let E=null;c==="interpolate-hcl"||c==="interpolate-lab"?E=Zo:i.expectedType&&i.expectedType.kind!=="value"&&(E=i.expectedType);for(let M=0;M<y.length;M+=2){const R=y[M],z=y[M+1],B=M+3,j=M+4;if(typeof R!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(b.length&&b[b.length-1][0]>=R)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const V=i.parse(z,j,E);if(!V)return null;E=E||V.type,b.push([R,V])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new Si(E,c,f,g,b):i.error(`Type ${Wi(E)} is not interpolatable.`)}evaluate(e){const i=this.labels,c=this.outputs;if(i.length===1)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=i[0])return c[0].evaluate(e);const g=i.length;if(f>=i[g-1])return c[g-1].evaluate(e);const y=ou(i,f),b=Si.interpolationFactor(this.interpolation,f,i[y],i[y+1]),E=c[y].evaluate(e),M=c[y+1].evaluate(e);return this.operator==="interpolate"?Nh[this.type.kind.toLowerCase()](E,M,b):this.operator==="interpolate-hcl"?dp.reverse(dp.interpolate(dp.forward(E),dp.forward(M),b)):Kd.reverse(Kd.interpolate(Kd.forward(E),Kd.forward(M),b))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const i=[this.operator,e,this.input.serialize()];for(let c=0;c<this.labels.length;c++)i.push(this.labels[c],this.outputs[c].serialize());return i}}function Qd(s,e,i,c){const f=c-i,g=s-i;return f===0?0:e===1?g/f:(Math.pow(e,g)-1)/(Math.pow(e,f)-1)}class cu{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let c=null;const f=i.expectedType;f&&f.kind!=="value"&&(c=f);const g=[];for(const b of e.slice(1)){const E=i.parse(b,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!E)return null;c=c||E.type,g.push(E)}const y=f&&g.some(b=>Jc(f,b.type));return new cu(y?Ln:c,g)}evaluate(e){let i,c=null,f=0;for(const g of this.args){if(f++,c=g.evaluate(e),c&&c instanceof ls&&!c.available&&(i||(i=c),c=null,f===this.args.length))return i;if(c!==null)break}return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class el{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let g=1;g<e.length-1;g+=2){const y=e[g];if(typeof y!="string")return i.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",g);const b=i.parse(e[g+1],g+1);if(!b)return null;c.push([y,b])}const f=i.parse(e[e.length-1],e.length-1,i.expectedType,c);return f?new el(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,c]of this.bindings)e.push(i,c.serialize());return e.push(this.result.serialize()),e}}class Jd{constructor(e,i,c){this.type=e,this.index=i,this.input=c}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,_r),f=i.parse(e[2],2,Ro(i.expectedType||Ln));return c&&f?new Jd(f.type.itemType,c,f):null}evaluate(e){const i=this.index.evaluate(e),c=this.input.evaluate(e);if(i<0)throw new Yi("Array index out of bounds: negative index");if(i>=c.length)throw new Yi("Array index out of bounds: index exceeds array size");if(i!==Math.floor(i))throw new Yi("Array index must be an integer. Use at-interpolated for fractional indices");return c[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class uu{constructor(e,i,c){this.type=e,this.index=i,this.input=c}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,_r),f=i.parse(e[2],2,Ro(i.expectedType||Ln));return c&&f?new uu(f.type.itemType,c,f):null}evaluate(e){const i=this.index.evaluate(e),c=this.input.evaluate(e);if(i<0)throw new Yi(`Array index out of bounds: ${i} < 0.`);if(i>c.length-1)throw new Yi(`Array index out of bounds: ${i} > ${c.length-1}.`);if(i===Math.floor(i))return c[i];const f=Math.floor(i),g=Math.ceil(i),y=c[f],b=c[g];if(typeof y!="number"||typeof b!="number")throw new Yi(`Cannot interpolate between non-number values at index ${i}.`);const E=i-f;return y*(1-E)+b*E}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Qu{constructor(e,i){this.type=bn,this.needle=e,this.haystack=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,Ln),f=i.parse(e[2],2,Ln);return c&&f?l_(c.type,[bn,En,_r,ss,Ln])?new Qu(c,f):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(c.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(c==null)return!1;if(!Ud(i,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(xa(i))} instead.`);if(!Ud(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${Wi(xa(c))} instead.`);return c.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class ef{constructor(e,i,c){this.type=_r,this.needle=e,this.haystack=i,this.fromIndex=c}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,Ln),f=i.parse(e[2],2,Ln);if(!c||!f)return null;if(!l_(c.type,[bn,En,_r,ss,Ln]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(c.type)} instead`);if(e.length===4){const g=i.parse(e[3],3,_r);return g?new ef(c,f,g):null}return new ef(c,f)}evaluate(e){const i=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!Ud(i,["boolean","string","number","null"]))throw new Yi(`Expected first argument to be of type boolean, string, number or null, but found ${Wi(xa(i))} instead.`);if(!Ud(c,["string","array"]))throw new Yi(`Expected second argument to be of type array or string, but found ${Wi(xa(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return c.indexOf(i,f)}return c.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class tf{constructor(e,i,c,f,g,y){this.inputType=e,this.type=i,this.input=c,this.cases=f,this.outputs=g,this.otherwise=y}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let c,f;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);const g={},y=[];for(let M=2;M<e.length-1;M+=2){let R=e[M];const z=e[M+1];Array.isArray(R)||(R=[R]);const B=i.concat(M);if(R.length===0)return B.error("Expected at least one branch label.");for(const V of R){if(typeof V!="number"&&typeof V!="string")return B.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return B.error("Numeric branch labels must be integer values.");if(c){if(B.checkSubtype(c,xa(V)))return null}else c=xa(V);if(g[String(V)]!==void 0)return B.error("Branch labels must be unique.");g[String(V)]=y.length}const j=i.parse(z,M,f);if(!j)return null;f=f||j.type,y.push(j)}const b=i.parse(e[1],1,Ln);if(!b)return null;const E=i.parse(e[e.length-1],e.length-1,f);return E?b.type.kind!=="value"&&i.concat(1).checkSubtype(c,b.type)?null:new tf(c,f,b,g,y,E):null}evaluate(e){const i=this.input.evaluate(e);return(ep(xa(i),this.inputType)&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),c=[],f={};for(const y of i){const b=f[this.cases[y]];b===void 0?(f[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[b][1].push(y)}const g=y=>this.inputType.kind==="number"?Number(y):y;for(const[y,b]of c)e.push(b.length===1?g(b[0]):b.map(g)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}class fp{constructor(e,i,c){this.type=e,this.branches=i,this.otherwise=c}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const f=[];for(let y=1;y<e.length-1;y+=2){const b=i.parse(e[y],y,bn);if(!b)return null;const E=i.parse(e[y+1],y+1,c);if(!E)return null;f.push([b,E]),c=c||E.type}const g=i.parse(e[e.length-1],e.length-1,c);return g?new fp(c,f,g):null}evaluate(e){for(const[i,c]of this.branches)if(i.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,c]of this.branches)e(i),e(c);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class pp{constructor(e,i,c,f){this.type=e,this.input=i,this.beginIndex=c,this.endIndex=f}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,Ln),f=i.parse(e[2],2,_r);if(!c||!f)return null;if(!l_(c.type,[Ro(Ln),En,Ln]))return i.error(`Expected first argument to be of type array or string, but found ${Wi(c.type)} instead`);if(e.length===4){const g=i.parse(e[3],3,_r);return g?new pp(c.type,c,f,g):null}return new pp(c.type,c,f)}evaluate(e){const i=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!Ud(i,["string","array"]))throw new Yi(`Expected first argument to be of type array or string, but found ${Wi(xa(i))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return i.slice(c,f)}return i.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class hu{constructor(e,i){this.type=Ro(En),this.str=e,this.delimiter=i}static parse(e,i){if(e.length!==3)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=i.parse(e[1],1,En),f=i.parse(e[2],2,En);return c&&f?new hu(c,f):void 0}evaluate(e){const i=this.str.evaluate(e),c=this.delimiter.evaluate(e);return i.split(c)}eachChild(e){e(this.str),e(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function mp(s,e){return s==="=="||s==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function rf(s,e,i,c){return c.compare(e,i)===0}function Wh(s,e,i){const c=s!=="=="&&s!=="!=";return class iV{constructor(g,y,b){this.type=bn,this.lhs=g,this.rhs=y,this.collator=b,this.hasUntypedArgument=g.type.kind==="value"||y.type.kind==="value"}static parse(g,y){if(g.length!==3&&g.length!==4)return y.error("Expected two or three arguments.");const b=g[0];let E=y.parse(g[1],1,Ln);if(!E)return null;if(!mp(b,E.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${Wi(E.type)}'.`);let M=y.parse(g[2],2,Ln);if(!M)return null;if(!mp(b,M.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${Wi(M.type)}'.`);if(E.type.kind!==M.type.kind&&E.type.kind!=="value"&&M.type.kind!=="value")return y.error(`Cannot compare types '${Wi(E.type)}' and '${Wi(M.type)}'.`);c&&(E.type.kind==="value"&&M.type.kind!=="value"?E=new zr(M.type,[E]):E.type.kind!=="value"&&M.type.kind==="value"&&(M=new zr(E.type,[M])));let R=null;if(g.length===4){if(E.type.kind!=="string"&&M.type.kind!=="string"&&E.type.kind!=="value"&&M.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(R=y.parse(g[3],3,Om),!R)return null}return new iV(E,M,R)}evaluate(g){const y=this.lhs.evaluate(g),b=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){const E=xa(y),M=xa(b);if(E.kind!==M.kind||E.kind!=="string"&&E.kind!=="number")throw new Yi(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${E.kind}, ${M.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const E=xa(y),M=xa(b);if(E.kind!=="string"||M.kind!=="string")return e(g,y,b)}return this.collator?i(g,y,b,this.collator.evaluate(g)):e(g,y,b)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[s];return this.eachChild(y=>{g.push(y.serialize())}),g}}}const nf=Wh("==",function(s,e,i){return e===i},rf),p_=Wh("!=",function(s,e,i){return e!==i},function(s,e,i,c){return!rf(0,e,i,c)}),gp=Wh("<",function(s,e,i){return e<i},function(s,e,i,c){return c.compare(e,i)<0}),_p=Wh(">",function(s,e,i){return e>i},function(s,e,i,c){return c.compare(e,i)>0}),yp=Wh("<=",function(s,e,i){return e<=i},function(s,e,i,c){return c.compare(e,i)<=0}),_v=Wh(">=",function(s,e,i){return e>=i},function(s,e,i,c){return c.compare(e,i)>=0});class Ec{constructor(e,i,c,f,g,y){this.type=En,this.number=e,this.locale=i,this.currency=c,this.unit=f,this.minFractionDigits=g,this.maxFractionDigits=y}static parse(e,i){if(e.length!==3)return i.error("Expected two arguments.");const c=i.parse(e[1],1,_r);if(!c)return null;const f=e[2];if(typeof f!="object"||Array.isArray(f))return i.error("NumberFormat options argument must be an object.");let g=null;if(f.locale&&(g=i.parseObjectValue(f.locale,2,"locale",En),!g))return null;let y=null;if(f.currency&&(y=i.parseObjectValue(f.currency,2,"currency",En),!y))return null;let b=null;if(f.unit&&(b=i.parseObjectValue(f.unit,2,"unit",En),!b))return null;let E=null;if(f["min-fraction-digits"]&&(E=i.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",_r),!E))return null;let M=null;return f["max-fraction-digits"]&&(M=i.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",_r),!M)?null:new Ec(c,g,y,b,E,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class du{constructor(e){this.type=_r,this.input=e}static parse(e,i){if(e.length!==2)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=i.parse(e[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Wi(c.type)} instead.`):new du(c):null}evaluate(e){const i=this.input.evaluate(e);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Yi(`Expected value to be of type string or array, but found ${Wi(xa(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}function m_(s){return function(){s=1831565813+(s|=0)|0;let e=Math.imul(s^s>>>15,1|s);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const Ju={"==":nf,"!=":p_,">":_p,"<":gp,">=":_v,"<=":yp,array:zr,at:Jd,"at-interpolated":uu,boolean:zr,case:fp,coalesce:cu,collator:Ps,format:mr,image:Uh,in:Qu,"index-of":ef,interpolate:Si,"interpolate-hcl":Si,"interpolate-lab":Si,length:du,let:el,literal:Ws,match:tf,number:zr,"number-format":Ec,object:zr,slice:pp,step:Vl,string:zr,"to-boolean":vc,"to-color":vc,"to-number":vc,"to-string":vc,var:Ul,within:ru,distance:au,config:Wu,split:hu};function eh(s,[e,i,c,f]){e=e.evaluate(s),i=i.evaluate(s),c=c.evaluate(s);const g=f?f.evaluate(s):1,y=c_(e,i,c,g);if(y)throw new Yi(y);return new Cn(e/255,i/255,c/255,g)}function af(s,[e,i,c,f]){e=e.evaluate(s),i=i.evaluate(s),c=c.evaluate(s);const g=f?f.evaluate(s):1,y=(function(M,R,z,B){return typeof M=="number"&&M>=0&&M<=360?typeof R=="number"&&R>=0&&R<=100&&typeof z=="number"&&z>=0&&z<=100?B===void 0||typeof B=="number"&&B>=0&&B<=1?null:`Invalid hsla value [${[M,R,z,B].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof B=="number"?[M,R,z,B]:[M,R,z]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof B=="number"?[M,R,z,B]:[M,R,z]).join(", ")}]: 'h' must be between 0 and 360.`})(e,i,c,g);if(y)throw new Yi(y);const b=`hsla(${e}, ${i}%, ${c}%, ${g})`,E=Cn.parse(b);if(!E)throw new Yi(`Failed to parse HSLA color: ${b}`);return E}function vp(s,e){return s in e}function Yh(s,e){const i=e[s];return i===void 0?null:i}function Gl(s){return{type:s}}function th(s){if(s instanceof Wu)return new Set([s.key]);let e=new Set;return s.eachChild(i=>{e=new Set([...e,...th(i)])}),e}function Mc(s){if(s instanceof cs&&s.name==="is-active-floor")return!0;let e=!1;return s.eachChild(i=>{!e&&Mc(i)&&(e=!0)}),e}function g_(s){return{result:"success",value:s}}function fs(s){return{result:"error",value:s}}function xp(s,e){return!!s&&!!s.parameters&&s.parameters.indexOf(e)>-1}function of(s){return s["property-type"]==="data-driven"}function Oc(s){return xp(s.expression,"measure-light")}function fu(s){return xp(s.expression,"zoom")}function Kh(s){return!!s.expression&&s.expression.interpolated}function sf(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function Gm(s){return s}function Qh(s,e){const i=e.type==="color",c=s.stops&&typeof s.stops[0][0]=="object",f=c||!(c||s.property!==void 0),g=s.type||(Kh(e)?"exponential":"interval");if(i&&((s=Object.assign({},s)).stops&&(s.stops=s.stops.map(M=>[M[0],Cn.parse(M[1])])),s.default=Cn.parse(s.default?s.default:e.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!gv[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let y,b,E;if(g==="exponential")y=ed;else if(g==="interval")y=yv;else if(g==="categorical"){y=Jh,b=Object.create(null);for(const M of s.stops)b[M[0]]=M[1];E=typeof s.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);y=$m}if(c){const M={},R=[];for(let j=0;j<s.stops.length;j++){const V=s.stops[j],Y=V[0].zoom;M[Y]===void 0&&(M[Y]={zoom:Y,type:s.type,property:s.property,default:s.default,stops:[]},R.push(Y)),M[Y].stops.push([V[0].value,V[1]])}const z=[];for(const j of R)z.push([M[j].zoom,Qh(M[j],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Si.interpolationFactor.bind(void 0,B),zoomStops:z.map(j=>j[0]),evaluate:({zoom:j},V)=>ed({stops:z,base:s.base},e,j).evaluate(j,V)}}if(f){const M=g==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:Si.interpolationFactor.bind(void 0,M),zoomStops:s.stops.map(R=>R[0]),evaluate:({zoom:R})=>y(s,e,R,b,E)}}return{kind:"source",evaluate(M,R){const z=R&&R.properties?R.properties[s.property]:void 0;return z===void 0?pu(s.default,e.default):y(s,e,z,b,E)}}}function pu(s,e,i){return s!==void 0?s:e!==void 0?e:i!==void 0?i:void 0}function Jh(s,e,i,c,f){return pu(typeof i===f?c[i]:void 0,s.default,e.default)}function yv(s,e,i){if(!Cr(i))return pu(s.default,e.default);const c=s.stops.length;if(c===1||i<=s.stops[0][0])return s.stops[0][1];if(i>=s.stops[c-1][0])return s.stops[c-1][1];const f=ou(s.stops.map(g=>g[0]),i);return s.stops[f][1]}function ed(s,e,i){const c=s.base!==void 0?s.base:1;if(!Cr(i))return pu(s.default,e.default);const f=s.stops.length;if(f===1||i<=s.stops[0][0])return s.stops[0][1];if(i>=s.stops[f-1][0])return s.stops[f-1][1];const g=ou(s.stops.map(R=>R[0]),i),y=(function(R,z,B,j){const V=j-B,Y=R-B;return V===0?0:z===1?Y/V:(Math.pow(z,Y)-1)/(Math.pow(z,V)-1)})(i,c,s.stops[g][0],s.stops[g+1][0]),b=s.stops[g][1],E=s.stops[g+1][1];let M=Nh[e.type]||Gm;if(s.colorSpace&&s.colorSpace!=="rgb"){const R=gv[s.colorSpace];M=(z,B)=>R.reverse(R.interpolate(R.forward(z),R.forward(B),y))}return typeof b.evaluate=="function"?{evaluate(...R){const z=b.evaluate.apply(void 0,R),B=E.evaluate.apply(void 0,R);if(z!==void 0&&B!==void 0)return M(z,B,y)}}:M(b,E,y)}function $m(s,e,i){return e.type==="color"?i=Cn.parse(i):e.type==="formatted"?i=xo.fromString(i.toString()):e.type==="resolvedImage"?i=ls.build(i.toString()):Rr(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),pu(i,s.default,e.default)}cs.register(Ju,{error:[{kind:"error"},[En],(s,[e])=>{throw new Yi(e.evaluate(s))}],typeof:[En,[Ln],(s,[e])=>Wi(xa(e.evaluate(s)))],"to-rgba":[Ro(_r,4),[Zo],(s,[e])=>e.evaluate(s).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Ro(_r,4),[Zo],(s,[e])=>e.evaluate(s).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Zo,[_r,_r,_r],eh],rgba:[Zo,[_r,_r,_r,_r],eh],hsl:[Zo,[_r,_r,_r],af],hsla:[Zo,[_r,_r,_r,_r],af],has:{type:bn,overloads:[[[En],(s,[e])=>vp(e.evaluate(s),s.properties())],[[En,Nd],(s,[e,i])=>vp(e.evaluate(s),i.evaluate(s))]]},get:{type:Ln,overloads:[[[En],(s,[e])=>Yh(e.evaluate(s),s.properties())],[[En,Nd],(s,[e,i])=>Yh(e.evaluate(s),i.evaluate(s))]]},"feature-state":[Ln,[En],(s,[e])=>Yh(e.evaluate(s),s.featureState||{})],properties:[Nd,[],s=>s.properties()],"geometry-type":[En,[],s=>s.geometryType()],worldview:[En,[],s=>s.globals.worldview||""],"is-active-floor":[bn,Gl(En),(s,e)=>{if(!(s.globals.activeFloors&&s.globals.activeFloors.size>0))return!1;const i=s.globals.activeFloors;return e.some(c=>{const f=c.evaluate(s);return i.has(f)})}],id:[Ln,[],s=>s.id()],zoom:[_r,[],s=>s.globals.zoom],pitch:[_r,[],s=>s.globals.pitch||0],"distance-from-center":[_r,[],s=>s.distanceFromCenter()],"measure-light":[_r,[En],(s,[e])=>s.measureLight(e.evaluate(s))],"heatmap-density":[_r,[],s=>s.globals.heatmapDensity||0],"line-progress":[_r,[],s=>s.globals.lineProgress||0],"raster-value":[_r,[],s=>s.globals.rasterValue||0],"raster-particle-speed":[_r,[],s=>s.globals.rasterParticleSpeed||0],"sky-radial-progress":[_r,[],s=>s.globals.skyRadialProgress||0],accumulated:[Ln,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[_r,Gl(_r),(s,e)=>{let i=0;for(const c of e)i+=c.evaluate(s);return i}],"*":[_r,Gl(_r),(s,e)=>{let i=1;for(const c of e)i*=c.evaluate(s);return i}],"-":{type:_r,overloads:[[[_r,_r],(s,[e,i])=>e.evaluate(s)-i.evaluate(s)],[[_r],(s,[e])=>-e.evaluate(s)]]},"/":[_r,[_r,_r],(s,[e,i])=>e.evaluate(s)/i.evaluate(s)],"%":[_r,[_r,_r],(s,[e,i])=>e.evaluate(s)%i.evaluate(s)],ln2:[_r,[],()=>Math.LN2],pi:[_r,[],()=>Math.PI],e:[_r,[],()=>Math.E],"^":[_r,[_r,_r],(s,[e,i])=>Math.pow(e.evaluate(s),i.evaluate(s))],sqrt:[_r,[_r],(s,[e])=>Math.sqrt(e.evaluate(s))],log10:[_r,[_r],(s,[e])=>Math.log(e.evaluate(s))/Math.LN10],ln:[_r,[_r],(s,[e])=>Math.log(e.evaluate(s))],log2:[_r,[_r],(s,[e])=>Math.log2(e.evaluate(s))],sin:[_r,[_r],(s,[e])=>Math.sin(e.evaluate(s))],cos:[_r,[_r],(s,[e])=>Math.cos(e.evaluate(s))],tan:[_r,[_r],(s,[e])=>Math.tan(e.evaluate(s))],asin:[_r,[_r],(s,[e])=>Math.asin(e.evaluate(s))],acos:[_r,[_r],(s,[e])=>Math.acos(e.evaluate(s))],atan:[_r,[_r],(s,[e])=>Math.atan(e.evaluate(s))],min:[_r,Gl(_r),(s,e)=>Math.min(...e.map(i=>i.evaluate(s)))],max:[_r,Gl(_r),(s,e)=>Math.max(...e.map(i=>i.evaluate(s)))],abs:[_r,[_r],(s,[e])=>Math.abs(e.evaluate(s))],round:[_r,[_r],(s,[e])=>{const i=e.evaluate(s);return i<0?-Math.round(-i):Math.round(i)}],floor:[_r,[_r],(s,[e])=>Math.floor(e.evaluate(s))],ceil:[_r,[_r],(s,[e])=>Math.ceil(e.evaluate(s))],"filter-==":[bn,[En,Ln],(s,[e,i])=>s.properties()[e.value]===i.value],"filter-id-==":[bn,[Ln],(s,[e])=>s.id()===e.value],"filter-type-==":[bn,[En],(s,[e])=>s.geometryType()===e.value],"filter-<":[bn,[En,Ln],(s,[e,i])=>{const c=s.properties()[e.value],f=i.value;return typeof c==typeof f&&c<f}],"filter-id-<":[bn,[Ln],(s,[e])=>{const i=s.id(),c=e.value;return typeof i==typeof c&&i<c}],"filter->":[bn,[En,Ln],(s,[e,i])=>{const c=s.properties()[e.value],f=i.value;return typeof c==typeof f&&c>f}],"filter-id->":[bn,[Ln],(s,[e])=>{const i=s.id(),c=e.value;return typeof i==typeof c&&i>c}],"filter-<=":[bn,[En,Ln],(s,[e,i])=>{const c=s.properties()[e.value],f=i.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[bn,[Ln],(s,[e])=>{const i=s.id(),c=e.value;return typeof i==typeof c&&i<=c}],"filter->=":[bn,[En,Ln],(s,[e,i])=>{const c=s.properties()[e.value],f=i.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[bn,[Ln],(s,[e])=>{const i=s.id(),c=e.value;return typeof i==typeof c&&i>=c}],"filter-has":[bn,[Ln],(s,[e])=>e.value in s.properties()],"filter-has-id":[bn,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[bn,[Ro(En)],(s,[e])=>e.value.indexOf(s.geometryType())>=0],"filter-id-in":[bn,[Ro(Ln)],(s,[e])=>e.value.indexOf(s.id())>=0],"filter-in-small":[bn,[En,Ro(Ln)],(s,[e,i])=>i.value.indexOf(s.properties()[e.value])>=0],"filter-in-large":[bn,[En,Ro(Ln)],(s,[e,i])=>(function(c,f,g,y){for(;g<=y;){const b=g+y>>1;if(f[b]===c)return!0;f[b]>c?y=b-1:g=b+1}return!1})(s.properties()[e.value],i.value,0,i.value.length-1)],all:{type:bn,overloads:[[[bn,bn],(s,[e,i])=>e.evaluate(s)&&i.evaluate(s)],[Gl(bn),(s,e)=>{for(const i of e)if(!i.evaluate(s))return!1;return!0}]]},any:{type:bn,overloads:[[[bn,bn],(s,[e,i])=>e.evaluate(s)||i.evaluate(s)],[Gl(bn),(s,e)=>{for(const i of e)if(i.evaluate(s))return!0;return!1}]]},"!":[bn,[bn],(s,[e])=>!e.evaluate(s)],"is-supported-script":[bn,[En],(s,[e])=>{const i=s.globals&&s.globals.isSupportedScript;return!i||i(e.evaluate(s))}],upcase:[En,[En],(s,[e])=>e.evaluate(s).toUpperCase()],downcase:[En,[En],(s,[e])=>e.evaluate(s).toLowerCase()],concat:[En,Gl(Ln),(s,e)=>e.map(i=>Bl(i.evaluate(s))).join("")],"resolved-locale":[En,[Om],(s,[e])=>e.evaluate(s).resolvedLocale()],random:[_r,[_r,_r,Ln],(s,e)=>{const[i,c,f]=e.map(y=>y.evaluate(s));if(i>c||i===c)return i;let g;if(typeof f=="string")g=(function(y){let b=0;if(y.length===0)return b;for(let E=0;E<y.length;E++)b=(b<<5)-b+y.charCodeAt(E),b&=b;return b})(f);else{if(typeof f!="number")throw new Yi(`Invalid seed input: ${f}`);g=f}return i+m_(g)()*(c-i)}]});class bp{constructor(e,i,c,f,g){this.expression=e,this._warningHistory={},this._scope=c,this._options=f,this._iconImageUseTheme=g,this._evaluator=new $d(c,f,g),this._defaultValue=i?(function(y){return y.type==="color"&&(sf(y.default)||Array.isArray(y.default))?new Cn(0,0,0,0):y.type==="color"?Cn.parse(y.default)||null:y.default===void 0?null:y.default})(i):null,this._enumValues=i&&i.type==="enum"?i.values:null,this.configDependencies=th(e),this.isIndoorDependent=Mc(e)}evaluateWithoutErrorHandling(e,i,c,f,g,y,b,E){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,c,f,g,y,b,E,M){this._evaluator||(this._evaluator=new $d(this._scope,this._options,this._iconImageUseTheme)),this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this._evaluator.iconImageUseTheme=M||null;try{const R=this.expression.evaluate(this._evaluator);if(R==null||typeof R=="number"&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new Yi(`Expected value to be one of ${Object.keys(this._enumValues).map(z=>JSON.stringify(z)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){const z=R;return this._warningHistory[z.message]||(this._warningHistory[z.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${z.message}`)),this._defaultValue}}}function td(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in Ju}function Cc(s,e,i,c,f){const g=new cp(Ju,[],e?(function(b){const E={color:Zo,string:En,number:_r,enum:En,boolean:bn,formatted:jd,resolvedImage:jh};return b.type==="array"?Ro(E[b.value]||Ln,b.length):E[b.type]})(e):void 0,void 0,void 0,i,c,f),y=g.parse(s,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?g_(new bp(y,e,i,c,f)):fs(g.errors)}class Lo{constructor(e,i,c,f){this.kind=e,this._styleExpression=i,this.isLightConstant=c,this.isLineProgressConstant=f,this.isStateDependent=e!=="constant"&&!Fa(i.expression),this.configDependencies=th(i.expression),this.isIndoorDependent=Mc(i.expression)}evaluateWithoutErrorHandling(e,i,c,f,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,c,f,g,y)}evaluate(e,i,c,f,g,y,b){return this._styleExpression.evaluate(e,i,c,f,g,y,void 0,void 0,b)}}class wo{constructor(e,i,c,f,g,y){this.kind=e,this.zoomStops=c,this._styleExpression=i,this.isStateDependent=e!=="camera"&&!Fa(i.expression),this.isIndoorDependent=Mc(i.expression),this.isLightConstant=g,this.isLineProgressConstant=y,this.configDependencies=th(i.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,i,c,f,g,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,c,f,g,y)}evaluate(e,i,c,f,g,y){return this._styleExpression.evaluate(e,i,c,f,g,y)}interpolationFactor(e,i,c){return this.interpolationType?Si.interpolationFactor(this.interpolationType,e,i,c):0}}function $l(s,e,i,c,f){if((s=Cc(s,e,i,c,f)).result==="error")return s;const g=s.value.expression,y=Xh(g);if(!y&&!of(e))return fs([new vo("","data expressions not supported")]);const b=Fi(g,["zoom","pitch","distance-from-center"]);if(!b&&!fu(e))return fs([new vo("","zoom expressions not supported")]);const E=Fi(g,["measure-light"]);if(!E&&!Oc(e))return fs([new vo("","measure-light expression not supported")]);const M=Fi(g,["line-progress"]);if(!M&&!(function(B){return xp(B.expression,"line-progress")})(e))return fs([new vo("","line-progress expression not supported")]);const R=e.expression&&e.expression.relaxZoomRestriction,z=wp(g);return z||b||R?z instanceof vo?fs([z]):z instanceof Si&&!Kh(e)?fs([new vo("",'"interpolate" expressions cannot be used with this property')]):g_(z?new wo(y&&M?"camera":"composite",s.value,z.labels,z instanceof Si?z.interpolation:void 0,E,M):new Lo(y&&M?"constant":"source",s.value,E,M)):fs([new vo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class rd{constructor(e,i){this._parameters=e,this._specification=i,Object.assign(this,Qh(this._parameters,this._specification))}static deserialize(e){return new rd(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function wp(s){let e=null;if(s instanceof el)e=wp(s.result);else if(s instanceof cu){for(const i of s.args)if(e=wp(i),e)break}else(s instanceof Vl||s instanceof Si)&&s.input instanceof cs&&s.input.name==="zoom"&&(e=s);return e instanceof vo||s.eachChild(i=>{const c=wp(i);c instanceof vo?e=c:e&&c&&e!==c&&(e=new vo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}var Bo,Rs,Na=(function(){if(Rs)return Bo;Rs=1,Bo=e;var s=3;function e(i,c,f){var g=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var y=new Int32Array(this.arrayBuffer);i=y[0],this.d=(c=y[1])+2*(f=y[2]);for(var b=0;b<this.d*this.d;b++){var E=y[s+b],M=y[s+b+1];g.push(E===M?null:y.subarray(E,M))}var R=y[s+g.length+1];this.keys=y.subarray(y[s+g.length],R),this.bboxes=y.subarray(R),this.insert=this._insertReadonly}else{this.d=c+2*f;for(var z=0;z<this.d*this.d;z++)g.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=i,this.padding=f,this.scale=c/i,this.uid=0;var B=f/c*i;this.min=-B,this.max=i+B}return e.prototype.insert=function(i,c,f,g,y){this._forEachCell(c,f,g,y,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(y)},e.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},e.prototype._insertCell=function(i,c,f,g,y,b){this.cells[y].push(b)},e.prototype.query=function(i,c,f,g,y){var b=this.min,E=this.max;if(i<=b&&c<=b&&E<=f&&E<=g&&!y)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(i,c,f,g,this._queryCell,M,{},y),M},e.prototype._queryCell=function(i,c,f,g,y,b,E,M){var R=this.cells[y];if(R!==null)for(var z=this.keys,B=this.bboxes,j=0;j<R.length;j++){var V=R[j];if(E[V]===void 0){var Y=4*V;(M?M(B[Y+0],B[Y+1],B[Y+2],B[Y+3]):i<=B[Y+2]&&c<=B[Y+3]&&f>=B[Y+0]&&g>=B[Y+1])?(E[V]=!0,b.push(z[V])):E[V]=!1}}},e.prototype._forEachCell=function(i,c,f,g,y,b,E,M){for(var R=this._convertToCellCoord(i),z=this._convertToCellCoord(c),B=this._convertToCellCoord(f),j=this._convertToCellCoord(g),V=R;V<=B;V++)for(var Y=z;Y<=j;Y++){var re=this.d*Y+V;if((!M||M(this._convertFromCellCoord(V),this._convertFromCellCoord(Y),this._convertFromCellCoord(V+1),this._convertFromCellCoord(Y+1)))&&y.call(this,i,c,f,g,re,b,E,M))return}},e.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},e.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},e.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,c=s+this.cells.length+1+1,f=0,g=0;g<this.cells.length;g++)f+=this.cells[g].length;var y=new Int32Array(c+f+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var b=c,E=0;E<i.length;E++){var M=i[E];y[s+E]=b,y.set(M,b),b+=M.length}return y[s+i.length]=b,y.set(this.keys,b),y[s+i.length+1]=b+=this.keys.length,y.set(this.bboxes,b),b+=this.bboxes.length,y.buffer},Bo})(),Ic=Xa(Na);const xl={};function jt(s,e,i={}){Object.defineProperty(s,"_classRegistryKey",{value:e,writable:!1}),xl[e]={klass:s,omit:i.omit||[]}}jt(Object,"Object"),Ic.serialize=function(s,e){const i=s.toArrayBuffer();return e&&e.add(i),{buffer:i}},Ic.deserialize=function(s){return new Ic(s.buffer)},Object.defineProperty(Ic,"name",{value:"Grid"}),jt(Ic,"Grid"),delete yt.prototype.constructor,jt(Cn,"Color"),jt(Error,"Error"),jt(xo,"Formatted"),jt(tp,"FormattedSection"),jt(Bh,"AJAXError"),jt(ls,"ResolvedImage"),jt(rd,"StylePropertyFunction"),jt(bp,"StyleExpression",{omit:["_evaluator"]}),jt(Do,"ImageId"),jt(Wa,"ImageVariant"),jt(wo,"ZoomDependentExpression"),jt(Lo,"ZoomConstantExpression"),jt(cs,"CompoundExpression",{omit:["_evaluate"]});for(const s in Ju)xl[Ju[s]._classRegistryKey]||jt(Ju[s],`Expression${s}`);function Ni(s){return s&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function ji(s,e){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Ni(s)||s instanceof ImageBitmap)return e&&e.add(s),s;if(ArrayBuffer.isView(s))return e&&e.add(s.buffer),s;if(s instanceof ImageData)return e&&e.add(s.data.buffer),s;if(Array.isArray(s)){const i=[];for(const c of s)i.push(ji(c,e));return i}if(s instanceof Map){const i={$name:"Map",entries:[]};for(const[c,f]of s.entries())i.entries.push(ji(c),ji(f,e));return i}if(s instanceof Set){const i={$name:"Set"};let c=0;for(const f of s.values())i[++c]=ji(f);return i}if(typeof s=="bigint")return{$name:"BigInt",value:s.toString()};if(typeof s=="object"){const i=s.constructor,c=i._classRegistryKey;if(!c)throw new Error(`Can't serialize object of unregistered class "${i.name}".`);const f=i.serialize?i.serialize(s,e):{};if(!i.serialize){for(const g in s)s.hasOwnProperty(g)&&(xl[c].omit.indexOf(g)>=0||(f[g]=ji(s[g],e)));s instanceof Error&&(f.message=s.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof s)}function bl(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Ni(s)||s instanceof ImageBitmap||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(bl);if(typeof s=="object"){const e=s.$name||"Object";if(e==="Map"){const f=s.entries||[],g=new Map;for(let y=0;y<f.length;y+=2)g.set(bl(f[y]),bl(f[y+1]));return g}if(e==="Set"){const f=new Set;for(const g of Object.keys(s))g!=="$name"&&f.add(bl(s[g]));return f}if(e==="BigInt")return BigInt(s.value);const{klass:i}=xl[e];if(!i)throw new Error(`Can't deserialize unregistered class "${e}".`);if(i.deserialize)return i.deserialize(s);const c=Object.create(i.prototype);for(const f of Object.keys(s))f!=="$name"&&(c[f]=bl(s[f]));return c}throw new Error("can't deserialize object of type "+typeof s)}const nd=s=>s>=1536&&s<=1791,rh=s=>s>=1872&&s<=1919,id=s=>s>=2208&&s<=2303,nh=s=>s>=11904&&s<=12031,ih=s=>s>=12032&&s<=12255,__=s=>s>=12272&&s<=12287,Ki=s=>s>=12288&&s<=12351,ah=s=>s>=12352&&s<=12447,ad=s=>s>=12448&&s<=12543,ql=s=>s>=12544&&s<=12591,y_=s=>s>=12704&&s<=12735,vv=s=>s>=12736&&s<=12783,qm=s=>s>=12784&&s<=12799,Hm=s=>s>=12800&&s<=13055,Ap=s=>s>=13056&&s<=13311,Ya=s=>s>=13312&&s<=19903,fa=s=>s>=19968&&s<=40959,lf=s=>s>=40960&&s<=42127,oh=s=>s>=42128&&s<=42191,Tp=s=>s>=44032&&s<=55215,Xm=s=>s>=63744&&s<=64255,Hl=s=>s>=64336&&s<=65023,Sp=s=>s>=65040&&s<=65055,Ep=s=>s>=65072&&s<=65103,Zm=s=>s>=65104&&s<=65135,Wm=s=>s>=65136&&s<=65279,Ym=s=>s>=65280&&s<=65519;function Km(s){for(const e of s)if(Pc(e.charCodeAt(0)))return!0;return!1}function xv(s){for(const e of s)if(!bv(e.charCodeAt(0)))return!1;return!0}function bv(s){return!(nd(s)||rh(s)||id(s)||Hl(s)||Wm(s))}function v_(s){return!(s<11904||!(y_(s)||ql(s)||Ep(s)||Xm(s)||Ap(s)||nh(s)||vv(s)||Ki(s)||Ya(s)||fa(s)||Hm(s)||Ym(s)||ah(s)||__(s)||ih(s)||qm(s)||ad(s)||Sp(s)||oh(s)||lf(s)))}function Pc(s){return!(s!==746&&s!==747&&(s<4352||!(y_(s)||ql(s)||Ep(s)&&!(s>=65097&&s<=65103)||Xm(s)||Ap(s)||nh(s)||vv(s)||!(!Ki(s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Ya(s)||fa(s)||Hm(s)||(e=>e>=12592&&e<=12687)(s)||(e=>e>=43360&&e<=43391)(s)||(e=>e>=55216&&e<=55295)(s)||(e=>e>=4352&&e<=4607)(s)||Tp(s)||ah(s)||__(s)||(e=>e>=12688&&e<=12703)(s)||ih(s)||qm(s)||ad(s)&&s!==12540||!(!Ym(s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Zm(s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||(e=>e>=5120&&e<=5759)(s)||(e=>e>=6320&&e<=6399)(s)||Sp(s)||(e=>e>=19904&&e<=19967)(s)||lf(s)||oh(s))))}function x_(s){return s===12312||s===12313||s===12316||s===12540||s===12448}function b_(s){return!(Pc(s)||(function(e){return!!((i=>i>=128&&i<=255)(e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||(i=>i>=8192&&i<=8303)(e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&e!==9251||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ki(e)||ad(e)||(i=>i>=57344&&i<=63743)(e)||Ep(e)||Zm(e)||Ym(e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)})(s))}function Mp(s){return nd(s)||rh(s)||id(s)||Hl(s)||Wm(s)}function w_(s){return s>=1424&&s<=2303||Hl(s)||Wm(s)}function wv(s,e){return!(!e&&w_(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||(i=>i>=6016&&i<=6143)(s))}function Dc(s){for(const e of s)if(w_(e.charCodeAt(0)))return!0;return!1}const Qo={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let mu=null,ko=Qo.unavailable,gu=null;const A_=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(ko=Qo.error),mu&&mu(s)};function T_(){Qm.fire(new gl("pluginStateChange",{pluginStatus:ko,pluginURL:gu}))}const Qm=new Qc,sh=function(){return ko},Jm=function(){if(ko!==Qo.deferred||!gu)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ko=Qo.loading,T_(),gu&&kh({url:gu},s=>{s?A_(s):(ko=Qo.loaded,T_())})},zs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ko===Qo.loaded||zs.applyArabicShaping!=null,isLoading:()=>ko===Qo.loading,setState(s){ko=s.pluginStatus,gu=s.pluginURL},isParsing:()=>ko===Qo.parsing,isParsed:()=>ko===Qo.parsed,getPluginURL:()=>gu};class In{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch,this.brightness=i.brightness,this.worldview=i.worldview,this.activeFloors=i.activeFloors):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return(function(i,c){for(const f of i)if(!wv(f.charCodeAt(0),c))return!1;return!0})(e,zs.isLoaded())}}class cf{constructor(e,i,c,f,g){this.property=e,this.value=i,this.expression=(function(y,b,E,M,R){if(sf(y))return new rd(y,b);if(td(y)||Array.isArray(y)&&y.length>0){const z=$l(y,b,E,M,R);if(z.result==="error")throw new Error(z.value.map(B=>`${B.key}: ${B.message}`).join(", "));return z.value}{let z=y;return typeof y=="string"&&b.type==="color"&&(z=Cn.parse(y)),{kind:"constant",configDependencies:new Set,isIndoorDependent:!1,evaluate:()=>z}}})(i===void 0?e.specification.default:i,e.specification,c,f,g)}isIndoorDependent(){return this.expression.isIndoorDependent}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,i,c,f){return this.property.possiblyEvaluate(this,e,i,c,f)}}class od{constructor(e,i,c,f){this.property=e,this.value=new cf(e,void 0,i,c,f)}transitioned(e,i){return new S_(this.property,this.value,i,Object.assign({},e.transition,this.transition),e.now)}untransitioned(){return new S_(this.property,this.value,null,{},0)}}class uf{constructor(e,i,c,f){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._scope=i,this._options=c,this._iconImageUseTheme=f,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(e){return Br(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new od(this._values[e].property,this._scope,this._options,this._iconImageUseTheme)),this._values[e].value=new cf(this._values[e].property,i===null?void 0:Br(i),this._scope,this._options,this._iconImageUseTheme),this._values[e].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].value.expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[e].value.isIndoorDependent())}setTransitionOrValue(e,i){i&&(this._options=i);const c=this._properties.properties;if(e)for(const f in e){const g=e[f];if(f.endsWith("-transition")){const y=f.slice(0,-11);c[y]&&this.setTransition(y,g)}else c.hasOwnProperty(f)&&this.setValue(f,g)}}getTransition(e){return Br(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new od(this._values[e].property)),this._values[e].transition=Br(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(e[i]=c);const f=this.getTransition(i);f!==void 0&&(e[`${i}-transition`]=f)}return e}transitioned(e,i){const c=new E_(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(e,i._values[f]);return c}untransitioned(){const e=new E_(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}isIndoorDependent(){return this._isIndoorDependent}}class S_{constructor(e,i,c,f,g){const y=f.delay||0,b=f.duration||0;g=g||0,this.property=e,this.value=i,this.begin=g+y,this.end=this.begin+b,e.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(e,i,c){const f=e.now||0,g=this.value.possiblyEvaluate(e,i,c),y=this.prior;if(y){if(f>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(f<this.begin)return y.possiblyEvaluate(e,i,c);{const b=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,i,c),g,de(b))}}return g}}class E_{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,c){const f=new Fo(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].possiblyEvaluate(e,i,c);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class eg{constructor(e,i,c,f){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._scope=i,this._options=c,this._iconImageUseTheme=f,this._isIndoorDependent=!1,this.configDependencies=new Set}getValue(e){return Br(this._values[e].value)}setValue(e,i){this._values[e]=new cf(this._values[e].property,i===null?void 0:Br(i),this._scope,this._options,this._iconImageUseTheme),this._values[e].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[e].expression.configDependencies]),this._isIndoorDependent=this._isIndoorDependent||this._values[e].isIndoorDependent())}serialize(){const e={};for(const i of Object.keys(this._values)){const c=this.getValue(i);c!==void 0&&(e[i]=c)}return e}possiblyEvaluate(e,i,c,f){const g=new Fo(this._properties);for(const y of Object.keys(this._values))g._values[y]=this._values[y].possiblyEvaluate(e,i,c,f);return g}isIndoorDependent(){return this._isIndoorDependent}}class lh{constructor(e,i,c,f){this.property=e,this.value=i,this.parameters=c,this.iconImageUseTheme=f}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,i,c,f){return this.property.evaluate(this.value,this.parameters,e,i,c,f,this.iconImageUseTheme)}}class Fo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ft{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,c){const f=Nh[this.specification.type];return f?f(e,i,c):e}}class Qt{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,c,f,g){return e.expression.kind==="constant"||e.expression.kind==="camera"?new lh(this,{kind:"constant",value:e.expression.evaluate(i,null,{},c,f,void 0,g)},i):new lh(this,e.expression,i,g)}interpolate(e,i,c){if(e.value.kind!=="constant"||i.value.kind!=="constant")return e;if(e.value.value===void 0||i.value.value===void 0)return new lh(this,{kind:"constant",value:void 0},e.parameters);const f=Nh[this.specification.type];return f?new lh(this,{kind:"constant",value:f(e.value.value,i.value.value,c)},e.parameters):e}evaluate(e,i,c,f,g,y,b){return e.kind==="constant"?e.value:e.evaluate(i,c,f,g,y,void 0,b)}}class sd{constructor(e){this.specification=e}possiblyEvaluate(e,i,c,f){return!!e.expression.evaluate(i,null,{},c,f)}interpolate(){return!1}}class vi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new In(0,{});for(const c in e){const f=e[c];f.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new cf(f,void 0),y=this.defaultTransitionablePropertyValues[c]=new od(f);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate(i)}}}jt(Qt,"DataDrivenProperty"),jt(Ft,"DataConstantProperty"),jt(sd,"ColorRampProperty");var Ye=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"shadow-draw-before-layer":{"type":"string"}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"url":{"type":"string"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"interpolated":true,"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"model-allow-density-reduction":{"type":"boolean","default":true}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":[0.1,0.1],"maximum":[10,10],"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor_source":{"sourceId":{"type":"string"},"sourceLayers":{"type":"array","value":"string"}},"indoor":{"*":{"type":"indoor_source"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function M_(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function tg(s){if(Array.isArray(s))return s.map(tg);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const e={};for(const i in s)e[i]=tg(s[i]);return e}return M_(s)}function Op(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const e of s.slice(1))if(!Op(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function rg(s,e="",i=null,c="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Op(s)||(s=hf(s));const f=s;let g=!0;try{g=(function(R){if(!ld(R))return R;let z=tg(R);return Cp(z),z=O_(z),z})(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let y=null,b=null;if(c!=="background"&&c!=="sky"&&c!=="slot"){b=Ye[`filter_${c}`];const R=Cc(g,b,e,i);if(R.result==="error")throw new Error(R.value.map(z=>`${z.key}: ${z.message}`).join(", "));y=(z,B,j)=>R.value.evaluate(z,B,{},j)}let E=null,M=null;if(g!==f){const R=Cc(f,b,e,i);if(R.result==="error")throw new Error(R.value.map(z=>`${z.key}: ${z.message}`).join(", "));E=(z,B,j,V,Y)=>R.value.evaluate(z,B,{},j,void 0,void 0,V,Y),M=!Xh(R.value.expression)}return{filter:y,dynamicFilter:E||void 0,needGeometry:C_(g),needFeature:!!M}}function O_(s){if(!Array.isArray(s))return s;const e=(function(i){if(Av.has(i[0])){for(let c=1;c<i.length;c++)if(ld(i[c]))return!0}return i})(s);return e===!0?e:e.map(i=>O_(i))}function Cp(s){let e=!1;const i=[];if(s[0]==="case"){for(let c=1;c<s.length-1;c+=2)e=e||ld(s[c]),i.push(s[c+1]);i.push(s[s.length-1])}else if(s[0]==="match"){e=e||ld(s[1]);for(let c=2;c<s.length-1;c+=2)i.push(s[c+1]);i.push(s[s.length-1])}else if(s[0]==="step"){e=e||ld(s[1]);for(let c=1;c<s.length-1;c+=2)i.push(s[c+1])}e&&(s.length=0,s.push("any",...i));for(let c=1;c<s.length;c++)Cp(s[c])}function ld(s){if(!Array.isArray(s))return!1;if((e=s[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let i=1;i<s.length;i++)if(ld(s[i]))return!0;return!1}const Av=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Tx(s,e){return s<e?-1:s>e?1:0}function C_(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let e=1;e<s.length;e++)if(C_(s[e]))return!0;return!1}function hf(s){if(!s)return!0;const e=s[0];return s.length<=1?e!=="any":e==="=="?Ls(s[1],s[2],"=="):e==="!="?Dp(Ls(s[1],s[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Ls(s[1],s[2],e):e==="any"?(i=s.slice(1),["any"].concat(i.map(hf))):e==="all"?["all"].concat(s.slice(1).map(hf)):e==="none"?["all"].concat(s.slice(1).map(hf).map(Dp)):e==="in"?Ip(s[1],s.slice(2)):e==="!in"?Dp(Ip(s[1],s.slice(2))):e==="has"?Pp(s[1]):e!=="!has"||Dp(Pp(s[1]));var i}function Ls(s,e,i){switch(s){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,s,e]}}function Ip(s,e){if(e.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",s,["literal",e.sort(Tx)]]:["filter-in-small",s,["literal",e]]}}function Pp(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Dp(s){return["!",s]}const df="";function Xl(s,e){return e?`${s}${df}${e}`:s}let ng;const Rp=()=>ng||(ng=new vi({"icon-size":new Qt(Ye.layout_symbol["icon-size"]),"icon-image":new Qt(Ye.layout_symbol["icon-image"]),"icon-rotate":new Qt(Ye.layout_symbol["icon-rotate"]),"icon-offset":new Qt(Ye.layout_symbol["icon-offset"]),"text-size":new Qt(Ye.layout_symbol["text-size"]),"text-rotate":new Qt(Ye.layout_symbol["text-rotate"]),"text-offset":new Qt(Ye.layout_symbol["text-offset"])}));class I_{constructor(e,i,c,f,g,y){const b=Cc(e,Ye.appearance.condition);if(b.result==="success"&&(this.condition=b.value),this.name=i,c){this.properties=new Fo(Rp()),this.unevaluatedLayout=new eg(Rp(),f,g,y);for(const E in c)this.unevaluatedLayout.setValue(E,c[E])}}isActive(e){return!(this.condition||!e.isHidden||this.name!=="hidden")||this.condition.evaluate(e.globals,e.feature,e.featureState,e.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(e){return this.properties.get(e)}getUnevaluatedProperties(){return this.unevaluatedLayout}getUnevaluatedProperty(e){return this.unevaluatedLayout._values[e]}recalculate(e,i,c){this.unevaluatedLayout&&(this.properties=this.unevaluatedLayout.possiblyEvaluate(e,void 0,i,c))}serialize(){const e={};return e.condition=this.condition.expression.serialize(),this.name&&(e.name=this.name),this.unevaluatedLayout&&(e.properties=this.unevaluatedLayout.serialize()),e}hasIconProperties(){const e=this.hasProperty("icon-image"),i=this.hasProperty("icon-size"),c=this.hasProperty("icon-offset"),f=this.hasProperty("icon-rotate");return e||i||c||f}hasTextProperties(){const e=this.hasProperty("text-size"),i=this.hasProperty("text-offset"),c=this.hasProperty("text-rotate");return e||i||c}hasProperty(e){return this.getUnevaluatedProperty(e).value!==void 0}}const ig="-transition",ag=new Set(["fill","line","background","hillshade","raster"]);class No extends Qc{constructor(e,i,c,f,g,y){if(super(),this.id=e.id,this.fqid=Xl(this.id,c),this.type=e.type,this.scope=c,this.lut=f,this.options=g,this.iconImageUseTheme=y,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.expressionDependencies={isIndoorDependent:!1,configDependencies:new Set},e.type!=="custom"){if(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type&&e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"){this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter;const b=Cc(this.filter,Ye[`filter_${e.type}`]);b.result!=="error"&&(this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...b.value.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||b.value.isIndoorDependent)}if(e.slot&&(this.slot=e.slot),e.appearances&&this.setAppearances(e.appearances),i.layout&&(this._unevaluatedLayout=new eg(i.layout,this.scope,g,this.iconImageUseTheme),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._unevaluatedLayout.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._unevaluatedLayout.isIndoorDependent()),i.paint){this._transitionablePaint=new uf(i.paint,this.scope,g);for(const b in e.paint)this.setPaintProperty(b,e.paint[b]);for(const b in e.layout)this.setLayoutProperty(b,e.layout[b]);this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...this._transitionablePaint.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||this._transitionablePaint.isIndoorDependent(),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fo(i.paint)}}}onAdd(e){}onRemove(e){}isDraped(e){return!this.is3D(!0)&&ag.has(this.type)}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i){if(this.type==="custom"&&e==="visibility")return void(this.visibility=i);const c=this._unevaluatedLayout;c._properties.properties[e]&&(c.setValue(e,i),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...c.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||c.isIndoorDependent(),e==="visibility"&&this.possiblyEvaluateVisibility())}setAppearances(e){this.appearances=[],e.forEach(i=>{this.appearances.push(new I_(i.condition,i.name,i.properties,this.scope,this.options,this.iconImageUseTheme))})}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(e){return e.endsWith(ig)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}isPaintProperty(e){return!!this._transitionablePaint._properties.properties[e]}setPaintProperty(e,i){const c=this._transitionablePaint,f=c._properties.properties;if(e.endsWith(ig)){const z=e.slice(0,-11);return f[z]&&c.setTransition(z,i||void 0),!1}if(!f[e])return!1;const g=c._values[e],y=g.value.isDataDriven(),b=g.value;c.setValue(e,i),this.expressionDependencies.configDependencies=new Set([...this.expressionDependencies.configDependencies,...c.configDependencies]),this.expressionDependencies.isIndoorDependent=this.expressionDependencies.isIndoorDependent||c.isIndoorDependent(),this._handleSpecialPaintPropertyUpdate(e);const E=c._values[e].value,M=E.isDataDriven(),R=e.endsWith("pattern")||e==="line-dasharray";return M||y||R||this._handleOverridablePaintPropertyUpdate(e,b,E)}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getDefaultProgramParams(e,i,c){return null}_handleOverridablePaintPropertyUpdate(e,i,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(e.appearances=this.appearances.map(i=>i.serialize())),vr(e,(i,c)=>!(i===void 0||c==="layout"&&!Object.keys(i).length||c==="paint"&&!Object.keys(i).length))}is3D(e){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof lh&&of(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}for(const e of this.appearances)if(!Fa(e.condition.expression))return!0;return!1}compileFilter(e){this._filterCompiled||(this._featureFilter=rg(this.filter,this.scope,e),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(e){this._stats&&(e.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRenderedFeatures(e,i,c){return{}}queryRadius(e){}queryIntersectsFeature(e,i,c,f,g,y,b,E,M,R){}}const P_={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Bs{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}const Tv=new ArrayBuffer(0);class ai{constructor(){this._reallocCount=0,this.capacity=0,this.length=0}static serialize(e,i){return e._trim(),i&&e.arrayBuffer&&i.add(e.arrayBuffer),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,e.arrayBuffer?i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement:(i.capacity=0,i.arrayBuffer=Tv),i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this._reallocCount++,this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}reserveForAdditional(e){this.reserve(this.length+e)}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...e){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...e){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function en(s,e=1){let i=0,c=0;return{members:s.map(f=>{const g=P_[f.type].BYTES_PER_ELEMENT,y=i=zp(i,Math.max(e,g)),b=f.components||1;return c=Math.max(c,g),i+=g*b,{name:f.name,type:f.type,components:b,offset:y}}),size:zp(i,Math.max(c,e)),alignment:e}}function zp(s,e){return Math.ceil(s/e)*e}class _u extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.int16[f+0]=i,this.int16[f+1]=c,e}}_u.prototype.bytesPerElement=4,jt(_u,"StructArrayLayout2i4");class Zl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const g=3*e;return this.int16[g+0]=i,this.int16[g+1]=c,this.int16[g+2]=f,e}}Zl.prototype.bytesPerElement=6,jt(Zl,"StructArrayLayout3i6");class Rc extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,c,f)}emplace(e,i,c,f,g){const y=4*e;return this.int16[y+0]=i,this.int16[y+1]=c,this.int16[y+2]=f,this.int16[y+3]=g,e}}Rc.prototype.bytesPerElement=8,jt(Rc,"StructArrayLayout4i8");class ja extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}ja.prototype.bytesPerElement=4,jt(ja,"StructArrayLayout1f4");class ff extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const g=4*e,y=2*e;return this.int16[g+0]=i,this.int16[g+1]=c,this.float32[y+1]=f,e}}ff.prototype.bytesPerElement=8,jt(ff,"StructArrayLayout2i1f8");class Lp extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const g=4*e;return this.int16[g+0]=i,this.int16[g+1]=c,this.int16[g+2]=f,e}}Lp.prototype.bytesPerElement=8,jt(Lp,"StructArrayLayout3i8");class Ea extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f,g)}emplace(e,i,c,f,g,y){const b=5*e;return this.int16[b+0]=i,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+3]=g,this.int16[b+4]=y,e}}Ea.prototype.bytesPerElement=10,jt(Ea,"StructArrayLayout5i10");class oo extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,c,f,g,y,b)}emplace(e,i,c,f,g,y,b,E){const M=6*e,R=12*e,z=3*e;return this.int16[M+0]=i,this.int16[M+1]=c,this.uint8[R+4]=f,this.uint8[R+5]=g,this.uint8[R+6]=y,this.uint8[R+7]=b,this.float32[z+2]=E,e}}oo.prototype.bytesPerElement=12,jt(oo,"StructArrayLayout2i4ub1f12");class tl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const g=3*e;return this.float32[g+0]=i,this.float32[g+1]=c,this.float32[g+2]=f,e}}tl.prototype.bytesPerElement=12,jt(tl,"StructArrayLayout3f12");class Wl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f,g)}emplace(e,i,c,f,g,y){const b=6*e,E=3*e;return this.uint16[b+0]=i,this.uint16[b+1]=c,this.uint16[b+2]=f,this.uint16[b+3]=g,this.float32[E+2]=y,e}}Wl.prototype.bytesPerElement=12,jt(Wl,"StructArrayLayout4ui1f12");class cd extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,c,f)}emplace(e,i,c,f,g){const y=4*e;return this.uint16[y+0]=i,this.uint16[y+1]=c,this.uint16[y+2]=f,this.uint16[y+3]=g,e}}cd.prototype.bytesPerElement=8,jt(cd,"StructArrayLayout4ui8");class ud extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,c,f,g,y)}emplace(e,i,c,f,g,y,b){const E=6*e;return this.int16[E+0]=i,this.int16[E+1]=c,this.int16[E+2]=f,this.int16[E+3]=g,this.int16[E+4]=y,this.int16[E+5]=b,e}}ud.prototype.bytesPerElement=12,jt(ud,"StructArrayLayout6i12");class hd extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z,B){const j=this.length;return this.resize(j+1),this.emplace(j,e,i,c,f,g,y,b,E,M,R,z,B)}emplace(e,i,c,f,g,y,b,E,M,R,z,B,j){const V=12*e;return this.int16[V+0]=i,this.int16[V+1]=c,this.int16[V+2]=f,this.int16[V+3]=g,this.uint16[V+4]=y,this.uint16[V+5]=b,this.uint16[V+6]=E,this.uint16[V+7]=M,this.int16[V+8]=R,this.int16[V+9]=z,this.int16[V+10]=B,this.int16[V+11]=j,e}}hd.prototype.bytesPerElement=24,jt(hd,"StructArrayLayout4i4ui4i24");class og extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,c,f,g,y)}emplace(e,i,c,f,g,y,b){const E=10*e,M=5*e;return this.int16[E+0]=i,this.int16[E+1]=c,this.int16[E+2]=f,this.float32[M+2]=g,this.float32[M+3]=y,this.float32[M+4]=b,e}}og.prototype.bytesPerElement=20,jt(og,"StructArrayLayout3i3f20");class Yl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,c,f)}emplace(e,i,c,f,g){const y=4*e;return this.float32[y+0]=i,this.float32[y+1]=c,this.float32[y+2]=f,this.float32[y+3]=g,e}}Yl.prototype.bytesPerElement=16,jt(Yl,"StructArrayLayout4f16");class sg extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}sg.prototype.bytesPerElement=4,jt(sg,"StructArrayLayout1ul4");class rl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.uint16[f+0]=i,this.uint16[f+1]=c,e}}rl.prototype.bytesPerElement=4,jt(rl,"StructArrayLayout2ui4");class ch extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z,B,j){const V=this.length;return this.resize(V+1),this.emplace(V,e,i,c,f,g,y,b,E,M,R,z,B,j)}emplace(e,i,c,f,g,y,b,E,M,R,z,B,j,V){const Y=20*e,re=10*e;return this.int16[Y+0]=i,this.int16[Y+1]=c,this.int16[Y+2]=f,this.int16[Y+3]=g,this.int16[Y+4]=y,this.float32[re+3]=b,this.float32[re+4]=E,this.float32[re+5]=M,this.float32[re+6]=R,this.int16[Y+14]=z,this.uint32[re+8]=B,this.uint16[Y+18]=j,this.uint16[Y+19]=V,e}}ch.prototype.bytesPerElement=40,jt(ch,"StructArrayLayout5i4f1i1ul2ui40");class pf extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,c,f,g,y,b)}emplace(e,i,c,f,g,y,b,E){const M=8*e;return this.int16[M+0]=i,this.int16[M+1]=c,this.int16[M+2]=f,this.int16[M+4]=g,this.int16[M+5]=y,this.int16[M+6]=b,this.int16[M+7]=E,e}}pf.prototype.bytesPerElement=16,jt(pf,"StructArrayLayout3i2i2i16");class Bp extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f,g)}emplace(e,i,c,f,g,y){const b=4*e,E=8*e;return this.float32[b+0]=i,this.float32[b+1]=c,this.float32[b+2]=f,this.int16[E+6]=g,this.int16[E+7]=y,e}}Bp.prototype.bytesPerElement=16,jt(Bp,"StructArrayLayout2f1f2i16");class kp extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,c,f,g,y)}emplace(e,i,c,f,g,y,b){const E=20*e,M=5*e;return this.uint8[E+0]=i,this.uint8[E+1]=c,this.float32[M+1]=f,this.float32[M+2]=g,this.float32[M+3]=y,this.float32[M+4]=b,e}}kp.prototype.bytesPerElement=20,jt(kp,"StructArrayLayout2ub4f20");class pa extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,c)}emplace(e,i,c,f){const g=3*e;return this.uint16[g+0]=i,this.uint16[g+1]=c,this.uint16[g+2]=f,e}}pa.prototype.bytesPerElement=6,jt(pa,"StructArrayLayout3ui6");class dd extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se){const we=this.length;return this.resize(we+1),this.emplace(we,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se)}emplace(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se,we){const Ie=30*e,Pe=15*e,Oe=60*e;return this.int16[Ie+0]=i,this.int16[Ie+1]=c,this.int16[Ie+2]=f,this.float32[Pe+2]=g,this.float32[Pe+3]=y,this.uint16[Ie+8]=b,this.uint16[Ie+9]=E,this.uint32[Pe+5]=M,this.uint32[Pe+6]=R,this.uint32[Pe+7]=z,this.uint16[Ie+16]=B,this.uint16[Ie+17]=j,this.uint16[Ie+18]=V,this.float32[Pe+10]=Y,this.float32[Pe+11]=re,this.uint8[Oe+48]=J,this.uint8[Oe+49]=oe,this.uint8[Oe+50]=ce,this.uint32[Pe+13]=pe,this.int16[Ie+28]=Se,this.uint8[Oe+58]=we,e}}dd.prototype.bytesPerElement=60,jt(dd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class uh extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se,we,Ie,Pe,Oe,ke,Ge,pt,ct,dt,St,At,Tt){const lt=this.length;return this.resize(lt+1),this.emplace(lt,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se,we,Ie,Pe,Oe,ke,Ge,pt,ct,dt,St,At,Tt)}emplace(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se,we,Ie,Pe,Oe,ke,Ge,pt,ct,dt,St,At,Tt,lt){const Ot=20*e,xt=40*e,It=80*e;return this.float32[Ot+0]=i,this.float32[Ot+1]=c,this.int16[xt+4]=f,this.int16[xt+5]=g,this.int16[xt+6]=y,this.int16[xt+7]=b,this.int16[xt+8]=E,this.int16[xt+9]=M,this.int16[xt+10]=R,this.int16[xt+11]=z,this.int16[xt+12]=B,this.uint16[xt+13]=j,this.uint16[xt+14]=V,this.uint16[xt+15]=Y,this.uint16[xt+16]=re,this.uint16[xt+17]=J,this.uint16[xt+18]=oe,this.uint16[xt+19]=ce,this.uint16[xt+20]=pe,this.uint16[xt+21]=Se,this.uint16[xt+22]=we,this.uint16[xt+23]=Ie,this.uint16[xt+24]=Pe,this.uint16[xt+25]=Oe,this.uint16[xt+26]=ke,this.uint16[xt+27]=Ge,this.uint32[Ot+14]=pt,this.float32[Ot+15]=ct,this.float32[Ot+16]=dt,this.float32[Ot+17]=St,this.float32[Ot+18]=At,this.uint8[It+76]=Tt,this.uint16[xt+39]=lt,e}}uh.prototype.bytesPerElement=80,jt(uh,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class mf extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,c,f,g,y)}emplace(e,i,c,f,g,y,b){const E=6*e;return this.float32[E+0]=i,this.float32[E+1]=c,this.float32[E+2]=f,this.float32[E+3]=g,this.float32[E+4]=y,this.float32[E+5]=b,e}}mf.prototype.bytesPerElement=24,jt(mf,"StructArrayLayout6f24");class hh extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,c,f,g)}emplace(e,i,c,f,g,y){const b=5*e;return this.float32[b+0]=i,this.float32[b+1]=c,this.float32[b+2]=f,this.float32[b+3]=g,this.float32[b+4]=y,e}}hh.prototype.bytesPerElement=20,jt(hh,"StructArrayLayout5f20");class gf extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,c,f,g,y,b)}emplace(e,i,c,f,g,y,b,E){const M=7*e;return this.float32[M+0]=i,this.float32[M+1]=c,this.float32[M+2]=f,this.float32[M+3]=g,this.float32[M+4]=y,this.float32[M+5]=b,this.float32[M+6]=E,e}}gf.prototype.bytesPerElement=28,jt(gf,"StructArrayLayout7f28");class _f extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z){const B=this.length;return this.resize(B+1),this.emplace(B,e,i,c,f,g,y,b,E,M,R,z)}emplace(e,i,c,f,g,y,b,E,M,R,z,B){const j=11*e;return this.float32[j+0]=i,this.float32[j+1]=c,this.float32[j+2]=f,this.float32[j+3]=g,this.float32[j+4]=y,this.float32[j+5]=b,this.float32[j+6]=E,this.float32[j+7]=M,this.float32[j+8]=R,this.float32[j+9]=z,this.float32[j+10]=B,e}}_f.prototype.bytesPerElement=44,jt(_f,"StructArrayLayout11f44");class fd extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M){const R=this.length;return this.resize(R+1),this.emplace(R,e,i,c,f,g,y,b,E,M)}emplace(e,i,c,f,g,y,b,E,M,R){const z=9*e;return this.float32[z+0]=i,this.float32[z+1]=c,this.float32[z+2]=f,this.float32[z+3]=g,this.float32[z+4]=y,this.float32[z+5]=b,this.float32[z+6]=E,this.float32[z+7]=M,this.float32[z+8]=R,e}}fd.prototype.bytesPerElement=36,jt(fd,"StructArrayLayout9f36");class dh extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const c=this.length;return this.resize(c+1),this.emplace(c,e,i)}emplace(e,i,c){const f=2*e;return this.float32[f+0]=i,this.float32[f+1]=c,e}}dh.prototype.bytesPerElement=8,jt(dh,"StructArrayLayout2f8");class Fp extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,e,i,c,f)}emplace(e,i,c,f,g){const y=6*e;return this.uint32[3*e+0]=i,this.uint16[y+2]=c,this.uint16[y+3]=f,this.uint16[y+4]=g,e}}Fp.prototype.bytesPerElement=12,jt(Fp,"StructArrayLayout1ul3ui12");class yf extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}yf.prototype.bytesPerElement=2,jt(yf,"StructArrayLayout1ui2");class Kl extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re){const J=this.length;return this.resize(J+1),this.emplace(J,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re)}emplace(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J){const oe=16*e;return this.float32[oe+0]=i,this.float32[oe+1]=c,this.float32[oe+2]=f,this.float32[oe+3]=g,this.float32[oe+4]=y,this.float32[oe+5]=b,this.float32[oe+6]=E,this.float32[oe+7]=M,this.float32[oe+8]=R,this.float32[oe+9]=z,this.float32[oe+10]=B,this.float32[oe+11]=j,this.float32[oe+12]=V,this.float32[oe+13]=Y,this.float32[oe+14]=re,this.float32[oe+15]=J,e}}Kl.prototype.bytesPerElement=64,jt(Kl,"StructArrayLayout16f64");class pd extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,c,f,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,c,f,g,y,b)}emplace(e,i,c,f,g,y,b,E){const M=10*e,R=5*e;return this.uint16[M+0]=i,this.uint16[M+1]=c,this.uint16[M+2]=f,this.uint16[M+3]=g,this.float32[R+2]=y,this.float32[R+3]=b,this.float32[R+4]=E,e}}pd.prototype.bytesPerElement=20,jt(pd,"StructArrayLayout4ui3f20");class D_ extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.int16[1*e+0]=i,e}}D_.prototype.bytesPerElement=2,jt(D_,"StructArrayLayout1i2");class Np extends ai{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint8[1*e+0]=i,e}}Np.prototype.bytesPerElement=1,jt(Np,"StructArrayLayout1ub1");class zc extends Bs{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}zc.prototype.size=40;class lg extends ch{get(e){return new zc(this,e)}}jt(lg,"CollisionBoxArray");class R_ extends Bs{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}R_.prototype.size=60;class jp extends dd{get(e){return new R_(this,e)}}jt(jp,"PlacedSymbolArray");class vf extends Bs{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(e){this._structArray.uint32[this._pos4+14]=e}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(e){this._structArray.float32[this._pos4+18]=e}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}vf.prototype.size=80;class ia extends uh{get(e){return new vf(this,e)}}jt(ia,"SymbolInstanceArray");class Up extends ja{getoffsetX(e){return this.float32[1*e+0]}}jt(Up,"GlyphOffsetArray");class Sv extends _u{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}jt(Sv,"SymbolLineVertexArray");class z_ extends Bs{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}z_.prototype.size=12;class yu extends Fp{get(e){return new z_(this,e)}}jt(yu,"FeatureIndexArray");class vu extends rl{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}jt(vu,"FillExtrusionCentroidArray");class cg extends Bs{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}cg.prototype.size=6;class L_ extends Zl{get(e){return new cg(this,e)}}jt(L_,"FillExtrusionWallArray");const xf=en([{name:"a_pos",components:2,type:"Int16"}],4),Ql=en([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),B_=en([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ui{constructor(e=[]){this.segments=e}_prepareSegment(e,i,c,f){let g=this.segments[this.segments.length-1];return e>ui.MAX_VERTEX_ARRAY_LENGTH&&br(`Max vertices per segment is ${ui.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!g||g.vertexLength+e>ui.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==f)&&(g={vertexOffset:i,primitiveOffset:c,vertexLength:0,primitiveLength:0},f!==void 0&&(g.sortKey=f),this.segments.push(g)),g}prepareSegment(e,i,c,f){return this._prepareSegment(e,i.length,c.length,f)}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,c,f){return new ui([{vertexOffset:e,primitiveOffset:i,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}function k_(s,e){return 256*(s=Ee(Math.floor(s),0,255))+Ee(Math.floor(e),0,255)}ui.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt(ui,"SegmentVector");const ug=en([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),F_=en([{name:"a_pattern_b",components:4,type:"Uint16"}]),hg=en([{name:"a_dash",components:4,type:"Uint16"}]);class bf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,i,c,f){this.ids.push(Lc(e)),this.positions.push(i,c,f)}eachPosition(e,i){const c=Lc(e);let f=0,g=this.ids.length-1;for(;f<g;){const y=f+g>>1;this.ids[y]>=c?g=y:f=y+1}for(;this.ids[f]===c;)i(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(e,i){const c=new Float64Array(e.ids),f=new Uint32Array(e.positions);return Ma(c,f,0,c.length-1),i&&(i.add(c.buffer),i.add(f.buffer)),{ids:c,positions:f}}static deserialize(e){const i=new bf;let c;i.ids=e.ids,i.positions=e.positions;for(const f of i.ids)f!==c&&i.uniqueIds.push(f),c=f;return i.indexed=!0,i}}function Lc(s){const e=+s;return Number.isSafeInteger(e)?e:yc(String(s))}function Ma(s,e,i,c){for(;i<c;){const f=s[i+c>>1];let g=i-1,y=c+1;for(;;){do g++;while(s[g]<f);do y--;while(s[y]>f);if(g>=y)break;md(s,g,y),md(e,3*g,3*y),md(e,3*g+1,3*y+1),md(e,3*g+2,3*y+2)}y-i<c-y?(Ma(s,e,i,y),i=y+1):(Ma(s,e,y+1,c),c=y)}}function md(s,e,i){const c=s[e];s[e]=s[i],s[i]=c}jt(bf,"FeaturePositionMap");class wl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}set(e,i,c){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ui extends wl{constructor(e){super(e),this.current=0}set(e,i,c){this.fetchUniformLocation(e,i)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class aa extends wl{constructor(e){super(e),this.current=0}set(e,i,c){this.fetchUniformLocation(e,i)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class ks extends wl{constructor(e){super(e),this.current=[0,0]}set(e,i,c){this.fetchUniformLocation(e,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class wf extends wl{constructor(e){super(e),this.current=[0,0,0]}set(e,i,c){this.fetchUniformLocation(e,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class Qi extends wl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,c){this.fetchUniformLocation(e,i)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class ps extends wl{constructor(e){super(e),this.current=Cn.transparent.toPremultipliedRenderColor(null)}set(e,i,c){this.fetchUniformLocation(e,i)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const xu=new Float32Array(16);class gd extends wl{constructor(e){super(e),this.current=xu}set(e,i,c){if(this.fetchUniformLocation(e,i)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let f=1;f<16;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const Sx=new Float32Array(9),p=new Float32Array(4);class n extends wl{constructor(e){super(e),this.current=p}set(e,i,c){if(this.fetchUniformLocation(e,i)){for(let f=0;f<4;f++)if(c[f]!==this.current[f]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function u(s){return[k_(255*s.r,255*s.g),k_(255*s.b,255*s.a)]}function m(s,e,i,c,f,g,y,b){return!!s&&(s.kind==="composite"||s.kind==="source"?s.evaluate(new In(0,{brightness:g,worldview:b}),e,i,f,c,y)==="none":s.value==="none")}class x{constructor(e,i,c,f){this.value=e,this.uniformNames=i.map(g=>`u_${g}`),this.type=c,this.context=f}setUniform(e,i,c,f,g){const y=f.constantOr(this.value);i.set(e,g,y instanceof Cn?y.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):y)}getBinding(e,i){return this.type==="color"?new ps(e):new aa(e)}}class A{constructor(e,i){this.uniformNames=i.map(c=>`u_${c}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(e,i){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br),this.patternTransition=i?i.tl.concat(i.br):this.pattern}setUniform(e,i,c,f,g){let y=null;g!=="u_pattern"&&g!=="u_dash"||(y=this.pattern),g==="u_pattern_b"&&(y=this.patternTransition),g==="u_pixel_ratio"&&(y=this.pixelRatio),y&&i.set(e,g,y)}getBinding(e,i){return i==="u_pattern"||i==="u_pattern_b"||i==="u_dash"?new Qi(e):new aa(e)}}class S{constructor(e,i,c,f){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=i.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,i,c,f,g,y,b,E){const M=this.paintVertexArray.length,R=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new In(0,{brightness:y,worldview:E}),i,{},g,f,b):this.expression.kind==="constant"&&this.expression.value,z=m(this.lutExpression,i,{},f,g,y,b,E);this.paintVertexArray.resize(e),this._setPaintValue(M,e,R,z?null:this.context.lut)}updatePaintArray(e,i,c,f,g,y,b,E){const M=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:b,worldview:E},c,f,void 0,g):this.expression.kind==="constant"&&this.expression.value,R=m(this.lutExpression,c,f,g,void 0,b,void 0,E);this._setPaintValue(e,i,M,R?null:this.context.lut)}_setPaintValue(e,i,c,f){if(this.type==="color"){const g=u(c.toPremultipliedRenderColor(f));for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,g[0],g[1])}else{for(let g=e;g<i;g++)this.paintVertexArray.emplace(g,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class O{constructor(e,i,c,f,g,y){this.expression=e,this.uniformNames=i.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=f,this.context=g,this.maxValue=0,this.paintVertexAttributes=i.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,i,c,f,g,y,b,E){const M=this.expression.evaluate(new In(this.context.zoom,{brightness:y,worldview:E}),i,{},g,f,b),R=this.expression.evaluate(new In(this.context.zoom+1,{brightness:y,worldview:E}),i,{},g,f,b),z=m(this.lutExpression,i,{},f,g,y,b,E),B=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(B,e,M,R,z?null:this.context.lut)}updatePaintArray(e,i,c,f,g,y,b,E){const M=this.expression.evaluate({zoom:this.context.zoom,brightness:b,worldview:E},c,f,void 0,g),R=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b,worldview:E},c,f,void 0,g),z=m(this.lutExpression,c,f,g,void 0,b,void 0,E);this._setPaintValue(e,i,M,R,z?null:this.context.lut)}_setPaintValue(e,i,c,f,g){if(this.type==="color"){const y=u(c.toPremultipliedRenderColor(g)),b=u(f.toPremultipliedRenderColor(g));for(let E=e;E<i;E++)this.paintVertexArray.emplace(E,y[0],y[1],b[0],b[1])}else{for(let y=e;y<i;y++)this.paintVertexArray.emplace(y,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,c,f,g){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,b=Ee(this.expression.interpolationFactor(y,this.context.zoom,this.context.zoom+1),0,1);i.set(e,g,b)}getBinding(e,i){return new aa(e)}}class D{constructor(e,i,c,f,g){this.expression=e,this.layerId=g,this.paintVertexAttributes=(c==="array"?hg:ug).members;for(let y=0;y<i.length;++y);this.paintVertexArray=new f,this.paintTransitionVertexArray=new cd}populatePaintArray(e,i,c,f){const g=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(g,e,i.patterns&&i.patterns[this.layerId],c)}updatePaintArray(e,i,c,f,g,y,b){this._setPaintValues(e,i,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(e,i,c,f){if(!f||!c)return;const g=f[c[0]],y=f[c[1]];if(g){if(g){const{tl:b,br:E,pixelRatio:M}=g;for(let R=e;R<i;R++)this.paintVertexArray.emplace(R,b[0],b[1],E[0],E[1],M)}if(y){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:b,br:E}=y;for(let M=e;M<i;M++)this.paintTransitionVertexArray.emplace(M,b[0],b[1],E[0],E[1])}}}upload(e){const i=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,i)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=e.createVertexBuffer(this.paintTransitionVertexArray,F_.members,i))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class F{constructor(e,i,c=()=>!0){this.binders={},this._buffers=[],this.context=i;const f=[];for(const g in e.paint._values){const y=e.paint.get(g);if(g.endsWith("-use-theme")||!c(g)||!(y instanceof lh&&of(y.property.specification)))continue;const b=$(g,e.type),E=y.value,M=y.property.specification.type,R=!!y.property.useIntegerZoom,z=g==="line-dasharray"||g.endsWith("pattern"),B=e.paint.get(`${g}-use-theme`),j=g==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant"||B&&B.value.kind!=="constant";if(E.kind!=="constant"||j)if(E.kind==="source"||j||z){const V=te(g,M,"source");this.binders[g]=z?new D(E,b,M,V,e.id):new S(E,b,M,V),f.push(`/a_${g}`)}else{const V=te(g,M,"composite");this.binders[g]=new O(E,b,M,R,i,V),f.push(`/z_${g}`)}else this.binders[g]=z?new A(E.value,b):new x(E.value,b,M,i),f.push(`/u_${g}`);B&&(this.binders[g].lutExpression=B.value)}this.cacheKey=f.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof S||i instanceof O?i.maxValue:0}populatePaintArrays(e,i,c,f,g,y,b,E){for(const M in this.binders){const R=this.binders[M];R.context=this.context,(R instanceof S||R instanceof O||R instanceof D)&&R.populatePaintArray(e,i,c,f,g,y,b,E)}}setConstantPatternPositions(e,i){for(const c in this.binders){const f=this.binders[c];f instanceof A&&f.setConstantPatternPositions(e,i)}}getPatternTransitionVertexBuffer(e){const i=this.binders[e];return i instanceof D?i.paintTransitionVertexBuffer:null}updatePaintArrays(e,i,c,f,g,y,b,E,M,R){let z=!1;const B=Object.keys(e),j=B.length!==0&&!E,V=j?B:i.uniqueIds;this.context.lut=g.lut;for(const Y in this.binders){const re=this.binders[Y];if(re.context=this.context,(re instanceof S||re instanceof O||re instanceof D)&&re.expression&&re.expression.kind&&re.expression.kind!=="constant"&&(re.expression.isStateDependent===!0||re.expression.isLightConstant===!1)){const J=g.paint.get(Y);re.expression=J.value;for(const oe of V){const ce=e[oe.toString()];i.eachPosition(oe,(pe,Se,we)=>{const Ie=f.feature(pe);re.updatePaintArray(Se,we,Ie,ce,y,b,M,R)})}if(!j)for(const oe of c.uniqueIds){const ce=e[oe.toString()];c.eachPosition(oe,(pe,Se,we)=>{const Ie=f.feature(pe);re.updatePaintArray(Se,we,Ie,ce,y,b,M,R)})}z=!0}}return z}defines(){const e=[];for(const i in this.binders){const c=this.binders[i];(c instanceof x||c instanceof A)&&e.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof x||f instanceof A||f instanceof O)for(const g of f.uniformNames)i.push({name:g,property:c,binding:f.getBinding(e,g)})}return i}setUniforms(e,i,c,f,g){for(const{name:y,property:b,binding:E}of c)this.binders[b].setUniform(e,E,g,f.get(b),y)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof S||i instanceof O||i instanceof D)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer),i instanceof D&&i.paintTransitionVertexBuffer&&this._buffers.push(i.paintTransitionVertexBuffer)}}upload(e){for(const i in this.binders){const c=this.binders[i];(c instanceof S||c instanceof O||c instanceof D)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof S||i instanceof O||i instanceof D)&&i.destroy()}}}class N{constructor(e,i,c=()=>!0){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new F(f,i,c);this.needsUpload=!1,this._featureMap=new bf,this._featureMapWithoutIds=new bf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(e,i,c,f,g,y,b,E,M){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(e,i,f,g,y,b,E,M);i.id!==void 0?this._featureMap.add(i.id,c,this._bufferOffset,e):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,e),this._idlessCounter+=1),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,c,f,g,y,b,E){for(const M of c)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(e,this._featureMap,this._featureMapWithoutIds,i,M,f,g,y,b||0,E)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Z={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function $(s,e){return Z[s]||[s.replace(`${e}-`,"").replace(/-/g,"_")]}const W={"line-pattern":{source:Wl,composite:Wl},"fill-pattern":{source:Wl,composite:Wl},"fill-extrusion-pattern":{source:Wl,composite:Wl},"line-dasharray":{source:cd,composite:cd}},ne={color:{source:dh,composite:Yl},number:{source:ja,composite:dh}};function te(s,e,i){const c=W[s];return c&&c[i]||ne[e][i]}jt(x,"ConstantBinder"),jt(A,"PatternConstantBinder"),jt(S,"SourceExpressionBinder"),jt(D,"PatternCompositeBinder"),jt(O,"CompositeExpressionBinder"),jt(F,"ProgramConfiguration",{omit:["_buffers"]}),jt(N,"ProgramConfigurationSet");const ae=Gt/Math.PI/2,le=64,be=[le,32,16],xe=-ae,ye=ae;function Re(s,e,i,c=ae){return i=yr(i),[s*Math.sin(i)*c,-e*c,s*Math.cos(i)*c]}function Ce(s,e,i){return Re(Math.cos(yr(s)),Math.sin(yr(s)),e,i)}const De=63710088e-1,Me=2*Math.PI*De;class Te{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Te(it(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,c=this.lat*i,f=e.lat*i,g=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((e.lng-this.lng)*i);return De*Math.acos(Math.min(g,1))}toBounds(e=0){const i=360*e/40075017,c=i/Math.cos(Math.PI/180*this.lat);return new Ne({lng:this.lng-c,lat:this.lat-i},{lng:this.lng+c,lat:this.lat+i})}toEcef(e){return Ce(this.lat,this.lng,ae+e*ae/De)}static convert(e){if(e instanceof Te)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Te(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Te(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Ne{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):Array.isArray(e)&&e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof Te?new Te(e.lng,e.lat):Te.convert(e),this}setSouthWest(e){return this._sw=e instanceof Te?new Te(e.lng,e.lat):Te.convert(e),this}extend(e){const i=this._sw,c=this._ne;let f,g;if(e instanceof Te)f=e,g=e;else{if(!(e instanceof Ne))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ne.convert(e)):this.extend(Te.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(Te.convert(e)):this;if(f=e._sw,g=e._ne,!f||!g)return this}return i||c?(i.lng=Math.min(f.lng,i.lng),i.lat=Math.min(f.lat,i.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new Te(f.lng,f.lat),this._ne=new Te(g.lng,g.lat)),this}getCenter(){return new Te((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Te(this.getWest(),this.getNorth())}getSouthEast(){return new Te(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:c}=Te.convert(e);let f=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){if(e)return e instanceof Ne?e:new Ne(e)}}function Ve(s){return Me*Math.cos(s*Math.PI/180)}function He(s){return(180+s)/360}function Qe(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function We(s,e){return s/Ve(e)}function ut(s){return 360*s-180}function wt(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function et(s,e){return s*Ve(wt(e))}const je=85.051129;function mt(s){return Math.cos(yr(Ee(s,-85.051129,je)))}function ot(s,e){const i=Ee(e,0,25.5),c=Math.pow(2,i);return mt(s)*Me/(512*c)}function bt(s){return 1/Math.cos(s*Math.PI/180)}function zt(s,e=0){const i=Math.exp(Math.PI*(1-(s.y+e/Gt)/(1<<s.z)*2));return 80150034*i/(i*i+1)/Gt/(1<<s.z)}class qt{constructor(e,i,c=0){this.x=+e,this.y=+i,this.z=+c}static fromLngLat(e,i=0){const c=Te.convert(e);return new qt(He(c.lng),Qe(c.lat),We(i,c.lat))}toLngLat(){return new Te(ut(this.x),wt(this.y))}toAltitude(){return et(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Me*bt(wt(this.y))}}function kt(s,e,i,c,f,g,y,b,E){const M=(e+c)/2,R=(i+f)/2,z=new yt(M,R);b(z),(function(B,j,V,Y,re,J){const oe=V-re,ce=Y-J;return Math.abs((Y-j)*oe-(V-B)*ce)/Math.hypot(oe,ce)})(z.x,z.y,g.x,g.y,y.x,y.y)>=E?(kt(s,e,i,M,R,g,z,b,E),kt(s,M,R,c,f,z,y,b,E)):s.push(y)}function Lt(s,e,i){let c=s[0],f=c.x,g=c.y;e(c);const y=[c];for(let b=1;b<s.length;b++){const E=s[b],{x:M,y:R}=E;e(E),kt(y,f,g,M,R,c,E,e,i),f=M,g=R,c=E}return y}function hr(s,e,i,c){if(c(e,i)){const f=e.add(i)._mult(.5);hr(s,e,f,c),hr(s,f,i,c)}else s.push(i)}function sr(s,e){let i=s[0];const c=[i];for(let f=1;f<s.length;f++){const g=s[f];hr(c,i,g,e),i=g}return c}const Zt=Math.pow(2,14)-1,lr=-Zt-1;function xr(s,e){const i=Math.round(s.x*e),c=Math.round(s.y*e);return s.x=Ee(i,lr,Zt),s.y=Ee(c,lr,Zt),(i<s.x||i>s.x+1||c<s.y||c>s.y+1)&&br("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function Ir(s,e,i){const c=s.loadGeometry(),f=s.extent,g=Gt/f;if(e&&i&&i.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:b,x:E,y:M,projection:R}=i,z=B=>{const j=ut((e.x+B.x/f)/y),V=wt((e.y+B.y/f)/y),Y=R.project(j,V);B.x=(Y.x*b-E)*f,B.y=(Y.y*b-M)*f};for(let B=0;B<c.length;B++)if(s.type!==1)c[B]=Lt(c[B],z,1);else{const j=[];for(const V of c[B])V.x<0||V.x>=f||V.y<0||V.y>=f||(z(V),j.push(V));c[B]=j}}for(const y of c)for(const b of y)xr(b,g);return c}function Vr(s,e){return{type:s.type,id:s.id,properties:s.properties,geometry:e?Ir(s):[]}}class tn{constructor(e,i,c,f,g){this.properties={},this.extent=c,this.type=0,this.id=void 0,this._pbf=e,this._geometry=-1,this._keys=f,this._values=g,e.readFields(Pr,this,i)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos,c=[];let f,g=1,y=0,b=0,E=0;for(;e.pos<i;){if(y<=0){const M=e.readVarint();g=7&M,y=M>>3}if(y--,g===1||g===2)b+=e.readSVarint(),E+=e.readSVarint(),g===1&&(f&&c.push(f),f=[]),f&&f.push(new yt(b,E));else{if(g!==7)throw new Error(`unknown command ${g}`);f&&f.push(f[0].clone())}}return f&&c.push(f),c}bbox(){const e=this._pbf;e.pos=this._geometry;const i=e.readVarint()+e.pos;let c=1,f=0,g=0,y=0,b=1/0,E=-1/0,M=1/0,R=-1/0;for(;e.pos<i;){if(f<=0){const z=e.readVarint();c=7&z,f=z>>3}if(f--,c===1||c===2)g+=e.readSVarint(),y+=e.readSVarint(),g<b&&(b=g),g>E&&(E=g),y<M&&(M=y),y>R&&(R=y);else if(c!==7)throw new Error(`unknown command ${c}`)}return[b,M,E,R]}toGeoJSON(e,i,c){const f=this.extent*Math.pow(2,c),g=this.extent*e,y=this.extent*i,b=this.loadGeometry();function E(B){return[360*(B.x+g)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(B.y+y)/f)*Math.PI))-90]}function M(B){return B.map(E)}let R;if(this.type===1){const B=[];for(const V of b)B.push(V[0]);const j=M(B);R=B.length===1?{type:"Point",coordinates:j[0]}:{type:"MultiPoint",coordinates:j}}else if(this.type===2){const B=b.map(M);R=B.length===1?{type:"LineString",coordinates:B[0]}:{type:"MultiLineString",coordinates:B}}else{if(this.type!==3)throw new Error("unknown feature type");{const B=(function(V){const Y=V.length;if(Y<=1)return[V];const re=[];let J,oe;for(let ce=0;ce<Y;ce++){const pe=Gr(V[ce]);pe!==0&&(oe===void 0&&(oe=pe<0),oe===pe<0?(J&&re.push(J),J=[V[ce]]):J&&J.push(V[ce]))}return J&&re.push(J),re})(b),j=[];for(const V of B)j.push(V.map(M));R=j.length===1?{type:"Polygon",coordinates:j[0]}:{type:"MultiPolygon",coordinates:j}}}const z={type:"Feature",geometry:R,properties:this.properties};return this.id!=null&&(z.id=this.id),z}}function Pr(s,e,i){s===1?e.id=i.readVarint():s===2?(function(c,f){const g=c.readVarint()+c.pos;for(;c.pos<g;){const y=f._keys[c.readVarint()],b=f._values[c.readVarint()];f.properties[y]=b}})(i,e):s===3?e.type=i.readVarint():s===4&&(e._geometry=i.pos)}function Gr(s){let e=0;for(let i,c,f=0,g=s.length,y=g-1;f<g;y=f++)i=s[f],c=s[y],e+=(c.x-i.x)*(i.y+c.y);return e}tn.types=["Unknown","Point","LineString","Polygon"];class Lr{constructor(e,i){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(yn,this,i),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new tn(this._pbf,i,this.extent,this._keys,this._values)}}function yn(s,e,i){s===15?e.version=i.readVarint():s===1?e.name=i.readString():s===5?e.extent=i.readVarint():s===2?e._features.push(i.pos):s===3?e._keys.push(i.readString()):s===4&&e._values.push((function(c){let f=null;const g=c.readVarint()+c.pos;for(;c.pos<g;){const y=c.readVarint()>>3;f=y===1?c.readString():y===2?c.readFloat():y===3?c.readDouble():y===4?c.readVarint64():y===5?c.readVarint():y===6?c.readSVarint():y===7?c.readBoolean():null}if(f==null)throw new Error("unknown feature value");return f})(i))}class hn{constructor(e,i){this.layers=e.readFields(Pn,{},i)}}function Pn(s,e,i){if(s===3){const c=new Lr(i,i.readVarint()+i.pos);c.length&&(e[c.name]=c)}}const ln="3d_elevation_id",$r="level";class mn{constructor(){this._valid=!1}reset(e){return this.feature=e,this._valid=!0,this._geometry=e.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(e,i){return this._valid&&e(i(this._geometry)),this}require(e,i,c){return this.get(e,!0,i,c)}optional(e,i,c){return this.get(e,!1,i,c)}success(){return this._valid}get(e,i,c,f){const g=this.feature.properties.hasOwnProperty(e)?+this.feature.properties[e]:void 0;return this._valid&&g!==void 0&&!Number.isNaN(g)?c(f?f(g):g):i&&(this._valid=!1),this}}class hi{constructor(e,i){this.featureFunc=e,this.vertexFunc=i}parseFeature(e,i,c){return this.featureFunc(e,i,c)}parseVertex(e,i,c){return this.vertexFunc(e,i,c)}}const Dn=new hi((s,e,i)=>s.reset(e).require(ln,c=>{i.id=c}).optional("fixed_height_relative",c=>{i.constantHeight=c},Nr.decodeRelativeHeight).geometry(c=>{i.bounds=c},kl).success(),(s,e,i)=>s.reset(e).require(ln,c=>{i.id=c}).require("elevation_idx",c=>{i.idx=c}).require("extent",c=>{i.extent=c}).require("height_relative",c=>{i.height=c},Nr.decodeRelativeHeight).geometry(c=>{i.position=c},Nr.getPoint).success()),wn=new hi((s,e,i)=>s.reset(e).require(ln,c=>{i.id=c}).optional("fixed_height",c=>{i.constantHeight=c},Nr.decodeMetricHeight).geometry(c=>{i.bounds=c},kl).success(),(s,e,i)=>s.reset(e).require(ln,c=>{i.id=c}).require("elevation_idx",c=>{i.idx=c}).require("extent",c=>{i.extent=c}).require("height",c=>{i.height=c},Nr.decodeMetricHeight).geometry(c=>{i.position=c},Nr.getPoint).success());class Nr{static getPoint(e){return qi(e[0][0].x,e[0][0].y)}static decodeRelativeHeight(e){return 1e-4*e*5}static decodeMetricHeight(e){return 1e-4*e}static getVersionSchema(e){return e?e==="1.0.1"?wn:void 0:Dn}static parse(e){const i=[],c=[],f=e.length,g=new mn;for(let y=0;y<f;y++){const b=e.feature(y),E=b.properties.version,M=Nr.getVersionSchema(E);if(M===void 0){br(`Unknown elevation feature version number ${E||"(unknown)"}`);continue}const R=b.properties.type;if(!R)continue;const z=tn.types[b.type];if(z==="Point"&&R==="curve_point"){const B={};M.parseVertex(g,b,B)&&i.push(B)}else if(z==="Polygon"&&R==="curve_meta"){const B={};M.parseFeature(g,b,B)&&c.push(B)}}return{vertices:i,features:c}}}class qr{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,c){const f=pn(i,this.dir);if(Math.abs(f)<1e-6)return!1;const g=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1])/f;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,!0}}class Kn{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,c){const f=Mr(i,this.dir);if(Math.abs(f)<1e-6)return!1;const g=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/f;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,c[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(e,i,c){if((function(j,V){var Y=j[0],re=j[1],J=j[2],oe=V[0],ce=V[1],pe=V[2];return Math.abs(Y-oe)<=C*Math.max(1,Math.abs(Y),Math.abs(oe))&&Math.abs(re-ce)<=C*Math.max(1,Math.abs(re),Math.abs(ce))&&Math.abs(J-pe)<=C*Math.max(1,Math.abs(J),Math.abs(pe))})(this.pos,e)||i===0)return c[0]=c[1]=c[2]=0,!1;const[f,g,y]=this.dir,b=this.pos[0]-e[0],E=this.pos[1]-e[1],M=this.pos[2]-e[2],R=f*f+g*g+y*y,z=2*(b*f+E*g+M*y),B=z*z-4*R*(b*b+E*E+M*M-i*i);if(B<0){const j=Math.max(-z/2,0),V=b+f*j,Y=E+g*j,re=M+y*j,J=Math.hypot(V,Y,re);return c[0]=V*i/J,c[1]=Y*i/J,c[2]=re*i/J,!1}{const j=(-z-Math.sqrt(B))/(2*R);if(j<0){const V=Math.hypot(b,E,M);return c[0]=b*i/V,c[1]=E*i/V,c[2]=M*i/V,!1}return c[0]=b+f*j,c[1]=E+g*j,c[2]=M+y*j,!0}}}class Ii{constructor(e,i,c,f,g){this.TL=e,this.TR=i,this.BR=c,this.BL=f,this.horizon=g}static fromInvProjectionMatrix(e,i,c){const f=[-1,1,1],g=[1,1,1],y=[1,-1,1],b=[-1,-1,1],E=Tr(f,f,e),M=Tr(g,g,e),R=Tr(y,y,e),z=Tr(b,b,e);return new Ii(E,M,R,z,i/c)}}function kn(s,e,i){let c=1/0,f=-1/0;const g=[];for(const y of s){_n(g,y,e);const b=Mr(g,i);c=Math.min(c,b),f=Math.max(f,b)}return[c,f]}function Qn(s,e){let i=!0;for(let c=0;c<s.planes.length;c++){const f=s.planes[c];let g=0;for(let y=0;y<e.length;y++)g+=+(Mr(f,e[y])+f[3]>=0);if(g===0)return 0;g!==e.length&&(i=!1)}return i?2:1}function Ao(s,e){for(const i of s.projections){const c=kn(e,s.points[0],i.axis);if(i.projection[1]<c[0]||i.projection[0]>c[1])return 0}return 1}function Ka(s,e){let i=0;const c=[0,0,0,0];for(let f=0;f<s.length;f++)c[0]=s[f][0],c[1]=s[f][1],c[2]=s[f][2],c[3]=1,ni(c,e)>=0&&i++;return i}class Oa{constructor(e,i){this.points=e||new Array(8).fill([0,0,0]),this.planes=i||new Array(6).fill([0,0,0,0]),this.bounds=An.fromPoints(this.points),this.projections=[],this.frustumEdges=[_n([],this.points[2],this.points[3]),_n([],this.points[0],this.points[3]),_n([],this.points[4],this.points[0]),_n([],this.points[5],this.points[1]),_n([],this.points[6],this.points[2]),_n([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const f=[0,-c[2],c[1]],g=[c[2],0,-c[0]];this.projections.push({axis:f,projection:kn(this.points,this.points[0],f)}),this.projections.push({axis:g,projection:kn(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(e,i,c,f){const g=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(M=>{const R=ii([],M,e),z=1/R[3]/i*g;return(B=R)[0]=(j=R)[0]*(V=[z,z,f?1/R[3]:z,z])[0],B[1]=j[1]*V[1],B[2]=j[2]*V[2],B[3]=j[3]*V[3],B;var B,j,V}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(M=>{const R=Xt([],kr([],_n([],y[M[0]],y[M[1]]),_n([],y[M[2]],y[M[1]]))),z=-Mr(R,y[M[1]]);return R.concat(z)}),E=[];for(let M=0;M<y.length;M++)E.push([y[M][0],y[M][1],y[M][2]]);return new Oa(E,b)}intersectsPrecise(e,i,c){for(let f=0;f<i.length;f++)if(!Ka(e,i[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!Ka(e,this.planes[f]))return 0;for(const f of c)for(const g of this.frustumEdges){const y=kr([],f,g),b=Mt(y);if(b===0)continue;Bt(y,y,1/b);const E=kn(this.points,this.points[0],y),M=kn(e,this.points[0],y);if(E[0]>M[1]||M[0]>E[1])return 0}return 1}containsPoint(e){for(const i of this.planes){const c=i[3];if(Mr([i[0],i[1],i[2]],e)+c<0)return!1}return!0}}class An{static fromPoints(e){const i=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of e)Ze(i,i,f),gt(c,c,f);return new An(i,c)}static fromTileIdAndHeight(e,i,c){const f=1<<e.canonical.z,g=e.canonical.x,y=e.canonical.y;return new An([g/f,y/f,i],[(g+1)/f,(y+1)/f,c])}static applyTransform(e,i){const c=e.getCorners();for(let f=0;f<c.length;++f)Tr(c[f],c[f],i);return An.fromPoints(c)}static applyTransformFast(e,i){const c=[i[12],i[13],i[14]],f=[...c];for(let g=0;g<3;g++)for(let y=0;y<3;y++){const b=i[4*y+g],E=b*e.min[y],M=b*e.max[y];c[g]+=Math.min(E,M),f[g]+=Math.max(E,M)}return new An(c,f)}static projectAabbCorners(e,i){const c=e.getCorners();for(let f=0;f<c.length;++f)Tr(c[f],c[f],i);return c}constructor(e,i){this.min=e,this.max=i,this.center=Bt([],Ct([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],c=Rt(this.min),f=Rt(this.max);for(let g=0;g<i.length;g++)c[g]=i[g]?this.min[g]:this.center[g],f[g]=i[g]?this.center[g]:this.max[g];return f[2]=this.max[2],new An(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?Qn(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?Qn(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,i){return i||this.intersects(e)?Ao(e,this.getCorners()):0}intersectsPreciseFlat(e,i){return i||this.intersectsFlat(e)?Ao(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let i=0;i<3;++i)if(this.min[i]>e.max[i]||e.min[i]>this.max[i])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e.min[i]),this.max[i]=Math.max(this.max[i],e.max[i])}encapsulatePoint(e){for(let i=0;i<3;i++)this.min[i]=Math.min(this.min[i],e[i]),this.max[i]=Math.max(this.max[i],e[i])}closestPoint(e){return[Math.max(Math.min(this.max[0],e[0]),this.min[0]),Math.max(Math.min(this.max[1],e[1]),this.min[1]),Math.max(Math.min(this.max[2],e[2]),this.min[2])]}}jt(An,"Aabb");class ms{constructor(e,i){this.feature=e,this.metersToTile=i,this.index=0}get(){const e=this.feature.vertices[this.index],i=this.feature.vertexProps[this.index].dir,c=i[1],f=-i[0],g=(e.extent+1)*this.metersToTile;return[new yt(Math.trunc(e.position[0]+c*g),Math.trunc(e.position[1]+f*g)),new yt(Math.trunc(e.position[0]-c*g),Math.trunc(e.position[1]-f*g))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Qa{constructor(e,i,c,f,g,y){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Ti(),Ti(),Ti(),Ti(),Ti(),Ti(),Ti()],this.id=e,this.heightRange={min:c,max:c},this.safeArea=i,this.constantHeight=c,this.constantHeight==null&&(this.constantHeight!=null||f.length!==0)){this.vertices=f,this.edges=g,this.edges=this.edges.filter(b=>{return b.a<this.vertices.length&&b.b<this.vertices.length&&!((E=this.vertices[b.a].position)[0]===(M=this.vertices[b.b].position)[0]&&E[1]===M[1]);var E,M}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const b of this.vertices)this.vertexProps.push({dir:qi(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,b.height),this.heightRange.max=Math.max(this.heightRange.max,b.height);for(const b of this.edges){const E=this.vertices[b.a].position,M=this.vertices[b.b].position,R=Mn(Ti(),M,E),z=_a(R),B=io(Ti(),R,1/z);this.edgeProps.push({vec:R,dir:B,len:z});const j=this.vertexProps[b.a].dir,V=this.vertexProps[b.b].dir;$o(j,j,B),$o(V,V,B)}for(const b of this.vertexProps)b.dir[0]===0&&b.dir[1]===0||La(b.dir,b.dir);this.tessellate(y)}}pointElevation(e){if(this.constantHeight!=null)return this.constantHeight;const i=this.getClosestEdge(e);if(i==null)return 0;const[c,f]=i;return Dr(this.vertices[this.edges[c].a].height,this.vertices[this.edges[c].b].height,f)}computeSlopeNormal(e,i){const c=this.getClosestEdge(e);if(!c)return $e(0,0,1);const f=c[0],g=this.edges[f],y=this.edgeProps[f].vec,b=$e(y[0],y[1],(this.vertices[g.b].height-this.vertices[g.a].height)*i),E=$e(b[1],-b[0],0);kr(E,E,b);const M=Mt(E);return M>0?Bt(E,E,1/M):rt(E,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(e){if(this.edges.length===0)return;let i=0,c=Number.POSITIVE_INFINITY,f=0;const[g,y,b,E,M,R,z]=this._tmpVec2;_o(z,e.x,e.y);const B=new qr(z,null);for(let j=0;j<this.edges.length;j++){const V=this.edges[j],Y=this.edgeProps[j].dir;B.dir=Y;const re=this.vertices[V.a].position,J=this.vertices[V.b].position,oe=B.intersectsPlane(re,this.vertexProps[V.a].dir,g),ce=B.intersectsPlane(J,this.vertexProps[V.b].dir,y);if(!oe||!ce)continue;Mn(b,y,g),Mn(E,z,g);const pe=pn(b,b),Se=pe>0?pn(E,b)/pe:0,we=Ee(Se,0,1),Ie=Math.abs((Se-we)*this.edgeProps[j].len);Mn(M,z,re),_o(R,Y[1],-Y[0]);const Pe=Ie+Math.abs(pn(M,R));Pe<c&&(i=j,c=Pe,f=we)}return[i,f]}tessellate(e){const i=st(),c=st(),f=st(),g=st();for(let y=this.edges.length-1;y>=0;--y){const b=this.edges[y].a,E=this.edges[y].b,{position:M,height:R,extent:z}=this.vertices[b],{position:B,height:j,extent:V}=this.vertices[E],Y=this.vertexProps[b].dir,re=this.vertexProps[E].dir;if(rt(i,M[0]/e,M[1]/e,R),rt(c,B[0]/e,B[1]/e,j),rt(f,Y[1],-Y[0],0),Bt(f,f,z),rt(g,re[1],-re[0],0),Bt(g,g,V),this.distSqLines($e(i[0]+.5*f[0],i[1]+.5*f[1],i[2]+.5*f[2]),$e(c[0]-.5*g[0],c[1]-.5*g[1],c[2]-.5*g[2]),$e(i[0]-.5*f[0],i[1]-.5*f[1],i[2]-.5*f[2]),$e(c[0]+.5*g[0],c[1]+.5*g[1],c[2]+.5*g[2]))<=.0025000000000000005)continue;const J=this.vertices.length,oe=$o(Ti(),M,B);this.vertices.push({position:io(oe,oe,.5),height:.5*(R+j),extent:.5*(z+V)});const ce=$o(Ti(),Y,re);this.vertexProps.push({dir:La(ce,ce)}),this.edges.splice(y,1),this.edgeProps.splice(y,1),this.edges.push({a:b,b:J}),this.edges.push({a:J,b:E});const pe=Mn(Ti(),this.vertices[J].position,M),Se=_a(pe),we={vec:pe,dir:io(Ti(),pe,1/Se),len:Se};this.edgeProps.push(we),this.edgeProps.push(we)}}distSqLines(e,i,c,f){const g=Kt(st(),i,e),y=Kt(st(),f,c),b=Kt(st(),e,c),E=Mr(g,g),M=Mr(g,y),R=Mr(g,b),z=Mr(y,y),B=Mr(y,b),j=E*z-M*M;if(j===0)return jr(or(g,c,f,Mr(b,y)/Mr(y,y)),e);const V=(E*B-M*R)/j;return jr(or(g,e,i,(M*B-R*z)/j),or(y,c,f,V))}}class so{static parseFrom(e,i){const c=Nr.parse(e);if(!c)return[];let{vertices:f,features:g}=c;const y=1/zt(i);g.sort((R,z)=>R.id-z.id),f.sort((R,z)=>R.id-z.id||R.idx-z.idx),f=f.filter((R,z,B)=>z===B.findIndex(j=>j.id===R.id&&j.idx===R.idx));const b=new Array;let E=0;const M=f.length;for(const R of g){if(R.constantHeight){b.push(new Qa(R.id,R.bounds,R.constantHeight));continue}for(;E!==M&&f[E].id<R.id;)E++;if(E===M||f[E].id!==R.id)continue;const z=new Array,B=new Array,j=E;for(;E!==M&&f[E].id===R.id;){const V=f[E];if(z.push({position:V.position,height:V.height,extent:V.extent}),E!==j&&f[E-1].idx===V.idx-1){const Y=E-j;B.push({a:Y-1,b:Y})}E++}b.push(new Qa(R.id,R.bounds,void 0,z,B,y))}return b}static getElevationFeature(e,i){if(!i)return;const c=+e.properties[ln];return Number.isNaN(c)?void 0:i.find(f=>f.id===c)}}class Fs{constructor(e,i){this.zScale=1,this.xOffset=0,this.yOffset=0,e.equals(i)||(this.zScale=Math.pow(2,i.z-e.z),this.xOffset=(e.x*this.zScale-i.x)*Gt,this.yOffset=(e.y*this.zScale-i.y)*Gt)}constantElevation(e,i){if(e.constantHeight!=null)return this.computeBiasedHeight(e.constantHeight,i)}pointElevation(e,i,c){const f=this.constantElevation(i,c);return f??(e.x=e.x*this.zScale+this.xOffset,e.y=e.y*this.zScale+this.yOffset,this.computeBiasedHeight(i.pointElevation(e),c))}computeBiasedHeight(e,i){return i<=0?e:e+i*Fe(0,i,e>=0?e:Math.abs(.5*e))}}jt(Qa,"ElevationFeature");class Jo{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new _u,this.indexArray=new pa,this.segments=new ui,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new ja),this.worldview=e.worldview,this.hasAppearances=null}updateFootprints(e,i){}updateAppearances(e,i,c,f){}populate(e,i,c,f){const g=this.layers[0],y=[];let b=null;g.type==="circle"&&(b=g.layout.get("circle-sort-key"));for(const{feature:M,id:R,index:z,sourceLayerIndex:B}of e){const j=this.layers[0]._featureFilter.needGeometry,V=Vr(M,j);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),V,c))continue;const Y=b?b.evaluate(V,{},c):void 0,re={id:R,properties:M.properties,type:M.type,sourceLayerIndex:B,index:z,geometry:j?V.geometry:Ir(M,c,f),patterns:{},sortKey:Y};y.push(re)}b&&y.sort((M,R)=>M.sortKey-R.sortKey);let E=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new ud,E=f.projection);for(const M of y){const{geometry:R,index:z,sourceLayerIndex:B}=M,j=e[z].feature;this.addFeature(M,R,z,i.availableImages,c,E,i.brightness,i.elevationFeatures),i.featureIndex.insert(j,R,z,B,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(e,i,c,f,g,y,b){this.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xf.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,B_.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=e.createVertexBuffer(this.elevatedLayoutVertexArray,Ql.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(e,i,c,f,g,y,b,E){let M;this.elevationMode!=="none"&&(M=so.getElevationFeature(e,E));for(const R of i)for(const z of R){const B=z.x,j=z.y;if(B<0||B>=Gt||j<0||j>=Gt)continue;if(y){const re=y.projectTilePoint(B,j,g),J=y.upVector(g,B,j);this.addGlobeExtVertex(re,J),this.addGlobeExtVertex(re,J),this.addGlobeExtVertex(re,J),this.addGlobeExtVertex(re,J)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),Y=V.vertexLength;if(this.addCircleVertex(B,j,-1,-1),this.addCircleVertex(B,j,1,-1),this.addCircleVertex(B,j,1,1),this.addCircleVertex(B,j,-1,1),this.elevationMode!=="none"){const re=M?M.pointElevation(new yt(B,j)):0;this.hasElevation=this.hasElevation||re!==0;for(let J=0;J<4;J++)this.elevatedLayoutVertexArray.emplaceBack(re)}this.indexArray.emplaceBack(Y,Y+1,Y+2),this.indexArray.emplaceBack(Y,Y+2,Y+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},f,g,b,void 0,this.worldview)}addCircleVertex(e,i,c,f){this.layoutVertexArray.emplaceBack(2*e+(c+1)/2,2*i+(f+1)/2)}addGlobeExtVertex(e,i){this.globeExtVertexArray.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}}function xi(s,e){for(let i=0;i<s.length;i++)if(_s(e,s[i]))return!0;for(let i=0;i<e.length;i++)if(_s(s,e[i]))return!0;return!!ba(s,e)}function Hi(s,e,i){return!!_s(s,e)||!!Jl(e,s,i)}function ri(s,e){if(s.length===1)return yd(e,s[0]);for(let i=0;i<e.length;i++){const c=e[i];for(let f=0;f<c.length;f++)if(_s(s,c[f]))return!0}for(let i=0;i<s.length;i++)if(yd(e,s[i]))return!0;for(let i=0;i<e.length;i++)if(ba(s,e[i]))return!0;return!1}function Ji(s,e,i){if(s.length>1){if(ba(s,e))return!0;for(let c=0;c<e.length;c++)if(Jl(e[c],s,i))return!0}for(let c=0;c<s.length;c++)if(Jl(s[c],e,i))return!0;return!1}function ba(s,e){if(s.length===0||e.length===0)return!1;for(let i=0;i<s.length-1;i++){const c=s[i],f=s[i+1];for(let g=0;g<e.length-1;g++)if(Ei(c,f,e[g],e[g+1]))return!0}return!1}function Ei(s,e,i,c){return Vn(s,i,c)!==Vn(e,i,c)&&Vn(s,e,i)!==Vn(s,e,c)}function gs(s,e,i){return(s.x-i.x)*(e.y-i.y)-(s.y-i.y)*(e.x-i.x)}function Af(s,e,i,c){const f=gs(s,e,c),g=gs(s,e,i);if(Math.sign(f)===Math.sign(g))return;const y=gs(i,c,s),b=y+g-f;return Math.sign(y)!==Math.sign(b)?[y/(y-b),g/(g-f)]:void 0}function Jl(s,e,i){const c=i*i;if(e.length===1)return s.distSqr(e[0])<c;for(let f=1;f<e.length;f++)if(_d(s,e[f-1],e[f])<c)return!0;return!1}function _d(s,e,i){const c=e.distSqr(i);if(c===0)return s.distSqr(e);const f=((s.x-e.x)*(i.x-e.x)+(s.y-e.y)*(i.y-e.y))/c;return s.distSqr(f<0?e:f>1?i:i.sub(e)._mult(f)._add(e))}function yd(s,e){let i,c,f,g=!1;for(let y=0;y<s.length;y++){i=s[y];for(let b=0,E=i.length-1;b<i.length;E=b++)c=i[b],f=i[E],c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(g=!g)}return g}function _s(s,e){let i=!1;for(let c=0,f=s.length-1;c<s.length;f=c++){const g=s[c],y=s[f];g.y>e.y!=y.y>e.y&&e.x<(y.x-g.x)*(e.y-g.y)/(y.y-g.y)+g.x&&(i=!i)}return i}function nl(s,e,i,c,f){for(const y of s)if(e<=y.x&&i<=y.y&&c>=y.x&&f>=y.y)return!0;const g=[new yt(e,i),new yt(e,f),new yt(c,f),new yt(c,i)];if(s.length>2){for(const y of g)if(_s(s,y))return!0}for(let y=0;y<s.length-1;y++)if(ec(s[y],s[y+1],g))return!0;return!1}function ec(s,e,i){const c=i[0],f=i[2];if(s.x<c.x&&e.x<c.x||s.x>f.x&&e.x>f.x||s.y<c.y&&e.y<c.y||s.y>f.y&&e.y>f.y)return!1;const g=Vn(s,e,i[0]);return g!==Vn(s,e,i[1])||g!==Vn(s,e,i[2])||g!==Vn(s,e,i[3])}function Ns(s,e,i,c,f,g){let y=e.y-s.y,b=s.x-e.x;if(g=g||0){const E=y*y+b*b;if(E===0)return!0;const M=Math.sqrt(E);y/=M,b/=M}return!((i.x-s.x)*y+(i.y-s.y)*b-g<0||(c.x-s.x)*y+(c.y-s.y)*b-g<0||(f.x-s.x)*y+(f.y-s.y)*b-g<0)}function oi(s,e,i,c,f,g,y){return!(Ns(s,e,c,f,g,y)||Ns(e,i,c,f,g,y)||Ns(i,s,c,f,g,y)||Ns(c,f,s,e,i,y)||Ns(f,g,s,e,i,y)||Ns(g,c,s,e,i,y))}function bu(s,e,i){const c=e.paint.get(s).value;return c.kind==="constant"?c.value:i.programConfigurations.get(e.id).getMaxValue(s)}function dg(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function Ex(s,e,i,c,f){if(!e[0]&&!e[1])return s;const g=yt.convert(e)._mult(f);i==="viewport"&&g._rotate(-c);const y=[];for(let b=0;b<s.length;b++)y.push(s[b].sub(g));return y}function mw(s,e,i,c){const f=yt.convert(s)._mult(c);return e==="viewport"&&f._rotate(-i),f}let gw,_w;function N_(s,e,i){var c=2*Math.PI*6378137/256/Math.pow(2,i);return[s*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}jt(Jo,"CircleBucket",{omit:["layers"]});class Bc{constructor(e,i,c){this.z=e,this.x=i,this.y=c,this.key=Tf(0,e,e,i,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}isChildOf(e){const i=this.z-e.z;return e.z===0||e.z<this.z&&e.x===this.x>>i&&e.y===this.y>>i}url(e,i){const c=(function(g,y,b){var E=N_(256*g,256*(y=Math.pow(2,b)-y-1),b),M=N_(256*(g+1),256*(y+1),b);return E[0]+","+E[1]+","+M[0]+","+M[1]})(this.x,this.y,this.z),f=(function(g,y,b){let E,M="";for(let R=g;R>0;R--)E=1<<R-1,M+=(y&E?1:0)+(b&E?2:0);return M})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(i==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ev{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Tf(e,i.z,i.z,i.x,i.y)}}class lo{constructor(e,i,c,f,g){this.overscaledZ=e,this.wrap=i,this.canonical=new Bc(c,+f,+g),this.key=i===0&&e===c?this.canonical.key:Tf(i,e,c,f,g)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new lo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new lo(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Tf(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return Tf(this.wrap*+i,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.z<this.canonical.z&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new lo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new lo(i,this.wrap,i,c,f),new lo(i,this.wrap,i,c+1,f),new lo(i,this.wrap,i,c,f+1),new lo(i,this.wrap,i,c+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new lo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new lo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ev(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Tf(s,e,i,c,f){const g=1<<Math.min(i,22);let y=g*(f%g)+c%g;return s&&i<22&&(y+=g*g*((s<0?-2*s-1:2*s)%(1<<2*(22-i)))),16*(32*y+i)+(e-i)}const Sf=[s=>{let e=s.canonical.x-1,i=s.wrap;return e<0&&(e=(1<<s.canonical.z)-1,i--),new lo(s.overscaledZ,i,s.canonical.z,e,s.canonical.y)},s=>{let e=s.canonical.x+1,i=s.wrap;return e===1<<s.canonical.z&&(e=0,i++),new lo(s.overscaledZ,i,s.canonical.z,e,s.canonical.y)},s=>new lo(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,(s.canonical.y===0?1<<s.canonical.z:s.canonical.y)-1),s=>new lo(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y===(1<<s.canonical.z)-1?0:s.canonical.y+1)];jt(Bc,"CanonicalTileID"),jt(lo,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const fh=en([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ef}=fh,gS=en([{name:"a_pos_3",components:3,type:"Int16"}]);var Mx=en([{name:"a_pos",type:"Int16",components:2}]);function j_(s){return s*ae/De}const yw=[new An([xe,xe,xe],[ye,ye,ye]),new An([xe,xe,xe],[0,0,ye]),new An([0,xe,xe],[ye,0,ye]),new An([xe,0,xe],[0,ye,ye]),new An([0,0,xe],[ye,ye,ye])];function Ox(s,e,i,c=!0){const f=Bt([],s._camera.position,s.worldSize),g=[e,i,1,1];ii(g,g,s.pixelMatrixInverse),ha(g,g,1/g[3]);const y=Xt([],_n([],g,f)),b=s.globeMatrix,E=[b[12],b[13],b[14]],M=_n([],E,f),R=Mt(M),z=Xt([],M),B=s.worldSize/(2*Math.PI),j=Mr(z,y),V=Math.asin(B/R);if(V<Math.acos(j)){if(!c)return null;const ke=[],Ge=[];Bt(ke,y,R/j),Xt(Ge,_n(Ge,ke,M)),Xt(y,Ct(y,M,Bt(y,Ge,Math.tan(V)*R)))}const Y=[];new Kn(f,y).closestPointOnSphere(E,B,Y);const re=Xt([],Gn(b,0)),J=Xt([],Gn(b,1)),oe=Xt([],Gn(b,2)),ce=Mr(re,Y),pe=Mr(J,Y),Se=Mr(oe,Y),we=Xe(Math.asin(-pe/B));let Ie=Xe(Math.atan2(ce,Se));Ie=s.center.lng+(function(ke,Ge){const pt=(Ge-ke+180)%360-180;return pt<-180?pt+360:pt})(s.center.lng,Ie);const Pe=He(Ie),Oe=Ee(Qe(we),0,1);return new qt(Pe,Oe)}class _S{constructor(e,i,c){this.a=_n([],e,c),this.b=_n([],i,c),this.center=c;const f=Xt([],this.a),g=Xt([],this.b);this.angle=Math.acos(Mr(f,g))}}function U_(s,e){if(s.angle===0)return null;let i;return i=s.a[e]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[e]/s.a[e]/Math.sin(s.angle)-1/Math.tan(s.angle)),i<0||i>1?null:(function(c,f,g,y){const b=Math.sin(g);return c*(Math.sin((1-y)*g)/b)+f*(Math.sin(y*g)/b)})(s.a[e],s.b[e],s.angle,Ee(i,0,1))+s.center[e]}function wu(s){if(s.z<=1)return yw[s.z+2*s.y+s.x];const e=Cx(fg(s));return An.fromPoints(e)}function ph(s,e,i){return Bt(s,s,1-i),ar(s,s,e,i)}function vw(s,e,i){for(const c of s)Tr(c,c,e),Bt(c,c,i)}function Mv(s,e,i,c){const f=e/s.worldSize,g=s.globeMatrix;if(i.z<=1){const Oe=wu(i).getCorners();return vw(Oe,g,f),An.fromPoints(Oe)}const y=fg(i,c),b=Cx(y,ae+j_(s._tileCoverLift));vw(b,g,f);const E=Number.MAX_VALUE,M=[-E,-E,-E],R=[E,E,E];if(y.contains(s.center)){for(const Ge of b)Ze(R,R,Ge),gt(M,M,Ge);M[2]=0;const Oe=s.point,ke=[Oe.x*f,Oe.y*f,0];return Ze(R,R,ke),gt(M,M,ke),new An(R,M)}if(s._tileCoverLift>0){for(const Oe of b)Ze(R,R,Oe),gt(M,M,Oe);return new An(R,M)}const z=[g[12]*f,g[13]*f,g[14]*f],B=y.getCenter(),j=Ee(s.center.lat,-85.051129,je),V=Ee(B.lat,-85.051129,je),Y=He(s.center.lng),re=Qe(j);let J=Y-He(B.lng);const oe=re-Qe(V);J>.5?J-=1:J<-.5&&(J+=1);let ce=0;Math.abs(J)>Math.abs(oe)?ce=J>=0?1:3:(ce=oe>=0?0:2,ar(z,z,[g[4]*f,g[5]*f,g[6]*f],-Math.sin(yr(oe>=0?y.getSouth():y.getNorth()))*ae));const pe=b[ce],Se=b[(ce+1)%4],we=new _S(pe,Se,z),Ie=[U_(we,0)||pe[0],U_(we,1)||pe[1],U_(we,2)||pe[2]],Pe=vd(s.zoom);if(Pe>0){const Oe=(function({x:Ge,y:pt,z:ct},dt,St,At,Tt){const lt=1/(1<<ct);let Ot=Ge*lt,xt=Ot+lt,It=pt*lt,Et=It+lt,rr=0;const nr=(Ot+xt)/2-At;return nr>.5?rr=-1:nr<-.5&&(rr=1),Ot=((Ot+rr)*dt-(At*=dt))*St+At,xt=((xt+rr)*dt-At)*St+At,It=(It*dt-(Tt*=dt))*St+Tt,Et=(Et*dt-Tt)*St+Tt,[[Ot,Et,0],[xt,Et,0],[xt,It,0],[Ot,It,0]]})(i,e,s._pixelsPerMercatorPixel,Y,re);for(let Ge=0;Ge<b.length;Ge++)ph(b[Ge],Oe[Ge],Pe);const ke=Ct([],Oe[ce],Oe[(ce+1)%4]);Bt(ke,ke,.5),ph(Ie,ke,Pe)}for(const Oe of b)Ze(R,R,Oe),gt(M,M,Oe);return R[2]=Math.min(pe[2],Se[2]),Ze(R,R,Ie),gt(M,M,Ie),new An(R,M)}function fg({x:s,y:e,z:i},c=!1){const f=1/(1<<i),g=new Te(ut(s*f),e===(1<<i)-1&&c?-90:wt((e+1)*f)),y=new Te(ut((s+1)*f),e===0&&c?90:wt(e*f));return new Ne(g,y)}function Cx(s,e=ae){const i=yr(s.getNorth()),c=yr(s.getSouth()),f=Math.cos(i),g=Math.cos(c),y=Math.sin(i),b=Math.sin(c),E=s.getWest(),M=s.getEast();return[Re(g,b,E,e),Re(g,b,M,e),Re(f,y,M,e),Re(f,y,E,e)]}function V_(s,e,i,c){const f=1<<i.z,g=(s/Gt+i.x)/f;return Ce(wt((e/Gt+i.y)/f),ut(g),c)}function Mf({min:s,max:e}){return 16383/Math.max(e[0]-s[0],e[1]-s[1],e[2]-s[2])}const xw=new Float64Array(16);function G_(s){const e=Mf(s),i=Le(xw,[e,e,e]);return me(i,i,fn([],s.min))}function si(s){const e=(function(c,f){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c})(xw,s.min),i=1/Mf(s);return ge(e,e,[i,i,i])}function $_(s){const e=Gt/(2*Math.PI);return s/(2*Math.PI)/e}function q_(s,e){return Gt/(512*Math.pow(2,s))*Mf(wu(e))}function Ov(s,e,i,c,f){const g=$_(i),y=[s,e,-i/(2*Math.PI)],b=K(new Float64Array(16));return me(b,b,y),ge(b,b,[g,g,g]),se(b,b,yr(-f)),fe(b,b,yr(-c)),b}function vd(s){return Fe(5,6,s)}function Cv(s,e){const i=Ce(e.lat,e.lng),c=(function(V){const Y=Ce(V._center.lat,V._center.lng);let re=kr([],$e(0,1,0),Y);const J=Ue([],-V.angle,Y);re=Tr(re,re,J),Ue(J,-V._pitch,re);const oe=Xt([],Y);return Bt(oe,oe,j_(V.cameraToCenterDistance/V.pixelsPerMeter)),Tr(oe,oe,J),Ct([],Y,oe)})(s);return y=(f=Kt([],c,i))[0],b=f[1],E=f[2],M=(g=i)[0],R=g[1],z=g[2],j=(B=Math.sqrt((y*y+b*b+E*E)*(M*M+R*R+z*z)))&&Mr(f,g)/B,Math.acos(Math.min(Math.max(j,-1),1));var f,g,y,b,E,M,R,z,B,j}function Vp(s,e){return Cv(s,e)>Math.PI/2*1.01}const H_=yr(85),yS=Math.cos(H_),bw=Math.sin(H_),vS=Q(),ww=s=>{const e=[];return s.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),s.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e};function Ix(s,e,i,c,f,g,y,b,E){if(g&&s.queryGeometry.isAboveHorizon)return!1;g&&(E*=s.pixelToTileUnitsFactor);const M=s.tileID.canonical,R=i.projection.upVectorScale(M,i.center.lat,i.worldSize).metersToTile;for(const z of e)for(const B of z){const j=B.add(b),V=f&&i.elevation?i.elevation.exaggeration()*f.getElevationAt(j.x,j.y,!0):0,Y=i.projection.projectTilePoint(j.x,j.y,M);if(V>0){const ce=i.projection.upVector(M,j.x,j.y);Y.x+=ce[0]*R*V,Y.y+=ce[1]*R*V,Y.z+=ce[2]*R*V}const re=g?j:Aw(Y.x,Y.y,Y.z,c),J=g?s.tilespaceRays.map(ce=>ys(ce,V)):s.queryGeometry.screenGeometry,oe=ii([],[Y.x,Y.y,Y.z,1],c);if(!y&&g?E*=oe[3]/i.cameraToCenterDistance:y&&!g&&(E*=i.cameraToCenterDistance/oe[3]),g){const ce=wt((B.y/Gt+M.y)/(1<<M.z));E/=i.projection.pixelsPerMeter(ce,1)/We(1,ce)}if(Hi(J,re,E))return!0}return!1}function Aw(s,e,i,c){const f=ii([],[s,e,i,1],c);return new yt(f[0]/f[3],f[1]/f[3])}const ea=$e(0,0,0),Px=$e(0,0,1);function ys(s,e){const i=st();return ea[2]=e,s.intersectsPlane(ea,Px,i),new yt(i[0],i[1])}class Tw extends Jo{}let Dx,Sw,Iv,Pv;function X_(s,{width:e,height:i},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*i*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(e*i*c);return s.width=e,s.height=i,s.data=f,s}function Rx(s,e,i){const{width:c,height:f}=e;c===s.width&&f===s.height||(Dv(s,e,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,c),height:Math.min(s.height,f)},i,null),s.width=c,s.height=f,s.data=e.data)}function Dv(s,e,i,c,f,g,y,b){if(f.width===0||f.height===0)return e;if(f.width>s.width||f.height>s.height||i.x>s.width-f.width||i.y>s.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||c.x>e.width-f.width||c.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const E=s.data,M=e.data,R=g===4&&b;for(let z=0;z<f.height;z++){const B=((i.y+z)*s.width+i.x)*g,j=((c.y+z)*e.width+c.x)*g;if(R)for(let V=0;V<f.width;V++){const Y=B+V*g+3,re=j+V*g;M[re+0]=255,M[re+1]=255,M[re+2]=255,M[re+3]=E[Y]}else if(y)for(let V=0;V<f.width;V++){const Y=B+V*g,re=j+V*g,J=new Cn(E[Y+0]/255,E[Y+1]/255,E[Y+2]/255,E[Y+3]).toNonPremultipliedRenderColor(y).toArray();M[re+0]=J[0],M[re+1]=J[1],M[re+2]=J[2],M[re+3]=J[3]}else for(let V=0;V<f.width*g;V++)M[j+V]=E[B+V]}return e}jt(Tw,"HeatmapBucket",{omit:["layers"]});class mh{constructor(e,i){X_(this,e,1,i)}resize(e){Rx(this,new mh(e),1)}clone(){return new mh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,c,f,g){Dv(e,i,c,f,g,1,null)}}class Ja{constructor(e,i){X_(this,e,4,i)}resize(e){Rx(this,new Ja(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ja({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,c,f,g,y,b){Dv(e,i,c,f,g,4,y,b)}}class Ew{constructor(e,i){this.width=e.width,this.height=e.height,this.data=i instanceof Uint8Array?new Float32Array(i.buffer):i}}function pg(s){const e={},i=s.resolution||256,c=s.clips?s.clips.length:1,f=s.image||new Ja({width:i,height:c}),g=(y,b,E)=>{e[s.evaluationKey]=E;const M=s.expression.evaluate(e),R=M?M.toNonPremultipliedRenderColor(null):null;R&&(f.data[y+b+0]=Math.floor(255*R.r),f.data[y+b+1]=Math.floor(255*R.g),f.data[y+b+2]=Math.floor(255*R.b),f.data[y+b+3]=Math.floor(255*R.a))};if(s.clips)for(let y=0,b=0;y<c;++y,b+=4*i)for(let E=0,M=0;E<i;E++,M+=4){const R=E/(i-1),{start:z,end:B}=s.clips[y];g(b,M,z*(1-R)+B*R)}else for(let y=0,b=0;y<i;y++,b+=4)g(0,b,y/(i-1));return f}jt(mh,"AlphaImage"),jt(Ja,"RGBAImage");const xS=en([{name:"a_pos",components:2,type:"Int16"}],4),Mw=en([{name:"a_road_z_offset",components:1,type:"Float32"}],4),bS=en([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),wS=en([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function tc(s,e,i=2){const c=e&&e.length,f=c?e[0]*i:s.length;let g=zx(s,0,f,i,!0);const y=[];if(!g||g.next===g.prev)return y;let b,E,M;if(c&&(g=(function(R,z,B,j){const V=[];for(let Y=0,re=z.length;Y<re;Y++){const J=zx(R,z[Y]*j,Y<re-1?z[Y+1]*j:R.length,j,!1);J===J.next&&(J.steiner=!0),V.push(Cw(J))}V.sort(Bx);for(let Y=0;Y<V.length;Y++)B=SS(V[Y],B);return B})(s,e,g,i)),s.length>80*i){b=s[0],E=s[1];let R=b,z=E;for(let B=i;B<f;B+=i){const j=s[B],V=s[B+1];j<b&&(b=j),V<E&&(E=V),j>R&&(R=j),V>z&&(z=V)}M=Math.max(R-b,z-E),M=M!==0?32767/M:0}return Gp(g,y,i,b,E,M,0),y}function zx(s,e,i,c,f){let g;if(f===(function(y,b,E,M){let R=0;for(let z=b,B=E-M;z<E;z+=M)R+=(y[B]-y[z])*(y[z+1]+y[B+1]),B=z;return R})(s,e,i,c)>0)for(let y=e;y<i;y+=c)g=Fx(y/c|0,s[y],s[y+1],g);else for(let y=i-c;y>=e;y-=c)g=Fx(y/c|0,s[y],s[y+1],g);return g&&$p(g,g.next)&&(Q_(g),g=g.next),g}function Of(s,e){if(!s)return s;e||(e=s);let i,c=s;do if(i=!1,c.steiner||!$p(c,c.next)&&Mi(c.prev,c,c.next)!==0)c=c.next;else{if(Q_(c),c=e=c.prev,c===c.next)break;i=!0}while(i||c!==e);return e}function Gp(s,e,i,c,f,g,y){if(!s)return;!y&&g&&(function(E,M,R,z){let B=E;do B.z===0&&(B.z=Z_(B.x,B.y,M,R,z)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==E);B.prevZ.nextZ=null,B.prevZ=null,(function(j){let V,Y=1;do{let re,J=j;j=null;let oe=null;for(V=0;J;){V++;let ce=J,pe=0;for(let we=0;we<Y&&(pe++,ce=ce.nextZ,ce);we++);let Se=Y;for(;pe>0||Se>0&&ce;)pe!==0&&(Se===0||!ce||J.z<=ce.z)?(re=J,J=J.nextZ,pe--):(re=ce,ce=ce.nextZ,Se--),oe?oe.nextZ=re:j=re,re.prevZ=oe,oe=re;J=ce}oe.nextZ=null,Y*=2}while(V>1)})(B)})(s,c,f,g);let b=s;for(;s.prev!==s.next;){const E=s.prev,M=s.next;if(g?TS(s,c,f,g):AS(s))e.push(E.i,s.i,M.i),Q_(s),s=M.next,b=M.next;else if((s=M)===b){y?y===1?Gp(s=Ow(Of(s),e),e,i,c,f,g,2):y===2&&Lx(s,e,i,c,f,g):Gp(Of(s),e,i,c,f,g,1);break}}}function AS(s){const e=s.prev,i=s,c=s.next;if(Mi(e,i,c)>=0)return!1;const f=e.x,g=i.x,y=c.x,b=e.y,E=i.y,M=c.y,R=Math.min(f,g,y),z=Math.min(b,E,M),B=Math.max(f,g,y),j=Math.max(b,E,M);let V=c.next;for(;V!==e;){if(V.x>=R&&V.x<=B&&V.y>=z&&V.y<=j&&mg(f,b,g,E,y,M,V.x,V.y)&&Mi(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function TS(s,e,i,c){const f=s.prev,g=s,y=s.next;if(Mi(f,g,y)>=0)return!1;const b=f.x,E=g.x,M=y.x,R=f.y,z=g.y,B=y.y,j=Math.min(b,E,M),V=Math.min(R,z,B),Y=Math.max(b,E,M),re=Math.max(R,z,B),J=Z_(j,V,e,i,c),oe=Z_(Y,re,e,i,c);let ce=s.prevZ,pe=s.nextZ;for(;ce&&ce.z>=J&&pe&&pe.z<=oe;){if(ce.x>=j&&ce.x<=Y&&ce.y>=V&&ce.y<=re&&ce!==f&&ce!==y&&mg(b,R,E,z,M,B,ce.x,ce.y)&&Mi(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,pe.x>=j&&pe.x<=Y&&pe.y>=V&&pe.y<=re&&pe!==f&&pe!==y&&mg(b,R,E,z,M,B,pe.x,pe.y)&&Mi(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;ce&&ce.z>=J;){if(ce.x>=j&&ce.x<=Y&&ce.y>=V&&ce.y<=re&&ce!==f&&ce!==y&&mg(b,R,E,z,M,B,ce.x,ce.y)&&Mi(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;pe&&pe.z<=oe;){if(pe.x>=j&&pe.x<=Y&&pe.y>=V&&pe.y<=re&&pe!==f&&pe!==y&&mg(b,R,E,z,M,B,pe.x,pe.y)&&Mi(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function Ow(s,e){let i=s;do{const c=i.prev,f=i.next.next;!$p(c,f)&&Y_(c,i,i.next,f)&&K_(c,f)&&K_(f,c)&&(e.push(c.i,i.i,f.i),Q_(i),Q_(i.next),i=s=f),i=i.next}while(i!==s);return Of(i)}function Lx(s,e,i,c,f,g){let y=s;do{let b=y.next.next;for(;b!==y.prev;){if(y.i!==b.i&&W_(y,b)){let E=qp(y,b);return y=Of(y,y.next),E=Of(E,E.next),Gp(y,e,i,c,f,g,0),void Gp(E,e,i,c,f,g,0)}b=b.next}y=y.next}while(y!==s)}function Bx(s,e){let i=s.x-e.x;return i===0&&(i=s.y-e.y,i===0)&&(i=(s.next.y-s.y)/(s.next.x-s.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function SS(s,e){const i=(function(f,g){let y=g;const b=f.x,E=f.y;let M,R=-1/0;if($p(f,y))return y;do{if($p(f,y.next))return y.next;if(E<=y.y&&E>=y.next.y&&y.next.y!==y.y){const Y=y.x+(E-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(Y<=b&&Y>R&&(R=Y,M=y.x<y.next.x?y:y.next,Y===b))return M}y=y.next}while(y!==g);if(!M)return null;const z=M,B=M.x,j=M.y;let V=1/0;y=M;do{if(b>=y.x&&y.x>=B&&b!==y.x&&kx(E<j?b:R,E,B,j,E<j?R:b,E,y.x,y.y)){const Y=Math.abs(E-y.y)/(b-y.x);K_(y,f)&&(Y<V||Y===V&&(y.x>M.x||y.x===M.x&&kc(M,y)))&&(M=y,V=Y)}y=y.next}while(y!==z);return M})(s,e);if(!i)return e;const c=qp(i,s);return Of(c,c.next),Of(i,i.next)}function kc(s,e){return Mi(s.prev,s,e.prev)<0&&Mi(e.next,s,s.next)<0}function Z_(s,e,i,c,f){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-i)*f|0)|s<<8))|s<<4))|s<<2))|s<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Cw(s){let e=s,i=s;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==s);return i}function kx(s,e,i,c,f,g,y,b){return(f-y)*(e-b)>=(s-y)*(g-b)&&(s-y)*(c-b)>=(i-y)*(e-b)&&(i-y)*(g-b)>=(f-y)*(c-b)}function mg(s,e,i,c,f,g,y,b){return!(s===y&&e===b)&&kx(s,e,i,c,f,g,y,b)}function W_(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!(function(i,c){let f=i;do{if(f.i!==i.i&&f.next.i!==i.i&&f.i!==c.i&&f.next.i!==c.i&&Y_(f,f.next,i,c))return!0;f=f.next}while(f!==i);return!1})(s,e)&&(K_(s,e)&&K_(e,s)&&(function(i,c){let f=i,g=!1;const y=(i.x+c.x)/2,b=(i.y+c.y)/2;do f.y>b!=f.next.y>b&&f.next.y!==f.y&&y<(f.next.x-f.x)*(b-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==i);return g})(s,e)&&(Mi(s.prev,s,e.prev)||Mi(s,e.prev,e))||$p(s,e)&&Mi(s.prev,s,s.next)>0&&Mi(e.prev,e,e.next)>0)}function Mi(s,e,i){return(e.y-s.y)*(i.x-e.x)-(e.x-s.x)*(i.y-e.y)}function $p(s,e){return s.x===e.x&&s.y===e.y}function Y_(s,e,i,c){const f=Rv(Mi(s,e,i)),g=Rv(Mi(s,e,c)),y=Rv(Mi(i,c,s)),b=Rv(Mi(i,c,e));return f!==g&&y!==b||!(f!==0||!Fc(s,i,e))||!(g!==0||!Fc(s,c,e))||!(y!==0||!Fc(i,s,c))||!(b!==0||!Fc(i,e,c))}function Fc(s,e,i){return e.x<=Math.max(s.x,i.x)&&e.x>=Math.min(s.x,i.x)&&e.y<=Math.max(s.y,i.y)&&e.y>=Math.min(s.y,i.y)}function Rv(s){return s>0?1:s<0?-1:0}function K_(s,e){return Mi(s.prev,s,s.next)<0?Mi(s,e,s.next)>=0&&Mi(s,s.prev,e)>=0:Mi(s,e,s.prev)<0||Mi(s,s.next,e)<0}function qp(s,e){const i=Nx(s.i,s.x,s.y),c=Nx(e.i,e.x,e.y),f=s.next,g=e.prev;return s.next=e,e.prev=s,i.next=f,f.prev=i,c.next=i,i.prev=c,g.next=c,c.prev=g,c}function Fx(s,e,i,c){const f=Nx(s,e,i);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Q_(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Nx(s,e,i){return{i:s,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function J_(s,e){const i=s.length;if(i<=1)return[s];const c=[];let f,g;for(let y=0;y<i;y++){const b=yi(s[y]);b!==0&&(s[y].area=Math.abs(b),g===void 0&&(g=b<0),g===b<0?(f&&c.push(f),f=[s[y]]):f.push(s[y]))}if(f&&c.push(f),e>1)for(let y=0;y<c.length;y++)c[y].length<=e||(rp(c[y],e,1,c[y].length-1,ES),c[y]=c[y].slice(0,e));return c}function ES(s,e){return e.area-s.area}function Iw(s,e,i=1){if(!s)return null;const c=typeof s=="string"?ls.from(s).getPrimary():s.getPrimary(),f=typeof s=="string"?null:s.getSecondary();for(const g of[c,f]){if(!g)continue;const y=g.id.toString();e.has(y)||e.set(y,[]),g.scaleSelf(i),e.get(y).push(g)}return{primary:c.toString(),secondary:f?f.toString():null}}function jx(s,e,i,c){const f=c.patternDependencies;let g=!1;for(const y of e){const b=y.paint.get(`${s}-pattern`);b.isConstant()||(g=!0),Iw(b.constantOr(null),f,i)&&(g=!0)}return g}function Ux(s,e,i,c,f,g){const y=g.patternDependencies;for(const b of e){const E=b.paint.get(`${s}-pattern`).value;if(E.kind!=="constant"){let M=E.evaluate({zoom:c},i,{},g.availableImages);M=M&&M.name?M.name:M;const R=Iw(M,y,f);if(!R)continue;const{primary:z,secondary:B}=R;z&&(i.patterns[b.id]=[z,B].filter(Boolean))}}return i}class gh{constructor(){this.portals=[]}static isOnBorder(e,i){return e<=0&&i<=0||e>=Gt&&i>=Gt}static evaluate(e){if(e.length===0)return new gh;let i=[];for(const E of e)i.push(...E.portals);if(i.length===0)return new gh;for(const E of i){const M=E.va,R=E.vb;(gh.isOnBorder(M.x,R.x)||gh.isOnBorder(M.y,R.y))&&(E.type="border")}const c=i.filter(E=>E.type!=="unevaluated"),f=i.filter(E=>E.type==="unevaluated");if(f.length===0)return new gh;f.sort((E,M)=>E.hash===M.hash?E.isTunnel===M.isTunnel?0:E.isTunnel?-1:1:E.hash<M.hash?1:-1),i=c.concat(f);let g=c.length,y=g,b=g;do if(y++,y===i.length||i[g].hash!==i[y].hash){if(y-g===2){b<g&&(i[b]=i[g],i[g]=null);const E=i[b],M=i[y-1];E.type=E.isTunnel!==M.isTunnel?"tunnel":"polygon",E.connection={a:E.connection.a,b:M.connection.a},b++}g=y}while(g!==i.length);return i.splice(b),i.sort((E,M)=>E.hash<M.hash?1:-1),{portals:i}}}jt(gh,"ElevationPortalGraph");class gg{constructor(e,i,c){this.outPositions=e,this.outNormals=i,this.outIndices=c,this.vertexLookup=new Map}addVertex(e,i,c){let f=e[2];c!=null&&(f*=c);const g=`${e[0]},${e[1]},${e[2]},${i[0]},${i[1]},${i[2]}`,y=this.vertexLookup.get(g);if(y!=null)return y;const b=this.outPositions.length;this.vertexLookup.set(g,b);const E=Math.trunc(16384*i[0]),M=Math.trunc(16384*i[1]),R=Math.trunc(16384*i[2]);return this.outPositions.emplaceBack(e[0],e[1],f),this.outNormals.emplaceBack(E,M,R),b}addTriangle(e,i,c){this.outIndices.emplaceBack(e,i,c)}addTriangles(e,i,c){if(e.length===0)return;const f=c.length===1,g=st(),y=st();for(let b=0;b<e.length;b+=3){const E=i[e[b+0]],M=i[e[b+1]],R=i[e[b+2]],z=f?c[0]:c[e[b+1]],B=f?c[0]:c[e[b+2]];rt(g,E.x,E.y,f?c[0]:c[e[b+0]]);const j=this.addVertex(g,y);rt(g,M.x,M.y,z);const V=this.addVertex(g,y);rt(g,R.x,R.y,B);const Y=this.addVertex(g,y);this.outIndices.emplaceBack(j,V,Y)}}addQuad(e,i,c,f,g,y){const b=this.addVertex(e,g,y),E=this.addVertex(i,g,y),M=this.addVertex(c,g,y),R=this.addVertex(f,g,y);this.addTriangle(b,E,M),this.addTriangle(M,R,b)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class jo{constructor(e,i,c,f){this.unevaluatedPortals=new gh,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new ff,this.vertexNormals=new Lp,this.indexArray=new pa,this.tileToMeters=zt(e),this.bridgeProgramConfigurations=new N(i,{zoom:c,lut:f},g=>g!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new N(i,{zoom:c,lut:f},g=>g!=="fill-bridge-guard-rail-color")}addVertices(e,i){const c=this.unevalVertices.length;for(let f=0;f<e.length;f++)this.unevalVertices.push(e[f]),this.unevalHeights.push(i[f]);return c}addTriangles(e,i,c){const f=c?this.unevalTunnelTriangles:this.unevalTriangles;for(const g of e)f.push(g+i)}addRenderableRing(e,i,c,f,g,y){const b=[new yt(g.min.x,g.min.y),new yt(g.max.x,g.min.y),new yt(g.max.x,g.max.y),new yt(g.min.x,g.max.y)];for(let E=0;E<c-1;E++){const M=i+E,R=M+1,z=this.unevalVertices[M],B=this.unevalVertices[R];if(!(z.x>=g.min.x&&z.x<=g.max.x&&z.y>=g.min.y&&z.y<=g.max.y||B.x>=g.min.x&&B.x<=g.max.x&&B.y>=g.min.y&&B.y<=g.max.y||ec(z,B,b))||this.isOnBorder(z.x,B.x)||this.isOnBorder(z.y,B.y))continue;const j=jo.computeEdgeHash(this.unevalVertices[M],this.unevalVertices[R]);let V,Y=this.vertexHashLookup.get(jo.computePosHash(z));Y!=null?V=Y.next:(Y=this.vertexHashLookup.get(jo.computePosHash(B)),V=Y!=null?Y.prev:j),this.unevalEdges.push({polygonIdx:e,a:M,b:R,hash:j,portalHash:V,isTunnel:f,type:"unevaluated",featureInfo:y})}}addPortalCandidates(e,i,c,f,g){if(i.length!==0){this.vertexHashLookup.clear();for(const y of i){if(y.length===0)continue;const b=y[0];let E=jo.computeEdgeHash(b[b.length-2],b[b.length-1]);for(let M=0;M<b.length-1;M++){const R=b[M+0],z=b[M+1],B=qi(z.x-R.x,z.y-R.y),j=_a(B);if(j===0)continue;let V="unevaluated";const Y=f.pointElevation(R),re=f.pointElevation(z);Math.abs(Y)<.01&&Math.abs(re)<.01?V="entrance":(this.isOnBorder(R.x,z.x)||this.isOnBorder(R.y,z.y))&&(V="border");const J=jo.computeEdgeHash(R,z);this.unevaluatedPortals.portals.push({connection:{a:e,b:void 0},va:R,vb:z,vab:B,length:j,hash:J,isTunnel:c,type:V});const oe=jo.computePosHash(R);this.vertexHashLookup.set(oe,{prev:E,next:J}),E=J}}}}construct(e){if(this.unevalVertices.length===0)return;const i=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),c=B=>{B.primitiveLength=this.indexArray.length-B.primitiveOffset},f=new gg(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(e.portals,this.unevalEdges);const g=i(),y=i(),b=i(),E=(B,j)=>{B.sort((Y,re)=>Y.type===j&&re.type!==j?-1:Y.type!==j&&re.type===j?1:0);const V=B.findIndex(Y=>Y.type!==j);return V>=0?V:B.length};let M=0;this.unevalEdges.length>0&&(M=E(this.unevalEdges,"none"),this.constructBridgeStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},this.tileToMeters)),c(b);const R=i(),z=i();if(this.unevalEdges.length>0){const B=this.unevalEdges.splice(M),j=E(B,"tunnel")+M;this.unevalEdges.push(...B),this.constructTunnelStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:M},{min:M,max:j})}c(R),f.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),c(z),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),c(y),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),c(g),this.maskSegments=ui.simpleSegment(0,z.primitiveOffset,0,z.primitiveLength),this.depthSegments=ui.simpleSegment(0,y.primitiveOffset,0,y.primitiveLength),this.renderableBridgeSegments=ui.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength),this.renderableTunnelSegments=ui.simpleSegment(0,R.primitiveOffset,0,R.primitiveLength),this.shadowCasterSegments=ui.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength)}update(e,i,c,f,g,y,b,E){this.bridgeProgramConfigurations.updatePaintArrays(e,i,g,c,f,y,b,E),this.tunnelProgramConfigurations.updatePaintArrays(e,i,g,c,f,y,b,E)}upload(e){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=e.createVertexBuffer(this.vertexPositions,bS.members),this.vertexBufferNormal=e.createVertexBuffer(this.vertexNormals,wS.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(e),this.tunnelProgramConfigurations.upload(e))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(e,i,c,f,g){const y=(b,E)=>{for(let M=0;M<E.length-1;M++){const R=E[M].featureIndex,z=E[M+1].vertexStart,B=e.feature(R);b.populatePaintArrays(z,B,R,{},c,i,f,void 0,g)}};y(this.bridgeProgramConfigurations,this.bridgeFeatureSections),y(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(e,i,c,f,g){const y=new Map;for(let b=f;b<g;b++){const E=c[b],M=E.a,R=E.b,z=jo.computePosHash(e[M]),B=jo.computePosHash(e[R]);let j=y.get(z);j||(j={},y.set(z,j));let V=y.get(B);V||(V={},y.set(B,V)),i[M]<=0&&i[R]<=0||(j.to=R,V.from=M)}return y}isTerminalVertex(e,i){const c=jo.computePosHash(this.unevalVertices[e]),f=i.get(c);return!f||!f.from||!f.to}constructBridgeStructures(e,i,c,f,g,y){e.clearVertexLookup();const b=this.computeVertexConnections(i,c,f,g.min,g.max),E=1/y,M=.5*E,R=(St,At)=>rt(St,i[At].x,i[At].y,c[At]*E),z=st(),B=st(),j=st(),V=st(),Y=st(),re=(St,At)=>{const Tt=b.get(jo.computePosHash(i[At])),lt=Tt.from,Ot=Tt.to;if(!lt||!Ot)return;R(z,lt),R(B,At),R(j,Ot),Fn(V),Ut(z,B)||(_n(Y,B,z),Xt(V,Y)),Ut(j,B)||(_n(Y,j,B),Ct(V,V,Xt(Y,Y)));const xt=da(V);return xt>0?Bt(St,V,1/xt):void 0};let J=Number.POSITIVE_INFINITY;this.sortSubarray(f,g.min,g.max,(St,At)=>St.featureInfo.featureIndex-At.featureInfo.featureIndex);const oe=st(),ce=st(),pe=st(),Se=st(),we=st(),Ie=st(),Pe=st(),Oe=st(),ke=st(),Ge=[st(),st(),st(),st()],pt=[st(),st(),st(),st()],ct=[{coord:new yt(0,0),height:0},{coord:new yt(0,0),height:0}],dt=(St,At)=>St>At;for(let St=g.min;St<g.max;St++){const At=f[St];if(!At.featureInfo.guardRailEnabled||!this.prepareEdgePoints(ct,i,c,At,dt))continue;const[Tt,lt]=ct;if(rt(oe,Tt.coord.x,Tt.coord.y,E*Tt.height),rt(ce,lt.coord.x,lt.coord.y,E*lt.height),Ut(oe,ce))continue;_n(pe,ce,oe),Xt(pe,pe);const Ot=re(Oe,At.a)||pe,xt=re(ke,At.b)||pe;rt(Se,Ot[1],-Ot[0],0),Xt(Se,Se),rt(we,xt[1],-xt[0],0),Xt(we,we),kr(Oe,Se,Ot),Xt(Ie,Oe),kr(Oe,we,xt),Xt(Pe,Oe),Ct(Ge[0],oe,Bt(Oe,_n(Oe,Se,Ie),M)),Ct(Ge[1],oe,Bt(Oe,Ct(Oe,Se,Ie),M)),Ct(Ge[2],oe,Bt(Oe,Ie,M)),Ge[3]=oe,Ct(pt[0],ce,Bt(Oe,_n(Oe,we,Pe),M)),Ct(pt[1],ce,Bt(Oe,Ct(Oe,we,Pe),M)),Ct(pt[2],ce,Bt(Oe,Pe,M)),pt[3]=ce,J=this.addFeatureSection(At.featureInfo.featureIndex,J,this.bridgeFeatureSections,e);const It=e.addVertex(Ge[0],Se,y),Et=e.addVertex(Ge[1],Se,y),rr=e.addVertex(pt[0],we,y),nr=e.addVertex(pt[1],we,y);e.addTriangle(It,Et,rr),e.addTriangle(Et,nr,rr);const Ht=e.addVertex(Ge[1],Ie,y),Yt=e.addVertex(Ge[2],Ie,y),wr=e.addVertex(pt[1],Pe,y),gr=e.addVertex(pt[2],Pe,y);e.addTriangle(Ht,Yt,wr),e.addTriangle(Yt,gr,wr),fn(Se,Se),fn(we,we);const tr=e.addVertex(Ge[2],Se,y),Fr=e.addVertex(Ge[3],Se,y),nn=e.addVertex(pt[2],we,y),On=e.addVertex(pt[3],we,y);e.addTriangle(tr,Fr,nn),e.addTriangle(Fr,On,nn);const Yr=this.isTerminalVertex(At.a,b),Hn=this.isTerminalVertex(At.b,b);Tt.height<.01&&Yr&&e.addQuad(Ge[3],Ge[2],Ge[1],Ge[0],fn(Ot,Ot),y),lt.height<.01&&Hn&&e.addQuad(pt[0],pt[1],pt[2],pt[3],xt,y)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:e.getVertexCount()})}constructTunnelStructures(e,i,c,f,g,y){e.clearVertexLookup();let b=Number.POSITIVE_INFINITY;const E=(J,oe)=>J.featureInfo.featureIndex-oe.featureInfo.featureIndex;this.sortSubarray(f,g.min,g.max,E),this.sortSubarray(f,y.min,y.max,E);const M=J=>Xt(J,J),R=[{coord:new yt(0,0),height:0},{coord:new yt(0,0),height:0}],z=(J,oe)=>J<oe,B=st(),j=st(),V=st(),Y=st(),re=st();for(let J=g.min;J<g.max;J++){if(!this.prepareEdgePoints(R,i,c,f[J],z))continue;const[oe,ce]=R,pe=M(rt(re,-(ce.coord.y-oe.coord.y),ce.coord.x-oe.coord.x,0));b=this.addFeatureSection(f[J].featureInfo.featureIndex,b,this.tunnelFeatureSections,e),e.addQuad(rt(B,oe.coord.x,oe.coord.y,oe.height),rt(j,ce.coord.x,ce.coord.y,ce.height),rt(V,ce.coord.x,ce.coord.y,f[J].isTunnel?-.1:0),rt(Y,oe.coord.x,oe.coord.y,f[J].isTunnel?-.1:0),pe)}for(let J=y.min;J<y.max;J++){const oe=f[J];oe.isTunnel&&([oe.a,oe.b]=[oe.b,oe.a]);const ce=i[oe.a],pe=i[oe.b],Se=M(rt(re,-(pe.y-ce.y),pe.x-ce.x,0));b=this.addFeatureSection(oe.featureInfo.featureIndex,b,this.tunnelFeatureSections,e),e.addQuad(rt(B,pe.x,pe.y,0),rt(j,ce.x,ce.y,0),rt(V,ce.x,ce.y,c[oe.a]+4),rt(Y,pe.x,pe.y,c[oe.b]+4),Se),e.addQuad(rt(B,ce.x,ce.y,0),rt(j,pe.x,pe.y,0),rt(V,pe.x,pe.y,c[oe.b]+4),rt(Y,ce.x,ce.y,c[oe.a]+4),Se)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:e.getVertexCount()})}setElevatedPoint(e,i,c,f){e.coord.x=i,e.coord.y=c,e.height=f}prepareEdgePoints(e,i,c,f,g){let y=i[f.a].x,b=i[f.a].y,E=i[f.b].x,M=i[f.b].y,R=c[f.a],z=c[f.b];const B=g(R,0),j=g(z,0);if(B&&j)return this.setElevatedPoint(e[0],y,b,R),this.setElevatedPoint(e[1],E,M,z),!0;if(!B&&!j)return!1;if(B){if(!j){const V=z/(z-R);E=Dr(E,y,V),M=Dr(M,b,V),z=Dr(z,R,V)}}else{const V=R/(R-z);y=Dr(y,E,V),b=Dr(b,M,V),R=Dr(R,z,V)}return this.setElevatedPoint(e[0],y,b,R),this.setElevatedPoint(e[1],E,M,z),!0}prepareEdges(e,i){if(i.length===0)return;i.sort((b,E)=>b.hash===E.hash?E.polygonIdx-b.polygonIdx:E.hash>b.hash?1:-1);let c=0,f=0,g=0,y=i[c].polygonIdx;do f++,(f===i.length||i[c].hash!==i[f].hash)&&((f-c===1||i[f-1].polygonIdx!==y)&&(g<c&&(i[g]=i[c],i[c]=null),i[g].type="none",g++),c=f,c!==i.length&&(y=i[c].polygonIdx));while(c!==i.length);if(i.splice(g),i.length!==0&&e.length!==0){i.sort((M,R)=>M.portalHash<R.portalHash?1:-1);let b=0,E=0;for(;b!==i.length&&E!==e.length;){const M=i[b],R=e[E];M.portalHash>R.hash?b++:R.hash>M.portalHash?E++:(M.type=R.type,b++)}}}isOnBorder(e,i){return e<=0&&i<=0||e>=Gt&&i>=Gt}addFeatureSection(e,i,c,f){return e!==i&&(i=e,c.push({featureIndex:e,vertexStart:f.getVertexCount()}),f.clearVertexLookup()),i}sortSubarray(e,i,c,f){const g=e.slice(i,c);g.sort(f),e.splice(i,g.length,...g)}static computeEdgeHash(e,i){return(e.y===i.y&&e.x>i.x||e.y>i.y)&&([e,i]=[i,e]),BigInt(jo.computePosHash(e))<<32n|BigInt(jo.computePosHash(i))}static computePosHash(e){return((65535&e.x)<<16|65535&e.y)>>>0}}function Pw(s,e){return s>e?1:s<e?-1:0}class Vx{constructor(e=Pw,i=!1){this._compare=e,this._root=null,this._size=0,this._noDuplicates=!!i}rotateLeft(e){var i=e.right;i&&(e.right=i.left,i.left&&(i.left.parent=e),i.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=i:e.parent.right=i:this._root=i,i&&(i.left=e),e.parent=i}rotateRight(e){var i=e.left;i&&(e.left=i.right,i.right&&(i.right.parent=e),i.parent=e.parent),e.parent?e===e.parent.left?e.parent.left=i:e.parent.right=i:this._root=i,i&&(i.right=e),e.parent=i}_splay(e){for(;e.parent;){var i=e.parent;i.parent?i.left===e&&i.parent.left===i?(this.rotateRight(i.parent),this.rotateRight(i)):i.right===e&&i.parent.right===i?(this.rotateLeft(i.parent),this.rotateLeft(i)):i.left===e&&i.parent.right===i?(this.rotateRight(i),this.rotateLeft(i)):(this.rotateLeft(i),this.rotateRight(i)):i.left===e?this.rotateRight(i):this.rotateLeft(i)}}splay(e){for(var i,c,f,g,y;e.parent;)(c=(i=e.parent).parent)&&c.parent?((f=c.parent).left===c?f.left=e:f.right=e,e.parent=f):(e.parent=null,this._root=e),g=e.left,y=e.right,e===i.left?(c&&(c.left===i?(i.right?(c.left=i.right,c.left.parent=c):c.left=null,i.right=c,c.parent=i):(g?(c.right=g,g.parent=c):c.right=null,e.left=c,c.parent=e)),y?(i.left=y,y.parent=i):i.left=null,e.right=i,i.parent=e):(c&&(c.right===i?(i.left?(c.right=i.left,c.right.parent=c):c.right=null,i.left=c,c.parent=i):(y?(c.left=y,y.parent=c):c.left=null,e.right=c,c.parent=e)),g?(i.right=g,g.parent=i):i.right=null,e.left=i,i.parent=e)}replace(e,i){e.parent?e===e.parent.left?e.parent.left=i:e.parent.right=i:this._root=i,i&&(i.parent=e.parent)}minNode(e=this._root){if(e)for(;e.left;)e=e.left;return e}maxNode(e=this._root){if(e)for(;e.right;)e=e.right;return e}insert(e,i){var c=this._root,f=null,g=this._compare;if(this._noDuplicates)for(;c;){if(f=c,g(c.key,e)===0)return;c=g(c.key,e)<0?c.right:c.left}else for(;c;)f=c,c=g(c.key,e)<0?c.right:c.left;return c={key:e,data:i,left:null,right:null,parent:f},f?g(f.key,c.key)<0?f.right=c:f.left=c:this._root=c,this.splay(c),this._size++,c}find(e){for(var i=this._root,c=this._compare;i;){var f=c(i.key,e);if(f<0)i=i.right;else{if(!(f>0))return i;i=i.left}}return null}contains(e){for(var i=this._root,c=this._compare;i;){var f=c(e,i.key);if(f===0)return!0;i=f<0?i.left:i.right}return!1}remove(e){var i=this.find(e);if(!i)return!1;if(this.splay(i),i.left)if(i.right){var c=this.minNode(i.right);c.parent!==i&&(this.replace(c,c.right),c.right=i.right,c.right.parent=c),this.replace(i,c),c.left=i.left,c.left.parent=c}else this.replace(i,i.left);else this.replace(i,i.right);return this._size--,!0}removeNode(e){if(!e)return!1;if(this.splay(e),e.left)if(e.right){var i=this.minNode(e.right);i.parent!==e&&(this.replace(i,i.right),i.right=e.right,i.right.parent=i),this.replace(e,i),i.left=e.left,i.left.parent=i}else this.replace(e,e.left);else this.replace(e,e.right);return this._size--,!0}erase(e){var i=this.find(e);if(i){this.splay(i);var c=i.left,f=i.right,g=null;c&&(c.parent=null,g=this.maxNode(c),this.splay(g),this._root=g),f&&(c?g.right=f:this._root=f,f.parent=g),this._size--}}pop(){var e=this._root,i=null;if(e){for(;e.left;)e=e.left;i={key:e.key,data:e.data},this.remove(e.key)}return i}next(e){var i=e;if(i)if(i.right)for(i=i.right;i&&i.left;)i=i.left;else for(i=e.parent;i&&i.right===e;)e=i,i=i.parent;return i}prev(e){var i=e;if(i)if(i.left)for(i=i.left;i&&i.right;)i=i.right;else for(i=e.parent;i&&i.left===e;)e=i,i=i.parent;return i}forEach(e){for(var i=this._root,c=[],f=!1,g=0;!f;)i?(c.push(i),i=i.left):c.length>0?(e(i=c.pop(),g++),i=i.right):f=!0;return this}range(e,i,c,f){const g=[],y=this._compare;let b,E=this._root;for(;g.length!==0||E;)if(E)g.push(E),E=E.left;else{if(E=g.pop(),b=y(E.key,i),b>0)break;if(y(E.key,e)>=0&&c.call(f,E))return this;E=E.right}return this}keys(){for(var e=this._root,i=[],c=[],f=!1;!f;)e?(i.push(e),e=e.left):i.length>0?(e=i.pop(),c.push(e.key),e=e.right):f=!0;return c}values(){for(var e=this._root,i=[],c=[],f=!1;!f;)e?(i.push(e),e=e.left):i.length>0?(e=i.pop(),c.push(e.data),e=e.right):f=!0;return c}at(e){for(var i=this._root,c=[],f=!1,g=0;!f;)if(i)c.push(i),i=i.left;else if(c.length>0){if(i=c.pop(),g===e)return i;g++,i=i.right}else f=!0;return null}load(e=[],i=[],c=!1){if(this._size!==0)throw new Error("bulk-load: tree is not empty");const f=e.length;return c&&Hp(e,i,0,f-1,this._compare),this._root=Cf(null,e,i,0,f),this._size=f,this}min(){var e=this.minNode(this._root);return e?e.key:null}max(){var e=this.maxNode(this._root);return e?e.key:null}isEmpty(){return this._root===null}get size(){return this._size}static createTree(e,i,c,f,g){return new Vx(c,g).load(e,i,f)}}function Cf(s,e,i,c,f){const g=f-c;if(g>0){const y=c+Math.floor(g/2),b={key:e[y],data:i[y],parent:s};return b.left=Cf(b,e,i,c,y),b.right=Cf(b,e,i,y+1,f),b}return null}function Hp(s,e,i,c,f){if(i>=c)return;const g=s[i+c>>1];let y=i-1,b=c+1;for(;;){do y++;while(f(s[y],g)<0);do b--;while(f(s[b],g)>0);if(y>=b)break;let E=s[y];s[y]=s[b],s[b]=E,E=e[y],e[y]=e[b],e[b]=E}Hp(s,e,i,b,f),Hp(s,e,b+1,c,f)}const Gx=11102230246251565e-32,Uo=134217729,$x=(3+8*Gx)*Gx;function ey(s,e,i,c,f){let g,y,b,E,M=e[0],R=c[0],z=0,B=0;R>M==R>-M?(g=M,M=e[++z]):(g=R,R=c[++B]);let j=0;if(z<s&&B<i)for(R>M==R>-M?(y=M+g,b=g-(y-M),M=e[++z]):(y=R+g,b=g-(y-R),R=c[++B]),g=y,b!==0&&(f[j++]=b);z<s&&B<i;)R>M==R>-M?(y=g+M,E=y-g,b=g-(y-E)+(M-E),M=e[++z]):(y=g+R,E=y-g,b=g-(y-E)+(R-E),R=c[++B]),g=y,b!==0&&(f[j++]=b);for(;z<s;)y=g+M,E=y-g,b=g-(y-E)+(M-E),M=e[++z],g=y,b!==0&&(f[j++]=b);for(;B<i;)y=g+R,E=y-g,b=g-(y-E)+(R-E),R=c[++B],g=y,b!==0&&(f[j++]=b);return g===0&&j!==0||(f[j++]=g),j}function If(s){return new Float64Array(s)}const Xp=If(4),qx=If(8),Dw=If(12),Hx=If(16),il=If(4);function Zp(s,e,i){e===null?(s.inOut=!1,s.otherInOut=!0):(s.isSubject===e.isSubject?(s.inOut=!e.inOut,s.otherInOut=e.otherInOut):(s.inOut=!e.otherInOut,s.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(s.prevInResult=!Rw(e,i)||e.isVertical()?e.prevInResult:e)),s.resultTransition=Rw(s,i)?(function(c,f){let g,y=!c.inOut,b=!c.otherInOut;switch(f){case 0:g=y&&b;break;case 1:g=y||b;break;case 3:g=y!==b;break;case 2:g=c.isSubject?y&&!b:b&&!y}return g?1:-1})(s,i):0}function Rw(s,e){switch(s.type){case 0:switch(e){case 0:return!s.otherInOut;case 1:return s.otherInOut;case 2:return s.isSubject&&s.otherInOut||!s.isSubject&&!s.otherInOut;case 3:return!0}break;case 2:return e===0||e===1;case 3:return e===2;case 1:return!1}return!1}class xd{constructor(e,i,c,f,g){this.left=i,this.point=e,this.otherEvent=c,this.isSubject=f??!1,this.type=g||0,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0}isBelow(e){const i=this.point,c=this.otherEvent.point;return this.left?(i[0]-e[0])*(c[1]-e[1])-(c[0]-e[0])*(i[1]-e[1])>0:(c[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(c[1]-e[1])>0}isAbove(e){return!this.isBelow(e)}isVertical(){return this.point[0]===this.otherEvent.point[0]}get inResult(){return this.resultTransition!==0}clone(){const e=new xd(this.point,this.left,this.otherEvent,this.isSubject,this.type);return e.contourId=this.contourId,e.resultTransition=this.resultTransition,e.prevInResult=this.prevInResult,e.isExteriorRing=this.isExteriorRing,e.inOut=this.inOut,e.otherInOut=this.otherInOut,e}}function rc(s,e){return s[0]===e[0]&&s[1]===e[1]}function _g(s,e,i){const c=(function(f,g,y,b,E,M){const R=(g-M)*(y-E),z=(f-E)*(b-M),B=R-z;if(R===0||z===0||R>0!=z>0)return B;const j=Math.abs(R+z);return Math.abs(B)>=33306690738754716e-32*j?B:-(function(V,Y,re,J,oe,ce,pe){let Se,we,Ie,Pe,Oe,ke,Ge,pt,ct,dt,St,At,Tt,lt,Ot,xt,It,Et;const rr=V-oe,nr=re-oe,Ht=Y-ce,Yt=J-ce;lt=rr*Yt,ke=Uo*rr,Ge=ke-(ke-rr),pt=rr-Ge,ke=Uo*Yt,ct=ke-(ke-Yt),dt=Yt-ct,Ot=pt*dt-(lt-Ge*ct-pt*ct-Ge*dt),xt=Ht*nr,ke=Uo*Ht,Ge=ke-(ke-Ht),pt=Ht-Ge,ke=Uo*nr,ct=ke-(ke-nr),dt=nr-ct,It=pt*dt-(xt-Ge*ct-pt*ct-Ge*dt),St=Ot-It,Oe=Ot-St,Xp[0]=Ot-(St+Oe)+(Oe-It),At=lt+St,Oe=At-lt,Tt=lt-(At-Oe)+(St-Oe),St=Tt-xt,Oe=Tt-St,Xp[1]=Tt-(St+Oe)+(Oe-xt),Et=At+St,Oe=Et-At,Xp[2]=At-(Et-Oe)+(St-Oe),Xp[3]=Et;let wr=(function(On,Yr){let Hn=Yr[0];for(let gn=1;gn<4;gn++)Hn+=Yr[gn];return Hn})(0,Xp),gr=22204460492503146e-32*pe;if(wr>=gr||-wr>=gr||(Oe=V-rr,Se=V-(rr+Oe)+(Oe-oe),Oe=re-nr,Ie=re-(nr+Oe)+(Oe-oe),Oe=Y-Ht,we=Y-(Ht+Oe)+(Oe-ce),Oe=J-Yt,Pe=J-(Yt+Oe)+(Oe-ce),Se===0&&we===0&&Ie===0&&Pe===0)||(gr=11093356479670487e-47*pe+$x*Math.abs(wr),wr+=rr*Pe+Yt*Se-(Ht*Ie+nr*we),wr>=gr||-wr>=gr))return wr;lt=Se*Yt,ke=Uo*Se,Ge=ke-(ke-Se),pt=Se-Ge,ke=Uo*Yt,ct=ke-(ke-Yt),dt=Yt-ct,Ot=pt*dt-(lt-Ge*ct-pt*ct-Ge*dt),xt=we*nr,ke=Uo*we,Ge=ke-(ke-we),pt=we-Ge,ke=Uo*nr,ct=ke-(ke-nr),dt=nr-ct,It=pt*dt-(xt-Ge*ct-pt*ct-Ge*dt),St=Ot-It,Oe=Ot-St,il[0]=Ot-(St+Oe)+(Oe-It),At=lt+St,Oe=At-lt,Tt=lt-(At-Oe)+(St-Oe),St=Tt-xt,Oe=Tt-St,il[1]=Tt-(St+Oe)+(Oe-xt),Et=At+St,Oe=Et-At,il[2]=At-(Et-Oe)+(St-Oe),il[3]=Et;const tr=ey(4,Xp,4,il,qx);lt=rr*Pe,ke=Uo*rr,Ge=ke-(ke-rr),pt=rr-Ge,ke=Uo*Pe,ct=ke-(ke-Pe),dt=Pe-ct,Ot=pt*dt-(lt-Ge*ct-pt*ct-Ge*dt),xt=Ht*Ie,ke=Uo*Ht,Ge=ke-(ke-Ht),pt=Ht-Ge,ke=Uo*Ie,ct=ke-(ke-Ie),dt=Ie-ct,It=pt*dt-(xt-Ge*ct-pt*ct-Ge*dt),St=Ot-It,Oe=Ot-St,il[0]=Ot-(St+Oe)+(Oe-It),At=lt+St,Oe=At-lt,Tt=lt-(At-Oe)+(St-Oe),St=Tt-xt,Oe=Tt-St,il[1]=Tt-(St+Oe)+(Oe-xt),Et=At+St,Oe=Et-At,il[2]=At-(Et-Oe)+(St-Oe),il[3]=Et;const Fr=ey(tr,qx,4,il,Dw);lt=Se*Pe,ke=Uo*Se,Ge=ke-(ke-Se),pt=Se-Ge,ke=Uo*Pe,ct=ke-(ke-Pe),dt=Pe-ct,Ot=pt*dt-(lt-Ge*ct-pt*ct-Ge*dt),xt=we*Ie,ke=Uo*we,Ge=ke-(ke-we),pt=we-Ge,ke=Uo*Ie,ct=ke-(ke-Ie),dt=Ie-ct,It=pt*dt-(xt-Ge*ct-pt*ct-Ge*dt),St=Ot-It,Oe=Ot-St,il[0]=Ot-(St+Oe)+(Oe-It),At=lt+St,Oe=At-lt,Tt=lt-(At-Oe)+(St-Oe),St=Tt-xt,Oe=Tt-St,il[1]=Tt-(St+Oe)+(Oe-xt),Et=At+St,Oe=Et-At,il[2]=At-(Et-Oe)+(St-Oe),il[3]=Et;const nn=ey(Fr,Dw,4,il,Hx);return Hx[nn-1]})(f,g,y,b,E,M,j)})(s[0],s[1],e[0],e[1],i[0],i[1]);return c>0?-1:c<0?1:0}function Pf(s,e){const i=s.point,c=e.point;return i[0]>c[0]?1:i[0]<c[0]?-1:i[1]!==c[1]?i[1]>c[1]?1:-1:(function(f,g,y){return f.left!==g.left?f.left?1:-1:_g(y,f.otherEvent.point,g.otherEvent.point)!==0?f.isBelow(g.otherEvent.point)?-1:1:!f.isSubject&&g.isSubject?1:-1})(s,e,i)}function Nc(s,e,i){const c=new xd(e,!1,s,s.isSubject),f=new xd(e,!0,s.otherEvent,s.isSubject);return rc(s.point,s.otherEvent.point)&&console.warn("what is that, a collapsed segment?",s),c.contourId=f.contourId=s.contourId,Pf(f,s.otherEvent)>0&&(s.otherEvent.left=!0,f.left=!1),s.otherEvent.otherEvent=f,s.otherEvent=c,i.push(f),i.push(c),i}function zv(s,e){return s[0]*e[1]-s[1]*e[0]}function Lv(s,e){return s[0]*e[0]+s[1]*e[1]}function Bv(s,e,i){const c=(function(E,M,R,z){const B=[M[0]-E[0],M[1]-E[1]],j=[z[0]-R[0],z[1]-R[1]];function V(Ie,Pe,Oe){return[Ie[0]+Pe*Oe[0],Ie[1]+Pe*Oe[1]]}const Y=[R[0]-E[0],R[1]-E[1]];let re=zv(B,j),J=re*re;const oe=Lv(B,B);if(J>0){const Ie=zv(Y,j)/re;if(Ie<0||Ie>1)return null;const Pe=zv(Y,B)/re;return Pe<0||Pe>1?null:Ie===0||Ie===1?[V(E,Ie,B)]:Pe===0||Pe===1?[V(R,Pe,j)]:[V(E,Ie,B)]}if(re=zv(Y,B),J=re*re,J>0)return null;const ce=Lv(B,Y)/oe,pe=ce+Lv(B,j)/oe,Se=Math.min(ce,pe),we=Math.max(ce,pe);return Se<=1&&we>=0?Se===1?[V(E,Se>0?Se:0,B)]:we===0?[V(E,we<1?we:1,B)]:[V(E,Se>0?Se:0,B),V(E,we<1?we:1,B)]:null})(s.point,s.otherEvent.point,e.point,e.otherEvent.point),f=c?c.length:0;if(f===0||f===1&&(rc(s.point,e.point)||rc(s.otherEvent.point,e.otherEvent.point))||f===2&&s.isSubject===e.isSubject)return 0;if(f===1)return!rc(s.point,c[0])&&!rc(s.otherEvent.point,c[0])&&Nc(s,c[0],i),!rc(e.point,c[0])&&!rc(e.otherEvent.point,c[0])&&Nc(e,c[0],i),1;const g=[];let y=!1,b=!1;return rc(s.point,e.point)?y=!0:Pf(s,e)===1?g.push(e,s):g.push(s,e),rc(s.otherEvent.point,e.otherEvent.point)?b=!0:Pf(s.otherEvent,e.otherEvent)===1?g.push(e.otherEvent,s.otherEvent):g.push(s.otherEvent,e.otherEvent),y&&b||y?(e.type=1,s.type=e.inOut===s.inOut?2:3,y&&!b&&Nc(g[1].otherEvent,g[0].point,i),2):b?(Nc(g[0],g[1].point,i),3):g[0]!==g[3].otherEvent?(Nc(g[0],g[1].point,i),Nc(g[1],g[2].point,i),3):(Nc(g[0],g[1].point,i),Nc(g[3].otherEvent,g[2].point,i),3)}function zw(s,e){if(s===e)return 0;if(_g(s.point,s.otherEvent.point,e.point)!==0||_g(s.point,s.otherEvent.point,e.otherEvent.point)!==0)return rc(s.point,e.point)?s.isBelow(e.otherEvent.point)?-1:1:s.point[0]===e.point[0]?s.point[1]<e.point[1]?-1:1:Pf(s,e)===1?e.isAbove(s.point)?-1:1:s.isBelow(e.point)?-1:1;if(s.isSubject!==e.isSubject)return s.isSubject?-1:1;{let i=s.point,c=e.point;if(i[0]===c[0]&&i[1]===c[1])return i=s.otherEvent.point,c=e.otherEvent.point,i[0]===c[0]&&i[1]===c[1]?0:(s.contourId??0)>(e.contourId??0)?1:-1}return Pf(s,e)===1?1:-1}class Lw{constructor(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null}isExterior(){return this.holeOf==null}}function Xx(s,e,i,c){let f,g=s+1,y=e[s].point;const b=e.length;for(g<b&&(f=e[g].point);g<b&&f[0]===y[0]&&f[1]===y[1];){if(!i[g])return g;g++,g<b&&(f=e[g].point)}for(g=s-1;i[g]&&g>c;)g--;return g}function Bw(s,e,i){const c=new Lw;if(s.prevInResult!=null){const f=s.prevInResult,g=f.outputContourId;if(f.resultTransition>0){const y=e[g];if(y.holeOf!=null){const b=y.holeOf;e[b].holeIds.push(i),c.holeOf=b,c.depth=e[g].depth}else e[g].holeIds.push(i),c.holeOf=g,c.depth=e[g].depth+1}else c.holeOf=null,c.depth=e[g].depth}else c.holeOf=null,c.depth=0;return c}const Zx=Math.max,ty=Math.min;let kv=0;function kw(s,e,i,c,f,g){let y,b,E,M,R,z;for(y=0,b=s.length-1;y<b;y++){if(E=s[y],M=s[y+1],R=new xd(E,!1,void 0,e),z=new xd(M,!1,R,e),R.otherEvent=z,E[0]===M[0]&&E[1]===M[1])continue;R.contourId=z.contourId=i,g||(R.isExteriorRing=!1,z.isExteriorRing=!1),Pf(R,z)>0?z.left=!0:R.left=!0;const B=E[0],j=E[1];f[0]=ty(f[0],B),f[1]=ty(f[1],j),f[2]=Zx(f[2],B),f[3]=Zx(f[3],j),c.push(R),c.push(z)}}const yg=[];function Fv(s,e,i){let c=s,f=e;typeof s[0][0][0]=="number"&&(c=[s]),typeof e[0][0][0]=="number"&&(f=[e]);let g=(function(B,j,V){let Y=null;return B.length*j.length===0&&(V===0?Y=yg:V===2?Y=B:(V===1||V===3)&&(Y=B.length===0?j:B)),Y})(c,f,i);if(g)return g===yg?null:g;const y=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=(function(B,j,V,Y,re){const J=new qh(void 0,Pf);let oe,ce,pe,Se,we,Ie;for(pe=0,Se=B.length;pe<Se;pe++)for(oe=B[pe],we=0,Ie=oe.length;we<Ie;we++)ce=we===0,ce&&kv++,kw(oe[we],!0,kv,J,V,ce);for(pe=0,Se=j.length;pe<Se;pe++)for(oe=j[pe],we=0,Ie=oe.length;we<Ie;we++)ce=we===0,re===2&&(ce=!1),ce&&kv++,kw(oe[we],!1,kv,J,Y,ce);return J})(c,f,y,b,i);if(g=(function(B,j,V,Y,re){let J=null;return(V[0]>Y[2]||Y[0]>V[2]||V[1]>Y[3]||Y[1]>V[3])&&(re===0?J=yg:re===2?J=B:(re===1||re===3)&&(J=B.concat(j))),J})(c,f,y,b,i),g)return g===yg?null:g;const M=(function(B,j,V,Y,re,J){const oe=new Vx(zw),ce=[],pe=Math.min(Y[2],re[2]);let Se,we,Ie;for(;B.length!==0;){let Pe=B.pop();if(ce.push(Pe),J===0&&Pe.point[0]>pe||J===2&&Pe.point[0]>Y[2])break;if(Pe.left){we=Se=oe.insert(Pe),Ie=oe.minNode(),Se=Se!==Ie?oe.prev(Se):null,we=oe.next(we);const Oe=Se?Se.key:null;let ke;if(Zp(Pe,Oe,J),we&&Bv(Pe,we.key,B)===2&&(Zp(Pe,Oe,J),Zp(we.key,Pe,J)),Se&&Bv(Se.key,Pe,B)===2){let Ge=Se;Ge=Ge!==Ie?oe.prev(Ge):null,ke=Ge?Ge.key:null,Zp(Oe,ke,J),Zp(Pe,Oe,J)}}else Pe=Pe.otherEvent,we=Se=oe.find(Pe),Se&&we&&(Se=Se!==Ie?oe.prev(Se):null,we=oe.next(we),oe.remove(Pe),we&&Se&&Bv(Se.key,we.key,B))}return ce})(E,0,0,y,b,i),R=(function(B){let j,V;const Y=(function(oe){let ce,pe,Se,we,Ie;const Pe=[];for(pe=0,Se=oe.length;pe<Se;pe++)ce=oe[pe],(ce.left&&ce.inResult||!ce.left&&ce.otherEvent.inResult)&&Pe.push(ce);let Oe=!1;for(;!Oe;)for(Oe=!0,pe=0,Se=Pe.length;pe<Se;pe++)pe+1<Se&&Pf(Pe[pe],Pe[pe+1])===1&&(we=Pe[pe],Pe[pe]=Pe[pe+1],Pe[pe+1]=we,Oe=!1);for(pe=0,Se=Pe.length;pe<Se;pe++)ce=Pe[pe],ce.otherPos=pe;for(pe=0,Se=Pe.length;pe<Se;pe++)ce=Pe[pe],ce.left||(Ie=ce.otherPos,ce.otherPos=ce.otherEvent.otherPos,ce.otherEvent.otherPos=Ie);return Pe})(B),re={},J=[];for(j=0,V=Y.length;j<V;j++){if(re[j])continue;const oe=J.length,ce=Bw(Y[j],J,oe),pe=Ie=>{re[Ie]=!0,Ie<Y.length&&Y[Ie]&&(Y[Ie].outputContourId=oe)};let Se=j,we=j;for(ce.points.push(Y[j].point);pe(Se),Se=Y[Se].otherPos,pe(Se),ce.points.push(Y[Se].point),Se=Xx(Se,Y,re,we),!(Se==we||Se>=Y.length)&&Y[Se];);J.push(ce)}return J})(M),z=[];for(let B=0;B<R.length;B++){let j=R[B];if(j.isExterior()){let V=[j.points];for(let Y=0;Y<j.holeIds.length;Y++)V.push(R[j.holeIds[Y]].points);z.push(V)}}return z}function Wp(s,e,i,c){const f=[],g=c===0?(y,b,E,M,R,z)=>{y.push(new yt(z,E+(z-b)/(M-b)*(R-E)))}:(y,b,E,M,R,z)=>{y.push(new yt(b+(z-E)/(R-E)*(M-b),z))};for(const y of s){const b=[];for(const E of y){if(E.length<=2)continue;const M=[];for(let B=0;B<E.length-1;B++){const j=E[B].x,V=E[B].y,Y=E[B+1].x,re=E[B+1].y,J=c===0?j:V,oe=c===0?Y:re;J<e?oe>e&&g(M,j,V,Y,re,e):J>i?oe<i&&g(M,j,V,Y,re,i):M.push(E[B]),oe<e&&J>=e&&g(M,j,V,Y,re,e),oe>i&&J<=i&&g(M,j,V,Y,re,i)}let R=E[E.length-1];const z=c===0?R.x:R.y;z>=e&&z<=i&&M.push(R),M.length&&(R=M[M.length-1],M[0].x===R.x&&M[0].y===R.y||M.push(M[0]),b.push(M))}b.length&&f.push(b)}return f}function Wx(s,e){const i=Fv(ry(s),ry([e]),0);return i==null?[]:bd(i)}function Fw(s,e){let c=ry(s,65536);const f=[];for(;e.valid();e.next()){const[g,y]=e.get(),b=g.x*65536,E=g.y*65536,M=y.x*65536,R=y.y*65536,z=M-b,B=R-E,j=Math.hypot(z,B);if(j===0)continue;const V=Math.trunc(B/j*3),Y=-Math.trunc(z/j*3);f.push([[[b,E],[M,R],[M+V,R+Y],[b+V,E+Y],[b,E]]])}return f.length>0&&(c=Fv(c,f,2)),bd(c,1/65536,128)}function ry(s,e=1){return[s.map(i=>i.map(c=>[c.x*e,c.y*e]))]}function bd(s,e=1,i){return s.map(c=>c.map((f,g)=>{const y=f.map(b=>{let E=b[0],M=b[1];return i&&(E=Math.round(E/i)*i,M=Math.round(M/i)*i),new yt(E*e,M*e)._round()});return g>0&&y.reverse(),y}))}class _h{constructor(e,i){this.layoutVertexArray=new _u,this.indexArray=new pa,this.lineIndexArray=new rl,this.triangleSegments=new ui,this.lineSegments=new ui,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut}),this.uploaded=!1,i&&(this.elevatedLayoutVertexArray=new ja)}update(e,i,c,f,g,y,b,E){this.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,E)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,xS.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.lineIndexBuffer=e.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=e.createVertexBuffer(this.elevatedLayoutVertexArray,Mw.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(e,i,c,f,g,y,b){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,c,f,g,y,void 0,b)}}class yh{constructor(e){this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=e.lut,this.bufferData=new _h(e,!1),this.elevationBufferData=new _h(e,!0),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=e.sourceLayerIndex,this.worldview=e.worldview,this.hasAppearances=null}updateFootprints(e,i){}updateAppearances(e,i,c,f){}populate(e,i,c,f){this.hasPattern=jx("fill",this.layers,this.pixelRatio,i);const g=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:b,id:E,index:M,sourceLayerIndex:R}of e){const z=this.layers[0]._featureFilter.needGeometry,B=Vr(b,z);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),B,c))continue;const j=g?g.evaluate(B,{},c,i.availableImages):void 0,V={id:E,properties:b.properties,type:b.type,sourceLayerIndex:R,index:M,geometry:z?B.geometry:Ir(b,c,f),patterns:{},sortKey:j};y.push(V)}g&&y.sort((b,E)=>b.sortKey-E.sortKey);for(const b of y){const{geometry:E,index:M,sourceLayerIndex:R}=b;if(this.hasPattern){const z=Ux("fill",this.layers,b,this.zoom,this.pixelRatio,i);this.patternFeatures.push(z)}else this.addFeature(b,E,M,c,{},i.availableImages,i.brightness,i.elevationFeatures);i.featureIndex.insert(e[M].feature,E,M,R,this.index)}}update(e,i,c,f,g,y,b){this.bufferData.update(e,i,c,f,g,y,b,this.worldview),this.elevationBufferData.update(e,i,c,f,g,y,b,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(e,i,c,f,g,y,b,this.worldview)}addFeatures(e,i,c,f,g,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,i,c,f,y,e.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(e){this.bufferData.upload(e),this.elevationBufferData.upload(e),this.elevatedStructures&&this.elevatedStructures.upload(e)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(e,i,c,f,g,y=[],b,E){const M=J_(i,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(e,M,f,c,E):this.addGeometry(M,this.bufferData),this.bufferData.populatePaintArrays(e,c,g,y,f,b,this.worldview),this.elevationBufferData.populatePaintArrays(e,c,g,y,f,b,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}setEvaluatedPortalGraph(e,i,c,f,g){this.elevatedStructures&&(this.elevatedStructures.construct(e),this.elevatedStructures.populatePaintArrays(i,c,f,g,this.worldview))}addElevatedRoadFeature(e,i,c,f,g){const y=new Array,b=so.getElevationFeature(e,g);if(!b)return void this.addGeometry(i,this.bufferData);{const M=this.clipPolygonsToTile(i,1);M.length>0&&y.push({polygons:M,elevationFeature:b,elevationTileID:c})}const E={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(e,{},c),featureIndex:f};for(const M of y)if(M.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new jo(M.elevationTileID,this.layers,this.zoom,this.lut));const z=M.elevationFeature.isTunnel();let B=0;e.properties.hasOwnProperty($r)&&(B=+e.properties[$r]),this.elevatedStructures.addPortalCandidates(M.elevationFeature.id,M.polygons,z,M.elevationFeature,B)}M.elevationFeature.constantHeight==null&&(M.polygons=this.prepareElevatedPolygons(M.polygons,M.elevationFeature,M.elevationTileID));const R=new Fs(c,M.elevationTileID);this.addElevatedGeometry(M.polygons,R,M.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,f,E)}}addElevatedGeometry(e,i,c,f,g,y){const b={elevation:c,elevationSampler:i,bias:f,index:g,featureInfo:y},[E,M]=this.addGeometry(e,this.elevationBufferData,b);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:E,max:M}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,E),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,M))}addGeometry(e,i,c){let f=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,y=null;c&&(y=c.elevationSampler.constantElevation(c.elevation,c.bias),y!=null&&(f=y,g=y));const b=(E,M,R)=>{if(c!=null)if(M.push(E),y!=null)i.elevatedLayoutVertexArray.emplaceBack(y),R.push(y);else{const z=c.elevationSampler.pointElevation(E,c.elevation,c.bias);i.elevatedLayoutVertexArray.emplaceBack(z),R.push(z),f=Math.min(f,z),g=Math.max(g,z)}};for(const E of e){let M=0;for(const ce of E)M+=ce.length;const R=i.triangleSegments.prepareSegment(M,i.layoutVertexArray,i.indexArray),z=R.vertexLength,B=[],j=[],V=[],Y=[],re=[],J=i.layoutVertexArray.length;for(const ce of E){if(ce.length===0)continue;ce!==E[0]&&j.push(B.length/2);const pe=i.lineSegments.prepareSegment(ce.length,i.layoutVertexArray,i.lineIndexArray),Se=pe.vertexLength;c&&re.push(i.layoutVertexArray.length-J),b(ce[0],V,Y),i.layoutVertexArray.emplaceBack(ce[0].x,ce[0].y),i.lineIndexArray.emplaceBack(Se+ce.length-1,Se),B.push(ce[0].x),B.push(ce[0].y);for(let we=1;we<ce.length;we++)b(ce[we],V,Y),i.layoutVertexArray.emplaceBack(ce[we].x,ce[we].y),i.lineIndexArray.emplaceBack(Se+we-1,Se+we),B.push(ce[we].x),B.push(ce[we].y);pe.vertexLength+=ce.length,pe.primitiveLength+=ce.length}const oe=tc(B,j);for(let ce=0;ce<oe.length;ce+=3)i.indexArray.emplaceBack(z+oe[ce],z+oe[ce+1],z+oe[ce+2]);if(oe.length>0&&c&&this.elevationMode==="hd-road-base"){const ce=c.elevation.isTunnel(),pe=c.elevation.safeArea,Se=this.elevatedStructures.addVertices(V,Y);this.elevatedStructures.addTriangles(oe,Se,ce);const we=re.length;if(we>0){for(let Ie=0;Ie<we-1;Ie++)this.elevatedStructures.addRenderableRing(c.index,re[Ie]+Se,re[Ie+1]-re[Ie],ce,pe,c.featureInfo);this.elevatedStructures.addRenderableRing(c.index,re[we-1]+Se,V.length-re[we-1],ce,pe,c.featureInfo)}}R.vertexLength+=M,R.primitiveLength+=oe.length/3}return[f,g]}prepareElevatedPolygons(e,i,c){const f=1/zt(c),g=[];for(const y of e){const b=Fw(y,new ms(i,f));g.push(...b)}return g}clipPolygonsToTile(e,i){const c=-i,f=-i,g=Gt+i,y=Gt+i;let b=0;const E=[],M=[];for(;b<e.length;b++){const B=e[b],j=kl(B);(j.min.x>=c&&j.max.x<=g&&j.min.y>=f&&j.max.y<=y?E:M).push(B)}if(E.length===e.length)return e;const R=[new yt(c,f),new yt(g,f),new yt(g,y),new yt(c,y),new yt(c,f)],z=E;for(const B of M)z.push(...Wx(B,R));return z}}let vg,xg,wd,Nw;jt(yh,"FillBucket",{omit:["layers","patternFeatures"]}),jt(_h,"FillBufferData"),jt(jo,"ElevatedStructures");class ny{constructor(e,i,c,f){if(this.triangleCount=i.length/3,this.min=new yt(0,0),this.max=new yt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0)return;const[g,y]=[e[0].clone(),e[0].clone()];for(let z=1;z<e.length;++z){const B=e[z];g.x=Math.min(g.x,B.x),g.y=Math.min(g.y,B.y),y.x=Math.max(y.x,B.x),y.y=Math.max(y.y,B.y)}if(f){const z=Math.ceil(Math.max(y.x-g.x,y.y-g.y)/f);c=Math.max(c,z)}if(c===0)return;this.min=g,this.max=y;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const E=Math.max(b.x,b.y)/c;this.cellsX=Math.max(1,Math.ceil(b.x/E)),this.cellsY=Math.max(1,Math.ceil(b.y/E)),this.xScale=1/E,this.yScale=1/E;const M=[];for(let z=0;z<this.triangleCount;z++){const B=e[i[3*z+0]].sub(this.min),j=e[i[3*z+1]].sub(this.min),V=e[i[3*z+2]].sub(this.min),Y=Al(Math.floor(Math.min(B.x,j.x,V.x)),this.xScale,this.cellsX),re=Al(Math.floor(Math.max(B.x,j.x,V.x)),this.xScale,this.cellsX),J=Al(Math.floor(Math.min(B.y,j.y,V.y)),this.yScale,this.cellsY),oe=Al(Math.floor(Math.max(B.y,j.y,V.y)),this.yScale,this.cellsY),ce=new yt(0,0),pe=new yt(0,0),Se=new yt(0,0),we=new yt(0,0);for(let Ie=J;Ie<=oe;++Ie){ce.y=pe.y=Ie*E,Se.y=we.y=(Ie+1)*E;for(let Pe=Y;Pe<=re;++Pe)ce.x=Se.x=Pe*E,pe.x=we.x=(Pe+1)*E,(oi(B,j,V,ce,pe,we)||oi(B,j,V,ce,we,Se))&&M.push({cellIdx:Ie*this.cellsX+Pe,triIdx:z})}}if(M.length===0)return;M.sort((z,B)=>z.cellIdx-B.cellIdx||z.triIdx-B.triIdx);let R=0;for(;R<M.length;){const z=M[R].cellIdx,B={start:this.payload.length,len:0};for(;R<M.length&&M[R].cellIdx===z;)++B.len,this.payload.push(M[R++].triIdx);this.cells[z]=B}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(e,i){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>e.x||e.y>this.max.y||this.min.y>e.y)return;const c=Al(e.x-this.min.x,this.xScale,this.cellsX),f=Al(e.y-this.min.y,this.yScale,this.cellsY),g=this.cells[f*this.cellsX+c];if(g){this._lazyInitLookup();for(let y=0;y<g.len;y++){const b=this.payload[g.start+y],E=Math.floor(b/8),M=1<<b%8;if(!(this.lookup[E]&M)&&(this.lookup[E]|=M,i.push(b),i.length===this.triangleCount))return}}}query(e,i,c){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>i.x||e.y>this.max.y||this.min.y>i.y)return;this._lazyInitLookup();const f=Al(e.x-this.min.x,this.xScale,this.cellsX),g=Al(i.x-this.min.x,this.xScale,this.cellsX),y=Al(e.y-this.min.y,this.yScale,this.cellsY),b=Al(i.y-this.min.y,this.yScale,this.cellsY);for(let E=y;E<=b;E++)for(let M=f;M<=g;M++){const R=this.cells[E*this.cellsX+M];if(R)for(let z=0;z<R.len;z++){const B=this.payload[R.start+z],j=Math.floor(B/8),V=1<<B%8;if(!(this.lookup[j]&V)&&(this.lookup[j]|=V,c.push(B),c.length===this.triangleCount))return}}}}function Al(s,e,i){return Math.max(0,Math.min(i-1,Math.floor(s*e)))}jt(ny,"TriangleGridIndex");class jw{constructor(e){this.zoom=e.zoom,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.footprints=[],this.worldview=e.worldview,this.hasAppearances=null}updateFootprints(e,i){for(const c of this.footprints)i.push({footprint:c,id:e})}updateAppearances(e,i,c,f){}populate(e,i,c,f){const g=[];for(const{feature:y,id:b,index:E,sourceLayerIndex:M}of e){const R=this.layers[0]._featureFilter.needGeometry,z=Vr(y,R);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),z,c))continue;const B={id:b,properties:y.properties,type:y.type,sourceLayerIndex:M,index:E,geometry:R?z.geometry:Ir(y,c,f),patterns:{}};g.push(B)}for(const y of g){const{geometry:b,index:E,sourceLayerIndex:M}=y;this.addFeature(y,b,E,c,{},i.availableImages,i.brightness),i.featureIndex.insert(e[E].feature,b,E,M,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(e){}update(e,i,c,f,g,y,b){}destroy(){}addFeature(e,i,c,f,g,y=[],b){for(const E of J_(i,2)){const M=[],R=[],z=[],B=new yt(1/0,1/0),j=new yt(-1/0,-1/0);for(const re of E)if(re.length!==0){re!==E[0]&&z.push(R.length/2);for(let J=0;J<re.length;J++)R.push(re[J].x),R.push(re[J].y),M.push(re[J]),B.x=Math.min(B.x,re[J].x),B.y=Math.min(B.y,re[J].y),j.x=Math.max(j.x,re[J].x),j.y=Math.max(j.y,re[J].y)}const V=tc(R,z),Y=new ny(M,V,8,256);this.footprints.push({vertices:M,indices:V,grid:Y,min:B,max:j})}}}jt(jw,"ClipBucket",{omit:["layers"]});const Uw=en([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Nv=en([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Vw=en([{name:"a_flood_light_ground_radius",components:1,type:"Float32"}]),MS=en([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jv=en([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Uv=en([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Gw=en([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:bg}=Uw,wg=Number.MAX_SAFE_INTEGER,Yx=wg-1;function iy(s,e,i,c){return s.order<e||s.order===wg||!(s.clipMask&i)||(function(f,g){return g.length!==0&&g.find(y=>y===f)===void 0})(c,s.clipScope)}function ay(s,e){return s.x-e.x||s.y-e.y}function $w(s,e){return ay(s.min,e.min)===0&&ay(s.max,e.max)===0}function Ag(s,e){return!(s.min.x>e.max.x||s.max.x<e.min.x||s.min.y>e.max.y||s.max.y<e.min.y)}function d(s,e){if(s.length!==e.length)return!1;for(let i=0;i<s.length;i++)if(s[i].sourceId!==e[i].sourceId||!$w(s[i],e[i])||s[i].order!==e[i].order||s[i].clipMask!==e[i].clipMask||!Or(s[i].clipScope,e[i].clipScope))return!1;return!0}function _(s,e,i){const c=1/Gt,f=1/(1<<i.canonical.z),g=(e.x*c+i.canonical.x)*f+i.wrap,y=(e.y*c+i.canonical.y)*f;return{min:new yt((s.x*c+i.canonical.x)*f+i.wrap,(s.y*c+i.canonical.y)*f),max:new yt(g,y)}}function T(s,e,i){const c=1<<i.canonical.z,f=((e.x-i.wrap)*c-i.canonical.x)*Gt,g=(e.y*c-i.canonical.y)*Gt;return{min:new yt(((s.x-i.wrap)*c-i.canonical.x)*Gt,(s.y*c-i.canonical.y)*Gt),max:new yt(f,g)}}function P(s,e,i,c,f,g,y){const b=s.indices,E=s.vertices,M=[];for(let R=c;R<c+f;R+=3){const z=e[i[R+0]+g],B=e[i[R+1]+g],j=e[i[R+2]+g],V=Math.min(z.x,B.x,j.x),Y=Math.max(z.x,B.x,j.x),re=Math.min(z.y,B.y,j.y),J=Math.max(z.y,B.y,j.y);M.length=0,s.grid.query(new yt(V,re),new yt(Y,J),M);for(let oe=0;oe<M.length;oe++){const ce=M[oe];if(oi(E[b[3*ce+0]],E[b[3*ce+1]],E[b[3*ce+2]],z,B,j,y))return!0}}return!1}function U(s,e,i,c){if(!s||!i)return!1;let f=s.vertices;if(!e.canonical.equals(c.canonical)||e.wrap!==c.wrap){if(i.vertices.length<s.vertices.length)return U(i,c,s,e);const g=e.canonical,y=c.canonical,b=Math.pow(2,y.z-g.z);f=s.vertices.map(E=>new yt((E.x+g.x*Gt)*b-y.x*Gt,(E.y+g.y*Gt)*b-y.y*Gt))}return P(i,f,s.indices,0,s.indices.length,0,0)}function X(s,e,i,c){const f=Math.pow(2,c.z-i.z);return new yt((s+i.x*Gt)*f-c.x*Gt,(e+i.y*Gt)*f-c.y*Gt)}function _e(s,e){const i=[];e.grid.queryPoint(s,i);const c=e.indices,f=e.vertices;for(let g=0;g<i.length;g++){const y=i[g];if(_s([f[c[3*y+0]],f[c[3*y+1]],f[c[3*y+2]]],s))return!0}return!1}const Be=[new yt(0,0),new yt(Gt,0),new yt(Gt,Gt),new yt(0,Gt)];function ht(s,e){const i=[];let c=[];if(!e||s.length<2)return[s];if(s.length===2)return ec(s[0],s[1],Be)?[s]:[];for(let f=0;f<s.length+2;f++){const g=s[f%s.length],y=s[(f+1)%s.length],b=ec(f===0?s[s.length-1]:s[(f-1)%s.length],g,Be),E=ec(g,y,Be),M=b||E;M&&c.push(g),M&&E||c.length>0&&(c.length>1&&i.push(c),c=[])}return c.length>1&&i.push(c),i}const Vt=tn.types,ir=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],pr=["fill-extrusion-flood-light-ground-radius"],$t=Math.pow(2,13),er=Math.pow(2,15)-1,Hr=new yt(0,1),cn=2147483648;function Vi(s,e,i,c,f,g,y,b){s.emplaceBack((e<<1)+y,(i<<1)+g,(Math.floor(c*$t)<<1)+f,Math.round(b))}function Pt(s,e,i){s.emplaceBack(e.x*Gt,e.y*Gt,i?1:0)}function _t(s,e,i,c,f,g){s.emplaceBack(e.x,e.y,(i.x<<1)+c,(i.y<<1)+f,g)}function Nt(s,e,i){s.emplaceBack(e.x,e.y,e.z,i[0]*16384,i[1]*16384,i[2]*16384)}class ur{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class dn{constructor(){this.centroidXY=new yt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new yt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new yt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new yt(this.max.x-this.min.x,this.max.y-this.min.y)}}class Pi{constructor(){this.acc=new yt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,i){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=i.x,e.min.y=e.max.y=i.y)}appendEdge(e,i,c){this.accCount++,this.acc._add(i);let f=!!this.borders;i.x<e.min.x?(e.min.x=i.x,f=!0):i.x>e.max.x&&(e.max.x=i.x,f=!0),i.y<e.min.y?(e.min.y=i.y,f=!0):i.y>e.max.y&&(e.max.y=i.y,f=!0),((i.x===0||i.x===Gt)&&i.x===c.x)!=((i.y===0||i.y===Gt)&&i.y===c.y)&&this.processBorderOverlap(i,c),f&&this.checkBorderIntersection(i,c)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,Dr(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Gt!=e.x>Gt&&this.addBorderIntersection(1,Dr(i.y,e.y,(Gt-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Dr(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Gt!=e.y>Gt&&this.addBorderIntersection(3,Dr(i.x,e.x,(Gt-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];i<c[0]&&(c[0]=i),i>c[1]&&(c[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const c=e.x===0?0:1;this.addBorderIntersection(c,i.y),this.addBorderIntersection(c,e.y)}else{const c=e.y===0?2:3;this.addBorderIntersection(c,i.x),this.addBorderIntersection(c,e.x)}}centroid(){return this.accCount===0?new yt(0,0):new yt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0):0}}function rn(s,e){const i=s.add(e)._unit(),c=Ee(s.x*i.x+s.y*i.y,-1,1);var f,g,y;return y=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(y)))/4*er*((f=s).x*(g=e).y-f.y*g.x<0?-1:1)}const Jn=[s=>s.x<0,s=>s.x>Gt,s=>s.y<0,s=>s.y>Gt];function pi(s,e,i,c){const f=[4];if(c===0)return f;i._mult(c);const g=s.sub(i),y=e.sub(i),b=[s,e,g,y];for(let E=0;E<4;E++)for(const M of b)if(Jn[E](M)){f.push(E);break}return f}class Oi{constructor(e){this.groundRadiusArray=null,this.groundRadiusBuffer=null,this.vertexArray=new Ea,this.indexArray=new pa,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut},i=>pr.includes(i)),this._segments=new ui,this.hiddenByLandmarkVertexArray=new Np,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ui}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(e,i,c,f=!1){const g=e.length;if(g>2){let y=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[y].length);let E;y!==this._segments.get().length-1&&(y++,this._segmentToGroundQuads[y]=[],this._segmentToRegionTriCounts[y]=[0,0,0,0,0]);{const M=e[0],R=e[1];E=rn(M.sub(e[g-1])._perp()._unit(),R.sub(M)._perp()._unit())}for(let M=0;M<g;M++){const R=M===g-1?0:M+1,z=e[M],B=e[R],j=e[R===g-1?0:R+1],V=B.sub(z)._perp()._unit(),Y=rn(V,j.sub(B)._perp()._unit()),re=E,J=Y;if(OS(z,B,i)||f&&LR(z,i)&&LR(B,i)){E=Y;continue}const oe=b.vertexLength;_t(this.vertexArray,z,B,1,1,re),_t(this.vertexArray,z,B,1,0,re),_t(this.vertexArray,z,B,0,1,J),_t(this.vertexArray,z,B,0,0,J),b.vertexLength+=4;const ce=pi(z,B,V,c);for(const pe of ce)this._segmentToGroundQuads[y].push({id:oe,region:pe}),this._segmentToRegionTriCounts[y][pe]+=2,b.primitiveLength+=2;E=Y}}}prepareBorderSegments(){if(!this.hasData())return;const e=this._segments.get(),i=e.length;for(let c=0;c<i;c++)this._segmentToGroundQuads[c].sort((f,g)=>f.region-g.region);for(let c=0;c<i;c++){const f=this._segmentToGroundQuads[c],g=e[c],y=this._segmentToRegionTriCounts[c];y.reduce((E,M)=>E+M,0);let b=0;for(let E=0;E<=4;E++){const M=y[E];if(M!==0){let R=this.regionSegments[E];R||(R=this.regionSegments[E]=new ui);const z={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+b,vertexLength:g.vertexLength,primitiveLength:M};R.get().push(z)}b+=M}for(let E=0;E<f.length;E++){const M=f[E].id;this.indexArray.emplaceBack(M,M+1,M+3),this.indexArray.emplaceBack(M,M+3,M+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(e,i,c,f,g,y,b){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,i,c,f,g,y,void 0,b)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,Nv.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.groundRadiusArray!=null&&(this.groundRadiusBuffer=e.createVertexBuffer(this.groundRadiusArray,Vw.members)))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,i,c,f,g,y,b,E){this.hasData()&&this.programConfigurations.updatePaintArrays(e,i,c,f,g,y,b,E)}updateHiddenByLandmark(e){this.updateHiddenByLandmarkRange(e.groundVertexArrayOffset,e.groundVertexCount,!!(e.flags&cn))}updateHiddenByLandmarkRange(e,i,c){if(!this.hasData())return;const f=i+e;if(i!==0){for(let g=e;g<f;++g)this.hiddenByLandmarkVertexArray.emplace(g,c?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(e){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,Uv.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this.groundRadiusBuffer&&this.groundRadiusBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let e=0;e<=4;e++){const i=this.regionSegments[e];i&&i.destroy()}}}}class Au{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.pixelRatio=e.pixelRatio,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new pa,this.footprintVertices=new _u,this.footprintSegments=[],this.layoutVertexArray=new Rc,this.centroidVertexArray=new vu,this.wallVertexArray=new L_,this.indexArray=new pa,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut},i=>ir.includes(i)),this.segments=new ui,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.groundEffect=new Oi(e),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=e.worldview,this.hasAppearances=null}updateFootprints(e,i){}updateAppearances(e,i,c,f){}populate(e,i,c,f){this.features=[],this.hasPattern=jx("fill-extrusion",this.layers,this.pixelRatio,i),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=zt(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:g,id:y,index:b,sourceLayerIndex:E}of e){const M=this.layers[0]._featureFilter.needGeometry,R=Vr(g,M);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),R,c))continue;const z={id:y,sourceLayerIndex:E,index:b,geometry:M?R.geometry:Ir(g,c,f),properties:g.properties,type:g.type,patterns:{}},B=this.layoutVertexArray.length,j=Vt[z.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:g.id,feature:Ux("fill-extrusion",this.layers,z,this.zoom,this.pixelRatio,i)});else if(this.wallMode)for(const V of z.geometry)for(const Y of ht(V,j))this.addFeature(g.id,z,[Y],b,c,{},i.availableImages,f,i.brightness);else this.addFeature(g.id,z,z.geometry,b,c,{},i.availableImages,f,i.brightness);i.featureIndex.insert(g,z.geometry,b,E,this.index,B)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(e,i,c,f,g,y){for(const{featureId:b,feature:E}of this.features){const M=Vt[E.type]==="Polygon",{geometry:R}=E;if(this.wallMode)for(const z of R)for(const B of ht(z,M))this.addFeature(b,E,[B],E.index,i,c,f,g,y);else this.addFeature(b,E,R,E.index,i,c,f,g,y)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(e,i,c,f,g,y,b){this.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,this.worldview),this.groundEffect.update(e,i,g,c,f,y,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,bg),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.wallVertexBuffer=e.createVertexBuffer(this.wallVertexArray,jv.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Gw.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,MS.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,c,f,g,y,b,E,M){const R=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,z=[new yt(0,0),new yt(Gt,Gt)],B=E.projection,j=B.name==="globe",V=this.wallMode||Vt[i.type]==="Polygon",Y=new Pi;Y.centroidDataIndex=this.centroidData.length;const re=new dn;re.buildingId=e,i.properties&&i.properties.hasOwnProperty("building_id")&&(re.buildingId=Number(i.properties.building_id));const J=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},g)<=0,oe=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},g);let ce;if(re.height=oe,re.vertexArrayOffset=this.layoutVertexArray.length,re.groundVertexArrayOffset=this.groundEffect.vertexArray.length,j&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ud),this.wallMode){if(j)return void br("Non zero fill-extrusion-line-width is not yet supported on globe.");if(c.length!==1)return;ce=(function(ke){const Ge=ke[0].x===ke[ke.length-1].x&&ke[0].y===ke[ke.length-1].y;(function(Ht){let Yt=0;const wr=Ht.length;for(let gr=0;gr<wr;gr++)Yt+=(Ht[(gr+1)%wr].x-Ht[gr].x)*(Ht[(gr+1)%wr].y+Ht[gr].y);return Yt>=0})(ke)||(ke=ke.reverse());const ct={geometry:[],joinNormals:[],indices:[]},dt=[],St=[],At=[];let Tt=ke.length;for(;Tt>=2&&ke[Tt-1].equals(ke[Tt-2]);)Tt--;if(Tt<(Ge?3:2))return ct;let lt,Ot,xt,It,Et,rr=0;for(;rr<Tt-1&&ke[rr].equals(ke[rr+1]);)rr++;Ge&&(lt=ke[Tt-2],Et=ke[rr].sub(lt)._unit()._perp());for(let Ht=rr;Ht<Tt;Ht++){if(xt=Ht===Tt-1?Ge?ke[rr+1]:void 0:ke[Ht+1],xt&&ke[Ht].equals(xt))continue;Et&&(It=Et),lt&&(Ot=lt),lt=ke[Ht],Et=xt?xt.sub(lt)._unit()._perp():It,It=It||Et;let Yt=It.add(Et);Yt.x===0&&Yt.y===0||Yt._unit();const wr=Yt.x*Et.x+Yt.y*Et.y,gr=wr!==0?1/wr:1/0,tr=It.x*Et.y-It.y*Et.x>0;let Fr="miter";const nn=2;Fr==="miter"&&gr>nn&&(Fr="bevel"),Fr==="bevel"&&(gr>100&&(Fr="flipbevel"),gr<nn&&(Fr="miter"));const On=(Yr,Hn,gn,ta)=>{const vn=new yt(Yr.x,Yr.y),Un=new yt(Yr.x,Yr.y);vn.x+=Hn.x*ta,vn.y+=Hn.y*ta,Un.x-=Hn.x*Math.max(gn,1),Un.y-=Hn.y*Math.max(gn,1),At.push(Hn),dt.push(vn),St.push(Un)};if(Fr==="miter")Yt._mult(gr),On(lt,Yt,0,0);else if(Fr==="flipbevel")Yt=Et.mult(-1),On(lt,Yt,0,0),On(lt,Yt.mult(-1),0,0);else{const Yr=-Math.sqrt(gr*gr-1),Hn=tr?Yr:0,gn=tr?0:Yr;Ot&&On(lt,It,Hn,gn),xt&&On(lt,Et,Hn,gn)}}ct.geometry=[...dt,...St.reverse(),dt[0]],ct.joinNormals=[...At,...At.reverse(),At[At.length-1]];const nr=ct.geometry.length-1;for(let Ht=0;Ht<nr/2;Ht++)if(Ht+1<nr/2){let Yt=Ht,wr=Ht+1,gr=nr-1-Ht,tr=nr-2-Ht;Yt=Yt===0?nr-1:Yt-1,wr=wr===0?nr-1:wr-1,gr=gr===0?nr-1:gr-1,tr=tr===0?nr-1:tr-1,ct.indices.push(gr),ct.indices.push(wr),ct.indices.push(Yt),ct.indices.push(gr),ct.indices.push(tr),ct.indices.push(wr)}return ct})(c[0]),c=[ce.geometry]}const pe=(ke,Ge)=>ke<(Ge.length-1)/2||ke===Ge.length-1,Se=this.wallMode?[c]:J_(c,500);for(let ke=Se.length-1;ke>=0;ke--){const Ge=Se[ke];(Ge.length===0||CG(Ge[0]))&&Se.splice(ke,1)}let we;if(j)we=NR(Se,z,g);else{we=[];for(const ke of Se)we.push({polygon:ke,bounds:z})}const Ie=V?this.edgeRadius:0,Pe=Ie>0&&this.zoom<17,Oe=(ke,Ge)=>{if(ke.length===0)return!1;const pt=ke[ke.length-1];return Ge.x===pt.x&&Ge.y===pt.y};for(const{polygon:ke,bounds:Ge}of we){let pt=0,ct=0;for(const Tt of ke)V&&!Tt[0].equals(Tt[Tt.length-1])&&Tt.push(Tt[0]),ct+=V?Tt.length-1:Tt.length;const dt=this.segments.prepareSegment((V?5:4)*ct,this.layoutVertexArray,this.indexArray);re.footprintSegIdx<0&&(re.footprintSegIdx=this.footprintSegments.length),re.polygonSegIdx<0&&(re.polygonSegIdx=this.polygonSegments.length);const St={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},At=new ur;if(At.vertexOffset=this.footprintVertices.length,At.indexOffset=3*this.footprintIndices.length,At.ringIndices=[],V){const Tt=[],lt=[];pt=dt.vertexLength;for(let xt=0;xt<ke.length;xt++){const It=ke[xt];It.length&&xt!==0&&lt.push(Tt.length/2);const Et=[];let rr,nr;rr=It[1].sub(It[0])._perp()._unit(),At.ringIndices.push(It.length-1);for(let Ht=1;Ht<It.length;Ht++){const Yt=It[Ht],wr=It[Ht===It.length-1?1:Ht+1],gr=Yt.clone();if(Ie){nr=wr.sub(Yt)._perp()._unit();const tr=rr.add(nr)._unit(),Fr=Ie*Math.min(4,1/(rr.x*tr.x+rr.y*tr.y));gr.x+=Fr*tr.x,gr.y+=Fr*tr.y,gr.x=Math.round(gr.x),gr.y=Math.round(gr.y),rr=nr}if(!J||Ie!==0&&!Pe||Oe(Et,gr)||Et.push(gr),Vi(this.layoutVertexArray,gr.x,gr.y,0,0,1,1,0),this.wallMode){const tr=pe(Ht,It);Pt(this.wallVertexArray,ce.joinNormals[Ht],!tr)}dt.vertexLength++,this.footprintVertices.emplaceBack(Yt.x,Yt.y),Tt.push(Yt.x,Yt.y),j&&Nt(this.layoutVertexExtArray,B.projectTilePoint(gr.x,gr.y,g),B.upVector(g,gr.x,gr.y))}J&&(Ie===0||Pe)&&(Et.length!==0&&Oe(Et,Et[0])&&Et.pop(),this.groundEffect.addData(Et,Ge,R))}const Ot=this.wallMode?ce.indices:tc(Tt,lt);for(let xt=0;xt<Ot.length;xt+=3)this.footprintIndices.emplaceBack(At.vertexOffset+Ot[xt+0],At.vertexOffset+Ot[xt+1],At.vertexOffset+Ot[xt+2]),this.indexArray.emplaceBack(pt+Ot[xt],pt+Ot[xt+2],pt+Ot[xt+1]),dt.primitiveLength++;At.indexCount+=Ot.length,At.vertexCount+=this.footprintVertices.length-At.vertexOffset}for(let Tt=0;Tt<ke.length;Tt++){const lt=ke[Tt];Y.startRing(re,lt[0]);let Ot=lt.length>4&&BR(lt[lt.length-2],lt[0],lt[1]),xt=Ie?OG(lt[lt.length-2],lt[0],lt[1],Ie):0;const It=[];let Et,rr,nr;rr=lt[1].sub(lt[0])._perp()._unit();let Ht=!0;for(let Yt=1,wr=0;Yt<lt.length;Yt++){let gr=lt[Yt-1],tr=lt[Yt];const Fr=lt[Yt===lt.length-1?1:Yt+1];if(Y.appendEdge(re,tr,gr),OS(tr,gr,Ge)){Ie&&(rr=Fr.sub(tr)._perp()._unit(),Ht=!Ht);continue}const nn=tr.sub(gr)._perp(),On=nn.x/(Math.abs(nn.x)+Math.abs(nn.y)),Yr=nn.y>0?1:0,Hn=gr.dist(tr);if(wr+Hn>32768&&(wr=0),Ie){nr=Fr.sub(tr)._perp()._unit();let Un=zR(gr,tr,Fr,qw(rr,nr),Ie);isNaN(Un)&&(Un=0);const bi=tr.sub(gr)._unit();gr=gr.add(bi.mult(xt))._round(),tr=tr.add(bi.mult(-Un))._round(),xt=Un,rr=nr,J&&this.zoom>=17&&(Oe(It,gr)||It.push(gr),Oe(It,tr)||It.push(tr))}const gn=dt.vertexLength,ta=lt.length>4&&BR(gr,tr,Fr);let vn=kR(wr,Ot,Ht);if(Vi(this.layoutVertexArray,gr.x,gr.y,On,Yr,0,0,vn),Vi(this.layoutVertexArray,gr.x,gr.y,On,Yr,0,1,vn),this.wallMode){const Un=pe(Yt-1,lt),bi=ce.joinNormals[Yt-1];Pt(this.wallVertexArray,bi,Un),Pt(this.wallVertexArray,bi,Un)}if(wr+=Hn,vn=kR(wr,ta,!Ht),Ot=ta,Vi(this.layoutVertexArray,tr.x,tr.y,On,Yr,0,0,vn),Vi(this.layoutVertexArray,tr.x,tr.y,On,Yr,0,1,vn),this.wallMode){const Un=pe(Yt,lt),bi=ce.joinNormals[Yt];Pt(this.wallVertexArray,bi,Un),Pt(this.wallVertexArray,bi,Un)}if(dt.vertexLength+=4,this.indexArray.emplaceBack(gn+0,gn+1,gn+2),this.indexArray.emplaceBack(gn+1,gn+3,gn+2),dt.primitiveLength+=2,Ie){const Un=pt+(Yt===1?lt.length-2:Yt-2),bi=Yt===1?pt:Un+1;if(this.indexArray.emplaceBack(gn+1,Un,gn+3),this.indexArray.emplaceBack(Un,bi,gn+3),dt.primitiveLength+=2,Et===void 0&&(Et=gn),!OS(Fr,lt[Yt],Ge)){const Di=Yt===lt.length-1?Et:dt.vertexLength;this.indexArray.emplaceBack(gn+2,gn+3,Di),this.indexArray.emplaceBack(gn+3,Di+1,Di),this.indexArray.emplaceBack(gn+3,bi,Di+1),dt.primitiveLength+=3}Ht=!Ht}if(j){const Un=this.layoutVertexExtArray,bi=B.projectTilePoint(gr.x,gr.y,g),Di=B.projectTilePoint(tr.x,tr.y,g),Ri=B.upVector(g,gr.x,gr.y),ra=B.upVector(g,tr.x,tr.y);Nt(Un,bi,Ri),Nt(Un,bi,Ri),Nt(Un,Di,ra),Nt(Un,Di,ra)}}V&&(pt+=lt.length-1),J&&Ie&&this.zoom>=17&&(It.length!==0&&Oe(It,It[0])&&It.pop(),this.groundEffect.addData(It,Ge,R,Ie>0))}this.footprintSegments.push(At),St.triangleCount=this.indexArray.length-St.triangleArrayOffset,this.polygonSegments.push(St),++re.footprintSegLen,++re.polygonSegLen}if(re.vertexCount=this.layoutVertexArray.length-re.vertexArrayOffset,re.groundVertexCount=this.groundEffect.vertexArray.length-re.groundVertexArrayOffset,re.vertexCount!==0){if(re.centroidXY=Y.borders?Hr:this.encodeCentroid(Y,re),this.centroidData.push(re),Y.borders){this.featuresOnBorder.push(Y);const ke=this.featuresOnBorder.length-1;for(let Ge=0;Ge<Y.borders.length;Ge++)Y.borders[Ge][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ge].push(ke)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,f,y,b,g,M,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(i,f,y,b,g,M,this.worldview),this.maxHeight=Math.max(this.maxHeight,oe)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((i,c)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[c].borders[e][0])}splitToSubtiles(){const e=[];for(let b=0;b<this.centroidData.length;b++){const E=this.centroidData[b],M=+(E.min.y+E.max.y>Gt),R=2*M+(+(E.min.x+E.max.x>Gt)^M);for(let z=0;z<E.polygonSegLen;z++){const B=E.polygonSegIdx+z;e.push({centroidIdx:b,subtile:R,polygonSegmentIdx:B,triangleSegmentIdx:this.polygonSegments[B].triangleSegIdx})}}const i=new pa;e.sort((b,E)=>b.triangleSegmentIdx===E.triangleSegmentIdx?b.subtile-E.subtile:b.triangleSegmentIdx-E.triangleSegmentIdx);let c=0,f=0,g=0;for(const b of e){if(b.triangleSegmentIdx!==c)break;g++}const y=e.length;for(;f!==e.length;){c=e[f].triangleSegmentIdx;let b=0,E=f,M=f;for(let R=E;R<g&&e[R].subtile===b;R++)M++;for(;E!==g;){const R=e[E];b=R.subtile;const z=this.centroidData[R.centroidIdx].min.clone(),B=this.centroidData[R.centroidIdx].max.clone(),j={vertexOffset:this.segments.segments[c].vertexOffset,primitiveOffset:i.length,vertexLength:this.segments.segments[c].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let V=E;V<M;V++){const Y=e[V],re=this.polygonSegments[Y.polygonSegmentIdx],J=this.centroidData[Y.centroidIdx].min,oe=this.centroidData[Y.centroidIdx].max,ce=this.indexArray.uint16;for(let pe=re.triangleArrayOffset;pe<re.triangleArrayOffset+re.triangleCount;pe++)i.emplaceBack(ce[3*pe],ce[3*pe+1],ce[3*pe+2]);j.primitiveLength+=re.triangleCount,z.x=Math.min(z.x,J.x),z.y=Math.min(z.y,J.y),B.x=Math.max(B.x,oe.x),B.y=Math.max(B.y,oe.y)}j.primitiveLength>0&&this.triangleSubSegments.push({segment:j,min:z,max:B}),E=M;for(let V=E;V<g&&e[V].subtile===e[E].subtile;V++)M++}f=g;for(let R=f;R<y&&e[R].triangleSegmentIdx===e[f].triangleSegmentIdx;R++)g++}i._trim(),this.indexArray=i}getVisibleSegments(e,i,c){const f=new ui;if(this.wallMode){for(const Y of this.triangleSubSegments)f.segments.push(Y.segment);return f}let g=0,y=0;const b=1<<e.canonical.z;if(i){const Y=i.getMinMaxForTile(e);Y&&(g=Y.min,y=Y.max)}y+=this.maxHeight;const E=e.toUnwrapped();let M;const R=[E.canonical.x/b+E.wrap,E.canonical.y/b],z=[(E.canonical.x+1)/b+E.wrap,(E.canonical.y+1)/b],B=(Y,re,J)=>[Y[0]*(1-J[0])+re[0]*J[0],Y[1]*(1-J[1])+re[1]*J[1]],j=[],V=[];for(const Y of this.triangleSubSegments){j[0]=Y.min.x/Gt,j[1]=Y.min.y/Gt,V[0]=Y.max.x/Gt,V[1]=Y.max.y/Gt;const re=B(R,z,j),J=B(R,z,V);if(new An([re[0],re[1],g],[J[0],J[1],y]).intersectsPrecise(c)===0){M&&(f.segments.push(M),M=void 0);continue}const oe=Y.segment;M&&M.vertexOffset!==oe.vertexOffset&&(f.segments.push(M),M=void 0),M?(M.vertexLength+=oe.vertexLength,M.primitiveLength+=oe.primitiveLength):M={vertexOffset:oe.vertexOffset,primitiveLength:oe.primitiveLength,vertexLength:oe.vertexLength,primitiveOffset:oe.primitiveOffset,sortKey:void 0,vaos:{}}}return M&&f.segments.push(M),f}encodeCentroid(e,i){const c=e.centroid(),f=i.span(),g=Math.min(7,Math.round(f.x*this.tileToMeter/10)),y=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new yt(Ee(c.x,1,8191)<<3|g,Ee(c.y,1,8191)<<3|y)}encodeBorderCentroid(e){if(!e.borders)return new yt(0,0);const i=e.borders,c=Number.MAX_VALUE;if(i[0][0]!==c||i[1][0]!==c){const f=i[0][0]!==c?0:1;return new yt(6|(i[0][0]!==c?0:65528),(i[f][0]+i[f][1])/2<<3|6)}{const f=i[2][0]!==c?2:3;return new yt((i[f][0]+i[f][1])/2<<3|6,6|(i[2][0]!==c?0:65528))}}showCentroid(e){const i=this.centroidData[e.centroidDataIndex];i.flags&=2147483647,i.centroidXY.x=0,i.centroidXY.y=0,this.writeCentroidToBuffer(i)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const i=e.vertexArrayOffset,c=e.vertexCount+e.vertexArrayOffset,f=e.flags&cn?Hr:e.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(i);if(this.centroidVertexArray.geta_centroid_pos1(i)!==f.y||g!==f.x){for(let y=i;y<c;++y)this.centroidVertexArray.emplace(y,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,i,c){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const f=i.getReplacementRegionsForTile(e.toUnwrapped());if(d(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const g=[];for(const y of this.activeReplacements){if(y.order<c)continue;const b=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-e.canonical.z));if(y.footprint.buildingIds)for(const E of this.centroidData)E.flags&cn||y.min.x>E.max.x||E.min.x>y.max.x||y.min.y>E.max.y||E.min.y>y.max.y||y.footprint.buildingIds.has(E.buildingId)&&(E.flags|=cn);else for(const E of this.centroidData)if(!(E.flags&cn||y.min.x>E.max.x||E.min.x>y.max.x||y.min.y>E.max.y||E.min.y>y.max.y))for(let M=0;M<E.footprintSegLen;M++){const R=this.footprintSegments[E.footprintSegIdx+M];if(g.length=0,IG(this.footprintVertices,R.vertexOffset,R.vertexCount,y.footprintTileId.canonical,e.canonical,g),P(y.footprint,g,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-b)){E.flags|=cn;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(e,i,c){let f=!1;for(let g=0;g<c.footprintSegLen;g++){const y=this.footprintSegments[c.footprintSegIdx+g];let b=0;for(const E of y.ringIndices){for(let M=b,R=E+b-1;M<E+b;R=M++){const z=this.footprintVertices.int16[2*(M+y.vertexOffset)+0],B=this.footprintVertices.int16[2*(M+y.vertexOffset)+1],j=this.footprintVertices.int16[2*(R+y.vertexOffset)+1];B>i!=j>i&&e<(this.footprintVertices.int16[2*(R+y.vertexOffset)+0]-z)*(i-B)/(j-B)+z&&(f=!f)}b=E}}return f}getHeightAtTileCoord(e,i){let c=Number.NEGATIVE_INFINITY,f=!0;const g=4*(e+Gt)*Gt+(i+Gt);if(this.partLookup.hasOwnProperty(g)){const y=this.partLookup[g];return y?{height:y.height,hidden:!!(y.flags&cn)}:void 0}for(const y of this.centroidData)e>y.max.x||y.min.x>e||i>y.max.y||y.min.y>i||y.height<=c||this.footprintContainsPoint(e,i,y)&&(c=y.height,this.partLookup[g]=y,f=!!(y.flags&cn));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:f};this.partLookup[g]=void 0}}function qw(s,e){const i=s.add(e)._unit();return s.x*i.x+s.y*i.y}function OG(s,e,i,c){const f=e.sub(s)._perp()._unit(),g=i.sub(e)._perp()._unit();return zR(s,e,i,qw(f,g),c)}function zR(s,e,i,c,f){const g=Math.sqrt(1-c*c);return Math.min(s.dist(e)/3,e.dist(i)/3,f*g/c)}function OS(s,e,i){return s.x<i[0].x&&e.x<i[0].x||s.x>i[1].x&&e.x>i[1].x||s.y<i[0].y&&e.y<i[0].y||s.y>i[1].y&&e.y>i[1].y}function LR(s,e){return s.x<e[0].x||s.x>e[1].x||s.y<e[0].y||s.y>e[1].y}function CG(s){return s.every(e=>e.x<=0)||s.every(e=>e.x>=Gt)||s.every(e=>e.y<=0)||s.every(e=>e.y>=Gt)}function BR(s,e,i){if(s.x<0||s.x>=Gt||e.x<0||e.x>=Gt||i.x<0||i.x>=Gt)return!1;const c=i.sub(e),f=c.perp(),g=s.sub(e);return(c.x*g.x+c.y*g.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(g.x*g.x+g.y*g.y))>-.866&&f.x*g.x+f.y*g.y<0}function kR(s,e,i){const c=e?2|s:-3&s;return i?1|c:-2&c}function FR(){const s=Math.PI/32,e=Math.tan(s),i=De;return i*Math.sqrt(1+2*e*e)-i}function NR(s,e,i){const c=1<<i.z,f=ut(i.x/c),g=ut((i.x+1)/c),y=wt(i.y/c),b=wt((i.y+1)/c);return(function(E,M,R,z,B=0,j){const V=[];if(!E.length||!R||!z)return V;const Y=(we,Ie)=>{for(const Pe of we)V.push({polygon:Pe,bounds:Ie})},re=Math.ceil(Math.log2(R)),J=Math.ceil(Math.log2(z)),oe=re-J,ce=[];for(let we=0;we<Math.abs(oe);we++)ce.push(oe>0?0:1);for(let we=0;we<Math.min(re,J);we++)ce.push(0),ce.push(1);let pe=E;if(pe=Wp(pe,M[0].y-B,M[1].y+B,1),pe=Wp(pe,M[0].x-B,M[1].x+B,0),!pe.length)return V;const Se=[];for(ce.length?Se.push({polygons:pe,bounds:M,depth:0}):Y(pe,M);Se.length;){const we=Se.pop(),Ie=we.depth,Pe=ce[Ie],Oe=we.bounds[0],ke=we.bounds[1],Ge=Pe===0?Oe.x:Oe.y,pt=Pe===0?ke.x:ke.y,ct=j?j(Pe,Ge,pt):.5*(Ge+pt),dt=Wp(we.polygons,Ge-B,ct+B,Pe),St=Wp(we.polygons,ct-B,pt+B,Pe);if(dt.length){const At=[Oe,new yt(Pe===0?ct:ke.x,Pe===1?ct:ke.y)];ce.length>Ie+1?Se.push({polygons:dt,bounds:At,depth:Ie+1}):Y(dt,At)}if(St.length){const At=[new yt(Pe===0?ct:Oe.x,Pe===1?ct:Oe.y),ke];ce.length>Ie+1?Se.push({polygons:St,bounds:At,depth:Ie+1}):Y(St,At)}}return V})(s,e,Math.ceil((g-f)/11.25),Math.ceil((y-b)/11.25),1,(E,M,R)=>{if(E===0)return .5*(M+R);{const z=wt((i.y+M/Gt)/c);return(Qe(.5*(wt((i.y+R/Gt)/c)+z))*c-i.y)*Gt}})}function IG(s,e,i,c,f,g){const y=Math.pow(2,c.z-f.z);for(let b=0;b<i;b++){let E=s.int16[2*(b+e)+0],M=s.int16[2*(b+e)+1];E=(E+f.x*Gt)*y-c.x*Gt,M=(M+f.y*Gt)*y-c.y*Gt,g.push(new yt(E,M))}}let jR,UR;jt(Au,"FillExtrusionBucket",{omit:["layers","features"]}),jt(dn,"PartData"),jt(ur,"FootprintSegment"),jt(Pi,"BorderCentroidData"),jt(Oi,"GroundEffect");class oy extends yt{constructor(e,i,c){super(e,i),this.z=c}}class VR extends oy{constructor(e,i,c,f){super(e,i,c),this.w=f}}function GR(s,e,i,c){const f=i==="x"?"y":"x",g=(c-s[i])/(e[i]-s[i]);s[f]=Math.round(s[f]+(e[f]-s[f])*g),s[i]=c,s.hasOwnProperty("z")&&(s.z=Dr(s.z,e.z,g)),s.hasOwnProperty("w")&&(s.w=Dr(s.w,e.w,g))}function $R(s,e,i,c){const f=i,g=c;for(const y of["x","y"]){let b=s,E=e;b[y]>=E[y]&&(b=e,E=s),b[y]<f&&E[y]>f&&GR(b,E,y,f),b[y]<g&&E[y]>g&&GR(E,b,y,g)}}function Hw(s,e,i,c,f,g){const y=[];for(let b=0;b<s.length;b++){const E=s[b];let M;const R=y.length;let z=0;for(let B=0;B<E.length-1;B++){let j=E[B],V=E[B+1],Y=0;const re=z;let J,oe;g&&(Y=Math.hypot(V.x-j.x,V.y-j.y),z+=Y,J=j,oe=V),j.x<e&&V.x<e||(j.x<e?j=new yt(e,j.y+(e-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x<e&&(V=new yt(e,j.y+(e-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y<i&&V.y<i||(j.y<i?j=new yt(j.x+(i-j.y)/(V.y-j.y)*(V.x-j.x),i)._round():V.y<i&&(V=new yt(j.x+(i-j.y)/(V.y-j.y)*(V.x-j.x),i)._round()),j.x>=c&&V.x>=c||(j.x>=c?j=new yt(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x>=c&&(V=new yt(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y>=f&&V.y>=f||(j.y>=f?j=new yt(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round():V.y>=f&&(V=new yt(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round()),M&&j.equals(M[M.length-1])||(M=[j],y.push(M),g&&g.push({progress:{min:re+qR(J,oe,j)*Y,max:1},parentIndex:b,prevPoint:J,nextPoint:oe})),M.push(V),g&&(g[g.length-1].progress.max=re+qR(J,oe,V)*Y,g[g.length-1].nextPoint=oe)))))}if(g&&z>0)for(let B=R;B<y.length;B++)g[B].progress.min/=z,g[B].progress.max/=z}return y}function PG(s,e,i,c,f){if(s.length<2)return void c.push(s);const g=[];for(;e.valid();){const[M,R]=e.get();for(let z=0;z<s.length-1;z++){const B=s[z],j=s[z+1],V=Af(B,j,M,R);if(V){const[Y]=V,re=new yt(Dr(B.x,j.x,Y),Dr(B.y,j.y,Y));g.push({t:z+Y,distance:0,point:re})}}e.next()}if(g.length===0)return void c.push(s);g.sort((M,R)=>M.t-R.t);let y=0,b=0,E=[];for(c.push(E);y!==s.length;){if(b===g.length){for(;y!==s.length;)E.length!==0&&E[E.length-1].equals(s[y])||E.push(s[y]),y++;break}g[b].t<=y?(E.length!==0&&E[E.length-1].equals(g[b].point)||E.push(g[b].point),Math.trunc(g[b].t),b++):(E.length!==0&&E[E.length-1].equals(s[y])||E.push(s[y]),y++)}}function qR(s,e,i){return s.x!==e.x?(i.x-s.x)/(e.x-s.x):s.y!==e.y?(i.y-s.y)/(e.y-s.y):0}function Kx(s,e){return s.x*e.x+s.y*e.y}function HR(s,e){if(s.length===1){let i=0;const c=e[i++];let f;for(;!f||c.equals(f);)if(f=e[i++],!f)return 1/0;for(;i<e.length;i++){const g=e[i],y=s[0],b=f.sub(c),E=g.sub(c),M=y.sub(c),R=Kx(b,b),z=Kx(b,E),B=Kx(E,E),j=Kx(M,b),V=Kx(M,E),Y=R*B-z*z,re=(B*j-z*V)/Y,J=(R*V-z*j)/Y,oe=c.z*(1-re-J)+f.z*re+g.z*J;if(isFinite(oe))return oe}return 1/0}{let i=1/0;for(const c of e)i=Math.min(i,c.z);return i}}function XR(s,e,i){let c=1/0;ri(i,e)&&(c=HR(i,e[0]));for(let f=0;f<e.length;f++){const g=e[f],y=s[f];for(let b=0;b<g.length-1;b++){const E=g[b],M=[E,g[b+1],y[b+1],y[b],E];xi(i,M)&&(c=Math.min(c,HR(i,M)))}}return c!==1/0&&c}function ZR(s,e,i,c,f,g,y,b,E,M,R){return s.projection.name==="globe"?(function(z,B,j,V,Y,re,J,oe,ce,pe,Se){const we=[],Ie=[],Pe=z.projection.upVectorScale(Se,z.center.lat,z.worldSize).metersToTile,Oe=[0,0,0,1],ke=[0,0,0,1],Ge=(ct,dt,St,At)=>{ct[0]=dt,ct[1]=St,ct[2]=At,ct[3]=1},pt=FR();j>0&&(j+=pt),V+=pt;for(const ct of B){const dt=[],St=[];for(const At of ct){const Tt=At.x+Y.x,lt=At.y+Y.y,Ot=z.projection.projectTilePoint(Tt,lt,Se),xt=z.projection.upVector(Se,At.x,At.y);let It=j,Et=V;if(J){const rr=WR(Tt,lt,j,V,J,oe,ce,pe);It+=rr.base,Et+=rr.top}j!==0?Ge(Oe,Ot.x+xt[0]*Pe*It,Ot.y+xt[1]*Pe*It,Ot.z+xt[2]*Pe*It):Ge(Oe,Ot.x,Ot.y,Ot.z),Ge(ke,Ot.x+xt[0]*Pe*Et,Ot.y+xt[1]*Pe*Et,Ot.z+xt[2]*Pe*Et),Tr(Oe,Oe,re),Tr(ke,ke,re),dt.push(new oy(Oe[0],Oe[1],Oe[2])),St.push(new oy(ke[0],ke[1],ke[2]))}we.push(dt),Ie.push(St)}return[we,Ie]})(s,e,i,c,f,g,y,b,E,M,R):y?(function(z,B,j,V,Y,re,J,oe,ce){const pe=[],Se=[],we=[0,0,0,1];for(const Ie of z){const Pe=[],Oe=[];for(const ke of Ie){const Ge=ke.x+V.x,pt=ke.y+V.y,ct=WR(Ge,pt,B,j,re,J,oe,ce);we[0]=Ge,we[1]=pt,we[2]=ct.base,we[3]=1,ii(we,we,Y),we[3]=Math.max(we[3],1e-5);const dt=new oy(we[0]/we[3],we[1]/we[3],we[2]/we[3]);we[0]=Ge,we[1]=pt,we[2]=ct.top,we[3]=1,ii(we,we,Y),we[3]=Math.max(we[3],1e-5);const St=new oy(we[0]/we[3],we[1]/we[3],we[2]/we[3]);Pe.push(dt),Oe.push(St)}pe.push(Pe),Se.push(Oe)}return[pe,Se]})(e,i,c,f,g,y,b,E,M):(function(z,B,j,V,Y){const re=[],J=[],oe=Y[8]*B,ce=Y[9]*B,pe=Y[10]*B,Se=Y[11]*B,we=Y[8]*j,Ie=Y[9]*j,Pe=Y[10]*j,Oe=Y[11]*j;for(const ke of z){const Ge=[],pt=[];for(const ct of ke){const dt=ct.x+V.x,St=ct.y+V.y,At=Y[0]*dt+Y[4]*St+Y[12],Tt=Y[1]*dt+Y[5]*St+Y[13],lt=Y[2]*dt+Y[6]*St+Y[14],Ot=Y[3]*dt+Y[7]*St+Y[15],xt=At+oe,It=Tt+ce,Et=lt+pe,rr=Math.max(Ot+Se,1e-5),nr=At+we,Ht=Tt+Ie,Yt=lt+Pe,wr=Math.max(Ot+Oe,1e-5);Ge.push(new oy(xt/rr,It/rr,Et/rr)),pt.push(new oy(nr/wr,Ht/wr,Yt/wr))}re.push(Ge),J.push(pt)}return[re,J]})(e,i,c,f,g)}function WR(s,e,i,c,f,g,y,b){const E=y*f.getElevationAt(s,e,!0,!0),M=g[0]!==0,R=M?g[1]===0?y*(g[0]/7-450):y*(function(z,B,j){const V=Math.floor(B[0]/8),Y=Math.floor(B[1]/8),re=10*(B[0]-8*V),J=10*(B[1]-8*Y),oe=z.getElevationAt(V,Y,!0,!0),ce=z.getMeterToDEM(j),pe=Math.floor(.5*(re*ce-1)),Se=Math.floor(.5*(J*ce-1)),we=z.tileCoordToPixel(V,Y),Ie=2*pe+1,Pe=2*Se+1,Oe=(function(St,At,Tt,lt,Ot){return[St.getElevationAtPixel(At,Tt,!0),St.getElevationAtPixel(At+Ot,Tt,!0),St.getElevationAtPixel(At,Tt+Ot,!0),St.getElevationAtPixel(At+lt,Tt+Ot,!0)]})(z,we.x-pe,we.y-Se,Ie,Pe),ke=Math.abs(Oe[0]-Oe[1]),Ge=Math.abs(Oe[2]-Oe[3]),pt=Math.abs(Oe[0]-Oe[2])+Math.abs(Oe[1]-Oe[3]),ct=Math.min(.25,.5*ce*(ke+Ge)/Ie),dt=Math.min(.25,.5*ce*pt/Pe);return oe+Math.max(ct*re,dt*J)})(f,g,b):E;return{base:E+(i===0?-1:i),top:M?Math.max(R+c,E+i+2):E+c}}class DG{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class RG{constructor(){this.tasks={},this.taskQueue=[],Wt(["process"],this),this.invoker=new DG(this.process),this.nextId=0}add(e,i){const c=this.nextId++,f=(function({type:g,isSymbolTile:y,zoom:b}){return b=b||0,g==="message"?0:g!=="maybePrepare"||y?g!=="parseTile"||y?g==="parseTile"&&y?300-b:g==="maybePrepare"&&y?400-b:500:200-b:100-b})(i);return f===0?(e(),null):(this.tasks[c]={fn:e,metadata:i,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}})}process(){{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}}pick(){let e=null,i=1/0;for(let f=0;f<this.taskQueue.length;f++){const g=this.tasks[this.taskQueue[f]];g.priority<i&&(i=g.priority,e=f)}if(e===null)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}class YR{constructor(e,i,c){this.target=e,this.parent=i,this.mapId=c,this.callbacks={},this.cancelCallbacks={},Wt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new RG}send(e,i,c,f,g=!1,y){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=y,this.callbacks[b]=c);const E=new Set;return this.target.postMessage({id:b,type:e,hasCallback:!!c,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:ji(i,E)},E),{cancel:()=>{c&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(e){const i=e.data;if(!i)return;const c=i.id;if(c&&(!i.targetMapId||this.mapId===i.targetMapId))if(i.type==="<cancel>"){const f=this.cancelCallbacks[c];delete this.cancelCallbacks[c],f&&f.cancel()}else if(i.mustQueue||Zn(self)){const f=this.callbacks[c],g=this.scheduler.add(()=>this.processTask(c,i),f&&f.metadata||{type:"message"});g&&(this.cancelCallbacks[c]=g)}else this.processTask(c,i)}processTask(e,i){if(delete this.cancelCallbacks[e],i.type==="<response>"){const c=this.callbacks[e];delete this.callbacks[e],c&&(i.error?c(bl(i.error)):c(null,bl(i.data)))}else{const c=new Set,f=i.hasCallback?(y,b)=>{this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:y?ji(y):null,data:ji(b,c)},c)}:()=>{},g=bl(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,g,f);else if(this.parent.getWorkerSource){const y=i.type.split("."),{source:b,scope:E}=g;this.parent.getWorkerSource(i.sourceMapId,y[0],b,E)[y[1]](g,f)}else f(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Qx={workerUrl:"",workerClass:null,workerParams:void 0};function zG(s){return Qx.workerClass!=null?new Qx.workerClass:new self.Worker(Qx.workerUrl,Object.assign({name:s},Qx.workerParams))}const CS="mapboxgl_preloaded_worker_pool";class sy{constructor(e){this.active={},this.name=e}acquire(e,i=sy.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<i;){const c=zG(`${this.name||""}WorkerPool: ${e}-${this.workers.length}`);this.workers.push(c)}return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.workers&&this.numActive()===0&&(this.workers.forEach(i=>{i.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[CS]}numActive(){return Object.keys(this.active).length}}sy.workerCount=2;class Vv{constructor(e,i,c="Worker",f=sy.workerCount){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Dt();const g=this.workerPool.acquire(this.id,f);for(let y=0;y<g.length;y++){const b=new Vv.Actor(g[y],i,this.id);b.name=`${c} ${y}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,i,c){qe(this.actors,(f,g)=>{f.send(e,i,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}let Jx,IS;function Xw(){return Jx||(Jx=new sy),Jx}Vv.Actor=YR;const PS=4096;class LG{constructor(e){this.module=e,this.memoryStack=this.module.malloc(PS),this.memoryStackNextFree=this.memoryStack}createIntArray(e){const i=this.memoryStackNextFree;return this.memoryStackNextFree+=e.length*Int32Array.BYTES_PER_ELEMENT,this.memoryStackNextFree-this.memoryStack>PS?-1:(new Int32Array(this.module.heap32.buffer,i,e.length).set(e),i)}createFloatArray(e){const i=this.memoryStackNextFree;return this.memoryStackNextFree+=e.length*Float32Array.BYTES_PER_ELEMENT,this.memoryStackNextFree-this.memoryStack>PS?-1:(new Float32Array(this.module.heapF32.buffer,i,e.length).set(e),i)}readStringBuffer(e){let i="";for(;this.module.heapU8[e]!==0;)i+=String.fromCharCode(this.module.heapU8[e]),++e;return i}setStyle(e){const i=e.normalScale;this.module.setStyle(i[0],i[1],i[2],e.tileToMeters)}setAOOptions(e,i){this.module.setAOOptions(e?1:0,i)}setMetricOptions(e,i){this.module.setMetricOptions(e?1:0,i)}setStructuralOptions(e){this.module.setStructuralOptions(e?1:0)}setFacadeOptions(e,i){this.module.setFacadeOptions(e,i?1:0)}setFauxFacadeOptions(e,i,c){this.module.setFauxFacadeOptions(e?1:0,i?1:0,c)}setFacadeClassifierOptions(e){this.module.setFacadeClassifierOptions(e)}generateMesh(e,i){this.memoryStackNextFree=this.memoryStack;for(const b of e){const E=this.createIntArray(b.ringIndices),M=this.createFloatArray(b.coordinates);if(E===-1||M===-1)return`building_gen: Out of stack memory: ${this.memoryStackNextFree-this.memoryStack}/4096`;this.module.addFeature(b.id,b.sourceId,b.minHeight,b.height,b.roofType,M,E,b.ringIndices.length-1)}for(const b of i){let E;E=b.entrances?JSON.parse(b.entrances):[];const M=this.createFloatArray(E),R=this.createFloatArray(b.coordinates);if(M===-1||R===-1)return`building_gen: Out of stack memory: ${this.memoryStackNextFree-this.memoryStack}/4096`;this.module.addFacade(b.sourceId,b.crossPerc,b.distanceToRoad,M,E.length,R,b.coordinates.length)}if(!this.module.generateMesh()){const b=this.module.getLastError();return this.readStringBuffer(b)}const c=this.module.getMeshCount(),f=new Array(c);for(let b=0;b<c;b++){const E=this.module.getPositionsPtr(b),M=this.module.getPositionsLength(b),R=new Float32Array(this.module.heapF32.buffer,E,M),z=this.module.getNormalsPtr(b),B=this.module.getNormalsLength(b),j=new Float32Array(this.module.heapF32.buffer,z,B),V=this.module.getAOPtr(b),Y=this.module.getAOLength(b),re=new Float32Array(this.module.heapF32.buffer,V,Y),J=this.module.getUVPtr(b),oe=this.module.getUVLength(b),ce=new Float32Array(this.module.heapF32.buffer,J,oe),pe=this.module.getFauxFacadePtr(b),Se=this.module.getFauxFacadeLength(b),we=new Uint8Array(this.module.heapU8.buffer,pe,Se),Ie=this.module.getIndicesPtr(b),Pe=this.module.getIndicesLength(b),Oe=new Int16Array(this.module.heap16.buffer,Ie,Pe),ke=this.module.getBuildingPart(b);f[b]={positions:R,normals:j,ao:re,uv:ce,isFauxFacade:we,indices:Oe,buildingPart:ke}}const g=this.module.getRingCount(),y=[];for(let b=0;b<g;b++){const E=this.module.getRingPtr(b),M=this.module.getRingLength(b),R=new Float32Array(this.module.heapF32.buffer,E,M);y.push(R)}return{meshes:f,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:y}}}let e1,DS,Ad,Gv,RS,$v=null,qv=null,KR=null,Zw=null;function QR(){return Zn(self)&&self.worker.dracoUrl?self.worker.dracoUrl:DS||ya.DRACO_URL}function JR(){if(Zn(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Gv)return Gv;const s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Gv=WebAssembly.validate(s)?ya.MESHOPT_SIMD_URL:ya.MESHOPT_URL,Gv}function BG(){return Zw}const ez=5120,tz=5121,rz=5122,nz=5123,iz=5125,az=5126,Ww={[ez]:Int8Array,[tz]:Uint8Array,[rz]:Int16Array,[nz]:Uint16Array,[iz]:Uint32Array,[az]:Float32Array},kG={[ez]:"DT_INT8",[tz]:"DT_UINT8",[rz]:"DT_INT16",[nz]:"DT_UINT16",[iz]:"DT_UINT32",[az]:"DT_FLOAT32"},t1={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function oz(s,e,i){const c=i.json.bufferViews.length,f=i.buffers.length;e.bufferView=c,i.json.bufferViews[c]={buffer:f,byteLength:s.byteLength},i.buffers[f]=s}const zS="KHR_draco_mesh_compression";function FG(s,e){const i=s.extensions&&s.extensions[zS];if(!i)return;const c=new Ad.Decoder,f=uz(e,i.bufferView),g=new Ad.Mesh;if(!c.DecodeArrayToMesh(f,f.byteLength,g))throw new Error("Failed to decode Draco mesh");const y=e.json.accessors[s.indices],b=Ww[y.componentType],E=y.count*b.BYTES_PER_ELEMENT,M=Ad._malloc(E);b===Uint16Array?c.GetTrianglesUInt16Array(g,E,M):c.GetTrianglesUInt32Array(g,E,M),oz(Ad.memory.buffer.slice(M,M+E),y,e),Ad._free(M);for(const R of Object.keys(i.attributes)){const z=c.GetAttributeByUniqueId(g,i.attributes[R]),B=e.json.accessors[s.attributes[R]],j=kG[B.componentType],V=B.count*t1[B.type]*Ww[B.componentType].BYTES_PER_ELEMENT,Y=Ad._malloc(V);c.GetAttributeDataArrayForAllPoints(g,z,Ad[j],V,Y),oz(Ad.memory.buffer.slice(Y,Y+V),B,e),Ad._free(Y)}c.destroy(),g.destroy(),delete s.extensions[zS]}const Yw="EXT_meshopt_compression";function NG(s,e){if(!s.extensions||!s.extensions[Yw])return;const i=s.extensions[Yw],c=new Uint8Array(e.buffers[i.buffer],i.byteOffset||0,i.byteLength||0),f=new Uint8Array(i.count*i.byteStride);RS.decodeGltfBuffer(f,i.count,i.byteStride,c,i.mode,i.filter),s.buffer=e.buffers.length,s.byteOffset=0,e.buffers[s.buffer]=f.buffer,delete s.extensions[Yw]}const sz=1179937895,lz=new TextDecoder("utf8");function cz(s,e){return new URL(s,e).href}function jG(s,e,i,c){return fetch(cz(s.uri,c)).then(f=>f.arrayBuffer()).then(f=>{e.buffers[i]=f})}function uz(s,e){const i=s.json.bufferViews[e];return new Uint8Array(s.buffers[i.buffer],i.byteOffset||0,i.byteLength)}function UG(s,e,i,c){if(s.uri){const f=cz(s.uri,c);return fetch(f).then(g=>g.blob()).then(g=>createImageBitmap(g)).then(g=>{e.images[i]=g})}if(s.bufferView!==void 0){const f=uz(e,s.bufferView),g=new Blob([f],{type:s.mimeType});return createImageBitmap(g).then(y=>{e.images[i]=y})}}function hz(s,e=0,i){const c={json:null,images:[],buffers:[]};if(new Uint32Array(s,e,1)[0]===sz){const R=new Uint32Array(s,e);let z=2;const B=(R[z++]>>2)-3,j=R[z++]>>2;if(z++,c.json=JSON.parse(lz.decode(R.subarray(z,z+j))),z+=j,z<B){const V=R[z++];z++;const Y=e+(z<<2);c.buffers[0]=s.slice(Y,Y+V)}}else c.json=JSON.parse(lz.decode(new Uint8Array(s,e)));const{buffers:f,images:g,meshes:y,extensionsUsed:b,bufferViews:E}=c.json;let M=Promise.resolve();if(f){const R=[];for(let z=0;z<f.length;z++){const B=f[z];B.uri?R.push(jG(B,c,z,i)):c.buffers[z]||(c.buffers[z]=null)}M=Promise.all(R)}return M.then(()=>{const R=[],z=b&&b.includes(zS),B=b&&b.includes(Yw);if(z&&R.push((function(){if(!Ad)return e1??(e1=(function(j){let V,Y=null;function re(){V=new Uint8Array(Y.buffer)}function J(){throw new Error("Unexpected Draco error.")}const oe={a:{a:J,d:function(ce,pe,Se){return V.copyWithin(ce,pe,pe+Se)},c:function(ce){const pe=V.length,Se=Math.max(ce>>>0,Math.ceil(1.2*pe)),we=Math.ceil((Se-pe)/65536);try{return Y.grow(we),re(),!0}catch{return!1}},b:J}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(j,oe):j.then(ce=>ce.arrayBuffer()).then(ce=>WebAssembly.instantiate(ce,oe))).then(ce=>{const{Rb:pe,Qb:Se,P:we,T:Ie,X:Pe,Ja:Oe,La:ke,Qa:Ge,Va:pt,Wa:ct,eb:dt,jb:St,f:At,e:Tt,yb:lt,zb:Ot,Ab:xt,Bb:It,Db:Et,Gb:rr}=ce.instance.exports;Y=Tt;const nr=(()=>{let Ht=0,Yt=0,wr=0,gr=0;return tr=>{wr&&(pe(gr),pe(Ht),Yt+=wr,wr=Ht=0),Ht||(Yt+=128,Ht=Se(Yt));const Fr=tr.length+7&-8;let nn=Ht;Fr>=Yt&&(wr=Fr,nn=gr=Se(Fr));for(let On=0;On<tr.length;On++)V[nn+On]=tr[On];return nn}})();return re(),At(),{memory:Tt,_free:pe,_malloc:Se,Mesh:class{constructor(){this.ptr=we()}destroy(){Ie(this.ptr)}},Decoder:class{constructor(){this.ptr=Oe()}destroy(){St(this.ptr)}DecodeArrayToMesh(Ht,Yt,wr){const gr=nr(Ht),tr=ke(this.ptr,gr,Yt,wr.ptr);return!!Pe(tr)}GetAttributeByUniqueId(Ht,Yt){return{ptr:Ge(this.ptr,Ht.ptr,Yt)}}GetTrianglesUInt16Array(Ht,Yt,wr){pt(this.ptr,Ht.ptr,Yt,wr)}GetTrianglesUInt32Array(Ht,Yt,wr){ct(this.ptr,Ht.ptr,Yt,wr)}GetAttributeDataArrayForAllPoints(Ht,Yt,wr,gr,tr){dt(this.ptr,Ht.ptr,Yt.ptr,wr,gr,tr)}},DT_INT8:lt(),DT_UINT8:Ot(),DT_INT16:xt(),DT_UINT16:It(),DT_UINT32:Et(),DT_FLOAT32:rr()}})})(fetch(QR())),e1.then(j=>{Ad=j,e1=void 0}))})()),B&&R.push((function(){if(RS)return;const j=(function(V){let Y;const re=WebAssembly.instantiateStreaming(V,{}).then(ce=>{Y=ce.instance,Y.exports.__wasm_call_ctors()}),J={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},oe={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:re,supported:!0,decodeGltfBuffer(ce,pe,Se,we,Ie,Pe){(function(Oe,ke,Ge,pt,ct,dt,St){const At=Oe.exports.sbrk,Tt=pt+3&-4,lt=At(Tt*ct),Ot=At(dt.length),xt=new Uint8Array(Oe.exports.memory.buffer);xt.set(dt,Ot);const It=ke(lt,pt,ct,Ot,dt.length);if(It===0&&St&&St(lt,Tt,ct),Ge.set(xt.subarray(lt,lt+pt*ct)),At(lt-At(0)),It!==0)throw new Error(`Malformed buffer data: ${It}`)})(Y,Y.exports[oe[Ie]],ce,pe,Se,we,Y.exports[J[Pe]])}}})(fetch(JR()));return j.ready.then(()=>{RS=j})})()),g)for(let j=0;j<g.length;j++)R.push(UG(g[j],c,j,i));return(R.length?Promise.all(R):Promise.resolve()).then(()=>{if(z&&y)for(const{primitives:j}of y)for(const V of j)FG(V,c);if(B&&y&&E)for(const j of E)NG(j,c);return c})})}function dz(s){return fetch(s).then(e=>e.arrayBuffer()).then(e=>hz(e,0,s))}function LS(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function BS(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class kS{constructor(e,i,c,f){this.context=e,this.format=c,this.useMipmap=f&&f.useMipmap,this.texture=e.gl.createTexture(),this.update(i,{premultiply:f&&f.premultiply})}update(e,i){const c=e&&e instanceof HTMLVideoElement&&e.width===0?e.videoWidth:e.width,f=e&&e instanceof HTMLVideoElement&&e.height===0?e.videoHeight:e.height,{context:g}=this,{gl:y}=g,{x:b,y:E}=i&&i.position?i.position:{x:0,y:0},M=b+c,R=E+f;!this.size||this.size[0]===M&&this.size[1]===R||(y.bindTexture(y.TEXTURE_2D,null),y.deleteTexture(this.texture),this.texture=y.createTexture(),this.size=null),y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA8&&(!i||i.premultiply!==!1));const z=e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||ImageBitmap&&e instanceof ImageBitmap;if(!this.size&&M>0&&R>0){const B=this.useMipmap?Math.floor(Math.log2(Math.max(M,R)))+1:1;y.texStorage2D(y.TEXTURE_2D,B,this.format,M,R),this.size=[M,R]}this.size&&(z?y.texSubImage2D(y.TEXTURE_2D,0,b,E,LS(this.format),BS(this.format),e):"data"in e&&e.data&&y.texSubImage2D(y.TEXTURE_2D,0,b,E,c,f,LS(this.format),BS(this.format),e.data)),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(e,i,c=!1){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),e!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,e),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!c?e===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),i!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,i),this.wrapS=i)}bindExtraParam(e,i,c,f,g){const{context:y}=this,{gl:b}=y;b.bindTexture(b.TEXTURE_2D,this.texture),i!==this.magFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,i),this.magFilter=i),e!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap?e===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:e),this.minFilter=e),c!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,c),this.wrapS=c),f!==this.wrapT&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,f),this.wrapT=f),g!==this.compareMode&&(g?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_FUNC,g)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.NONE),this.compareMode=g)}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class r1{constructor(e,i){this.context=e,this.texture=i}bind(e,i){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,e),this.minFilter=e),i!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,i),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,i),this.wrapS=i)}}const VG=en([{name:"a_pos_3f",components:3,type:"Float32"}]),GG=en([{name:"a_color_3f",components:3,type:"Float32"}]),$G=en([{name:"a_color_4f",components:4,type:"Float32"}]),qG=en([{name:"a_uv_2f",components:2,type:"Float32"}]),HG=en([{name:"a_normal_3f",components:3,type:"Float32"}]),XG=en([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),ZG=en([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function fz(s,e){const i=Kw(s.projection,s.zoom,s.width,s.height),c=(function(g,y,b,E,M){const R=new Te(b.lng-180*Tg,b.lat),z=new Te(b.lng+180*Tg,b.lat),B=g.project(R.lng,R.lat),j=g.project(z.lng,z.lat),V=-Math.atan2(j.y-B.y,j.x-B.x),Y=qt.fromLngLat(b);Y.y=Ee(Y.y,-1+Tg,1-Tg);const re=Y.toLngLat(),J=g.project(re.lng,re.lat),oe=qt.fromLngLat(re);oe.x+=Tg;const ce=oe.toLngLat(),pe=g.project(ce.lng,ce.lat),Se=mz(pe.x-J.x,pe.y-J.y,V),we=qt.fromLngLat(re);we.y+=Tg;const Ie=we.toLngLat(),Pe=g.project(Ie.lng,Ie.lat),Oe=mz(Pe.x-J.x,Pe.y-J.y,V),ke=Math.abs(Se.x)/Math.abs(Oe.y),Ge=K([]);ve(Ge,Ge,-V*(1-(M?0:E)));const pt=K([]);return ge(pt,pt,[1,1-(1-ke)*E,1]),pt[4]=-Oe.x/Oe.y*E,ve(pt,pt,V),ue(pt,Ge,pt),pt})(s.projection,0,s.center,i,e),f=pz(s);return ge(c,c,[f,f,1]),c}function pz(s){const e=s.projection,i=Kw(s.projection,s.zoom,s.width,s.height),c=FS(e,s.center),f=FS(e,Te.convert(e.center));return Math.pow(2,c*i+(1-i)*f)}function Kw(s,e,i,c,f=1/0){const g=s.range;if(!g)return 0;const y=Math.min(f,Math.max(i,c)),b=Math.log2(y/1024);return Fe(g[0]+b,g[1]+b,e)}const Tg=1/4e4;function FS(s,e){const i=Ee(e.lat,-85.051129,je),c=new Te(e.lng-180*Tg,i),f=new Te(e.lng+180*Tg,i),g=s.project(c.lng,i),y=s.project(f.lng,i),b=qt.fromLngLat(c),E=qt.fromLngLat(f),M=y.x-g.x,R=y.y-g.y,z=E.x-b.x,B=E.y-b.y,j=Math.sqrt((z*z+B*B)/(M*M+R*R));return Math.log2(j)}function mz(s,e,i){const c=Math.cos(i),f=Math.sin(i);return{x:s*c-e*f,y:s*f+e*c}}function gz(s,e,i){K(s),ve(s,s,yr(e[2])),se(s,s,yr(e[0])),fe(s,s,yr(e[1])),ge(s,s,i),ue(s,s,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Qw(s,e,i,c,f,g,y,b){const E=[i[0]-e[0],i[1]-e[1],0],M=[c[0]-e[0],c[1]-e[1],0];if(Mt(E)<1e-12||Mt(M)<1e-12)return Ai(s);const R=kr([],E,M);Xt(R,R),Kt(M,c,e),E[2]=(g-f)*b,M[2]=(y-f)*b;const z=E;return kr(z,E,M),Xt(z,z),Ci(s,R,z)}function Jw(s,e,i=!1){const c=vd(e.zoom),f=(function(g,y,b){const E=y.worldSize,M=[g[12],g[13],g[14]],R=wt(M[1]/E),z=ut(M[0]/E),B=K([]),j=We(1,R)*E,V=We(1,0)*E*ot(R,y.zoom),Y=1/$_(E);let re=V*Y;if(b){const pe=Kw(y.projection,y.zoom,y.width,y.height,1024);re=Y*y.projection.pixelSpaceConversion(y.center.lat,E,pe)}const J=Ce(R,z);Ct(J,J,Bt([],Xt([],J),j*re*M[2]));const oe=(function(pe){const Se=[pe[0],pe[1],pe[2]];let we=[0,1,0];const Ie=kr([],we,Se);return kr(we,Se,Ie),Zr(we)===0&&(we=[0,1,0],kr(Ie,Se,we)),Xt(Ie,Ie),Xt(we,we),Xt(Se,Se),[Ie[0],Ie[1],Ie[2],0,we[0],we[1],we[2],0,Se[0],Se[1],Se[2],0,pe[0],pe[1],pe[2],1]})(J);ge(B,B,[re,re,re*j]),me(B,B,[-M[0],-M[1],-M[2]]);const ce=ue([],y.globeMatrix,oe);return ue(ce,ce,B),ue(ce,ce,g),ce})(s,e,i);if(c>0){const g=(function(y,b){const E=b.worldSize,M=We(1,0)*E*ot(b.center.lat,b.zoom)/$_(E),R=We(1,b.center.lat)*E,z=K([]);fe(z,z,yr(b.center.lng)),se(z,z,yr(b.center.lat)),me(z,z,[0,0,ae]),ge(z,z,[M,M,M*R]);const B=b.point;return me(z,z,[-B.x,-B.y,0]),ue(z,z,y),ue(z,b.globeMatrix,z)})(s,e);return(function(y,b,E){const M=(V,Y,re)=>{const J=Mt(V),oe=Mt(Y),ce=ph(V,Y,re);return Bt(ce,ce,1/Mt(ce)*Dr(J,oe,re))},R=M([y[0],y[1],y[2]],[b[0],b[1],b[2]],E),z=M([y[4],y[5],y[6]],[b[4],b[5],b[6]],E),B=M([y[8],y[9],y[10]],[b[8],b[9],b[10]],E),j=ph([y[12],y[13],y[14]],[b[12],b[13],b[14]],E);return[R[0],R[1],R[2],0,z[0],z[1],z[2],0,B[0],B[1],B[2],0,j[0],j[1],j[2],1]})(f,g,c)}return f}function NS(s,e,i,c){const f=An.projectAabbCorners(c,i);let g=Number.MAX_VALUE;for(let b=0;b<f.length;++b){const E=f[b];E[0]=(.5*E[0]+.5)*e.width,E[1]=(.5-.5*E[1])*e.height,E[2]<g&&(g=E[2])}const y=(function(b){const E=[];let M=0;for(let j=1;j<b.length;j++)(b[j][0]<b[M][0]||b[j][0]===b[M][0]&&b[j][1]<b[M][1])&&(M=j);let R,z=M;const B=new Uint8Array(b.length);do{if(B[z])break;E.push(new yt(b[z][0],b[z][1])),B[z]=1,R=(z+1)%b.length;for(let j=0;j<b.length;j++){if(b[j][0]===b[R][0]&&b[j][1]===b[R][1]||b[j][0]===b[z][0]&&b[j][1]===b[z][1])continue;const V=[b[j][0]-b[z][0],b[j][1]-b[z][1]],Y=[b[R][0]-b[z][0],b[R][1]-b[z][1]],re=V[0]*Y[1]-V[1]*Y[0];(re>0||re===0&&V[0]*Y[0]+V[1]*Y[1]>=0&&V[0]*V[0]+V[1]*V[1]>Y[0]*Y[0]+Y[1]*Y[1])&&(R=j)}z=R}while(z!==M);return E.length>0&&E.push(E[0]),E})(f);if(xi(s,y))return g}const ly=64,Hv={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function e2(s,e,i,c,f,g,y,b,E,M=!1){const R=i.zoom,z=i.project(c),B=ot(c.lat,R),j=1/B;K(s),me(s,s,[z.x+y[0]*j,z.y+y[1]*j,y[2]]);let V=1,Y=1;const re=i.worldSize;if(M){if(i.projection.name==="mercator"){let pe=0;i.elevation&&(pe=i.elevation.getAtPointOrZero(new qt(z.x/re,z.y/re),0));const Se=ii([],[z.x,z.y,pe,1],i.projMatrix)[3]/i.cameraToCenterDistance;V=Se,Y=Se*ot(i.center.lat,R)}else if(i.projection.name==="globe"){const pe=Jw(s,i),Se=[0,0,0,1];ii(Se,Se,ue([],i.projMatrix,pe));const we=Se[3]/i.cameraToCenterDistance,Ie=vd(R),Pe=i.projection.pixelsPerMeter(c.lat,re)*ot(c.lat,R),Oe=i.projection.pixelsPerMeter(i.center.lat,re)*ot(i.center.lat,R);V=we/Dr(Pe,mt(i.center.lat),Ie),Y=we*B/Pe,V*=Oe,Y*=Oe}}else V=j;ge(s,s,[V,V,Y]);const J=[...s],oe=e.orientation,ce=[];if(gz(ce,[oe[0]+(f?f[0]:0),oe[1]+(f?f[1]:0),oe[2]+(f?f[2]:0)],g),ue(s,J,ce),b&&i.elevation){let pe=0;const Se=[];if(E&&i.elevation){pe=(function(Ie,Pe,Oe,ke,Ge){const pt=Pe.elevation;if(!pt)return 0;const ct=An.projectAabbCorners(Oe,ke),dt=We(1,Ge.lat)*Pe.worldSize,St=(function(Yt,wr){const gr=[0,0,1],tr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Fr of tr){const nn=Yt[Fr.corners[0]],On=Yt[Fr.corners[1]],Yr=Yt[Fr.corners[2]],Hn=[On[0]-nn[0],On[1]-nn[1],wr*(On[2]-nn[2])],gn=kr(Hn,Hn,[Yr[0]-nn[0],Yr[1]-nn[1],wr*(Yr[2]-nn[2])]);Xt(gn,gn),Fr.dotProductWithUp=Mr(gn,gr)}return tr.sort((Fr,nn)=>Fr.dotProductWithUp-nn.dotProductWithUp),tr[0].corners})(ct,dt),At=ct[St[0]],Tt=ct[St[1]],lt=ct[St[2]],Ot=ct[St[3]],xt=pt.getAtPointOrZero(new qt(At[0]/Pe.worldSize,At[1]/Pe.worldSize),0),It=pt.getAtPointOrZero(new qt(Tt[0]/Pe.worldSize,Tt[1]/Pe.worldSize),0),Et=pt.getAtPointOrZero(new qt(lt[0]/Pe.worldSize,lt[1]/Pe.worldSize),0),rr=pt.getAtPointOrZero(new qt(Ot[0]/Pe.worldSize,Ot[1]/Pe.worldSize),0),nr=(xt+rr)/2,Ht=(It+Et)/2;return nr>Ht?It<Et?Qw(Ie,Tt,Ot,At,It,rr,xt,dt):Qw(Ie,lt,At,Ot,Et,xt,rr,dt):xt<rr?Qw(Ie,At,Tt,lt,xt,It,Et,dt):Qw(Ie,Ot,lt,Tt,rr,Et,It,dt),Math.max(nr,Ht)})(Se,i,e.aabb,s,c);const we=ue([],Ke([],Se),ce);ue(s,J,we)}else pe=i.elevation.getAtPointOrZero(new qt(z.x/re,z.y/re),0);pe!==0&&(s[14]+=pe)}}class _z{constructor(e,i,c,f,g){this.materialOverrides=new Map,this.nodeOverrides=new Map,this.materialOverrideNames=[],this.nodeOverrideNames=[],this.featureProperties={},this.id=e,this.uri=i,this.position=c!=null?new Te(c[0],c[1]):new Te(0,0),this.orientation=f??[0,0,0],this.nodes=g,this.uploaded=!1,this.aabb=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,i){ue(e.globalMatrix,i,e.localMatrix);const c=this.nodeOverrides.get(e.name);if(c!==void 0){const y=[];g=c.orientation,K(f=y),fe(f,f,yr(g[1])),ve(f,f,yr(g[2])),se(f,f,yr(g[0])),ue(e.globalMatrix,e.globalMatrix,y)}var f,g;if(e.meshes)for(const y of e.meshes){const b=An.applyTransformFast(y.aabb,e.globalMatrix);this.aabb.encapsulate(b)}if(e.children)for(const y of e.children)this._applyTransformations(y,e.globalMatrix)}computeBoundsAndApplyParent(){const e=K([]);this.aabb=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const i of this.nodes)this._applyTransformations(i,e)}computeModelMatrix(e,i,c,f,g,y,b=!1){e2(this.matrix,this,e.transform,this.position,i,c,f,g,y,b)}upload(e){if(!this.uploaded){for(const i of this.nodes)jS(i,e);for(const i of this.nodes)t2(i);this.uploaded=!0}}destroy(){for(const e of this.nodes)US(e)}}function n1(s,e,i=!1){s.uploaded||(s.gfxTexture=new kS(e,s.image,i?e.gl.R8:e.gl.RGBA8,{useMipmap:s.sampler.minFilter>=e.gl.NEAREST_MIPMAP_NEAREST}),s.uploaded=!0,s.image=null)}function WG(s,e,i){s.indexBuffer=e.createIndexBuffer(s.indexArray,!1,!0),s.vertexBuffer=e.createVertexBuffer(s.vertexArray,VG.members,!1,!0),s.normalArray&&(s.normalBuffer=e.createVertexBuffer(s.normalArray,HG.members,!1,!0)),s.texcoordArray&&(s.texcoordBuffer=e.createVertexBuffer(s.texcoordArray,qG.members,!1,!0)),s.colorArray&&(s.colorBuffer=e.createVertexBuffer(s.colorArray,(s.colorArray.bytesPerElement===12?GG:$G).members,!1,!0)),s.featureArray&&(s.pbrBuffer=e.createVertexBuffer(s.featureArray,ZG.members,!0)),s.segments=ui.simpleSegment(0,0,s.vertexArray.length,s.indexArray.length);const c=s.material;c.pbrMetallicRoughness.baseColorTexture&&n1(c.pbrMetallicRoughness.baseColorTexture,e),c.pbrMetallicRoughness.metallicRoughnessTexture&&n1(c.pbrMetallicRoughness.metallicRoughnessTexture,e),c.normalTexture&&n1(c.normalTexture,e),c.occlusionTexture&&n1(c.occlusionTexture,e,i),c.emissionTexture&&n1(c.emissionTexture,e)}function jS(s,e,i){if(s.meshes)for(const c of s.meshes)WG(c,e,i);if(s.children)for(const c of s.children)jS(c,e,i)}function t2(s){if(s.meshes)for(const e of s.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(s.children)for(const e of s.children)t2(e)}function YG(s){s.pbrMetallicRoughness.baseColorTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture&&s.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),s.pbrMetallicRoughness.metallicRoughnessTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&s.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),s.normalTexture&&s.normalTexture.gfxTexture&&s.normalTexture.gfxTexture.destroy(),s.emissionTexture&&s.emissionTexture.gfxTexture&&s.emissionTexture.gfxTexture.destroy(),s.occlusionTexture&&s.occlusionTexture.gfxTexture&&s.occlusionTexture.gfxTexture.destroy()}function US(s){if(s.meshes)for(const e of s.meshes)e.vertexBuffer&&(e.vertexBuffer.destroy(),e.indexBuffer.destroy(),e.normalBuffer&&e.normalBuffer.destroy(),e.texcoordBuffer&&e.texcoordBuffer.destroy(),e.colorBuffer&&e.colorBuffer.destroy(),e.pbrBuffer&&e.pbrBuffer.destroy(),e.segments.destroy(),e.material&&YG(e.material));if(s.children)for(const e of s.children)US(e)}function cy(s,e){const i=s.json.bufferViews[e.bufferView],c=Ww[e.componentType];return new c(s.buffers[i.buffer],(e.byteOffset||0)+(i.byteOffset||0),e.count*(i.byteStride&&i.byteStride!==t1[e.type]*c.BYTES_PER_ELEMENT?i.byteStride/c.BYTES_PER_ELEMENT:t1[e.type]))}function VS(s,e,i,c){const f=Ww[e.componentType],g=(function(R){switch(R){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(f),y=s.json.bufferViews[e.bufferView],b=y.byteStride?y.byteStride/f.BYTES_PER_ELEMENT:t1[e.type],E=i.float32,M=E.length/i.capacity;for(let R=0,z=0;R<e.count*b;R+=b,z+=M)for(let B=0;B<M;B++)E[z+B]=c[R+B]*g;i._trim()}function KG(s,e,i){const c=s.indices,f=s.attributes,g={};g.indexArray=new pa;const y=e.json.accessors[c],b=y.count/3;g.indexArray.reserve(b);const E=cy(e,y);for(let B=0;B<b;B++)g.indexArray.emplaceBack(E[3*B],E[3*B+1],E[3*B+2]);g.indexArray._trim(),g.vertexArray=new tl;const M=e.json.accessors[f.POSITION];g.vertexArray.reserve(M.count);const R=cy(e,M);for(let B=0;B<M.count;B++)g.vertexArray.emplaceBack(R[3*B],R[3*B+1],R[3*B+2]);if(g.vertexArray._trim(),g.aabb=new An(M.min,M.max),g.centroid=(function(B,j){const V=[0,0,0],Y=B.length;if(Y>0){for(let re=0;re<Y;re++){const J=3*B[re];V[0]+=j[J],V[1]+=j[J+1],V[2]+=j[J+2]}V[0]/=Y,V[1]/=Y,V[2]/=Y}return V})(E,R),f.COLOR_0!==void 0){const B=e.json.accessors[f.COLOR_0],j=t1[B.type],V=cy(e,B);g.colorArray=j===3?new tl:new Yl,g.colorArray.resize(B.count),VS(e,B,g.colorArray,V)}if(f.NORMAL!==void 0){g.normalArray=new tl;const B=e.json.accessors[f.NORMAL];g.normalArray.resize(B.count);const j=cy(e,B);VS(e,B,g.normalArray,j)}if(f.TEXCOORD_0!==void 0&&i.length>0){g.texcoordArray=new dh;const B=e.json.accessors[f.TEXCOORD_0];g.texcoordArray.resize(B.count);const j=cy(e,B);VS(e,B,g.texcoordArray,j)}if(f._FEATURE_ID_RGBA4444!==void 0){const B=e.json.accessors[f._FEATURE_ID_RGBA4444];e.json.extensionsUsed&&e.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=cy(e,B))}f._FEATURE_RGBA4444!==void 0&&(g.featureData=new Uint32Array(cy(e,e.json.accessors[f._FEATURE_RGBA4444]).buffer));const z=s.material;return g.material=(function(B,j){const{emissiveFactor:V=[0,0,0],alphaMode:Y="OPAQUE",alphaCutoff:re=.5,normalTexture:J,occlusionTexture:oe,emissiveTexture:ce,doubleSided:pe,name:Se}=B,{baseColorFactor:we=[1,1,1,1],metallicFactor:Ie=1,roughnessFactor:Pe=1,baseColorTexture:Oe,metallicRoughnessTexture:ke}=B.pbrMetallicRoughness||{},Ge=oe?j[oe.index]:void 0;if(oe&&oe.extensions&&oe.extensions.KHR_texture_transform&&Ge){const pt=oe.extensions.KHR_texture_transform;Ge.offsetScale=[pt.offset[0],pt.offset[1],pt.scale[0],pt.scale[1]]}return{name:Se,pbrMetallicRoughness:{baseColorFactor:new Cn(...we),metallicFactor:Ie,roughnessFactor:Pe,baseColorTexture:Oe?j[Oe.index]:void 0,metallicRoughnessTexture:ke?j[ke.index]:void 0},doubleSided:pe,emissiveFactor:new Cn(...V),alphaMode:Y,alphaCutoff:re,normalTexture:J?j[J.index]:void 0,occlusionTexture:Ge,emissionTexture:ce?j[ce.index]:void 0,defined:B.defined===void 0}})(z!==void 0?e.json.materials[z]:{defined:!1},i),g}function yz(s,e,i){const{matrix:c,rotation:f,translation:g,scale:y,mesh:b,extras:E,children:M,name:R}=s,z={};if(z.name=R,z.localMatrix=c||(function(B,j,V,Y){var re=j[0],J=j[1],oe=j[2],ce=j[3],pe=re+re,Se=J+J,we=oe+oe,Ie=re*pe,Pe=re*Se,Oe=re*we,ke=J*Se,Ge=J*we,pt=oe*we,ct=ce*pe,dt=ce*Se,St=ce*we,At=Y[0],Tt=Y[1],lt=Y[2];return B[0]=(1-(ke+pt))*At,B[1]=(Pe+St)*At,B[2]=(Oe-dt)*At,B[3]=0,B[4]=(Pe-St)*Tt,B[5]=(1-(Ie+pt))*Tt,B[6]=(Ge+ct)*Tt,B[7]=0,B[8]=(Oe+dt)*lt,B[9]=(Ge-ct)*lt,B[10]=(1-(Ie+ke))*lt,B[11]=0,B[12]=V[0],B[13]=V[1],B[14]=V[2],B[15]=1,B})([],f||[0,0,0,1],g||[0,0,0],y||[1,1,1]),z.globalMatrix=H(z.localMatrix),b!==void 0){z.meshes=i[b];const B=z.anchor=[0,0];for(const j of z.meshes){const{min:V,max:Y}=j.aabb;B[0]+=V[0]+Y[0],B[1]+=V[1]+Y[1]}B[0]=Math.floor(B[0]/z.meshes.length/2),B[1]=Math.floor(B[1]/z.meshes.length/2)}if(E&&(E.id&&(z.id=E.id),E.lights&&(z.lights=(function(B){if(!B.length)return[];const j=(function(oe){const ce=atob(oe),pe=new Uint8Array(ce.length);for(let Se=0;Se<ce.length;Se++)pe[Se]=ce.codePointAt(Se);return pe})(B),V=[],Y=j.length/24,re=new Uint16Array(j.buffer),J=new Float32Array(j.buffer);for(let oe=0;oe<Y;oe++){const ce=re[2*oe*6]/30,pe=re[2*oe*6+1]/30,Se=re[2*oe*6+10]/100,we=J[6*oe+1],Ie=J[6*oe+2],Pe=J[6*oe+3],Oe=J[6*oe+4],ke=Pe-we,Ge=Oe-Ie,pt=Math.hypot(ke,Ge);V.push({pos:[we+.5*ke,Ie+.5*Ge,pe],normal:[Ge/pt,-ke/pt,0],width:pt,height:ce,depth:Se,points:[we,Ie,Pe,Oe]})}return V})(E.lights)),E.MAPBOX_geometry_bloom&&(z.isGeometryBloom=E.MAPBOX_geometry_bloom)),M){const B=[];for(const j of M)B.push(yz(e.json.nodes[j],e,i));z.children=B}return z}function QG(s){if(s.vertices.length===0||s.indices.length===0)return null;const e=new ny(s.vertices,s.indices,8,256),[i,c]=[e.min.clone(),e.max.clone()];return{vertices:s.vertices,indices:s.indices,grid:e,min:i,max:c}}function JG(s){if(!s.extras||!s.extras.ground)return null;const e=s.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const i=e[0];if(!i||!Array.isArray(i)||i.length===0)return null;const c=[];for(const y of i){if(!Array.isArray(y)||y.length!==2)continue;const b=y[0],E=y[1];typeof b=="number"&&typeof E=="number"&&c.push(new yt(b,E))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let f=0;for(let y=0;y<c.length;y++){const b=c[y],E=c[(y+1)%c.length],M=c[(y+2)%c.length];f+=(b.x-E.x)*(M.y-E.y)-(M.x-E.x)*(b.y-E.y)}f>0&&c.reverse();const g=tc(c.flatMap(y=>[y.x,y.y]),[]);return g.length===0?null:{vertices:c,indices:g}}function e$(s,e){const i=[],c=[];let f=0;const g=[];for(const y of s){f=i.length;const b=y.vertexArray.float32,E=y.indexArray.uint16;for(let M=0;M<y.vertexArray.length;M++)g[0]=b[3*M+0],g[1]=b[3*M+1],g[2]=b[3*M+2],Tr(g,g,e),i.push(new yt(g[0],g[1]));for(let M=0;M<3*y.indexArray.length;M++)c.push(E[M]+f)}if(c.length%3!=0)return null;for(let y=0;y<c.length;y+=3){const b=i[c[y+0]],E=i[c[y+1]],M=i[c[y+2]];(b.x-E.x)*(M.y-E.y)-(M.x-E.x)*(b.y-E.y)>0&&([c[y+1],c[y+2]]=[c[y+2],c[y+1]])}return{vertices:i,indices:c}}function GS(s){const e=(function(E,M){const R=[],z=WebGL2RenderingContext;if(E.json.textures)for(const B of E.json.textures){const j={magFilter:z.LINEAR,minFilter:z.NEAREST,wrapS:z.REPEAT,wrapT:z.REPEAT};B.sampler!==void 0&&Object.assign(j,E.json.samplers[B.sampler]),R.push({image:M[B.source],sampler:j,uploaded:!1})}return R})(s,s.images),i=(function(E,M){const R=[];for(const z of E.json.meshes){const B=[];for(const j of z.primitives)B.push(KG(j,E,M));R.push(B)}return R})(s,e),{scenes:c,scene:f,nodes:g}=s.json,y=c?c[f||0].nodes:[...g.keys()],b=[];for(const E of y)b.push(yz(g[E],s,i));return(function(E,M,R){const z={},B=new Set;for(let j=0;j<E.length;j++){const V=R[M[j]];if(!V.extras)continue;const Y=V.extras["mapbox:footprint:version"],re=V.extras["mapbox:footprint:id"];(Y||re)&&B.add(j),Y==="1.0.0"&&re&&(z[re]=j)}for(let j=0;j<E.length;j++){if(B.has(j))continue;const V=E[j],Y=R[M[j]];if(!Y.extras)continue;let re=null;V.id in z&&(re=e$(E[z[V.id]].meshes,V.localMatrix)),re||(re=JG(Y)),re&&(V.footprint=QG(re))}if(B.size>0){const j=Array.from(B.values()).sort((V,Y)=>V-Y);for(let V=j.length-1;V>=0;V--)E.splice(j[V],1)}})(b,y,s.json.nodes),b}function t$(s){s.heightmap=new Float32Array(4096),s.heightmap.fill(-1);const e=s.vertexArray.float32,i=s.aabb.min[0]-1,c=s.aabb.min[1]-1,f=ly/(s.aabb.max[0]-i+2),g=ly/(s.aabb.max[1]-c+2);for(let y=0;y<e.length;y+=3){const b=e[y+2],E=(e[y+0]-i)*f|0,M=(e[y+1]-c)*g|0;b>s.heightmap[M*ly+E]&&(s.heightmap[M*ly+E]=b)}}function vz(s,e,i,c,f){i.reserve(i.length+4*s.length),c.reserve(c.length+10*s.length),f.reserve(f.length+10*s.length);let g=c.length;for(const y of s){const b=Math.min(10,Math.max(4,1.3*y.height))*e,E=[-y.normal[1],y.normal[0],0],M=Math.min(.29,.1*y.width/y.depth),R=y.width-2*y.depth*e*(M+.01),z=ar([],y.pos,E,R/2),B=ar([],y.pos,E,-R/2),j=[z[0],z[1],z[2]+y.height],V=[B[0],B[1],B[2]+y.height],Y=ar([],y.normal,E,M);Bt(Y,Y,b);const re=ar([],y.normal,E,-M);Bt(re,re,b),Ct(Y,z,Y),Ct(re,B,re),z[2]+=.1,B[2]+=.1,c.emplaceBack(Y[0],Y[1],Y[2]),c.emplaceBack(re[0],re[1],re[2]),c.emplaceBack(z[0],z[1],z[2]),c.emplaceBack(B[0],B[1],B[2]),c.emplaceBack(j[0],j[1],j[2]),c.emplaceBack(V[0],V[1],V[2]),c.emplaceBack(z[0],z[1],z[2]),c.emplaceBack(B[0],B[1],B[2]),c.emplaceBack(Y[0],Y[1],Y[2]),c.emplaceBack(re[0],re[1],re[2]);const J=R/b/2;f.emplaceBack(-J-M,-1,J,.8),f.emplaceBack(J+M,-1,J,.8),f.emplaceBack(-J,0,J,1.3),f.emplaceBack(J,0,J,1.3),f.emplaceBack(J+M,-.8,J,.7),f.emplaceBack(J+M,-.8,J,.7),f.emplaceBack(0,0,J,1.3),f.emplaceBack(0,0,J,1.3),f.emplaceBack(J+M,-1.2,J,.8),f.emplaceBack(J+M,-1.2,J,.8),i.emplaceBack(6+g,4+g,8+g),i.emplaceBack(7+g,9+g,5+g),i.emplaceBack(0+g,1+g,2+g),i.emplaceBack(1+g,3+g,2+g),g+=10}}function r$(s,e){const i={};i.indexArray=new pa,i.vertexArray=new tl,i.colorArray=new Yl,vz(s,e,i.indexArray,i.vertexArray,i.colorArray);const c={defined:!0};c.emissiveFactor=Cn.black;const f={};return f.baseColorFactor=Cn.white,c.pbrMetallicRoughness=f,i.material=c,i.aabb=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),i}const xz=en([{name:"a_pos_3f",components:3,type:"Float32"}]),n$=en([{name:"a_normal_3",components:3,type:"Int16"}]),i$=en([{name:"a_centroid_3",components:3,type:"Int16"}]),bz=en([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),a$=en([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),o$=en([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),s$=en([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),l$=en([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),c$=en([{name:"a_flood_light_wall_radius_1i16",components:1,type:"Uint16"}]),wz=tn.types,r2=32767;function u$(s,e){const i=Gt+e;for(const c of s)for(const f of c)if(f.x<-e||f.x>i||f.y<-e||f.y>i)return!1;return!0}function h$(s){switch(s){case"flat":return 3;case"hipped":return 1;case"gabled":return 2;case"parapet":return 0;case"mansard":return 4;case"skillion":return 5;case"pyramidal":return 6;default:throw new Error(`Unknown roof shape: ${s}`)}}class $S{constructor(){this.layoutVertexArray=new tl,this.layoutAttenuationArray=new Yl,this.layoutColorArray=new rl,this.indexArray=new pa,this.indexArrayForConflation=new pa,this.segmentsBucket=new ui}}class qS{constructor(e){this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.segmentsBucket=new ui,this.entranceBloom=new $S;const i=66560;this.layoutVertexArray=new tl,this.layoutVertexArray.reserve(i),this.layoutNormalArray=new Zl,this.layoutNormalArray.reserve(i),this.layoutCentroidArray=new Zl,this.layoutCentroidArray.reserve(i),this.layoutColorArray=new rl,this.layoutColorArray.reserve(i),this.layoutFloodLightDataArray=new yf,this.layoutFloodLightDataArray.reserve(i),this.layoutAOArray=new Np,this.layoutAOArray.reserve(i),this.indexArray=new pa,this.indexArray.reserve(66560),this.indexArrayForConflation=new pa,this.segmentsBucket=new ui,this.entranceBloom=new $S,e&&(this.layoutFacadePaintArray=new rl,this.layoutFacadeDataArray=new cd,this.layoutFacadeVerticalRangeArray=new rl)}reserve(e,i,c){this.layoutVertexArray.reserveForAdditional(e),this.layoutCentroidArray.reserveForAdditional(e),this.layoutFloodLightDataArray.reserveForAdditional(e),this.layoutNormalArray.reserveForAdditional(e),this.layoutAOArray.reserveForAdditional(e),this.layoutColorArray.reserveForAdditional(e),this.indexArray.reserveForAdditional(i),c&&(this.layoutFacadePaintArray.reserveForAdditional(e),this.layoutFacadeDataArray.reserveForAdditional(e),this.layoutFacadeVerticalRangeArray.reserveForAdditional(e))}}class Az{constructor(e){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.footprintsVertices=new dh,this.footprintsIndices=new yf,this.footprintsMin=new yt(1/0,1/0),this.footprintsMax=new yt(-1/0,-1/0),this.featuresOnBorder=[],this.buildingWithoutFacade=new qS(!1),this.buildingWithFacade=new qS(!0),this.indexArrayForConflationUploaded=!1,this.featureFootprintLookup=new Map,this.buildingIds=new Set,this.footprintLookup={},this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.hasPattern=!1,this.worldview=e.worldview,this.lut=e.lut,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut}),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection,this.groundEffect=new Oi(e),this.groundEffect.groundRadiusArray=new ja,this.hasAppearances=null}updateFootprints(e,i){const c=new ny([],[],1),f={vertices:[],indices:new Uint32Array(0),grid:c,min:this.footprintsMin,max:this.footprintsMax,buildingIds:this.buildingIds};i.push({footprint:f,id:e})}updateAppearances(e,i,c,f){}prepare(){return(function(){if(Zw!=null||KR!=null)return null;if(qv!=null)return qv;const e=fetch(ya.BUILDING_GEN_URL);return qv=(function(i){let c,f,g,y,b;function E(){c=new Uint8Array(b.buffer),f=new Int16Array(b.buffer),g=new Int32Array(b.buffer),y=new Float32Array(b.buffer)}function M(){throw new Error("Unexpected BuildingGen error.")}const R=()=>{},z={a:{a:M,f:function(B){const j=c.length,V=Math.max(B>>>0,Math.ceil(1.2*j)),Y=Math.ceil((V-j)/65536);try{return b.grow(Y),E(),!0}catch{return!1}},g:M,b:R,c:R,d:R,e:R}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(i,z):i.then(B=>B.arrayBuffer()).then(B=>WebAssembly.instantiate(B,z))).then(B=>{const j=B.instance.exports;return(0,j.g)(),b=j.f,E(),new LG({setStyle:j.h,setAOOptions:j.i,setMetricOptions:j.j,setStructuralOptions:j.k,setFacadeOptions:j.l,setFauxFacadeOptions:j.m,setFacadeClassifierOptions:j.n,addFeature:j.o,addFacade:j.p,generateMesh:j.q,getLastError:j.r,getOuterRingLength:j.s,getMeshCount:j.t,getPositionsPtr:j.u,getPositionsLength:j.v,getNormalsPtr:j.w,getNormalsLength:j.x,getAOPtr:j.y,getAOLength:j.z,getUVPtr:j.A,getUVLength:j.B,getFauxFacadePtr:j.C,getFauxFacadeLength:j.D,getIndicesPtr:j.E,getIndicesLength:j.F,getBuildingPart:j.G,getRingCount:j.H,getRingPtr:j.I,getRingLength:j.J,malloc:j.K,free:j.L,heapU8:c,heap16:f,heap32:g,heapF32:y})})})(e).then(i=>(qv=null,Zw=i,Zw)).catch(i=>{br("Could not load building-gen"),qv=null,KR=i}),qv})()}populate(e,i,c,f){const g=BG();if(!g)return;const y=zt(c);this.tileToMeter=y,this.brightness=i.brightness,g.setStyle({normalScale:[1,-1,y],tileToMeters:y}),g.setAOOptions(!1,.3),g.setMetricOptions(!1,16),g.setStructuralOptions(!0),g.setFacadeClassifierOptions(3);const b=new Map,E=new Map;let M=0;for(const{feature:J}of e){if(wz[J.type]!=="LineString"){b.set(J.id,J.properties.source_id);continue}const oe=this.layers[0]._featureFilter.needGeometry;if(oe&&!this.layers[0]._featureFilter.filter(new In(this.zoom),J,c))continue;const ce=Vr(J,oe);if(!oe&&!this.layers[0]._featureFilter.filter(new In(this.zoom),ce,c))continue;const pe=oe?ce.geometry:Ir(J,c,f),Se=[];for(const Oe of pe)for(const ke of Oe)Se.push(ke.x),Se.push(ke.y);const we={coordinates:Se,crossPerc:J.properties.cross_perc,distanceToRoad:J.properties.distance_to_road,entrances:J.properties.entrances,sourceId:0},Ie=J.properties.source_id;let Pe=E.get(Ie);Pe||(Pe=[],E.set(Ie,Pe)),Pe.push(we),++M}this.maxHeight=0;const R=new Array,z=new Set,B=J=>{J!=null&&z.add(J)},j=(J,oe)=>{J!=null&&R.push({buildingId:J,footprintIndex:oe})},V=64*(e.length-M),Y=V/2;this.buildingWithFacade.reserve(V,Y,!0),this.buildingWithoutFacade.reserve(2*V,2*Y,!1),this.footprintsIndices.reserve(16*(e.length-M)),this.footprintsVertices.reserve(8*(e.length-M));for(const{feature:J,id:oe,index:ce,sourceLayerIndex:pe}of e){if(wz[J.type]==="LineString")continue;const Se=this.layers[0]._featureFilter.needGeometry;if(Se&&!this.layers[0]._featureFilter.filter(new In(this.zoom),J,c))continue;let we=null;if(J.properties&&J.properties.hasOwnProperty("building_id")&&(we=Number(J.properties.building_id),z.has(we)))continue;const Ie=Vr(J,Se);if(!Se&&!this.layers[0]._featureFilter.filter(new In(this.zoom),Ie,c))continue;const Pe=Se?Ie.geometry:Ir(J,c,f),Oe=J_(Pe,500);let ke=!1;for(const Kr of Oe)if(Kr.length!==1){ke=!0;break}if(ke){B(we);continue}if(!u$(Pe,163)){B(we);continue}const Ge=this.layers[0],pt=h$(Ge.layout.get("building-roof-shape").evaluate(J,{},c)),ct=Ge.layout.get("building-base").evaluate(J,{},c),dt=Ge.layout.get("building-height").evaluate(J,{},c),St=Ge.layout.get("building-flood-light-ground-radius").evaluate(J,{},c),At=Ge.paint.get("building-ambient-occlusion-intensity"),Tt=St/this.tileToMeter;J.properties["building-part"]="roof";const lt=Ge.paint.get("building-color").evaluate(J,{},this.canonical).toPremultipliedRenderColor(this.lut),Ot=Ge.paint.get("building-emissive-strength").evaluate(J,{},this.canonical);J.properties["building-part"]="wall";const xt=Ge.paint.get("building-color").evaluate(J,{},this.canonical).toPremultipliedRenderColor(this.lut),It=Ge.paint.get("building-emissive-strength").evaluate(J,{},this.canonical);J.properties["building-part"]="window";const Et=Ge.paint.get("building-color").evaluate(J,{},this.canonical).toPremultipliedRenderColor(this.lut),rr=Ge.paint.get("building-emissive-strength").evaluate(J,{},this.canonical);J.properties["building-part"]="door";const nr=Ge.paint.get("building-color").evaluate(J,{},this.canonical).toPremultipliedRenderColor(this.lut),Ht=Ge.paint.get("building-emissive-strength").evaluate(J,{},this.canonical);let Yt=Ge.layout.get("building-flood-light-wall-radius").evaluate(J,{},c);Yt=Ee(Yt,0,2048);const wr=Yt/2048*r2,gr=b.get(oe),tr=E.get(gr)||[],Fr=tr.length!==0&&Ge.layout.get("building-facade").evaluate(J,{},c);g.setFacadeOptions(4,!0),g.setFauxFacadeOptions(Fr,!1,1);let nn=0,On=0,Yr=0,Hn=0,gn=0,ta=0,vn=0,Un=0,bi=0,Di=0,Ri=0;if(Fr){let Kr=Math.round(Ge.layout.get("building-facade-floors").evaluate(J,{},c));if(ct===0){Kr=Math.max(1,Kr-(tr.length>0?1:0));let na=4;if(dt>100){const Ga=[10,13,15];na=Ga[J.id?J.id%Ga.length:0]}else dt<=10&&(na=3);g.setFacadeOptions(na,!0),gn=(dt<15?1.3:1.61803)*na/y}else gn=ct/y;ta=dt/y,gn=Math.min(gn,ta),Yr=Ge.layout.get("building-facade-unit-width").evaluate(J,{},c)/y,Hn=(ta-gn)/Kr,g.setFauxFacadeOptions(!0,!0,Yr);const uo=Ge.layout.get("building-facade-window").evaluate(J,{},c);nn=uo[0],On=uo[1],vn=Math.floor(65535*Math.min(1,gn/Gt)),Un=Math.floor(65535*Math.min(1,ta/Gt)),bi=Math.floor(255*nn)<<8|Math.floor(255*On),Di=Math.floor(65535*Math.min(1,Yr/Gt)),Ri=Math.floor(65535*Math.min(1,Hn/Gt))}const ra=Array(Oe.length),To={x:1/0,y:1/0},es={x:-1/0,y:-1/0},Ca={x:0,y:0};let Va=0;for(let Kr=0;Kr<Oe.length;Kr++){const uo=Oe[Kr];if(uo.length>0){const na=[],Ga=Array(uo.length+1);Ga[0]=0;for(let Eu=0;Eu<uo.length;Eu++){const Tl=uo[Eu];for(let ac=0;ac<Tl.length;ac++){const ho=Tl[Tl.length-ac-1];To.x=Math.min(To.x,ho.x),To.y=Math.min(To.y,ho.y),es.x=Math.max(es.x,ho.x),es.y=Math.max(es.y,ho.y),Ca.x+=ho.x,Ca.y+=ho.y,Va++,na.push(ho.x),na.push(ho.y)}Ga[Eu+1]=na.length}ra[Kr]={id:J.id?J.id:0,height:dt,minHeight:ct,sourceId:0,roofType:pt,coordinates:na,ringIndices:Ga}}}Ca.x/=Va||1,Ca.y/=Va||1;const eo=g.generateMesh(ra,tr);if(typeof eo=="string"){br(`Unable to generate building ${J.id}: ${eo}`),B(we);continue}if(eo.meshes.length===0||eo.modifiedPolygonRings.length===0){B(we);continue}const Xr=Fr?this.buildingWithFacade:this.buildingWithoutFacade;let zi=0;for(const Kr of eo.meshes)zi+=Kr.positions.length/3;const $i=Xr.segmentsBucket.prepareSegment(zi,Xr.layoutVertexArray,Xr.indexArray),ic=[];let js=null,So=0,Us=-1;const Df=Xr.layoutVertexArray.length,vs=Df+zi;Xr.layoutVertexArray.resize(vs),Xr.layoutCentroidArray.resize(vs),Xr.layoutNormalArray.resize(vs),Xr.layoutAOArray.resize(vs),Xr.layoutColorArray.resize(vs),Xr.layoutFloodLightDataArray.resize(vs),Fr&&(Xr.layoutFacadePaintArray.resize(vs),Xr.layoutFacadeDataArray.resize(vs),Xr.layoutFacadeVerticalRangeArray.resize(vs));const M2=Xr.indexArray.length;let i0=0,al=Df;for(const Kr of eo.meshes){let uo,na;if(Kr.buildingPart===1)uo=lt,na=Ot;else if(Kr.buildingPart===0)uo=xt,na=It;else if(Kr.buildingPart===2)uo=Et,na=rr;else{if(Kr.buildingPart!==3)continue;uo=nr,na=Ht}if(na=Ee(na,0,1),Kr.buildingPart===3){const Ia=new Array;for(let bs=0;bs<Kr.positions.length;bs+=12){const Cg=Kr.positions[bs+0],Mo=Kr.positions[bs+1],Sl=Kr.positions[bs+3],bh=Kr.positions[bs+4],Lf=Kr.positions[bs+2],IE=Kr.positions[bs+8]-Lf,PE=1,M1=Sl-Cg,o0=bh-Mo,Ed=Math.hypot(M1,o0);Ia.push({pos:[Cg+.5*M1,Mo+.5*o0,Lf],normal:[o0/Ed,-M1/Ed,0],width:Ed,height:IE,depth:PE,points:[Cg,Mo,Sl,bh]})}const Eo=Xr.entranceBloom.segmentsBucket.prepareSegment(10*Ia.length,Xr.entranceBloom.layoutVertexArray,Xr.entranceBloom.indexArray),$a=Xr.entranceBloom.layoutVertexArray.length;So=Xr.entranceBloom.indexArray.length,vz(Ia,.5/this.tileToMeter,Xr.entranceBloom.indexArray,Xr.entranceBloom.layoutVertexArray,Xr.entranceBloom.layoutAttenuationArray);const xs=Xr.entranceBloom.layoutVertexArray.length-$a;Us=Xr.entranceBloom.indexArray.length-So;for(let bs=0;bs<xs;bs++)Xr.entranceBloom.layoutColorArray.emplaceBack(255*nr.r<<8|255*nr.g,255*nr.b<<8|51*Ht);Eo.vertexLength+=xs,Eo.primitiveLength+=Us,js={part:Kr.buildingPart,vertexOffset:$a,vertexLength:xs}}Xr.layoutVertexArray.float32.set(Kr.positions,3*al);const Ga=Kr.positions.length/3;for(let Ia=0;Ia<Ga;++Ia){const Eo=3*Ia;i0=Math.max(i0,Kr.positions[Eo+2]);const $a=Kr.normals[Eo+1]*r2,xs=Kr.normals[Eo+2]*r2,bs=3*(al+Ia);Xr.layoutNormalArray.int16[bs]=Kr.normals[Eo]*r2,Xr.layoutNormalArray.int16[bs+1]=$a,Xr.layoutNormalArray.int16[bs+2]=xs;const Cg=Kr.ao[Ia];Xr.layoutAOArray.uint8[al+Ia]=255*Cg;const Mo=1+(Cg-1)*At,Sl=255*uo.b*Mo<<8|255*na;Xr.layoutColorArray.uint16[2*(al+Ia)]=255*uo.r*Mo<<8|255*uo.g*Mo,Xr.layoutColorArray.uint16[2*(al+Ia)+1]=Sl}const Eu=Math.floor(Ca.x),Tl=Math.floor(Ca.y),ac=Math.floor(dt);for(let Ia=0;Ia<Ga;++Ia){const Eo=3*(al+Ia);Xr.layoutCentroidArray.int16[Eo]=Eu,Xr.layoutCentroidArray.int16[Eo+1]=Tl,Xr.layoutCentroidArray.int16[Eo+2]=ac}if(Xr.layoutFloodLightDataArray.uint16.fill(Kr.buildingPart===0?wr:0,al,al+Ga),Fr){const Ia=255*Et.r<<8|255*Et.g,Eo=255*Et.b<<8|255*rr;for(let $a=0;$a<Ga;++$a){const xs=2*(al+$a);Xr.layoutFacadePaintArray.uint16[xs]=Ia,Xr.layoutFacadePaintArray.uint16[xs+1]=Eo}for(let $a=0;$a<Ga;++$a)if(Kr.isFauxFacade[$a]){const xs=Math.min(65535,Math.floor(Kr.uv[2*$a]*eo.outerRingLength));Xr.layoutFacadeDataArray.emplace(al+$a,1|xs,bi,Di,Ri),Xr.layoutFacadeVerticalRangeArray.emplace(al+$a,vn,Un)}else Xr.layoutFacadeDataArray.emplace(al+$a,0,0,0,0),Xr.layoutFacadeVerticalRangeArray.emplace(al+$a,0,0)}const ho=$i.vertexLength,E1=Kr.indices.length/3,zf=Xr.indexArray.length;Xr.indexArray.resize(zf+E1);for(let Ia=0;Ia<E1;++Ia){const Eo=3*Ia,$a=3*zf+Eo;Xr.indexArray.uint16[$a]=ho+Kr.indices[Eo],Xr.indexArray.uint16[$a+1]=ho+Kr.indices[Eo+1],Xr.indexArray.uint16[$a+2]=ho+Kr.indices[Eo+2]}Kr.buildingPart!==1&&Kr.buildingPart!==0&&Kr.buildingPart!==2&&Kr.buildingPart!==3||ic.push({part:Kr.buildingPart,vertexOffset:al,vertexLength:Kr.positions.length/3}),al+=Ga,$i.vertexLength+=Ga,$i.primitiveLength+=Kr.indices.length/3}this.maxHeight=Math.max(this.maxHeight,i0);const O2=Xr.indexArray.length-M2,Rf=this.footprintsIndices.length,Qp=this.footprintsVertices.length,Og=[],Su=new yt(1/0,1/0),xh=new yt(-1/0,-1/0),S1=this.groundEffect.vertexArray.length;for(const Kr of eo.modifiedPolygonRings){const uo=[],na=new yt(1/0,1/0),Ga=new yt(-1/0,-1/0);for(let Eu=0;Eu<Kr.length;Eu+=2){const Tl=Kr.length-Eu-2;na.x=Math.min(na.x,Kr[Tl]),na.y=Math.min(na.y,Kr[Tl+1]),Ga.x=Math.max(Ga.x,Kr[Tl]),Ga.y=Math.max(Ga.y,Kr[Tl+1]);const ac=new yt(Kr[Tl],Kr[Tl+1]);uo.push(ac),Og.push(ac.x,ac.y),this.footprintsVertices.emplaceBack(ac.x,ac.y)}Su.x=Math.min(Su.x,na.x),Su.y=Math.min(Su.y,na.y),xh.x=Math.max(xh.x,Ga.x),xh.y=Math.max(xh.y,Ga.y),this.groundEffect.addData(uo,[na,Ga],Tt)}const a0=this.groundEffect.vertexArray.length-S1;this.groundEffect.groundRadiusArray.reserveForAdditional(a0);for(let Kr=0;Kr<a0;Kr++)this.groundEffect.groundRadiusArray.emplaceBack(St);(To.x<0||es.x>Gt||To.y<0||es.y>Gt)&&this.featuresOnBorder.push({featureId:J.id,footprintIndex:this.footprints.length});{const Kr=tc(Og,null,2);this.footprintsIndices.resize(this.footprintsIndices.length+Kr.length),this.footprintsIndices.uint16.set(Kr,Rf),this.buildingIds.add(we??J.id),this.footprintsMin.x=Math.min(this.footprintsMin.x,Su.x),this.footprintsMin.y=Math.min(this.footprintsMin.y,Su.y),this.footprintsMax.x=Math.max(this.footprintsMax.x,xh.x),this.footprintsMax.y=Math.max(this.footprintsMax.y,xh.y);const uo={footprintVertexOffset:Qp,footprintVertexLength:this.footprintsVertices.length-Qp,footprintIndexOffset:Rf,footprintIndexLength:this.footprintsIndices.length-Rf,min:Su,max:xh,hiddenFlags:0,indicesOffset:M2,indicesLength:O2,bloomIndicesOffset:So,bloomIndicesLength:Us,groundEffectVertexOffset:S1,groundEffectVertexLength:a0,hasFauxFacade:Fr,height:i0,promoteId:oe,feature:Ie,parts:ic,buildingBloom:js},na=this.footprints.length;J.id!==void 0&&this.featureFootprintLookup.set(J.id,na),j(we,na),this.footprints.push(uo)}this.programConfigurations.populatePaintArrays(Xr.layoutVertexArray.length,J,ce,{},i.availableImages,c,i.brightness),this.groundEffect.addPaintPropertiesData(J,ce,{},i.availableImages,c,i.brightness),i.featureIndex.insert(J,Pe,ce,pe,this.index,Df)}R.forEach(({buildingId:J,footprintIndex:oe})=>{z.has(J)&&(this.footprints[oe].hiddenFlags|=4)});const re=new Set;this.buildingIds.forEach((J,oe,ce)=>{z.has(J)||re.add(J)}),this.buildingIds=re,this.groundEffect.prepareBorderSegments()}update(e,i,c,f,g,y,b){this.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b),this.groundEffect.update(e,i,g,c,f,y,b),this.evaluate(this.layers[0],e),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){const i=c=>{c.layoutVertexBuffer=e.createVertexBuffer(c.layoutVertexArray,xz.members),c.layoutNormalBuffer=e.createVertexBuffer(c.layoutNormalArray,n$.members),c.layoutCentroidBuffer=e.createVertexBuffer(c.layoutCentroidArray,i$.members),c.layoutFloodLightDataBuffer=e.createVertexBuffer(c.layoutFloodLightDataArray,c$.members),c.layoutFacadeDataArray&&c.layoutFacadeDataArray.length&&(c.layoutFacadeDataBuffer=e.createVertexBuffer(c.layoutFacadeDataArray,o$.members)),c.layoutFacadeVerticalRangeArray&&c.layoutFacadeVerticalRangeArray.length&&(c.layoutFacadeVerticalRangeBuffer=e.createVertexBuffer(c.layoutFacadeVerticalRangeArray,s$.members)),c.entranceBloom.layoutVertexArray.length&&(c.entranceBloom.layoutVertexBuffer=e.createVertexBuffer(c.entranceBloom.layoutVertexArray,xz.members),c.entranceBloom.layoutAttenuationBuffer=e.createVertexBuffer(c.entranceBloom.layoutAttenuationArray,l$.members)),this.uploadUpdatedColorBuffer(e),this.uploadUpdatedIndexBuffer(e)};this.uploaded||(i(this.buildingWithoutFacade),i(this.buildingWithFacade),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){const e=i=>{i.layoutVertexBuffer&&(i.layoutVertexBuffer.destroy(),i.layoutNormalBuffer.destroy(),i.layoutColorBuffer.destroy(),i.segmentsBucket.destroy(),i.indexBuffer&&i.indexBuffer.destroy(),i.entranceBloom.layoutVertexBuffer&&(i.entranceBloom.layoutVertexBuffer.destroy(),i.entranceBloom.layoutColorBuffer.destroy(),i.entranceBloom.layoutAttenuationBuffer.destroy(),i.entranceBloom.indexBuffer.destroy(),i.entranceBloom.segmentsBucket.destroy()))};e(this.buildingWithoutFacade),e(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(e,i,c=!0){let f=!1;const g=c?i:0,y=0|(c?-1:~i);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const b of e){const E=this.footprints[b],M=E.hiddenFlags&y|g;E.hiddenFlags!==M&&(E.hiddenFlags=M,f=!0,this.groundEffect.updateHiddenByLandmarkRange(E.groundEffectVertexOffset,E.groundEffectVertexLength,E.hiddenFlags!==0))}return f&&(this.indexArrayForConflationUploaded=!1),f}uploadUpdatedIndexBuffer(e){if(this.groundEffect.uploadHiddenByLandmark(e),this.indexArrayForConflationUploaded)return;const i=f=>{f.indexArray.length!==0&&(f.indexArrayForConflation.resize(f.indexArray.length),f.indexArrayForConflation.uint16.set(f.indexArray.uint16),f.entranceBloom.indexArrayForConflation.resize(f.entranceBloom.indexArray.length),f.entranceBloom.indexArrayForConflation.uint16.set(f.entranceBloom.indexArray.uint16))};i(this.buildingWithoutFacade),i(this.buildingWithFacade);for(const f of this.footprints){const g=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,y=f.indicesOffset+f.indicesLength;if(f.hiddenFlags!==0){for(let E=f.indicesOffset;E<y;E++)g.indexArrayForConflation.uint16[3*E+0]=0,g.indexArrayForConflation.uint16[3*E+1]=0,g.indexArrayForConflation.uint16[3*E+2]=0;const b=f.bloomIndicesOffset+f.bloomIndicesLength;for(let E=f.bloomIndicesOffset;E<b;E++)g.entranceBloom.indexArrayForConflation.uint16[3*E+0]=0,g.entranceBloom.indexArrayForConflation.uint16[3*E+1]=0,g.entranceBloom.indexArrayForConflation.uint16[3*E+2]=0}}const c=f=>{f.indexArray.length!==0&&(f.indexBuffer?f.indexBuffer.updateData(f.indexArrayForConflation):f.indexBuffer=e.createIndexBuffer(f.indexArrayForConflation,!0),f.entranceBloom.indexBuffer?f.entranceBloom.indexBuffer.updateData(f.entranceBloom.indexArrayForConflation):f.entranceBloom.indexBuffer=e.createIndexBuffer(f.entranceBloom.indexArrayForConflation,!0))};c(this.buildingWithoutFacade),c(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(e){const i=c=>{c.layoutColorBuffer?c.layoutColorBuffer.updateData(c.layoutColorArray):c.layoutColorBuffer=e.createVertexBuffer(c.layoutColorArray,bz.members,!0),c.layoutFacadePaintArray&&(c.layoutFacadePaintBuffer?c.layoutFacadePaintBuffer.updateData(c.layoutFacadePaintArray):c.layoutFacadePaintBuffer=e.createVertexBuffer(c.layoutFacadePaintArray,a$.members,!0)),c.entranceBloom.layoutColorBuffer?c.entranceBloom.layoutColorBuffer.updateData(c.entranceBloom.layoutColorArray):c.entranceBloom.layoutColorBuffer=e.createVertexBuffer(c.entranceBloom.layoutColorArray,bz.members,!0)};i(this.buildingWithoutFacade),i(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(e,i){const c=e.paint.get("building-ambient-occlusion-intensity");for(const f of this.footprints){if(4&f.hiddenFlags)continue;const g=i[f.promoteId],y=f.feature;y.properties["building-part"]="roof";const b=e.paint.get("building-color").evaluate(y,g,this.canonical).toPremultipliedRenderColor(this.lut),E=e.paint.get("building-emissive-strength").evaluate(y,g,this.canonical);y.properties["building-part"]="wall";const M=e.paint.get("building-color").evaluate(y,g,this.canonical).toPremultipliedRenderColor(this.lut),R=e.paint.get("building-emissive-strength").evaluate(y,g,this.canonical);y.properties["building-part"]="window";const z=e.paint.get("building-color").evaluate(y,g,this.canonical).toPremultipliedRenderColor(this.lut),B=e.paint.get("building-emissive-strength").evaluate(y,g,this.canonical);y.properties["building-part"]="door";const j=e.paint.get("building-color").evaluate(y,g,this.canonical).toPremultipliedRenderColor(this.lut),V=e.paint.get("building-emissive-strength").evaluate(y,g,this.canonical),Y=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const J of f.parts){let oe,ce=b;J.part===1?(ce=b,oe=E):J.part===0?(ce=M,oe=R):J.part===2?(ce=z,oe=B):J.part===3&&(ce=j,oe=V),oe=Ee(oe,0,1);for(let pe=0;pe<J.vertexLength;pe++){const Se=J.vertexOffset+pe,we=1+(Y.layoutAOArray.uint8[Se]/255-1)*c;Y.layoutColorArray.emplace(Se,ce.r*we*255<<8|ce.g*we*255,ce.b*we*255<<8|255*oe),f.hasFauxFacade&&Y.layoutFacadePaintArray.emplace(Se,255*z.r<<8|255*z.g,255*z.b<<8|255*B)}}const re=f.buildingBloom;if(re)for(let J=0;J<re.vertexLength;J++)Y.entranceBloom.layoutColorArray.emplace(re.vertexOffset+J,255*j.r<<8|255*j.g,255*j.b<<8|51*V)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(e,i,c){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const f=i.getReplacementRegionsForTile(e.toUnwrapped());if(d(this.activeReplacements,f))return;this.activeReplacements=f;for(const y of this.footprints)y.hiddenFlags&=-2;const g=[];for(const y of this.activeReplacements){if(y.order<c)continue;const b=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-e.canonical.z));for(const E of this.footprints)E.min.x>y.max.x||E.max.x<y.min.x||E.min.y>y.max.y||E.max.y<y.min.y||(g.length=0,f$(this.footprintsVertices,E.footprintVertexOffset,E.footprintVertexLength,y.footprintTileId.canonical,e.canonical,g),P(y.footprint,g,this.footprintsIndices.uint16,E.footprintIndexOffset,E.footprintIndexLength,0,-b)&&(E.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const y of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(y.groundEffectVertexOffset,y.groundEffectVertexLength,y.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getFootprint(e){if(e.id!==void 0){const i=this.featureFootprintLookup.get(e.id);return this.footprints[i]}return null}getHeightAtTileCoord(e,i){let c=Number.NEGATIVE_INFINITY,f=!0;const g=4*(e+Gt)*Gt+(i+Gt);if(this.footprintLookup.hasOwnProperty(g)){const b=this.footprintLookup[g];return b?{height:b.height,hidden:b.hiddenFlags!==0}:void 0}const y=new yt(e,i);for(const b of this.footprints)e>b.max.x||b.min.x>e||i>b.max.y||b.min.y>i||b.height<=c||d$(y,this.footprintsVertices.float32.subarray(2*b.footprintVertexOffset,2*(b.footprintVertexOffset+b.footprintVertexLength)),this.footprintsIndices.uint16.subarray(b.footprintIndexOffset,b.footprintIndexOffset+b.footprintIndexLength))&&(c=b.height,this.footprintLookup[g]=b,f=b.hiddenFlags!==0);if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:f};this.footprintLookup[g]=void 0}}function d$(s,e,i){for(let c=0;c<i.length;c+=3){const f=i[c],g=i[c+1],y=i[c+2],b=e[2*f+0],E=e[2*f+1],M=e[2*g+0],R=e[2*g+1],z=e[2*y+0],B=e[2*y+1],j=(b-z)*(s.y-B)-(E-B)*(s.x-z),V=(M-b)*(s.y-E)-(R-E)*(s.x-b);if(j<0!=V<0&&j!==0&&V!==0)continue;const Y=(z-M)*(s.y-R)-(B-R)*(s.x-M);if(Y===0||Y<0==j+V<=0)return!0}return!1}function f$(s,e,i,c,f,g){const y=Math.pow(2,c.z-f.z);for(let b=0;b<i;b++){let E=s.float32[2*(b+e)+0],M=s.float32[2*(b+e)+1];E=(E+f.x*Gt)*y-c.x*Gt,M=(M+f.y*Gt)*y-c.y*Gt,g.push(new yt(E,M))}}let Tz,Sz;jt(Az,"BuildingBucket",{omit:["layers"]}),jt(qS,"BuildingGeometry"),jt($S,"BuildingBloomGeometry");const p$=en([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),m$=en([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:g$}=p$,_$=en([{name:"a_packed",components:3,type:"Float32"}]),{members:y$}=_$,v$=en([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:x$}=v$;class Ez{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new mh({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const c=this.getKey(e,i);return this.positions[c]}trim(){const e=this.width,i=this.height=vt(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,c){const f=[];let g=e.length%2==1?-e[e.length-1]*c:0,y=e[0]*c,b=!0;f.push({left:g,right:y,isDash:b,zeroLength:e[0]===0});let E=e[0];for(let M=1;M<e.length;M++){b=!b;const R=e[M];g=E*c,E+=R,y=E*c,f.push({left:g,right:y,isDash:b,zeroLength:R===0})}return f}addRoundDash(e,i,c){const f=i/2;for(let g=-c;g<=c;g++){const y=this.width*(this.nextRow+c+g);let b=0,E=e[b];for(let M=0;M<this.width;M++){M/E.right>1&&(E=e[++b]);const R=Math.abs(M-E.left),z=Math.abs(M-E.right),B=Math.min(R,z);let j;const V=g/c*(f+1);if(E.isDash){const Y=f-Math.abs(V);j=Math.sqrt(B*B+Y*Y)}else j=f-Math.sqrt(B*B+V*V);this.image.data[y+M]=Math.max(0,Math.min(255,j+128))}}}addRegularDash(e,i){for(let E=e.length-1;E>=0;--E){const M=e[E],R=e[E+1];M.zeroLength?e.splice(E,1):R&&R.isDash===M.isDash&&(R.left=M.left,e.splice(E,1))}const c=e[0],f=e[e.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const g=this.width*this.nextRow;let y=0,b=e[y];for(let E=0;E<this.width;E++){E/b.right>1&&(b=e[++y]);const M=Math.abs(E-b.left),R=Math.abs(E-b.right),z=Math.min(M,R);this.image.data[g+E]=Math.max(0,Math.min(255,(b.isDash?z:-z)+i+128))}}addDash(e,i){const c=this.getKey(e,i);if(this.positions[c])return this.positions[c];const f=i==="round",g=f?7:0,y=2*g+1;if(this.nextRow+y>this.height)return br("LineAtlas out of space"),null;e.length===0&&e.push(1);let b=0;for(let R=0;R<e.length;R++)e[R]<0&&(br("Negative value is found in line dasharray, replacing values with 0"),e[R]=0),b+=e[R];if(b!==0){const R=this.width/b,z=this.getDashRanges(e,this.width,R);f?this.addRoundDash(z,R,g):this.addRegularDash(z,i==="square"?.5*R:0)}const E=this.nextRow+g;this.nextRow+=y;const M={tl:[E,g],br:[b,0]};return this.positions[c]=M,M}}jt(Ez,"LineAtlas");const b$=tn.types,w$=Math.cos(Math.PI/180*37.5),A$=Math.cos(Math.PI/180*5);class HS{constructor(e){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=e.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=e.overscaling,this.pixelRatio=e.pixelRatio,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new oo,this.layoutVertexArray2=new tl,this.patternVertexArray=new tl,this.indexArray=new pa,this.programConfigurations=new N(e.layers,{zoom:e.zoom,lut:e.lut}),this.segments=new ui,this.maxLineLength=0,this.zOffsetVertexArray=new tl,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.tessellationStep=e.tessellationStep?e.tessellationStep:128,this.worldview=e.worldview,this.hasAppearances=null}updateFootprints(e,i){}updateAppearances(e,i,c,f){}populate(e,i,c,f){this.hasPattern=jx("line",this.layers,this.pixelRatio,i);const g=this.layers[0].layout.get("line-sort-key");this.tileToMeter=zt(c);const y=this.layers[0].layout.get("line-elevation-reference");if(y==="hd-road-markup")this.elevationType="road";else{const B=this.layers[0].layout.get("line-z-offset"),j=B.isConstant()&&!B.constantOr(0);this.elevationType=y!=="sea"&&y!=="ground"&&j?"none":"offset",this.elevationType==="offset"&&y==="none"&&br(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const b=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&b!==void 0;const E=[];for(const{feature:B,id:j,index:V,sourceLayerIndex:Y}of e){const re=this.layers[0]._featureFilter.needGeometry,J=Vr(B,re);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),J,c))continue;const oe=g?g.evaluate(J,{},c):void 0,ce={id:j,properties:B.properties,type:B.type,sourceLayerIndex:Y,index:V,geometry:re?J.geometry:Ir(B,c,f),patterns:{},sortKey:oe};E.push(ce)}g&&E.sort((B,j)=>B.sortKey-j.sortKey);const{lineAtlas:M,featureIndex:R}=i,z=this.addConstantDashes(M);for(const B of E){const{geometry:j,index:V,sourceLayerIndex:Y}=B;if(z&&this.addFeatureDashes(B,M),this.hasPattern){const re=Ux("line",this.layers,B,this.zoom,this.pixelRatio,i);this.patternFeatures.push(re)}else this.addFeature(B,j,V,c,M.positions,i.availableImages,i.brightness,i.elevationFeatures);R.insert(e[V].feature,j,V,Y,this.index)}}addConstantDashes(e){let i=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,g=c.layout.get("line-cap").value;if(f.kind!=="constant"||g.kind!=="constant")i=!0;else{const y=g.value,b=f.value;if(!b)continue;e.addDash(b,y)}}return i}addFeatureDashes(e,i){const c=this.zoom;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,y=f.layout.get("line-cap").value;if(g.kind==="constant"&&y.kind==="constant")continue;let b,E;if(g.kind==="constant"){if(b=g.value,!b)continue}else b=g.evaluate({zoom:c},e);E=y.kind==="constant"?y.value:y.evaluate({zoom:c},e),i.addDash(b,E),e.patterns[f.id]=[i.getKey(b,E)]}}update(e,i,c,f,g,y,b,E){this.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,E)}addFeatures(e,i,c,f,g,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,i,c,f,y,e.elevationFeatures)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,y$)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=e.createVertexBuffer(this.patternVertexArray,x$)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,m$.members,!0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,g$),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e,i){let c,f;if(i&&i>0?(c=`mapbox_clip_start_${i}`,f=`mapbox_clip_end_${i}`):(c="mapbox_clip_start",f="mapbox_clip_end"),e.properties&&e.properties.hasOwnProperty(c)&&e.properties.hasOwnProperty(f))return{start:+e.properties[c],end:+e.properties[f]}}addFeature(e,i,c,f,g,y,b,E){const M=this.layers[0].layout,R=M.get("line-join").evaluate(e,{}),z=M.get("line-cap").evaluate(e,{}),B=M.get("line-miter-limit"),j=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(e),this.lineFeature=e;const V=!(!e.properties||!e.properties.hasOwnProperty("mapbox_line_metrics"))&&e.properties.mapbox_line_metrics;this.zOffsetValue=M.get("line-z-offset").value;const Y=this.layers[0].paint.get("line-width").value;if(Y.kind!=="constant"&&Y.isLineProgressConstant===!1&&(this.variableWidthValue=Y),this.elevationType==="road"){const re=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(e,i,f,E,R,z,B,j)){const[J,oe]=this.clipRuntimeLinesToTile(i,1);for(let ce=0;ce<J.length;ce++){const pe=J[ce],Se=oe[ce],we={progress:{min:Se.progress.min,max:Se.progress.max},nextDir:this.computeSegNextDir(Se,pe),prevDir:this.computeSegPrevDir(Se,pe)};this.addLine(pe,e,f,R,z,B,j,we,V&&Se.parentIndex>0?Se.parentIndex:null)}this.fillNonElevatedRoadSegment(re)}}else for(let re=0;re<i.length;re++)this.addLine(i[re],e,f,R,z,B,j,void 0,V&&re>0?re:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,g,y,f,b,void 0,this.worldview)}computeSegNextDir(e,i){return e.nextPoint.sub(i.at(-2)).unit()}computeSegPrevDir(e,i){return i[1].sub(e.prevPoint).unit()}clipLinesToTile(e,i){return Hw(e,-i,-i,Gt+i,Gt+i)}clipRuntimeLinesToTile(e,i){const c=[];return[Hw(e,-i,-i,Gt+i,Gt+i,c),c]}addElevatedRoadFeature(e,i,c,f,g,y,b,E){const M=[],R=so.getElevationFeature(e,f);if(R){const z=this.clipLinesToTile(i,1),B=this.prepareElevatedLines(z,R,c);for(const j of B)M.push({geometry:j,elevation:R,elevationTileID:c,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(M.length===0)return!1;for(const z of M){const B=this.layoutVertexArray.length;this.addLine(z.geometry,e,c,g,y,b,E);const j=new Fs(c,z.elevationTileID);if(z.elevation)for(let V=B;V<this.layoutVertexArray.length;V++){const Y=new yt(this.layoutVertexArray.int16[6*V]>>1,this.layoutVertexArray.int16[6*V+1]>>1),re=j.pointElevation(Y,z.elevation,.05);this.updateHeightRange(re),this.zOffsetVertexArray.emplaceBack(re,0,0)}else this.fillNonElevatedRoadSegment(B)}return!0}prepareElevatedLines(e,i,c){if(i.constantHeight!=null)return e;const f=[],g=1/zt(c);for(const y of e)PG(y,new ms(i,g),0,f);return f}fillNonElevatedRoadSegment(e){for(let i=e;i<this.layoutVertexArray.length;i++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(e){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,e),this.heightRange.max=Math.max(this.heightRange.max,e)):this.heightRange={min:e,max:e}}addLine(e,i,c,f,g,y,b,E,M){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=M?this.lineFeatureClips(i,M):this.lineClips;const R=f==="none";this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const z=E&&E.progress.min>0,B=E&&E.progress.max<1;if(this.lineClips){let Oe={min:this.lineClips.start,max:this.lineClips.end},ke=1;if(E){const ct=this.lineClips.end-this.lineClips.start;Oe=(function(dt,St,At){return{min:Ba(dt.min,St,At),max:Ba(dt.max,St,At)}})(E.progress,{min:0,max:1},Oe),ct>0&&(ke=(Oe.max-Oe.min)/ct)}const Ge=+i.properties.mapbox_clip_feature_len,pt=+i.properties.mapbox_clip_seg_len;if(Number.isNaN(Ge)||Number.isNaN(pt)){for(let dt=0;dt<e.length-1;dt++)this.totalDistance+=e[dt].dist(e[dt+1]);const ct=this.totalDistance/(Oe.max-Oe.min);this.totalFeatureLength=Number.isFinite(ct)?ct:0,this.lineClips.start=Oe.min,this.lineClips.end=Oe.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ge,this.distance=pt*ke,this.lineClips.start=Oe.min,this.lineClips.end=Oe.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const j=b$[i.type]==="Polygon";let V=e.length;for(;V>=2&&e[V-1].equals(e[V-2]);)V--;let Y=0;for(;Y<V-1&&e[Y].equals(e[Y+1]);)Y++;if(V<(j?3:2))return;f==="bevel"&&(y=1.05);const re=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray);let J,oe,ce,pe,Se,we,Ie,Pe;E&&E.prevDir&&(we=E.prevDir.perp()),E&&E.nextDir&&(Ie=E.nextDir.perp()),this.e1=this.e2=-1,j&&(J=e[V-2],Se=e[Y].sub(J)._unit()._perp());for(let Oe=Y;Oe<V;Oe++){if(ce=Oe===V-1?j?e[Y+1]:void 0:e[Oe+1],ce&&e[Oe].equals(ce))continue;Se&&(pe=Se),J&&(oe=J),J=e[Oe],Pe=this.evaluateLineProgressFeatures(oe?oe.dist(J):0),Se=ce?ce.sub(J)._unit()._perp():pe,pe=pe||Se;const ke=oe&&ce;let Ge=ke?f:j||R?"butt":g;const pt=pe.x*Se.x+pe.y*Se.y;if(R){const xt=function(It){if(It.patternJoinNone){const Et=It.segmentPoints.length/2,rr=It.lineSoFar-It.segmentStart;for(let nr=0;nr<Et;++nr){const Ht=It.segmentPoints[2*nr+1],Yt=Math.round(It.segmentPoints[2*nr])+.5+.25*Ht;It.patternVertexArray.emplaceBack(Yt,rr,It.segmentStart),It.patternVertexArray.emplaceBack(Yt,rr,It.segmentStart)}It.segmentPoints.length=0}It.e1=It.e2=-1};if(ke&&pt<A$){this.updateDistance(oe,J),this.addCurrentVertex(J,pe,1,1,re,Pe),xt(this),this.addCurrentVertex(J,Se,-1,-1,re,Pe);continue}if(oe){if(!ce){this.updateDistance(oe,J),this.addCurrentVertex(J,pe,1,1,re,Pe),xt(this);continue}Ge="miter"}}let ct=pe.add(Se);ct.x===0&&ct.y===0||ct._unit();const dt=ct.x*Se.x+ct.y*Se.y,St=dt!==0?1/dt:1/0,At=2*Math.sqrt(2-2*dt),Tt=dt<w$&&oe&&ce,lt=pe.x*Se.y-pe.y*Se.x>0,Ot=this.overscaling<=16?122880/(512*this.overscaling):0;if(ke&&Ge==="round"){if(St<b)Ge="miter";else if(St<=2){const xt=XS(J,-10,8202);Ge=this.elevationType==="offset"&&(xt||this.hasCrossSlope)?"miter":"fakeround"}}if(Ge==="miter"&&St>y&&(Ge="bevel"),Ge==="bevel"&&(St>2&&(Ge="flipbevel"),St<y&&(Ge="miter")),oe&&!(Ge==="miter"&&Tt)&&this.updateDistance(oe,J),Ge==="miter")if(Tt){const xt=J.dist(oe);if(xt>2*Ot){const Et=J.sub(J.sub(oe)._mult(Ot/xt)._round());this.updateDistance(oe,Et),this.addCurrentVertex(Et,pe,0,0,re,Pe),oe=Et}this.updateDistance(oe,J),ct._mult(St),this.addCurrentVertex(J,ct,0,0,re,Pe);const It=J.dist(ce);if(It>2*Ot){const Et=J.add(ce.sub(J)._mult(Ot/It)._round());this.updateDistance(J,Et),this.addCurrentVertex(Et,Se,0,0,re,Pe),J=Et}}else ct._mult(St),this.addCurrentVertex(J,ct,0,0,re,Pe);else if(Ge==="flipbevel"){if(St>100)ct=Se.mult(-1);else{const xt=St*pe.add(Se).mag()/pe.sub(Se).mag();ct._perp()._mult(xt*(lt?-1:1))}this.addCurrentVertex(J,ct,0,0,re,Pe),this.addCurrentVertex(J,ct.mult(-1),0,0,re,Pe)}else if(Ge==="bevel"||Ge==="fakeround"){Pe!=null&&oe&&this.addCurrentVertex(J,Ie||pe,-1,-1,re,Pe);const xt=J.dist(oe)<=2*Ot&&Ge!=="bevel",It=ct.mult(lt?1:-1);It._mult(St);const Et=Se.mult(lt?-1:1),rr=pe.mult(lt?-1:1),nr=this.evaluateLineProgressFeatures(this.distance);if(Pe==null&&(this.addHalfVertex(J,It.x,It.y,!1,!lt,0,re,nr),xt||this.addHalfVertex(J,It.x+2*rr.x,It.y+2*rr.y,!1,lt,0,re,nr)),Ge==="fakeround"){const Ht=Math.round(180*At/Math.PI/20);this.addHalfVertex(J,rr.x,rr.y,!1,lt,0,re,nr);for(let Yt=0;Yt<Ht;Yt++){let wr=Yt/Ht;if(wr!==.5){const tr=wr-.5;wr+=wr*tr*(wr-1)*((1.0904+pt*(pt*(3.55645-1.43519*pt)-3.2452))*tr*tr+(.848013+pt*(.215638*pt-1.06021)))}const gr=Et.sub(rr)._mult(wr)._add(rr)._unit();this.addHalfVertex(J,gr.x,gr.y,!1,lt,0,re,nr)}this.addHalfVertex(J,Et.x,Et.y,!1,lt,0,re,nr)}xt||Pe!=null||this.addHalfVertex(J,It.x+2*Et.x,It.y+2*Et.y,!1,lt,0,re,nr),Pe!=null&&ce&&this.addCurrentVertex(J,we||Se,1,1,re,Pe)}else if(Ge==="butt")this.addCurrentVertex(J,ct,0,0,re,Pe);else if(Ge==="square"){if(!oe){const xt=z?0:-1;this.addCurrentVertex(J,ct,xt,xt,re,Pe)}if(this.addCurrentVertex(J,ct,0,0,re,Pe),oe){const xt=B?0:1;this.addCurrentVertex(J,ct,xt,xt,re,Pe)}}else if(Ge==="round"){if(oe){const xt=!ke&&Ie?Ie:pe;this.addCurrentVertex(J,xt,0,0,re,Pe),!ke&&B||this.addCurrentVertex(J,xt,1,1,re,Pe,!0)}if(ce){const xt=!ke&&we?we:Se;!ke&&z||this.addCurrentVertex(J,xt,-1,-1,re,Pe,!0),this.addCurrentVertex(J,xt,0,0,re,Pe)}}}}addVerticesTo(e,i,c,f,g,y,b,E,M,R){const z=(i.w-e.w)/this.tessellationStep|0;let B=0;const j=this.scaledDistance;if(z>1){this.lineSoFar=e.w;const Y=(i.x-e.x)/z,re=(i.y-e.y)/z,J=(i.z-e.z)/z,oe=(i.w-e.w)/z;for(let ce=1;ce<z;++ce){e.x+=Y,e.y+=re,e.z+=J,this.lineSoFar+=oe,B+=oe;const pe=this.evaluateLineProgressFeatures(this.prevDistance+B);this.scaledDistance=(this.prevDistance+B)/this.totalDistance,this.addHalfVertex(e,c,f,R,!1,b,M,pe),this.addHalfVertex(e,g,y,R,!0,-E,M,pe)}}this.lineSoFar=i.w,this.scaledDistance=j;const V=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(i,c,f,R,!1,b,M,V),this.addHalfVertex(i,g,y,R,!0,-E,M,V)}evaluateLineProgressFeatures(e){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+e)/this.totalFeatureLength):br(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let i=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(i=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:i}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:i}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:i}}addCurrentVertex(e,i,c,f,g,y,b=!1){const E=i.x+i.y*c,M=i.y-i.x*c,R=i.y*f-i.x,z=-i.y-i.x*f;if(y!=null){const B=this.elevationType==="offset",j=-10,V=8202,Y=y.zOffset,re=new VR(e.x,e.y,Y,this.lineSoFar),J=!!B&&XS(e,j,V),oe=this.lineSoFar,ce=this.distance;if(this.currentVertex)if(J){const pe=this.currentVertexIsOutside,Se=this.currentVertex,we=new VR(e.x,e.y,Y,this.lineSoFar);if($R(Se,we,j,V),!XS(we,j,V)){if(pe){this.e1=this.e2=-1,this.distance-=Se.dist(re),this.lineSoFar=Se.w;const Ie=this.evaluateLineProgressFeatures(Se.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Se,E,M,b,!1,c,g,Ie),this.addHalfVertex(Se,R,z,b,!0,-f,g,Ie),this.prevDistance=this.distance}this.distance=this.prevDistance+Se.dist(we),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Se,we,E,M,R,z,c,f,g,b),this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}}else{const pe=this.currentVertex;if(this.currentVertexIsOutside){$R(pe,re,j,V),this.e1=this.e2=-1,this.distance-=pe.dist(re),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=pe.w;const Se=this.evaluateLineProgressFeatures(pe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(pe,E,M,b,!1,c,g,Se),this.addHalfVertex(pe,R,z,b,!0,-f,g,Se),this.prevDistance=this.distance,this.distance=ce,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(pe,re,E,M,R,z,c,f,g,b)}else J||(this.addHalfVertex(e,E,M,b,!1,c,g,y),this.addHalfVertex(e,R,z,b,!0,-f,g,y));this.currentVertex=re,this.currentVertexIsOutside=J,this.lineSoFar=oe}else this.addHalfVertex(e,E,M,b,!1,c,g,y),this.addHalfVertex(e,R,z,b,!0,-f,g,y)}addHalfVertex({x:e,y:i},c,f,g,y,b,E,M){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),y||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((e<<1)+(g?1:0),(i<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const z=Dr(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,z)}const R=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),E.primitiveLength++),y?this.e2=R:this.e1=R,M!=null&&this.zOffsetVertexArray.emplaceBack(M.zOffset,M.variableWidth,M.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(e,i){this.prevDistance=this.distance,this.distance+=e.dist(i),this.updateScaledDistance()}}function XS(s,e,i){return s.x<e||s.x>i||s.y<e||s.y>i}let Mz,Oz;function Cz(s,e,i){return e*(Gt/(s.tileSize*Math.pow(2,i-s.tileID.overscaledZ)))}jt(HS,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Iz=(s,e,i)=>(1-i)*s+i*e;function Pz(s,e){return 1/Cz(s,1,e.tileZoom)}function Dz(s,e,i,c){return s.translatePosMatrix(c||e.tileID.projMatrix,e,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"))}const Rz=s=>{const e=[];zz(s)&&e.push("RENDER_LINE_DASH"),s.paint.get("line-gradient")&&e.push("RENDER_LINE_GRADIENT");const i=s.paint.get("line-trim-offset");i[0]===0&&i[1]===0||e.push("RENDER_LINE_TRIM_OFFSET"),s.paint.get("line-border-width").constantOr(1)!==0&&e.push("RENDER_LINE_BORDER");const c=s.layout.get("line-join").constantOr("miter")==="none",f=!!s.paint.get("line-pattern").constantOr(1);return c&&f&&e.push("LINE_JOIN_NONE"),e};function zz(s){const e=s.paint.get("line-dasharray").value;return e.kind!=="constant"||e.value}let ZS;const Lz=()=>ZS||(ZS={layout:Mz||(Mz=new vi({"line-cap":new Qt(Ye.layout_line["line-cap"]),"line-join":new Qt(Ye.layout_line["line-join"]),"line-miter-limit":new Ft(Ye.layout_line["line-miter-limit"]),"line-round-limit":new Ft(Ye.layout_line["line-round-limit"]),"line-sort-key":new Qt(Ye.layout_line["line-sort-key"]),"line-z-offset":new Qt(Ye.layout_line["line-z-offset"]),"line-elevation-reference":new Ft(Ye.layout_line["line-elevation-reference"]),"line-cross-slope":new Ft(Ye.layout_line["line-cross-slope"]),visibility:new Ft(Ye.layout_line.visibility),"line-width-unit":new Ft(Ye.layout_line["line-width-unit"])})),paint:Oz||(Oz=new vi({"line-opacity":new Qt(Ye.paint_line["line-opacity"]),"line-color":new Qt(Ye.paint_line["line-color"]),"line-translate":new Ft(Ye.paint_line["line-translate"]),"line-translate-anchor":new Ft(Ye.paint_line["line-translate-anchor"]),"line-width":new Qt(Ye.paint_line["line-width"]),"line-gap-width":new Qt(Ye.paint_line["line-gap-width"]),"line-offset":new Qt(Ye.paint_line["line-offset"]),"line-blur":new Qt(Ye.paint_line["line-blur"]),"line-dasharray":new Qt(Ye.paint_line["line-dasharray"]),"line-pattern":new Qt(Ye.paint_line["line-pattern"]),"line-pattern-cross-fade":new Ft(Ye.paint_line["line-pattern-cross-fade"]),"line-gradient":new sd(Ye.paint_line["line-gradient"]),"line-trim-offset":new Ft(Ye.paint_line["line-trim-offset"]),"line-trim-fade-range":new Ft(Ye.paint_line["line-trim-fade-range"]),"line-trim-color":new Ft(Ye.paint_line["line-trim-color"]),"line-emissive-strength":new Qt(Ye.paint_line["line-emissive-strength"]),"line-border-width":new Qt(Ye.paint_line["line-border-width"]),"line-border-color":new Qt(Ye.paint_line["line-border-color"]),"line-occlusion-opacity":new Ft(Ye.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},ZS);class T$ extends Qt{possiblyEvaluate(e,i){return i=new In(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition,worldview:i.worldview}),super.possiblyEvaluate(e,i)}evaluate(e,i,c,f){return i=Object.assign({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(e,i,c,f)}}let i1;function Bz(s,e){return e>0?e+2*s:s}const S$=en([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),E$=en([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),M$=en([{name:"a_projected_pos",components:4,type:"Float32"}],4);en([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const O$=en([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),C$=en([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),I$=en([{name:"a_texb",components:2,type:"Uint16"}]),P$=en([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),D$=en([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);en([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const kz=en([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),R$=en([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);en([{name:"triangle",components:3,type:"Uint16"}]),en([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),en([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),en([{type:"Float32",name:"offsetX"}]),en([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var co=24;function z$(s,e,i){return s.sections.forEach(c=>{c.text=(function(f,g,y){const b=g.layout.get("text-transform").evaluate(y,{});return b==="uppercase"?f=f.toLocaleUpperCase():b==="lowercase"&&(f=f.toLocaleLowerCase()),zs.applyArabicShaping&&(f=zs.applyArabicShaping(f)),f})(c.text,e,i)}),s}const a1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function L$(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function B$(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}const WS=4294967296,Fz=1/WS,Nz=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let n2=class{constructor(s=new Uint8Array(16)){this.buf=ArrayBuffer.isView(s)?s:new Uint8Array(s),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(s,e,i=this.length){for(;this.pos<i;){const c=this.readVarint(),f=c>>3,g=this.pos;this.type=7&c,s(f,e,this),this.pos===g&&this.skip(c)}return e}readMessage(s,e){return this.readFields(s,e,this.readVarint()+this.pos)}readFixed32(){const s=this.dataView.getUint32(this.pos,!0);return this.pos+=4,s}readSFixed32(){const s=this.dataView.getInt32(this.pos,!0);return this.pos+=4,s}readFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*WS;return this.pos+=8,s}readSFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*WS;return this.pos+=8,s}readFloat(){const s=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,s}readDouble(){const s=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,s}readVarint(s){const e=this.buf;let i,c;return c=e[this.pos++],i=127&c,c<128?i:(c=e[this.pos++],i|=(127&c)<<7,c<128?i:(c=e[this.pos++],i|=(127&c)<<14,c<128?i:(c=e[this.pos++],i|=(127&c)<<21,c<128?i:(c=e[this.pos],i|=(15&c)<<28,(function(f,g,y){const b=y.buf;let E,M;if(M=b[y.pos++],E=(112&M)>>4,M<128||(M=b[y.pos++],E|=(127&M)<<3,M<128)||(M=b[y.pos++],E|=(127&M)<<10,M<128)||(M=b[y.pos++],E|=(127&M)<<17,M<128)||(M=b[y.pos++],E|=(127&M)<<24,M<128)||(M=b[y.pos++],E|=(1&M)<<31,M<128))return Xv(f,E,g);throw new Error("Expected varint not more than 10 bytes")})(i,s,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const s=this.readVarint();return s%2==1?(s+1)/-2:s/2}readBoolean(){return!!this.readVarint()}readString(){const s=this.readVarint()+this.pos,e=this.pos;return this.pos=s,s-e>=12&&Nz?Nz.decode(this.buf.subarray(e,s)):(function(i,c,f){let g="",y=c;for(;y<f;){const b=i[y];let E,M,R,z=null,B=b>239?4:b>223?3:b>191?2:1;if(y+B>f)break;B===1?b<128&&(z=b):B===2?(E=i[y+1],(192&E)==128&&(z=(31&b)<<6|63&E,z<=127&&(z=null))):B===3?(E=i[y+1],M=i[y+2],(192&E)==128&&(192&M)==128&&(z=(15&b)<<12|(63&E)<<6|63&M,(z<=2047||z>=55296&&z<=57343)&&(z=null))):B===4&&(E=i[y+1],M=i[y+2],R=i[y+3],(192&E)==128&&(192&M)==128&&(192&R)==128&&(z=(15&b)<<18|(63&E)<<12|(63&M)<<6|63&R,(z<=65535||z>=1114112)&&(z=null))),z===null?(z=65533,B=1):z>65535&&(z-=65536,g+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),g+=String.fromCharCode(z),y+=B}return g})(this.buf,e,s)}readBytes(){const s=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,s);return this.pos=s,e}readPackedVarint(s=[],e){const i=this.readPackedEnd();for(;this.pos<i;)s.push(this.readVarint(e));return s}readPackedSVarint(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readSVarint());return s}readPackedBoolean(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readBoolean());return s}readPackedFloat(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readFloat());return s}readPackedDouble(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readDouble());return s}readPackedFixed32(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readFixed32());return s}readPackedSFixed32(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readSFixed32());return s}readPackedFixed64(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readFixed64());return s}readPackedSFixed64(s=[]){const e=this.readPackedEnd();for(;this.pos<e;)s.push(this.readSFixed64());return s}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(s){const e=7&s;if(e===0)for(;this.buf[this.pos++]>127;);else if(e===2)this.pos=this.readVarint()+this.pos;else if(e===5)this.pos+=4;else{if(e!==1)throw new Error(`Unimplemented type: ${e}`);this.pos+=8}}writeTag(s,e){this.writeVarint(s<<3|e)}realloc(s){let e=this.length||16;for(;e<this.pos+s;)e*=2;if(e!==this.length){const i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeSFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*Fz),!0),this.pos+=8}writeSFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*Fz),!0),this.pos+=8}writeVarint(s){(s=+s||0)>268435455||s<0?(function(e,i){let c,f;if(e>=0?(c=e%4294967296|0,f=e/4294967296|0):(c=~(-e%4294967296),f=~(-e/4294967296),4294967295^c?c=c+1|0:(c=0,f=f+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),(function(g,y,b){b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,b.buf[b.pos]=127&(g>>>=7)})(c,0,i),(function(g,y){const b=(7&g)<<4;y.buf[y.pos++]|=b|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))})(f,i)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))}writeSVarint(s){this.writeVarint(s<0?2*-s-1:2*s)}writeBoolean(s){this.writeVarint(+s)}writeString(s){s=String(s),this.realloc(4*s.length),this.pos++;const e=this.pos;this.pos=(function(c,f,g){for(let y,b,E=0;E<f.length;E++){if(y=f.charCodeAt(E),y>55295&&y<57344){if(!b){y>56319||E+1===f.length?(c[g++]=239,c[g++]=191,c[g++]=189):b=y;continue}if(y<56320){c[g++]=239,c[g++]=191,c[g++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(c[g++]=239,c[g++]=191,c[g++]=189,b=null);y<128?c[g++]=y:(y<2048?c[g++]=y>>6|192:(y<65536?c[g++]=y>>12|224:(c[g++]=y>>18|240,c[g++]=y>>12&63|128),c[g++]=y>>6&63|128),c[g++]=63&y|128)}return g})(this.buf,s,this.pos);const i=this.pos-e;i>=128&&jz(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i}writeFloat(s){this.realloc(4),this.dataView.setFloat32(this.pos,s,!0),this.pos+=4}writeDouble(s){this.realloc(8),this.dataView.setFloat64(this.pos,s,!0),this.pos+=8}writeBytes(s){const e=s.length;this.writeVarint(e),this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=s[i]}writeRawMessage(s,e){this.pos++;const i=this.pos;s(e,this);const c=this.pos-i;c>=128&&jz(i,c,this),this.pos=i-1,this.writeVarint(c),this.pos+=c}writeMessage(s,e,i){this.writeTag(s,2),this.writeRawMessage(e,i)}writePackedVarint(s,e){e.length&&this.writeMessage(s,k$,e)}writePackedSVarint(s,e){e.length&&this.writeMessage(s,F$,e)}writePackedBoolean(s,e){e.length&&this.writeMessage(s,U$,e)}writePackedFloat(s,e){e.length&&this.writeMessage(s,N$,e)}writePackedDouble(s,e){e.length&&this.writeMessage(s,j$,e)}writePackedFixed32(s,e){e.length&&this.writeMessage(s,V$,e)}writePackedSFixed32(s,e){e.length&&this.writeMessage(s,G$,e)}writePackedFixed64(s,e){e.length&&this.writeMessage(s,$$,e)}writePackedSFixed64(s,e){e.length&&this.writeMessage(s,q$,e)}writeBytesField(s,e){this.writeTag(s,2),this.writeBytes(e)}writeFixed32Field(s,e){this.writeTag(s,5),this.writeFixed32(e)}writeSFixed32Field(s,e){this.writeTag(s,5),this.writeSFixed32(e)}writeFixed64Field(s,e){this.writeTag(s,1),this.writeFixed64(e)}writeSFixed64Field(s,e){this.writeTag(s,1),this.writeSFixed64(e)}writeVarintField(s,e){this.writeTag(s,0),this.writeVarint(e)}writeSVarintField(s,e){this.writeTag(s,0),this.writeSVarint(e)}writeStringField(s,e){this.writeTag(s,2),this.writeString(e)}writeFloatField(s,e){this.writeTag(s,5),this.writeFloat(e)}writeDoubleField(s,e){this.writeTag(s,1),this.writeDouble(e)}writeBooleanField(s,e){this.writeVarintField(s,+e)}};function Xv(s,e,i){return i?4294967296*e+(s>>>0):4294967296*(e>>>0)+(s>>>0)}function jz(s,e,i){const c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(c);for(let f=i.pos-1;f>=s;f--)i.buf[f+c]=i.buf[f]}function k$(s,e){for(let i=0;i<s.length;i++)e.writeVarint(s[i])}function F$(s,e){for(let i=0;i<s.length;i++)e.writeSVarint(s[i])}function N$(s,e){for(let i=0;i<s.length;i++)e.writeFloat(s[i])}function j$(s,e){for(let i=0;i<s.length;i++)e.writeDouble(s[i])}function U$(s,e){for(let i=0;i<s.length;i++)e.writeBoolean(s[i])}function V$(s,e){for(let i=0;i<s.length;i++)e.writeFixed32(s[i])}function G$(s,e){for(let i=0;i<s.length;i++)e.writeSFixed32(s[i])}function $$(s,e){for(let i=0;i<s.length;i++)e.writeFixed64(s[i])}function q$(s,e){for(let i=0;i<s.length;i++)e.writeSFixed64(s[i])}function H$(s,e,i){e.glyphs=[],s===1&&i.readMessage(X$,e)}function X$(s,e,i){if(s===3){const{id:c,bitmap:f,width:g,height:y,left:b,top:E,advance:M}=i.readMessage(Z$,{});e.glyphs.push({id:c,bitmap:new mh({width:g+6,height:y+6},f),metrics:{width:g,height:y,left:b,top:E,advance:M}})}else s===4?e.ascender=i.readSVarint():s===5&&(e.descender=i.readSVarint())}function Z$(s,e,i){s===1?e.id=i.readVarint():s===2?e.bitmap=i.readBytes():s===3?e.width=i.readVarint():s===4?e.height=i.readVarint():s===5?e.left=i.readSVarint():s===6?e.top=i.readSVarint():s===7&&(e.advance=i.readVarint())}const nc={horizontal:1,vertical:2,horizontalOnly:3};class o1{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(e,i){const c=new o1;return c.scale=e||1,c.fontStack=i,c}static forImage(e){const i=new o1;return i.image=e,i}}class Zv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i,c){const f=new Zv;for(let g=0;g<e.sections.length;g++){const y=e.sections[g];y.image?f.addImageSection(y,c):f.addTextSection(y,i)}return f}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=(function(i,c){let f="";for(let g=0;g<i.length;g++){const y=i.charCodeAt(g+1)||null,b=i.charCodeAt(g-1)||null;f+=!c&&(y&&b_(y)&&!a1[i[g+1]]||b&&b_(b)&&!a1[i[g-1]])||!a1[i[g]]?i[g]:a1[i[g]]}return f})(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&i2[this.text.charCodeAt(c)];c++)e++;let i=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&i2[this.text.charCodeAt(c)];c--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const c=new Zv;return c.text=this.text.substring(e,i),c.sectionIndex=this.sectionIndex.slice(e,i),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(o1.forText(e.scale,e.fontStack||i));const c=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(c)}addImageSection(e,i){const c=e.image?e.image.getPrimary():null;if(!c)return void br("Can't add FormattedSection with an empty image.");c.scaleSelf(i);const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(o1.forImage(c)),this.sectionIndex.push(this.sections.length-1)):br("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function YS(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y=1){const re=Zv.fromFeature(s,f,Y);z===nc.vertical&&re.verticalizePunctuation(B);let J=[];const oe=(function(Ie,Pe,Oe,ke,Ge,pt){if(!Ie)return[];const ct=[],dt=(function(Tt,lt,Ot,xt,It,Et){let rr=0;for(let nr=0;nr<Tt.length();nr++){const Ht=Tt.getSection(nr);rr+=Uz(Tt.getCodePoint(nr),Ht,xt,It,lt,Et)}return rr/Math.max(1,Math.ceil(rr/Ot))})(Ie,Pe,Oe,ke,Ge,pt),St=Ie.text.indexOf("")>=0;let At=0;for(let Tt=0;Tt<Ie.length();Tt++){const lt=Ie.getSection(Tt),Ot=Ie.getCodePoint(Tt);if(i2[Ot]||(At+=Uz(Ot,lt,ke,Ge,Pe,pt)),Tt<Ie.length()-1){const xt=v_(Ot);(W$[Ot]||xt||lt.image)&&ct.push(Gz(Tt+1,At,dt,ct,Y$(Ot,Ie.getCodePoint(Tt+1),xt&&St),!1))}}return $z(Gz(Ie.length(),At,dt,ct,0,!0))})(re,M,g,e,c,j),{processBidirectionalText:ce,processStyledBidirectionalText:pe}=zs;if(ce&&re.sections.length===1){const Ie=ce(re.toString(),oe);for(const Pe of Ie){const Oe=new Zv;Oe.text=Pe,Oe.sections=re.sections;for(let ke=0;ke<Pe.length;ke++)Oe.sectionIndex.push(0);J.push(Oe)}}else if(pe){const Ie=pe(re.text,re.sectionIndex,oe);for(const Pe of Ie){const Oe=new Zv;Oe.text=Pe[0],Oe.sectionIndex=Pe[1],Oe.sections=re.sections,J.push(Oe)}}else J=(function(Ie,Pe){const Oe=[],ke=Ie.text;let Ge=0;for(const pt of Pe)Oe.push(Ie.substring(Ge,pt)),Ge=pt;return Ge<ke.length&&Oe.push(Ie.substring(Ge,ke.length)),Oe})(re,oe);const Se=[],we={positionedLines:Se,text:re.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function(Ie,Pe,Oe,ke,Ge,pt,ct,dt,St,At,Tt,lt){let Ot=0,xt=0,It=0;const Et=dt==="right"?1:dt==="left"?0:.5;let rr=!1;for(const gr of Ge){const tr=gr.getSections();for(const Fr of tr){if(Fr.image)continue;const nn=Pe[Fr.fontStack];if(nn&&(rr=nn.ascender!==void 0&&nn.descender!==void 0,!rr))break}if(!rr)break}let nr=0;for(const gr of Ge){gr.trim();const tr=gr.getMaxScale(),Fr=(tr-1)*co,nn={positionedGlyphs:[],lineOffset:0};Ie.positionedLines[nr]=nn;const On=nn.positionedGlyphs;let Yr=0;if(!gr.length()){xt+=pt,++nr;continue}let Hn=0,gn=0;for(let vn=0;vn<gr.length();vn++){const Un=gr.getSection(vn),bi=gr.getSectionIndex(vn),Di=gr.getCodePoint(vn);let Ri=Un.scale,ra=null,To=null,es=null,Ca=co,Va=0,eo=St;eo===nc.vertical&&x_(Di)&&(eo=nc.horizontal);const Xr=!(eo===nc.horizontal||!Tt&&!Pc(Di)||Tt&&(i2[Di]||Mp(Di)));if(Un.image){const zi=ke.get(Un.image.toString());if(!zi)continue;es=Un.image,Ie.iconsInText=Ie.iconsInText||!0,To=zi.paddedRect;const $i=zi.displaySize;Ri=Ri*co/lt,ra={width:$i[0],height:$i[1],left:0,top:-3,advance:Xr?$i[1]:$i[0],localGlyph:!1},Va=rr?-ra.height*Ri:tr*co-17-$i[1]*Ri,Ca=ra.advance;const ic=(Xr?$i[0]:$i[1])*Ri-co*tr;ic>0&&ic>Yr&&(Yr=ic)}else{const zi=Oe[Un.fontStack];if(!zi)continue;zi[Di]&&(To=zi[Di]);const $i=Pe[Un.fontStack];if(!$i)continue;const ic=$i.glyphs[Di];if(!ic)continue;if(ra=ic.metrics,Ca=Di!==8203?co:0,rr){const js=$i.ascender!==void 0?Math.abs($i.ascender):0,So=$i.descender!==void 0?Math.abs($i.descender):0,Us=(js+So)*Ri;Hn<Us&&(Hn=Us,gn=(js-So)/2*Ri),Va=-js*Ri}else Va=(tr-Ri)*co-17}Xr?(Ie.verticalizable=!0,On.push({glyph:Di,image:es,x:Ot,y:xt+Va,vertical:Xr,scale:Ri,localGlyph:ra.localGlyph,fontStack:Un.fontStack,sectionIndex:bi,metrics:ra,rect:To}),Ot+=Ca*Ri+At):(On.push({glyph:Di,image:es,x:Ot,y:xt+Va,vertical:Xr,scale:Ri,localGlyph:ra.localGlyph,fontStack:Un.fontStack,sectionIndex:bi,metrics:ra,rect:To}),Ot+=ra.advance*Ri+At)}On.length!==0&&(It=Math.max(Ot-At,It),rr?qz(On,Et,Yr,gn,pt*tr/2):qz(On,Et,Yr,0,pt/2)),Ot=0;const ta=pt*tr+Yr;nn.lineOffset=Math.max(Yr,Fr),xt+=ta,++nr}const Ht=xt,{horizontalAlign:Yt,verticalAlign:wr}=KS(ct);(function(gr,tr,Fr,nn,On,Yr){const Hn=(tr-Fr)*On,gn=-Yr*nn;for(const ta of gr)for(const vn of ta.positionedGlyphs)vn.x+=Hn,vn.y+=gn})(Ie.positionedLines,Et,Yt,wr,It,Ht),Ie.top+=-wr*Ht,Ie.bottom=Ie.top+Ht,Ie.left+=-Yt*It,Ie.right=Ie.left+It,Ie.hasBaseline=rr})(we,e,i,c,J,y,b,E,z,M,B,V),!(function(Ie){for(const Pe of Ie)if(Pe.positionedGlyphs.length!==0)return!1;return!0})(Se))return we}const i2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},W$={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Uz(s,e,i,c,f,g){if(e.image){const y=c.get(e.image.toString());return y?y.displaySize[0]*e.scale*co/g+f:0}{const y=i[e.fontStack],b=y&&y.glyphs[s];return b?b.metrics.advance*e.scale+f:0}}function Vz(s,e,i,c){const f=Math.pow(s-e,2);return c?s<e?f/2:2*f:f+Math.abs(i)*i}function Y$(s,e,i){let c=0;return s===10&&(c-=1e4),i&&(c+=150),s!==40&&s!==65288||(c+=50),e!==41&&e!==65289||(c+=50),c}function Gz(s,e,i,c,f,g){let y=null,b=Vz(e,i,f,g);for(const E of c){const M=Vz(e-E.x,i,f,g)+E.badness;M<=b&&(y=E,b=M)}return{index:s,x:e,priorBreak:y,badness:b}}function $z(s){return s?$z(s.priorBreak).concat(s.index):[]}function KS(s){let e=.5,i=.5;switch(s){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function qz(s,e,i,c,f){if(!(e||i||c||f))return;const g=s.length-1,y=s[g],b=(y.x+y.metrics.advance*y.scale)*e;for(let E=0;E<=g;E++)s[E].x-=b,s[E].y+=i+c+f}function QS(s){return s.imagePrimary!==void 0&&s.top!==void 0&&s.bottom!==void 0&&s.left!==void 0&&s.right!==void 0}function a2(s,e,i,c){const{horizontalAlign:f,verticalAlign:g}=KS(c),y=i[0]-s.displaySize[0]*f,b=i[1]-s.displaySize[1]*g;return{imagePrimary:s,imageSecondary:e,top:b,bottom:b+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function JS(s,e,i,c,f,g){const y=s.imagePrimary;let b;if(y.content){const re=y.content,J=y.pixelRatio||1;b=[re[0]/J,re[1]/J,y.displaySize[0]-re[2]/J,y.displaySize[1]-re[3]/J]}const E=e.left*g,M=e.right*g;let R,z,B,j;i==="width"||i==="both"?(j=f[0]+E-c[3],z=f[0]+M+c[1]):(j=f[0]+(E+M-y.displaySize[0])/2,z=j+y.displaySize[0]);const V=e.top*g,Y=e.bottom*g;return i==="height"||i==="both"?(R=f[1]+V-c[0],B=f[1]+Y+c[2]):(R=f[1]+(V+Y-y.displaySize[1])/2,B=R+y.displaySize[1]),{imagePrimary:y,imageSecondary:void 0,top:R,right:z,bottom:B,left:j,collisionPadding:b}}function Hz(s){return!s.imagePrimary.stretchX}function Xz(s){return!s.imagePrimary.stretchY}function Zz(s){return{width:s.right-s.left,height:s.bottom-s.top}}const Yp=128;function uy(s,e,i,c){const{expression:f}=e;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new In(s+1,{worldview:i}),void 0,void 0,void 0,c)};if(f.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:y}=f;let b=0;for(;b<g.length&&g[b]<=s;)b++;b=Math.max(0,b-1);let E=b;for(;E<g.length&&g[E]<s+1;)E++;E=Math.min(g.length-1,E);const M=g[b],R=g[E];return f.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:R,interpolationType:y}:{kind:"camera",minZoom:M,maxZoom:R,minSize:f.evaluate(new In(M,{worldview:i}),void 0,void 0,void 0,c),maxSize:f.evaluate(new In(R,{worldview:i}),void 0,void 0,void 0,c),interpolationType:y}}}function eE(s,{uSize:e,uSizeT:i},{lowerSize:c,upperSize:f}){return s.kind==="source"?c/Yp:s.kind==="composite"?Dr(c/Yp,f/Yp,i):e}function Wv(s,e,i=1){let c=0,f=0;if(s.kind==="constant")f=s.layoutSize*i;else if(s.kind!=="source"){const{interpolationType:g,minZoom:y,maxZoom:b}=s,E=g?Ee(Si.interpolationFactor(g,e,y,b),0,1):0;s.kind==="camera"?f=Dr(s.minSize,s.maxSize,E)*i:c=E*i}return{uSizeT:c,uSize:f}}class Kp extends yt{constructor(e,i,c,f,g){super(e,i),this.angle=f,this.z=c,g!==void 0&&(this.segment=g)}clone(){return new Kp(this.x,this.y,this.z,this.angle,this.segment)}}function Wz(s,e,i,c,f){if(e.segment===void 0)return!0;let g=e,y=e.segment+1,b=0;for(;b>-i/2;){if(y--,y<0)return!1;b-=s[y].dist(g),g=s[y]}b+=s[y].dist(s[y+1]),y++;const E=[];let M=0;for(;b<i/2;){const R=s[y],z=s[y+1];if(!z)return!1;let B=s[y-1].angleTo(R)-R.angleTo(z);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:B}),M+=B;b-E[0].distance>c;)M-=E.shift().angleDelta;if(M>f)return!1;y++,b+=R.dist(z)}return!0}function Yz(s){let e=0;for(let i=0;i<s.length-1;i++)e+=s[i].dist(s[i+1]);return e}function Kz(s,e,i){return s?.6*e*i:0}function Qz(s,e){return Math.max(s?s.right-s.left:0,e?e.right-e.left:0)}function K$(s,e,i,c,f,g){const y=Kz(i,f,g),b=Qz(i,c)*g;let E=0;const M=Yz(s)/2;for(let R=0;R<s.length-1;R++){const z=s[R],B=s[R+1],j=z.dist(B);if(E+j>M){const V=(M-E)/j,Y=Dr(z.x,B.x,V),re=Dr(z.y,B.y,V),J=new Kp(Y,re,0,B.angleTo(z),R);return!y||Wz(s,J,b,y,e)?J:void 0}E+=j}}function Q$(s,e,i,c,f,g,y,b,E){const M=Kz(c,g,y),R=Qz(c,f),z=R*y,B=s[0].x===0||s[0].x===E||s[0].y===0||s[0].y===E;return e-z<e/4&&(e=z+e/4),Jz(s,B?e/2*b%e:(R/2+2*g)*y*b%e,e,M,i,z,B,!1,E)}function Jz(s,e,i,c,f,g,y,b,E){const M=g/2,R=Yz(s);let z=0,B=e-i,j=[];for(let V=0;V<s.length-1;V++){const Y=s[V],re=s[V+1],J=Y.dist(re),oe=re.angleTo(Y);for(;B+i<z+J;){B+=i;const ce=(B-z)/J,pe=Dr(Y.x,re.x,ce),Se=Dr(Y.y,re.y,ce);if(pe>=0&&pe<E&&Se>=0&&Se<E&&B-M>=0&&B+M<=R){const we=new Kp(pe,Se,0,oe,V);c&&!Wz(s,we,g,c,f)||j.push(we)}}z+=J}return b||j.length||y||(j=Jz(s,z/2,i,c,f,g,y,!0,E)),j}function eL(s){let e=0,i=0;for(const y of s)e+=y.w*y.h,i=Math.max(i,y.w);s.sort((y,b)=>b.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let f=0,g=0;for(const y of s)for(let b=c.length-1;b>=0;b--){const E=c[b];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,g=Math.max(g,y.y+y.h),f=Math.max(f,y.x+y.w),y.w===E.w&&y.h===E.h){const M=c.pop();M&&b<c.length&&(c[b]=M)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(c.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:f,h:g,fill:e/(f*g)||0}}jt(Kp,"Anchor");class s1{static getImagePositionScale(e,i,c){if(i&&e){const{sx:f,sy:g}=e;return{x:f,y:g}}return{x:c,y:c}}constructor(e,i,c,f){this.paddedRect=e;const{pixelRatio:g,version:y,stretchX:b,stretchY:E,content:M,sdf:R,usvg:z}=i;this.pixelRatio=g,this.stretchX=b,this.stretchY=E,this.content=M,this.version=y,this.padding=c,this.sdf=R,this.usvg=z,this.scale=s1.getImagePositionScale(f,z,g)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function tE(s,e,i){const c=Wa.parse(s),f=(function(g,y,b=[1,1]){return{x:0,y:0,w:(g.data?g.data.width:g.width*b[0])+2*y,h:(g.data?g.data.height:g.height*b[1])+2*y}})(e,i,[c.sx,c.sy]);return{bin:f,imagePosition:new s1(f,e,i,c),imageVariant:c}}class tL{constructor(e,i,c){const f=new Map,g=new Map;this.haveRenderCallbacks=[];const y=[];this.addImages(e,f,1,y),this.addImages(i,g,2,y);const{w:b,h:E}=eL(y),M=new Ja({width:b||1,height:E||1});for(const[R,z]of e.entries()){const B=f.get(R).paddedRect;Ja.copy(z.data,M,{x:0,y:0},{x:B.x+1,y:B.y+1},z.data,null,z.sdf)}for(const[R,z]of i.entries()){const B=g.get(R),j=B.paddedRect;let V=B.padding;const Y=j.x+V,re=j.y+V,J=z.data.width,oe=z.data.height;V=V>1?V-1:V,Ja.copy(z.data,M,{x:0,y:0},{x:Y,y:re},z.data,c),Ja.copy(z.data,M,{x:0,y:oe-V},{x:Y,y:re-V},{width:J,height:V},c),Ja.copy(z.data,M,{x:0,y:0},{x:Y,y:re+oe},{width:J,height:V},c),Ja.copy(z.data,M,{x:J-V,y:0},{x:Y-V,y:re},{width:V,height:oe},c),Ja.copy(z.data,M,{x:0,y:0},{x:Y+J,y:re},{width:V,height:oe},c),Ja.copy(z.data,M,{x:J-V,y:oe-V},{x:Y-V,y:re-V},{width:V,height:V},c),Ja.copy(z.data,M,{x:0,y:oe-V},{x:Y+J,y:re-V},{width:V,height:V},c),Ja.copy(z.data,M,{x:0,y:0},{x:Y+J,y:re+oe},{width:V,height:V},c),Ja.copy(z.data,M,{x:J-V,y:0},{x:Y-V,y:re+oe},{width:V,height:V},c)}this.lut=c,this.image=M,this.iconPositions=f,this.patternPositions=g}addImages(e,i,c,f){for(const[g,y]of e.entries()){const{bin:b,imagePosition:E,imageVariant:M}=tE(g,y,c);i.set(g,E),f.push(b),y.hasRenderCallback&&this.haveRenderCallbacks.push(M.id)}}patchUpdatedImages(e,i,c,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>e.hasImage(g,c)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const g of e.getUpdatedImages(c)){for(const y of this.iconPositions.keys()){const b=Wa.parse(y);if(Do.isEqual(b.id,g)){const E=e.getImage(g,c);this.patchUpdatedImage(this.iconPositions.get(y),E,i,null)}}for(const y of this.patternPositions.keys()){const b=Wa.parse(y);if(Do.isEqual(b.id,g)){const E=e.getImage(g,c);this.patchUpdatedImage(this.patternPositions.get(y),E,i,f||this.lut)}}}}patchUpdatedImage(e,i,c,f=null){if(!e||!i||e.version===i.version)return;e.version=i.version;const[g,y]=e.tl,b=e.sdf;if(this.lut||b){const E={width:i.data.width,height:i.data.height},M=new Ja(E);Ja.copy(i.data,M,{x:0,y:0},{x:0,y:0},E,f,b),c.update(M,{position:{x:g,y}})}else c.update(i.data,{position:{x:g,y}})}}jt(s1,"ImagePosition"),jt(tL,"ImageAtlas",{omit:["lut"]});const l1=1e20;function rL(s,e,i,c,f,g,y,b,E){for(let M=e;M<e+c;M++)nL(s,i*g+M,g,f,y,b,E);for(let M=i;M<i+f;M++)nL(s,M*g+e,1,c,y,b,E)}function nL(s,e,i,c,f,g,y){g[0]=0,y[0]=-l1,y[1]=l1,f[0]=s[e];for(let b=1,E=0,M=0;b<c;b++){f[b]=s[e+b*i];const R=b*b;do{const z=g[E];M=(f[b]-f[z]+R-z*z)/(b-z)/2}while(M<=y[E]&&--E>-1);E++,g[E]=b,y[E]=M,y[E+1]=l1}for(let b=0,E=0;b<c;b++){for(;y[E+1]<b;)E++;const M=g[E],R=b-M;s[e+b*i]=f[M]+R*R}}const rE={none:0,ideographs:1,all:2};class Yv{constructor(e,i,c){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=c,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const c=[],f=this.url||ya.GLYPHS_URL;for(const g in e)for(const y of e[g])c.push({stack:g,id:y});qe(c,({stack:g,id:y},b)=>{let E=this.entries[g];E||(E=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=E.glyphs[y];if(M!==void 0)return void b(null,{stack:g,id:y,glyph:M});if(M=this._tinySDF(E,g,y),M)return E.glyphs[y]=M,void b(null,{stack:g,id:y,glyph:M});const R=Math.floor(y/256);if(256*R>65535)return br("glyphs > 65535 not supported"),void b(null,{stack:g,id:y,glyph:M});if(E.ranges[R])return void b(null,{stack:g,id:y,glyph:M});let z=E.requests[R];z||(z=E.requests[R]=[],Yv.loadGlyphRange(g,R,f,this.requestManager,(B,j)=>{if(j){E.ascender=j.ascender,E.descender=j.descender;for(const V in j.glyphs)this._doesCharSupportLocalGlyph(+V)||(E.glyphs[+V]=j.glyphs[+V]);E.ranges[R]=!0}for(const V of z)V(B,j);delete E.requests[R]})),z.push((B,j)=>{B?b(B):j&&b(null,{stack:g,id:y,glyph:j.glyphs[y]||null})})},(g,y)=>{if(g)i(g);else if(y){const b={};for(const{stack:E,id:M,glyph:R}of y)b[E]===void 0&&(b[E]={}),b[E].glyphs===void 0&&(b[E].glyphs={}),b[E].glyphs[M]=R&&{id:R.id,bitmap:R.bitmap.clone(),metrics:R.metrics},b[E].ascender=this.entries[E].ascender,b[E].descender=this.entries[E].descender;i(null,b)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==rE.none&&(this.localGlyphMode===rE.all?!!this.localFontFamily:!!this.localFontFamily&&(fa(e)||Tp(e)||ah(e)||ad(e)||Ki(e)||Ya(e)||(i=e)>=131072&&i<=173791||(c=>c>=66736&&c<=66815)(e)));var i}_tinySDF(e,i,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let g=e.tinySDF;if(!g){let Y="400";/bold/i.test(i)?Y="900":/medium/i.test(i)?Y="500":/light/i.test(i)&&(Y="200"),g=e.tinySDF=new Yv.TinySDF({fontFamily:f,fontWeight:Y,fontSize:48,buffer:6,radius:16}),g.fontWeight=Y}if(this.localGlyphs[g.fontWeight][c])return this.localGlyphs[g.fontWeight][c];const y=String.fromCodePoint(c),{data:b,width:E,height:M,glyphWidth:R,glyphHeight:z,glyphLeft:B,glyphTop:j,glyphAdvance:V}=g.draw(y);return this.localGlyphs[g.fontWeight][c]={id:c,bitmap:new mh({width:E,height:M},b),metrics:{width:R/2,height:z/2,left:B/2,top:j/2-27,advance:V/2,localGlyph:!0}}}}function iL(s,e){return s+e[1]-e[0]}function nE(s,e,i,c,f=1){const g=[],y=s.imagePrimary,b=y.pixelRatio,E=y.paddedRect.w-2,M=y.paddedRect.h-2,R=(s.right-s.left)*f,z=(s.bottom-s.top)*f,B=y.stretchX||[[0,E]],j=y.stretchY||[[0,M]],V=B.reduce(iL,0),Y=j.reduce(iL,0),re=E-V,J=M-Y;let oe=0,ce=V,pe=0,Se=Y,we=0,Ie=re,Pe=0,Oe=J;if(y.content&&c){const Ge=y.content;oe=o2(B,0,Ge[0]),pe=o2(j,0,Ge[1]),ce=o2(B,Ge[0],Ge[2]),Se=o2(j,Ge[1],Ge[3]),we=Ge[0]-oe,Pe=Ge[1]-pe,Ie=Ge[2]-Ge[0]-ce,Oe=Ge[3]-Ge[1]-Se}const ke=(Ge,pt,ct,dt)=>{const St=s2(Ge.stretch-oe,ce,R,s.left*f),At=l2(Ge.fixed-we,Ie,Ge.stretch,V),Tt=s2(pt.stretch-pe,Se,z,s.top*f),lt=l2(pt.fixed-Pe,Oe,pt.stretch,Y),Ot=s2(ct.stretch-oe,ce,R,s.left*f),xt=l2(ct.fixed-we,Ie,ct.stretch,V),It=s2(dt.stretch-pe,Se,z,s.top*f),Et=l2(dt.fixed-Pe,Oe,dt.stretch,Y),rr=new yt(St,Tt),nr=new yt(Ot,Tt),Ht=new yt(Ot,It),Yt=new yt(St,It),wr=new yt(At/b,lt/b),gr=new yt(xt/b,Et/b),tr=e*Math.PI/180;if(tr){const gn=Math.sin(tr),ta=Math.cos(tr),vn=[ta,-gn,gn,ta];rr._matMult(vn),nr._matMult(vn),Yt._matMult(vn),Ht._matMult(vn)}const Fr=Ge.stretch+Ge.fixed,nn=ct.stretch+ct.fixed,On=pt.stretch+pt.fixed,Yr=dt.stretch+dt.fixed,Hn=s.imageSecondary;return{tl:rr,tr:nr,bl:Yt,br:Ht,texPrimary:{x:y.paddedRect.x+1+Fr,y:y.paddedRect.y+1+On,w:nn-Fr,h:Yr-On},texSecondary:Hn?{x:Hn.paddedRect.x+1+Fr,y:Hn.paddedRect.y+1+On,w:nn-Fr,h:Yr-On}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:wr,pixelOffsetBR:gr,minFontScaleX:Ie/b/R,minFontScaleY:Oe/b/z,isSDF:i}};if(y.stretchX||y.stretchY){const Ge=aL(B,re,V),pt=aL(j,J,Y);for(let ct=0;ct<Ge.length-1;ct++){const dt=Ge[ct],St=Ge[ct+1];for(let At=0;At<pt.length-1;At++)g.push(ke(dt,pt[At],St,pt[At+1]))}}else g.push(ke({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:M+1}));return g}function J$(s,e){const i=s.stretchY||[[0,s.paddedRect.h-2]];return s.stretchX||s.stretchY?oL(s.stretchX||[[0,s.paddedRect.w-2]])*oL(i):1}function o2(s,e,i){let c=0;for(const f of s)c+=Math.max(e,Math.min(i,f[1]))-Math.max(e,Math.min(i,f[0]));return c}function aL(s,e,i){const c=[{fixed:-1,stretch:0}];for(const[f,g]of s){const y=c[c.length-1];c.push({fixed:f-y.stretch,stretch:y.stretch}),c.push({fixed:f-y.stretch,stretch:y.stretch+(g-f)})}return c.push({fixed:e+1,stretch:i}),c}function oL(s){return 2*s.length+1}function s2(s,e,i,c){return s/e*i+c}function l2(s,e,i,c){return s-e*i/c}function eq(s,e,i,c){const f=e+s.positionedLines[c].lineOffset;return c===0?i+f/2:i+(f+(e+s.positionedLines[c-1].lineOffset))/2}function sL(s,e,i,c,f,g,y,b,E){const M=[];if(e.positionedLines.length===0)return M;const R=(E!==void 0?E:c.layout.get("text-rotate").evaluate(g,{}))*Math.PI/180,z=(function(re){const J=re[0],oe=re[1],ce=J*oe;return ce>0?[J,-oe]:ce<0?[-J,oe]:J===0?[oe,J]:[oe,-J]})(i);let B=Math.abs(e.top-e.bottom);for(const re of e.positionedLines)B-=re.lineOffset;const j=e.positionedLines.length,V=B/j;let Y=e.top-i[1];for(let re=0;re<j;++re){const J=e.positionedLines[re];Y=eq(e,V,Y,re);for(const oe of J.positionedGlyphs){if(!oe.rect)continue;const ce=oe.rect||{};let pe=4,Se=!0,we=1,Ie=0;if(oe.image){const nr=y.get(oe.image.toString());if(!nr)continue;if(nr.sdf){br("SDF images are not supported in formatted text and will be ignored.");continue}Se=!1,we=nr.pixelRatio,pe=1/we}const Pe=(f||b)&&oe.vertical,Oe=oe.metrics.advance*oe.scale/2,ke=oe.metrics,Ge=oe.rect;if(Ge===null)continue;b&&e.verticalizable&&(Ie=oe.image?Oe-oe.metrics.width*oe.scale/2:0);const pt=f?[oe.x+Oe,oe.y]:[0,0];let ct=[0,0],dt=[0,0],St=!1;f||(Pe?(dt=[oe.x+Oe+z[0],oe.y+z[1]-Ie],St=!0):ct=[oe.x+Oe+i[0],oe.y+i[1]-Ie]);const At=Ge.w*oe.scale/(we*(oe.localGlyph?2:1)),Tt=Ge.h*oe.scale/(we*(oe.localGlyph?2:1));let lt,Ot,xt,It;if(Pe){const nr=oe.y-Y,Ht=new yt(-Oe,Oe-nr),Yt=-Math.PI/2,wr=new yt(...dt);lt=new yt(-Oe+ct[0],ct[1]),lt._rotateAround(Yt,Ht)._add(wr),lt.x+=-nr+Oe,lt.y-=(ke.left-pe)*oe.scale;const gr=oe.image?ke.advance*oe.scale:co*oe.scale,tr=String.fromCodePoint(oe.glyph);L$(tr)?lt.x+=(1-pe)*oe.scale:B$(tr)?lt.x+=gr-ke.height*oe.scale+(-pe-1)*oe.scale:lt.x+=oe.image||ke.width+2*pe===Ge.w&&ke.height+2*pe===Ge.h?(gr-Tt)/2:(gr-(ke.height+2*pe)*oe.scale)/2,Ot=new yt(lt.x,lt.y-At),xt=new yt(lt.x+Tt,lt.y),It=new yt(lt.x+Tt,lt.y-At)}else{const nr=(ke.left-pe)*oe.scale-Oe+ct[0],Ht=(-ke.top-pe)*oe.scale+ct[1],Yt=nr+At,wr=Ht+Tt;lt=new yt(nr,Ht),Ot=new yt(Yt,Ht),xt=new yt(nr,wr),It=new yt(Yt,wr)}if(R){let nr;nr=f?new yt(0,0):St?new yt(z[0],z[1]):new yt(i[0],i[1]),lt._rotateAround(R,nr),Ot._rotateAround(R,nr),xt._rotateAround(R,nr),It._rotateAround(R,nr)}const Et=new yt(0,0),rr=new yt(0,0);M.push({tl:lt,tr:Ot,bl:xt,br:It,texPrimary:ce,texSecondary:void 0,writingMode:e.writingMode,glyphOffset:pt,sectionIndex:oe.sectionIndex,isSDF:Se,pixelOffsetTL:Et,pixelOffsetBR:rr,minFontScaleX:0,minFontScaleY:0})}}return M}function tq(s,e=1,i=!1){let c=1/0,f=1/0,g=-1/0,y=-1/0;const b=s[0];for(let j=0;j<b.length;j++){const V=b[j];(!j||V.x<c)&&(c=V.x),(!j||V.y<f)&&(f=V.y),(!j||V.x>g)&&(g=V.x),(!j||V.y>y)&&(y=V.y)}const E=Math.min(g-c,y-f);let M=E/2;const R=new qh([],rq);if(E===0)return new yt(c,f);for(let j=c;j<g;j+=E)for(let V=f;V<y;V+=E)R.push(new Kv(j+M,V+M,M,s));let z=(function(j){let V=0,Y=0,re=0;const J=j[0];for(let oe=0,ce=J.length,pe=ce-1;oe<ce;pe=oe++){const Se=J[oe],we=J[pe],Ie=Se.x*we.y-we.x*Se.y;Y+=(Se.x+we.x)*Ie,re+=(Se.y+we.y)*Ie,V+=3*Ie}return new Kv(Y/V,re/V,0,j)})(s),B=R.length;for(;R.length;){const j=R.pop();(j.d>z.d||!z.d)&&(z=j,i&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,B)),j.max-z.d<=e||(M=j.h/2,R.push(new Kv(j.p.x-M,j.p.y-M,M,s)),R.push(new Kv(j.p.x+M,j.p.y-M,M,s)),R.push(new Kv(j.p.x-M,j.p.y+M,M,s)),R.push(new Kv(j.p.x+M,j.p.y+M,M,s)),B+=4)}return i&&(console.log(`num probes: ${B}`),console.log(`best distance: ${z.d}`)),z.p}function rq(s,e){return e.max-s.max}Yv.loadGlyphRange=function(s,e,i,c,f){const g=256*e,y=g+255,b=c.transformRequest(c.normalizeGlyphsURL(i).replace("{fontstack}",s).replace("{range}",`${g}-${y}`),va.Glyphs);kh(b,(E,M)=>{if(E)f(E);else if(M){const R={},z=(function(B){return new n2(B).readFields(H$,{})})(M);for(const B of z.glyphs)R[B.id]=B;f(null,{glyphs:R,ascender:z.ascender,descender:z.descender})}})},Yv.TinySDF=class{constructor({fontSize:s=24,buffer:e=3,radius:i=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:g="normal",fontStyle:y="normal",lang:b=null}={}){this.buffer=e,this.cutoff=c,this.radius=i,this.lang=b;const E=this.size=s+4*e,M=this._createCanvas(E),R=this.ctx=M.getContext("2d",{willReadFrequently:!0});R.font=`${y} ${g} ${s}px ${f}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(s){const e=document.createElement("canvas");return e.width=e.height=s,e}draw(s){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:g}=this.ctx.measureText(s),y=Math.ceil(i),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-f))),E=Math.min(this.size-this.buffer,y+Math.ceil(c)),M=b+2*this.buffer,R=E+2*this.buffer,z=Math.max(M*R,0),B=new Uint8ClampedArray(z),j={data:B,width:M,height:R,glyphWidth:b,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(b===0||E===0)return j;const{ctx:V,buffer:Y,gridInner:re,gridOuter:J}=this;this.lang&&(V.lang=this.lang),V.clearRect(Y,Y,b,E),V.fillText(s,Y,Y+y);const oe=V.getImageData(Y,Y,b,E);J.fill(l1,0,z),re.fill(0,0,z);for(let ce=0;ce<E;ce++)for(let pe=0;pe<b;pe++){const Se=oe.data[4*(ce*b+pe)+3]/255;if(Se===0)continue;const we=(ce+Y)*M+pe+Y;if(Se===1)J[we]=0,re[we]=l1;else{const Ie=.5-Se;J[we]=Ie>0?Ie*Ie:0,re[we]=Ie<0?Ie*Ie:0}}rL(J,0,0,M,R,M,this.f,this.v,this.z),rL(re,Y,Y,b,E,M,this.f,this.v,this.z);for(let ce=0;ce<z;ce++){const pe=Math.sqrt(J[ce])-Math.sqrt(re[ce]);B[ce]=Math.round(255-255*(pe/this.radius+this.cutoff))}return j}};class Kv{constructor(e,i,c,f){this.p=new yt(e,i),this.h=c,this.d=(function(g,y){let b=!1,E=1/0;for(let M=0;M<y.length;M++){const R=y[M];for(let z=0,B=R.length,j=B-1;z<B;j=z++){const V=R[z],Y=R[j];V.y>g.y!=Y.y>g.y&&g.x<(Y.x-V.x)*(g.y-V.y)/(Y.y-V.y)+V.x&&(b=!b),E=Math.min(E,_d(g,V,Y))}}return(b?1:-1)*Math.sqrt(E)})(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const nq=Object.keys,iE=Number.POSITIVE_INFINITY,iq=Math.sqrt(2);function Sg(s,e,i,c,f){const g=QS(s)&&s.collisionPadding?s.collisionPadding:[0,0,0,0],y={top:s.top-g[1],bottom:s.bottom+g[3],left:s.left-g[0],right:s.right+g[2],scaled:!1};return c!==void 0&&(function(b,E){b.top*=E,b.bottom*=E,b.left*=E,b.right*=E,b.scaled=!0})(y,c),i&&(function(b,E){if(!E)return;const M=yr(E),R=new yt(b.left,b.top),z=new yt(b.right,b.top),B=new yt(b.left,b.bottom),j=new yt(b.right,b.bottom),V=new yt(0,0);R._rotateAround(M,V),z._rotateAround(M,V),B._rotateAround(M,V),j._rotateAround(M,V),b.left=Math.min(R.x,z.x,B.x,j.x),b.right=Math.max(R.x,z.x,B.x,j.x),b.top=Math.min(R.y,z.y,B.y,j.y),b.bottom=Math.max(R.y,z.y,B.y,j.y)})(y,i),f&&(y.left+=f[0],y.right+=f[0],y.top+=f[1],y.bottom+=f[1]),e?{top:Math.min(e.top,y.top),bottom:Math.max(e.bottom,y.bottom),left:Math.min(e.left,y.left),right:Math.max(e.right,y.right),scaled:e.scaled||y.scaled}:y}function lL(s,[e,i]){let c=0,f=0;if(i===iE){e<0&&(e=0);const g=e/iq;switch(s){case"top-right":case"top-left":f=g-7;break;case"bottom-right":case"bottom-left":f=7-g;break;case"bottom":f=7-e;break;case"top":f=e-7}switch(s){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=e;break;case"right":c=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),s){case"top-right":case"top-left":case"top":f=i-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-i}switch(s){case"top-right":case"bottom-right":case"right":c=-e;break;case"top-left":case"bottom-left":case"left":c=e}}return[c,f]}function aq(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V){const Y=s.layers[0],re=Y.appearances;if(re.length===0)return{iconBBox:null,iconVerticalBBox:null,textBBox:null,textVerticalBBox:null};const J={iconBBox:null,iconVerticalBBox:null},oe={textBBox:null,textVerticalBBox:null},{baseIconRotate:ce,baseTextRotate:pe,iconScaleFactor:Se}=(function(Ie,Pe,Oe){const ke=Ie.get("icon-rotate").evaluate(Pe,{},Oe),Ge=Ie.get("text-rotate").evaluate(Pe,{},Oe),[pt,ct]=Ie.get("icon-size-scale-range");return{baseIconRotate:ke,baseTextRotate:Ge,iconScaleFactor:Ee(1,pt,ct)}})(c,f,g);e&&(J.iconBBox=Sg(e,J.iconBBox,ce,y),i)&&(J.iconVerticalBBox=Sg(i,J.iconVerticalBBox,ce+90,y));const we=u2(z.horizontal);we&&(oe.textBBox=Sg(we,oe.textBBox,pe,1,j)),z.vertical&&(oe.textVerticalBBox=Sg(z.vertical,oe.textVerticalBBox,pe+90,1,j));for(const Ie of re)Ie.hasIconProperties()&&oq(J,s,Y,Ie,f,g,b,ce,y,E,e,M,Se,R,V),Ie.hasTextProperties()&&sq(oe,Y,Ie,f,g,j,pe,B,we,z.vertical);return{iconBBox:J.iconBBox,iconVerticalBBox:J.iconVerticalBBox,textBBox:oe.textBBox,textVerticalBBox:oe.textVerticalBBox}}function oq(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V){const{appearanceIconOffset:Y,appearanceIconRotate:re,appearanceIconSize:J}=cL(c,i,f,g,y,b,E,M.iconScaleFactor);let oe=null,ce=null,pe=null;c.hasProperty("icon-image")?pe=(function(Se,we,Ie,Pe,Oe,ke,Ge,pt){let ct=null;const dt=we.getAppearanceValueAndResolveTokens(Ie,"icon-image",Pe,Oe,pt);if(dt){const St=Se.getResolvedImageFromTokens(dt),At=Ie.getUnevaluatedProperty("icon-size"),Tt=c1(St,uy(Se.zoom,At,Se.worldview,pt),At,Oe,Se.zoom,Pe,Se.pixelRatio,Ge,Se.worldview,pt);ct=ke.get(Tt.iconPrimary.toString())}return ct})(e,i,c,f,g,z,B,V):R&&(pe=R.imagePrimary),pe&&(oe=a2(pe,null,Y,j),e.allowVerticalPlacement&&(ce=a2(pe,null,Y,j))),oe&&(s.iconBBox=Sg(oe,s.iconBBox,re,J)),ce&&(s.iconVerticalBBox=Sg(ce,s.iconVerticalBBox,re+90,J))}function cL(s,e,i,c,f,g,y,b){const E=s.hasProperty("icon-offset")?e.getAppearanceValueAndResolveTokens(s,"icon-offset",i,c,[]):null,M=E&&Array.isArray(E)?E:f,R=s.hasProperty("icon-rotate")?e.getAppearanceValueAndResolveTokens(s,"icon-rotate",i,c,[]):null,z=typeof R=="number"?R:g,B=s.hasProperty("icon-size")?e.getAppearanceValueAndResolveTokens(s,"icon-size",i,c,[]):null;return{appearanceIconOffset:M,appearanceIconRotate:z,appearanceIconSize:typeof B=="number"?B*b:y}}function sq(s,e,i,c,f,g,y,b,E,M){const{appearanceTextOffset:R,appearanceTextRotate:z,appearanceTextSize:B}=uL(i,e,c,f,g,y,b),j=B/b;E&&(s.textBBox=Sg(E,s.textBBox,z,j,R)),M&&(s.textVerticalBBox=Sg(M,s.textVerticalBBox,z+90,j,R))}function uL(s,e,i,c,f,g,y){const b=s.hasProperty("text-offset")?e.getAppearanceValueAndResolveTokens(s,"text-offset",i,c,[]):null,E=b&&Array.isArray(b)?[b[0]*co,b[1]*co]:f,M=s.hasProperty("text-rotate")?e.getAppearanceValueAndResolveTokens(s,"text-rotate",i,c,[]):null,R=typeof M=="number"?M:g,z=s.hasProperty("text-size")?e.getAppearanceValueAndResolveTokens(s,"text-size",i,c,[]):null;return{appearanceTextOffset:E,appearanceTextRotate:R,appearanceTextSize:typeof z=="number"?z:y}}function c2(s,e,i,c,f,g,y,b,E){if(!e||!e.usvg)return;const M=Zz(c),R=Zz(f),z=g!=="both"&&g!=="width"||!Hz(c)?1:R.width/M.width,B=g!=="both"&&g!=="height"||!Xz(c)?1:R.height/M.height;i.scaleSelf(z,B);const j=i.toString();y.set(j,i),b.set(j,e);const{imagePosition:V}=tE(j,e,1);E.set(j,V)}function hL(s,e,i,c,f,g,y,b,E,M){if(!s)return;const R=(function(z,B,j,V,Y,re,J){if(z.kind==="camera")return z.maxSize;if(z.kind==="composite"){const oe=B.possiblyEvaluate(new In(z.maxZoom,{worldview:re}),j,J).evaluate(Y,{},j,J),ce=B.possiblyEvaluate(new In(z.minZoom,{worldview:re}),j,J).evaluate(Y,{},j,J);return Math.max(oe,ce)}return B.possiblyEvaluate(new In(V,{worldview:re}),j,J).evaluate(Y,{},j,J)})(e,i,c,f,g,E,M);return s.scaleSelf(R*b*y)}function c1(s,e,i,c,f,g,y,b,E,M){return{iconPrimary:hL(s.getPrimary(),e,i,c,f,g,y,b,E,M),iconSecondary:hL(s.getSecondary(),e,i,c,f,g,y,b,E,M)}}function lq(s,e,i){if(!e)return;const c=i.get(s.toString()),f=i.get(e.toString());c&&f&&(c.paddedRect.w===f.paddedRect.w&&c.paddedRect.h===f.paddedRect.h||br(`Mismatch in icon variant sizes: ${s.toString()} and ${e.toString()}`),c.usvg!==f.usvg&&br(`Mismatch in icon variant image types: ${s.id} and ${e.id}`))}function dL(s,e,i,c){if(!s)return;const f=e.get(i.toString());if(s.imagePrimary=f,c){const g=e.get(c.toString());s.imageSecondary=g}}function cq(s,e){for(const i in s.horizontal)fL(s.horizontal[i],e);fL(s.vertical,e)}function fL(s,e){if(s){for(const i of s.positionedLines)for(const c of i.positionedGlyphs)if(c.image!==null){const f=c.image.toString();c.rect=e.get(f).paddedRect}}}function aE(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function uq(s,e,i,c,f,g,y,b,E){const M=u2(g.horizontal)||g.vertical,R=i.get("icon-text-fit-padding").evaluate(c,{},f);let z,B=e;return e&&E!=="none"&&(s.allowVerticalPlacement&&g.vertical&&(z=JS(e,g.vertical,E,R,b,y)),M&&(B=JS(e,M,E,R,b,y))),{defaultShapedIcon:B,verticallyShapedIcon:z}}function pL(s,e){return s*e/24}function hq(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe,ce,pe,Se,we,Ie){let Pe=y.textMaxSize.evaluate(e,{},B);Pe===void 0?Pe=b*y.textScaleFactor:Pe*=y.textScaleFactor;const Oe=s.layers[0].layout,ke=pL(b,y.textScaleFactor),Ge=u2(i.horizontal)||i.vertical,pt=s.hasAnyAppearanceProperty(["text-size","text-offset","text-rotate"]);if((re!=="none"||pt)&&s.appearanceFeatureData&&s.featureToAppearanceIndex[e.index]<s.appearanceFeatureData.length){const Ht=s.appearanceFeatureData[s.featureToAppearanceIndex[e.index]];Ht&&(Ht.textShaping=Ge,Ht.iconTextFitPadding=Oe.get("icon-text-fit-padding").evaluate(e,{},B),Ht.fontScale=ke,Ht.textScaleFactor=y.textScaleFactor)}const ct=j.name==="globe",dt=s.tilePixelRatio*Pe/24,St=(It=s.overscaling,s.zoom>18&&It>2&&(It>>=1),Math.max(Gt/(512*It),1)*Oe.get("symbol-spacing")),At=Oe.get("text-padding")*s.tilePixelRatio,Tt=Oe.get("icon-padding")*s.tilePixelRatio,lt=yr(Oe.get("text-max-angle")),Ot=Oe.get("icon-rotation-alignment")==="map"&&ce!=="point",xt=St/2;var It;s.hasAnyIconTextFit===!1&&re!=="none"&&(s.hasAnyIconTextFit=!0);const Et=e.properties?+e.properties[ln]:null,rr=Et&&s.elevationFeatureIdToIndex?s.elevationFeatureIdToIndex.get(Et):65535,nr=(Ht,Yt,wr)=>{if(Yt.x<0||Yt.x>=Gt||Yt.y<0||Yt.y>=Gt)return;let gr=null;if(ct){const{x:tr,y:Fr,z:nn}=j.projectTilePoint(Yt.x,Yt.y,wr);gr={anchor:new Kp(tr,Fr,nn,0,void 0),up:j.upVector(wr,Yt.x,Yt.y)}}(function(tr,Fr,nn,On,Yr,Hn,gn,ta,vn,Un,bi,Di,Ri,ra,To,es,Ca,Va,eo,Xr,zi,$i,ic,js,So,Us,Df,vs,M2,i0,al,O2){const Rf=tr.addToLineVertexArray(Fr,On);let Qp,Og,Su,xh,S1,a0,Kr,uo=0,na=0,Ga=0,Eu=0,Tl=-1,ac=-1;const ho={};let E1=yc("");const zf=nn?nn.anchor:Fr,Ia=vs!=="none";let Eo=0,$a=0;if(vn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Mo=vn.layout.get("text-offset").evaluate(zi,{},So);Eo=Mo[0]*co,$a=Mo[1]*co}else Eo=vn.layout.get("text-radial-offset").evaluate(zi,{},So)*co,$a=iE;if(tr.allowVerticalPlacement&&Yr.vertical){const Mo=Yr.vertical;if(To)a0=lE(Mo),ta&&(Kr=lE(ta));else{const Sl=vn.layout.get("text-rotate").evaluate(zi,{},So)+90;Su=h2(Un,zf,Fr,bi,Di,Ri,Mo,ra,Sl,es,O2),ta&&(xh=h2(Un,zf,Fr,bi,Di,Ri,ta,Va,Sl,null,al))}}if(Hn){const Mo=vn.layout.get("icon-rotate").evaluate(zi,{},So),Sl=nE(Hn,Mo,ic,Ia,$i.iconScaleFactor),bh=ta?nE(ta,Mo,ic,Ia,$i.iconScaleFactor):void 0;Og=h2(Un,zf,Fr,bi,Di,Ri,Hn,Va,Mo,null,i0);const Lf=(function(Ed,AH,DB,TH,SH,RB,zB,EH,kfe,DE){const LB=Ed.layers[0],BB=LB.appearances;let s0=AH.length;if(DB&&(s0=Math.max(s0,DB.length)),BB.length===0)return s0;const[MH,OH]=TH.get("icon-size-scale-range"),CH=Ee(1,MH,OH);for(const RE of BB){const kB=RE.getUnevaluatedProperties();if(kB._values["icon-image"].value!==void 0){const FB=LB.getAppearanceValueAndResolveTokens(RE,"icon-image",RB,zB,DE);if(FB){const NB=Ed.getResolvedImageFromTokens(FB);if(NB){const jB=RE.hasProperty("icon-size")?kB._values["icon-size"]:SH._values["icon-size"],IH=c1(NB,uy(Ed.zoom,jB,Ed.worldview,DE),jB,zB,Ed.zoom,RB,Ed.pixelRatio,CH,Ed.worldview,DE),UB=EH.get(IH.iconPrimary.toString());UB&&(s0=Math.max(s0,J$(UB)))}}}}return s0})(tr,Sl,bh,vn.layout,vn._unevaluatedLayout,zi,So,tr.iconAtlasPositions,0,js);uo=4*Lf;const IE=vn.layout.get("icon-size").evaluate(zi,{},So,js),PE=$i.compositeIconSizes?$i.compositeIconSizes[0].evaluate(zi,{},So,js):0,M1=$i.compositeIconSizes?$i.compositeIconSizes[1].evaluate(zi,{},So,js):0,o0=sE(tr.layerIds[0],tr.iconSizeData,IE,$i.iconScaleFactor,PE,M1);tr.addSymbols(tr.icon,Sl,o0,Xr,eo,zi,void 0,nn,Fr,Rf.lineStartIndex,Rf.lineLength,-1,js,So,Us,Df,tr.symbolInstances.length,Lf),Tl=tr.icon.placedSymbolArray.length-1,bh&&(na=4*Lf,tr.addSymbols(tr.icon,bh,o0,Xr,eo,zi,nc.vertical,nn,Fr,Rf.lineStartIndex,Rf.lineLength,-1,js,So,Us,Df,tr.symbolInstances.length,Lf),ac=tr.icon.placedSymbolArray.length-1)}for(const Mo in Yr.horizontal){const Sl=Mo,bh=Yr.horizontal[Sl];Qp||(E1=yc(bh.text),To?S1=lE(bh):Qp=h2(Un,zf,Fr,bi,Di,Ri,bh,ra,vn.layout.get("text-rotate").evaluate(zi,{},So),es,O2));const Lf=bh.positionedLines.length===1;if(Ga+=mL(tr,nn,Fr,bh,gn,vn,To,zi,es,Rf,Yr.vertical?nc.horizontal:nc.horizontalOnly,Lf?nq(Yr.horizontal):[Sl],ho,Tl,$i,js,So,tr.symbolInstances.length,Us),Lf)break}Yr.vertical&&(Eu+=mL(tr,nn,Fr,Yr.vertical,gn,vn,To,zi,es,Rf,nc.vertical,["vertical"],ho,ac,$i,js,So,tr.symbolInstances.length,Us));let xs=-1;const bs=(Mo,Sl)=>Mo?Math.max(Mo,Sl):Sl;xs=bs(S1,xs),xs=bs(a0,xs),xs=bs(Kr,xs);const Cg=xs>-1?1:0;tr.glyphOffsetArray.length>=65535&&br("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),zi.sortKey!==void 0&&tr.addToSortKeyRanges(tr.symbolInstances.length,zi.sortKey),tr.symbolInstances.emplaceBack(Fr.x,Fr.y,zf.x,zf.y,zf.z,ho.right>=0?ho.right:-1,ho.center>=0?ho.center:-1,ho.left>=0?ho.left:-1,ho.vertical>=0?ho.vertical:-1,Tl,ac,E1,Qp!==void 0?Qp:tr.collisionBoxArray.length,Qp!==void 0?Qp+1:tr.collisionBoxArray.length,Su!==void 0?Su:tr.collisionBoxArray.length,Su!==void 0?Su+1:tr.collisionBoxArray.length,Og!==void 0?Og:tr.collisionBoxArray.length,Og!==void 0?Og+1:tr.collisionBoxArray.length,xh||tr.collisionBoxArray.length,xh?xh+1:tr.collisionBoxArray.length,bi,Ga,Eu,uo,na,Cg,0,Eo,$a,xs,0,Ia?1:0,M2)})(s,Yt,gr,Ht,i,c,g,f,s.layers[0],s.collisionBoxArray,e.index,e.sourceLayerIndex,s.index,At,oe,M,0,Tt,Ot,J,e,y,R,z,B,V,Y,re,rr,pe,Se,we)};if(ce==="line")for(const Ht of Hw(e.geometry,0,0,Gt,Gt)){const Yt=Q$(Ht,St,lt,i.vertical||Ge,c,24,dt,s.overscaling,Gt);for(const wr of Yt)Ge&&dq(s,Ge.text,xt,wr)||nr(Ht,wr,B)}else if(ce==="line-center"){for(const Ht of e.geometry)if(Ht.length>1){const Yt=K$(Ht,lt,i.vertical||Ge,c,24,dt);Yt&&nr(Ht,Yt,B)}}else if(e.type==="Polygon")for(const Ht of J_(e.geometry,0)){const Yt=tq(Ht,16);nr(Ht[0],new Kp(Yt.x,Yt.y,0,0,void 0),B)}else if(e.type==="LineString")for(const Ht of e.geometry)nr(Ht,new Kp(Ht[0].x,Ht[0].y,0,0,void 0),B);else if(e.type==="Point")for(const Ht of e.geometry)for(const Yt of Ht)nr([Yt],new Kp(Yt.x,Yt.y,0,0,void 0),B)}const oE=255,hy=oE*Yp;function mL(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe){const ce=sL(0,c,E,g,y,b,f,s.allowVerticalPlacement,void 0),pe=g.layout.get("text-size").evaluate(b,{},re),Se=V.compositeTextSizes?V.compositeTextSizes[0].evaluate(b,{},re):0,we=V.compositeTextSizes?V.compositeTextSizes[1].evaluate(b,{},re):0,Ie=sE(s.layerIds[0],s.textSizeData,pe,V.textScaleFactor,Se,we);s.addSymbols(s.text,ce,Ie,E,y,b,R,e,i,M.lineStartIndex,M.lineLength,j,Y,re,oe,!1,J,ce.length);for(const Pe of z)B[Pe]=s.text.placedSymbolArray.length-1;return 4*ce.length}function sE(s,e,i,c,f,g){const y=e;let b=null;return y.kind==="source"?(b=[Yp*i*c],b[0]>hy&&br(`${s}: Value for "text-size" is >= ${oE}. Reduce your "text-size".`)):y.kind==="composite"&&(b=[Yp*f*c,Yp*g*c],(b[0]>hy||b[1]>hy)&&br(`${s}: Value for "text-size" is >= ${oE}. Reduce your "text-size".`)),b}function u2(s){for(const e in s)return s[e];return null}function h2(s,e,i,c,f,g,y,b,E,M,R){let z,B,j,V;if(z=R?R.top:y.top,B=R?R.bottom:y.bottom,j=R?R.left:y.left,V=R?R.right:y.right,QS(y)&&y.collisionPadding){const Y=y.collisionPadding;j-=Y[0],z-=Y[1],V+=Y[2],B+=Y[3]}if(E){const Y=new yt(j,z),re=new yt(V,z),J=new yt(j,B),oe=new yt(V,B),ce=yr(E);let pe=new yt(0,0);M&&(pe=new yt(M[0],M[1])),Y._rotateAround(ce,pe),re._rotateAround(ce,pe),J._rotateAround(ce,pe),oe._rotateAround(ce,pe),j=Math.min(Y.x,re.x,J.x,oe.x),V=Math.max(Y.x,re.x,J.x,oe.x),z=Math.min(Y.y,re.y,J.y,oe.y),B=Math.max(Y.y,re.y,J.y,oe.y)}return s.emplaceBack(e.x,e.y,e.z,i.x,i.y,j,z,V,B,b,c,f,g),s.length-1}function lE(s){QS(s)&&s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const e=s.bottom-s.top;return e>0?Math.max(10,e):null}function dq(s,e,i,c){const f=s.compareText;if(e in f){const g=f[e];for(let y=g.length-1;y>=0;y--)if(c.dist(g[y])<i)return!0}else f[e]=[];return f[e].push(c),!1}function gL(s,e){const i=s.fovAboveCenter,c=s.elevation?s.elevation.getMinElevationBelowMSL()*e:0,f=(s._camera.position[2]*s.worldSize-c)/Math.cos(s._pitch),g=Math.sin(i)*f/Math.sin(Math.max(Math.PI/2-s._pitch-i,.01));let y=Math.sin(s._pitch)*g+f;const b=f*(1/s._horizonShift);if(!s.elevation||s.elevation.exaggeration()===0){let E=Math.max(s.zoom-17,0);s.isOrthographic&&(E/=10),y*=1+E}return Math.min(1.01*y,b)}function u1(s,e){if(!e.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:e};const i=Math.pow(2,-s.z),c=s.x*i,f=(s.x+1)*i,g=s.y*i,y=(s.y+1)*i,b=ut(c),E=ut(f),M=wt(g),R=wt(y),z=e.project(b,M),B=e.project(E,M),j=e.project(E,R),V=e.project(b,R);let Y=Math.min(z.x,B.x,j.x,V.x),re=Math.min(z.y,B.y,j.y,V.y),J=Math.max(z.x,B.x,j.x,V.x),oe=Math.max(z.y,B.y,j.y,V.y);const ce=i/16;function pe(we,Ie,Pe,Oe,ke,Ge){const pt=(Pe+ke)/2,ct=(Oe+Ge)/2,dt=e.project(ut(pt),wt(ct)),St=Math.max(0,Y-dt.x,re-dt.y,dt.x-J,dt.y-oe);Y=Math.min(Y,dt.x),J=Math.max(J,dt.x),re=Math.min(re,dt.y),oe=Math.max(oe,dt.y),St>ce&&(pe(we,dt,Pe,Oe,pt,ct),pe(dt,Ie,pt,ct,ke,Ge))}pe(z,B,c,g,f,g),pe(B,j,f,g,f,y),pe(j,V,f,y,c,y),pe(V,z,c,y,c,g),Y-=ce,re-=ce,J+=ce,oe+=ce;const Se=1/Math.max(J-Y,oe-re);return{scale:Se,x:Y*Se,y:re*Se,x2:J*Se,y2:oe*Se,projection:e}}function _L(s,{x:e,y:i},c=0){return new yt(((e-c)*s.scale-s.x)*Gt,(i*s.scale-s.y)*Gt)}const fq=K(new Float32Array(16));class Eg{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new Te(0,0)}projectTilePoint(e,i,c){return{x:e,y:i,z:0}}locationPoint(e,i,c,f=!0){return e._coordinatePoint(e.locationCoordinate(i,c),f)}pixelsPerMeter(e,i){return We(1,e)*i}pixelSpaceConversion(e,i,c){return 1}farthestPixelDistance(e){return gL(e,e.pixelsPerMeter)}pointCoordinate(e,i,c,f){const g=e.horizonLineFromTop(!1),y=new yt(i,Math.max(g,c));return e.rayIntersectionCoordinate(e.pointRayIntersection(y,f))}pointCoordinate3D(e,i,c){const f=new yt(i,c);if(e.elevation)return e.elevation.pointCoordinate(f);{const g=this.pointCoordinate(e,f.x,f.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(e,i){if(e.elevation&&e.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(e,i.x,i.y);const c=e.horizonLineFromTop();return i.y<c}createInversionMatrix(e,i){return fq}createTileMatrix(e,i,c){let f,g,y;const b=c.canonical,E=K(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=u1(b,this);f=1,g=M.x+c.wrap*M.scale,y=M.y,ge(E,E,[f/M.scale,f/M.scale,e.pixelsPerMeter/i])}else f=i/e.zoomScale(b.z),g=(b.x+Math.pow(2,b.z)*c.wrap)*f,y=b.y*f;return me(E,E,[g,y,0]),ge(E,E,[f/Gt,f/Gt,1]),E}upVector(e,i,c){return[0,0,1]}upVectorScale(e,i,c){return{metersToTile:1}}}class pq extends Eg{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,c]=this.parallels=e.parallels||[29.5,45.5],f=Math.sin(yr(i));this.n=(f+Math.sin(yr(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:c,c:f,r0:g}=this,y=yr(e-this.center[0]),b=yr(i),E=Math.sqrt(f-2*c*Math.sin(b))/c;return{x:E*Math.sin(y*c),y:E*Math.cos(y*c)-g,z:0}}unproject(e,i){const{n:c,c:f,r0:g}=this,y=g+i;let b=Math.atan2(e,Math.abs(y))*Math.sign(y);y*c<0&&(b-=Math.PI*Math.sign(e)*Math.sign(y));const E=yr(this.center[0])*c;b=it(b,-Math.PI-E,Math.PI-E);const M=Ee(Xe(b/c)+this.center[0],-180,180),R=Math.asin(Ee((f-(e*e+y*y)*c*c)/(2*c),-1,1)),z=Ee(Xe(R),-85.051129,je);return new Te(M,z)}}const h1=1.340264,d1=-.081106,f1=893e-6,p1=.003796,d2=Math.sqrt(3)/2;class mq extends Eg{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const c=Math.asin(d2*Math.sin(i)),f=c*c,g=f*f*f;return{x:.5*(e*Math.cos(c)/(d2*(h1+3*d1*f+g*(7*f1+9*p1*f)))/Math.PI+.5),y:1-.5*(c*(h1+d1*f+g*(f1+p1*f))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,f=c*c,g=f*f*f;for(let R,z,B,j=0;j<12&&(z=c*(h1+d1*f+g*(f1+p1*f))-i,B=h1+3*d1*f+g*(7*f1+9*p1*f),R=z/B,c=Ee(c-R,-Math.PI/3,Math.PI/3),f=c*c,g=f*f*f,!(Math.abs(R)<1e-12));++j);const y=d2*e*(h1+3*d1*f+g*(7*f1+9*p1*f))/Math.cos(c),b=Math.asin(Math.sin(c)/d2),E=Ee(180*y/Math.PI,-180,180),M=Ee(180*b/Math.PI,-85.051129,je);return new Te(E,M)}}class gq extends Eg{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const c=360*(e-.5),f=Ee(360*(.5-i),-85.051129,je);return new Te(c,f)}}const Qv=Math.PI/2;function f2(s){return Math.tan((Qv+s)/2)}class _q extends Eg{constructor(e){super(e),this.center=e.center||[0,30];const[i,c]=this.parallels=e.parallels||[30,30];let f=yr(i),g=yr(c);this.southernCenter=f+g<0,this.southernCenter&&(f=-f,g=-g);const y=Math.cos(f),b=f2(f);this.n=f===g?Math.sin(f):Math.log(y/Math.cos(g))/Math.log(f2(g)/b),this.f=y*Math.pow(f2(f),this.n)/this.n}project(e,i){i=yr(i),this.southernCenter&&(i=-i),e=yr(e-this.center[0]);const c=1e-6,{n:f,f:g}=this;g>0?i<-Qv+c&&(i=-Qv+c):i>Qv-c&&(i=Qv-c);const y=g/Math.pow(f2(i),f);let b=y*Math.sin(f*e),E=g-y*Math.cos(f*e);return b=.5*(b/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:b,y:this.southernCenter?E:1-E,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:c,f}=this,g=f-i,y=Math.sign(g),b=Math.sign(c)*Math.sqrt(e*e+g*g);let E=Math.atan2(e,Math.abs(g))*y;g*c<0&&(E-=Math.PI*Math.sign(e)*y);const M=Ee(Xe(E/c)+this.center[0],-180,180),R=Ee(Xe(2*Math.atan(Math.pow(f/b,1/c))-Qv),-85.051129,je);return new Te(M,this.southernCenter?-R:R)}}class yL extends Eg{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:He(e),y:Qe(i),z:0}}unproject(e,i){const c=ut(e),f=wt(i);return new Te(c,f)}}const vL=yr(je);class yq extends Eg{project(e,i){const c=(i=yr(i))*i,f=c*c;return{x:.5*((e=yr(e))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let c=i=(2*(1-i)-1)*Math.PI,f=25,g=0,y=c*c;do{y=c*c;const M=y*y;g=(c*(1.007226+y*(.015085+M*(.028874*y-.044475-.005916*M)))-i)/(1.007226+y*(.045255+M*(.259866*y-.311325-.005916*11*M))),c=Ee(c-g,-vL,vL)}while(Math.abs(g)>1e-6&&--f>0);y=c*c;const b=Ee(Xe(e/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=Xe(c);return new Te(b,E)}}const xL=yr(je);class vq extends Eg{project(e,i){i=yr(i),e=yr(e);const c=Math.cos(i),f=2/Math.PI,g=Math.acos(c*Math.cos(e/2)),y=Math.sin(g)/g,b=.5*(e*f+2*c*Math.sin(e/2)/y)||0,E=.5*(i+Math.sin(i)/y)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,i){let c=e=(2*e-.5)*Math.PI,f=i=(2*(1-i)-1)*Math.PI,g=25;const y=1e-6;let b=0,E=0;do{const M=Math.cos(f),R=Math.sin(f),z=2*R*M,B=R*R,j=M*M,V=Math.cos(c/2),Y=Math.sin(c/2),re=2*V*Y,J=Y*Y,oe=1-j*V*V,ce=oe?1/oe:0,pe=oe?Math.acos(M*V)*Math.sqrt(1/oe):0,Se=.5*(2*pe*M*Y+2*c/Math.PI)-e,we=.5*(pe*R+f)-i,Ie=.5*ce*(j*J+pe*M*V*B)+1/Math.PI,Pe=ce*(re*z/4-pe*R*Y),Oe=.125*ce*(z*Y-pe*R*j*re),ke=.5*ce*(B*V+pe*J*M)+.5,Ge=Pe*Oe-ke*Ie;b=(we*Pe-Se*ke)/Ge,E=(Se*Oe-we*Ie)/Ge,c=Ee(c-b,-Math.PI,Math.PI),f=Ee(f-E,-xL,xL)}while((Math.abs(b)>y||Math.abs(E)>y)&&--g>0);return new Te(Xe(c),Xe(f))}}class bL extends Eg{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(yr(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:c,cosPhi:f}=this;return{x:yr(e)*f*c+.5,y:-Math.sin(yr(i))/f*c+.5,z:0}}unproject(e,i){const{scale:c,cosPhi:f}=this,g=-(i-.5)/c,y=Ee(Xe((e-.5)/c)/f,-180,180),b=Math.asin(Ee(g*f,-1,1)),E=Ee(Xe(b),-85.051129,je);return new Te(y,E)}}class xq extends yL{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,c){const f=V_(e,i,c);return Tr(f,f,G_(wu(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(e,i,c){const f=Ce(i.lat,i.lng),g=Xt([],f),y=c?e._centerAltitude+c:e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;ar(f,f,g,We(1,0)*Gt*y);const b=K(new Float64Array(16));return ue(b,e.pixelMatrix,e.globeMatrix),Tr(f,f,b),new yt(f[0],f[1])}pixelsPerMeter(e,i){return We(1,0)*i}pixelSpaceConversion(e,i,c){const f=We(1,e)*i,g=Dr(We(1,45)*i,f,c);return this.pixelsPerMeter(e,i)/g}createTileMatrix(e,i,c){const f=si(wu(c.canonical));return ue(new Float64Array(16),e.globeMatrix,f)}createInversionMatrix(e,i){const{center:c}=e,f=G_(wu(i));return fe(f,f,yr(c.lng)),se(f,f,yr(c.lat)),ge(f,f,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(e,i,c,f){return Ox(e,i,c,!0)||new qt(0,0)}pointCoordinate3D(e,i,c){const f=this.pointCoordinate(e,i,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(e,i){return!Ox(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=(function(f,g){const y=f.cameraToCenterDistance,b=f._centerAltitude*g,E=f._camera,M=f._camera.forward(),R=Ct([],Bt([],M,-y),[0,0,b]),z=f.worldSize/(2*Math.PI),B=[0,0,-z],j=f.width/f.height,V=Math.tan(f.fovAboveCenter),Y=Bt([],E.up(),V),re=Bt([],E.right(),V*j),J=Xt([],Ct([],Ct([],M,Y),re)),oe=[];let ce;if(new Kn(R,J).closestPointOnSphere(B,z,oe)){const pe=Ct([],oe,B),Se=_n([],pe,R);ce=Math.cos(f.fovAboveCenter)*Mt(Se)}else{const pe=_n([],R,B),Se=_n([],B,R);Xt(Se,Se);const we=Mt(pe)-z;ce=Math.sqrt(we*(we+2*z));const Ie=Math.acos(ce/(z+we))-Math.acos(Mr(M,Se));ce*=Math.cos(Ie)}return 1.01*ce})(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),c=vd(e.zoom);if(c>0){const f=gL(e,We(1,e.center.lat)*e.worldSize),g=e.worldSize/(2*Math.PI),y=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Dr(i,f+g*(1-Math.cos(y)),Math.pow(c,10))}return i}upVector(e,i,c){return V_(i,c,e,1)}upVectorScale(e){return{metersToTile:j_(Mf(wu(e)))}}}function wL(s){const e=s.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(s.name){case"mercator":return new yL(s);case"equirectangular":return new gq(s);case"naturalEarth":return new yq(s);case"equalEarth":return new mq(s);case"winkelTripel":return new vq(s);case"albers":return i?new bL(s):new pq(s);case"lambertConformalConic":return i?new bL(s):new _q(s);case"globe":return new xq(s)}throw new Error(`Invalid projection name: ${s.name}`)}const bq=tn.types,wq=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function m1(s,e,i,c,f,g,y,b,E,M,R,z,B){const j=b?Math.min(hy,Math.round(b[0])):0,V=b?Math.min(hy,Math.round(b[1])):0;s.emplaceBack(e,i,Math.round(32*c),Math.round(32*f),g,y,(j<<1)+(E?1:0),0+(V<<1),16*M,16*R,256*z,256*B)}function g1(s,e,i){s.emplaceBack(e,i)}function _1(s,e,i,c,f,g,y){s.emplaceBack(e,i,c,f,g,y)}const p2=(s,e,i,c)=>{for(let f=0;f<e;f++)s.emplaceBack(i[0],i[1],i[2],c[0],c[1],c[2])};function Jv(s,e,i,c,f){s.emplaceBack(e,i,c,f),s.emplaceBack(e,i,c,f),s.emplaceBack(e,i,c,f),s.emplaceBack(e,i,c,f)}function Aq(s){for(const e of s.sections)if(Dc(e.text))return!0;return!1}class cE{constructor(e){this.layoutVertexArray=new hd,this.indexArray=new pa,this.programConfigurations=e,this.segments=new ui,this.dynamicLayoutVertexArray=new Yl,this.opacityVertexArray=new sg,this.placedSymbolArray=new jp,this.iconTransitioningVertexArray=new rl,this.globeExtVertexArray=new og,this.zOffsetVertexArray=new ja,this.orientationVertexArray=new mf,this.symbolInstanceIndices=[]}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}getSymbolVertexData(e,i){const c=[],f=this.layoutVertexArray.uint16;for(let g=0;g<i;++g){const y=12*(e+g);c.push(...f.slice(y,y+12))}return c}updateSymbolVertexData(e,i,c,f,g,y,b,E,M,R,z,B,j){const V=this.layoutVertexArray.uint16,Y=12*e;V[Y]=i,V[Y+1]=c,V[Y+2]=f,V[Y+3]=g,V[Y+4]=y,V[Y+5]=b,V[Y+6]=E,V[Y+7]=M,V[Y+8]=R,V[Y+9]=z,V[Y+10]=B,V[Y+11]=j}upload(e,i,c,f,g,y){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,S$.members,!!y),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,M$.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,wq,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,I$.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,E$.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=e.createVertexBuffer(this.zOffsetVertexArray,O$.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=e.createVertexBuffer(this.orientationVertexArray,C$.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}jt(cE,"SymbolBuffers");class uE{constructor(e,i,c){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new c,this.segments=new ui,this.collisionVertexArray=new kp,this.collisionVertexArrayExt=new Yl}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,P$.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,D$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}jt(uE,"CollisionBuffers");class m2{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.fqid),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=K([]),this.placementViewportMatrix=K([]);const i=this.layers[0]._unevaluatedLayout._values;this.worldview=e.worldview,this.localizable=e.localizable,this.textSizeData=uy(this.zoom,i["text-size"],this.worldview,e.availableImages),this.iconSizeData=uy(this.zoom,i["icon-size"],this.worldview,e.availableImages);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.lut=e.lut,this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>nc[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID,this.projection=e.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1,this.hasAppearances=null,this.lastActiveApperance=null,this.featureToAppearanceIndex={}}hasAnyAppearanceProperty(e){const i=this.layers[0].getAppearances();if(!i||i.length===0)return!1;const c=Array.isArray(e)?e:[e];return i.some(f=>c.some(g=>f.getProperty(g)!=null))}createArrays(){this.text=new cE(new N(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("text")||e.startsWith("symbol"))),this.icon=new cE(new N(this.layers,{zoom:this.zoom,lut:this.lut},e=>e.startsWith("icon")||e.startsWith("symbol"))),this.glyphOffsetArray=new Up,this.lineVertexArray=new Sv,this.symbolInstances=new ia}calculateGlyphDependencies(e,i,c,f,g){for(const y of e){const b=y.codePointAt(0);if(b===void 0)break;if(i[b]=!0,f&&g&&b<=65535){const E=a1[y];E&&(i[E.charCodeAt(0)]=!0)}}}calculateEffectiveAppearanceIconSize(e,i,c,f,g,y,b){if(!e.hasProperty("icon-size"))return b*y;let E=1;const M=e.getUnevaluatedProperties()._values["icon-size"],R=uy(this.zoom,M,this.worldview,g),z=Wv(R,i);if(R.kind!=="constant"&&R.kind!=="camera"||(E=z.uSize),R.kind==="composite"){const{minZoom:B,maxZoom:j}=R,V=M.possiblyEvaluate(new In(B,{worldview:this.worldview}),f),Y=M.possiblyEvaluate(new In(j,{worldview:this.worldview}),f),re=V.evaluate(c,{},f,g);E=re+(Y.evaluate(c,{},f,g)-re)*z.uSizeT}return R.kind==="source"&&(E=M.possiblyEvaluate(new In(this.zoom,{worldview:this.worldview}),f).evaluate(c,{},f,g)),E*y}updateFootprints(e,i){}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=i.updateTime;const c=i.getReplacementRegionsForTile(e.toUnwrapped(),!0);return!d(this.activeReplacements,c)&&(this.activeReplacements=c,!0)}getResolvedImageFromTokens(e){return typeof e=="string"?ls.build(e):e}populate(e,i,c,f){const g=this.layers[0],y=g.layout,b=this.projection.name==="globe",E=y.get("text-font"),M=y.get("text-field"),R=y.get("icon-image"),[z,B]=y.get("icon-size-scale-range"),j=Ee(i.scaleFactor||1,z,B),V=(M.value.kind!=="constant"||M.value.value instanceof xo&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),Y=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,re=this.hasAnyAppearanceProperty("icon-image"),J=y.get("symbol-sort-key");if(this.features=[],this.appearanceFeatureData=[],!V&&!Y&&!re)return;const oe=i.iconDependencies,ce=i.glyphDependencies,pe=i.availableImages,Se=new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),we=Ie=>{const Pe=Ie.id.toString();oe.has(Pe)?oe.get(Pe).push(Ie):oe.set(Pe,[Ie])};for(const Ie of e){const{feature:Pe,id:Oe,index:ke,sourceLayerIndex:Ge}=Ie,pt=g._featureFilter.needGeometry,ct=Vr(Pe,pt);if(!g._featureFilter.filter(Se,ct,c))continue;if(pt||(ct.geometry=Ir(Pe,c,f)),b&&Pe.type!==1&&c.z<=5){const It=ct.geometry,Et=.98078528056,rr=(nr,Ht)=>Mr(V_(nr.x,nr.y,c,1),V_(Ht.x,Ht.y,c,1))<Et;for(let nr=0;nr<It.length;nr++)It[nr]=sr(It[nr],rr)}let dt,St;if(V){const It=g.getValueAndResolveTokens("text-field",ct,c,pe),Et=xo.factory(It);Aq(Et)&&(this.hasRTLText=!0),(!this.hasRTLText||sh()==="unavailable"||this.hasRTLText&&zs.isParsed())&&(dt=z$(Et,g,ct))}if(Y){const It=g.getValueAndResolveTokens("icon-image",ct,c,pe);St=this.getResolvedImageFromTokens(It)}const At=this.layers[0];let Tt=!1;if(!St&&re){const It=At.getAppearances();for(const Et of It)if(Et.getProperty("icon-image")){const rr=At.getAppearanceValueAndResolveTokens(Et,"icon-image",ct,c,pe);if(rr){St=this.getResolvedImageFromTokens(rr),Tt=!0;break}}}if(!dt&&!St)continue;const lt=this.sortFeaturesByKey?J.evaluate(ct,{},c):void 0,Ot={id:Oe,text:dt,icon:St,index:ke,sourceLayerIndex:Ge,geometry:ct.geometry,properties:Pe.properties,type:bq[Pe.type],sortKey:lt};if(this.features.push(Ot),this.featureToAppearanceIndex[ke]=this.appearanceFeatureData.length,this.appearanceFeatureData.push({id:Oe,properties:Pe.properties,usesAppearanceIconAsPlaceholder:Tt,isUsingAppearanceIconVertexData:!1,isUsingAppearanceTextVertexData:!1,layoutBasedIconVertexData:[],layoutBasedTextVertexData:[],activeAppearance:null}),St){const It=At._unevaluatedLayout._values,{iconPrimary:Et,iconSecondary:rr}=c1(St,this.iconSizeData,It["icon-size"],c,this.zoom,Ot,this.pixelRatio,j,this.worldview,pe);we(Et),rr&&(this.hasAnySecondaryIcon=!0,we(rr))}const xt=At.getAppearances();if(xt.length!==0&&xt.forEach(It=>{if(!It.getProperty("icon-image"))return;const Et=this.getCombinedIconPrimary(It,At,ct,c,pe,Ot,j);Et&&we(Et)}),dt){const It=E.evaluate(ct,{},c).join(","),Et=y.get("text-rotation-alignment")==="map"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(nc.vertical)>=0;for(const rr of dt.sections)if(rr.image){const nr=rr.image.getPrimary().scaleSelf(this.pixelRatio),Ht=nr.id.toString(),Yt=oe.get(Ht)||[];Yt.push(nr),oe.set(Ht,Yt)}else{const nr=Km(dt.toString()),Ht=rr.fontStack||It,Yt=ce[Ht]=ce[Ht]||{};this.calculateGlyphDependencies(rr.text,Yt,Et,this.allowVerticalPlacement,nr)}}}if(y.get("symbol-placement")==="line"&&(this.features=(function(Ie){const Pe={},Oe={},ke=[];let Ge=0;function pt(At){ke.push(Ie[At]),Ge++}function ct(At,Tt,lt){const Ot=Oe[At];return delete Oe[At],Oe[Tt]=Ot,ke[Ot].geometry[0].pop(),ke[Ot].geometry[0]=ke[Ot].geometry[0].concat(lt[0]),Ot}function dt(At,Tt,lt){const Ot=Pe[Tt];return delete Pe[Tt],Pe[At]=Ot,ke[Ot].geometry[0].shift(),ke[Ot].geometry[0]=lt[0].concat(ke[Ot].geometry[0]),Ot}function St(At,Tt,lt){const Ot=lt?Tt[0][Tt[0].length-1]:Tt[0][0];return`${At}:${Ot.x}:${Ot.y}`}for(let At=0;At<Ie.length;At++){const Tt=Ie[At],lt=Tt.geometry,Ot=Tt.text?Tt.text.toString():null;if(!Ot){pt(At);continue}const xt=St(Ot,lt),It=St(Ot,lt,!0);if(xt in Oe&&It in Pe&&Oe[xt]!==Pe[It]){const Et=dt(xt,It,lt),rr=ct(xt,It,ke[Et].geometry);delete Pe[xt],delete Oe[It],Oe[St(Ot,ke[rr].geometry,!0)]=rr,ke[Et].geometry=null}else xt in Oe?ct(xt,It,lt):It in Pe?dt(xt,It,lt):(pt(At),Pe[xt]=Ge-1,Oe[It]=Ge-1)}return ke.filter(At=>At.geometry)})(this.features)),y.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",i.elevationFeatures){!this.elevationFeatures&&i.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ie of i.elevationFeatures)this.elevationFeatureIdToIndex.set(Ie.id,this.elevationFeatures.length),this.elevationFeatures.push(Ie)}}else y.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((Ie,Pe)=>Ie.sortKey-Pe.sortKey)}getCombinedIconPrimary(e,i,c,f,g,y,b){let E,M;const R=e.getUnevaluatedProperties();if(R._values["icon-image"].value!==void 0){const z=i.getAppearanceValueAndResolveTokens(e,"icon-image",c,f,g);E=this.getResolvedImageFromTokens(z)}else{const z=i.getValueAndResolveTokens("icon-image",c,f,g);E=this.getResolvedImageFromTokens(z)}if(E){const z=e.hasProperty("icon-size")?R._values["icon-size"]:i._unevaluatedLayout._values["icon-size"];M=c1(E,uy(this.zoom,z,this.worldview,g),z,f,this.zoom,y,this.pixelRatio,b,this.worldview,g).iconPrimary}return M}updateSymbolInstanceIconVertices(e,i,c,f,g,y,b,E,M,R,z,B,j,V){if(e.placedIconSymbolIndex<0)return{vertexOffsetDelta:0,hasChanges:!1};if(i.activeAppearance===c)return{vertexOffsetDelta:e.numIconVertices,hasChanges:!1};if(c){const Y=this.getCombinedIconPrimary(c,M,f,y,b,{sortKey:void 0,text:void 0,icon:null,index:e.featureIndex,sourceLayerIndex:e.featureIndex,geometry:[],properties:i.properties,type:"Point",id:i.id},R);if(!Y)return{vertexOffsetDelta:0,hasChanges:!1};const re=Y.toString(),J=this.iconAtlasPositions&&this.iconAtlasPositions.get(re);if(J){const{appearanceIconOffset:oe,appearanceIconRotate:ce}=cL(c,M,f,y,B,V,j,R);let pe=a2(J,void 0,oe,M.layout.get("icon-anchor").evaluate(f,z,y));const Se=J.sdf,we=M.layout.get("icon-text-fit").constantOr("none");we!=="none"&&i.textShaping&&i.iconTextFitPadding&&i.fontScale&&(pe=JS(pe,i.textShaping,we,i.iconTextFitPadding,oe,i.fontScale));const Ie=this.calculateEffectiveAppearanceIconSize(c,E.zoom,f,y,b,R,j),Pe=0,Oe=1+(Math.min(hy,Math.round(Ie*Yp))<<1),ke=nE(pe,ce,Se,we!=="none",R);i.isUsingAppearanceIconVertexData||(i.isUsingAppearanceIconVertexData=!0,i.layoutBasedIconVertexData=this.icon.getSymbolVertexData(g,e.numIconVertices));let Ge=g;for(let ct=0;ct<ke.length;++ct){const dt=ke[ct],St=i.layoutBasedIconVertexData[0]||e.tileAnchorX,At=i.layoutBasedIconVertexData[1]||e.tileAnchorY,Tt=16*dt.pixelOffsetTL.x,lt=16*dt.pixelOffsetTL.y,Ot=16*dt.pixelOffsetBR.x,xt=16*dt.pixelOffsetBR.y,It=16*dt.minFontScaleX,Et=16*dt.minFontScaleY;this.icon.updateSymbolVertexData(Ge,St,At,Math.round(32*dt.tl.x),Math.round(32*dt.tl.y),dt.texPrimary.x,dt.texPrimary.y,Pe,Oe,Tt,lt,It,Et),this.icon.updateSymbolVertexData(Ge+1,St,At,Math.round(32*dt.tr.x),Math.round(32*dt.tr.y),dt.texPrimary.x+dt.texPrimary.w,dt.texPrimary.y,Pe,Oe,Ot,lt,It,Et),this.icon.updateSymbolVertexData(Ge+2,St,At,Math.round(32*dt.bl.x),Math.round(32*dt.bl.y),dt.texPrimary.x,dt.texPrimary.y+dt.texPrimary.h,Pe,Oe,Tt,xt,It,Et),this.icon.updateSymbolVertexData(Ge+3,St,At,Math.round(32*dt.br.x),Math.round(32*dt.br.y),dt.texPrimary.x+dt.texPrimary.w,dt.texPrimary.y+dt.texPrimary.h,Pe,Oe,Ot,xt,It,Et),Ge+=4}const pt=e.numIconVertices-4*ke.length;for(let ct=0;ct<pt;++ct)this.icon.updateSymbolVertexData(Ge+ct,0,0,0,0,0,0,0,0,0,0,0,0);return{vertexOffsetDelta:e.numIconVertices,hasChanges:!0}}}else if(i.usesAppearanceIconAsPlaceholder){if(this.layers[0].appearances&&this.layers[0].appearances.length>0)return this.icon.updateSymbolVertexData(g,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateSymbolVertexData(g+1,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateSymbolVertexData(g+2,0,0,0,0,0,0,0,0,0,0,0,0),this.icon.updateSymbolVertexData(g+3,0,0,0,0,0,0,0,0,0,0,0,0),{vertexOffsetDelta:e.numIconVertices,hasChanges:!0}}else if(i.isUsingAppearanceIconVertexData){const re=i.layoutBasedIconVertexData.length/12;for(let J=0;J<re;++J){const oe=J*12;this.icon.updateSymbolVertexData(g+J,i.layoutBasedIconVertexData[oe+0],i.layoutBasedIconVertexData[oe+1],i.layoutBasedIconVertexData[oe+2],i.layoutBasedIconVertexData[oe+3],i.layoutBasedIconVertexData[oe+4],i.layoutBasedIconVertexData[oe+5],i.layoutBasedIconVertexData[oe+6],i.layoutBasedIconVertexData[oe+7],i.layoutBasedIconVertexData[oe+8],i.layoutBasedIconVertexData[oe+9],i.layoutBasedIconVertexData[oe+10],i.layoutBasedIconVertexData[oe+11])}return i.isUsingAppearanceIconVertexData=!1,{vertexOffsetDelta:re,hasChanges:!0}}return{vertexOffsetDelta:e.numIconVertices,hasChanges:!1}}updateSymbolInstanceTextVertices(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe){const ce=e.numHorizontalGlyphVertices>0||e.numVerticalGlyphVertices>0;if(!ce)return{vertexOffsetDelta:ce?e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices:0,hasChanges:!1};if(i.activeAppearance===c)return{vertexOffsetDelta:e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices,hasChanges:!1};if(c&&i.textShaping){const{appearanceTextOffset:pe,appearanceTextRotate:Se,appearanceTextSize:we}=uL(c,b,f,y,z,j,B);i.fontScale=pL(we,i.textScaleFactor);const Ie=c.getUnevaluatedProperty("text-size");let Pe=this.textSizeData,Oe=re,ke=J;c.hasProperty("text-size")&&(Pe=uy(this.zoom,Ie,this.worldview,oe),Oe=this.textSizeData.kind==="composite"?this.textSizeData.minZoom:0,ke=this.textSizeData.kind==="composite"?this.textSizeData.maxZoom:0);const Ge=i.textShaping.bottom-z[1],pt=i.textShaping.left-z[0],ct=i.textShaping.right-z[0];i.textShaping.top=pe[1]+(i.textShaping.top-z[1]),i.textShaping.bottom=pe[1]+Ge,i.textShaping.left=pe[0]+pt,i.textShaping.right=pe[0]+ct;const dt=sL(0,i.textShaping,pe,b,!1,f,M,this.allowVerticalPlacement,Se),St=we&&Pe.kind==="composite"?Ie.possiblyEvaluate(new In(Oe,{}),y).evaluate(f,R,y):V,At=we&&Pe.kind==="composite"?Ie.possiblyEvaluate(new In(ke,{}),y).evaluate(f,R,y):Y,Tt=sE(c.name,Pe,we,E,St,At),lt=Array.isArray(Tt)?Tt[1]:we,Ot=0,xt=1+(Math.min(hy,Math.round(lt*Yp))<<1);i.isUsingAppearanceTextVertexData||(i.isUsingAppearanceTextVertexData=!0,i.layoutBasedTextVertexData=this.text.getSymbolVertexData(g,e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices));for(let It=0;It<dt.length&&It<(e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices)/4;++It){const Et=dt[It],rr=Et.glyphOffset[1],nr=e.tileAnchorX,Ht=e.tileAnchorY,Yt=g+4*It;this.text.updateSymbolVertexData(Yt,nr,Ht,Math.round(32*Et.tl.x),Math.round(32*(rr+Et.tl.y)),Et.texPrimary.x,Et.texPrimary.y,Ot,xt,Et.pixelOffsetTL.x,Et.pixelOffsetTL.y,Et.minFontScaleX,Et.minFontScaleY),this.text.updateSymbolVertexData(Yt+1,nr,Ht,Math.round(32*Et.tr.x),Math.round(32*(rr+Et.tr.y)),Et.texPrimary.x+Et.texPrimary.w,Et.texPrimary.y,Ot,xt,Et.pixelOffsetBR.x,Et.pixelOffsetTL.y,Et.minFontScaleX,Et.minFontScaleY),this.text.updateSymbolVertexData(Yt+2,nr,Ht,Math.round(32*Et.bl.x),Math.round(32*(rr+Et.bl.y)),Et.texPrimary.x,Et.texPrimary.y+Et.texPrimary.h,Ot,xt,Et.pixelOffsetTL.x,Et.pixelOffsetBR.y,Et.minFontScaleX,Et.minFontScaleY),this.text.updateSymbolVertexData(Yt+3,nr,Ht,Math.round(32*Et.br.x),Math.round(32*(rr+Et.br.y)),Et.texPrimary.x+Et.texPrimary.w,Et.texPrimary.y+Et.texPrimary.h,Ot,xt,Et.pixelOffsetBR.x,Et.pixelOffsetBR.y,Et.minFontScaleX,Et.minFontScaleY)}return{vertexOffsetDelta:e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices,hasChanges:!0}}if(i.isUsingAppearanceTextVertexData){const Se=i.layoutBasedTextVertexData.length/12;for(let we=0;we<Se;++we){const Ie=we*12;this.text.updateSymbolVertexData(g+we,i.layoutBasedTextVertexData[Ie+0],i.layoutBasedTextVertexData[Ie+1],i.layoutBasedTextVertexData[Ie+2],i.layoutBasedTextVertexData[Ie+3],i.layoutBasedTextVertexData[Ie+4],i.layoutBasedTextVertexData[Ie+5],i.layoutBasedTextVertexData[Ie+6],i.layoutBasedTextVertexData[Ie+7],i.layoutBasedTextVertexData[Ie+8],i.layoutBasedTextVertexData[Ie+9],i.layoutBasedTextVertexData[Ie+10],i.layoutBasedTextVertexData[Ie+11])}return i.isUsingAppearanceTextVertexData=!1,{vertexOffsetDelta:Se,hasChanges:!0}}return{vertexOffsetDelta:e.numHorizontalGlyphVertices+e.numVerticalGlyphVertices,hasChanges:!1}}update(e,i,c,f,g,y,b){this.text.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,this.worldview),this.icon.programConfigurations.updatePaintArrays(e,i,g,c,f,y,b,this.worldview)}updateRoadElevation(e){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let i=!1;const c=zt(e),f=1/c;let g=!1,y=!1;for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b),M=$e(1,0,0),R=$e(0,1,0),{numHorizontalGlyphVertices:z,numVerticalGlyphVertices:B,numIconVertices:j,numVerticalIconVertices:V}=E,Y=z>0||B>0,re=j>0,J=this.elevationFeatures[E.elevationFeatureIndex];if(J){const oe=new yt(E.tileAnchorX,E.tileAnchorY),ce=.075+J.pointElevation(oe);E.zOffset!==ce&&(i=!0,E.zOffset=ce),ce!==0&&(this.hasAnyZOffset=!0);const pe=J.computeSlopeNormal(oe,f),Se=Ci(no(),$e(0,0,1),pe);zn(M,M,Se),zn(R,R,Se),M[2]*=c,R[2]*=c,M[0]===1&&M[1]===0&&M[2]===0&&R[0]===0&&R[1]===1&&R[2]===0||(g=g||Y,y=y||re)}if(Y&&(p2(this.text.orientationVertexArray,z,M,R),p2(this.text.orientationVertexArray,B,M,R)),re){const{placedIconSymbolIndex:oe,verticalPlacedIconSymbolIndex:ce}=E;oe>=0&&p2(this.icon.orientationVertexArray,j,M,R),ce>=0&&p2(this.icon.orientationVertexArray,V,M,R)}}g||(this.text.orientationVertexArray=void 0),y||(this.icon.orientationVertexArray=void 0),i&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const e=(g,y,b)=>{c+=y,c>g.length&&g.resize(c);for(let E=-y;E<0;E++)g.emplace(E+c,b)},i=(g,y,b)=>{f+=y,f>g.length&&g.resize(f);for(let E=-y;E<0;E++)g.emplace(E+f,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,f=0;for(let g=0;g<this.symbolInstances.length;g++){const y=this.symbolInstances.get(g),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:E,numIconVertices:M}=y,R=y.zOffset,z=M>0;if((b>0||E>0)&&(e(this.text.zOffsetVertexArray,b,R),e(this.text.zOffsetVertexArray,E,R)),z){const{placedIconSymbolIndex:B,verticalPlacedIconSymbolIndex:j}=y;B>=0&&i(this.icon.zOffsetVertexArray,M,R),j>=0&&i(this.icon.zOffsetVertexArray,y.numVerticalIconVertices,R)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e,i,c,f,g){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,this.hasAppearances),this.hasAppearances===null&&(this.hasAppearances=this.layers.some(y=>y.appearances&&y.appearances.length>0)),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload,this.hasAppearances),this.uploaded=!0}updateAppearances(e,i,c,f,g){if(!(e&&i&&c&&this.appearanceFeatureData))return!1;const y=this.icon.layoutVertexArray&&this.icon.layoutVertexArray.length>0&&this.icon.layoutVertexArray.arrayBuffer,b=this.text.layoutVertexArray&&this.text.layoutVertexArray.length>0&&this.text.layoutVertexArray.arrayBuffer;if(!y&&!b)return!1;const E=this.layers[0],M=E.layout;let R=1,z=0,B=!1;if(y){const[J,oe]=M.get("icon-size-scale-range");R=Ee(1,J,oe)}let j=1,V=0,Y=!1;if(b){const[J,oe]=M.get("text-size-scale-range");j=Ee(1,J,oe)}const re=new Map;if(g&&c)for(const J of c){const oe=g.getImage(J,E.scope);if(oe){const ce=new Wa(J.toString());re.set(ce.toString(),oe)}}for(let J=0;J<this.symbolInstances.length;J++){const oe=this.symbolInstances.get(J),ce=this.featureToAppearanceIndex[oe.featureIndex],pe=ce!==void 0?this.appearanceFeatureData[ce]:void 0;if(!pe)continue;const Se=pe.id,we=i&&Se!==void 0?i[String(Se)]:void 0,Ie={type:"Point",id:pe.id,properties:pe.properties,geometry:[]},Pe=E.appearances&&E.appearances.find(Oe=>Oe.isActive({globals:f,feature:Ie,canonical:e,featureState:we}));if(b){const Oe=M.get("text-size"),ke=M.get("text-offset").evaluate(Ie,we,e),Ge=Oe.evaluate(Ie,we,e),pt=M.get("text-rotate").evaluate(Ie,we,e),ct=this.textSizeData.kind==="composite"?this.textSizeData.minZoom:0,dt=this.textSizeData.kind==="composite"?this.textSizeData.maxZoom:0,St=Oe.evaluate(Ie,{zoom:ct},e),At=Oe.evaluate(Ie,{zoom:dt},e),Tt=this.updateSymbolInstanceTextVertices(oe,pe,Pe,Ie,V,e,E,j,re,we,ke,Ge,pt,St,At,ct,dt,c);V+=Tt.vertexOffsetDelta,Y=Y||Tt.hasChanges}if(y){const Oe=M.get("icon-offset").evaluate(Ie,we,e),ke=M.get("icon-size").evaluate(Ie,we,e,c),Ge=M.get("icon-rotate").evaluate(Ie,we,e),pt=this.updateSymbolInstanceIconVertices(oe,pe,Pe,Ie,z,e,c,f,E,R,we,Oe,ke,Ge);z+=pt.vertexOffsetDelta,B=B||pt.hasChanges}pe.activeAppearance=Pe}return B&&this.icon.layoutVertexBuffer&&this.icon.layoutVertexArray.arrayBuffer!==null&&this.icon.layoutVertexArray.length===this.icon.layoutVertexBuffer.length&&this.icon.layoutVertexBuffer.updateData(this.icon.layoutVertexArray),Y&&this.text.layoutVertexBuffer&&this.text.layoutVertexArray.arrayBuffer!==null&&this.text.layoutVertexArray.length===this.text.layoutVertexBuffer.length&&this.text.layoutVertexBuffer.updateData(this.text.layoutVertexArray),B||Y}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=wL(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const c=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:f,y:g}of i)this.lineVertexArray.emplaceBack(f,g);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y,re,J,oe){const ce=e.indexArray,pe=e.layoutVertexArray,Se=e.globeExtVertexArray,we=e.segments.prepareSegment(4*oe,pe,ce,this.canOverlap?y.sortKey:void 0),Ie=this.glyphOffsetArray.length,Pe=we.vertexLength,Oe=this.allowVerticalPlacement&&b===nc.vertical?Math.PI/2:0,ke=y.text&&y.text.sections;for(let ct=0;ct<i.length;ct++){const{tl:dt,tr:St,bl:At,br:Tt,texPrimary:lt,texSecondary:Ot,pixelOffsetTL:xt,pixelOffsetBR:It,minFontScaleX:Et,minFontScaleY:rr,glyphOffset:nr,isSDF:Ht,sectionIndex:Yt}=i[ct],wr=we.vertexLength,gr=nr[1];if(m1(pe,M.x,M.y,dt.x,gr+dt.y,lt.x,lt.y,c,Ht,xt.x,xt.y,Et,rr),m1(pe,M.x,M.y,St.x,gr+St.y,lt.x+lt.w,lt.y,c,Ht,It.x,xt.y,Et,rr),m1(pe,M.x,M.y,At.x,gr+At.y,lt.x,lt.y+lt.h,c,Ht,xt.x,It.y,Et,rr),m1(pe,M.x,M.y,Tt.x,gr+Tt.y,lt.x+lt.w,lt.y+lt.h,c,Ht,It.x,It.y,Et,rr),E){const{x:tr,y:Fr,z:nn}=E.anchor,[On,Yr,Hn]=E.up;_1(Se,tr,Fr,nn,On,Yr,Hn),_1(Se,tr,Fr,nn,On,Yr,Hn),_1(Se,tr,Fr,nn,On,Yr,Hn),_1(Se,tr,Fr,nn,On,Yr,Hn),Jv(e.dynamicLayoutVertexArray,tr,Fr,nn,Oe)}else Jv(e.dynamicLayoutVertexArray,M.x,M.y,M.z,Oe);if(re){const tr=Ot||lt;g1(e.iconTransitioningVertexArray,tr.x,tr.y),g1(e.iconTransitioningVertexArray,tr.x+tr.w,tr.y),g1(e.iconTransitioningVertexArray,tr.x,tr.y+tr.h),g1(e.iconTransitioningVertexArray,tr.x+tr.w,tr.y+tr.h)}ce.emplaceBack(wr,wr+1,wr+2),ce.emplaceBack(wr+1,wr+2,wr+3),we.vertexLength+=4,we.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(nr[0]),ct!==i.length-1&&Yt===i[ct+1].sectionIndex||e.programConfigurations.populatePaintArrays(pe.length,y,y.index,{},j,V,Y,ke&&ke[Yt],this.worldview)}const Ge=oe-i.length;Ge!==0&&this._addNullVertices(Ge,pe,c,E,Se,e,re,we,ce);const pt=E?E.anchor:M;e.placedSymbolArray.emplaceBack(pt.x,pt.y,pt.z,M.x,M.y,Ie,this.glyphOffsetArray.length-Ie,Pe,R,z,M.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],b,0,0,0,B,0),e.symbolInstanceIndices.push(J)}_addNullVertices(e,i,c,f,g,y,b,E,M){for(let R=0;R<e;R++){for(let B=0;B<4;B++)m1(i,0,0,0,0,0,0,c,!1,0,0,0,0),f&&_1(g,0,0,0,0,0,0),Jv(y.dynamicLayoutVertexArray,0,0,0,0),b&&g1(y.iconTransitioningVertexArray,0,0);const z=E.vertexLength;M.emplaceBack(z,z+1,z+2),M.emplaceBack(z+1,z+2,z+3),E.vertexLength+=4,E.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(0)}}_commitLayoutVertex(e,i,c,f,g,y,b){e.emplaceBack(i,c,f,g,y,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(e,i,c,f,g,y,b){const E=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),M=E.vertexLength,R=b.tileAnchorX,z=b.tileAnchorY;for(let j=0;j<4;j++)c.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(c.collisionVertexArrayExt,i,e.padding,b.zOffset),this._commitLayoutVertex(c.layoutVertexArray,f,g,y,R,z,new yt(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,g,y,R,z,new yt(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,g,y,R,z,new yt(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,g,y,R,z,new yt(e.x1,e.y2)),E.vertexLength+=4;const B=c.indexArray;B.emplaceBack(M,M+1),B.emplaceBack(M+1,M+2),B.emplaceBack(M+2,M+3),B.emplaceBack(M+3,M),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,c,f,g,y){for(let b=f;b<g;b++){const E=c.get(b),M=this.getSymbolInstanceTextSize(e,y,i,b);this._addCollisionDebugVertices(E,M,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,i,c,f,g,y){for(let b=f;b<g;b++){const E=c.get(b),M=this.getSymbolInstanceIconSize(e,i,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,M,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,i,c){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uE(pf,kz.members,rl),this.iconCollisionBox=new uE(pf,kz.members,rl);const f=Wv(this.iconSizeData,e),g=Wv(this.textSizeData,e,c);for(let y=0;y<this.symbolInstances.length;y++){const b=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(g,e,i,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(g,e,i,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(f,e,i,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(f,e,i,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(e,i,c,f){const g=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:f),y=eE(this.textSizeData,e,g)/co;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,i,c){const f=this.icon.placedSymbolArray.get(c),g=eE(this.iconSizeData,e,f);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(e,i,c,f){e.emplaceBack(i,-c,-c,f),e.emplaceBack(i,c,-c,f),e.emplaceBack(i,c,c,f),e.emplaceBack(i,-c,c,f)}_updateTextDebugCollisionBoxes(e,i,c,f,g,y,b){for(let E=f;E<g;E++){const M=c.get(E),R=this.getSymbolInstanceTextSize(e,y,i,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,R,M.padding,y.zOffset)}}_updateIconDebugCollisionBoxes(e,i,c,f,g,y,b){for(let E=f;E<g;E++){const M=c.get(E),R=this.getSymbolInstanceIconSize(e,i,y.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,R,M.padding,y.zOffset)}}updateCollisionDebugBuffers(e,i,c,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const g=Wv(this.iconSizeData,e,f),y=Wv(this.textSizeData,e,c);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(y,e,i,E.textBoxStartIndex,E.textBoxEndIndex,E,c),this._updateTextDebugCollisionBoxes(y,e,i,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E,c),this._updateIconDebugCollisionBoxes(g,e,i,E.iconBoxStartIndex,E.iconBoxEndIndex,E,f),this._updateIconDebugCollisionBoxes(g,e,i,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,c,f,g,y,b,E,M){const R={};if(i<c){const{x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe,featureIndex:Se}=e.get(i);R.textBox={x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe},R.textFeatureIndex=Se}if(f<g){const{x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe,featureIndex:Se}=e.get(f);R.verticalTextBox={x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe},R.verticalTextFeatureIndex=Se}if(y<b){const{x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe,featureIndex:Se}=e.get(y);R.iconBox={x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe},R.iconFeatureIndex=Se}if(E<M){const{x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe,featureIndex:Se}=e.get(E);R.verticalIconBox={x1:z,y1:B,x2:j,y2:V,padding:Y,projectedAnchorX:re,projectedAnchorY:J,projectedAnchorZ:oe,tileAnchorX:ce,tileAnchorY:pe},R.verticalIconFeatureIndex=Se}return R}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const c=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,i){const c=e.placedSymbolArray.get(i),f=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<f;g+=4)e.indexArray.emplaceBack(g,g+1,g+2),e.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(e),c=Math.cos(e),f=[],g=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const E=this.symbolInstances.get(b);f.push(0|Math.round(i*E.tileAnchorX+c*E.tileAnchorY)),g.push(E.featureIndex)}return y.sort((b,E)=>f[b]-f[E]||g[E]-g[b]),y}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let e=0;e<this.symbolInstances.length;++e)this.symbolInstanceIndexesSortedZOffset.push(e)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((e,i)=>this.symbolInstances.get(i).zOffset-this.symbolInstances.get(e).zOffset)}addToSortKeyRanges(e,i){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===i?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const c=this.symbolInstances.get(i);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:M}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),g>=0&&g!==f&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&y!==g&&y!==f&&this.addIndicesForPlacedSymbol(this.text,y),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}getElevationFeatureForText(e){const i=this.symbolInstances.get(this.text.symbolInstanceIndices[e]).elevationFeatureIndex;let c;return this.elevationFeatures&&i<this.elevationFeatures.length&&(c=this.elevationFeatures[i]),c}}function AL(s,e){return e.replace(/{([^{}]+)}/g,(i,c)=>c in s?String(s[c]):"")}let TL,SL,hE;jt(m2,"SymbolBucket",{omit:["layers","collisionBoxArray","compareText","features"]}),m2.addDynamicAttributes=Jv;class EL{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ss,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}jt(EL,"FormatSectionOverride",{omit:["defaultValue"]});const dE=()=>hE||(hE={layout:TL||(TL=new vi({"symbol-placement":new Ft(Ye.layout_symbol["symbol-placement"]),"symbol-spacing":new Ft(Ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ft(Ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qt(Ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ft(Ye.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Ft(Ye.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Ft(Ye.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Ft(Ye.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ft(Ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ft(Ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ft(Ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qt(Ye.layout_symbol["icon-size"]),"icon-size-scale-range":new Ft(Ye.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Qt(Ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qt(Ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qt(Ye.layout_symbol["icon-image"]),"icon-image-use-theme":new Ft({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new Qt(Ye.layout_symbol["icon-rotate"]),"icon-padding":new Ft(Ye.layout_symbol["icon-padding"]),"icon-keep-upright":new Ft(Ye.layout_symbol["icon-keep-upright"]),"icon-offset":new Qt(Ye.layout_symbol["icon-offset"]),"icon-anchor":new Qt(Ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ft(Ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ft(Ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ft(Ye.layout_symbol["text-rotation-alignment"]),"text-field":new Qt(Ye.layout_symbol["text-field"]),"text-font":new Qt(Ye.layout_symbol["text-font"]),"text-size":new Qt(Ye.layout_symbol["text-size"]),"text-size-scale-range":new Ft(Ye.layout_symbol["text-size-scale-range"]),"text-max-width":new Qt(Ye.layout_symbol["text-max-width"]),"text-line-height":new Qt(Ye.layout_symbol["text-line-height"]),"text-letter-spacing":new Qt(Ye.layout_symbol["text-letter-spacing"]),"text-justify":new Qt(Ye.layout_symbol["text-justify"]),"text-radial-offset":new Qt(Ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ft(Ye.layout_symbol["text-variable-anchor"]),"text-anchor":new Qt(Ye.layout_symbol["text-anchor"]),"text-max-angle":new Ft(Ye.layout_symbol["text-max-angle"]),"text-writing-mode":new Ft(Ye.layout_symbol["text-writing-mode"]),"text-rotate":new Qt(Ye.layout_symbol["text-rotate"]),"text-padding":new Ft(Ye.layout_symbol["text-padding"]),"text-keep-upright":new Ft(Ye.layout_symbol["text-keep-upright"]),"text-transform":new Qt(Ye.layout_symbol["text-transform"]),"text-offset":new Qt(Ye.layout_symbol["text-offset"]),"text-allow-overlap":new Ft(Ye.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ft(Ye.layout_symbol["text-ignore-placement"]),"text-optional":new Ft(Ye.layout_symbol["text-optional"]),visibility:new Ft(Ye.layout_symbol.visibility)})),paint:SL||(SL=new vi({"icon-opacity":new Qt(Ye.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Qt(Ye.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Qt(Ye.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Qt(Ye.paint_symbol["text-emissive-strength"]),"icon-color":new Qt(Ye.paint_symbol["icon-color"]),"icon-halo-color":new Qt(Ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qt(Ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qt(Ye.paint_symbol["icon-halo-blur"]),"icon-translate":new Ft(Ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ft(Ye.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ft(Ye.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Qt(Ye.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Qt(Ye.paint_symbol["text-occlusion-opacity"]),"text-color":new Qt(Ye.paint_symbol["text-color"],{runtimeType:Zo,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new Qt(Ye.paint_symbol["text-halo-color"]),"text-halo-width":new Qt(Ye.paint_symbol["text-halo-width"]),"text-halo-blur":new Qt(Ye.paint_symbol["text-halo-blur"]),"text-translate":new Ft(Ye.paint_symbol["text-translate"]),"text-translate-anchor":new Ft(Ye.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Ft(Ye.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Ft(Ye.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Ft(Ye.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Ft(Ye.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Qt(Ye.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},hE);class g2 extends No{constructor(e,i,c,f){super(e,dE(),i,c,f,e.layout?e.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=K([]),this.hasOcclusionOpacityProperties=e.paint!==void 0&&("icon-occlusion-opacity"in e.paint||"text-occlusion-opacity"in e.paint)}_handleSpecialPaintPropertyUpdate(e){e!=="icon-occlusion-opacity"&&e!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(e,i){super.recalculate(e,i),this.appearances&&this.appearances.forEach(f=>{f.recalculate(e,i,this.iconImageUseTheme)}),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const g of c)f.indexOf(g)<0&&f.push(g);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(e,i,c,f){return this._saturation===e&&this._contrast===i&&this._brightnessMin===c&&this._brightnessMax===f||(this._colorAdjustmentMatrix=(function(g,y,b,E){g=ki(g),y=ti(y);const M=Q(),R=g/3,z=1-2*R,B=[z,R,R,0,R,z,R,0,R,R,z,0,0,0,0,1],j=.5-.5*y,V=E-b;return ue(M,[V,0,0,0,0,V,0,0,0,0,V,0,b,b,b,1],[y,0,0,0,0,y,0,0,0,0,y,0,j,j,j,1]),ue(M,M,B),M})(e,i,c,f),this._saturation=e,this._contrast=i,this._brightnessMin=c,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(e,i,c,f){const g=this.layout.get(e).evaluate(i,{},c,f),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||td(y.value)||!g?g:AL(i.properties,g)}getAppearanceValueAndResolveTokens(e,i,c,f,g){const y=e.getProperty(i);if(!y)return;const b=y.evaluate(c,{},f,g),E=e.getUnevaluatedProperties()._values[i];return E.isDataDriven()||td(E.value)||!b||typeof b!="string"?b:AL(c.properties,b)}createBucket(e){return new m2(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of dE().paint.overridableProperties){if(!g2.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),c=new EL(i),f=new bp(c,i.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let g=null;g=i.value.kind==="constant"||i.value.kind==="source"?new Lo("source",f):new wo("composite",f,i.value.zoomStops,i.value.interpolationType),this.paint._values[e]=new lh(i.property,g,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,c){return!(!this.layout||i.isDataDriven()||c.isDataDriven())&&g2.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const c=e.get("text-field"),f=dE().paint.properties[i];let g=!1;const y=b=>{for(const E of b)if(f.overrides&&f.overrides.hasOverride(E))return void(g=!0)};if(c.value.kind==="constant"&&c.value.value instanceof xo)y(c.value.value.sections);else if(c.value.kind==="source"){const b=M=>{g||(M instanceof Ws&&xa(M.value)===jd?y(M.value.sections):M instanceof mr?y(M.sections):M.eachChild(b))},E=c.value;E._styleExpression&&b(E._styleExpression.expression)}return g}getProgramIds(){return["symbol"]}getDefaultProgramParams(e,i,c){return{config:new F(this,{zoom:i,lut:c}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let ML,OL,CL,IL;var fE=en([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function _2(s,e,i,c,f,g,y,b){const E=[s,e,1,i,c,1,f,g,1],M=[y,b,1],R=G([],E),[z,B,j]=Ur(M,M,R);return q(E,E,[z,0,0,0,B,0,0,0,j])}function PL(s,e,i,c,f,g,y,b){const E=(function(M,R,z,B,j,V,Y,re){const J=_2(0,0,1,0,1,1,0,1),oe=_2(M,R,z,B,j,V,Y,re);return q(oe,oe,G([],J))})(s,e,i,c,f,g,y,b);return[E[2]/E[8]/Gt,E[5]/E[8]/Gt]}function y2(s){return[s[0],Math.min(Math.max(s[1],-85.051129),je)]}class DL extends Qc{constructor(e,i,c,f){super(),this.id=e,this.dispatcher=c,this.coordinates=i.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=i,this._dirty=!1}load(e,i){if(this._loaded=i||!1,this.fire(new gl("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return e&&(this.coordinates=e),this._loaded=!0,void this._finishLoading();this._imageRequest=Qf(this.map._requestManager.transformRequest(this.url,va.Image),(c,f)=>{this._imageRequest=null,this._loaded=!0,c?this.fire(new Fd(c)):f&&(this.image=f instanceof HTMLImageElement?Is.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading())})}loaded(){return this._loaded}updateImage(e){return e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}setTexture(e){if(!(e.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new r1(this.map.painter.context,e.handle),this.width=e.dimensions[0],this.height=e.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new gl("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(e){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof r1||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(e){if(this.coordinates=e,this._boundsArray=void 0,this._unsupportedCoords=!1,!e.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let i=e[0][1],c=e[0][1];for(const g of e)g[1]>c&&(c=g[1]),g[1]<i&&(i=g[1]);const f=(c+i)/2;if(f>je?this.onNorthPole=!0:f<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=e.map(qt.fromLngLat);this.tileID=(function(y){let b=1/0,E=1/0,M=-1/0,R=-1/0;for(const Y of y)b=Math.min(b,Y.x),E=Math.min(E,Y.y),M=Math.max(M,Y.x),R=Math.max(R,Y.y);const z=Math.max(M-b,R-E),B=Math.max(0,Math.floor(-Math.log2(z))),j=Math.pow(2,B);let V=Math.floor((b+M)/2*j);return V>1&&(V-=1),new Bc(B,V,Math.floor((E+R)/2*j))})(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new gl("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof r1||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(e){for(const J in this.tiles){const oe=this.tiles[J];oe.state!=="loaded"&&(oe.state="loaded",oe.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const i=u1(new Bc(0,0,0),this.map.transform.projection),c=[i.projection.project(this.coordinates[0][0],this.coordinates[0][1]),i.projection.project(this.coordinates[1][0],this.coordinates[1][1]),i.projection.project(this.coordinates[2][0],this.coordinates[2][1]),i.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(J){const oe=J[1].x-J[0].x,ce=J[1].y-J[0].y,pe=J[2].x-J[1].x,Se=J[2].y-J[1].y,we=J[3].x-J[2].x,Ie=J[3].y-J[2].y,Pe=J[0].x-J[3].x,Oe=J[0].y-J[3].y,ke=oe*Se-pe*ce,Ge=pe*Ie-we*Se,pt=we*Oe-Pe*Ie,ct=Pe*ce-oe*Oe;return ke>0&&Ge>0&&pt>0&&ct>0||ke<0&&Ge<0&&pt<0&&ct<0})(c))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=u1(this.tileID,this.map.transform.projection),[g,y,b,E]=this.coordinates.map(J=>{const oe=f.projection.project(J[0],J[1]);return _L(f,oe)._round()});this.perspectiveTransform=PL(g.x,g.y,y.x,y.y,b.x,b.y,E.x,E.y);const M=this._boundsArray=new Rc;M.emplaceBack(g.x,g.y,0,0),M.emplaceBack(y.x,y.y,Gt,0),M.emplaceBack(E.x,E.y,0,Gt),M.emplaceBack(b.x,b.y,Gt,Gt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=e.createVertexBuffer(M,fE.members),this.boundsSegments=ui.simpleSegment(0,0,4,2);const R=[],z=[y2((B=this.coordinates)[0]),y2(B[1]),y2(B[2]),y2(B[3])];var B;const[j,V,Y,re]=(function(J){let oe=J[0][0],ce=oe,pe=J[0][1],Se=pe;for(let we=1;we<J.length;we++)J[we][0]<oe?oe=J[we][0]:J[we][0]>ce&&(ce=J[we][0]),J[we][1]<pe?pe=J[we][1]:J[we][1]>Se&&(Se=J[we][1]);return[oe,pe,ce-oe,Se-pe]})(z);{const J=new Rc,[oe,ce,pe,Se]=(function(Tt){let lt=Tt[0].x,Ot=lt,xt=Tt[0].y,It=xt;for(let Et=1;Et<Tt.length;Et++)Tt[Et].x<lt?lt=Tt[Et].x:Tt[Et].x>Ot&&(Ot=Tt[Et].x),Tt[Et].y<xt?xt=Tt[Et].y:Tt[Et].y>It&&(It=Tt[Et].y);return[lt,xt,Ot-lt,It-xt]})(c),we=Tt=>[(Tt.x-oe)/pe,(Tt.y-ce)/Se],[Ie,Pe,Oe,ke]=c.map(we),Ge=(function(Tt,lt,Ot,xt,It,Et,rr,nr){const Ht=_2(0,0,1,0,1,1,0,1);return q(Ht,Ht,G([],_2(Tt,lt,Ot,xt,It,Et,rr,nr)))})(Ie[0],Ie[1],Pe[0],Pe[1],Oe[0],Oe[1],ke[0],ke[1]);this.elevatedGlobePerspectiveTransform=PL(Ie[0],Ie[1],Pe[0],Pe[1],Oe[0],Oe[1],ke[0],ke[1]);const pt=(Tt,lt)=>{R.push(Tt.lng);const Ot=Math.round((Tt.lng-j)/Y*Gt),xt=Math.round((Tt.lat-V)/re*Gt),It=we(lt),Et=Ur([],[It[0],It[1],1],Ge),rr=Math.round(Et[0]/Et[2]*Gt),nr=Math.round(Et[1]/Et[2]*Gt);J.emplaceBack(Ot,xt,rr,nr)},ct=c[3].x-c[0].x,dt=c[3].y-c[0].y,St=c[2].x-c[1].x,At=c[2].y-c[1].y;for(let Tt=0;Tt<65;Tt++){const lt=Tt/64,Ot=[c[0].x+lt*ct,c[0].y+lt*dt],xt=[c[1].x+lt*St,c[1].y+lt*At],It=xt[0]-Ot[0],Et=xt[1]-Ot[1];for(let rr=0;rr<65;rr++){const nr=rr/64,Ht={x:Ot[0]+It*nr,y:Ot[1]+Et*nr};pt(i.projection.unproject(Ht.x,Ht.y),Ht)}}this.elevatedGlobeVertexBuffer=e.createVertexBuffer(J,fE.members)}{this.maxLongitudeTriangleSize=0;let J=[],oe=new pa;const ce=(pe,Se,we)=>{oe.emplaceBack(pe,Se,we);const Ie=R[pe],Pe=R[Se],Oe=R[we],ke=Math.min(Math.min(Ie,Pe),Oe),Ge=Math.max(Math.max(Ie,Pe),Oe)-ke;Ge>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ge),J.push(ke+Ge/2)};for(let pe=0;pe<64;pe++)for(let Se=0;Se<64;Se++){const we=65*pe+Se,Ie=we+1,Pe=we+65,Oe=Pe+1;ce(we,Pe,Ie),ce(Ie,Pe,Oe)}[J,oe]=(function(pe,Se){const we=Array.from({length:pe.length},(Oe,ke)=>ke);we.sort((Oe,ke)=>pe[Oe]-pe[ke]);const Ie=[],Pe=new pa;for(let Oe=0;Oe<we.length;Oe++){const ke=we[Oe];Ie.push(pe[ke]);const Ge=3*ke,pt=Ge+1;Pe.emplaceBack(Se.uint16[Ge],Se.uint16[pt],Se.uint16[pt+1])}return[Ie,Pe]})(J,oe),this.elevatedGlobeTrianglesCenterLongitudes=J,this.elevatedGlobeIndexBuffer=e.createIndexBuffer(oe)}this.elevatedGlobeSegments=ui.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,Y/Gt,0,re/Gt,0,0,V,j,0])}prepare(){const e=Object.keys(this.tiles).length!==0;if(this.tileID&&!e)return;const i=this.map.painter.context,c=i.gl;!this._dirty||this.texture instanceof r1||(this.texture?this.texture.update(this.image):(this.texture=new kS(i,this.image,c.RGBA8),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),e&&this._prepareData(i)}loadTile(e,i){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},i(null)):(e.state="errored",i(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(e){const i=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!i)return null;const c=this.elevatedGlobeTrianglesCenterLongitudes;let f=(g=e+180)+360*Math.round((c[0]-g)/360);var g;const y=new ui,b=(z,B)=>{y.segments.push({vertexOffset:0,primitiveOffset:z,vertexLength:i.segments[0].vertexLength,primitiveLength:B,sortKey:void 0,vaos:{}})},E=.51*this.maxLongitudeTriangleSize;if(Math.abs(c[0]-f)<=E){const z=jn(c,0,c.length,f+E);return z===c.length||b(z,Nn(c,z+1,c.length,f+360-E)-z),y}f<c[0]&&(f+=360);const M=Nn(c,0,c.length,f-E);if(M===c.length)return b(0,c.length),y;b(0,M-0);const R=jn(c,M+1,c.length,f+E);return R!==c.length&&b(R,c.length-R),y}}const pE=1024,Tq=(Math.pow(pE,2)-1)/268170240;class RL extends No{constructor(e,i,c,f){super(e,{layout:CL||(CL=new vi({visibility:new Ft(Ye.layout_raster.visibility)})),paint:IL||(IL=new vi({"raster-opacity":new Ft(Ye.paint_raster["raster-opacity"]),"raster-color":new sd(Ye.paint_raster["raster-color"]),"raster-color-mix":new Ft(Ye.paint_raster["raster-color-mix"]),"raster-color-range":new Ft(Ye.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ft(Ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ft(Ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ft(Ye.paint_raster["raster-brightness-max"]),"raster-saturation":new Ft(Ye.paint_raster["raster-saturation"]),"raster-contrast":new Ft(Ye.paint_raster["raster-contrast"]),"raster-resampling":new Ft(Ye.paint_raster["raster-resampling"]),"raster-fade-duration":new Ft(Ye.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Ft(Ye.paint_raster["raster-emissive-strength"]),"raster-array-band":new Ft(Ye.paint_raster["raster-array-band"]),"raster-elevation":new Ft(Ye.paint_raster["raster-elevation"]),"raster-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},i,c,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(e){return!(e&&e._source instanceof DL&&(e._source.onNorthPole||e._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(e){e!=="raster-color"&&e!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(e){if(!this.hasColorMap()||!this._curRampRange)return;const i=this._transitionablePaint._values["raster-color"].value.expression,[c,f]=e||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(c)&&isNaN(f)||c===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=pg({expression:i,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:c,end:f}],resolution:pE}),this.colorRampTexture=null,this._curRampRange=[c,f])}is3D(e){return this.paint.get("raster-elevation")>0}}let zL,LL,BL,kL,FL;class NL extends No{constructor(e,i,c,f){super(e,{layout:zL||(zL=new vi({visibility:new Ft(Ye["layout_raster-particle"].visibility)})),paint:LL||(LL=new vi({"raster-particle-array-band":new Ft(Ye["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Ft(Ye["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new sd(Ye["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Ft(Ye["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Ft(Ye["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Ft(Ye["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Ft(Ye["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Ft(Ye["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},i,c,f),this._updateColorRamp(),this.lastInvalidatedAt=Is.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(e){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(e){return!1}_handleSpecialPaintPropertyUpdate(e){e!=="raster-particle-color"&&e!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),e==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const e=this._transitionablePaint._values["raster-particle-color"].value.expression,i=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=pg({expression:e,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:i}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Is.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Sq extends No{constructor(e,i){super(e,{},i,null),this.implementation=e,e.slot&&(this.slot=e.slot)}is3D(e){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(e){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}function mE(s,e,i){const c=[0,0,1],f=Ai([]);return Ha(f,f,i?-yr(s)+Math.PI:yr(s)),ga(f,f,-yr(e)),zn(c,c,f),Xt(c,c)}const jL={None:0,Model:1,Symbol:2,FillExtrusion:4};class v2{constructor(e,i,c,f){this.message=(e?`${e}: `:"")+c,f&&(this.identifier=f),i!=null&&i.__line__&&(this.line=i.__line__)}}function gE(s,e){const i=s.indexOf("://")===-1;try{return new URL(s,i&&e?"http://example.com":void 0),!0}catch{return!1}}class UL{constructor(e,i){this.feature=e,this.instancedDataOffset=i,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class VL{constructor(){this.maxScale=1,this.maxXYTranslationDistance=0,this.instancedDataArray=new Kl,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}colorForInstance(e){const i=16*e,c=this.instancedDataArray.float32;let f=Math.floor(c[i+2]);const g=1.05*(c[i+2]-f);return f/=100,[c[i]%1*1.05,c[i+1]%1*1.05,g,f]}tileCoordinatesForInstance(e){const i=16*e,c=this.instancedDataArray.float32;let f=c[i+0];return f=f>Gt?f-Gt:f,new yt(Math.trunc(f),Math.trunc(c[i+1]))}translationForInstance(e){const i=16*e,c=this.instancedDataArray.float32;return[c[i+4],c[i+5],c[i+6]]}rotationScaleForInstance(e){const i=16*e,c=this.instancedDataArray.float32;return[c[i+7],c[i+8],c[i+9],c[i+10],c[i+11],c[i+12],c[i+13],c[i+14],c[i+15]]}transformForInstance(e){const i=16*e,c=this.instancedDataArray.float32;return[c[i+7],c[i+8],c[i+9],c[i+4],c[i+10],c[i+11],c[i+12],c[i+5],c[i+13],c[i+14],c[i+15],c[i+6],0,0,0,1]}}class _E{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaledZ=this.canonical.z+Math.log2(e.overscaling),this.layers=e.layers,this.layerIds=this.layers.map(i=>i.fqid),this.projection=e.projection,this.index=e.index,this.worldview=e.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=e.styleDefinedModelURLs,this.hasAppearances=null}updateFootprints(e,i){}updateAppearances(e,i,c,f){}populate(e,i,c,f){this.tileToMeter=zt(c);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);const y=this.layers[0].paint.get("model-elevation-reference")==="hd-road-markup"?i.elevationFeatures:void 0;for(const{feature:b,id:E,index:M,sourceLayerIndex:R}of e){const z=E??(b.properties&&b.properties.hasOwnProperty("id")?b.properties.id:void 0),B=Vr(b,g);if(!this.layers[0]._featureFilter.filter(new In(this.zoom,{worldview:this.worldview,activeFloors:i.activeFloors}),B,c))continue;const j={id:z,sourceLayerIndex:R,index:M,geometry:g?B.geometry:Ir(b,c,f),properties:b.properties,type:b.type,patterns:{}},V=this.addFeature(j,j.geometry,B,y,c);V&&i.featureIndex.insert(b,j.geometry,M,R,this.index,this.instancesPerModel[V].instancedDataArray.length,256)}this.lookup=null}evaluateQueryRenderedFeaturePadding(){const e=this.layers[0].modelManager,i=this.layers[0].scope;let c=0;for(const f of this.modelUris){const g=e.getModel(f,i);if(!g)continue;const y=this.instancesPerModel[f];if(y){const b=.5*Er(g.aabb.max,g.aabb.min)*y.maxScale+y.maxXYTranslationDistance,E=Math.min(Gt,Math.max(b/this.tileToMeter,256));c=Math.max(E,c)}}return c}update(e,i,c,f){for(const g in this.instancesPerModel){const y=this.instancesPerModel[g];for(const b in e)y.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(y.features[y.idToFeaturesIndex[b]],e[b],y,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let e=!1;for(const i in this.instancesPerModel){const c=this.instancesPerModel[i];for(const f of c.features){const g=this.layers[0],y=f.feature,b=this.canonical,E=g.paint.get("model-rotation").evaluate(y,{},b),M=g.paint.get("model-scale").evaluate(y,{},b),R=g.paint.get("model-translation").evaluate(y,{},b);Ut(f.rotation,E)&&Ut(f.scale,M)&&Ut(f.translation,R)||(this.evaluate(f,f.featureStates,c,!0),e=!0)}}return e}updateReplacement(e,i,c,f){if(i.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=i.updateTime;const g=i.getReplacementRegionsForTile(e.toUnwrapped(),!0);if(d(this.activeReplacements,g))return!1;this.activeReplacements=g;let y=!1;for(const b in this.instancesPerModel){const E=this.instancesPerModel[b],M=E.instancedDataArray;for(const R of E.features){const z=R.instancedDataOffset,B=R.instancedDataCount;for(let j=0;j<B;j++){const V=16*(j+z);let Y=M.float32[V+0];const re=Y>Gt;Y=re?Y-Gt:Y;const J=Math.floor(Y),oe=Math.floor(M.float32[V+1]);let ce=!1;for(const pe of this.activeReplacements)if(!iy(pe,c,jL.Model,f)&&!(pe.min.x>J||J>pe.max.x||pe.min.y>oe||oe>pe.max.y)&&(ce=_e(X(J,oe,e.canonical,pe.footprintTileId.canonical),pe.footprint),ce))break;M.float32[V]=ce?Y+Gt:Y,y=y||ce!==re}}}return y}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){if(!this.uploaded)for(const i in this.instancesPerModel){const c=this.instancesPerModel[i];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=e.createVertexBuffer(c.instancedDataArray,XG.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(e){for(const c in this.instancesPerModel){const f=this.instancesPerModel[c];f.instancedDataArray.length!==0&&f.instancedDataBuffer&&f.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(e&&i&&this.modelUris&&this.modelsRequested)for(const c of this.modelUris)i.removeModel(c,"",!0)}addFeature(e,i,c,f,g){const y=this.layers[0],b=y.layout.get("model-id"),E=y.layout.get("model-allow-density-reduction"),M=b.evaluate(c,{},this.canonical);if(!M)return br(`modelId is not evaluated for layer ${y.id} and it is not going to get rendered.`),M;(gE(M,!1)||this.styleDefinedModelURLs[M]!==void 0)&&(this.modelUris.includes(M)||this.modelUris.push(M)),this.instancesPerModel[M]||(this.instancesPerModel[M]=new VL);const R=this.instancesPerModel[M],z=R.instancedDataArray,B=new UL(c,z.length);let j;f&&(j=so.getElevationFeature(e,f));for(const V of i)for(const Y of V){if(Y.x<0||Y.x>=Gt||Y.y<0||Y.y>=Gt)continue;if(this.lookupDim!==0&&E){const J=(this.lookupDim-1)/Gt,oe=this.lookupDim*(Y.y*J|0)+Y.x*J|0;if(this.lookup){if(this.lookup[oe]!==0)continue;this.lookup[oe]=1}}this.instanceCount++;const re=z.length;if(z.resize(re+1),f){R.instancesRoadElevation||(R.instancesRoadElevation=[]);const J=j?j.pointElevation(new yt(Y.x,Y.y)):0;R.instancesRoadElevation.push(J)}R.instancesEvaluatedElevation.push(0),z.float32[16*re]=Y.x,z.float32[16*re+1]=Y.y}return B.instancedDataCount=R.instancedDataArray.length-B.instancedDataOffset,B.instancedDataCount>0&&(e.id&&(R.idToFeaturesIndex[e.id]=R.features.length),R.features.push(B),this.evaluate(B,{},R,!1)),M}getModelUris(){return this.modelUris}evaluate(e,i,c,f){const g=this.layers[0],y=e.feature,b=this.canonical,E=e.rotation=g.paint.get("model-rotation").evaluate(y,i,b),M=e.scale=g.paint.get("model-scale").evaluate(y,i,b),R=e.translation=g.paint.get("model-translation").evaluate(y,i,b),z=Object.assign({},g.paint.get("model-color").evaluate(y,i,b));z.a=g.paint.get("model-color-mix-intensity").evaluate(y,i,b);const B=[];this.maxVerticalOffset<R[2]&&(this.maxVerticalOffset=R[2]);const j=R[0]*R[0]+R[1]*R[1],V=j>0?Math.sqrt(j):0;c.maxScale=Math.max(Math.max(c.maxScale,M[0]),Math.max(M[1],M[2])),c.maxXYTranslationDistance=Math.max(c.maxXYTranslationDistance,V),this.maxScale=Math.max(Math.max(this.maxScale,M[0]),Math.max(M[1],M[2])),gz(B,E,M);const Y=Math.round(100*z.a)+z.b/1.05;for(let re=0;re<e.instancedDataCount;++re){const J=e.instancedDataOffset+re,oe=16*J,ce=c.instancedDataArray.float32;let pe=0;f&&(pe=ce[oe+6]-c.instancesEvaluatedElevation[J]);const Se=0|ce[oe+1];ce[oe]=(0|ce[oe])+z.r/1.05,ce[oe+1]=Se+z.g/1.05,ce[oe+2]=Y,ce[oe+3]=1/(b.z>10?this.tileToMeter:zt(b,Se)),ce[oe+4]=R[0],ce[oe+5]=R[1],ce[oe+6]=R[2]+(c.instancesRoadElevation?c.instancesRoadElevation[J]:0)+pe,ce[oe+7]=B[0],ce[oe+8]=B[1],ce[oe+9]=B[2],ce[oe+10]=B[4],ce[oe+11]=B[5],ce[oe+12]=B[6],ce[oe+13]=B[8],ce[oe+14]=B[9],ce[oe+15]=B[10],c.instancesEvaluatedElevation[J]=R[2]}}}let GL,$L;jt(_E,"ModelBucket",{omit:["layers"]}),jt(VL,"PerModelAttributes"),jt(UL,"ModelFeature");class e0{constructor(e,i,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=c}static create(e,i,c){const f=c||e.findDEMTileFor(i);if(!f||!f.dem)return;const g=f.dem,y=f.tileID,b=1<<i.canonical.z-y.canonical.z;return new e0(f,g.dim/Gt/b,[(i.canonical.x/b-y.canonical.x)*g.dim,(i.canonical.y/b-y.canonical.y)*g.dim])}tileCoordToPixel(e,i){const c=i*this._scale+this._offset[1];return new yt(Math.floor(e*this._scale+this._offset[0]),Math.floor(c))}getElevationAt(e,i,c,f){const g=e*this._scale+this._offset[0],y=i*this._scale+this._offset[1],b=Math.floor(g),E=Math.floor(y),M=this._dem;return f=!!f,c?Dr(Dr(M.get(b,E,f),M.get(b,E+1,f),y-E),Dr(M.get(b+1,E,f),M.get(b+1,E+1,f),y-E),g-b):M.get(b,E,f)}getElevationAtPixel(e,i,c){return this._dem.get(e,i,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*We(1,e)*this._dem.stride}}const yE=new Float32Array(262144),dy=new Uint8Array(262144);function qL(s){let e=0;if(s.meshes)for(const i of s.meshes)e=Math.max(e,i.aabb.max[2]);if(s.children)for(const i of s.children)e=Math.max(e,qL(i));return e}function HL(s,e,i){if(s.meshes)for(const c of s.meshes){if(c.aabb.min[0]===1/0)continue;const f=An.applyTransform(c.aabb,s.globalMatrix);i.insert(e,f.min[0],f.min[1],f.max[0],f.max[1])}if(s.children)for(const c of s.children)HL(c,e,i)}const XL=["","wall","door","roof","window","lamp","logo"];class ZL{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:e.id,geometry:[],properties:{height:qL(e)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let e=0;const i=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const c of this.node.meshes)this.node.lightMeshIndex!==e&&(c.transformedAabb=An.applyTransformFast(c.aabb,this.node.globalMatrix),i.encapsulate(c.transformedAabb)),e++;this.aabb=i}return this.aabb}}class x2{constructor(e,i,c,f,g,y,b,E){this.id=c,this.layers=e,this.layerIds=this.layers.map(M=>M.fqid),this.stateDependentLayerIds=this.layers.filter(M=>M.isStateDependent()).map(M=>M.id),this.modelTraits|=Hv.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=Hv.HasMapboxMeshFeatures),g&&(this.modelTraits|=Hv.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.worldview=E,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const M of i)this.nodesInfo.push(new ZL(M)),HL(M,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0);this.states={},this.hasAppearances=null}updateFootprints(e,i){for(const c of this.getNodesInfo()){const f=c.node;f.footprint&&i.push({footprint:f.footprint,id:e})}}updateAppearances(e,i,c,f){}update(e){const i=Object.keys(e).length!==0;if(i&&!this.stateDependentLayers.length)return;const c=i?this.stateDependentLayers:this.layers;if(!Or(e,this.states))for(const f of c)this.evaluate(f,e);this.states=structuredClone(e)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const i=this.getNodesInfo();for(const c of i){const f=c.node;this.uploaded?this.updatePbrBuffer(f):jS(f,e,!0)}for(const c of i)t2(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let i=!1;if(!e.meshes)return i;for(const c of e.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),i=!0);return i}needsReEvaluation(e,i,c){const f=e.transform.projectionOptions,g=e.style.getBrightness(),y=this.brightness!==g;if(!this.uploaded||this.dirty||f.name!==this.projection.name||y1(c.paint.get("model-color").value,y)||y1(c.paint.get("model-color-mix-intensity").value,y)||y1(c.paint.get("model-roughness").value,y)||y1(c.paint.get("model-emissive-strength").value,y)||y1(c.paint.get("model-height-based-emissive-strength-multiplier").value,y)){this.projection=f,this.brightness=g;const b=this.getNodesInfo();for(const E of b)E.state=null;return!0}return!1}evaluateTransform(e,i){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const c=this.getNodesInfo(),f=this.id.canonical;for(const g of c){const y=g.feature;g.evaluatedTranslation=i.paint.get("model-translation").evaluate(y,{},f),g.evaluatedScale=i.paint.get("model-scale").evaluate(y,{},f)}}evaluate(e,i){const c=this.getNodesInfo();for(const f of c){if(!f.node.meshes)continue;const g=f.feature,y=i&&i[g.id];if(Or(y,f.state))continue;f.state=structuredClone(y);const b=f.node.meshes&&f.node.meshes[0].featureData,E=f.evaluatedColor[2],M=f.evaluatedRMEA[2],R=this.id.canonical;if(f.hasTranslucentParts=!1,b){for(let z=0;z<XL.length;z++){const B=XL[z];B.length&&(g.properties.part=B);const j=e.paint.get("model-color").evaluate(g,y,R).toPremultipliedRenderColor(null),V=e.paint.get("model-color-mix-intensity").evaluate(g,y,R);f.evaluatedColor[z]=[j.r,j.g,j.b,V],f.evaluatedRMEA[z][0]=e.paint.get("model-roughness").evaluate(g,y,R),f.evaluatedRMEA[z][2]=e.paint.get("model-emissive-strength").evaluate(g,y,R),f.evaluatedRMEA[z][3]=j.a,f.emissionHeightBasedParams[z]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(g,y,R),!f.hasTranslucentParts&&j.a<1&&(f.hasTranslucentParts=!0)}delete g.properties.part,Mq(f,E!==f.evaluatedColor[2]||M!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=e.paint.get("model-emissive-strength").evaluate(g,y,R);f.evaluatedTranslation=e.paint.get("model-translation").evaluate(g,y,R),f.evaluatedScale=e.paint.get("model-scale").evaluate(g,y,R),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(e,i,c,f){const g=e.findDEMTileFor(c);if(g&&(g.tileID.canonical!==this.terrainTile||i!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const y=e0.create(e,c,g);if(!y)return;this.modelTraits&Hv.HasMapboxMeshFeatures&&this.updateDEM(e,y,c,f);for(const b of this.getNodesInfo()){const E=b.node;if(!E.footprint||!E.footprint.vertices||!E.footprint.vertices.length)continue;const M=E.footprint.vertices;let R=y.getElevationAt(M[0].x,M[0].y,!0,!0);for(let z=1;z<M.length;z++)R=Math.min(R,y.getElevationAt(M[z].x,M[z].y,!0,!0));E.elevation=R}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=i}}updateDEM(e,i,c,f){let g=i._dem._modifiedForSources[f];if(g===void 0&&(i._dem._modifiedForSources[f]=[],g=i._dem._modifiedForSources[f]),g.includes(c.canonical))return;const y=i._dem.dim;g.push(c.canonical);let b=!1;for(const E of this.getNodesInfo()){const M=E.node;if(!M.footprint||!M.footprint.grid)continue;const R=M.footprint.grid,z=i.tileCoordToPixel(R.min.x,R.min.y),B=i.tileCoordToPixel(R.max.x,R.max.y),j=Math.min(Math.min(y-B.y,z.x),Math.min(z.y,y-B.x));if(j<0)continue;const V=Ee(j,2,5);let Y=Math.max(0,z.x-V),re=Math.max(0,z.y-V),J=Math.min(B.x+V,y-1),oe=Math.min(B.y+V,y-1);for(let we=re;we<=oe;++we)for(let Ie=Y;Ie<=J;++Ie)dy[we*y+Ie]=255;let ce=0,pe=0;for(let we=0;we<R.cellsY;++we)for(let Ie=0;Ie<R.cellsX;++Ie){if(!R.cells[we*R.cellsX+Ie])continue;const Pe=i.tileCoordToPixel(R.min.x+Ie/R.xScale,R.min.y+we/R.yScale),Oe=i.tileCoordToPixel(R.min.x+(Ie+1)/R.xScale,R.min.y+(we+1)/R.yScale);for(let ke=Pe.y;ke<=Math.min(Oe.y+1,y-1);++ke)for(let Ge=Pe.x;Ge<=Math.min(Oe.x+1,y-1);++Ge)dy[ke*y+Ge]===255&&(dy[ke*y+Ge]=0,ce+=i.getElevationAtPixel(Ge,ke),pe++)}const Se=ce/pe;Y=Math.max(1,z.x-V),re=Math.max(1,z.y-V),J=Math.min(B.x+V,y-2),oe=Math.min(B.y+V,y-2),b=!0;for(let we=re;we<=oe;++we)for(let Ie=Y;Ie<=J;++Ie)dy[we*y+Ie]===0&&(yE[we*y+Ie]=i._dem.set(Ie,we,Se));for(let we=1;we<V;++we){Y=Math.max(1,z.x-we),re=Math.max(1,z.y-we),J=Math.min(B.x+we,y-2),oe=Math.min(B.y+we,y-2);for(let Ie=re;Ie<=oe;++Ie)for(let Pe=Y;Pe<=J;++Pe){const Oe=Ie*y+Pe;if(dy[Oe]===255){let ke=0,Ge=0,pt=-1,ct=-1;for(let dt=-1;dt<=1;++dt)for(let St=-1;St<=1;++St){const At=(Ie+dt)*y+Pe+St;if(dy[At]>=we)continue;const Tt=yE[At],lt=Math.abs(Tt);lt>Ge&&(ke=Tt,Ge=lt,pt=St,ct=dt)}if(Ge>.1){const dt=1-(we+.5*Math.abs(pt*ct))/V;let St=i._dem.get(Pe,Ie)+ke*dt;const At=i._dem.get(Pe+pt,Ie+ct),Tt=i._dem.get(Pe-pt,Ie-ct,!0);(St-At)*(St-Tt)>0&&(St=(At+Tt)/2),yE[Oe]=i._dem.set(Pe,Ie,St),dy[Oe]=we}}}}}b&&(i._demTile.needsDEMTextureUpload=!0,i._dem._timestamp=Is.now())}setFilter(e){this.filter=e?rg(e):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(e=>this.filter.filter(new In(this.id.overscaledZ,{worldview:this.worldview}),e.feature,this.id.canonical)):this.nodesInfo}destroy(){const e=this.getNodesInfo();for(const i of e)t2(i.node),US(i.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(e,i){if(i.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=i.updateTime;const c=i.getReplacementRegionsForTile(e.toUnwrapped());for(const f of this.getNodesInfo()){const g=f.node.footprint;f.hiddenByReplacement=!!g&&!c.find(y=>y.footprint===g)}}getHeightAtTileCoord(e,i){const c=[],f=[0,0,0],g=K([]);for(const y of this.getNodesInfo()){const b=y.node.meshes[0],E=b.transformedAabb;if(e<E.min[0]||i<E.min[1]||e>E.max[0]||i>E.max[1])continue;if(y.node.hidden===!0)return{height:1/0,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};he(g,y.node.globalMatrix),f[0]=e,f[1]=i,Tr(f,f,g);const M=(f[0]-b.aabb.min[0])/(b.aabb.max[0]-b.aabb.min[0])*ly|0,R=Math.min(63,(f[1]-b.aabb.min[1])/(b.aabb.max[1]-b.aabb.min[1])*ly|0)*ly+Math.min(63,M),z=b.heightmap[R];if(!(z<0&&y.node.footprint))return y.hiddenByReplacement?void 0:{height:z,maxHeight:y.feature.properties.height,hidden:!1,verticalScale:y.evaluatedScale[2]};if(y.node.footprint.grid.query(new yt(e,i),new yt(e,i),c),c.length>0)return{height:void 0,maxHeight:y.feature.properties.height,hidden:y.hiddenByReplacement,verticalScale:y.evaluatedScale[2]}}}}function y1(s,e){return s instanceof Lo&&!s.isLightConstant&&e}function Eq(s,e,i,c,f,g,y,b){let E=(61440&e|(61440&e)>>4)>>8,M=(3840&e|(3840&e)>>4)>>4,R=240&e|(240&e)>>4;i[3]>0&&(E=Dr(E,255*i[0],i[3]),M=Dr(M,255*i[1],i[3]),R=Dr(R,255*i[2],i[3]));const z=E<<8|M,B=R<<8|Math.floor(255*c[3]),j=(function(we){const Ie=Ee(we,0,2);return Math.min(Math.round(.5*Ie*255),255)})(c[2])<<8|15*c[0]<<4|15*c[1],V=Ee(f[0],0,1),Y=Ee(f[1],0,1),re=Ee(f[2],0,1),J=Ee(f[3],0,1);let oe,ce,pe,Se;if(V!==Y&&y!==g&&Y!==V){const we=y-g;ce=1/(we*(Y-V)),pe=-(g+we*V)/(we*(Y-V));const Ie=Ee(f[4],-1,1);Se=Math.pow(10,Ie),oe=255*re<<8|255*J}else oe=65535,ce=0,pe=1,Se=1;if(s.emplaceBack(z,B,j,oe,ce,pe,Se),b){const we=b.length;b.clear();for(let Ie=0;Ie<we;Ie++)b.emplaceBack(z,B,j,oe,ce,pe,Se)}}function Mq(s,e,i){const c=s.node;let f=0;const g=i&Hv.HasMeshoptCompression;for(const y of c.meshes){if(c.lights&&c.lightMeshIndex===f||!y.featureData)continue;y.featureArray=new pd,y.featureArray.reserve(y.featureData.length);let b=e;for(const E of y.featureData){const M=g?65535&E:E>>16&65535,R=g?E>>16&65535:65535&E,z=(15&R)<8?15&R:0,B=s.evaluatedRMEA[z],j=s.evaluatedColor[z],V=s.emissionHeightBasedParams[z];let Y;if(b&&z===2&&c.lights&&(Y=new pd,Y.resize(10*c.lights.length)),Eq(y.featureArray,M,j,B,V,y.aabb.min[2],y.aabb.max[2],Y),Y&&b){b=!1;const re=c.meshes[c.lightMeshIndex];re.featureArray=Y,re.featureArray._trim()}}y.featureArray._trim(),f++}}jt(x2,"Tiled3dModelBucket",{omit:["layers"]}),jt(ZL,"Tiled3dModelFeature");const Oq=["id","tile","layer","source","sourceLayer","state"];class fy{constructor(e,i,c,f,g){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=c,this._y=f,this.properties=e?e.properties:{},this.id=g}clone(){const e=new fy(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(e.state=Object.assign({},this.state)),this.layer&&(e.layer=Object.assign({},this.layer)),this.source&&(e.source=this.source),this.sourceLayer&&(e.sourceLayer=this.sourceLayer),e}get geometry(){return this._geometry===void 0&&this._vectorTileFeature&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const i of Oq)this[i]!==void 0&&(e[i]=this[i]);return e}}class py extends Qc{constructor(e,i,c,f){super(),this.id=e,this.type="model",this.models=[],this._options=i,this._modelsInfo=new Map}loadGLTFFromURI(e){return dz(this.map._requestManager.transformRequest(e,va.Model).url)}load(){for(const e in this._options.models){const i=this._options.models[e],c=this._modelsInfo.get(e);if(c){c.modelSpec=i;const f=c.model;f&&(f.position=i.position!=null?new Te(i.position[0],i.position[1]):new Te(0,0),f.orientation=i.orientation!=null?i.orientation:[0,0,0],py.applyModelSpecification(f,i),f.computeBoundsAndApplyParent(),this.models.push(f))}else this._modelsInfo.set(e,{modelSpec:i,model:null}),this.loadGLTFFromURI(i.uri).then(f=>{if(!f)return;const g=this._modelsInfo.get(e);if(!g)return;const y=GS(f),b=g.modelSpec,E=new _z(e,b.uri,b.position,b.orientation,y);py.applyModelSpecification(E,b),E.computeBoundsAndApplyParent(),this.models.push(E),g.model=E,this.loaded()&&this.fire(new gl("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(f=>{this.fire(new Fd(new Error(`Could not load model ${e} from ${i.uri}: ${f.message}`)))})}this.loaded()&&this.fire(new gl("data",{dataType:"source",sourceDataType:"metadata"}))}static applyModelSpecification(e,i){i.nodeOverrides&&py.convertNodeOverrides(e,i.nodeOverrides),i.materialOverrides&&py.convertMaterialOverrides(e,i.materialOverrides),i.nodeOverrideNames&&(e.nodeOverrideNames=[...i.nodeOverrideNames]),i.materialOverrideNames&&(e.materialOverrideNames=[...i.materialOverrideNames]),i.featureProperties&&(e.featureProperties=i.featureProperties)}static convertNodeOverrides(e,i){if(Array.isArray(i)&&i.every(c=>typeof c=="string")){e.nodeOverrideNames=[];for(const c of i)e.nodeOverrideNames.push(c)}else Object.entries(i).forEach(([c,f])=>{const g={orientation:[0,0,0]};if(f.hasOwnProperty("orientation")){const y=f.orientation;y&&(g.orientation=y)}e.nodeOverrides.set(c,g)})}static convertMaterialOverrides(e,i){if(Array.isArray(i)&&i.every(c=>typeof c=="string")){e.materialOverrideNames=[];for(const c of i)e.materialOverrideNames.push(c)}else Object.entries(i).forEach(([c,f])=>{const g={color:new Cn(1,1,1),colorMix:0,emissionStrength:0,opacity:1},y=f["model-color"];y!==void 0&&(g.color.r=y[0],g.color.g=y[1],g.color.b=y[2]);const b=f["model-color-mix-intensity"];b!==void 0&&(g.colorMix=b);const E=f["model-emissive-strength"];E!==void 0&&(g.emissionStrength=E);const M=f["model-opacity"];M!==void 0&&(g.opacity=M),e.materialOverrides.set(c,g)})}onAdd(e){this.map=e,this.load()}hasTransition(){return!1}loaded(){if(this._modelsInfo.size===0)return!0;for(const e of this._modelsInfo.values())if(e.model==null)return!1;return!0}getModels(){return this.models}loadTile(e,i){}serialize(){return this._options}setProperty(e,i){return!1}reload(){const e=Xl(this.id,this.scope);this.map.style.clearSource(e),this.models=[],this._modelsInfo.clear(),this.load()}setModels(e){this.models=[];const i=new Map;for(const c in e){const f=e[c];if(this._modelsInfo.has(c)){const g=this._modelsInfo.get(c);g&&g.modelSpec.uri===f.uri&&i.set(c,g)}}this._modelsInfo=i,this._options.models=e,this.load()}}function vE(s,e,i,c){const f=1<<s.z;e.lat=wt((c/Gt+s.y)/f),e.lng=ut((i/Gt+s.x)/f)}function Cq(s,e,i,c){const f=s.getNodesInfo()[e];if(!f||f.hiddenByReplacement||!f.node.meshes)return;let g=Number.MAX_VALUE;const y=f.node,b=i.tile,E=c.calculatePosMatrix(b.tileID.toUnwrapped(),c.worldSize),M=f.evaluatedScale;let R=0;c.elevation&&y.elevation&&(R=y.elevation*c.elevation.exaggeration()),me(E,E,[(y.anchor?y.anchor[0]:0)*(M[0]-1),(y.anchor?y.anchor[1]:0)*(M[1]-1),R]),ge(E,E,M);const z=i.queryGeometry,B=z.isPointQuery()?z.screenBounds:z.screenGeometry,j=function(Y){const re=ue([],E,Y.globalMatrix);ue(re,c.expandedFarZProjMatrix,re);for(let J=0;J<Y.meshes.length;++J){const oe=Y.meshes[J];if(J===Y.lightMeshIndex)continue;const ce=NS(B,c,re,oe.aabb);ce!=null&&(g=Math.min(ce,g))}if(Y.children)for(const J of Y.children)j(J)};if(j(y),g===Number.MAX_VALUE)return;const V=new Te(0,0);return vE(b.tileID.canonical,V,f.node.anchor[0],f.node.anchor[1]),{intersectionZ:g,position:V,feature:f.feature}}const Iq={circle:class extends No{constructor(s,e,i,c){super(s,{layout:gw||(gw=new vi({"circle-sort-key":new Qt(Ye.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Ft(Ye.layout_circle["circle-elevation-reference"]),visibility:new Ft(Ye.layout_circle.visibility)})),paint:_w||(_w=new vi({"circle-radius":new Qt(Ye.paint_circle["circle-radius"]),"circle-color":new Qt(Ye.paint_circle["circle-color"]),"circle-blur":new Qt(Ye.paint_circle["circle-blur"]),"circle-opacity":new Qt(Ye.paint_circle["circle-opacity"]),"circle-translate":new Ft(Ye.paint_circle["circle-translate"]),"circle-translate-anchor":new Ft(Ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ft(Ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ft(Ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qt(Ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qt(Ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qt(Ye.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ft(Ye.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c)}createBucket(s){return new Jo(s)}queryRadius(s){const e=s;return bu("circle-radius",this,e)+bu("circle-stroke-width",this,e)+dg(this.paint.get("circle-translate"))}queryIntersectsFeature(s,e,i,c,f,g,y,b){const E=mw(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return Ix(s,c,g,y,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,M)}getProgramIds(){return["circle"]}getDefaultProgramParams(s,e,i){const c=ww(this);return{config:new F(this,{zoom:e,lut:i}),defines:c,overrideFog:!1}}is3D(s){return!s&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends No{createBucket(s){return new Tw(s)}constructor(s,e,i,c){super(s,{layout:Dx||(Dx=new vi({visibility:new Ft(Ye.layout_heatmap.visibility)})),paint:Sw||(Sw=new vi({"heatmap-radius":new Qt(Ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qt(Ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ft(Ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new sd(Ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ft(Ye.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=pg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(s){return bu("heatmap-radius",this,s)}queryIntersectsFeature(s,e,i,c,f,g,y,b){const E=this.paint.get("heatmap-radius").evaluate(e,i);return Ix(s,c,g,y,b,!0,!0,new yt(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(s,e,i){return s==="heatmap"?{config:new F(this,{zoom:e,lut:i}),overrideFog:!1}:{}}},hillshade:class extends No{constructor(s,e,i,c){super(s,{layout:Iv||(Iv=new vi({visibility:new Ft(Ye.layout_hillshade.visibility)})),paint:Pv||(Pv=new vi({"hillshade-illumination-direction":new Ft(Ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ft(Ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ft(Ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ft(Ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ft(Ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ft(Ye.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Ft(Ye.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(s,e,i){return{overrideFog:!1}}},fill:class extends No{constructor(s,e,i,c){super(s,{layout:vg||(vg=new vi({"fill-sort-key":new Qt(Ye.layout_fill["fill-sort-key"]),visibility:new Ft(Ye.layout_fill.visibility),"fill-elevation-reference":new Ft(Ye.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new Qt(Ye.layout_fill["fill-construct-bridge-guard-rail"])})),paint:xg||(xg=new vi({"fill-antialias":new Ft(Ye.paint_fill["fill-antialias"]),"fill-opacity":new Qt(Ye.paint_fill["fill-opacity"]),"fill-color":new Qt(Ye.paint_fill["fill-color"]),"fill-outline-color":new Qt(Ye.paint_fill["fill-outline-color"]),"fill-translate":new Ft(Ye.paint_fill["fill-translate"]),"fill-translate-anchor":new Ft(Ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qt(Ye.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Ft(Ye.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Ft(Ye.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Qt(Ye.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new Qt(Ye.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new Qt(Ye.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c)}getProgramIds(){const s=this.paint.get("fill-pattern"),e=s&&s.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getDefaultProgramParams(s,e,i){return{config:new F(this,{zoom:e,lut:i}),overrideFog:!1}}recalculate(s,e){super.recalculate(s,e);const i=this.paint._values["fill-outline-color"];i.value.kind==="constant"&&i.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new yh(s)}queryRadius(){return dg(this.paint.get("fill-translate"))}queryIntersectsFeature(s,e,i,c,f,g){return!s.queryGeometry.isAboveHorizon&&ri(Ex(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),c)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(s){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const e=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return s!=null?e&&!s:e}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends No{constructor(s,e,i,c){super(s,{layout:jR||(jR=new vi({visibility:new Ft(Ye["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ft(Ye["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:UR||(UR=new vi({"fill-extrusion-opacity":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Qt(Ye["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Ft(Ye["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new Au(s)}queryRadius(){return dg(this.paint.get("fill-extrusion-translate"))}is3D(s){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(s,e,i,c,f,g,y,b,E){const M=mw(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),B=[0,0],j=b&&g.elevation,V=g.elevation?g.elevation.exaggeration():1,Y=s.tile.getBucket(this);if(j&&Y instanceof Au){const pe=Y.centroidVertexArray,Se=E+1;Se<pe.length&&(B[0]=pe.geta_centroid_pos0(Se),B[1]=pe.geta_centroid_pos1(Se))}if(B[0]===0&&B[1]===1)return!1;g.projection.name==="globe"&&(c=NR([c],[new yt(0,0),new yt(Gt,Gt)],s.tileID.canonical).map(pe=>pe.polygon).flat());const re=j?b:null,[J,oe]=ZR(g,c,z,R,M,y,re,B,V,g.center.lat,s.tileID.canonical),ce=s.queryGeometry;return XR(J,oe,ce.isPointQuery()?ce.screenBounds:ce.screenGeometry)}},building:class extends No{constructor(s,e,i,c){super(s,{layout:Tz||(Tz=new vi({visibility:new Ft(Ye.layout_building.visibility),"building-facade":new Qt(Ye.layout_building["building-facade"]),"building-facade-floors":new Qt(Ye.layout_building["building-facade-floors"]),"building-facade-unit-width":new Qt(Ye.layout_building["building-facade-unit-width"]),"building-facade-window":new Qt(Ye.layout_building["building-facade-window"]),"building-roof-shape":new Qt(Ye.layout_building["building-roof-shape"]),"building-height":new Qt(Ye.layout_building["building-height"]),"building-base":new Qt(Ye.layout_building["building-base"]),"building-flood-light-wall-radius":new Qt(Ye.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new Qt(Ye.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new Qt(Ye.layout_building["building-flip-roof-orientation"])})),paint:Sz||(Sz=new vi({"building-opacity":new Ft(Ye.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new Ft(Ye.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new Ft(Ye.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Ft(Ye.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Ft(Ye.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Ft(Ye.paint_building["building-vertical-scale"]),"building-cast-shadows":new Ft(Ye.paint_building["building-cast-shadows"]),"building-color":new Qt(Ye.paint_building["building-color"]),"building-emissive-strength":new Qt(Ye.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new Ft(Ye.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new Ft(Ye.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new Ft(Ye.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new Ft(Ye.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new Ft(Ye.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new Az(s)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(s){return!0}queryRadius(s){return 0}queryIntersectsFeature(s,e,i,c,f,g,y,b,E,M){let R=this.layout.get("building-height").evaluate(e,i);const z=this.layout.get("building-base").evaluate(e,i),B=s.tile.getBucket(this).getFootprint(e);if(B){if(B.hiddenFlags!==0)return!1;R=B.height}const[j,V]=ZR(g,c,z,R,new yt(0,0),y,null,[0,0],1,g.center.lat,s.tileID.canonical),Y=s.queryGeometry;return XR(j,V,Y.isPointQuery()?Y.screenBounds:Y.screenGeometry)}},line:class extends No{constructor(s,e,i,c){const f=Lz();super(s,f,e,i,c),f.layout&&(this.layout=new Fo(f.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Vl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}emissiveStrengthExpression(){return this._transitionablePaint._values["line-emissive-strength"].value.expression}recalculate(s,e){super.recalculate(s,e),this.paint._values["line-floorwidth"]=(()=>{if(i1)return i1;const i=Lz();return i1=new T$(i.paint.properties["line-width"].specification),i1.useIntegerZoom=!0,i1})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new HS(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(s,e,i){const c=Rz(this);return{config:new F(this,{zoom:e,lut:i}),defines:c,overrideFog:!1}}queryRadius(s){const e=s,i=Bz(bu("line-width",this,e),bu("line-gap-width",this,e)),c=bu("line-offset",this,e);return i/2+Math.abs(c)+dg(this.paint.get("line-translate"))}queryIntersectsFeature(s,e,i,c,f,g){if(s.queryGeometry.isAboveHorizon)return!1;const y=Ex(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,s.pixelToTileUnitsFactor),b=s.pixelToTileUnitsFactor/2*Bz(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),E=this.paint.get("line-offset").evaluate(e,i);return E&&(c=(function(M,R){const z=[],B=new yt(0,0);for(let j=0;j<M.length;j++){const V=M[j],Y=[];for(let re=0;re<V.length;re++){const J=V[re],oe=V[re+1],ce=re===0?B:J.sub(V[re-1])._unit()._perp(),pe=re===V.length-1?B:oe.sub(J)._unit()._perp(),Se=ce._add(pe)._unit();Se._mult(1/(Se.x*pe.x+Se.y*pe.y)),Y.push(Se._mult(R)._add(J))}z.push(Y)}return z})(c,E*s.pixelToTileUnitsFactor)),(function(M,R,z){for(let B=0;B<R.length;B++){const j=R[B];if(M.length>=3){for(let V=0;V<j.length;V++)if(_s(M,j[V]))return!0}if(Ji(M,j,z))return!0}return!1})(y,c,b)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(s){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:g2,background:class extends No{constructor(s,e,i,c){super(s,{layout:ML||(ML=new vi({visibility:new Ft(Ye.layout_background.visibility)})),paint:OL||(OL=new vi({"background-pitch-alignment":new Ft(Ye.paint_background["background-pitch-alignment"]),"background-color":new Ft(Ye.paint_background["background-color"]),"background-pattern":new Ft(Ye.paint_background["background-pattern"]),"background-opacity":new Ft(Ye.paint_background["background-opacity"]),"background-emissive-strength":new Ft(Ye.paint_background["background-emissive-strength"]),"background-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(s,e,i){return{overrideFog:!1}}is3D(s){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:RL,"raster-particle":NL,sky:class extends No{constructor(s,e,i,c){super(s,{layout:BL||(BL=new vi({visibility:new Ft(Ye.layout_sky.visibility)})),paint:kL||(kL=new vi({"sky-type":new Ft(Ye.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ft(Ye.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ft(Ye.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ft(Ye.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ft(Ye.paint_sky["sky-gradient-radius"]),"sky-gradient":new sd(Ye.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ft(Ye.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ft(Ye.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ft(Ye.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=pg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(s,e){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,g=s.style.light,y=g.properties.get("position");return f&&g.properties.get("anchor")==="viewport"&&br("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?mE(y.azimuthal,90-y.polar,e):mE(c[0],90-c[1],e)}const i=this.paint.get("sky-gradient-center");return mE(i[0],90-i[1],e)}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}},slot:class extends No{constructor(s,e,i,c){super(s,{paint:FL||(FL=new vi({}))},e,null)}},model:class extends No{constructor(s,e,i,c){super(s,{layout:GL||(GL=new vi({visibility:new Ft(Ye.layout_model.visibility),"model-id":new Qt(Ye.layout_model["model-id"]),"model-allow-density-reduction":new Ft(Ye.layout_model["model-allow-density-reduction"])})),paint:$L||($L=new vi({"model-opacity":new Qt(Ye.paint_model["model-opacity"]),"model-rotation":new Qt(Ye.paint_model["model-rotation"]),"model-scale":new Qt(Ye.paint_model["model-scale"]),"model-translation":new Qt(Ye.paint_model["model-translation"]),"model-color":new Qt(Ye.paint_model["model-color"]),"model-color-mix-intensity":new Qt(Ye.paint_model["model-color-mix-intensity"]),"model-type":new Ft(Ye.paint_model["model-type"]),"model-cast-shadows":new Ft(Ye.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ft(Ye.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ft(Ye.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Qt(Ye.paint_model["model-emissive-strength"]),"model-roughness":new Qt(Ye.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Qt(Ye.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Ft(Ye.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Ft(Ye.paint_model["model-front-cutoff"]),"model-elevation-reference":new Ft(Ye.paint_model["model-elevation-reference"]),"model-color-use-theme":new Qt({type:"string",default:"default","property-type":"data-driven"})}))},e,i,c),this.layer=s,this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new _E(s)}getProgramIds(){return["model"]}is3D(s){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(s){return s instanceof x2?8191:0}queryRenderedFeatures(s,e,i){const c=e.getSource();if(!(c&&c instanceof py))return{};const f=c,g={};g[this.id]=[];const y=g[this.id];let b=0;for(const E of f.models){const M=e.getFeatureState(this.sourceLayer,E.id),R={type:"Unknown",id:E.id,properties:E.featureProperties},z=this.paint.get("model-rotation").evaluate(R,M),B=this.paint.get("model-scale").evaluate(R,M),j=this.paint.get("model-translation").evaluate(R,M),V=this.paint.get("model-elevation-reference");let Y=[];e2(Y,E,i,E.position,z,B,j,V==="ground",V==="ground",!1),i.projection.name==="globe"&&(Y=Jw(Y,i));const re=ue([],i.projMatrix,Y),J=NS(s.isPointQuery()?s.screenBounds:s.screenGeometry,i,re,E.aabb);if(J!=null){const oe=new fy(void 0,0,0,0,E.id);oe.layer=this.layer,oe.properties=structuredClone(E.featureProperties),oe.properties.layer=this.id,oe.properties.uri=E.uri,oe.properties.orientation=E.orientation,oe.sourceLayer=this.sourceLayer,oe.geometry={type:"Point",coordinates:[E.position.lng,E.position.lat]},oe.state=M,oe.source=this.source,y.push({featureIndex:b,feature:oe,intersectionZ:J})}++b}return g}queryIntersectsFeature(s,e,i,c,f,g,y,b,E,M){if(!this.modelManager)return!1;const R=this.modelManager,z=s.tile.getBucket(this);if(!(z&&z instanceof _E))return!1;for(const B in z.instancesPerModel){const j=z.instancesPerModel[B],V=e.id!==void 0?e.id:e.properties&&e.properties.hasOwnProperty("id")?e.properties.id:void 0;if(j.idToFeaturesIndex.hasOwnProperty(V)){const Y=j.features[j.idToFeaturesIndex[V]],re=R.getModel(B,M||this.scope);if(!re)return!1;let J=[];const oe=new Te(0,0),ce=z.canonical;let pe=Number.MAX_VALUE;for(let Se=0;Se<Y.instancedDataCount;++Se){const we=16*(Y.instancedDataOffset+Se),Ie=j.instancedDataArray.float32,Pe=[Ie[we+4],Ie[we+5],Ie[we+6]];vE(ce,oe,Math.floor(Ie[we]),Math.floor(Ie[we+1])),e2(J,re,g,oe,Y.rotation,Y.scale,Pe,!1,!1,!1),g.projection.name==="globe"&&(J=Jw(J,g));const Oe=ue([],g.projMatrix,J),ke=s.queryGeometry,Ge=NS(ke.isPointQuery()?ke.screenBounds:ke.screenGeometry,g,Oe,re.aabb);Ge!=null&&(pe=Math.min(Ge,pe))}return pe!==Number.MAX_VALUE&&pe}}return!1}_handleOverridablePaintPropertyUpdate(s,e,i){return!(!this.layout||e.isDataDriven()||i.isDataDriven()||s!=="model-color"&&s!=="model-color-mix-intensity"&&s!=="model-rotation"&&s!=="model-scale"&&s!=="model-translation"&&s!=="model-emissive-strength")}_isPropertyZoomDependent(s){const e=this._transitionablePaint._values[s];return e!=null&&e.value!=null&&e.value.expression!=null&&e.value.expression instanceof wo}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends No{constructor(s,e,i,c){super(s,{layout:wd||(wd=new vi({"clip-layer-types":new Ft(Ye.layout_clip["clip-layer-types"]),"clip-layer-scope":new Ft(Ye.layout_clip["clip-layer-scope"]),visibility:new Ft(Ye.layout_clip.visibility)})),paint:Nw||(Nw=new vi({}))},e,i,c)}recalculate(s,e){super.recalculate(s,e)}createBucket(s){return new jw(s)}is3D(s){return!0}}},xE=new Cn(0,0,0);function Pq(s,e,i){s===1&&e.icons.push((function(c,f){return(function(g){if(g.usvg_tree.height||(g.usvg_tree.height=g.usvg_tree.width),!g.metadata)return g;const{metadata:y}=g;if(y.content_area){const{content_area:b}=y;b.left==null&&(b.left=0),b.top==null&&(b.top=b.left),b.width==null&&(b.width=g.usvg_tree.width),b.height==null&&(b.height=b.width)}if(y.text_placeholder){const{text_placeholder:b}=y;b.top==null&&(b.top=b.left),b.height==null&&(b.height=b.width)}return y.stretch_x&&y.stretch_x.length&&WL(y,"x"),y.stretch_y&&y.stretch_y.length&&WL(y,"y"),g})(c.readFields(Dq,{name:void 0},f))})(i,i.readVarint()+i.pos))}function WL(s,e){const i=[],c=s[`stretch_${e}`];let f=null;for(let g=0;g<c.length;g++)f===null?f=i.length===0?c[0]:i[i.length-1][1]+c[g]:(i.push([f,f+c[g]]),f=null);s[`stretch_${e}_areas`]=i}function Dq(s,e,i){s===1?e.name=i.readString():s===2?e.metadata=(function(c,f){return c.readFields(Rq,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)})(i,i.readVarint()+i.pos):s===3&&(e.usvg_tree=(function(c,f){return c.readFields(Bq,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)})(i,i.readVarint()+i.pos),e.data="usvg_tree")}function Rq(s,e,i){s===1?e.stretch_x=i.readPackedVarint():s===2?e.stretch_y=i.readPackedVarint():s===3?e.content_area=YL(i,i.readVarint()+i.pos):s===4?e.variables.push((function(c,f){return c.readFields(Lq,{name:void 0},f)})(i,i.readVarint()+i.pos)):s===5&&(e.text_placeholder=YL(i,i.readVarint()+i.pos))}function YL(s,e){return s.readFields(zq,{},e)}function zq(s,e,i){s===1?e.left=i.readVarint():s===2?e.width=i.readVarint():s===3?e.top=i.readVarint():s===4&&(e.height=i.readVarint())}function Lq(s,e,i){s===1?e.name=i.readString():s===2&&(e.rgb_color=A2(i.readVarint()),e.value="rgb_color")}function Bq(s,e,i){s===1?e.width=e.height=i.readVarint():s===2?e.height=i.readVarint():s===3?e.children.push(b2(i,i.readVarint()+i.pos)):s===4?e.linear_gradients.push((function(c,f){return c.readFields(Gq,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)})(i,i.readVarint()+i.pos)):s===5?e.radial_gradients.push((function(c,f){return c.readFields(qq,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)})(i,i.readVarint()+i.pos)):s===7?e.clip_paths.push((function(c,f){return c.readFields(Hq,{children:[]},f)})(i,i.readVarint()+i.pos)):s===8&&e.masks.push((function(c,f){const g=c.readFields(Xq,{left:0,width:20,mask_type:1,children:[]},f);return g.height==null&&(g.height=g.width),g.top==null&&(g.top=g.left),g})(i,i.readVarint()+i.pos))}function b2(s,e){return s.readFields(kq,{},e)}function kq(s,e,i){s===1?(e.group=(function(c,f){return c.readFields(Fq,{opacity:255,children:[]},f)})(i,i.readVarint()+i.pos),e.node="group"):s===2&&(e.path=(function(c,f){return c.readFields(jq,{paint_order:1,commands:[],step:1,diffs:[],rule:1},f)})(i,i.readVarint()+i.pos),e.node="path")}function Fq(s,e,i){s===1?e.transform=w2(i,i.readVarint()+i.pos):s===2?e.opacity=i.readVarint():s===5?e.clip_path_idx=i.readVarint():s===6?e.mask_idx=i.readVarint():s===7&&e.children.push(b2(i,i.readVarint()+i.pos))}function w2(s,e){return s.readFields(Nq,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},e)}function Nq(s,e,i){s===1?e.sx=i.readFloat():s===2?e.ky=i.readFloat():s===3?e.kx=i.readFloat():s===4?e.sy=i.readFloat():s===5?e.tx=i.readFloat():s===6&&(e.ty=i.readFloat())}function jq(s,e,i){s===1?e.fill=(function(c,f){return c.readFields(Uq,{rgb_color:xE,paint:"rgb_color",opacity:255},f)})(i,i.readVarint()+i.pos):s===2?e.stroke=(function(c,f){return c.readFields(Vq,{rgb_color:xE,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)})(i,i.readVarint()+i.pos):s===3?e.paint_order=i.readVarint():s===5?i.readPackedVarint(e.commands):s===6?e.step=i.readFloat():s===7?i.readPackedSVarint(e.diffs):s===8&&(e.rule=i.readVarint())}function Uq(s,e,i){s===1?(e.rgb_color=A2(i.readVarint()),e.paint="rgb_color"):s===2?(e.linear_gradient_idx=i.readVarint(),e.paint="linear_gradient_idx"):s===3?(e.radial_gradient_idx=i.readVarint(),e.paint="radial_gradient_idx"):s===5&&(e.opacity=i.readVarint())}function A2(s){return new Cn((s>>16&255)/255,(s>>8&255)/255,(255&s)/255,1)}function Vq(s,e,i){s===1?(e.rgb_color=A2(i.readVarint()),e.paint="rgb_color"):s===2?(e.linear_gradient_idx=i.readVarint(),e.paint="linear_gradient_idx"):s===3?(e.radial_gradient_idx=i.readVarint(),e.paint="radial_gradient_idx"):s===5?i.readPackedFloat(e.dasharray):s===6?e.dashoffset=i.readFloat():s===7?e.miterlimit=i.readFloat():s===8?e.opacity=i.readVarint():s===9?e.width=i.readFloat():s===10?e.linecap=i.readVarint():s===11&&(e.linejoin=i.readVarint())}function Gq(s,e,i){s===1?e.transform=w2(i,i.readVarint()+i.pos):s===2?e.spread_method=i.readVarint():s===3?e.stops.push(KL(i,i.readVarint()+i.pos)):s===4?e.x1=i.readFloat():s===5?e.y1=i.readFloat():s===6?e.x2=i.readFloat():s===7&&(e.y2=i.readFloat())}function KL(s,e){return s.readFields($q,{offset:0,opacity:255,rgb_color:xE},e)}function $q(s,e,i){s===1?e.offset=i.readFloat():s===2?e.opacity=i.readVarint():s===3&&(e.rgb_color=A2(i.readVarint()))}function qq(s,e,i){s===1?e.transform=w2(i,i.readVarint()+i.pos):s===2?e.spread_method=i.readVarint():s===3?e.stops.push(KL(i,i.readVarint()+i.pos)):s===4?e.cx=i.readFloat():s===5?e.cy=i.readFloat():s===6?e.r=i.readFloat():s===7?e.fx=i.readFloat():s===8?e.fy=i.readFloat():s===9&&(e.fr=i.readFloat())}function Hq(s,e,i){s===1?e.transform=w2(i,i.readVarint()+i.pos):s===2?e.clip_path_idx=i.readVarint():s===3&&e.children.push(b2(i,i.readVarint()+i.pos))}function Xq(s,e,i){s===1?e.left=e.top=i.readFloat():s===2?e.width=e.height=i.readFloat():s===3?e.top=i.readFloat():s===4?e.height=i.readFloat():s===5?e.mask_type=i.readVarint():s===6?e.mask_idx=i.readVarint():s===7&&e.children.push(b2(i,i.readVarint()+i.pos))}class Zq{static calculate(e={},i=[]){const c=new Map,f=new Map;if(Object.keys(e).length===0)return c;i.forEach(g=>{f.set(g.name,g.rgb_color||new Cn(0,0,0))});for(const[g,y]of Object.entries(e))f.has(g)?c.set(f.get(g).toString(),y):console.warn(`Ignoring unknown image variable "${g}"`);return c}}function t0(s,e=255,i){const c=e/255,f=s.toString(),g=i.has(f)?i.get(f).clone():s.clone();return g.a*=c,g.toString()}function v1(s,e){if(!hl()){const i=document.createElement("canvas");return i.width=s,i.height=e,i}return new OffscreenCanvas(s,e)}let bE,x1=null;function wE(s,e,i,c,f){for(const g of c.children)QL(s,e,i,g,f)}function QL(s,e,i,c,f){c.group?(s.save(),(function(g,y,b,E,M){const R=E.mask_idx!=null?b.masks[E.mask_idx]:null,z=E.clip_path_idx!=null?b.clip_paths[E.clip_path_idx]:null;if(E.transform&&(y=r0(E.transform).preMultiplySelf(y)),!(function(V,Y,re){return V.opacity!==255||Y||re})(E,z!=null,R!=null))return void wE(g,y,b,E,M);const B=v1(g.canvas.width,g.canvas.height),j=B.getContext("2d");wE(j,y,b,E,M),z&&aB(j,y,b,z),R&&oB(j,y,b,R,M),g.globalAlpha=E.opacity/255,g.drawImage(B,0,0)})(s,e,i,c.group,f),s.restore()):c.path&&(s.save(),(function(g,y,b,E,M){g.setTransform(y),E.paint_order===1?(JL(g,b,E,M),tB(g,b,E,M)):(tB(g,b,E,M),JL(g,b,E,M))})(s,e,i,c.path,f),s.restore())}function JL(s,e,i,c){const f=i.fill;if(!f)return;const g=f.opacity/255;switch(s.save(),s.beginPath(),sB(i,s),f.paint){case"rgb_color":s.fillStyle=t0(f.rgb_color,f.opacity,c);break;case"linear_gradient_idx":{const y=e.linear_gradients[f.linear_gradient_idx];y.transform&&s.setTransform(r0(y.transform).preMultiplySelf(s.getTransform())),s.fillStyle=rB(s,y,g,c);break}case"radial_gradient_idx":{const y=e.radial_gradients[f.radial_gradient_idx];y.transform&&s.setTransform(r0(y.transform).preMultiplySelf(s.getTransform())),s.fillStyle=nB(s,y,g,c)}}s.fill(eB(i)),s.restore()}function eB(s){return s.rule===1?"nonzero":s.rule===2?"evenodd":void 0}function tB(s,e,i,c){const f=i.stroke;if(!f)return;const g=lB(i);s.lineWidth=f.width,s.miterLimit=f.miterlimit,s.setLineDash(f.dasharray),s.lineDashOffset=f.dashoffset;const y=f.opacity/255;switch(f.paint){case"rgb_color":s.strokeStyle=t0(f.rgb_color,f.opacity,c);break;case"linear_gradient_idx":s.strokeStyle=rB(s,e.linear_gradients[f.linear_gradient_idx],y,c,!0);break;case"radial_gradient_idx":s.strokeStyle=nB(s,e.radial_gradients[f.radial_gradient_idx],y,c,!0)}switch(f.linejoin){case 2:case 1:s.lineJoin="miter";break;case 3:s.lineJoin="round";break;case 4:s.lineJoin="bevel"}switch(f.linecap){case 1:s.lineCap="butt";break;case 2:s.lineCap="round";break;case 3:s.lineCap="square"}s.stroke(g)}function rB(s,e,i,c,f=!1){if(e.stops.length===1){const B=e.stops[0];return t0(B.rgb_color,B.opacity*i,c)}const{x1:g,y1:y,x2:b,y2:E}=e;let M=new DOMPoint(g,y),R=new DOMPoint(b,E);if(f){const B=r0(e.transform);M=B.transformPoint(M),R=B.transformPoint(R)}const z=s.createLinearGradient(M.x,M.y,R.x,R.y);for(const B of e.stops)z.addColorStop(B.offset,t0(B.rgb_color,B.opacity*i,c));return z}function nB(s,e,i,c,f=!1){if(e.stops.length===1){const J=e.stops[0];return t0(J.rgb_color,J.opacity*i,c)}const g=r0(e.transform),{fx:y,fy:b,fr:E,cx:M,cy:R,r:z}=e;let B=new DOMPoint(y,b),j=new DOMPoint(M,R),V=E,Y=z;if(f){B=g.transformPoint(B),j=g.transformPoint(j);const J=(g.a+g.d)/2;V=E*J,Y=e.r*J}const re=s.createRadialGradient(B.x,B.y,V,j.x,j.y,Y);for(const J of e.stops)re.addColorStop(J.offset,t0(J.rgb_color,J.opacity*i,c));return re}function iB(s,e,i,c){const f=c.transform?r0(c.transform).preMultiplySelf(e):e,g=v1(s.canvas.width,s.canvas.height),y=g.getContext("2d");for(const E of c.children)if(E.group)iB(y,f,i,E.group);else if(E.path){const M=E.path,R=new Path2D;R.addPath(lB(M),f),y.fill(R,eB(M))}const b=c.clip_path_idx!=null?i.clip_paths[c.clip_path_idx]:null;b&&aB(y,f,i,b),s.globalCompositeOperation="source-over",s.drawImage(g,0,0)}function aB(s,e,i,c){const f=v1(s.canvas.width,s.canvas.height);iB(f.getContext("2d"),e,i,c),s.globalCompositeOperation="destination-in",s.drawImage(f,0,0)}function oB(s,e,i,c,f){if(c.children.length===0)return;const g=c.mask_idx!=null?i.masks[c.mask_idx]:null;g&&oB(s,e,i,g,f);const y=s.canvas.width,b=s.canvas.height,E=v1(y,b),M=E.getContext("2d"),R=c.width,z=c.height,B=c.left,j=c.top,V=new Path2D,Y=new Path2D;Y.rect(B,j,R,z),V.addPath(Y,e),M.clip(V);for(const oe of c.children)QL(M,e,i,oe,f);const re=M.getImageData(0,0,y,b),J=re.data;if(c.mask_type===1)for(let oe=0;oe<J.length;oe+=4)J[oe+3]=J[oe+3]/255*(.2126*J[oe]+.7152*J[oe+1]+.0722*J[oe+2]);M.putImageData(re,0,0),s.globalCompositeOperation="destination-in",s.drawImage(E,0,0)}function r0(s){return s?new DOMMatrix([s.sx,s.ky,s.kx,s.sy,s.tx,s.ty]):new DOMMatrix}function sB(s,e){const i=s.step;let c=s.diffs[0]*i,f=s.diffs[1]*i;e.moveTo(c,f);for(let g=0,y=2;g<s.commands.length;g++)switch(s.commands[g]){case 1:c+=s.diffs[y++]*i,f+=s.diffs[y++]*i,e.moveTo(c,f);break;case 2:c+=s.diffs[y++]*i,f+=s.diffs[y++]*i,e.lineTo(c,f);break;case 3:{const b=c+s.diffs[y++]*i,E=f+s.diffs[y++]*i;c=b+s.diffs[y++]*i,f=E+s.diffs[y++]*i,e.quadraticCurveTo(b,E,c,f);break}case 4:{const b=c+s.diffs[y++]*i,E=f+s.diffs[y++]*i,M=b+s.diffs[y++]*i,R=E+s.diffs[y++]*i;c=M+s.diffs[y++]*i,f=R+s.diffs[y++]*i,e.bezierCurveTo(b,E,M,R,c,f);break}case 5:e.closePath();break}return e}function lB(s){return sB(s,new Path2D)}class T2{constructor(e){this.capacity=e,this.cache=new Map}get(e){if(!this.cache.has(e))return;const i=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,i),i}put(e,i){this.cache.has(e)?this.cache.delete(e):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(e,i)}delete(e){this.cache.delete(e)}}jt(T2,"LRUCache");class AE{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(e){return new Ja(e,e.data)}getFromCache(e,i,c){return this.cacheMap.has(c)||this.cacheMap.set(c,new T2(150)),this.cacheMap.get(c).get(Xl(e.toString(),i))}setInCache(e,i,c,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new T2(150));const g=this.cacheDependenciesMap.get(f),y=Xl(e.id.toString(),c);g.get(y)||g.set(y,new Set);const b=this.cacheMap.get(f),E=e.toString();g.get(y).add(E),b.put(Xl(e.toString(),c),i)}removeImagesFromCacheByIds(e,i,c=0){if(!this.cacheMap.has(c)||!this.cacheDependenciesMap.has(c))return;const f=this.cacheMap.get(c),g=this.cacheDependenciesMap.get(c);for(const y of e){const b=Xl(y.toString(),i);if(g.has(b)){for(const E of g.get(b))f.delete(E);g.delete(b)}}}rasterize(e,i,c,f){const g=this.getFromCache(e,c,f);if(g)return g.clone();const y=(function(E,M){const R=Zq.calculate(M.params,E.metadata?E.metadata.variables:[]),z=E.usvg_tree,B=z.width,j=z.height,V=Math.max(1,Math.round(B*M.sx)),Y=Math.max(1,Math.round(j*M.sy)),re=new DOMMatrix([V/B,0,0,Y/j,0,0]);return x1===null&&(x1=v1(10,10),bE=x1.getContext("2d",{willReadFrequently:!0})),x1.width=V,x1.height=Y,wE(bE,re,z,z,R),bE.getImageData(0,0,V,Y)})(i.icon,e),b=AE._getImage(y);return this.setInCache(e,b,c,f),b.clone()}}class cB{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const c=this.toIdx(e,i);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function uB(s,e,i,c){let f=0,g=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(i[y]<s[y]||i[y]>e[y])return null}else{const b=1/c[y];let E=(s[y]-i[y])*b,M=(e[y]-i[y])*b;if(E>M){const R=E;E=M,M=R}if(E>f&&(f=E),M<g&&(g=M),f>g)return null}return f}function hB(s,e,i,c,f,g,y,b,E,M,R){const z=c-s,B=f-e,j=g-i,V=y-s,Y=b-e,re=E-i,J=R[1]*re-R[2]*Y,oe=R[2]*V-R[0]*re,ce=R[0]*Y-R[1]*V,pe=z*J+B*oe+j*ce;if(Math.abs(pe)<1e-15)return null;const Se=1/pe,we=M[0]-s,Ie=M[1]-e,Pe=M[2]-i,Oe=(we*J+Ie*oe+Pe*ce)*Se;if(Oe<0||Oe>1)return null;const ke=Ie*j-Pe*B,Ge=Pe*z-we*j,pt=we*B-Ie*z,ct=(R[0]*ke+R[1]*Ge+R[2]*pt)*Se;return ct<0||Oe+ct>1?null:(V*ke+Y*Ge+re*pt)*Se}function dB(s,e,i){return(s-e)/(i-e)}function fB(s,e,i,c,f,g,y,b,E){const M=1<<i,R=g-c,z=y-f,B=(s+1)/M*R+c,j=(e+0)/M*z+f,V=(e+1)/M*z+f;b[0]=(s+0)/M*R+c,b[1]=j,E[0]=B,E[1]=V}class pB{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=(function(g){const y=Math.ceil(Math.log2(g.dim/8)),b=[];let E=Math.ceil(Math.pow(2,y));const M=1/E,R=(j,V,Y,re,J)=>{const oe=re?1:0,ce=(j+1)*Y-oe,pe=V*Y,Se=(V+1)*Y-oe;J[0]=j*Y,J[1]=pe,J[2]=ce,J[3]=Se};let z=new cB(E);const B=[];for(let j=0;j<E*E;j++){R(j%E,Math.floor(j/E),M,!1,B);const V=Mg(B[0],B[1],g),Y=Mg(B[2],B[1],g),re=Mg(B[2],B[3],g),J=Mg(B[0],B[3],g);z.minimums.push(Math.min(V,Y,re,J)),z.maximums.push(Math.max(V,Y,re,J)),z.leaves.push(1)}for(b.push(z),E/=2;E>=1;E/=2){const j=b[b.length-1];z=new cB(E);for(let V=0;V<E*E;V++){R(V%E,Math.floor(V/E),2,!0,B);const Y=j.getElevation(B[0],B[1]),re=j.getElevation(B[2],B[1]),J=j.getElevation(B[2],B[3]),oe=j.getElevation(B[0],B[3]),ce=j.isLeaf(B[0],B[1]),pe=j.isLeaf(B[2],B[1]),Se=j.isLeaf(B[2],B[3]),we=j.isLeaf(B[0],B[3]),Ie=Math.min(Y.min,re.min,J.min,oe.min),Pe=Math.max(Y.max,re.max,J.max,oe.max),Oe=ce&&pe&&Se&&we;z.maximums.push(Pe),z.minimums.push(Ie),z.leaves.push(Pe-Ie<=5&&Oe?1:0)}b.push(z)}return b})(this.dem),c=i.length-1,f=i[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(i,0,0,c,0)}raycastRoot(e,i,c,f,g,y,b=1){return uB([e,i,-100],[c,f,this.maximums[0]*b],g,y)}raycast(e,i,c,f,g,y,b=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,i,c,f,g,y,b);if(E==null)return null;const M=[],R=[],z=[],B=[],j=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;j.length>0;){const{idx:V,t:Y,nodex:re,nodey:J,depth:oe}=j.pop();if(this.leaves[V]){fB(re,J,oe,e,i,c,f,z,B);const pe=1<<oe,Se=(re+0)/pe,we=(re+1)/pe,Ie=(J+0)/pe,Pe=(J+1)/pe,Oe=Mg(Se,Ie,this.dem)*b,ke=Mg(we,Ie,this.dem)*b,Ge=Mg(we,Pe,this.dem)*b,pt=Mg(Se,Pe,this.dem)*b,ct=hB(z[0],z[1],Oe,B[0],z[1],ke,B[0],B[1],Ge,g,y),dt=hB(B[0],B[1],Ge,z[0],B[1],pt,z[0],z[1],Oe,g,y),St=Math.min(ct!==null?ct:Number.MAX_VALUE,dt!==null?dt:Number.MAX_VALUE);if(St!==Number.MAX_VALUE)return St;{const At=ar([],g,y,Y);if(mB(Oe,ke,pt,Ge,dB(At[0],z[0],B[0]),dB(At[1],z[1],B[1]))>=At[2])return Y}continue}let ce=0;for(let pe=0;pe<this._siblingOffset.length;pe++){fB((re<<1)+this._siblingOffset[pe][0],(J<<1)+this._siblingOffset[pe][1],oe+1,e,i,c,f,z,B),z[2]=-100,B[2]=this.maximums[this.childOffsets[V]+pe]*b;const Se=uB(z,B,g,y);if(Se!=null){const we=Se;M[pe]=we;let Ie=!1;for(let Pe=0;Pe<ce&&!Ie;Pe++)we>=M[R[Pe]]&&(R.splice(Pe,0,pe),Ie=!0);Ie||(R[ce]=pe),ce++}}for(let pe=0;pe<ce;pe++){const Se=R[pe];j.push({idx:this.childOffsets[V]+Se,t:M[Se],nodex:(re<<1)+this._siblingOffset[Se][0],nodey:(J<<1)+this._siblingOffset[Se][1],depth:oe+1})}}return null}_addNode(e,i,c){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,c,f,g){if(e[f].isLeaf(i,c)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const y=f-1,b=e[y];let E=0,M=0;for(let R=0;R<this._siblingOffset.length;R++){const z=2*i+this._siblingOffset[R][0],B=2*c+this._siblingOffset[R][1],j=b.getElevation(z,B),V=b.isLeaf(z,B),Y=this._addNode(j.min,j.max,V);V&&(E|=1<<R),M||(M=Y)}for(let R=0;R<this._siblingOffset.length;R++)E&1<<R||this._construct(e,2*i+this._siblingOffset[R][0],2*c+this._siblingOffset[R][1],y,M+R)}}function mB(s,e,i,c,f,g){return Dr(Dr(s,i,g),Dr(e,c,g),f)}function Mg(s,e,i){const c=i.dim,f=Ee(s*c-.5,0,c-1),g=Ee(e*c-.5,0,c-1),y=Math.floor(f),b=Math.floor(g),E=Math.min(y+1,c-1),M=Math.min(b+1,c-1);return mB(i.get(y,b),i.get(E,b),i.get(y,M),i.get(E,M),f-y,g-b)}const Wq={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Yq(s,e,i){return(256*s*256+256*e+i)/10-1e4}function Kq(s,e,i){return 256*s+e+i/256-32768}class S2{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,c,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return void br(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const g=this.dim=i.height-2,y=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.floatView=new Float32Array(i.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let E=0;E<g;E++)y[this._idx(-1,E)]=y[this._idx(0,E)],y[this._idx(g,E)]=y[this._idx(g-1,E)],y[this._idx(E,-1)]=y[this._idx(E,0)],y[this._idx(E,g)]=y[this._idx(E,g-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(g,-1)]=y[this._idx(g-1,0)],y[this._idx(-1,g)]=y[this._idx(0,g-1)],y[this._idx(g,g)]=y[this._idx(g-1,g-1)]}const b=c==="terrarium"?Kq:Yq;for(let E=0;E<y.length;++E){const M=4*E;this.floatView[E]=b(this.pixels[M],this.pixels[M+1],this.pixels[M+2])}this._timestamp=Is.now()}_buildQuadTree(){this._tree=new pB(this)}get(e,i,c=!1){c&&(e=Ee(e,-1,this.dim),i=Ee(i,-1,this.dim));const f=this._idx(e,i);return this.floatView[f]}set(e,i,c){const f=this._idx(e,i),g=this.floatView[f];return this.floatView[f]=c,c-g}static getUnpackVector(e){return Wq[e]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const c=[0,0,0,0],f=S2.getUnpackVector(i);let g=Math.floor((e+f[3])/f[2]);return c[2]=g%256,g=Math.floor(g/256),c[1]=g%256,g=Math.floor(g/256),c[0]=g,c}getPixels(){return new Ew({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=i*this.dim,g=i*this.dim+this.dim,y=c*this.dim,b=c*this.dim+this.dim;switch(i){case-1:f=g-1;break;case 1:g=f+1}switch(c){case-1:y=b-1;break;case 1:b=y+1}const E=-i*this.dim,M=-c*this.dim;for(let R=y;R<b;R++)for(let z=f;z<g;z++){const B=4*this._idx(z,R),j=4*this._idx(z+E,R+M);this.pixels[B+0]=e.pixels[j+0],this.pixels[B+1]=e.pixels[j+1],this.pixels[B+2]=e.pixels[j+2],this.pixels[B+3]=e.pixels[j+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Qq(s,e,i){s===1?e.headerLength=i.readFixed32():s===2?e.x=i.readVarint():s===3?e.y=i.readVarint():s===4?e.z=i.readVarint():s===5&&e.layers.push((function(c,f){return c.readFields(nH,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)})(i,i.readVarint()+i.pos))}function Jq(s,e,i){s===1?(e.delta_filter=(function(c,f){return c.readFields(eH,{blockSize:0},f)})(i,i.readVarint()+i.pos),e.filter="delta_filter"):s===2?(i.readVarint(),e.filter="zigzag_filter"):s===3?(i.readVarint(),e.filter="bitshuffle_filter"):s===4&&(i.readVarint(),e.filter="byteshuffle_filter")}function eH(s,e,i){s===1&&(e.blockSize=i.readVarint())}function tH(s,e,i){s===1?(i.readVarint(),e.codec="gzip_data"):s===2?(i.readVarint(),e.codec="jpeg_image"):s===3?(i.readVarint(),e.codec="webp_image"):s===4&&(i.readVarint(),e.codec="png_image")}function rH(s,e,i){let c=0,f=0;s===1?e.firstByte=i.readFixed64():s===2?e.lastByte=i.readFixed64():s===3?e.filters.push((function(g,y){return g.readFields(Jq,{},y)})(i,i.readVarint()+i.pos)):s===4?e.codec=(function(g,y){return g.readFields(tH,{},y)})(i,i.readVarint()+i.pos):s===5?f=i.readFloat():s===6?c=i.readFloat():s===7?e.bands.push(i.readString()):s===8?e.offset=i.readDouble():s===9&&(e.scale=i.readDouble()),e.offset===0&&(e.offset=f),e.scale===0&&(e.scale=c)}function nH(s,e,i){s===1?e.version=i.readVarint():s===2?e.name=i.readString():s===3?e.units=i.readString():s===4?e.tileSize=i.readVarint():s===5?e.buffer=i.readVarint():s===6?e.pixelFormat=i.readVarint():s===7&&e.dataIndex.push((function(c,f){return c.readFields(rH,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)})(i,i.readVarint()+i.pos))}function iH(s,e,i){if(s===2)(function(c,f,g){c.readFields(aH,g,f)})(i,i.readVarint()+i.pos,e);else if(s===3)throw new Error("Not implemented")}function aH(s,e,i){if(s===1){let c=0;const f=i.readVarint()+i.pos;for(;i.pos<f;)e[c++]=i.readVarint()}}function oH(s,e){if(e.length!==4)throw new Error(`Expected data of dimension 4 but got ${e.length}.`);let i=e[3];for(let c=2;c>=1;c--){const f=c===1?1:0,g=c===2?1:0;for(let y=0;y<e[0];y++){const b=e[1]*y;for(let E=f;E<e[1];E++){const M=e[2]*(E+b);for(let R=g;R<e[2];R++){const z=e[3]*(R+M);for(let B=0;B<e[3];B++){const j=z+B;s[j]+=s[j-i]}}}}i*=e[c]}return s}function sH(s){for(let e=0,i=s.length;e<i;e++)s[e]=s[e]>>>1^-(1&s[e]);return s}function lH(s,e){switch(e){case"uint32":return s;case"uint16":for(let i=0;i<s.length;i+=2){const c=s[i],f=s[i+1];s[i]=(240&c)>>4|(61440&c)>>8|(240&f)<<4|61440&f,s[i+1]=15&c|(3840&c)>>4|(15&f)<<8|(3840&f)<<4}return s;case"uint8":for(let i=0;i<s.length;i+=4){const c=s[i],f=s[i+1],g=s[i+2],y=s[i+3];s[i+0]=(192&c)>>6|(192&f)>>4|(192&g)>>2|192&y,s[i+1]=(48&c)>>4|(48&f)>>2|48&g|(48&y)<<2,s[i+2]=(12&c)>>2|12&f|(12&g)<<2|(12&y)<<4,s[i+3]=3&c|(3&f)<<2|(3&g)<<4|(3&y)<<6}return s;default:throw new Error(`Invalid pixel format, "${e}"`)}}jt(S2,"DEMData"),jt(pB,"DemMinMaxQuadTree",{omit:["dem"]});var Tu=Uint8Array,b1=Uint16Array,cH=Int32Array,gB=new Tu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_B=new Tu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uH=new Tu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yB=function(s,e){for(var i=new b1(31),c=0;c<31;++c)i[c]=e+=1<<s[c-1];var f=new cH(i[30]);for(c=1;c<30;++c)for(var g=i[c];g<i[c+1];++g)f[g]=g-i[c]<<5|c;return{b:i,r:f}},vB=yB(gB,2),xB=vB.b,hH=vB.r;xB[28]=258,hH[258]=28;for(var dH=yB(_B,0).b,bB=new b1(32768),Ua=0;Ua<32768;++Ua){var n0=(43690&Ua)>>1|(21845&Ua)<<1;bB[Ua]=((65280&(n0=(61680&(n0=(52428&n0)>>2|(13107&n0)<<2))>>4|(3855&n0)<<4))>>8|(255&n0)<<8)>>1}var w1=function(s,e,i){for(var c=s.length,f=0,g=new b1(e);f<c;++f)s[f]&&++g[s[f]-1];var y,b=new b1(e);for(f=1;f<e;++f)b[f]=b[f-1]+g[f-1]<<1;y=new b1(1<<e);var E=15-e;for(f=0;f<c;++f)if(s[f])for(var M=f<<4|s[f],R=e-s[f],z=b[s[f]-1]++<<R,B=z|(1<<R)-1;z<=B;++z)y[bB[z]>>E]=M;return y},A1=new Tu(288);for(Ua=0;Ua<144;++Ua)A1[Ua]=8;for(Ua=144;Ua<256;++Ua)A1[Ua]=9;for(Ua=256;Ua<280;++Ua)A1[Ua]=7;for(Ua=280;Ua<288;++Ua)A1[Ua]=8;var wB=new Tu(32);for(Ua=0;Ua<32;++Ua)wB[Ua]=5;var fH=w1(A1,9),pH=w1(wB,5),TE=function(s){for(var e=s[0],i=1;i<s.length;++i)s[i]>e&&(e=s[i]);return e},Td=function(s,e,i){var c=e/8|0;return(s[c]|s[c+1]<<8)>>(7&e)&i},SE=function(s,e){var i=e/8|0;return(s[i]|s[i+1]<<8|s[i+2]<<16)>>(7&e)},mH=function(s){return(s+7)/8|0},gH=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Sd=function(s,e,i){var c=new Error(e||gH[s]);if(c.code=s,Error.captureStackTrace&&Error.captureStackTrace(c,Sd),!i)throw c;return c},_H=new Tu(0),yH=typeof TextDecoder<"u"&&new TextDecoder;try{yH.decode(_H,{stream:!0})}catch{}const vH={gzip_data:"gzip"};class vh extends Error{constructor(e){super(e),this.name="MRTError"}}const xH={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},AB={uint32:1,uint16:2,uint8:4},bH={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let EE;class E2{constructor(e=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=e}getLayer(e){const i=this.layers[e];if(!i)throw new vh(`Layer '${e}' not found`);return i}getHeaderLength(e){const i=new Uint8Array(e),c=new DataView(e);if(i[0]!==13)throw new vh("File is not a valid MRT.");return c.getUint32(1,!0)}parseHeader(e){const i=new Uint8Array(e),c=this.getHeaderLength(e);if(i.length<c)throw new vh(`Expected header with length >= ${c} but got buffer of length ${i.length}`);const f=new EE(i.subarray(0,c)).readFields(Qq,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new vh(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const g of f.layers)this.layers[g.name]=new TB(g,{cacheSize:this._cacheSize});return this}createDecodingTask(e){const i=[],c=this.getLayer(e.layerName);for(let f of e.blockIndices){const g=c.dataIndex[f],y=g.firstByte-e.firstByte,b=g.lastByte-e.firstByte;if(c._blocksInProgress.has(f))continue;const E={layerName:c.name,firstByte:y,lastByte:b,pixelFormat:c.pixelFormat,blockIndex:f,blockShape:[g.bands.length].concat(c.bandShape),buffer:c.buffer,codec:g.codec.codec,filters:g.filters.map(M=>M.filter)};c._blocksInProgress.add(f),i.push(E)}return new SB(i,()=>{i.forEach(f=>c._blocksInProgress.delete(f.blockIndex))},(f,g)=>{if(i.forEach(y=>c._blocksInProgress.delete(y.blockIndex)),f)throw f;g.forEach(y=>{this.getLayer(y.layerName).processDecodedData(y)})})}}class TB{constructor({version:e,name:i,units:c,tileSize:f,pixelFormat:g,buffer:y,dataIndex:b},E){if(this.version=e,this.version!==1)throw new vh(`Cannot parse raster layer encoded with MRT version ${e}`);this.name=i,this.units=c,this.tileSize=f,this.buffer=y,this.pixelFormat=xH[g],this.dataIndex=b,this.bandShape=[f+2*y,f+2*y,AB[this.pixelFormat]],this._decodedBlocks=new T2(E?E.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return AB[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:e})=>e).flat()}processDecodedData(e){const i=e.blockIndex.toString();this._decodedBlocks.get(i)||this._decodedBlocks.put(i,e.data)}getBlockForBand(e){let i=0;switch(typeof e){case"string":for(const[c,f]of this.dataIndex.entries()){for(const[g,y]of f.bands.entries())if(y===e)return{bandIndex:i+g,blockIndex:c,blockBandIndex:g};i+=f.bands.length}break;case"number":for(const[c,f]of this.dataIndex.entries()){if(e>=i&&e<i+f.bands.length)return{bandIndex:e,blockIndex:c,blockBandIndex:e-i};i+=f.bands.length}break;default:throw new vh(`Invalid band \`${JSON.stringify(e)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(e){let i=1/0,c=-1/0;const f=[],g=new Set;for(const y of e){const{blockIndex:b}=this.getBlockForBand(y);if(b<0)throw new vh(`Invalid band: ${JSON.stringify(y)}`);const E=this.dataIndex[b];f.includes(b)||f.push(b),g.add(b),i=Math.min(i,E.firstByte),c=Math.max(c,E.lastByte)}if(g.size>this.cacheSize)throw new vh(`Number of blocks to decode (${g.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:i,lastByte:c,blockIndices:f}}hasBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0}hasDataForBand(e){const{blockIndex:i}=this.getBlockForBand(e);return i>=0&&!!this._decodedBlocks.get(i.toString())}getBandView(e){const{blockIndex:i,blockBandIndex:c}=this.getBlockForBand(e);if(i<0)throw new vh(`Band not found: ${JSON.stringify(e)}`);const f=this._decodedBlocks.get(i.toString());if(!f)throw new vh(`Data for band ${JSON.stringify(e)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[i],y=this.bandShape.reduce((M,R)=>M*R,1),b=c*y,E=f.subarray(b,b+y);return{data:E,bytes:new Uint8Array(E.buffer).subarray(E.byteOffset,E.byteOffset+E.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:g.offset,scale:g.scale}}}E2.setPbf=function(s){EE=s};class SB{constructor(e,i,c){this.tasks=e,this._onCancel=i,this._onComplete=c,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(e,i){this._finalized||(this._onComplete(e,i),this._finalized=!0)}}E2.performDecoding=function(s,e){const i=new Uint8Array(s);return Promise.all(e.tasks.map(c=>{const{layerName:f,firstByte:g,lastByte:y,pixelFormat:b,blockShape:E,blockIndex:M,filters:R,codec:z}=c,B=i.subarray(g,y+1),j=new Uint32Array(E[0]*E[1]*E[2]);let V;if(z!=="gzip_data")throw new vh(`Unhandled codec: ${z}`);return V=(function(Y,re){if(!globalThis.DecompressionStream&&re==="gzip_data")return Promise.resolve((Se=(function(Pe){Pe[0]==31&&Pe[1]==139&&Pe[2]==8||Sd(6,"invalid gzip data");var Oe=Pe[3],ke=10;4&Oe&&(ke+=2+(Pe[10]|Pe[11]<<8));for(var Ge=(Oe>>3&1)+(Oe>>4&1);Ge>0;Ge-=!Pe[ke++]);return ke+(2&Oe)})(J=Y),Se+8>J.length&&Sd(6,"invalid gzip data"),(function(Pe,Oe,ke,Ge){var pt=Pe.length;if(!pt||Oe.f&&!Oe.l)return ke||new Tu(0);var ct=!ke,dt=ct||Oe.i!=2,St=Oe.i;ct&&(ke=new Tu(3*pt));var At=function(Us){var Df=ke.length;if(Us>Df){var vs=new Tu(Math.max(2*Df,Us));vs.set(ke),ke=vs}},Tt=Oe.f||0,lt=Oe.p||0,Ot=Oe.b||0,xt=Oe.l,It=Oe.d,Et=Oe.m,rr=Oe.n,nr=8*pt;do{if(!xt){Tt=Td(Pe,lt,1);var Ht=Td(Pe,lt+1,3);if(lt+=3,!Ht){var Yt=Pe[(vn=mH(lt)+4)-4]|Pe[vn-3]<<8,wr=vn+Yt;if(wr>pt){St&&Sd(0);break}dt&&At(Ot+Yt),ke.set(Pe.subarray(vn,wr),Ot),Oe.b=Ot+=Yt,Oe.p=lt=8*wr,Oe.f=Tt;continue}if(Ht==1)xt=fH,It=pH,Et=9,rr=5;else if(Ht==2){var gr=Td(Pe,lt,31)+257,tr=Td(Pe,lt+10,15)+4,Fr=gr+Td(Pe,lt+5,31)+1;lt+=14;for(var nn=new Tu(Fr),On=new Tu(19),Yr=0;Yr<tr;++Yr)On[uH[Yr]]=Td(Pe,lt+3*Yr,7);lt+=3*tr;var Hn=TE(On),gn=(1<<Hn)-1,ta=w1(On,Hn);for(Yr=0;Yr<Fr;){var vn,Un=ta[Td(Pe,lt,gn)];if(lt+=15&Un,(vn=Un>>4)<16)nn[Yr++]=vn;else{var bi=0,Di=0;for(vn==16?(Di=3+Td(Pe,lt,3),lt+=2,bi=nn[Yr-1]):vn==17?(Di=3+Td(Pe,lt,7),lt+=3):vn==18&&(Di=11+Td(Pe,lt,127),lt+=7);Di--;)nn[Yr++]=bi}}var Ri=nn.subarray(0,gr),ra=nn.subarray(gr);Et=TE(Ri),rr=TE(ra),xt=w1(Ri,Et),It=w1(ra,rr)}else Sd(1);if(lt>nr){St&&Sd(0);break}}dt&&At(Ot+131072);for(var To=(1<<Et)-1,es=(1<<rr)-1,Ca=lt;;Ca=lt){var Va=(bi=xt[SE(Pe,lt)&To])>>4;if((lt+=15&bi)>nr){St&&Sd(0);break}if(bi||Sd(2),Va<256)ke[Ot++]=Va;else{if(Va==256){Ca=lt,xt=null;break}var eo=Va-254;Va>264&&(eo=Td(Pe,lt,(1<<($i=gB[Yr=Va-257]))-1)+xB[Yr],lt+=$i);var Xr=It[SE(Pe,lt)&es],zi=Xr>>4;if(Xr||Sd(3),lt+=15&Xr,ra=dH[zi],zi>3){var $i=_B[zi];ra+=SE(Pe,lt)&(1<<$i)-1,lt+=$i}if(lt>nr){St&&Sd(0);break}dt&&At(Ot+131072);var ic=Ot+eo;if(Ot<ra){var js=0-ra,So=Math.min(ra,ic);for(js+Ot<0&&Sd(3);Ot<So;++Ot)ke[Ot]=Ge[js+Ot]}for(;Ot<ic;++Ot)ke[Ot]=ke[Ot-ra]}}Oe.l=xt,Oe.p=Ca,Oe.b=Ot,Oe.f=Tt,xt&&(Tt=1,Oe.m=Et,Oe.d=It,Oe.n=rr)}while(!Tt);return Ot!=ke.length&&ct?(function(Us,Df,vs){return(vs==null||vs>Us.length)&&(vs=Us.length),new Tu(Us.subarray(0,vs))})(ke,0,Ot):ke.subarray(0,Ot)})(J.subarray(Se,-8),{i:2},new Tu(((ce=J)[(pe=ce.length)-4]|ce[pe-3]<<8|ce[pe-2]<<16|ce[pe-1]<<24)>>>0),oe)));var J,oe,ce,pe,Se;const we=vH[re];if(!we)throw new Error(`Unhandled codec: ${re}`);const Ie=new globalThis.DecompressionStream(we);return new Response(new Blob([Y]).stream().pipeThrough(Ie)).arrayBuffer().then(Pe=>new Uint8Array(Pe))})(B,z).then(Y=>((function(re,J){re.readFields(iH,J)})(new EE(Y),j),new bH[b](j.buffer))),V.then(Y=>{for(let re=R.length-1;re>=0;re--)switch(R[re]){case"delta_filter":oH(Y,E);break;case"zigzag_filter":sH(Y);break;case"bitshuffle_filter":lH(Y,b);break;default:throw new vh(`Unhandled filter "${R[re]}"`)}return{layerName:f,blockIndex:M,data:Y}}).catch(Y=>{throw Y})}))},jt(SB,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),jt(E2,"MapboxRasterTile"),jt(TB,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class EB{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const c=e[i];this._stringToNumber[c]=i,this._numberToString[i]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class MB{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ic(Gt,16,0),this.featureIndexArray=new yu,this.promoteId=i,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(e,i,c,f,g,y=0,b=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,g,y);const M=this.grid;for(let R=0;R<i.length;R++){const z=i[R],B=[1/0,1/0,-1/0,-1/0];for(let j=0;j<z.length;j++){const V=z[j];B[0]=Math.min(B[0],V.x),B[1]=Math.min(B[1],V.y),B[2]=Math.max(B[2],V.x),B[3]=Math.max(B[3],V.y)}b!==0&&(B[0]-=b,B[1]-=b,B[2]+=b,B[3]+=b),B[0]<Gt&&B[1]<Gt&&B[2]>=0&&B[3]>=0&&M.insert(E,B[0],B[1],B[2],B[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new hn(new n2(this.rawTileData)).layers,this.sourceLayerCoder=new EB(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i){const{tilespaceGeometry:c,transform:f,tileTransform:g,pixelPosMatrix:y,availableImages:b,worldview:E}=i;this.loadVTLayers(),this.serializedLayersCache.clear();const M=i.queryRadius?i.queryRadius:0,R=c.bufferedTilespaceBounds,z=this.grid.query(R.min.x,R.min.y,R.max.x,R.max.y,(Y,re,J,oe)=>nl(c.bufferedTilespaceGeometry,Y-M,re-M,J+M,oe+M));z.sort(wH);let B=null;f.elevation&&z.length>0&&(B=e0.create(f.elevation,this.tileID));const j={};let V;for(let Y=0;Y<z.length;Y++){const re=z[Y];if(re===V)continue;V=re;const J=this.featureIndexArray.get(re);let oe=null;this.is3DTile?this.loadMatchingModelFeature(j,J,e,c,f,E):this.loadMatchingFeature(j,J,e,b,E,(ce,pe,Se,we=0)=>(oe||(oe=Ir(ce,this.tileID.canonical,g)),pe.queryIntersectsFeature(c,ce,Se,oe,this.z,f,y,B,we,i.scope)))}return j}loadMatchingFeature(e,i,c,f,g,y){const{featureIndex:b,bucketIndex:E,sourceLayerIndex:M,layoutVertexArrayOffset:R}=i,z=this.bucketLayerIDs[E],B=c.layers,j=Object.keys(B);if(j.length&&!Sr(j,z))return;const V=c.sourceCache,Y=this.sourceLayerCoder.decode(M),re=this.vtLayers[Y].feature(b),J=this.getId(re,Y);for(let oe=0;oe<z.length;oe++){const ce=z[oe];if(!B[ce])continue;const{styleLayer:pe,targets:Se}=B[ce];let we={};J!==void 0&&(we=V.getFeatureState(pe.sourceLayer,J));const Ie=!y||y(re,pe,we,R);if(!Ie)continue;const Pe=new fy(re,this.z,this.x,this.y,J);Pe.tile=this.tileID.canonical,Pe.state=we;let Oe=this.serializedLayersCache.get(ce);Oe||(Oe=pe.serialize(),Oe.id=ce,this.serializedLayersCache.set(ce,Oe)),Pe.source=Oe.source,Pe.sourceLayer=Oe["source-layer"],Pe.layer=Object.assign({},Oe),Pe.layer.paint=OB(Oe.paint,pe.paint,re,we,f),Pe.layer.layout=OB(Oe.layout,pe.layout,re,we,f);let ke=!1;for(const Ge of Se){this.updateFeatureProperties(Pe,Ge);const{filter:pt}=Ge;if(pt){if(re.properties=Pe.properties,pt.needGeometry){const ct=Vr(re,!0);if(!pt.filter(new In(this.tileID.overscaledZ,{worldview:g}),ct,this.tileID.canonical))continue}else if(!pt.filter(new In(this.tileID.overscaledZ,{worldview:g}),re))continue}ke=!0,Ge.targetId&&this.addFeatureVariant(Pe,Ge)}ke&&this.appendToResult(e,ce,b,Pe,Ie)}}loadMatchingModelFeature(e,i,c,f,g,y){const{featureIndex:b,bucketIndex:E}=i,M=this.bucketLayerIDs[E],R=c.layers,z=Object.keys(R);if(!z.length||Sr(z,M))for(let B=0;B<M.length;B++){const j=M[B],{styleLayer:V,targets:Y}=R[j];if(V.type!=="model")continue;const re=f.tile,J=re.getBucket(V);if(!(J&&J instanceof x2))continue;const oe=Cq(J,b,f,g);if(!oe)continue;const{z:ce,x:pe,y:Se}=re.tileID.canonical,{feature:we,intersectionZ:Ie,position:Pe}=oe;let Oe={};we.id!==void 0&&(Oe=c.sourceCache.getFeatureState(V.sourceLayer,we.id));const ke=new fy({},ce,pe,Se,we.id);ke.tile=this.tileID.canonical,ke.state=Oe,ke.properties=we.properties,ke.geometry={type:"Point",coordinates:[Pe.lng,Pe.lat]};let Ge=this.serializedLayersCache.get(j);Ge||(Ge=V.serialize(),Ge.id=j,this.serializedLayersCache.set(j,Ge)),ke.source=Ge.source,ke.sourceLayer=Ge["source-layer"],ke.layer=Object.assign({},Ge);let pt=!1;for(const ct of Y){this.updateFeatureProperties(ke,ct);const{filter:dt}=ct;if(dt){if(we.properties=ke.properties,dt.needGeometry){if(!dt.filter(new In(this.tileID.overscaledZ,{worldview:y}),we,this.tileID.canonical))continue}else if(!dt.filter(new In(this.tileID.overscaledZ,{worldview:y}),we))continue}pt=!0,ct.targetId&&this.addFeatureVariant(ke,ct)}pt&&this.appendToResult(e,j,b,ke,Ie)}}updateFeatureProperties(e,i,c){if(i.properties){const f={};for(const g in i.properties){const y=i.properties[g].evaluate({zoom:this.z},e._vectorTileFeature,e.state,e.tile,c);y!=null&&(f[g]=y)}e.properties=f}}addFeatureVariant(e,i,c){const f={target:i.target,namespace:i.namespace,uniqueFeatureID:i.uniqueFeatureID};i.properties&&(f.properties=e.properties),e.variants=e.variants||{},e.variants[i.targetId]=e.variants[i.targetId]||[],e.variants[i.targetId].push(f)}appendToResult(e,i,c,f,g){let y=e[i];y===void 0&&(y=e[i]=[]),y.push({featureIndex:c,feature:f,intersectionZ:g})}lookupSymbolFeatures(e,i,c,f,g,y){const b={};this.loadVTLayers();for(const E of e)this.loadMatchingFeature(b,{bucketIndex:i,sourceLayerIndex:c,featureIndex:E,layoutVertexArrayOffset:0},f,g,y);return b}loadFeature(e){const{featureIndex:i,sourceLayerIndex:c}=e;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),g=this.vtFeatures[f];if(g[i])return g[i];const y=this.vtLayers[f].feature(i);return g[i]=y,y}hasLayer(e){for(const i of this.bucketLayerIDs)for(const c of i)if(e===c)return!0;return!1}getId(e,i){let c=e.id;if(this.promoteId){const f=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[i];if(f!=null)if(Array.isArray(f)){if(!this.promoteIdExpression){const g=Cc(f);if(g.result!=="success"){const y=g.value.map(b=>`${b.key}: ${b.message}`).join(", ");return void br(`Failed to create expression for promoteId: ${y}`)}this.promoteIdExpression=g.value}c=this.promoteIdExpression.evaluate({zoom:0},e)}else c=e.properties[f];typeof c=="boolean"&&(c=Number(c))}return c}}function OB(s,e,i,c,f){return dr(s,(g,y)=>{const b=e instanceof Fo?e.get(y):null;return b&&b.evaluate?b.evaluate(i,c,void 0,f):b})}function wH(s,e){return e-s}jt(MB,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const CB=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ME{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,c]=new Uint8Array(e,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const g=CB[15&c];if(!g)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[b]=new Uint32Array(e,4,1);return new ME(b,y,g,e)}constructor(e,i=64,c=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=c,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const g=CB.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,b=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=e,this.coords[this._pos++]=i,c}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return OE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:b}=this,E=[0,g.length-1,0],M=[];for(;E.length;){const R=E.pop()||0,z=E.pop()||0,B=E.pop()||0;if(z-B<=b){for(let re=B;re<=z;re++){const J=y[2*re],oe=y[2*re+1];J>=e&&J<=c&&oe>=i&&oe<=f&&M.push(g[re])}continue}const j=B+z>>1,V=y[2*j],Y=y[2*j+1];V>=e&&V<=c&&Y>=i&&Y<=f&&M.push(g[j]),(R===0?e<=V:i<=Y)&&(E.push(B),E.push(j-1),E.push(1-R)),(R===0?c>=V:f>=Y)&&(E.push(j+1),E.push(z),E.push(1-R))}return M}within(e,i,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:y}=this,b=[0,f.length-1,0],E=[],M=c*c;for(;b.length;){const R=b.pop()||0,z=b.pop()||0,B=b.pop()||0;if(z-B<=y){for(let re=B;re<=z;re++)PB(g[2*re],g[2*re+1],e,i)<=M&&E.push(f[re]);continue}const j=B+z>>1,V=g[2*j],Y=g[2*j+1];PB(V,Y,e,i)<=M&&E.push(f[j]),(R===0?e-c<=V:i-c<=Y)&&(b.push(B),b.push(j-1),b.push(1-R)),(R===0?e+c>=V:i+c>=Y)&&(b.push(j+1),b.push(z),b.push(1-R))}return E}}function OE(s,e,i,c,f,g){if(f-c<=i)return;const y=c+f>>1;IB(s,e,y,c,f,g),OE(s,e,i,c,y-1,1-g),OE(s,e,i,y+1,f,1-g)}function IB(s,e,i,c,f,g){for(;f>c;){if(f-c>600){const M=f-c+1,R=i-c+1,z=Math.log(M),B=.5*Math.exp(2*z/3),j=.5*Math.sqrt(z*B*(M-B)/M)*(R-M/2<0?-1:1);IB(s,e,i,Math.max(c,Math.floor(i-R*B/M+j)),Math.min(f,Math.floor(i+(M-R)*B/M+j)),g)}const y=e[2*i+g];let b=c,E=f;for(T1(s,e,c,i),e[2*f+g]>y&&T1(s,e,c,f);b<E;){for(T1(s,e,b,E),b++,E--;e[2*b+g]<y;)b++;for(;e[2*E+g]>y;)E--}e[2*c+g]===y?T1(s,e,c,E):(E++,T1(s,e,E,f)),E<=i&&(c=E+1),i<=E&&(f=E-1)}}function T1(s,e,i,c){CE(s,i,c),CE(e,2*i,2*c),CE(e,2*i+1,2*c+1)}function CE(s,e,i){const c=s[e];s[e]=s[i],s[i]=c}function PB(s,e,i,c){const f=s-i,g=e-c;return f*f+g*g}a.$=Im,a.A=Wa,a.B=Xl,a.C=2,a.D=Vv,a.E=Qc,a.F=s1,a.G=eL,a.H=Vd,a.I=Do,a.J=M_,a.K=Rr,a.L=Cr,a.M=Kh,a.N=of,a.O=fu,a.P=yt,a.Q=td,a.R=va,a.S=tg,a.T=kS,a.U=Cc,a.V=v2,a.W=$l,a.X=Fi,a.Y=Xh,a.Z=Fa,a._=cs,a.a=function(s){return ya.API_CDN_URL_REGEX.test(s)},a.a$=wt,a.a0=Gd,a.a1=lv,a.a2=Op,a.a3=class extends v2{},a.a4=sf,a.a5=Oc,a.a6=Ye,a.a7=function(s){const e=s.value;return e?Gd(e)?gE(e,!0)?[]:[new v2(s.key,e,`invalid url "${e}"`)]:[new v2(s.key,e,`string expected, "${Rr(e)}" found`)]:[]},a.a8=uf,a.a9=vi,a.aA=Ee,a.aB=ue,a.aC=ii,a.aD=ae,a.aE=_s,a.aF=He,a.aG=Lt,a.aH=function(s,e){const i={};for(let c=0;c<e.length;c++){const f=e[c];f in s&&(i[f]=s[f])}return i},a.aI=Ne,a.aJ=Qe,a.aK=class{constructor(s){this.entries={},this.scheduler=s}request(s,e,i,c){const f=this.entries[s]=this.entries[s]||{callbacks:[]};if(f.result){const[g,y]=f.result;return this.scheduler?this.scheduler.add(()=>{c(g,y)},e):c(g,y),()=>{}}return f.callbacks.push(c),f.cancel||(f.cancel=i((g,y)=>{f.result=[g,y];for(const b of f.callbacks)this.scheduler?this.scheduler.add(()=>{b(g,y)},e):b(g,y);setTimeout(()=>delete this.entries[s],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(g=>g!==c),f.callbacks.length||(f.cancel(),delete this.entries[s]))}}},a.aL=function(s,e,i){const c=JSON.stringify(s.request);return s.data&&(this.deduped.entries[c]={result:[null,s.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},f=>{const g=kh(s.request,(y,b,E)=>{y?f(y):b&&f(null,{rawData:b,vectorTile:i?void 0:new hn(new n2(b)),responseHeaders:new Map(E.entries())})});return()=>{g.cancel(),f()}},e)},a.aM=function(s){return s?{cacheControl:s.get("Cache-Control"),expires:s.get("Expires")}:{cacheControl:void 0,expires:void 0}},a.aN=Bh,a.aO=function(s){fl++,fl>Am&&(s.getActor().send("enforceCacheSizeLimit",t_),fl=0)},a.aP=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log2(s)))},a.aQ=lo,a.aR=RL,a.aS=NL,a.aT=Te,a.aU=DL,a.aV=function(s,e){const i=document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let c=0;c<s.length;c++){const f=document.createElement("source");Tm(s[c])||(i.crossOrigin="Anonymous"),f.src=s[c],i.appendChild(f)}return{cancel:()=>{}}},a.aW=r1,a.aX=py,a.aY=Wt,a.aZ=u1,a.a_=ut,a.aa=Ft,a.ab=class{constructor(s){this.specification=s}possiblyEvaluate(s,e){return Xn(s.expression.evaluate(e))}interpolate(s,e,i){return{x:Dr(s.x,e.x,i),y:Dr(s.y,e.y,i),z:Dr(s.z,e.z,i),azimuthal:Dr(s.azimuthal,e.azimuthal,i),polar:Dr(s.polar,e.polar,i)}}},a.ac=In,a.ad=wo,a.ae=qt,a.af=Tr,a.ag=Mt,a.ah=Fe,a.ai=Fo,a.aj=vd,a.ak=Dr,a.al=Gt,a.am=o_,a.an=yr,a.ao=Cn,a.ap=class{constructor(s){this.specification=s}possiblyEvaluate(s,e){return(function([i,c]){const f=Xn([1,i,c]);return{x:f.x,y:f.y,z:f.z}})(s.expression.evaluate(e))}interpolate(s,e,i){return{x:Dr(s.x,e.x,i),y:Dr(s.y,e.y,i),z:Dr(s.z,e.z,i)}}},a.aq=function(s,e,i=0,c=!0){const f=new yt(i,i),g=s.sub(f),y=e.add(f),b=[g,new yt(y.x,g.y),y,new yt(g.x,y.y)];return c&&b.push(g.clone()),b},a.ar=function(s,e){const i=[];for(let c=0;c<s.length;c++){const f=it(c-1,-1,s.length-1),g=it(c+1,-1,s.length-1),y=s[c],b=s[g],E=s[f].sub(y).unit(),M=b.sub(y).unit(),R=M.angleWithSep(E.x,E.y),z=E.add(M).unit().mult(-1*e/Math.sin(R/2));i.push(y.add(z))}return i},a.as=_L,a.at=nl,a.au=function(s,e,i=0){return $e(((e.x-i)*s.scale-s.x)*Gt,(e.y*s.scale-s.y)*Gt,et(e.z,e.y))},a.av=_n,a.aw=Xt,a.ax=Kn,a.ay=Cz,a.az=function(s){let e=1/0,i=1/0,c=-1/0,f=-1/0;for(const g of s)e=Math.min(e,g.x),i=Math.min(i,g.y),c=Math.max(c,g.x),f=Math.max(f,g.y);return{min:new yt(e,i),max:new yt(c,f)}},a.b=function(s){return ya.API_FONTS_REGEX.test(s)},a.b$=X,a.b0=pa,a.b1=Rc,a.b2=Dt,a.b3=lg,a.b4=m2,a.b5=function(){zs.isLoading()||zs.isLoaded()||sh()!=="deferred"||Jm()},a.b6=rg,a.b7=Vr,a.b8=fy,a.b9=qn,a.bA=K,a.bB=ve,a.bC=Q,a.bD=function(s,e){const{x:i,y:c}=s.point,f=Ov(i,c,s.worldSize/s._pixelsPerMercatorPixel,0,0);return ue(f,f,si(wu(e)))},a.bE=L,a.bF=Fn,a.bG=Er,a.bH=ar,a.bI=kr,a.bJ=Mr,a.bK=Wv,a.bL=nc,a.bM=eE,a.bN=function(s,e,i,c,f){const g=5*e+2;s.float32[g+0]=i,s.float32[g+1]=c,s.float32[g+2]=f},a.bO=Jv,a.bP=qi,a.bQ=io,a.bR=$o,a.bS=qo,a.bT=it,a.bU=function(s,e,i,c){var f=new I(4);return f[0]=s,f[1]=e,f[2]=i,f[3]=c,f},a.bV=class{isDataAvailableAtPoint(s){const e=this._source();if(this.isUsingMockSource()||!e||s.y<0||s.y>1)return!1;const i=e.getSource().maxzoom,c=1<<i,f=Math.floor(s.x),g=Math.floor((s.x-f)*c),y=Math.floor(s.y*c),b=this.findDEMTileFor(new lo(i,f,i,g,y));return!(!b||!b.dem)}getAtPointOrZero(s,e=0){return this.getAtPoint(s,e)||0}getAtPoint(s,e,i=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const c=this._source();if(!c||s.y<0||s.y>1)return e;const f=c.getSource().maxzoom,g=1<<f,y=Math.floor(s.x),b=s.x-y,E=new lo(f,y,f,Math.floor(b*g),Math.floor(s.y*g)),M=this.findDEMTileFor(E);if(!M||!M.dem)return e;const R=M.dem,z=1<<M.tileID.canonical.z,B=(b*z-M.tileID.canonical.x)*R.dim,j=(s.y*z-M.tileID.canonical.y)*R.dim,V=Math.floor(B),Y=Math.floor(j);return(i?this.exaggeration():1)*Dr(Dr(R.get(V,Y),R.get(V,Y+1),j-Y),Dr(R.get(V+1,Y),R.get(V+1,Y+1),j-Y),B-V)}static getAtTileOffset(s,e,i,c){const f=1<<s.canonical.z;return c?c.pointElevation(e):i?i.getAtPointOrZero(new qt(s.wrap+(s.canonical.x+e.x/Gt)/f,(s.canonical.y+e.y/Gt)/f)):0}static getAtTileOffsetFunc(s,e,i,c){return(f,g,y)=>{const b=this.getAtTileOffset(s,f,g,y),E=c.upVector(s.canonical,f.x,f.y);return Bt(E,E,b*c.upVectorScale(s.canonical,e,i).metersToTile),E}}getForTilePoints(s,e,i,c){if(this.isUsingMockSource())return!1;const f=e0.create(this,s,c);return!!f&&(e.forEach(g=>{g[2]=this.exaggeration()*f.getElevationAt(g[0],g[1],i)}),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(s);if(!e||!e.dem)return null;const i=e.dem.tree,c=e.tileID,f=1<<s.canonical.z-c.canonical.z;let g=s.canonical.x/f-c.canonical.x,y=s.canonical.y/f-c.canonical.y,b=0;for(let E=0;E<s.canonical.z-c.canonical.z&&!i.leaves[b];E++){g*=2,y*=2;const M=2*Math.floor(y)+Math.floor(g);b=i.childOffsets[b]+M,g%=1,y%=1}return{min:this.exaggeration()*i.minimums[b],max:this.exaggeration()*i.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const s=this.visibleDemTiles;if(s.length===0)return null;let e=!1,i=Number.MAX_VALUE,c=Number.MIN_VALUE;for(const f of s){const g=this.getMinMaxForTile(f.tileID);g&&(i=Math.min(i,g.min),c=Math.max(c,g.max),e=!0)}return e?{min:i,max:c}:null}},a.bW=Hw,a.bX=xi,a.bY=co,a.bZ=iy,a.b_=jL,a.ba=HS,a.bb=yh,a.bc=Ir,a.bd=_u,a.be=yf,a.bf=Mx,a.bg=ui,a.bh=tc,a.bi=fE,a.bj=function(s,e){const i=vd(e.zoom);if(i===0)return wu(s);const c=fg(s),f=Cx(c),g=He(c.getWest())*e.worldSize,y=He(c.getEast())*e.worldSize,b=Qe(c.getNorth())*e.worldSize,E=Qe(c.getSouth())*e.worldSize,M=[g,b,0],R=[y,b,0],z=[g,E,0],B=[y,E,0],j=he([],e.globeMatrix);return Tr(M,M,j),Tr(R,R,j),Tr(z,z,j),Tr(B,B,j),f[0]=ph(f[0],z,i),f[1]=ph(f[1],B,i),f[2]=ph(f[2],R,i),f[3]=ph(f[3],M,i),An.fromPoints(f)},a.bk=G_,a.bl=he,a.bm=V_,a.bn=ph,a.bo=Zl,a.bp=gS,a.bq=Le,a.br=me,a.bs=E2,a.bt=n2,a.bu=kh,a.bv=function(s,e){const i=[];for(const c in s)c in e||i.push(c);return i},a.bw=qe,a.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.by=Or,a.bz=H,a.c=yo,a.c$=function(s,e,i){let c=0;for(let f=0;f<2;++f)s[f]>0&&(c+=(s[f]-0)*(s[f]-0)),e[f]<0&&(c+=(0-e[f])*(0-e[f]));return c},a.c0=_e,a.c1=KS,a.c2=lL,a.c3=aE,a.c4=ME,a.c5=Bt,a.c6=da,a.c7=Ai,a.c8=function(s,e,i){i*=.5;var c=e[0],f=e[1],g=e[2],y=e[3],b=Math.sin(i),E=Math.cos(i);return s[0]=c*E+f*b,s[1]=f*E-c*b,s[2]=g*E+y*b,s[3]=y*E-g*b,s},a.c9=ga,a.cA=st,a.cB=Oa,a.cC=pz,a.cD=Bc,a.cE=Mv,a.cF=function(s,e,i,c,f,g,y,b,E){if(E.name==="globe")return Mv(s,e,new Bc(i,c,f),!1);const M=u1({z:i,x:c,y:f},E);return new An([(g+M.x/M.scale)*e,e*(M.y/M.scale),y],[(g+M.x2/M.scale)*e,e*(M.y2/M.scale),b])},a.cG=function(s,e,i){return s[0]=Math.min(e[0],i[0]),s[1]=Math.min(e[1],i[1]),s[2]=Math.min(e[2],i[2]),s[3]=Math.min(e[3],i[3]),s},a.cH=function(s,e,i){return s[0]=Math.max(e[0],i[0]),s[1]=Math.max(e[1],i[1]),s[2]=Math.max(e[2],i[2]),s[3]=Math.max(e[3],i[3]),s},a.cI=function(s){const e=Math.round((s+45+360)%360/90)%4;return ie[e]},a.cJ=je,a.cK=ha,a.cL=6,a.cM=function(s){const e=K(new Float64Array(16));ue(e,s.pixelMatrix,s.globeMatrix);const i=[0,xe,0],c=[0,ye,0];return Tr(i,i,e),Tr(c,c,e),[i[0]>0&&i[0]<=s.width&&i[1]>0&&i[1]<=s.height&&!Vp(s,new Te(s.center.lat,90)),c[0]>0&&c[0]<=s.width&&c[1]>0&&c[1]<=s.height&&!Vp(s,new Te(s.center.lat,-90))]},a.cN=function(s,e){const{scale:i}=s.tileTransform,c=i*Gt/(s.tileSize*Math.pow(2,e.zoom-s.tileID.overscaledZ+s.tileID.canonical.z));return(function(f,g,y){var b=g[1],E=g[2],M=g[3],R=y[0],z=y[1];return f[0]=g[0]*R,f[1]=b*R,f[2]=E*z,f[3]=M*z,f})(new Float32Array(4),e.inverseAdjustmentMatrix,[c,c])},a.cO=Kw,a.cP=nt,a.cQ=fz,a.cR=function(s){const e=fz(s,!0);return L([],[e[0],e[1],e[4],e[5]])},a.cS=ge,a.cT=Ii,a.cU=se,a.cV=function(s){const{x:e,y:i}=s.point,{lng:c,lat:f}=s._center;return Ov(e,i,s.worldSize,c,f)},a.cW=Je,a.cX=Xe,a.cY=Tf,a.cZ=ec,a.c_=5,a.ca=Gn,a.cb=function(s,e){return s[0]=-e[0],s[1]=-e[1],s[2]=-e[2],s[3]=e[3],s},a.cc=Ke,a.cd=function(s,e,i,c,f){var g=1/Math.tan(e/2);if(s[0]=g/i,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=g,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,f!=null&&f!==1/0){var y=1/(c-f);s[10]=(f+c)*y,s[14]=2*f*c*y}else s[10]=-1,s[14]=-2*c;return s},a.ce=function(s,e,i,c,f,g,y){var b=1/(e-i),E=1/(c-f),M=1/(g-y);return s[0]=-2*b,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*E,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*M,s[11]=0,s[12]=(e+i)*b,s[13]=(f+c)*E,s[14]=(y+g)*M,s[15]=1,s},a.cf=We,a.cg=function(s,e,i){s[4*e+0]=i[0],s[4*e+1]=i[1],s[4*e+2]=i[2],s[4*e+3]=i[3]},a.ch=Ui,a.ci=wf,a.cj=aa,a.ck=ks,a.cl=gd,a.cm=wL,a.cn=function(){var s=new I(4);return I!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},a.co=function(s,e,i){var c=e[0],f=e[1],g=e[2],y=e[3],b=Math.sin(i),E=Math.cos(i);return s[0]=c*E+g*b,s[1]=f*E+y*b,s[2]=c*-b+g*E,s[3]=f*-b+y*E,s},a.cp=function(s,e){return s[0]===e[0]&&s[1]===e[1]&&s[2]===e[2]&&s[3]===e[3]},a.cq=Ut,a.cr=function(s){var e=s[0],i=s[1],c=s[2],f=s[3];return Math.sqrt(e*e+i*i+c*c+f*f)},a.cs=Cs,a.ct=zn,a.cu=Ev,a.cv=3,a.cw=2,a.cx=7,a.cy=6,a.cz=or,a.d=function(s){return ya.API_TILEJSON_REGEX.test(s)},a.d$=class{constructor(s,e,i,c){this.context=s,this.format=c,this.size=i,this.texture=s.gl.createTexture();const[f,g,y]=this.size,{gl:b}=s;b.bindTexture(b.TEXTURE_3D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in e&&e.data&&b.texImage3D(b.TEXTURE_3D,0,this.format,f,g,y,0,LS(this.format),BS(this.format),e.data)}bind(s,e){const{context:i}=this,{gl:c}=i;c.bindTexture(c.TEXTURE_3D,this.texture),s!==this.minFilter&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MAG_FILTER,s),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_MIN_FILTER,s),this.minFilter=s),e!==this.wrapS&&(c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_S,e),c.texParameteri(c.TEXTURE_3D,c.TEXTURE_WRAP_T,e),this.wrapS=e)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}},a.d0=function(s){return s*s*s*s*s},a.d1=Ve,a.d2=45,a.d3=Qi,a.d4=function(s,e,i){const c=Math.sqrt(s*s+e*e+i*i),f=c>0?Math.acos(i/c)*an:0;let g=s!==0||e!==0?Math.atan2(-e,-s)*an+90:0;return g<0&&(g+=360),[c,g,f]},a.d5=$e,a.d6=Xn,a.d7=zt,a.d8=Ct,a.d9=An,a.dA=function(s){return s({pluginStatus:ko,pluginURL:gu}),Qm.on("pluginStateChange",s),s},a.dB=ps,a.dC=class extends wl{constructor(s){super(s),this.current=Sx}set(s,e,i){if(this.fetchUniformLocation(s,e)){for(let c=0;c<9;c++)if(i[c]!==this.current[c]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}},a.dD=de,a.dE=function(s,e,i){const c=vd(i.zoom),f=s.style.map._antialias,g=s.terrain&&s.terrain.exaggeration()>0;return c===0&&!f&&!g},a.dF=function(s){const e=s.pixelsPerMeter,i=e/We(1,s.center.lat),c=K(new Float64Array(16));return me(c,c,[s.point.x,s.point.y,0]),ge(c,c,[i,i,e]),Float32Array.from(c)},a.dG=fg,a.dH=function(s){const e=80.051129;s=Ee(s,-80.051129,e)/e*90;const i=Math.pow(Math.abs(Math.sin(yr(s))),3);return Math.round(i*(be.length-1))},a.dI=function(s,e,i,c){const f=e.getNorth(),g=e.getSouth(),y=e.getWest(),b=e.getEast(),E=1<<s.z,M=b-y,R=f-g,z=M/le,B=-R/be[i],j=[0,z,0,B,0,0,f,y,0];if(s.z>0){const V=180/c;q(j,j,[V/M+1,0,0,0,V/R+1,0,-.5*V/z,.5*V/B,1])}return j[2]=E,j[5]=s.x,j[8]=s.y,j},a.dJ=wu,a.dK=function(s,e,i){const c=K(new Float64Array(16)),f=(e/(1<<s)-.5)*Math.PI*2;return fe(c,i.globeMatrix,f),Float32Array.from(c)},a.dL=Ew,a.dM=j_,a.dN=function(s,e){return[Math.pow(s[0],2.2)*e,Math.pow(s[1],2.2)*e,Math.pow(s[2],2.2)*e]},a.dO=k,a.dP=function(s,e){var i=Math.sin(e),c=Math.cos(e);return s[0]=c,s[1]=i,s[2]=0,s[3]=-i,s[4]=c,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},a.dQ=Ur,a.dR=q_,a.dS=ti,a.dT=ki,a.dU=pE,a.dV=function(s,e){const i=[0,0,0];return Tr(i,i,G_(wu(e.canonical))),Tr(i,i,s),i},a.dW=s=>({u_matrix:new gd(s),u_texsize:new ks(s),u_pixels_to_tile_units:new n(s),u_device_pixel_ratio:new aa(s),u_width_scale:new aa(s),u_floor_width_scale:new aa(s),u_image:new Ui(s),u_units_to_pixels:new ks(s),u_tile_units_to_pixels:new aa(s),u_alpha_discard_threshold:new aa(s),u_trim_offset:new ks(s),u_trim_fade_range:new ks(s),u_trim_gradient_mix_range:new ks(s),u_trim_color:new Qi(s),u_zbias_factor:new aa(s),u_tile_to_meter:new aa(s),u_ground_shadow_factor:new wf(s),u_pattern_transition:new aa(s)}),a.dX=s=>({u_matrix:new gd(s),u_pixels_to_tile_units:new n(s),u_device_pixel_ratio:new aa(s),u_width_scale:new aa(s),u_floor_width_scale:new aa(s),u_units_to_pixels:new ks(s),u_dash_image:new Ui(s),u_gradient_image:new Ui(s),u_image_height:new aa(s),u_texsize:new ks(s),u_tile_units_to_pixels:new aa(s),u_alpha_discard_threshold:new aa(s),u_trim_offset:new ks(s),u_trim_fade_range:new ks(s),u_trim_gradient_mix_range:new ks(s),u_trim_color:new Qi(s),u_zbias_factor:new aa(s),u_tile_to_meter:new aa(s),u_ground_shadow_factor:new wf(s)}),a.dY=s=>({u_camera_to_center_distance:new aa(s),u_extrude_scale:new n(s),u_device_pixel_ratio:new aa(s),u_matrix:new gd(s),u_inv_rot_matrix:new gd(s),u_merc_center:new ks(s),u_tile_id:new wf(s),u_zoom_transition:new aa(s),u_up_dir:new wf(s),u_emissive_strength:new aa(s)}),a.dZ=Bp,a.d_=R$,a.da=Kt,a.db=function(s){return[Math.pow(s[0],1/2.2),Math.pow(s[1],1/2.2),Math.pow(s[2],1/2.2)]},a.dc=dz,a.dd=GS,a.de=_z,a.df=gE,a.dg=function(s,e){return s.readFields(Pq,{icons:[]},e)},a.dh=Xw,a.di=Yv,a.dj=rE,a.dk=Yc,a.dl=A_,a.dm=_c,a.dn=yc,a.dp=Br,a.dq=function(s){const e=s.indexOf(df);return e>=0?s.slice(0,e):s},a.dr=function(s){return s.indexOf(df)>=0},a.ds=function(s){const e=s.lastIndexOf(df);return e>=0?s.slice(e+1):""},a.dt=function(s){const e=[],i=s.id;return i===void 0&&e.push({message:`layers.${i}: missing required property "id"`}),s.render===void 0&&e.push({message:`layers.${i}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},a.du=function(s,e,i,c){return s.type==="custom"?new Sq(s,e):new Iq[s.type](s,e,i,c)},a.dv=vr,a.dw=function(s){const e=s.indexOf(df);return e>=0?s.slice(e+1):""},a.dx=class extends fy{constructor(s,e){super(s._vectorTileFeature,s._z,s._x,s._y,s.id),s.state&&(this.state=Object.assign({},s.state)),this.target=e.target,this.namespace=e.namespace,e.properties&&(this.properties=e.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=s.source,this.sourceLayer=s.sourceLayer,this.layer=s.layer)}toJSON(){const s=super.toJSON();return s.target=this.target,s.namespace=this.namespace,s}},a.dy=Qm,a.dz=Xo,a.e=ya,a.e$=rt,a.e0=ww,a.e1=(s,e,i,c,f,g)=>{const y=s.transform,b=y.projection.name==="globe";let E;if(g.paint.get("circle-pitch-alignment")==="map")if(b){const R=q_(y.zoom,e.canonical)*y._pixelsPerMercatorPixel;E=Float32Array.from([R,0,0,R])}else E=y.calculatePixelsToTileUnitsMatrix(i);else E=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const M={u_camera_to_center_distance:s.transform.getCameraToCenterDistance(y.projection),u_matrix:s.translatePosMatrix(e.projMatrix,i,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Is.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:vS,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(b){M.u_inv_rot_matrix=c,M.u_merc_center=f,M.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],M.u_zoom_transition=vd(y.zoom);const R=f[0]*Gt,z=f[1]*Gt;M.u_up_dir=y.projection.upVector(new Bc(0,0,0),R,z)}return M},a.e2=Rz,a.e3=ls,a.e4=(s,e,i,c,f,g,y,b,E,M)=>{const R=s.transform,z=R.pitch<15?Iz(.07,.7,Ee((14-R.zoom)/5,0,1)):.07,B=i.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:Dz(s,e,i,c),u_texsize:e.imageAtlasTexture?e.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:R.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:f,u_width_scale:g,u_floor_width_scale:y,u_image:0,u_tile_units_to_pixels:Pz(e,R),u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b,u_trim_fade_range:i.paint.get("line-trim-fade-range"),u_trim_gradient_mix_range:[1,1],u_trim_color:i.paint.get("line-trim-color").toPremultipliedRenderColor(B?null:i.lut).toArray01(),u_zbias_factor:z,u_tile_to_meter:zt(e.tileID.canonical,0),u_ground_shadow_factor:E,u_pattern_transition:M}},a.e5=(s,e,i,c,f,g,y,b,E,M)=>{const R=s.transform,z=R.calculatePixelsToTileUnitsMatrix(e),B=i.paint.get("line-trim-color-use-theme").constantOr("default")==="none",j=R.pitch<15?Iz(.07,.7,Ee((14-R.zoom)/5,0,1)):.07;return{u_matrix:Dz(s,e,i,c),u_pixels_to_tile_units:z,u_device_pixel_ratio:g,u_width_scale:y,u_floor_width_scale:b,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:zz(i)&&e.lineAtlasTexture?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Pz(e,s.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:i.paint.get("line-trim-fade-range"),u_trim_gradient_mix_range:[1,1],u_trim_color:i.paint.get("line-trim-color").toPremultipliedRenderColor(B?null:i.lut).toArray01(),u_zbias_factor:j,u_tile_to_meter:zt(e.tileID.canonical,0),u_ground_shadow_factor:M}},a.e6=vt,a.e7=pg,a.e8=et,a.e9=Sf,a.eA=function(s,e){var i=2*Math.acos(e[3]),c=Math.sin(i/2);return c>C?(s[0]=e[0]/c,s[1]=e[1]/c,s[2]=e[2]/c):(s[0]=1,s[1]=0,s[2]=0),i},a.eB=vE,a.eC=e2,a.eD=Jw,a.eE=[1,1,1],a.eF=e0,a.eG=Yn,a.eH=function(s,e,i,c){var f=e[0],g=e[1],y=e[2],b=e[3];return s[0]=f+c*(i[0]-f),s[1]=g+c*(i[1]-g),s[2]=y+c*(i[2]-y),s[3]=b+c*(i[3]-b),s},a.eI=Hv,a.eJ=rl,a.eK=dh,a.eL=function(s,e,i,c,f,g,y,b,E,M,R,z,B,j,V,Y){var re=new I(16);return re[0]=s,re[1]=e,re[2]=i,re[3]=c,re[4]=f,re[5]=g,re[6]=y,re[7]=b,re[8]=E,re[9]=M,re[10]=R,re[11]=z,re[12]=B,re[13]=j,re[14]=V,re[15]=Y,re},a.eM=De,a.eN=fd,a.eO=_f,a.eP=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new yt(1/0,1/0),max:new yt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(s,e=!1){const i=_(new yt(0,0),new yt(Gt,Gt),s),c=[];if(e&&!Ag(i,this._globalClipBounds))return c;for(const f of this._activeRegions){if(f.hiddenByOverlap||!Ag(i,f))continue;const g=T(f.min,f.max,s);c.push({min:g.min,max:g.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return c}setSources(s){this._setSources(s.map(e=>({getSourceId:()=>e.cache.id,getFootprints:()=>{const i=[];for(const c of e.cache.getVisibleCoordinates()){const f=e.cache.getTile(c).buckets[e.layer];f&&f.updateFootprints(c.toUnwrapped(),i)}return i},getOrder:()=>e.order,getClipMask:()=>e.clipMask,getClipScope:()=>e.clipScope})))}_addSource(s){const e=s.getFootprints();if(e.length===0)return;const i=s.getOrder(),c=s.getClipMask(),f=s.getClipScope();for(const g of e){if(!g.footprint)continue;const y=_(g.footprint.min,g.footprint.max,g.id);this._activeRegions.push({min:y.min,max:y.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:g.id,footprint:g.footprint,order:i,clipMask:c,clipScope:f})}this._sourceIds.push(s.getSourceId())}_computeReplacement(){this._activeRegions.sort((e,i)=>e.priority-i.priority||ay(e.min,i.min)||ay(e.max,i.max)||e.order-i.order||e.clipMask-i.clipMask||(function(c,f){const g=(y,b)=>y+b;return c.length-f.length||c.reduce(g,"").localeCompare(f.reduce(g,""))})(e.clipScope,i.clipScope));let s=this._activeRegions.length!==this._prevRegions.length;if(!s){let e=0;for(;!s&&e!==this._activeRegions.length;){const i=this._activeRegions[e],c=this._prevRegions[e];s=i.priority!==c.priority||!$w(i,c)||i.order!==c.order||i.clipMask!==c.clipMask||!Or(i.clipScope,c.clipScope),this._activeRegions[e].hiddenByOverlap=c.hiddenByOverlap,++e}}if(s){++this._updateTime;for(const i of this._activeRegions)i.order!==wg&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,i.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,i.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,i.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,i.max.y));const e=i=>{const c=this._activeRegions;if(i>=c.length)return i;const f=c[i].priority;for(;i<c.length&&c[i].priority===f;)++i;return i};if(this._sourceIds.length>1){let i=0,c=e(i);for(;i!==c;){let f=i;const g=i;for(;f!==c;){const y=this._activeRegions[f];y.hiddenByOverlap=!1;for(let b=0;b<g;b++){const E=this._activeRegions[b];if(!E.hiddenByOverlap&&y.order===wg&&Ag(y,E)&&(y.hiddenByOverlap=U(y.footprint,y.tileId,E.footprint,E.tileId),y.hiddenByOverlap))break}++f}i=c,c=e(i)}}}}_setSources(s){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let e=s.length-1;e>=0;e--)this._addSource(s[e]);this._computeReplacement()}},a.eQ=wg,a.eR=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy()}_fillGridMeshWithLods(s,e){const i=new _u,c=new pa,f=[],g=s+1+2,y=e[0]+1,b=e[0]+1+(1+e.length),E=(M,R,z)=>{let B=M===g-1?M-2:M===0?M:M-1;return B+=z?24575:0,[B,R]};for(let M=0;M<g;++M)i.emplaceBack(...E(M,0,!0));for(let M=0;M<y;++M)for(let R=0;R<g;++R)i.emplaceBack(...E(R,M,(R===0||R===g-1)&&!0));for(let M=0;M<e.length;++M){const R=e[M];for(let z=0;z<g;++z)i.emplaceBack(...E(z,R,!0))}for(let M=0;M<e.length;++M){const R=c.length,z=e[M]+1+2,B=new pa;for(let Y=0;Y<z-1;Y++){const re=Y===z-2,J=re?g*(b-e.length+M-Y):g;for(let oe=0;oe<g-1;oe++){const ce=Y*g+oe;Y===0||re||oe===0||oe===g-2?(B.emplaceBack(ce+1,ce,ce+J),B.emplaceBack(ce+J,ce+J+1,ce+1)):(c.emplaceBack(ce+1,ce,ce+J),c.emplaceBack(ce+J,ce+J+1,ce+1))}}const j=ui.simpleSegment(0,R,i.length,c.length-R);for(let Y=0;Y<B.uint16.length;Y+=3)c.emplaceBack(B.uint16[Y],B.uint16[Y+1],B.uint16[Y+2]);const V=ui.simpleSegment(0,R,i.length,c.length-R);f.push({withoutSkirts:j,withSkirts:V})}return{vertices:i,indices:c,segments:f}}_createGrid(s){const e=this._fillGridMeshWithLods(le,be);this._gridSegments=e.segments,this._gridBuffer=s.createVertexBuffer(e.vertices,Mx.members),this._gridIndexBuffer=s.createIndexBuffer(e.indices,!0)}_createPoles(s){const e=new pa;for(let y=0;y<=le;y++)e.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=s.createIndexBuffer(e,!0);const i=new hh,c=new hh,f=new hh,g=new hh;this._poleSegments=[];for(let y=0,b=0;y<5;y++){const E=360/(1<<y);i.emplaceBack(0,-ae,0,.5,0),c.emplaceBack(0,-ae,0,.5,1),f.emplaceBack(0,-ae,0,.5,.5),g.emplaceBack(0,-ae,0,.5,.5);for(let M=0;M<=le;M++){let R=M/le,z=0;const B=Dr(0,E,R),[j,V,Y]=Re(yS,bw,B,ae);i.emplaceBack(j,V,Y,R,z),c.emplaceBack(j,V,Y,R,1-z);const re=yr(B);R=.5+.5*Math.sin(re),z=.5+.5*Math.cos(re),f.emplaceBack(j,V,Y,R,z),g.emplaceBack(j,V,Y,R,1-z)}this._poleSegments.push(ui.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(i,Ef,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(c,Ef,!1),this._texturedPoleNorthVertexBuffer=s.createVertexBuffer(f,Ef,!1),this._texturedPoleSouthVertexBuffer=s.createVertexBuffer(g,Ef,!1)}getGridBuffers(s,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s,e){return[e?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,e?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}},a.eS=Yx,a.eT=Ae,a.eU=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.eV=ze,a.eW=bt,a.eX=function(s,e,i){return s[0]=e[0]/i[0],s[1]=e[1]/i[1],s[2]=e[2]/i[2],s},a.eY=ua,a.eZ=Ce,a.e_=Zr,a.ea=Au,a.eb=FR,a.ec=cn,a.ed=450,a.ee=7,a.ef=ot,a.eg=function(s,e){if(s===e){var i=e[1],c=e[2],f=e[3],g=e[6],y=e[7],b=e[11];s[1]=e[4],s[2]=e[8],s[3]=e[12],s[4]=i,s[6]=e[9],s[7]=e[13],s[8]=c,s[9]=g,s[11]=e[14],s[12]=f,s[13]=y,s[14]=b}else s[0]=e[0],s[1]=e[4],s[2]=e[8],s[3]=e[12],s[4]=e[1],s[5]=e[5],s[6]=e[9],s[7]=e[13],s[8]=e[2],s[9]=e[6],s[10]=e[10],s[11]=e[14],s[12]=e[3],s[13]=e[7],s[14]=e[11],s[15]=e[15];return s},a.eh=Tq,a.ei=en,a.ej=D_,a.ek=256,a.el=si,a.em=tl,a.en=fe,a.eo=function(s,e){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[4],s[4]=e[5],s[5]=e[6],s[6]=e[8],s[7]=e[9],s[8]=e[10],s},a.ep=hh,a.eq=m_,a.er=gf,a.es=function(s,e,i,c,f){return Ee((s-e)/(i-e)*(f-c)+c,c,f)},a.et=Ha,a.eu=function(s,e){var i=e[0],c=e[1],f=e[2],g=e[3],y=e[4],b=e[5],E=e[6],M=e[7],R=e[8],z=R*y-b*M,B=-R*g+b*E,j=M*g-y*E,V=i*z+c*B+f*j;return V?(s[0]=z*(V=1/V),s[1]=(-R*c+f*M)*V,s[2]=(b*c-f*y)*V,s[3]=B*V,s[4]=(R*i-f*E)*V,s[5]=(-b*i+f*g)*V,s[6]=j*V,s[7]=(-M*i+c*E)*V,s[8]=(y*i-c*g)*V,s):null},a.ev=2,a.ew=fn,a.ex=no,a.ey=tt,a.ez=function(s,e){var i=new I(3);tt(i,e);var c=1/i[0],f=1/i[1],g=1/i[2],y=e[0]*c,b=e[1]*f,E=e[2]*g,M=e[4]*c,R=e[5]*f,z=e[6]*g,B=e[8]*c,j=e[9]*f,V=e[10]*g,Y=y+R+V,re=0;return Y>0?(re=2*Math.sqrt(Y+1),s[3]=.25*re,s[0]=(z-j)/re,s[1]=(B-E)/re,s[2]=(b-M)/re):y>R&&y>V?(re=2*Math.sqrt(1+y-R-V),s[3]=(z-j)/re,s[0]=.25*re,s[1]=(b+M)/re,s[2]=(B+E)/re):R>V?(re=2*Math.sqrt(1+R-y-V),s[3]=(B-E)/re,s[0]=(b+M)/re,s[1]=.25*re,s[2]=(z+j)/re):(re=2*Math.sqrt(1+V-y-R),s[3]=(b-M)/re,s[0]=(B+E)/re,s[1]=(z+j)/re,s[2]=.25*re),s},a.f=function(s){return btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,(e,i)=>String.fromCharCode(+("0x"+i))))},a.f0=function([s,e,i]){const c=Math.hypot(s,e,i),f=Math.atan2(s,i),g=.5*Math.PI-Math.acos(-e/c);return new Te(Xe(f),Xe(g))},a.f1=go,a.f2=FS,a.f3=function(s){const e=s.navigator?s.navigator.userAgent:null;return!!(function(i){if(on==null){const c=i.navigator?i.navigator.userAgent:null;on=!!i.safari||!(!c||!(/\b(iPad|iPhone|iPod)\b/.test(c)||c.match("Safari")&&!c.match("Chrome")))}return on})(s)&&!(!e||!(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},a.f4=function(s,e){t_=s,Am=e},a.f5=Vp,a.f6=Cv,a.f7=function(s){const e=[0,0,0],i=K(new Float64Array(16));return ue(i,s.pixelMatrix,s.globeMatrix),Tr(e,e,i),new yt(e[0],e[1])},a.f8=function(){const s=Jx;s&&(s.isPreloaded()&&s.numActive()===1?(s.release(CS),Jx=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.f9=function(){Xw().acquire(CS)},a.fA=S2,a.fB=tn,a.fC=function(s){let e=0;if(new Uint32Array(s,0,1)[0]!==sz){const i=new Uint32Array(s,0,7),[,,c,f,g,y]=i;e=i.byteLength+f+g+y+g,(c!==s.byteLength||e>=s.byteLength)&&br("Invalid b3dm header information.")}return hz(s,e)},a.fD=function(s,e){const i=GS(s);for(const c of i){for(const f of c.meshes)t$(f);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(r$(c.lights,e)))}return i},a.fE=x2,a.fF=Zn,a.fG=YR,a.fH=zs,a.fI=Qo,a.fJ=function(s){ka(),Za?.then(e=>{e.keys().then(i=>{for(let c=0;c<i.length-s;c++)e.delete(i[c]).catch(f=>br(f.message))}).catch(i=>br(i.message))}).catch(e=>br(e.message))},a.fa=sh,a.fb=function(s,e,i=!1){if(ko===Qo.deferred||ko===Qo.loading||ko===Qo.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");gu=Is.resolveURL(s),ko=Qo.deferred,mu=e,T_(),i||Jm()},a.fc=function(s){Gv=Is.resolveURL(s),$v||($v=new Vv(Xw(),new Qc)),$v.broadcast("setMeshoptUrl",Gv)},a.fd=JR,a.fe=function(s){DS=Is.resolveURL(s),$v||($v=new Vv(Xw(),new Qc)),$v.broadcast("setDracoUrl",DS)},a.ff=QR,a.fg=Qx,a.fh=function(s){const e=dl();if(!e)return;const i=e.delete(ov);s&&i.then(()=>s()).catch(s)},a.fi=sy,a.fj=jt,a.fk=mh,a.fl=2,a.fm=EB,a.fn=MB,a.fo=Ez,a.fp=ln,a.fq="hd_road_elevation",a.fr=so,a.fs=dr,a.ft=gh,a.fu=tE,a.fv=1,a.fw=function(s,e,i,c,f,g,y,b=1,E,M,R,z){s.createArrays(),s.tilePixelRatio=Gt/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const B=s.layers[0].layout,j=s.layers[0]._unevaluatedLayout._values,V={};V.scaleFactor=b,V.textSizeScaleRange=B.get("text-size-scale-range"),V.iconSizeScaleRange=B.get("icon-size-scale-range");const[Y,re]=V.textSizeScaleRange,[J,oe]=V.iconSizeScaleRange;V.textScaleFactor=Ee(V.scaleFactor,Y,re),V.iconScaleFactor=Ee(V.scaleFactor,J,oe);const ce=j["text-size"],pe=j["icon-size"];if(s.textSizeData.kind==="composite"){const{minZoom:ke,maxZoom:Ge}=s.textSizeData;V.compositeTextSizes=[ce.possiblyEvaluate(new In(ke,{worldview:R}),g),ce.possiblyEvaluate(new In(Ge,{worldview:R}),g)]}if(s.iconSizeData.kind==="composite"){const{minZoom:ke,maxZoom:Ge}=s.iconSizeData;V.compositeIconSizes=[pe.possiblyEvaluate(new In(ke,{worldview:R}),g,z),pe.possiblyEvaluate(new In(Ge,{worldview:R}),g,z)]}V.layoutTextSize=ce.possiblyEvaluate(new In(y+1,{worldview:R}),g),V.layoutIconSize=pe.possiblyEvaluate(new In(y+1,{worldview:R}),g,z),V.textMaxSize=ce.possiblyEvaluate(new In(18,{worldview:R}),g);const Se=B.get("symbol-placement"),we=B.get("text-rotation-alignment")==="map"&&Se!=="point",Ie=B.get("text-size");let Pe=!1;const Oe=[];for(const ke of s.features){const Ge=B.get("text-font").evaluate(ke,{},g).join(","),pt=Ie.evaluate(ke,{},g)*V.textScaleFactor,ct=V.layoutTextSize.evaluate(ke,{},g)*V.textScaleFactor,dt=V.layoutIconSize.evaluate(ke,{},g,z)*V.iconScaleFactor,St={horizontal:{},vertical:void 0},At=ke.text;let Tt,lt=[0,0];if(At){const gn=At.toString(),ta=B.get("text-letter-spacing").evaluate(ke,{},g)*co,vn=B.get("text-line-height").evaluate(ke,{},g)*co,Un=xv(gn)?ta:0,bi=B.get("text-anchor").evaluate(ke,{},g),Di=B.get("text-variable-anchor");if(!Di){const Ca=B.get("text-radial-offset").evaluate(ke,{},g);if(Ca)lt=lL(bi,[Ca*co,iE]);else{const Va=B.get("text-offset").evaluate(ke,{},g);lt=[Va[0]*co,Va[1]*co]}}let Ri=we?"center":B.get("text-justify").evaluate(ke,{},g);const ra=Se==="point",To=ra?B.get("text-max-width").evaluate(ke,{},g)*co:1/0,es=Ca=>{s.allowVerticalPlacement&&Km(gn)&&(St.vertical=YS(At,e,i,f,Ge,To,vn,bi,Ca,Un,lt,nc.vertical,!0,ct,pt,E))};if(!we&&Di){const Ca=Ri==="auto"?Di.map(eo=>aE(eo)):[Ri];let Va=!1;for(let eo=0;eo<Ca.length;eo++){const Xr=Ca[eo];if(!St.horizontal[Xr])if(Va)St.horizontal[Xr]=St.horizontal[0];else{const zi=YS(At,e,i,f,Ge,To,vn,"center",Xr,Un,lt,nc.horizontal,!1,ct,pt,E);zi&&(St.horizontal[Xr]=zi,Va=zi.positionedLines.length===1)}}es("left")}else{if(Ri==="auto"&&(Ri=aE(bi)),ra||B.get("text-writing-mode").indexOf("horizontal")>=0||!Km(gn)){const Ca=YS(At,e,i,f,Ge,To,vn,bi,Ri,Un,lt,nc.horizontal,!1,ct,pt,E);Ca&&(St.horizontal[Ri]=Ca)}es(ra?"left":Ri)}}let Ot,xt,It,Et,rr,nr,Ht=!1;const Yt=B.get("icon-text-fit").evaluate(ke,{},g);if(ke.icon&&ke.icon.hasPrimary()){const gn=c1(ke.icon,s.iconSizeData,j["icon-size"],g,s.zoom,ke,E,V.iconScaleFactor,R,z);Ot=gn.iconPrimary,It=gn.iconSecondary;const ta=Ot.toString();if(xt=c.get(ta),xt&&(rr=B.get("icon-offset").evaluate(ke,{},g),nr=B.get("icon-anchor").evaluate(ke,{},g),Tt=a2(f.get(ta),It?f.get(It.toString()):void 0,rr,nr),Ht=xt.sdf,s.sdfIcons===void 0?s.sdfIcons=xt.sdf:s.sdfIcons!==xt.sdf&&br("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(xt.pixelRatio!==s.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0)),It){const vn=It.toString();Et=c.get(vn)}}Pe=Pe||!(!ke.icon||!ke.icon.hasSecondary());const wr=u2(St.horizontal)||St.vertical;s.iconsInText||(s.iconsInText=!!wr&&wr.iconsInText);const gr=ct*V.textScaleFactor/co,{defaultShapedIcon:tr,verticallyShapedIcon:Fr}=uq(s,Tt,B,ke,g,St,gr,rr,Yt);Yt!=="none"&&Tt&&(Hz(Tt)||Xz(Tt))&&(c2(0,xt,Ot,Tt,tr,Yt,M,c,f),c2(0,Et,It,Tt,tr,Yt,M,c,f),Fr&&(c2(0,xt,Ot,Tt,Fr,Yt,M,c,f),c2(0,Et,It,Tt,Fr,Yt,M,c,f))),Tt=tr;const{iconBBox:nn,iconVerticalBBox:On,textBBox:Yr,textVerticalBBox:Hn}=aq(s,Tt,Fr,B,ke,g,dt,rr,V,f,nr,St,ct,lt,z);Oe.push({feature:ke,shapedTextOrientations:St,shapedText:wr,shapedIcon:Tt,iconPrimary:Ot,iconSecondary:It,iconOffset:rr,iconAnchor:nr,verticallyShapedIcon:Fr,layoutTextSize:ct,layoutIconSize:dt,textOffset:lt,isSDFIcon:Ht,iconTextFit:Yt,iconCollisionBounds:nn,iconVerticalCollisionBounds:On,textCollisionBounds:Yr,textVerticalCollisionBounds:Hn})}return{featureData:Oe,sizes:V,hasAnySecondaryIcon:Pe,textAlongLine:we,symbolPlacement:Se}},a.fx=tL,a.fy=function(s,e,i,c,f,g,y,b,E,M){s.iconAtlasPositions=M.iconPositions;const{featureData:R,hasAnySecondaryIcon:z,sizes:B,textAlongLine:j,symbolPlacement:V}=e;for(const Y of R){const{shapedIcon:re,verticallyShapedIcon:J,feature:oe,shapedTextOrientations:ce,shapedText:pe,layoutTextSize:Se,textOffset:we,isSDFIcon:Ie,iconPrimary:Pe,iconSecondary:Oe,iconTextFit:ke,iconOffset:Ge,iconCollisionBounds:pt,iconVerticalCollisionBounds:ct,textCollisionBounds:dt}=Y;dL(re,M.iconPositions,Pe,Oe),dL(J,M.iconPositions,Pe,Oe),cq(ce,M.iconPositions),lq(Pe,Oe,M.iconPositions),(pe||re)&&hq(s,oe,ce,re,J,E,B,Se,0,we,Ie,c,f,y,b,z,ke,Ge,j,V,pt,ct,dt)}i&&s.generateCollisionDebugBuffers(g,s.collisionBoxArray,B.textScaleFactor)},a.fz=hn,a.g=function(s,e){return Xo(Object.assign(s,{method:"GET"}),e)},a.h=function(s){return s.indexOf("mapbox:")===0},a.i=function(s){return ya.API_STYLE_REGEX.test(s)&&!yo(s)},a.j=gc,a.k=Gu,a.l=function(s){return decodeURIComponent(atob(s).split("").map(e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.m=function(s,e){return Xo(Object.assign(s,{type:"json"}),e)},a.n=Qf,a.o=Is,a.p=function(s,e){return Xo(Object.assign(s,{method:"POST"}),e)},a.q=Ja,a.r=hl,a.s=function(s){try{const e=self[s];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=function(){return IS||(IS=new sy("ImageRasterizer")),IS},a.u=function(){return(function s(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)})()},a.v=function(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)},a.w=br,a.x=AE,a.y=Fd,a.z=gl}),v(["./shared"],function(a){function C(Xe){const ie=Xe?Xe.url.toString():void 0;return ie?performance.getEntriesByName(ie):[]}function I(Xe){if(typeof Xe=="number"||typeof Xe=="boolean"||typeof Xe=="string"||Xe==null)return JSON.stringify(Xe);if(Array.isArray(Xe)){let de="[";for(const Ae of Xe)de+=`${I(Ae)},`;return`${de}]`}let ie="{";for(const de of Object.keys(Xe).sort())ie+=`${de}:${I(Xe[de])},`;return`${ie}}`}function L(Xe){let ie="";for(const de of a.bx)ie+=`/${I(Xe[de])}`;return ie}function k(Xe,ie){return(function de(Ae){return typeof Ae=="string"&&Ae===ie||(Array.isArray(Ae)?Ae.some(de):!(!Ae||typeof Ae!="object")&&Object.values(Ae).some(de))})(Xe)}class G{constructor(ie){this.keyCache={},this._layers={},this._layerConfigs={},ie&&this.replace(ie)}replace(ie,de){this._layerConfigs={},this._layers={},this.update(ie,[],de)}update(ie,de,Ae){this._options=Ae;for(const Ee of ie)this._layerConfigs[Ee.id]=Ee,(this._layers[Ee.id]=a.du(Ee,this.scope,null,this._options)).compileFilter(Ae),this.keyCache[Ee.id]&&delete this.keyCache[Ee.id];for(const Ee of de)delete this.keyCache[Ee],delete this._layerConfigs[Ee],delete this._layers[Ee];this.familiesBySource={};const ze=(function(Ee,Fe){const it={};for(let at=0;at<Ee.length;at++){const Dt=Ee[at];let vt=Fe&&Fe[Dt.id];vt||(Dt.type==="symbol"?vt=Dt.id:(vt=L(Dt),Dt.type==="line"&&Dt.paint&&k(Dt.paint["line-width"],"line-progress")&&(vt+=`/${I(Dt.paint["line-width"])}`))),Fe&&(Fe[Dt.id]=vt);let Wt=it[vt];Wt||(Wt=it[vt]=[]),Wt.push(Dt)}const qe=[];for(const at in it)qe.push(it[at]);return qe})(Object.values(this._layerConfigs),this.keyCache);for(const Ee of ze){const Fe=Ee.map(Wt=>this._layers[Wt.id]),it=Fe[0];if(it.visibility==="none")continue;const qe=it.source||"";let at=this.familiesBySource[qe];at||(at=this.familiesBySource[qe]={});const Dt=it.sourceLayer||"_geojsonTileLayer";let vt=at[Dt];vt||(vt=at[Dt]=[]),vt.push(Fe)}}}const q=1*a.fl;class Q{constructor(ie){const de={},Ae=[];for(const it in ie){const qe=ie[it],at=de[it]={};for(const Dt in qe.glyphs){const vt=qe.glyphs[+Dt];if(!vt||vt.bitmap.width===0||vt.bitmap.height===0)continue;const Wt=vt.metrics.localGlyph?q:1,dr={x:0,y:0,w:vt.bitmap.width+2*Wt,h:vt.bitmap.height+2*Wt};Ae.push(dr),at[Dt]=dr}}const{w:ze,h:Ee}=a.G(Ae),Fe=new a.fk({width:ze||1,height:Ee||1});for(const it in ie){const qe=ie[it];for(const at in qe.glyphs){const Dt=qe.glyphs[+at];if(!Dt||Dt.bitmap.width===0||Dt.bitmap.height===0)continue;const vt=de[it][at],Wt=Dt.metrics.localGlyph?q:1;a.fk.copy(Dt.bitmap,Fe,{x:0,y:0},{x:vt.x+Wt,y:vt.y+Wt},Dt.bitmap)}}this.image=Fe,this.positions=de}}function H(Xe,ie,de){Xe[ie]?de&&(Xe[ie].center=de):Xe[ie]={floorIds:new Set,center:de||[0,0],floors:{}}}function K(Xe,ie,de,Ae){for(const ze of ie)H(Xe,ze),Xe[ze].floors[de]=Ae,Xe[ze].floorIds.add(de)}function he(Xe){return{id:Xe.properties.id.toString(),center:Xe.properties.center.toString().split(";").map(Number)}}function ue(Xe){return{id:Xe.properties.id.toString(),isDefault:!!Xe.properties.is_default&&Xe.properties.is_default,connections:Xe.properties.connected_floor_ids?new Set(Xe.properties.connected_floor_ids.toString().split(";")):new Set,conflicts:Xe.properties.conflicted_floor_ids?new Set(Xe.properties.conflicted_floor_ids.toString().split(";")):new Set,buildings:Xe.properties.building_ids?new Set(Xe.properties.building_ids.toString().split(";")):new Set,name:Xe.properties.name.toString(),zIndex:Xe.properties.z_index}}function me(Xe,ie){return ie.every(de=>Xe.properties&&Xe.properties[de]!=null)}function ge(Xe){return me(Xe,["type","id","name"])&&Xe.properties.type==="building"}function se(Xe){return me(Xe,["type","id","name","z_index"])&&Xe.properties.type==="floor"}a.fj(Q,"GlyphAtlas");class fe{constructor(ie){this.tileID=new a.aQ(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.lut=ie.lut,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.scope=ie.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.request&&ie.request.collectResourceTiming,this.promoteId=ie.promoteId,this.isSymbolTile=ie.isSymbolTile,this.tileTransform=a.aZ(ie.tileID.canonical,ie.projection),this.projection=ie.projection,this.worldview=ie.worldview,this.localizableLayerIds=ie.localizableLayerIds,this.brightness=ie.brightness,this.extraShadowCaster=!!ie.extraShadowCaster,this.tessellationStep=ie.tessellationStep,this.scaleFactor=ie.scaleFactor,this.worldview=ie.worldview,this.indoor=ie.indoor}parse(ie,de,Ae,ze,Ee,Fe){this.status="parsing",this.data=ie,this.collisionBoxArray=new a.b3;const it=new a.fm(Object.keys(ie.layers).sort()),qe=new a.fn(this.tileID,this.promoteId);qe.bucketLayerIDs=[];const at={},Dt=new a.fo(256,256),vt={featureIndex:qe,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Dt,availableImages:Ae,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0,activeFloors:void 0};if(this.indoor){const Br=this.indoor.indoorState.activeFloorsVisible,Sr=(function(fr,br,Vn){const yi=(function(qn,on){if(!qn)return a.w("No source layers defined in indoor specification"),on;if(qn.size===0)return on;const Gn=qn.difference(on);for(const Nn of Gn)a.w(`Missing source layer required in indoor specification: ${Nn}`);return on.intersection(on)})(br.sourceLayers,new Set(Object.keys(fr.layers))),Xn=br.indoorState,Zn=(function(qn,on,Gn,Nn){const jn=new Set,ti=new Set,ki=new Set,Ba=new Map,ya={},gc=yo=>{const Io=Ba.get(yo)||new Set;for(const ul of jn)if((Ba.get(ul)||new Set).has(yo)||Io.has(ul))return!0;return!1};for(const yo of on){const Io=qn.layers[yo];if(Io)for(let ul=0;ul<Io.length;ul++){const Sa=Io.feature(ul);if(ge(Sa)){const{id:Ho,center:Po}=he(Sa);H(ya,Ho,Po),jn.add(Ho);continue}if(se(Sa)){const{id:Ho,isDefault:Po,connections:zl,conflicts:hl,buildings:Is,name:zd,zIndex:_c}=ue(Sa);K(ya,Is,Ho,{name:zd,zIndex:_c}),Ba.set(Ho,hl),(Ho===Nn||zl.has(Nn))&&jn.add(Ho),ti.add(Ho),Po&&ki.add(Ho)}}else a.w(`indoor source layer not found: ${yo}`)}if(Gn)for(const yo of Gn)ti.has(yo)&&(gc(yo)||jn.add(yo));for(const yo of ki)jn.has(yo)||gc(yo)||jn.add(yo);return{buildings:ya,activeFloors:jn}})(fr,yi,Xn.lastActiveFloors,Xn.selectedFloorId);return Vn.send("setIndoorData",Zn),Zn})(ie,this.indoor,Ee);vt.activeFloors=Br?Sr.activeFloors:void 0}const Wt=[],dr=de.familiesBySource[this.source];for(const Br in dr){const Sr=ie.layers[Br];if(!Sr)continue;let fr=!1,br=!1,Vn=!1;for(const on of dr[Br])on[0].type==="symbol"?fr=!0:br=!0,on[0].is3D()&&on[0].type!=="model"&&(Vn=!0);if(this.extraShadowCaster&&!Vn||this.isSymbolTile===!0&&!fr||this.isSymbolTile===!1&&!br)continue;Sr.version===1&&a.w(`Vector tile source "${this.source}" layer "${Br}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yi=it.encode(Br),Xn=[],Zn=this.localizableLayerIds&&this.localizableLayerIds.has(Br);let qn=!1;for(let on=0,Gn=0;on<Sr.length;on++){const Nn=Sr.feature(on),jn=qe.getId(Nn,Br),ti=Nn.properties?Nn.properties.worldview:null;if(Zn&&this.worldview&&typeof ti=="string")if(ti==="all")Nn.properties.$localized=!0;else{if(!ti.split(",").includes(this.worldview))continue;Nn.properties.$localized=!0,Nn.properties.worldview=this.worldview}!qn&&Nn.properties&&Nn.properties.hasOwnProperty(a.fp)&&(qn=!0),Xn.push({feature:Nn,id:jn,index:Gn,sourceLayerIndex:yi}),Gn++}qn&&!vt.elevationFeatures&&ie.layers.hasOwnProperty(a.fq)&&(vt.elevationFeatures=a.fr.parseFrom(ie.layers[a.fq],this.canonical));for(const on of dr[Br]){const Gn=on[0];if(this.extraShadowCaster&&(!Gn.is3D()||Gn.type==="model")||this.isSymbolTile!==void 0&&Gn.type==="symbol"!==this.isSymbolTile||Gn.minzoom&&this.zoom<Math.floor(Gn.minzoom)||Gn.maxzoom&&this.zoom>=Gn.maxzoom||Gn.visibility==="none")continue;ve(on,this.zoom,vt.brightness,Ae,this.worldview);const Nn=at[Gn.id]=Gn.createBucket({index:qe.bucketLayerIDs.length,layers:on,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:ze,worldview:this.worldview,localizable:Zn,availableImages:Ae});qe.bucketLayerIDs.push(on.map(ti=>a.B(ti.id,ti.scope)));let jn=Nn.prepare?Nn.prepare():null;jn!=null?(jn=jn.then(()=>Nn.populate(Xn,vt,this.tileID.canonical,this.tileTransform)),Wt.push(jn)):Nn.populate(Xn,vt,this.tileID.canonical,this.tileTransform)}}const vr=()=>{let Br,Sr,fr,br,Vn,yi;Dt.trim();const Xn={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Zn=()=>{if(Br)return this.status="done",Fe(Br);if(this.extraShadowCaster)this.status="done",Fe(null,{buckets:Object.values(at).filter(on=>!on.isEmpty()),featureIndex:qe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:vt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Sr&&fr&&br){const on=new Q(Sr),Gn=new Map;for(const[ti,ki]of fr.entries()){const{imagePosition:Ba}=a.fu(ti,ki,a.fv);Gn.set(ti,Ba)}const Nn={};for(const ti in at){const ki=at[ti];ki instanceof a.b4&&(ve(ki.layers,this.zoom,vt.brightness,Ae,this.worldview),Nn[ti]=a.fw(ki,Sr,on.positions,fr,Gn,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Vn,this.worldview,Ae))}const jn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(Ee,fr,Vn,()=>{jn.iconsPending=!1,qn(Nn,on,jn)}),this.rasterizeIfNeeded(Ee,br,yi,()=>{jn.patternsPending=!1,qn(Nn,on,jn)})}},qn=(on,Gn,Nn,jn)=>{if(Nn.iconsPending||Nn.patternsPending)return;const ti=new a.fx(fr,br,this.lut);for(const ki in at){const Ba=at[ki];if(ki in on)a.fy(Ba,on[ki],this.showCollisionBoxes,Ae,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,fr,ti);else if(Ba.hasPattern&&(Ba instanceof a.ba||Ba instanceof a.bb||Ba instanceof a.ea)){ve(Ba.layers,this.zoom,vt.brightness,Ae,this.worldview);const ya=Object.fromEntries(ti.patternPositions);Ba.addFeatures(vt,this.tileID.canonical,ya,Ae,this.tileTransform,this.brightness)}}this.status="done",Fe(null,{buckets:Object.values(at).filter(ki=>!ki.isEmpty()),featureIndex:qe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gn.image,lineAtlas:Dt,imageAtlas:ti,brightness:vt.brightness})};if(!this.extraShadowCaster){const on=a.fs(vt.glyphDependencies,jn=>Object.keys(jn).map(Number));Object.keys(on).length?Ee.send("getGlyphs",{uid:this.uid,stacks:on},(jn,ti)=>{Br||(Br=jn,Sr=ti,Zn())},void 0,!1,Xn):Sr={};const Gn=Array.from(vt.iconDependencies.keys()).map(jn=>a.I.parse(jn));Gn.length?Ee.send("getImages",{images:Gn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(jn,ti)=>{Br||(Br=jn,fr=new Map,Vn=this.updateImageMapAndGetImageTaskQueue(fr,ti,vt.iconDependencies),Zn())},void 0,!1,Xn):(fr=new Map,Vn=new Map);const Nn=Array.from(vt.patternDependencies.keys()).map(jn=>a.I.parse(jn));Nn.length?Ee.send("getImages",{images:Nn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(jn,ti)=>{Br||(Br=jn,br=new Map,yi=this.updateImageMapAndGetImageTaskQueue(br,ti,vt.patternDependencies),Zn())},void 0,!1,Xn):(br=new Map,yi=new Map)}if(vt.elevationFeatures&&vt.elevationFeatures.length>0){const on=[];for(const Nn of Object.values(at))if(Nn instanceof a.bb){const jn=Nn.getUnevaluatedPortalGraph();jn&&on.push(jn)}const Gn=a.ft.evaluate(on);for(const Nn of Object.values(at))if(Nn instanceof a.bb){const jn=ie.layers[it.decode(Nn.sourceLayerIndex)];Nn.setEvaluatedPortalGraph(Gn,jn,this.tileID.canonical,vt.availableImages,vt.brightness)}}Zn()};Wt.length>0?Promise.allSettled(Wt).then(vr).catch(Fe):vr()}updateParameters(ie){this.scaleFactor=ie.scaleFactor,this.showCollisionBoxes=ie.showCollisionBoxes,this.projection=ie.projection,this.brightness=ie.brightness,this.tileTransform=a.aZ(ie.tileID.canonical,ie.projection),this.extraShadowCaster=ie.extraShadowCaster,this.lut=ie.lut,this.worldview=ie.worldview,this.indoor=ie.indoor}rasterizeIfNeeded(ie,de,Ae,ze){Array.from(de.values()).some(Ee=>Ee.usvg)?this.rasterize(ie,de,Ae,ze):ze()}updateImageMapAndGetImageTaskQueue(ie,de,Ae){const ze=new Map;for(const Ee of de.keys()){const Fe=Ae.get(Ee)||[];for(const it of Fe){const qe=it.toString(),at=de.get(it.id.toString());at.usvg?ze.has(qe)||(ze.set(qe,it),ie.set(qe,Object.assign({},at))):ie.set(qe,at)}}return ze}rasterize(ie,de,Ae,ze){this.rasterizeTask=ie.send("rasterizeImages",{scope:this.scope,tasks:Ae},(Ee,Fe)=>{if(!Ee)for(const[it,qe]of Fe.entries()){const at=Object.assign(de.get(it),{data:qe});de.set(it,at)}ze()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function ve(Xe,ie,de,Ae,ze){const Ee=new a.ac(ie,{brightness:de,worldview:ze});for(const Fe of Xe)Fe.recalculate(Ee,Ae)}class Le extends a.E{constructor(ie,de,Ae,ze,Ee,Fe,it){super(),this.actor=ie,this.layerIndex=de,this.availableImages=Ae,this.availableModels=ze,this.loadVectorData=Fe||a.aL,this.loading={},this.loaded={},this.deduped=new a.aK(ie.scheduler),this.isSpriteLoaded=Ee,this.scheduler=ie.scheduler,this.brightness=it}loadTile(ie,de){const Ae=ie.uid,ze=ie&&ie.request,Ee=ze&&ze.collectResourceTiming,Fe=this.loading[Ae]=new fe(ie);Fe.abort=this.loadVectorData(ie,(it,qe)=>{const at=!this.loading[Ae];if(delete this.loading[Ae],Fe.cancelRasterize(),at||it||!qe)return Fe.status="done",at||(this.loaded[Ae]=Fe),de(it);const Dt=qe.rawData,vt={},Wt=a.aM(qe.responseHeaders);Wt&&Wt.expires&&(vt.expires=Wt.expires),Wt&&Wt.cacheControl&&(vt.cacheControl=Wt.cacheControl),Fe.vectorTile=qe.vectorTile||new a.fz(new a.bt(Dt));const dr=()=>{Fe.parse(Fe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(vr,Br)=>{if(vr||!Br)return de(vr);const Sr={};if(Ee){const fr=C(ze);fr.length>0&&(Sr.resourceTiming=JSON.parse(JSON.stringify(fr)))}de(null,Object.assign({rawTileData:Dt.slice(0),responseHeaders:qe.responseHeaders},Br,vt,Sr))})};this.isSpriteLoaded?dr():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(dr,{type:"parseTile",isSymbolTile:ie.isSymbolTile,zoom:ie.tileZoom}):dr()}),this.loaded=this.loaded||{},this.loaded[Ae]=Fe})}reloadTile(ie,de){const Ae=this.loaded,ze=ie.uid;if(Ae&&Ae[ze]){const Ee=Ae[ze];Ee.updateParameters(ie);const Fe=(it,qe)=>{const at=Ee.reloadCallback;at&&(delete Ee.reloadCallback,Ee.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,at)),de(it,qe)};Ee.status==="parsing"?Ee.reloadCallback=Fe:Ee.status==="done"&&(Ee.vectorTile?Ee.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,Fe):Fe())}else de(null,void 0)}abortTile(ie,de){const Ae=ie.uid,ze=this.loading[Ae];ze&&(ze.abort&&ze.abort(),delete this.loading[Ae]),de()}removeTile(ie,de){const Ae=this.loaded,ze=ie.uid;Ae&&Ae[ze]&&delete Ae[ze],de()}}class Ue{loadTile(ie,de){const{uid:Ae,encoding:ze,rawImageData:Ee,padding:Fe}=ie,it=ImageBitmap&&Ee instanceof ImageBitmap?this.getImageData(Ee,Fe):Ee;de(null,new a.fA(Ae,it,ze,Fe<1))}reloadTile(ie,de){de(null,null)}abortTile(ie,de){de()}removeTile(ie,de){de()}getImageData(ie,de){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const Ae=this.offscreenCanvasContext.getImageData(-de,-de,ie.width+2*de,ie.height+2*de);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ae}}a.bs.setPbf(a.bt);class tt{constructor(ie){this._mrt=new a.bs(ie.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=ie.uid,this.tileID=ie.tileID,this.source=ie.source}parse(ie,de){const Ae=this._mrt;this.status="parsing",this._entireBuffer=ie;try{Ae.parseHeader(ie),this._isHeaderLoaded=!0;const ze=[];for(const Ee in Ae.layers){const Fe=Ae.getLayer(Ee),it=Fe.getDataRange(Fe.getBandList()),qe=Ae.createDecodingTask(it),at=ie.slice(it.firstByte,it.lastByte+1),Dt=a.bs.performDecoding(at,qe).then(vt=>qe.complete(null,vt)).catch(vt=>qe.complete(vt,null));ze.push(Dt)}Promise.allSettled(ze).then(()=>de(null,Ae)).catch(Ee=>de(Ee))}catch(ze){de(ze)}}}class Ke{constructor(ie){this.actor=ie,this.loading={},this.loaded={}}loadTile(ie,de){const Ae=ie.uid,ze=ie.request,Ee=this.loading[Ae]=new tt(ie),{cancel:Fe}=a.bu(ze,(it,qe,at)=>{const Dt=!this.loading[Ae];if(delete this.loading[Ae],Dt||it||!qe)return Ee.status="done",Dt||(this.loaded[Ae]=Ee),de(it);Ee.parse(qe,(vt,Wt)=>{if(vt||!Wt)return de(vt);de(null,Wt,at)}),this.loaded[Ae]=Ee});Ee.abort=Fe}reloadTile(ie,de){de(null,void 0)}abortTile(ie,de){const Ae=ie.uid,ze=this.loading[Ae];ze&&(ze.abort&&ze.abort(),delete this.loading[Ae]),de()}removeTile(ie,de){const Ae=ie.uid;this.loaded[Ae]&&delete this.loaded[Ae],de()}decodeRasterArray(ie,de){a.bs.performDecoding(ie.buffer,ie.task).then(Ae=>de(null,Ae)).catch(Ae=>de(Ae))}}const nt=a.fB.prototype.toGeoJSON;class st{constructor(ie){this._feature=ie,this.extent=a.al,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(this._feature.type===1){const ie=[];for(const de of this._feature.geometry)ie.push([new a.P(de[0],de[1])]);return ie}{const ie=[];for(const de of this._feature.geometry){const Ae=[];for(const ze of de)Ae.push(new a.P(ze[0],ze[1]));ie.push(Ae)}return ie}}toGeoJSON(ie,de,Ae){return nt.call(this,ie,de,Ae)}}class Rt{constructor(ie,de){this.name=ie,this.extent=a.al,this.length=de.length,this._jsonFeatures=de}feature(ie){return new st(this._jsonFeatures[ie])}}class Mt{constructor(ie){this.layers={},this.extent=a.al;for(const de of Object.keys(ie))this.layers[de]=new Rt(de,ie[de])}}const $e=64/4096;class rt{constructor(){this.features=new Map}clear(){this.features.clear()}load(ie=[],de){for(const Ae of ie){const ze=Ae.id;if(ze==null)continue;let Ee=this.features.get(ze);Ee&&this.updateCache(Ee,de),Ae.geometry?(Ee=Kt(Ae),this.updateCache(Ee,de),this.features.set(ze,Ee)):this.features.delete(ze),this.updateCache(Ee,de)}}updateCache(ie,de){for(const{canonical:Ae,uid:ze}of Object.values(de)){const{z:Ee,x:Fe,y:it}=Ae;Ct(ie,Math.pow(2,Ee),Fe,it)&&delete de[ze]}}getTile(ie,de,Ae){const ze=Math.pow(2,ie),Ee=[];for(const Fe of this.features.values())Ct(Fe,ze,de,Ae)&&Ee.push(Bt(Fe,ze,de,Ae));return{features:Ee}}getFeatures(){return[...this.features.values()]}}function Ct({minX:Xe,minY:ie,maxX:de,maxY:Ae},ze,Ee,Fe){return Xe<(Ee+1+$e)/ze&&ie<(Fe+1+$e)/ze&&de>(Ee-$e)/ze&&Ae>(Fe-$e)/ze}function Kt(Xe){const{id:ie,geometry:de,properties:Ae}=Xe;if(!de)return;if(de.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ze,coordinates:Ee}=de,Fe={id:ie,type:1,geometry:[],tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},it=Fe.geometry;if(ze==="Point")Je(Ee,it,Fe);else if(ze==="MultiPoint")for(const qe of Ee)Je(qe,it,Fe);else if(ze==="LineString")Fe.type=2,Ze(Ee,it,Fe);else if(ze==="MultiLineString")Fe.type=2,gt(Ee,it,Fe);else if(ze==="Polygon")Fe.type=3,gt(Ee,it,Fe,!0);else{if(ze!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");Fe.type=3;for(const qe of Ee)gt(qe,it,Fe,!0)}return Fe}function Je([Xe,ie],de,Ae){const ze=a.aF(Xe);let Ee=a.aJ(ie);Ee=Ee<0?0:Ee>1?1:Ee,de.push(ze,Ee),Ae.minX=Math.min(Ae.minX,ze),Ae.minY=Math.min(Ae.minY,Ee),Ae.maxX=Math.max(Ae.maxX,ze),Ae.maxY=Math.max(Ae.maxY,Ee)}function Ze(Xe,ie,de,Ae=!1,ze=!1){const Ee=[];for(const Fe of Xe)Je(Fe,Ee,de);ie.push(Ee),Ae&&(function(Fe,it){let qe=0;for(let at=0,Dt=Fe.length,vt=Dt-2;at<Dt;vt=at,at+=2)qe+=(Fe[at]-Fe[vt])*(Fe[at+1]+Fe[vt+1]);if(qe>0===it)for(let at=0,Dt=Fe.length;at<Dt/2;at+=2){const vt=Fe[at],Wt=Fe[at+1];Fe[at]=Fe[Dt-2-at],Fe[at+1]=Fe[Dt-1-at],Fe[Dt-2-at]=vt,Fe[Dt-1-at]=Wt}})(Ee,ze)}function gt(Xe,ie,de,Ae=!1){for(let ze=0;ze<Xe.length;ze++)Ze(Xe[ze],ie,de,Ae,ze===0)}function Bt(Xe,ie,de,Ae){const{id:ze,type:Ee,geometry:Fe,tags:it}=Xe,qe=[];if(Ee===1)(function(at,Dt,vt,Wt,dr){for(let vr=0;vr<at.length;vr+=2){const Br=Math.round(a.al*(at[vr+0]*Dt-vt)),Sr=Math.round(a.al*(at[vr+1]*Dt-Wt));dr.push([Br,Sr])}})(Fe,ie,de,Ae,qe);else if(Ee===2)for(const at of Fe)ar(at,ie,de,Ae,qe);else if(Ee===3)for(const at of Fe)Er(at,ie,de,Ae,qe);return{id:ze,type:Ee,geometry:qe,tags:it}}function ar(Xe,ie,de,Ae,ze){const Fe=a.al+128;let it;for(let qe=0;qe<Xe.length-2;qe+=2){let at=Math.round(a.al*(Xe[qe+0]*ie-de)),Dt=Math.round(a.al*(Xe[qe+1]*ie-Ae)),vt=Math.round(a.al*(Xe[qe+2]*ie-de)),Wt=Math.round(a.al*(Xe[qe+3]*ie-Ae));const dr=vt-at,vr=Wt-Dt;at<-128&&vt<-128||(at<-128?(Dt+=Math.round(vr*((-128-at)/dr)),at=-128):vt<-128&&(Wt=Dt+Math.round(vr*((-128-at)/dr)),vt=-128),Dt<-128&&Wt<-128||(Dt<-128?(at+=Math.round(dr*((-128-Dt)/vr)),Dt=-128):Wt<-128&&(vt=at+Math.round(dr*((-128-Dt)/vr)),Wt=-128),at>=Fe&&vt>=Fe||(at>=Fe?(Dt+=Math.round(vr*((Fe-at)/dr)),at=Fe):vt>=Fe&&(Wt=Dt+Math.round(vr*((Fe-at)/dr)),vt=Fe),Dt>=Fe&&Wt>=Fe||(Dt>=Fe?(at+=Math.round(dr*((Fe-Dt)/vr)),Dt=Fe):Wt>=Fe&&(vt=at+Math.round(dr*((Fe-Dt)/vr)),Wt=Fe),it&&at===it[it.length-1][0]&&Dt===it[it.length-1][1]||(it=[[at,Dt]],ze.push(it)),it.push([vt,Wt])))))}}function Er(Xe,ie,de,Ae,ze){const Ee=(de-$e)/ie,Fe=(Ae-$e)/ie,it=(de+1+$e)/ie,qe=(Ae+1+$e)/ie;function at(Wt,dr){let vr=0;return Wt<Ee?vr|=1:Wt>it&&(vr|=2),dr<Fe?vr|=4:dr>qe&&(vr|=8),vr}let Dt=[];for(let Wt=1;Wt<=8;Wt*=2){let dr=Xe[Xe.length-2],vr=Xe[Xe.length-1],Br=!(at(dr,vr)&Wt);for(let Sr=0;Sr<Xe.length;Sr+=2){const fr=Xe[Sr],br=Xe[Sr+1],Vn=!(at(fr,br)&Wt);Vn!==Br&&(8&Wt?Dt.push(dr+(fr-dr)*(qe-vr)/(br-vr),qe):4&Wt?Dt.push(dr+(fr-dr)*(Fe-vr)/(br-vr),Fe):2&Wt?Dt.push(it,vr+(br-vr)*(it-dr)/(fr-dr)):1&Wt&&Dt.push(Ee,vr+(br-vr)*(Ee-dr)/(fr-dr))),Vn&&Dt.push(fr,br),dr=fr,vr=br,Br=Vn}if(!(Xe=Dt).length||Wt===8)break;Dt=[]}const vt=[];for(let Wt=0;Wt<Dt.length;Wt+=2)vt.push([Math.round(a.al*(Dt[Wt]*ie-de)),Math.round(a.al*(Dt[Wt+1]*ie-Ae))]);vt.length&&ze.push(vt)}function jr({name:Xe,features:ie},de){de.writeStringField(1,Xe),de.writeVarintField(5,a.al);const Ae=new Map,ze=new Map,Ee={keys:Ae,values:ze,feature:null};for(const Fe of ie)Ee.feature=Fe,de.writeMessage(2,Zr,Ee);for(const Fe of Ae.keys())de.writeStringField(3,Fe);for(const Fe of ze.keys())de.writeMessage(4,or,Fe)}function Zr(Xe,ie){const de=Xe.feature;de.id!==void 0&&Number.isSafeInteger(+de.id)&&ie.writeVarintField(1,+de.id),de.tags&&ie.writeMessage(2,fn,Xe),ie.writeVarintField(3,de.type),ie.writeMessage(4,kr,de)}function fn({keys:Xe,values:ie,feature:de},Ae){for(const ze of Object.keys(de.tags)){let Ee=de.tags[ze];if(Ee===null)continue;let Fe=Xe.get(ze);Fe===void 0&&(Fe=Xe.size,Xe.set(ze,Fe)),Ae.writeVarint(Fe);const it=typeof Ee;it!=="string"&&it!=="boolean"&&it!=="number"&&(Ee=JSON.stringify(Ee));let qe=ie.get(Ee);qe===void 0&&(qe=ie.size,ie.set(Ee,qe)),Ae.writeVarint(qe)}}function Xt(Xe,ie){return(ie<<3)+(7&Xe)}function Mr(Xe){return Xe<<1^Xe>>31}function kr(Xe,ie){const{geometry:de,type:Ae}=Xe;let ze=0,Ee=0;if(Ae===1){ie.writeVarint(Xt(1,de.length));for(const Fe of de){const it=Fe[0]-ze,qe=Fe[1]-Ee;ie.writeVarint(Mr(it)),ie.writeVarint(Mr(qe)),ze+=it,Ee+=qe}}else for(const Fe of de){if(Fe.length===0)continue;ie.writeVarint(Xt(1,1));const it=Fe.length-(Ae===3?1:0);for(let qe=0;qe<it;qe++){qe===1&&ie.writeVarint(Xt(2,it-1));const at=Fe[qe][0]-ze,Dt=Fe[qe][1]-Ee;ie.writeVarint(Mr(at)),ie.writeVarint(Mr(Dt)),ze+=at,Ee+=Dt}Ae===3&&ie.writeVarint(Xt(7,1))}}function or(Xe,ie){const de=typeof Xe;de==="string"?ie.writeStringField(1,Xe):de==="boolean"?ie.writeBooleanField(7,Xe):de==="number"&&(Xe%1!=0?ie.writeDoubleField(3,Xe):Xe<0?ie.writeSVarintField(6,Xe):ie.writeVarintField(5,Xe))}const Tr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Xe=>Xe},Ur=Math.fround||(zn=new Float32Array(1),Xe=>(zn[0]=+Xe,zn[0]));var zn;class Fn{constructor(ie){this.options=Object.assign(Object.create(Tr),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:de,minZoom:Ae,maxZoom:ze}=this.options;de&&console.time("total time");const Ee=`prepare ${ie.length} points`;de&&console.time(Ee),this.points=ie;const Fe=[];for(let qe=0;qe<ie.length;qe++){const at=ie[qe];if(!at.geometry)continue;const[Dt,vt]=at.geometry.coordinates,Wt=Ur(ua(Dt)),dr=Ur(da(vt));Fe.push(Wt,dr,1/0,qe,-1,1),this.options.reduce&&Fe.push(0)}let it=this.trees[ze+1]=this._createTree(Fe);de&&console.timeEnd(Ee);for(let qe=ze;qe>=Ae;qe--){const at=+Date.now();it=this.trees[qe]=this._createTree(this._cluster(it,qe)),de&&console.log("z%d: %d clusters in %dms",qe,it.numItems,+Date.now()-at)}return de&&console.timeEnd("total time"),this}getClusters(ie,de){let Ae=((ie[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,ie[1]));let Ee=ie[2]===180?180:((ie[2]+180)%360+360)%360-180;const Fe=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)Ae=-180,Ee=180;else if(Ae>Ee){const vt=this.getClusters([Ae,ze,180,Fe],de),Wt=this.getClusters([-180,ze,Ee,Fe],de);return vt.concat(Wt)}const it=this.trees[this._limitZoom(de)],qe=it.range(ua(Ae),da(Fe),ua(Ee),da(ze)),at=it.data,Dt=[];for(const vt of qe){const Wt=this.stride*vt;Dt.push(at[Wt+5]>1?Ut(at,Wt,this.clusterProps):this.points[at[Wt+3]])}return Dt}getChildren(ie){const de=this._getOriginId(ie),Ae=this._getOriginZoom(ie),ze="No cluster with the specified id.",Ee=this.trees[Ae];if(!Ee)throw new Error(ze);const Fe=Ee.data;if(de*this.stride>=Fe.length)throw new Error(ze);const it=this.options.radius/(this.options.extent*Math.pow(2,Ae-1)),qe=Ee.within(Fe[de*this.stride],Fe[de*this.stride+1],it),at=[];for(const Dt of qe){const vt=Dt*this.stride;Fe[vt+4]===ie&&at.push(Fe[vt+5]>1?Ut(Fe,vt,this.clusterProps):this.points[Fe[vt+3]])}if(at.length===0)throw new Error(ze);return at}getLeaves(ie,de,Ae){const ze=[];return this._appendLeaves(ze,ie,de=de||10,Ae=Ae||0,0),ze}getTile(ie,de,Ae){const ze=this.trees[this._limitZoom(ie)],Ee=Math.pow(2,ie),{extent:Fe,radius:it}=this.options,qe=it/Fe,at=(Ae-qe)/Ee,Dt=(Ae+1+qe)/Ee,vt={features:[]};return this._addTileFeatures(ze.range((de-qe)/Ee,at,(de+1+qe)/Ee,Dt),ze.data,de,Ae,Ee,vt),de===0&&this._addTileFeatures(ze.range(1-qe/Ee,at,1,Dt),ze.data,Ee,Ae,Ee,vt),de===Ee-1&&this._addTileFeatures(ze.range(0,at,qe/Ee,Dt),ze.data,-1,Ae,Ee,vt),vt.features.length?vt:null}getClusterExpansionZoom(ie){let de=this._getOriginZoom(ie)-1;for(;de<=this.options.maxZoom;){const Ae=this.getChildren(ie);if(de++,Ae.length!==1)break;ie=Ae[0].properties.cluster_id}return de}_appendLeaves(ie,de,Ae,ze,Ee){const Fe=this.getChildren(de);for(const it of Fe){const qe=it.properties;if(qe&&qe.cluster?Ee+qe.point_count<=ze?Ee+=qe.point_count:Ee=this._appendLeaves(ie,qe.cluster_id,Ae,ze,Ee):Ee<ze?Ee++:ie.push(it),ie.length===Ae)break}return Ee}_createTree(ie){const de=new a.c4(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ae=0;Ae<ie.length;Ae+=this.stride)de.add(ie[Ae],ie[Ae+1]);return de.finish(),de.data=ie,de}_addTileFeatures(ie,de,Ae,ze,Ee,Fe){for(const it of ie){const qe=it*this.stride,at=de[qe+5]>1;let Dt,vt,Wt;if(at)Dt=_n(de,qe,this.clusterProps),vt=de[qe],Wt=de[qe+1];else{const Br=this.points[de[qe+3]];Dt=Br.properties;const[Sr,fr]=Br.geometry.coordinates;vt=ua(Sr),Wt=da(fr)}const dr={type:1,geometry:[[Math.round(this.options.extent*(vt*Ee-Ae)),Math.round(this.options.extent*(Wt*Ee-ze))]],tags:Dt};let vr;vr=at||this.options.generateId?de[qe+3]:this.points[de[qe+3]].id,vr!==void 0&&(dr.id=vr),Fe.features.push(dr)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,de){const{radius:Ae,extent:ze,reduce:Ee,minPoints:Fe}=this.options,it=Ae/(ze*Math.pow(2,de)),qe=ie.data,at=[],Dt=this.stride;for(let vt=0;vt<qe.length;vt+=Dt){if(qe[vt+2]<=de)continue;qe[vt+2]=de;const Wt=qe[vt],dr=qe[vt+1],vr=ie.within(qe[vt],qe[vt+1],it),Br=qe[vt+5];let Sr=Br;for(const fr of vr){const br=fr*Dt;qe[br+2]>de&&(Sr+=qe[br+5])}if(Sr>Br&&Sr>=Fe){let fr,br=Wt*Br,Vn=dr*Br,yi=-1;const Xn=(vt/Dt<<5)+(de+1)+this.points.length;for(const Zn of vr){const qn=Zn*Dt;if(qe[qn+2]<=de)continue;qe[qn+2]=de;const on=qe[qn+5];br+=qe[qn]*on,Vn+=qe[qn+1]*on,qe[qn+4]=Xn,Ee&&(fr||(fr=this._map(qe,vt,!0),yi=this.clusterProps.length,this.clusterProps.push(fr)),Ee(fr,this._map(qe,qn)))}qe[vt+4]=Xn,at.push(br/Sr,Vn/Sr,1/0,Xn,-1,Sr),Ee&&at.push(yi)}else{for(let fr=0;fr<Dt;fr++)at.push(qe[vt+fr]);if(Sr>1)for(const fr of vr){const br=fr*Dt;if(!(qe[br+2]<=de)){qe[br+2]=de;for(let Vn=0;Vn<Dt;Vn++)at.push(qe[br+Vn])}}}}return at}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,de,Ae){if(ie[de+5]>1){const Fe=this.clusterProps[ie[de+6]];return Ae?Object.assign({},Fe):Fe}const ze=this.points[ie[de+3]].properties,Ee=this.options.map(ze);return Ae&&Ee===ze?Object.assign({},Ee):Ee}}function Ut(Xe,ie,de){return{type:"Feature",id:Xe[ie+3],properties:_n(Xe,ie,de),geometry:{type:"Point",coordinates:[(Ae=Xe[ie],360*(Ae-.5)),Yn(Xe[ie+1])]}};var Ae}function _n(Xe,ie,de){const Ae=Xe[ie+5],ze=Ae>=1e4?`${Math.round(Ae/1e3)}k`:Ae>=1e3?Math.round(Ae/100)/10+"k":Ae,Ee=Xe[ie+6],Fe=Ee===-1?{}:Object.assign({},de[Ee]);return Object.assign(Fe,{cluster:!0,cluster_id:Xe[ie+3],point_count:Ae,point_count_abbreviated:ze})}function ua(Xe){return Xe/360+.5}function da(Xe){const ie=Math.sin(Xe*Math.PI/180),de=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return de<0?0:de>1?1:de}function Yn(Xe){const ie=(180-360*Xe)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function ha(Xe,ie,de,Ae){let ze=Ae;const Ee=ie+(de-ie>>1);let Fe,it=de-ie;const qe=Xe[ie],at=Xe[ie+1],Dt=Xe[de],vt=Xe[de+1];for(let Wt=ie+3;Wt<de;Wt+=3){const dr=go(Xe[Wt],Xe[Wt+1],qe,at,Dt,vt);if(dr>ze)Fe=Wt,ze=dr;else if(dr===ze){const vr=Math.abs(Wt-Ee);vr<it&&(Fe=Wt,it=vr)}}ze>Ae&&(Fe-ie>3&&ha(Xe,ie,Fe,Ae),Xe[Fe+2]=ze,de-Fe>3&&ha(Xe,Fe,de,Ae))}function go(Xe,ie,de,Ae,ze,Ee){let Fe=ze-de,it=Ee-Ae;if(Fe!==0||it!==0){const qe=((Xe-de)*Fe+(ie-Ae)*it)/(Fe*Fe+it*it);qe>1?(de=ze,Ae=Ee):qe>0&&(de+=Fe*qe,Ae+=it*qe)}return Fe=Xe-de,it=ie-Ae,Fe*Fe+it*it}function ni(Xe,ie,de,Ae){const ze={id:Xe??null,type:ie,geometry:de,tags:Ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ie==="Point"||ie==="MultiPoint"||ie==="LineString")ii(ze,de);else if(ie==="Polygon")ii(ze,de[0]);else if(ie==="MultiLineString")for(const Ee of de)ii(ze,Ee);else if(ie==="MultiPolygon")for(const Ee of de)ii(ze,Ee[0]);return ze}function ii(Xe,ie){for(let de=0;de<ie.length;de+=3)Xe.minX=Math.min(Xe.minX,ie[de]),Xe.minY=Math.min(Xe.minY,ie[de+1]),Xe.maxX=Math.max(Xe.maxX,ie[de]),Xe.maxY=Math.max(Xe.maxY,ie[de+1])}function no(Xe,ie,de,Ae){if(!ie.geometry)return;const ze=ie.geometry.coordinates;if(ze&&ze.length===0)return;const Ee=ie.geometry.type,Fe=Math.pow(de.tolerance/((1<<de.maxZoom)*de.extent),2);let it=[],qe=ie.id;if(de.promoteId?qe=ie.properties[de.promoteId]:de.generateId&&(qe=Ae||0),Ee==="Point")Ai(ze,it);else if(Ee==="MultiPoint")for(const at of ze)Ai(at,it);else if(Ee==="LineString")ga(ze,it,Fe,!1);else if(Ee==="MultiLineString"){if(de.lineMetrics){for(const at of ze)it=[],ga(at,it,Fe,!1),Xe.push(ni(qe,"LineString",it,ie.properties));return}Ha(ze,it,Fe,!1)}else if(Ee==="Polygon")Ha(ze,it,Fe,!0);else{if(Ee!=="MultiPolygon"){if(Ee==="GeometryCollection"){for(const at of ie.geometry.geometries)no(Xe,{id:qe,geometry:at,properties:ie.properties},de,Ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const at of ze){const Dt=[];Ha(at,Dt,Fe,!0),it.push(Dt)}}Xe.push(ni(qe,Ee,it,ie.properties))}function Ai(Xe,ie){ie.push(Zi(Xe[0]),cl(Xe[1]),0)}function ga(Xe,ie,de,Ae){let ze,Ee,Fe=0;for(let qe=0;qe<Xe.length;qe++){const at=Zi(Xe[qe][0]),Dt=cl(Xe[qe][1]);ie.push(at,Dt,0),qe>0&&(Fe+=Ae?(ze*Dt-at*Ee)/2:Math.sqrt(Math.pow(at-ze,2)+Math.pow(Dt-Ee,2))),ze=at,Ee=Dt}const it=ie.length-3;ie[2]=1,ha(ie,0,it,de),ie[it+2]=1,ie.size=Math.abs(Fe),ie.start=0,ie.end=ie.size}function Ha(Xe,ie,de,Ae){for(let ze=0;ze<Xe.length;ze++){const Ee=[];ga(Xe[ze],Ee,de,Ae),ie.push(Ee)}}function Zi(Xe){return Xe/360+.5}function cl(Xe){const ie=Math.sin(Xe*Math.PI/180),de=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return de<0?0:de>1?1:de}function fi(Xe,ie,de,Ae,ze,Ee,Fe,it){if(Ae/=ie,Ee>=(de/=ie)&&Fe<Ae)return Xe;if(Fe<de||Ee>=Ae)return null;const qe=[];for(const at of Xe){const Dt=at.geometry;let vt=at.type;const Wt=ze===0?at.minX:at.minY,dr=ze===0?at.maxX:at.maxY;if(Wt>=de&&dr<Ae){qe.push(at);continue}if(dr<de||Wt>=Ae)continue;let vr=[];if(vt==="Point"||vt==="MultiPoint")Cs(Dt,vr,de,Ae,ze);else if(vt==="LineString")Ci(Dt,vr,de,Ae,ze,!1,it.lineMetrics);else if(vt==="MultiLineString")qi(Dt,vr,de,Ae,ze,!1);else if(vt==="Polygon")qi(Dt,vr,de,Ae,ze,!0);else if(vt==="MultiPolygon")for(const Br of Dt){const Sr=[];qi(Br,Sr,de,Ae,ze,!0),Sr.length&&vr.push(Sr)}if(vr.length){if(it.lineMetrics&&vt==="LineString"){for(const Br of vr)qe.push(ni(at.id,vt,Br,at.tags));continue}vt!=="LineString"&&vt!=="MultiLineString"||(vr.length===1?(vt="LineString",vr=vr[0]):vt="MultiLineString"),vt!=="Point"&&vt!=="MultiPoint"||(vt=vr.length===3?"Point":"MultiPoint"),qe.push(ni(at.id,vt,vr,at.tags))}}return qe.length?qe:null}function Cs(Xe,ie,de,Ae,ze){for(let Ee=0;Ee<Xe.length;Ee+=3){const Fe=Xe[Ee+ze];Fe>=de&&Fe<=Ae&&_o(ie,Xe[Ee],Xe[Ee+1],Xe[Ee+2])}}function Ci(Xe,ie,de,Ae,ze,Ee,Fe){let it=Ti(Xe);const qe=ze===0?$o:Mn;let at,Dt,vt=Xe.start;for(let Sr=0;Sr<Xe.length-3;Sr+=3){const fr=Xe[Sr],br=Xe[Sr+1],Vn=Xe[Sr+2],yi=Xe[Sr+3],Xn=Xe[Sr+4],Zn=ze===0?fr:br,qn=ze===0?yi:Xn;let on=!1;Fe&&(at=Math.sqrt(Math.pow(fr-yi,2)+Math.pow(br-Xn,2))),Zn<de?qn>de&&(Dt=qe(it,fr,br,yi,Xn,de),Fe&&(it.start=vt+at*Dt)):Zn>Ae?qn<Ae&&(Dt=qe(it,fr,br,yi,Xn,Ae),Fe&&(it.start=vt+at*Dt)):_o(it,fr,br,Vn),qn<de&&Zn>=de&&(Dt=qe(it,fr,br,yi,Xn,de),on=!0),qn>Ae&&Zn<=Ae&&(Dt=qe(it,fr,br,yi,Xn,Ae),on=!0),!Ee&&on&&(Fe&&(it.end=vt+at*Dt),ie.push(it),it=Ti(Xe)),Fe&&(vt+=at)}let Wt=Xe.length-3;const dr=Xe[Wt],vr=Xe[Wt+1],Br=ze===0?dr:vr;Br>=de&&Br<=Ae&&_o(it,dr,vr,Xe[Wt+2]),Wt=it.length-3,Ee&&Wt>=3&&(it[Wt]!==it[0]||it[Wt+1]!==it[1])&&_o(it,it[0],it[1],it[2]),it.length&&ie.push(it)}function Ti(Xe){const ie=[];return ie.size=Xe.size,ie.start=Xe.start,ie.end=Xe.end,ie}function qi(Xe,ie,de,Ae,ze,Ee){for(const Fe of Xe)Ci(Fe,ie,de,Ae,ze,Ee,!1)}function _o(Xe,ie,de,Ae){Xe.push(ie,de,Ae)}function $o(Xe,ie,de,Ae,ze,Ee){const Fe=(Ee-ie)/(Ae-ie);return _o(Xe,Ee,de+(ze-de)*Fe,1),Fe}function Mn(Xe,ie,de,Ae,ze,Ee){const Fe=(Ee-de)/(ze-de);return _o(Xe,ie+(Ae-ie)*Fe,Ee,1),Fe}function io(Xe,ie){const de=[];for(let Ae=0;Ae<Xe.length;Ae++){const ze=Xe[Ae],Ee=ze.type;let Fe;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")Fe=_a(ze.geometry,ie);else if(Ee==="MultiLineString"||Ee==="Polygon"){Fe=[];for(const it of ze.geometry)Fe.push(_a(it,ie))}else if(Ee==="MultiPolygon"){Fe=[];for(const it of ze.geometry){const qe=[];for(const at of it)qe.push(_a(at,ie));Fe.push(qe)}}de.push(ni(ze.id,Ee,Fe,ze.tags))}return de}function _a(Xe,ie){const de=[];de.size=Xe.size,Xe.start!==void 0&&(de.start=Xe.start,de.end=Xe.end);for(let Ae=0;Ae<Xe.length;Ae+=3)de.push(Xe[Ae]+ie,Xe[Ae+1],Xe[Ae+2]);return de}function La(Xe,ie){if(Xe.transformed)return Xe;const de=1<<Xe.z,Ae=Xe.x,ze=Xe.y;for(const Ee of Xe.features){const Fe=Ee.geometry,it=Ee.type;if(Ee.geometry=[],it===1)for(let qe=0;qe<Fe.length;qe+=2)Ee.geometry.push(pn(Fe[qe],Fe[qe+1],ie,de,Ae,ze));else for(let qe=0;qe<Fe.length;qe++){const at=[];for(let Dt=0;Dt<Fe[qe].length;Dt+=2)at.push(pn(Fe[qe][Dt],Fe[qe][Dt+1],ie,de,Ae,ze));Ee.geometry.push(at)}}return Xe.transformed=!0,Xe}function pn(Xe,ie,de,Ae,ze,Ee){return[Math.round(de*(Xe*Ae-ze)),Math.round(de*(ie*Ae-Ee))]}function Bi(Xe,ie,de,Ae,ze){const Ee=ie===ze.maxZoom?0:ze.tolerance/((1<<ie)*ze.extent),Fe={features:[],numPoints:0,numSimplified:0,numFeatures:Xe.length,source:null,x:de,y:Ae,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const it of Xe)as(Fe,it,Ee,ze);return Fe}function as(Xe,ie,de,Ae){const ze=ie.geometry,Ee=ie.type,Fe=[];if(Xe.minX=Math.min(Xe.minX,ie.minX),Xe.minY=Math.min(Xe.minY,ie.minY),Xe.maxX=Math.max(Xe.maxX,ie.maxX),Xe.maxY=Math.max(Xe.maxY,ie.maxY),Ee==="Point"||Ee==="MultiPoint")for(let it=0;it<ze.length;it+=3)Fe.push(ze[it],ze[it+1]),Xe.numPoints++,Xe.numSimplified++;else if(Ee==="LineString")qo(Fe,ze,Xe,de,!1,!1);else if(Ee==="MultiLineString"||Ee==="Polygon")for(let it=0;it<ze.length;it++)qo(Fe,ze[it],Xe,de,Ee==="Polygon",it===0);else if(Ee==="MultiPolygon")for(let it=0;it<ze.length;it++){const qe=ze[it];for(let at=0;at<qe.length;at++)qo(Fe,qe[at],Xe,de,!0,at===0)}if(Fe.length){let it=ie.tags||null;if(Ee==="LineString"&&Ae.lineMetrics){it={};for(const at in ie.tags)it[at]=ie.tags[at];it.mapbox_clip_start=ze.start/ze.size,it.mapbox_clip_end=ze.end/ze.size}const qe={geometry:Fe,type:Ee==="Polygon"||Ee==="MultiPolygon"?3:Ee==="LineString"||Ee==="MultiLineString"?2:1,tags:it};ie.id!==null&&(qe.id=ie.id),Xe.features.push(qe)}}function qo(Xe,ie,de,Ae,ze,Ee){const Fe=Ae*Ae;if(Ae>0&&ie.size<(ze?Fe:Ae))return void(de.numPoints+=ie.length/3);const it=[];for(let qe=0;qe<ie.length;qe+=3)(Ae===0||ie[qe+2]>Fe)&&(de.numSimplified++,it.push(ie[qe],ie[qe+1])),de.numPoints++;ze&&(function(qe,at){let Dt=0;for(let vt=0,Wt=qe.length,dr=Wt-2;vt<Wt;dr=vt,vt+=2)Dt+=(qe[vt]-qe[dr])*(qe[vt+1]+qe[dr+1]);if(Dt>0===at)for(let vt=0,Wt=qe.length;vt<Wt/2;vt+=2){const dr=qe[vt],vr=qe[vt+1];qe[vt]=qe[Wt-2-vt],qe[vt+1]=qe[Wt-1-vt],qe[Wt-2-vt]=dr,qe[Wt-1-vt]=vr}})(it,Ee),Xe.push(it)}const Xa={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Tn{constructor(ie,de){const Ae=(de=this.options=(function(Ee,Fe){for(const it in Fe)Ee[it]=Fe[it];return Ee})(Object.create(Xa),de)).debug;if(Ae&&console.time("preprocess data"),de.maxZoom<0||de.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(de.promoteId&&de.generateId)throw new Error("promoteId and generateId cannot be used together.");let ze=(function(Ee,Fe){const it=[];if(Ee.type==="FeatureCollection")for(let qe=0;qe<Ee.features.length;qe++)no(it,Ee.features[qe],Fe,qe);else no(it,Ee.type==="Feature"?Ee:{geometry:Ee},Fe);return it})(ie,de);this.tiles={},this.tileCoords=[],Ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",de.indexMaxZoom,de.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=(function(Ee,Fe){const it=Fe.buffer/Fe.extent;let qe=Ee;const at=fi(Ee,1,-1-it,it,0,-1,2,Fe),Dt=fi(Ee,1,1-it,2+it,0,-1,2,Fe);return(at||Dt)&&(qe=fi(Ee,1,-it,1+it,0,-1,2,Fe)||[],at&&(qe=io(at,1).concat(qe)),Dt&&(qe=qe.concat(io(Dt,-1)))),qe})(ze,de),ze.length&&this.splitTile(ze,0,0,0),Ae&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,de,Ae,ze,Ee,Fe,it){const qe=[ie,de,Ae,ze],at=this.options,Dt=at.debug;for(;qe.length;){ze=qe.pop(),Ae=qe.pop(),de=qe.pop(),ie=qe.pop();const vt=1<<de,Wt=Jr(de,Ae,ze);let dr=this.tiles[Wt];if(!dr&&(Dt>1&&console.time("creation"),dr=this.tiles[Wt]=Bi(ie,de,Ae,ze,at),this.tileCoords.push({z:de,x:Ae,y:ze}),Dt)){Dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",de,Ae,ze,dr.numFeatures,dr.numPoints,dr.numSimplified),console.timeEnd("creation"));const on=`z${de}`;this.stats[on]=(this.stats[on]||0)+1,this.total++}if(dr.source=ie,Ee==null){if(de===at.indexMaxZoom||dr.numPoints<=at.indexMaxPoints)continue}else{if(de===at.maxZoom||de===Ee)continue;if(Ee!=null){const on=Ee-de;if(Ae!==Fe>>on||ze!==it>>on)continue}}if(dr.source=null,ie.length===0)continue;Dt>1&&console.time("clipping");const vr=.5*at.buffer/at.extent,Br=.5-vr,Sr=.5+vr,fr=1+vr;let br=null,Vn=null,yi=null,Xn=null,Zn=fi(ie,vt,Ae-vr,Ae+Sr,0,dr.minX,dr.maxX,at),qn=fi(ie,vt,Ae+Br,Ae+fr,0,dr.minX,dr.maxX,at);ie=null,Zn&&(br=fi(Zn,vt,ze-vr,ze+Sr,1,dr.minY,dr.maxY,at),Vn=fi(Zn,vt,ze+Br,ze+fr,1,dr.minY,dr.maxY,at),Zn=null),qn&&(yi=fi(qn,vt,ze-vr,ze+Sr,1,dr.minY,dr.maxY,at),Xn=fi(qn,vt,ze+Br,ze+fr,1,dr.minY,dr.maxY,at),qn=null),Dt>1&&console.timeEnd("clipping"),qe.push(br||[],de+1,2*Ae,2*ze),qe.push(Vn||[],de+1,2*Ae,2*ze+1),qe.push(yi||[],de+1,2*Ae+1,2*ze),qe.push(Xn||[],de+1,2*Ae+1,2*ze+1)}}getTile(ie,de,Ae){ie=+ie,de=+de,Ae=+Ae;const ze=this.options,{extent:Ee,debug:Fe}=ze;if(ie<0||ie>24)return null;const it=1<<ie,qe=Jr(ie,de=de+it&it-1,Ae);if(this.tiles[qe])return La(this.tiles[qe],Ee);Fe>1&&console.log("drilling down to z%d-%d-%d",ie,de,Ae);let at,Dt=ie,vt=de,Wt=Ae;for(;!at&&Dt>0;)Dt--,vt>>=1,Wt>>=1,at=this.tiles[Jr(Dt,vt,Wt)];return at&&at.source?(Fe>1&&(console.log("found parent tile z%d-%d-%d",Dt,vt,Wt),console.time("drilling down")),this.splitTile(at.source,Dt,vt,Wt,ie,de,Ae),Fe>1&&console.timeEnd("drilling down"),this.tiles[qe]?La(this.tiles[qe],Ee):null):null}}function Jr(Xe,ie,de){return 32*((1<<Xe)*de+ie)+Xe}function yt(Xe,ie){const de=Xe.tileID.canonical;if(!this._geoJSONIndex)return void ie(null,null);const Ae=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!Ae)return void ie(null,null);const ze=at=>at.tags&&"3d_elevation_id"in at.tags&&"source"in at.tags&&at.tags.source==="elevation",Ee=Ae.features.filter(at=>ze(at));let Fe={_geojsonTileLayer:Ae.features};Ee.length>0&&(Fe={_geojsonTileLayer:Ae.features.filter(at=>!ze(at)),hd_road_elevation:Ee});const it=new Mt(Fe),qe=(function(at){const Dt=new a.bt;for(const vt of Object.keys(at))Dt.writeMessage(3,jr,{name:vt,features:at[vt]});return Dt.finish()})(Fe).buffer;ie(null,{vectorTile:it,rawData:qe})}class Or extends Le{constructor(ie,de,Ae,ze,Ee,Fe,it){super(ie,de,Ae,ze,Ee,yt,it),Fe&&(this.loadGeoJSON=Fe),this._dynamicIndex=new rt}loadData(ie,de){const Ae=ie&&ie.request,ze=Ae&&Ae.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(ie,(Ee,Fe)=>{if(Ee||!Fe)return de(Ee);if(typeof Fe!="object")return de(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{try{if(ie.filter){const qe=a.U(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(qe.result==="error")throw new Error(qe.value.map(at=>`${at.key}: ${at.message}`).join(", "));Fe.features=Fe.features.filter(at=>qe.value.evaluate({zoom:0},at))}ie.dynamic?(Fe.type==="Feature"&&(Fe={type:"FeatureCollection",features:[Fe]}),ie.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(Fe.features,this.loaded),ie.cluster&&(Fe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ie.cluster?new Fn((function({superclusterOptions:qe,clusterProperties:at}){if(!at||!qe)return qe;const Dt={},vt={},Wt={accumulated:null,zoom:0},dr={properties:null},vr=Object.keys(at);for(const Br of vr){const[Sr,fr]=at[Br],br=a.U(fr),Vn=a.U(typeof Sr=="string"?[Sr,["accumulated"],["get",Br]]:Sr);Dt[Br]=br.value,vt[Br]=Vn.value}return qe.map=Br=>{dr.properties=Br;const Sr={};for(const fr of vr)Sr[fr]=Dt[fr].evaluate(Wt,dr);return Sr},qe.reduce=(Br,Sr)=>{dr.properties=Sr;for(const fr of vr)Wt.accumulated=Br[fr],Br[fr]=vt[fr].evaluate(Wt,dr)},qe})(ie)).load(Fe.features):ie.dynamic?this._dynamicIndex:(function(qe,at){return new Tn(qe,at)})(Fe,ie.geojsonVtOptions)}catch(qe){return de(qe)}const it={};if(ze){const qe=C(Ae);qe&&(it.resourceTiming={},it.resourceTiming[ie.source]=JSON.parse(JSON.stringify(qe)))}de(null,it)}})}reloadTile(ie,de){const Ae=this.loaded;return Ae&&Ae[ie.uid]?ie.partial?de(null,void 0):super.reloadTile(ie,de):this.loadTile(ie,de)}loadGeoJSON(ie,de){if(ie.request)a.m(ie.request,de);else{if(typeof ie.data!="string")return de(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));setTimeout(()=>{try{return de(null,JSON.parse(ie.data))}catch{return de(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}},0)}}getClusterExpansionZoom(ie,de){try{de(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(Ae){de(Ae)}}getClusterChildren(ie,de){try{de(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(Ae){de(Ae)}}getClusterLeaves(ie,de){try{de(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(Ae){de(Ae)}}}class Sn{constructor(ie,de,Ae){this.tileID=new a.aQ(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ie.projection,this.brightness=de,this.worldview=Ae}parse(ie,de,Ae,ze){this.status="parsing";const Ee=new a.aQ(Ae.tileID.overscaledZ,Ae.tileID.wrap,Ae.tileID.canonical.z,Ae.tileID.canonical.x,Ae.tileID.canonical.y),Fe=[],it=de.familiesBySource[Ae.source],qe=new a.fn(Ee,Ae.promoteId);qe.bucketLayerIDs=[],qe.is3DTile=!0,a.fC(ie).then(at=>{if(!at)return ze(new Error("Could not parse tile"));const Dt=at.json.extensionsUsed&&at.json.extensionsUsed.includes("MAPBOX_mesh_features")||at.json.asset.extras&&at.json.asset.extras.MAPBOX_mesh_features,vt=at.json.extensionsUsed&&at.json.extensionsUsed.includes("EXT_meshopt_compression"),Wt=new a.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const dr in it)for(const vr of it[dr]){const Br=vr[0];qe.bucketLayerIDs.push(vr.map(br=>a.B(br.id,br.scope))),Br.recalculate(Wt,[]);const Sr=a.fD(at,1/a.d7(Ae.tileID.canonical)),fr=new a.fE(vr,Sr,Ee,Dt,vt,this.brightness,qe,this.worldview);Dt||(fr.needsUpload=!0),Fe.push(fr),fr.evaluate(Br)}this.status="done",ze(null,{buckets:Fe,featureIndex:qe,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(at=>ze(new Error(at.message)))}}class an{constructor(ie,de,Ae,ze,Ee,Fe,it,qe){this.actor=ie,this.layerIndex=de,this.availableImages=Ae,this.availableModels=ze,this.brightness=it,this.loading={},this.loaded={},this.worldview=qe}loadTile(ie,de){const Ae=ie.uid,ze=this.loading[Ae]=new Sn(ie,this.brightness,this.worldview);a.bu(ie.request,(Ee,Fe)=>{const it=!this.loading[Ae];return delete this.loading[Ae],it||Ee?(ze.status="done",it||(this.loaded[Ae]=ze),de(Ee)):Fe&&Fe.byteLength!==0?void ze.parse(Fe,this.layerIndex,ie,(qe,at)=>{ze.status="done",this.loaded=this.loaded||{},this.loaded[Ae]=ze,qe||!at?de(qe):de(null,at)}):(ze.status="done",this.loaded[Ae]=ze,de())})}reloadTile(ie,de){const Ae=this.loaded,ze=ie.uid;if(Ae&&Ae[ze]){const Ee=Ae[ze];Ee.projection=ie.projection,Ee.brightness=ie.brightness;const Fe=(it,qe)=>{Ee.reloadCallback&&(delete Ee.reloadCallback,this.loadTile(ie,de)),de(it,qe)};Ee.status==="parsing"?Ee.reloadCallback=Fe:Ee.status==="done"&&this.loadTile(ie,de)}}abortTile(ie,de){const Ae=ie.uid;this.loading[Ae]&&delete this.loading[Ae],de()}removeTile(ie,de){const Ae=this.loaded,ze=ie.uid;Ae&&Ae[ze]&&delete Ae[ze],de()}}class yr{constructor(ie){this.self=ie,this.actor=new a.fG(ie,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new a.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=a.cm({name:"mercator"}),this.workerSourceTypes={vector:Le,geojson:Or,"raster-dem":Ue,"raster-array":Ke,"batched-model":an},this.workerSources={},this.self.registerWorkerSource=(de,Ae)=>{if(this.workerSourceTypes[de])throw new Error(`Worker source with name "${de}" already registered.`);this.workerSourceTypes[de]=Ae},this.self.registerRTLTextPlugin=de=>{if(a.fH.isParsed())throw new Error("RTL text plugin already registered.");a.fH.setState({pluginStatus:a.fI.parsed,pluginURL:a.fH.getPluginURL()}),a.fH.applyArabicShaping=de.applyArabicShaping,a.fH.processBidirectionalText=de.processBidirectionalText,a.fH.processStyledBidirectionalText=de.processStyledBidirectionalText;for(const Ae of this.rtlPluginParsingListeners)Ae(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(ie,de,Ae){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.availableModels[ie],delete this.workerSources[ie],Ae()}checkIfReady(ie,de,Ae){Ae()}setReferrer(ie,de){this.referrer=de}spriteLoaded(ie,de){this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={});const{scope:Ae,isLoaded:ze}=de;if(this.isSpriteLoaded[ie][Ae]=ze,this.workerSources[ie]&&this.workerSources[ie][Ae])for(const Ee in this.workerSources[ie][Ae]){const Fe=this.workerSources[ie][Ae][Ee];for(const it in Fe){const qe=Fe[it];qe instanceof Le&&(qe.isSpriteLoaded=ze,qe.fire(new a.z("isSpriteLoaded")))}}}setImages(ie,de,Ae){this.availableImages[ie]||(this.availableImages[ie]={});const{scope:ze,images:Ee}=de;if(this.availableImages[ie][ze]=Ee,this.workerSources[ie]&&this.workerSources[ie][ze]){for(const Fe in this.workerSources[ie][ze]){const it=this.workerSources[ie][ze][Fe];for(const qe in it)it[qe].availableImages=Ee}Ae()}else Ae()}setModels(ie,{scope:de,models:Ae},ze){if(this.availableModels[ie]||(this.availableModels[ie]={}),this.availableModels[ie][de]=Ae,this.workerSources[ie]&&this.workerSources[ie][de]){for(const Ee in this.workerSources[ie][de]){const Fe=this.workerSources[ie][de][Ee];for(const it in Fe)Fe[it].availableModels=Ae}ze()}else ze()}setProjection(ie,de){this.projections[ie]=a.cm(de)}setBrightness(ie,de,Ae){this.brightness=de,Ae()}setWorldview(ie,de,Ae){this.worldview=de,Ae()}setLayers(ie,de,Ae){this.getLayerIndex(ie,de.scope).replace(de.layers,de.options),Ae()}updateLayers(ie,de,Ae){this.getLayerIndex(ie,de.scope).update(de.layers,de.removedIds,de.options),Ae()}loadTile(ie,de,Ae){de.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,de.type,de.source,de.scope).loadTile(de,Ae)}decodeRasterArray(ie,de,Ae){this.getWorkerSource(ie,de.type,de.source,de.scope).decodeRasterArray(de,Ae)}reloadTile(ie,de,Ae){de.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,de.type,de.source,de.scope).reloadTile(de,Ae)}abortTile(ie,de,Ae){this.getWorkerSource(ie,de.type,de.source,de.scope).abortTile(de,Ae)}removeTile(ie,de,Ae){this.getWorkerSource(ie,de.type,de.source,de.scope).removeTile(de,Ae)}removeSource(ie,de,Ae){if(!(this.workerSources[ie]&&this.workerSources[ie][de.scope]&&this.workerSources[ie][de.scope][de.type]&&this.workerSources[ie][de.scope][de.type][de.source]))return;const ze=this.workerSources[ie][de.scope][de.type][de.source];delete this.workerSources[ie][de.scope][de.type][de.source],ze.removeSource!==void 0?ze.removeSource(de,Ae):Ae()}loadWorkerSource(ie,de,Ae){try{this.self.importScripts(de.url),Ae()}catch(ze){Ae(ze)}}syncRTLPluginState(ie,de,Ae){if(a.fH.isParsed())Ae(null,!0);else if(a.fH.isParsing())this.rtlPluginParsingListeners.push(Ae);else try{a.fH.setState(de);const ze=a.fH.getPluginURL();!a.fH.isLoaded()||a.fH.isParsed()||a.fH.isParsing()||ze==null||(a.fH.setState({pluginStatus:a.fI.parsing,pluginURL:a.fH.getPluginURL()}),this.self.importScripts(ze),a.fH.isParsed()?Ae(null,!0):this.rtlPluginParsingListeners.push(Ae))}catch(ze){Ae(ze)}}setDracoUrl(ie,de){this.dracoUrl=de}getAvailableImages(ie,de){this.availableImages[ie]||(this.availableImages[ie]={});let Ae=this.availableImages[ie][de];return Ae||(Ae=[]),Ae}getAvailableModels(ie,de){this.availableModels[ie]||(this.availableModels[ie]={});let Ae=this.availableModels[ie][de];return Ae||(Ae={}),Ae}getLayerIndex(ie,de){this.layerIndexes[ie]||(this.layerIndexes[ie]={});let Ae=this.layerIndexes[ie][de];return Ae||(Ae=this.layerIndexes[ie][de]=new G,Ae.scope=de),Ae}getWorkerSource(ie,de,Ae,ze){const Ee=this.workerSources;return Ee[ie]||(Ee[ie]={}),Ee[ie][ze]||(Ee[ie][ze]={}),Ee[ie][ze][de]||(Ee[ie][ze][de]={}),this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),Ee[ie][ze][de][Ae]||(Ee[ie][ze][de][Ae]=new this.workerSourceTypes[de]({send:(Fe,it,qe,at,Dt,vt)=>this.actor.send(Fe,it,qe,ie,Dt,vt),scheduler:this.actor.scheduler},this.getLayerIndex(ie,ze),this.getAvailableImages(ie,ze),this.getAvailableModels(ie,ze),this.isSpriteLoaded[ie][ze],void 0,this.brightness,this.worldview)),Ee[ie][ze][de][Ae]}rasterizeImagesWorker(ie,de,Ae){const ze=new Map;for(const[Ee,{image:Fe,imageVariant:it}]of de.tasks.entries()){const qe=this.imageRasterizer.rasterize(it,Fe,de.scope,ie);ze.set(Ee,qe)}Ae(void 0,ze)}removeRasterizedImages(ie,de,Ae){this.imageRasterizer.removeImagesFromCacheByIds(de.imageIds,de.scope,ie),Ae()}enforceCacheSizeLimit(ie,de){a.fJ(de)}getWorkerPerformanceMetrics(ie,de,Ae){Ae(void 0,void 0)}}return a.fF(self)&&(self.worker=new yr(self)),yr}),v(["./shared"],function(a){var C="3.18.1";const I={create:"create",load:"load",fullLoad:"fullLoad"},L={mark(p){performance.mark(p)},measure(p,n,u){performance.measure(p,n,u)}};function k(p){const n=p.name.split("?")[0];return a.a(n)&&n.includes("mapbox-gl.js")?"javascript":a.a(n)&&n.includes("mapbox-gl.css")?"css":a.b(n)?"fontRange":a.c(n)?"sprite":a.i(n)?"style":a.d(n)?"tilejson":"other"}var G,q={},Q=(function(){if(G)return q;function p(m){return!n(m)}function n(m){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,S,O=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(O);try{S=new Worker(D),A=!0}catch{A=!1}return S&&S.terminate(),URL.revokeObjectURL(D),A})()?(function(){var A=document.createElement("canvas");A.width=A.height=1;var S=A.getContext("2d");if(!S)return!1;var O=S.getImageData(0,0,1,1);return O&&O.width===A.width})()?(u[x=m&&m.failIfMajorPerformanceCaveat]===void 0&&(u[x]=(function(A){var S,O=(function(D){var F=document.createElement("canvas"),N=Object.create(p.webGLContextAttributes);return N.failIfMajorPerformanceCaveat=D,F.getContext("webgl2",N)})(A);if(!O)return!1;try{S=O.createShader(O.VERTEX_SHADER)}catch{return!1}return!(!S||O.isContextLost())&&(O.shaderSource(S,"void main() {}"),O.compileShader(S),O.getShaderParameter(S,O.COMPILE_STATUS)===!0)})(x)),u[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}G=1,q.supported=p,q.notSupportedReason=n;var u={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},q})();function H(p,n,u){const m=document.createElement(p);return n!=null&&(m.className=n),u&&u.appendChild(m),m}function K(p,n,u){const m=document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(n))m.setAttributeNS(null,x,String(n[x]));return u&&u.appendChild(m),m}const he=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ue=he&&he.userSelect!==void 0?"userSelect":"WebkitUserSelect";let me;function ge(){he&&ue&&(me=he[ue],he[ue]="none")}function se(){he&&ue&&(he[ue]=me)}function fe(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",fe,!0)}function ve(){window.addEventListener("click",fe,!0),window.setTimeout(()=>{window.removeEventListener("click",fe,!0)},0)}function Le(p,n){const u=p.getBoundingClientRect();return Ke(p,u,n)}function Ue(p,n){const u=p.getBoundingClientRect(),m=[];for(let x=0;x<n.length;x++)m.push(Ke(p,u,n[x]));return m}function tt(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function Ke(p,n,u){const m=p.offsetWidth===n.width?1:p.offsetWidth/n.width;return new a.P((u.clientX-n.left)*m,(u.clientY-n.top)*m)}const nt="01",st="NO_ACCESS_TOKEN";class Rt{constructor(n,u,m){this._transformRequestFn=n,this._customAccessToken=u,this._silenceAuthErrors=!!m,this._createSkuToken()}_createSkuToken(){const n=(function(){let u="";for(let m=0;m<10;m++)u+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",nt,u].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,u){return this._transformRequestFn&&this._transformRequestFn(n,u)||{url:n}}normalizeStyleURL(n,u){if(!a.h(n))return n;const m=$e(n);return m.params.push(`sdk=js-${C}`),m.path=`/styles/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||u)}normalizeGlyphsURL(n,u){if(!a.h(n))return n;const m=$e(n);return m.path=`/fonts/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||u)}normalizeModelURL(n,u){if(!a.h(n))return n;const m=$e(n);return m.path=`/models/v1${m.path}`,this._makeAPIURL(m,this._customAccessToken||u)}normalizeSourceURL(n,u,m,x){if(!a.h(n))return n;const A=$e(n);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),m&&A.params.push(`language=${m}`),x&&A.params.push(`worldview=${x}`),this._makeAPIURL(A,this._customAccessToken||u)}normalizeIconsetURL(n,u){const m=$e(n);return a.h(n)?(m.path=`/styles/v1${m.path}/iconset.pbf`,this._makeAPIURL(m,this._customAccessToken||u)):rt(m)}normalizeSpriteURL(n,u,m,x){const A=$e(n);return a.h(n)?(A.path=`/styles/v1${A.path}/sprite${u}${m}`,this._makeAPIURL(A,this._customAccessToken||x)):(A.path+=`${u}${m}`,rt(A))}normalizeTileURL(n,u,m){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!a.h(n))return n;const x=$e(n);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${u||m&&x.authority!=="raster"&&m===512?"@2x":""}${a.k.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${a.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${a.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${a.e.TILE_URL_VERSION}${x.path}`);const A=this._customAccessToken||(function(S){for(const O of S){const D=O.match(/^access_token=(.*)$/);if(D)return D[1]}return null})(x.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,A)}canonicalizeTileURL(n,u){const m=$e(n);if(!m.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!m.path.match(/\.[\w]+$/))return n;let x="mapbox://";m.path.match(/^\/raster\/v1\//)?x+=`raster/${m.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:m.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${m.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${m.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let A=m.params;return u&&(A=A.filter(S=>!S.match(/^access_token=/))),A.length&&(x+=`?${A.join("&")}`),x}canonicalizeTileset(n,u){const m=!!u&&a.h(u),x=[];for(const A of n.tiles||[])a.j(A)?x.push(this.canonicalizeTileURL(A,m)):x.push(A);return x}_makeAPIURL(n,u){const m="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=$e(a.e.API_URL);if(n.protocol=x.protocol,n.authority=x.authority,n.protocol==="http"){const A=n.params.indexOf("secure");A>=0&&n.params.splice(A,1)}if(x.path!=="/"&&(n.path=`${x.path}${n.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return rt(n);if(u=u||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!u)throw new Error(`An API access token is required to use Mapbox GL. ${m}`);if(u[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${m}`)}return n.params=n.params.filter(A=>A.indexOf("access_token")===-1),n.params.push(`access_token=${u||""}`),rt(n)}}const Mt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function $e(p){const n=p.match(Mt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function rt(p){const n=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${n}`}const Ct="mapbox.eventData";function Kt(p){if(!p)return null;const n=p.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(a.l(n[1]))}catch{return null}}class Je{constructor(n){this.type=n,this.anonId=null,this.anonIdTimestamp=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const u=Kt(a.e.ACCESS_TOKEN);let m="";return m=u&&u.u?a.f(u.u):a.e.ACCESS_TOKEN||"",n?`${Ct}.${n}:${m}`:`${Ct}:${m}`}fetchEventData(){const n=a.s("localStorage"),u=this.getStorageKey(),m=this.getStorageKey("uuid"),x=this.getStorageKey("uuidTimestamp");if(n)try{const A=localStorage.getItem(u);A&&(this.eventData=JSON.parse(A));const S=localStorage.getItem(m);S&&(this.anonId=S);const O=localStorage.getItem(x);O&&(this.anonIdTimestamp=Number(O));const D=Date.now()-864e5;(!this.anonIdTimestamp||this.anonIdTimestamp<D)&&this.refreshUUID()}catch{a.w("Unable to read from LocalStorage")}}refreshUUID(){this.anonId=a.u(),this.anonIdTimestamp=Date.now()}saveEventData(){const n=a.s("localStorage"),u=this.getStorageKey(),m=this.getStorageKey("uuid"),x=this.getStorageKey("uuidTimestamp"),A=this.anonId,S=this.anonIdTimestamp;if(n&&A)try{localStorage.setItem(m,A),Object.keys(this.eventData).length>=1&&localStorage.setItem(u,JSON.stringify(this.eventData)),S&&localStorage.setItem(x,S.toString())}catch{a.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,u,m,x){if(!a.e.EVENTS_URL)return;const A=$e(a.e.EVENTS_URL);A.params.push(`access_token=${x||a.e.ACCESS_TOKEN||""}`);const S={event:this.type,created:new Date(n).toISOString()},O=u?Object.assign(S,u):S,D={url:rt(A),headers:{"Content-Type":"text/plain"},body:JSON.stringify([O])};this.pendingRequest=a.p(D,F=>{this.pendingRequest=null,m(F),this.saveEventData(),this.processRequests(x)})}queueRequest(n,u){this.queue.push(n),this.processRequests(u)}}class Ze extends Je{constructor(n){super("metrics"),n&&(this.data=n)}postMetricsEvent(n){if(!a.e.EVENTS_URL||!n&&!a.e.ACCESS_TOKEN)return;this.anonId||this.fetchEventData(),a.v(this.anonId)||this.refreshUUID();const u=Object.assign({},this.data,{sessionId:this.anonId});this.queueRequest({timestamp:Date.now(),payload:u},n)}processRequests(n){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:u,payload:m}=this.queue.shift();this.postEvent(u,m,()=>{},n)}}const gt=new class extends Je{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,n){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some(u=>a.h(u)||a.j(u))&&this.queueRequest(Date.now(),n)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.anonIdTimestamp&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=Kt(a.e.ACCESS_TOKEN),u=n?n.u:a.e.ACCESS_TOKEN;let m=u!==this.eventData.tokenU;a.v(this.anonId)||(this.refreshUUID(),m=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const A=new Date(this.eventData.lastSuccess),S=new Date(x),O=(x-this.eventData.lastSuccess)/864e5;m=m||O>=1||O<-1||A.getDate()!==S.getDate()}else m=!0;m?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:nt,"enabled.telemetry":!1,userId:this.anonId},A=>{A||(this.eventData.lastSuccess=x,this.eventData.tokenU=u)},p):this.processRequests()}},Bt=gt.postTurnstileEvent.bind(gt),ar=new class extends Je{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,n,u,m){this.skuToken=n,this.errorCb=m,a.e.EVENTS_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(st)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||(this.anonId&&this.anonIdTimestamp||this.fetchEventData(),a.v(this.anonId)||this.refreshUUID(),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:nt,skuToken:this.skuToken,userId:this.anonId},m=>{m?this.errorCb(m):n&&(this.success[n]=!0)},p))}remove(){this.errorCb=null}},Er=ar.postMapLoadEvent.bind(ar),jr=new class extends Je{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let n=this.mapInstanceIdMap.get(p);return n||(n=a.u(),this.mapInstanceIdMap.set(p,n)),n}getEventId(p){const n=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,n+1),n}postStyleLoadEvent(p,n){const{map:u,style:m,importedStyles:x}=n;if(!a.e.EVENTS_URL||!p&&!a.e.ACCESS_TOKEN)return;const A=this.getMapInstanceId(u),S={mapInstanceId:A,eventId:this.getEventId(A),style:m};x.length&&(S.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:S},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:u}=this.queue.shift();this.postEvent(n,u,()=>{},p)}},Zr=jr.postStyleLoadEvent.bind(jr),fn=new Ze({attributes:[{name:"maps/js/layer-animations/style-with-appearances"}]}),Xt=fn.postMetricsEvent.bind(fn),Mr=new Ze({attributes:[{name:"maps/js/layer-animations/runtime-appearances"}]}),kr=Mr.postMetricsEvent.bind(Mr),or=new class extends Je{constructor(){super("gljs.performance")}postPerformanceEvent(p,n){a.e.EVENTS_URL&&(p||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:u}=this.queue.shift(),m=(function(x){const A=performance.getEntriesByType("resource"),S=performance.getEntriesByType("mark"),O=(function(W){const ne={};if(W){for(const te in W)if(te!=="other")for(const ae of W[te]){const le=`${te}ResolveRangeMin`,be=`${te}ResolveRangeMax`,xe=`${te}RequestCount`,ye=`${te}RequestCachedCount`;ne[le]=Math.min(ne[le]||1/0,ae.startTime),ne[be]=Math.max(ne[be]||-1/0,ae.responseEnd);const Re=Ce=>{ne[Ce]===void 0&&(ne[Ce]=0),++ne[Ce]};ae.transferSize!==void 0&&ae.transferSize===0&&Re(ye),Re(xe)}}return ne})((function(W,ne){const te={};if(W)for(const ae of W){const le=ne(ae);te[le]===void 0&&(te[le]=[]),te[le].push(ae)}return te})(A,k)),D=window.devicePixelRatio,F=navigator.connection||navigator.mozConnection||navigator.webkitConnection,N=F?F.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},$=(W,ne,te)=>{te!=null&&W.push({name:ne,value:te.toString()})};for(const W in O)$(Z.counters,W,O[W]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&($(Z.counters,"interactionRangeMin",x.interactionRange[0]),$(Z.counters,"interactionRangeMax",x.interactionRange[1])),S)for(const W of Object.values(I)){const ne=S.find(te=>te.name===W);ne&&$(Z.counters,W,ne.startTime)}return $(Z.counters,"visibilityHidden",x.visibilityHidden),$(Z.attributes,"style",(function(W){if(W)for(const ne of W){const te=ne.name.split("?")[0];if(a.i(te)){const ae=te.split("/").slice(-2);if(ae.length===2)return`mapbox://styles/${ae[0]}/${ae[1]}`}}})(A)),$(Z.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),$(Z.attributes,"fogEnabled",x.fogEnabled?"true":"false"),$(Z.attributes,"projection",x.projection),$(Z.attributes,"zoom",x.zoom),$(Z.metadata,"devicePixelRatio",D),$(Z.metadata,"connectionEffectiveType",N),$(Z.metadata,"navigatorUserAgent",navigator.userAgent),$(Z.metadata,"screenWidth",window.screen.width),$(Z.metadata,"screenHeight",window.screen.height),$(Z.metadata,"windowWidth",window.innerWidth),$(Z.metadata,"windowHeight",window.innerHeight),$(Z.metadata,"mapWidth",x.width/D),$(Z.metadata,"mapHeight",x.height/D),$(Z.metadata,"webglRenderer",x.renderer),$(Z.metadata,"webglVendor",x.vendor),$(Z.metadata,"sdkVersion",C),$(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z})(u);for(const x of m.metadata);for(const x of m.counters);for(const x of m.attributes);this.postEvent(n,m,()=>{},p)}},Tr=or.postPerformanceEvent.bind(or),Ur=new class extends Je{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,n,u,m){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const x=$e(a.e.API_URL+a.e.SESSION_PATH);x.params.push(`sku=${n||""}`),x.params.push(`access_token=${m||a.e.ACCESS_TOKEN||""}`);const A={url:rt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(A,S=>{this.pendingRequest=null,u(S),this.saveEventData(),this.processRequests(m)})}getSessionAPI(p,n,u,m){this.skuToken=n,this.errorCb=m,a.e.SESSION_PATH&&a.e.API_URL&&(u||a.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},u):this.errorCb(new Error(st)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:u}=this.queue.shift();n&&this.success[n]||this.getSession(u,this.skuToken,m=>{m?this.errorCb(m):n&&(this.success[n]=!0)},p)}remove(){this.errorCb=null}},zn=Ur.getSessionAPI.bind(Ur),Fn=new Set;function Ut(p,n){n?Fn.add(p):Fn.delete(p)}class _n{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,u){this._updatedSourceCaches[n]=u,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const u=n.scope;this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._updatedLayers[u].add(n.id),this.setDirty()}removeLayer(n){const u=n.scope;this._removedLayers[u]=this._removedLayers[u]||{},this._updatedLayers[u]=this._updatedLayers[u]||new Set,this._removedLayers[u][n.id]=n,this._updatedLayers[u].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const u in this._updatedLayers)n[u]=n[u]||{},n[u].updatedIds=Array.from(this._updatedLayers[u].values());for(const u in this._removedLayers)n[u]=n[u]||{},n[u].removedIds=Object.keys(this._removedLayers[u]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(n){return this._updatedImages[n]?Array.from(this._updatedImages[n].values()):[]}updateImage(n,u){this._updatedImages[u]=this._updatedImages[u]||new Set,this._updatedImages[u].add(a.I.toString(n)),this.setDirty()}resetUpdatedImages(n){this._updatedImages[n]&&this._updatedImages[n].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function ua(p){const{userImage:n}=p;return!!(n&&n.render&&n.render())&&(p.data.replace(new Uint8Array(n.data.buffer)),!0)}class da extends a.E{constructor(n){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=n,n!=="raster"&&a.r()&&(this.imageRasterizerDispatcher=new a.D(a.t(),this,"Image Rasterizer Worker",1))}addScope(n){this.loaded.set(n,!1),this.imageProviders.set(n,new Map),this.images.set(n,new Map),this.updatedImages.set(n,new Set),this.callbackDispatchedThisFrame.set(n,new Set),this.patterns.set(n,new Map),this.atlasImage.set(n,new a.q({width:1,height:1}))}removeScope(n){this.loaded.delete(n),this.imageProviders.delete(n),this.images.delete(n),this.updatedImages.delete(n),this.callbackDispatchedThisFrame.delete(n),this.patterns.delete(n),this.atlasImage.delete(n);const u=this.atlasTexture.get(n);u&&(u.destroy(),this.atlasTexture.delete(n))}addImageProvider(n,u){this.imageProviders.has(u)||this.imageProviders.set(u,new Map),this.imageProviders.get(u).set(n.id,n)}removeImageProvider(n,u){this.imageProviders.has(u)&&this.imageProviders.get(u).delete(n)}getPendingImageProviders(){const n=[];for(const u of this.imageProviders.values())for(const m of u.values())m.hasPendingRequests()&&n.push(m);return n}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new a.x),this._imageRasterizer}isLoaded(){for(const n of this.loaded.keys())if(!this.loaded.get(n))return!1;return!0}setLoaded(n,u){if(this.loaded.get(u)!==n&&(this.loaded.set(u,n),n)){for(const{ids:m,callback:x}of this.requestors)this._notify(m,u,x);this.requestors=[]}}hasImage(n,u){return!!this.getImage(n,u)}getImage(n,u){return this.images.get(u).get(n.toString())}addImage(n,u,m){this._validate(n,m)&&this.images.get(u).set(n.toString(),m)}_validate(n,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.y(new Error(`Image "${n.name}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.y(new Error(`Image "${n.name}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new a.y(new Error(`Image "${n.name}" has invalid "content" value`))),m=!1),m}_validateStretch(n,u){if(!n)return!0;let m=0;for(const x of n){if(x[0]<m||x[1]<x[0]||u<x[1])return!1;m=x[1]}return!0}_validateContent(n,u){return n?n.length!==4||!u.usvg&&(n[0]<0||u.data.width<n[0]||n[1]<0||u.data.height<n[1]||n[2]<0||u.data.width<n[2]||n[3]<0||u.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,u,m){const x=this.images.get(u).get(n.toString());m.version=x.version+1,this.images.get(u).set(n.toString(),m),this.updatedImages.get(u).add(n),this.removeFromImageRasterizerCache(n,u)}clearUpdatedImages(n){this.updatedImages.get(n).clear()}removeFromImageRasterizerCache(n,u){this.spriteFormat!=="raster"&&(a.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:u}):this.imageRasterizer.removeImagesFromCacheByIds([n],u))}removeImage(n,u){const m=this.images.get(u),x=m.get(n.toString());m.delete(n.toString()),this.patterns.get(u).delete(n.toString()),this.removeFromImageRasterizerCache(n,u),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(n){return Array.from(this.images.get(n).keys()).map(u=>a.I.from(u))}getImages(n,u,m){const x=[],A=[],S=this.imageProviders.get(u);for(const N of n){if(!N.iconsetId){x.push(N);continue}const Z=S.get(N.iconsetId);Z&&(this.getImage(N,u)?A.push(N):Z.addPendingRequest(N))}if(x.length===0)return void this._notify(A,u,m);let O=!0;const D=!!this.loaded.get(u),F=this.images.get(u);if(!D)for(const N of x)F.has(N.toString())||(O=!1);D||O?this._notify(x,u,m):this.requestors.push({ids:x,scope:u,callback:m})}rasterizeImages(n,u){const m=new Map,{tasks:x,scope:A}=n;for(const[S,O]of x.entries()){const D=this.getImage(O.id,A);D&&m.set(S,{image:D,imageVariant:O})}this._rasterizeImages(A,m,u)}_rasterizeImages(n,u,m){if(a.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:u,scope:n},m);else{const x=new Map;for(const[A,{image:S,imageVariant:O}]of u.entries())x.set(A,this.imageRasterizer.rasterize(O,S,n,0));m(void 0,x)}}getUpdatedImages(n){return this.updatedImages.get(n)||new Set}_notify(n,u,m){const x=this.images.get(u),A=new Map;for(const S of n){if(!x.get(S.toString())){if(S.iconsetId)continue;this.fire(new a.z("styleimagemissing",{id:S.name}))}const O=x.get(S.toString());if(!O){a.w(`Image "${S.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const D={data:O.usvg?null:O.data.clone(),pixelRatio:O.pixelRatio,sdf:O.sdf,usvg:O.usvg,version:O.version,stretchX:O.stretchX,stretchY:O.stretchY,content:O.content,hasRenderCallback:!!(O.userImage&&O.userImage.render)};O.usvg&&Object.assign(D,{width:O.icon.usvg_tree.width,height:O.icon.usvg_tree.height}),A.set(a.I.toString(S),D)}m(null,A)}getPixelSize(n){const{width:u,height:m}=this.atlasImage.get(n);return{width:u,height:m}}getPattern(n,u,m){const x=n.toString(),A=this.patterns.get(u),S=A.get(x),O=this.getImage(n,u);if(!O)return null;if(S){if(S.position.version===O.version)return S.position;S.position.version=O.version}else{if(O.usvg&&!O.data){const D=this.getPatternInFlightId(x,u);if(this.patternsInFlight.has(D))return null;this.patternsInFlight.add(D);const F=new a.A(n).scaleSelf(a.o.devicePixelRatio),N=new Map([[F.toString(),{image:O,imageVariant:F}]]);return this._rasterizeImages(u,N,(Z,$)=>this.storePatternImage(F,u,O,m,$)),null}this.storePattern(n,u,O)}return this._updatePatternAtlas(u,m),A.get(x).position}getPatternInFlightId(n,u){return a.B(n,u)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(n,u,m,x,A){const S=n.toString(),O=A?A.get(S):void 0;O&&(m.data=O,this.storePattern(n.id,u,m),this._updatePatternAtlas(u,x),this.patternsInFlight.delete(this.getPatternInFlightId(n.id.toString(),u)))}storePattern(n,u,m){const x={w:m.data.width+2*a.C,h:m.data.height+2*a.C,x:0,y:0},A=new a.F(x,m,a.C);this.patterns.get(u).set(n.toString(),{bin:x,position:A})}destroyAtlasTextures(){for(const n of this.atlasTexture.values())n&&n.destroy();this.atlasTexture.clear()}bind(n,u){const m=n.gl;let x=this.atlasTexture.get(u);x?this.dirty&&(x.update(this.atlasImage.get(u)),this.dirty=!1):(x=new a.T(n,this.atlasImage.get(u),m.RGBA8),this.atlasTexture.set(u,x)),x.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(n,u){const m=this.patterns.get(n),x=Array.from(m.values()).map(({bin:F})=>F),{w:A,h:S}=a.G(x),O=this.atlasImage.get(n);O.resize({width:A||1,height:S||1});const D=this.images.get(n);for(const[F,{bin:N,position:Z}]of m.entries()){let $=Z.padding;const W=N.x+$,ne=N.y+$,te=D.get(F).data,ae=te.width,le=te.height;$=$>1?$-1:$,a.q.copy(te,O,{x:0,y:0},{x:W,y:ne},{width:ae,height:le},u),a.q.copy(te,O,{x:0,y:le-$},{x:W,y:ne-$},{width:ae,height:$},u),a.q.copy(te,O,{x:0,y:0},{x:W,y:ne+le},{width:ae,height:$},u),a.q.copy(te,O,{x:ae-$,y:0},{x:W-$,y:ne},{width:$,height:le},u),a.q.copy(te,O,{x:0,y:0},{x:W+ae,y:ne},{width:$,height:le},u),a.q.copy(te,O,{x:ae-$,y:le-$},{x:W-$,y:ne-$},{width:$,height:$},u),a.q.copy(te,O,{x:0,y:le-$},{x:W+ae,y:ne-$},{width:$,height:$},u),a.q.copy(te,O,{x:0,y:0},{x:W+ae,y:ne+le},{width:$,height:$},u),a.q.copy(te,O,{x:ae-$,y:0},{x:W-$,y:ne+le},{width:$,height:$},u)}this.dirty=!0}beginFrame(){for(const n of this.images.keys())this.callbackDispatchedThisFrame.set(n,new Set)}dispatchRenderCallbacks(n,u){const m=this.images.get(u);for(const x of n){if(this.callbackDispatchedThisFrame.get(u).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(u).add(x.toString());const A=m.get(x.toString());ua(A)&&this.updateImage(x,u,A)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function Yn(p){const n=p.value,u=p.valueSpec,m=p.style,x=p.styleSpec,A=p.key,S=p.arrayElementValidator||pn;if(!Array.isArray(n))return[new a.V(A,n,`array expected, ${a.K(n)} found`)];if(u.length&&n.length!==u.length)return[new a.V(A,n,`array length ${u.length} expected, length ${n.length} found`)];if(u["min-length"]&&n.length<u["min-length"])return[new a.V(A,n,`array length at least ${u["min-length"]} expected, length ${n.length} found`)];let O={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};x.$version<7&&(O.function=u.function),a.H(u.value)&&(O=u.value);let D=[];for(let F=0;F<n.length;F++)D=D.concat(S({array:n,arrayIndex:F,value:n[F],valueSpec:O,style:m,styleSpec:x,key:`${A}[${F}]`},!0));return D}function ha(p){const n=p.key,u=p.value,m=p.valueSpec;if(!a.L(u))return[new a.V(n,u,`number expected, ${a.K(u)} found`)];if(u!=u)return[new a.V(n,u,"number expected, NaN found")];if("minimum"in m){let x=m.minimum;if(Array.isArray(m.minimum)&&(x=m.minimum[p.arrayIndex]),u<x)return[new a.V(n,u,`${u} is less than the minimum value ${x}`)]}if("maximum"in m){let x=m.maximum;if(Array.isArray(m.maximum)&&(x=m.maximum[p.arrayIndex]),u>x)return[new a.V(n,u,`${u} is greater than the maximum value ${x}`)]}return[]}function go(p){const n=p.key,u=p.value;if(!a.H(u))return[new a.V(n,u,`object expected, ${a.K(u)} found`)];const m=p.valueSpec,x=a.J(u.type);let A,S,O,D={};const F=x!=="categorical"&&u.property===void 0,N=!F,Z=(function(te){const ae=te.stops;return Array.isArray(ae)&&Array.isArray(ae[0])&&a.H(ae[0][0])})(u),$=Bi({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(te){if(x==="identity")return[new a.V(te.key,te.value,'identity function may not have a "stops" property')];let ae=[];const le=te.value;return ae=ae.concat(Yn({key:te.key,value:le,valueSpec:te.valueSpec,style:te.style,styleSpec:te.styleSpec,arrayElementValidator:W})),Array.isArray(le)&&le.length===0&&ae.push(new a.V(te.key,le,"array must have at least one stop")),ae},default:function(te){return pn({key:te.key,value:te.value,valueSpec:m,style:te.style,styleSpec:te.styleSpec})}}});return x==="identity"&&F&&$.push(new a.V(p.key,p.value,'missing required property "property"')),x==="identity"||u.stops||$.push(new a.V(p.key,p.value,'missing required property "stops"')),x==="exponential"&&m.expression&&!a.M(m)&&$.push(new a.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(N&&!a.N(m)?$.push(new a.V(p.key,p.value,"property functions not supported")):F&&!a.O(m)&&$.push(new a.V(p.key,p.value,"zoom functions not supported"))),x!=="categorical"&&!Z||u.property!==void 0||$.push(new a.V(p.key,p.value,'"property" property is required')),$;function W(te){let ae=[];const le=te.value,be=te.key;if(!Array.isArray(le))return[new a.V(be,le,`array expected, ${a.K(le)} found`)];if(le.length!==2)return[new a.V(be,le,`array length 2 expected, length ${le.length} found`)];if(Z){if(!a.H(le[0]))return[new a.V(be,le,`object expected, ${a.K(le[0])} found`)];const xe=le[0];if(xe.zoom===void 0)return[new a.V(be,le,"object stop key must have zoom")];if(xe.value===void 0)return[new a.V(be,le,"object stop key must have value")];const ye=a.J(xe.zoom);if(typeof ye!="number")return[new a.V(be,xe.zoom,"stop zoom values must be numbers")];if(O&&O>ye)return[new a.V(be,xe.zoom,"stop zoom values must appear in ascending order")];ye!==O&&(O=ye,S=void 0,D={}),ae=ae.concat(Bi({key:`${be}[0]`,value:le[0],valueSpec:{zoom:{}},style:te.style,styleSpec:te.styleSpec,objectElementValidators:{zoom:ha,value:ne}}))}else ae=ae.concat(ne({key:`${be}[0]`,value:le[0],style:te.style,styleSpec:te.styleSpec},le));return a.Q(a.S(le[1]))?ae.concat([new a.V(`${be}[1]`,le[1],"expressions are not allowed in function stops.")]):ae.concat(pn({key:`${be}[1]`,value:le[1],valueSpec:m,style:te.style,styleSpec:te.styleSpec}))}function ne(te,ae){const le=a.K(te.value),be=a.J(te.value),xe=te.value!==null?te.value:ae;if(A){if(le!==A)return[new a.V(te.key,xe,`${le} stop domain type must match previous stop domain type ${A}`)]}else A=le;if(le!=="number"&&le!=="string"&&le!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new a.V(te.key,xe,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&x!=="categorical"){let ye=`number expected, ${le} found`;return a.N(m)&&x===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(te.key,xe,ye)]}return x!=="categorical"||le!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?x!=="categorical"&&le==="number"&&typeof be=="number"&&typeof S=="number"&&S!==void 0&&be<S?[new a.V(te.key,xe,"stop domain values must appear in ascending order")]:(S=be,x==="categorical"&&be in D?[new a.V(te.key,xe,"stop domain values must be unique")]:(D[be]=!0,[])):[new a.V(te.key,xe,`integer expected, found ${String(be)}`)]}}function ni(p){const n=(p.expressionContext==="property"?a.W:a.U)(a.S(p.value),p.valueSpec);if(n.result==="error")return n.value.map(m=>new a.V(`${p.key}${m.key}`,p.value,m.message));const u=n.value.expression||n.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!u.outputDefined())return[new a.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!a.Z(u))return[new a.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return ii(u,p);if(p.expressionContext==="appearance")return no(u,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!a.X(u,["zoom","feature-state"]))return[new a.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!a.Y(u))return[new a.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ii(p,n){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const x of n.valueSpec.expression.parameters)u.delete(x);if(u.size===0)return[];const m=[];return p instanceof a._&&u.has(p.name)?[new a.V(n.key,n.value,`["${p.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(p.eachChild(x=>{m.push(...ii(x,n))}),m)}function no(p,n){const u=new Set;if(n.valueSpec&&n.valueSpec.expression)for(const x of n.valueSpec.expression.parameters)u.add(x);if(u.size===0)return[];const m=[];return p instanceof a._&&!u.has(p.name)?[new a.V(n.key,n.value,`["${p.name}"] is not an allowed parameter`)]:(p.eachChild(x=>{m.push(...no(x,n))}),m)}function Ai(p){const n=p.key,u=p.value,m=p.valueSpec,x=[];return Array.isArray(m.values)?m.values.indexOf(a.J(u))===-1&&x.push(new a.V(n,u,`expected one of [${m.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(m.values).indexOf(a.J(u))===-1&&x.push(new a.V(n,u,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(u)} found`)),x}function ga(p){return a.a2(a.S(p.value))?ni(Object.assign({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Ha(p)}function Ha(p){const n=p.value,u=p.key;if(!Array.isArray(n))return[new a.V(u,n,`array expected, ${a.K(n)} found`)];if(n.length<1)return[new a.V(u,n,"filter array must have at least 1 element")];const m=p.styleSpec;let x=Ai({key:`${u}[0]`,value:n[0],valueSpec:m.filter_operator});const A=()=>{n.length>=2&&(a.a0(n[1])||x.push(new a.V(`${u}[1]`,n[1],`string expected, ${a.K(n[1])} found`)));for(let S=2;S<n.length;S++)a.J(n[1])==="$type"?x=x.concat(Ai({key:`${u}[${S}]`,value:n[S],valueSpec:m.geometry_type})):a.a0(n[S])||a.L(n[S])||a.$(n[S])||x.push(new a.V(`${u}[${S}]`,n[S],`string, number, or boolean expected, ${a.K(n[S])} found.`))};switch(a.J(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&a.J(n[1])==="$type"&&x.push(new a.V(u,n,`"$type" cannot be use with operator "${n[0]}"`)),n.length!==3&&x.push(new a.V(u,n,`filter array for operator "${n[0]}" must have 3 elements`)),A();break;case"==":case"!=":n.length!==3&&x.push(new a.V(u,n,`filter array for operator "${n[0]}" must have 3 elements`)),A();break;case"in":case"!in":A();break;case"any":case"all":case"none":for(let S=1;S<n.length;S++)x=x.concat(Ha({key:`${u}[${S}]`,value:n[S],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":n.length!==2?x.push(new a.V(u,n,`filter array for "${n[0]}" operator must have 2 elements`)):a.a0(n[1])||x.push(new a.V(`${u}[1]`,n[1],`string expected, ${a.K(n[1])} found`))}return x}function Zi(p,n){const u=p.key,m=p.style,x=p.layer,A=p.styleSpec,S=p.value,O=p.objectKey,D=A[`${n}_${p.layerType}`];if(!D)return[];const F=O.match(/^(.*)-use-theme$/);if(F&&D[F[1]])return a.Q(a.S(S))?[].concat(pn({key:u,value:S,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:m,styleSpec:A,expressionContext:"property",propertyType:n,propertyKey:O})):pn({key:u,value:S,valueSpec:{type:"string"},style:m,styleSpec:A});const N=O.match(/^(.*)-transition$/);if(n==="paint"&&N&&D[N[1]]&&D[N[1]].transition)return pn({key:u,value:S,valueSpec:A.transition,style:m,styleSpec:A});const Z=p.valueSpec||D[O];if(!Z)return[new a.a3(u,S,`unknown property "${O}"`)];let $;if(a.a0(S)&&a.N(Z)&&!Z.tokens&&($=/^{([^}]+)}$/.exec(S))){const ne=`\`{ "type": "identity", "property": ${$?JSON.stringify($[1]):'"_"'} }\``;return[new a.V(u,S,`"${O}" does not support interpolation syntax
Use an identity property function instead: ${ne}.`)]}const W=[];if(p.layerType==="symbol")O!=="text-field"||!m||m.glyphs||m.imports||W.push(new a.V(u,S,'use of "text-field" requires a style "glyphs" property')),O==="text-font"&&a.a4(a.S(S))&&a.J(S.type)==="identity"&&W.push(new a.V(u,S,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&n==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&a.N(Z)&&(a.a5(Z)||a.O(Z))){const ne=a.W(a.S(S),Z).value,te="expression"in ne&&ne.expression||"_styleExpression"in ne&&ne._styleExpression&&ne._styleExpression.expression;te&&!a.X(te,["measure-light"])&&(O==="model-emissive-strength"&&a.Y(te)&&a.Z(te)||W.push(new a.V(u,S,`${O} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return W.concat(pn({key:p.key,value:S,valueSpec:Z,style:m,styleSpec:A,expressionContext:"property",propertyType:n,propertyKey:O}))}function cl(p){return Zi(p,"paint")}function fi(p){return Zi(p,"layout")}function Cs(p){let n=[];const u=p.value,m=p.key,x=p.style,A=p.styleSpec;if(!a.H(u))return[new a.V(m,u,"object expected")];u.type||u.ref||n.push(new a.V(m,u,'either "type" or "ref" is required'));let S=a.J(u.type);const O=a.J(u.ref);if(u.id){const D=a.J(u.id);for(let F=0;F<p.arrayIndex;F++){const N=x.layers[F];a.J(N.id)===D&&n.push(new a.V(m,u.id,`duplicate layer id "${D}", previously used at line ${N.id.__line__}`))}}if("ref"in u){let D;["type","source","source-layer","filter","layout"].forEach(F=>{F in u&&n.push(new a.V(m,u[F],`"${F}" is prohibited for ref layers`))}),x.layers.forEach(F=>{a.J(F.id)===O&&(D=F)}),D?D.ref?n.push(new a.V(m,u.ref,"ref cannot reference another ref layer")):S=a.J(D.type):typeof O=="string"&&n.push(new a.V(m,u.ref,`ref layer "${O}" not found`))}else if(S!=="background"&&S!=="sky"&&S!=="slot")if(u.source)if(a.a0(u.source)){const D=x.sources&&x.sources[u.source],F=D&&a.J(D.type);D?F==="vector"&&S==="raster"?n.push(new a.V(m,u.source,`layer "${u.id}" requires a raster source`)):F==="raster"&&S!=="raster"?n.push(new a.V(m,u.source,`layer "${u.id}" requires a vector source`)):F!=="vector"||u["source-layer"]?F==="raster-dem"&&S!=="hillshade"?n.push(new a.V(m,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):F!=="raster-array"||["raster","raster-particle"].includes(S)?S==="line"&&u.paint&&(u.paint["line-gradient"]||u.paint["line-trim-offset"])&&F==="geojson"&&!D.lineMetrics?n.push(new a.V(m,u,`layer "${u.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):S==="raster-particle"&&F!=="raster-array"&&n.push(new a.V(m,u.source,`layer "${u.id}" requires a 'raster-array' source.`)):n.push(new a.V(m,u.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new a.V(m,u,`layer "${u.id}" must specify a "source-layer"`)):n.push(new a.V(m,u.source,`source "${u.source}" not found`))}else n.push(new a.V(`${m}.source`,u.source,'"source" must be a string'));else n.push(new a.V(m,u,'missing required property "source"'));return n=n.concat(Bi({key:m,value:u,valueSpec:A.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>pn({key:`${m}.type`,value:u.type,valueSpec:A.layer.type,style:p.style,styleSpec:p.styleSpec,object:u,objectKey:"type"}),filter:D=>ga(Object.assign({layerType:S},D)),layout:D=>Bi({layer:u,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":F=>fi(Object.assign({layerType:S},F))}}),paint:D=>Bi({layer:u,key:D.key,value:D.value,valueSpec:{},style:D.style,styleSpec:D.styleSpec,objectElementValidators:{"*":F=>cl(Object.assign({layerType:S,layer:u},F))}}),appearances(D){const F=Yn({key:D.key,value:D.value,valueSpec:D.valueSpec,style:D.style,styleSpec:D.styleSpec,arrayElementValidator:$=>(function(W){const{key:ne,layer:te,layerType:ae}=W,le=a.J(W.value),be=a.J(le.name),xe=a.J(le.condition),ye=Bi({key:ne,value:le,valueSpec:W.styleSpec.appearance,style:W.style,styleSpec:W.styleSpec,objectElementValidators:{condition:Re=>(function(Ce){const De=[];return De.push(...ni({key:Ce.key,value:Ce.object.condition,valueSpec:a.a6.appearance.condition,expressionContext:"appearance"})),De})(Object.assign({layer:te,layerType:ae},Re)),properties:Re=>(function(Ce){const De=[],{styleSpec:Me,layer:Te,layerType:Ne}=Ce,Ve=Me[`paint_${Ne}`],He=Me[`layout_${Ne}`],Qe=Ce.object[Ce.objectKey];for(const We in Qe){const ut=We in Ve?"paint":We in He?"layout":void 0;if(!ut){De.push(new a.V(Ce.key,We,`unknown property "${We}" for layer type "${Ne}"`));continue}const wt=Object.assign({},Ce,{key:`${Ce.key}.${We}`,object:Qe,objectKey:We,layer:Te,layerType:Ne,value:Qe[We],valueSpec:ut==="paint"?Ve[We]:He[We]});De.push(...Zi(wt,ut))}return De})(Object.assign({layer:te,layerType:ae},Re))}});return be!=="hidden"&&xe===void 0&&ye.push(new a.V(W.key,"name",'Appearance with name different than "hidden" must have a condition')),ye})(Object.assign({layerType:S,layer:u},$))}),N=Array.isArray(D.value)?D.value:[],Z=new Set;return N.forEach(($,W)=>{const ne=a.J($.name);if(ne)if(Z.has(ne)){const te=a.J(u.id);F.push(new a.V(D.key,ne,`Duplicated appearance name "${ne}" for layer "${te}"`))}else Z.add(ne)}),F}}})),n}function Ci({key:p,value:n}){return a.a0(n)?[]:[new a.V(p,n,`string expected, ${a.K(n)} found`)]}const Ti={promoteId:function p({key:n,value:u}){if(a.a0(u))return Ci({key:n,value:u});if(Array.isArray(u)){const x=[],A=a.S(u),S=a.U(A);return S.result==="error"&&S.value.forEach(O=>{x.push(new a.V(`${n}${O.key}`,null,`${O.message}`))}),a.X(S.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||x.push(new a.V(`${n}`,null,"promoteId expression should be only feature dependent")),x}if(!a.H(u))return[new a.V(n,u,`string, expression or object expected, "${a.K(u)}" found`)];const m=[];for(const x in u)m.push(...p({key:`${n}.${x}`,value:u[x]}));return m}};function qi(p){const n=p.value,u=p.key,m=p.styleSpec,x=p.style;if(!a.H(n))return[new a.V(u,n,`object expected, ${a.K(n)} found`)];if(!("type"in n))return[new a.V(u,n,'"type" is required')];const A=a.J(n.type);let S=[];switch(["vector","raster","raster-dem","raster-array"].includes(A)&&("url"in n||"tiles"in n||S.push(new a.a3(u,n,'Either "url" or "tiles" is required.'))),A){case"vector":case"raster":case"raster-dem":case"raster-array":return S=S.concat(Bi({key:u,value:n,valueSpec:m[`source_${A.replace("-","_")}`],style:p.style,styleSpec:m,objectElementValidators:Ti})),S;case"geojson":if(S=Bi({key:u,value:n,valueSpec:m.source_geojson,style:x,styleSpec:m,objectElementValidators:Ti}),"cluster"in n&&"clusterProperties"in n){if(!a.H(n.clusterProperties))return[new a.V(`${u}.clusterProperties`,n,`object expected, ${a.K(n)} found`)];for(const O in n.clusterProperties){const D=n.clusterProperties[O];if(!Array.isArray(D))return[new a.V(`${u}.clusterProperties.${O}`,D,"array expected")];const[F,N]=D,Z=typeof F=="string"?[F,["accumulated"],["get",O]]:F;S.push(...ni({key:`${u}.${O}.map`,value:N,expressionContext:"cluster-map"})),S.push(...ni({key:`${u}.${O}.reduce`,value:Z,expressionContext:"cluster-reduce"}))}}return S;case"video":return Bi({key:u,value:n,valueSpec:m.source_video,style:x,styleSpec:m});case"image":return Bi({key:u,value:n,valueSpec:m.source_image,style:x,styleSpec:m});case"canvas":return[new a.V(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ai({key:`${u}.type`,value:n.type,valueSpec:{values:_o(m)}})}}function _o(p){return p.source.reduce((n,u)=>{const m=p[u];return m.type.type==="enum"&&(n=n.concat(Object.keys(m.type.values||{}))),n},[])}function $o(p){const n=p.value,u=p.styleSpec,m=u.light,x=p.style;if(n===void 0)return[];if(!a.H(n))return[new a.V("light",n,`object expected, ${a.K(n)} found`)];let A=[];for(const S in n){const O=S.match(/^(.*)-transition$/),D=S.match(/^(.*)-use-theme$/);A=A.concat(D&&m[D[1]]?pn({key:S,value:n[S],valueSpec:{type:"string"},style:x,styleSpec:u}):O&&m[O[1]]&&m[O[1]].transition?pn({key:S,value:n[S],valueSpec:u.transition,style:x,styleSpec:u}):m[S]?pn({key:S,value:n[S],valueSpec:m[S],style:x,styleSpec:u}):[new a.V(S,n[S],`unknown property "${S}"`)])}return A}function Mn(p){const n=p.value;if(!n)return[];const u=p.key;if(!a.H(n))return[new a.V(u,n,`object expected, ${a.K(n)} found`)];let m=[];const x=p.styleSpec,A=x["light-3d"],S=p.style,O=p.style.lights;for(const N of["type","id"])if(!(N in n))return m=m.concat([new a.V(u,n,`missing property "${N}"`)]),m;if(!a.a0(n.type))return m=m.concat([new a.V(`${u}.type`,n.type,"string expected")]),m;if(O)for(let N=0;N<p.arrayIndex;N++){const Z=a.J(n.type),$=O[N];a.J($.type)===Z&&m.push(new a.V(u,n.id,`duplicate light type "${n.type}", previously defined at line ${$.id.__line__}`))}const D=`properties_light_${n.type}`;if(!(D in x))return m=m.concat([new a.V(`${u}.type`,n,`Invalid light type ${n.type}`)]),m;const F=x[D];for(const N in n)if(N==="properties"){const Z=n[N];if(!a.H(Z))return m=m.concat([new a.V("properties",Z,`object expected, ${a.K(Z)} found`)]),m;for(const $ in Z){const W=$.match(/^(.*)-transition$/),ne=$.match(/^(.*)-use-theme$/);m=m.concat(ne&&F[ne[1]]?pn({key:N,value:Z[$],valueSpec:{type:"string"},style:S,styleSpec:x}):W&&F[W[1]]&&F[W[1]].transition?pn({key:N,value:n[N],valueSpec:x.transition,style:S,styleSpec:x}):F[$]?pn({key:$,value:Z[$],valueSpec:F[$],style:S,styleSpec:x}):[new a.a3(p.key,Z[$],`unknown property "${$}"`)])}}else m=m.concat(A[N]?pn({key:N,value:n[N],valueSpec:A[N],style:S,styleSpec:x}):[new a.a3(N,n[N],`unknown property "${N}"`)]);return m}function io(p){const n=p.value,u=p.key,m=p.style,x=p.styleSpec,A=x.terrain;if(n==null)return[];if(!a.H(n))return[new a.V("terrain",n,`object expected, ${a.K(n)} found`)];let S=[];for(const O in n){const D=O.match(/^(.*)-transition$/),F=O.match(/^(.*)-use-theme$/);S=S.concat(F&&A[F[1]]?pn({key:O,value:n[O],valueSpec:{type:"string"},style:m,styleSpec:x}):D&&A[D[1]]&&A[D[1]].transition?pn({key:O,value:n[O],valueSpec:x.transition,style:m,styleSpec:x}):A[O]?pn({key:O,value:n[O],valueSpec:A[O],style:m,styleSpec:x}):[new a.a3(O,n[O],`unknown property "${O}"`)])}if(n.source)if(a.a0(n.source)){const O=m.sources&&m.sources[n.source],D=O&&a.J(O.type);O?D!=="raster-dem"&&S.push(new a.V(`${u}.source`,n.source,`terrain cannot be used with a source of type ${D}, it only be used with a "raster-dem" source type`)):S.push(new a.V(`${u}.source`,n.source,`source "${n.source}" not found`))}else S.push(new a.V(`${u}.source`,n.source,"source must be a string"));else S.push(new a.V(u,n,'terrain is missing required property "source"'));return S}function _a(p){const n=p.value,u=p.style,m=p.styleSpec,x=m.fog;if(n===void 0)return[];if(!a.H(n))return[new a.V("fog",n,`object expected, ${a.K(n)} found`)];let A=[];for(const S in n){const O=S.match(/^(.*)-transition$/),D=S.match(/^(.*)-use-theme$/);A=A.concat(D&&x[D[1]]?pn({key:S,value:n[S],valueSpec:{type:"string"},style:u,styleSpec:m}):O&&x[O[1]]&&x[O[1]].transition?pn({key:S,value:n[S],valueSpec:m.transition,style:u,styleSpec:m}):x[S]?pn({key:S,value:n[S],valueSpec:x[S],style:u,styleSpec:m}):[new a.a3(S,n[S],`unknown property "${S}"`)])}return A}const La={"*":()=>[],array:Yn,boolean:function(p){const n=p.value,u=p.key;return a.$(n)?[]:[new a.V(u,n,`boolean expected, ${a.K(n)} found`)]},number:ha,color:function({key:p,value:n}){return a.a0(n)?a.a1.parseCSSColor(n)===null?[new a.V(p,n,`color expected, "${n}" found`)]:[]:[new a.V(p,n,`color expected, ${a.K(n)} found`)]},enum:Ai,filter:ga,function:go,layer:Cs,object:Bi,source:qi,model:a.a7,light:$o,"light-3d":Mn,terrain:io,fog:_a,string:Ci,formatted:function(p){return Ci(p).length===0?[]:ni(p)},resolvedImage:function(p){return Ci(p).length===0?[]:ni(p)},projection:function(p){const n=p.value,u=p.styleSpec,m=u.projection,x=p.style;if(a.H(n)){let A=[];for(const S in n)A=A.concat(pn({key:S,value:n[S],valueSpec:m[S],style:x,styleSpec:u}));return A}return a.a0(n)?[]:[new a.V("projection",n,`object or string expected, ${a.K(n)} found`)]},import:function(p){const n=p.key,{value:u,styleSpec:m}=p;if(!a.H(u))return[new a.V(n,u,"import must be an object")];const{data:x,...A}=u;Object.defineProperty(A,"__line__",{value:u.__line__,enumerable:!1});let S=Bi(Object.assign({},p,{value:A,valueSpec:m.import}));return a.J(A.id)===""&&S.push(new a.V(`${p.key}.id`,A,"import id can't be an empty string")),x&&(S=S.concat(qo(x,m,{key:`${p.key}.data`}))),S},iconset:function(p){const n=p.value,u=p.key,m=p.styleSpec,x=p.style;if(!a.H(n))return[new a.V(u,n,"object expected")];if(!n.type)return[new a.V(u,n,'"type" is required')];const A=a.J(n.type);let S=[];if(S=S.concat(Bi({key:u,value:n,valueSpec:m[`iconset_${A}`],style:x,styleSpec:m})),(function(O,D){return!(O!=="source"||!D.source)})(A,n)){const O=x.sources&&x.sources[n.source],D=O&&a.J(O.type);O?D!=="raster-array"&&S.push(new a.V(u,n.source,`iconset cannot be used with a source of type ${String(D)}, it only be used with a "raster-array" source type`)):S.push(new a.V(u,n.source,`source "${n.source}" not found`))}return S}};function pn(p,n=!1){const u=p.value,m=p.valueSpec,x=p.styleSpec;if(m.expression){if(a.a4(a.J(u)))return go(p);if(a.Q(a.S(u)))return ni(p)}if(m.type&&La[m.type]){const A=La[m.type](p);return n===!0&&A.length>0&&Array.isArray(p.value)?ni(p):A}return Bi(Object.assign({},p,{valueSpec:m.type?x[m.type]:m}))}function Bi(p){const n=p.key,u=p.value,m=p.valueSpec||{},x=p.objectElementValidators||{},A=p.style,S=p.styleSpec;if(!a.H(u))return[new a.V(n,u,`object expected, ${a.K(u)} found`)];let O=[];for(const D in u){const F=D.split(".")[0];let N;x[F]?N=x[F]:m[F]?N=pn:x["*"]?N=x["*"]:m["*"]&&(N=pn),N?O=O.concat(N({key:(n&&`${n}.`)+D,value:u[D],valueSpec:m[F]||m["*"],style:A,styleSpec:S,object:u,objectKey:D},u)):O.push(new a.a3(n,u[D],`unknown property "${D}"`))}for(const D in m){if(x[D])continue;const F=m[D];F.required&&F.default===void 0&&u[D]===void 0&&O.push(new a.V(n,u,`missing required property "${D}"`))}return O}function as({key:p,value:n}){const u=Ci({key:p,value:n});if(u.length)return u;const m=n;return m.indexOf("{fontstack}")===-1&&u.push(new a.V(p,n,'"glyphs" url must include a "{fontstack}" token')),m.indexOf("{range}")===-1&&u.push(new a.V(p,n,'"glyphs" url must include a "{range}" token')),u}function qo(p,n=a.a6,u={}){return Bi({key:u.key||"",value:p,valueSpec:Object.assign(n.$root,{"*":{type:"*"}}),styleSpec:n,style:p,objectElementValidators:{glyphs:as}})}function Xa(p,n=a.a6){return Ee(qo(p,n))}const Tn=p=>Ee(qi(p)),Jr=p=>Ee($o(p)),yt=p=>Ee(Mn(p)),Or=p=>Ee(io(p)),Sn=p=>Ee(_a(p)),an=p=>Ee((function(n){const u=n.value,m=n.style,x=n.styleSpec,A=x.snow;if(u===void 0)return[];if(!a.H(u))return[new a.V("snow",u,`object expected, ${a.K(u)} found`)];let S=[];for(const O in u){const D=O.match(/^(.*)-transition$/);S=S.concat(D&&A[D[1]]&&A[D[1]].transition?pn({key:O,value:u[O],valueSpec:x.transition,style:m,styleSpec:x}):A[O]?pn({key:O,value:u[O],valueSpec:A[O],style:m,styleSpec:x}):[new a.a3(O,u[O],`unknown property "${O}"`)])}return S})(p)),yr=p=>Ee((function(n){const u=n.value,m=n.style,x=n.styleSpec,A=x.rain;if(u===void 0)return[];if(!a.H(u))return[new a.V("rain",u,`object expected, ${a.K(u)} found`)];let S=[];for(const O in u){const D=O.match(/^(.*)-transition$/);S=S.concat(D&&A[D[1]]&&A[D[1]].transition?pn({key:O,value:u[O],valueSpec:x.transition,style:m,styleSpec:x}):A[O]?pn({key:O,value:u[O],valueSpec:A[O],style:m,styleSpec:x}):[new a.a3(O,u[O],`unknown property "${O}"`)])}return S})(p)),Xe=p=>Ee(Cs(p)),ie=p=>Ee(ga(p)),de=p=>Ee(cl(p)),Ae=p=>Ee(fi(p)),ze=p=>Ee(a.a7(p));function Ee(p){return p.slice().sort((n,u)=>n.line&&u.line?n.line-u.line:0)}function Fe(p,n){let u=!1;if(n&&n.length)for(const m of n)m instanceof a.a3?a.w(m.message):(p.fire(new a.y(new Error(m.message))),u=!0);return u}const it=a.a6.light;let qe;class at extends a.E{constructor(n,u="flat"){super(),this._transitionable=new a.a8(qe||(qe=new a.a9({anchor:new a.aa(it.anchor),position:new a.ab(it.position),color:new a.aa(it.color),intensity:new a.aa(it.intensity)}))),this.setLight(n,u),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u,m={}){this._validate(Jr,n,m)||(this._transitionable.setTransitionOrValue(n),this.id=u)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,m){return(!m||m.validate!==!1)&&Fe(this,n.call(Xa,Object.assign({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a6})))}}const Dt=a.a6.terrain;let vt=class extends a.E{constructor(p,n,u,m,x){super(),this.scope=u,this._transitionable=new a.a8(new a.a9({source:new a.aa(Dt.source),exaggeration:new a.aa(Dt.exaggeration)}),u,m),this._transitionable.setTransitionOrValue(p,m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n,this.worldview=x}get(){return this._transitionable.serialize()}set(p,n){this._transitionable.setTransitionOrValue(p,n)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new a.ac(p,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const n=p.value.expression;if(!n)return null;let u=-1,m=-1,x=1;for(const A of n.zoomStops)x=n.evaluate(new a.ac(A,{worldview:this.worldview})),x>.01?(u=A,m=-1):m=A;return x<.01&&u>0&&m>u?[u,m]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof a.ad}};const Wt=.05;function dr(p,n,u,m){const x=a.ah(45,65,u),[A,S]=vr(p,m);let O=1-Math.min(1,Math.exp((n-A)/(S-A)*-6));return O*=O*O,O=Math.min(1,1.00747*O),O*x*p.alpha}function vr(p,n){const u=.5/Math.tan(.5*n);return[p.range[0]+u,p.range[1]+u]}function Br(p,n,u,m,x){const A=a.af([],[n,u,m],x.mercatorFogMatrix);return dr(p,a.ag(A),x.pitch,x._fov)}function Sr(p,n,u,m,x,A,S){const O=[[u,m,0],[x,m,0],[x,A,0],[u,A,0]];let D=Number.MAX_VALUE,F=-Number.MAX_VALUE;for(const N of O){const Z=a.af([],N,n),$=a.ag(Z);D=Math.min(D,$),F=Math.max(F,$)}return[dr(p,D,S.pitch,S._fov),dr(p,F,S.pitch,S._fov)]}const fr=a.a6.fog;class br extends a.E{constructor(n,u,m,x){super();const A=new a.a9({range:new a.aa(fr.range),color:new a.aa(fr.color),"color-use-theme":new a.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new a.aa(fr["high-color"]),"high-color-use-theme":new a.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new a.aa(fr["space-color"]),"space-color-use-theme":new a.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new a.aa(fr["horizon-blend"]),"star-intensity":new a.aa(fr["star-intensity"]),"vertical-range":new a.aa(fr["vertical-range"])});this._transitionable=new a.a8(A,m,new Map(x)),this.set(n,x),this._transitioning=this._transitionable.untransitioned(),this._transform=u,this.properties=new a.ai(A),this.scope=m}get state(){const n=this._transform,u=n.projection.name==="globe",m=a.aj(n.zoom),x=this.properties.get("range"),A=[.5,3];return{range:u?[a.ak(A[0],x[0],m),a.ak(A[1],x[1],m)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,u,m={}){if(this._validate(Sn,n,m))return;const x=Object.assign({},n);for(const A of Object.keys(fr))x[A]===void 0&&(x[A]=fr[A].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,u)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.ah(45,65,n))*u.a}getOpacityAtLatLng(n,u){return this._transform.projection.supportsFog?(function(m,x,A){const S=a.ae.fromLngLat(x),O=A.elevation?A.elevation.getAtPointOrZero(S):0;return Br(m,S.x,S.y,O,A)})(this.state,n,u):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const u=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Sr(this.state,u,0,0,a.al,a.al,this._transform)}getOpacityForBounds(n,u,m,x,A){return this._transform.projection.supportsFog?Sr(this.state,n,u,m,x,A,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?vr(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const u=[4,5,6,7];for(const m of u){const x=n.points[m];let A;if(x[2]>=0)A=x;else{const S=n.points[m-4];A=a.am(S,x,S[2]/(S[2]-x[2]))}if(Br(this.state,A[0],A[1],0,this._transform)>=Wt)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,m){return(!m||m.validate!==!1)&&Fe(this,n.call(Xa,Object.assign({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.a6})))}}let Vn,yi,Xn,Zn=class extends a.E{constructor(p,n,u,m){super();const x=Vn||(Vn=new a.a9({density:new a.aa(a.a6.snow.density),intensity:new a.aa(a.a6.snow.intensity),color:new a.aa(a.a6.snow.color),opacity:new a.aa(a.a6.snow.opacity),vignette:new a.aa(a.a6.snow.vignette),"vignette-color":new a.aa(a.a6.snow["vignette-color"]),"center-thinning":new a.aa(a.a6.snow["center-thinning"]),direction:new a.aa(a.a6.snow.direction),"flake-size":new a.aa(a.a6.snow["flake-size"])}));this._transitionable=new a.a8(x,u,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ai(x),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),m=a.an(u[0]),x=-Math.max(a.an(u[1]),.01),A=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],S=this.properties.get("vignette"),O=this.properties.get("vignette-color");return O.a=S,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.ao(n.r,n.g,n.b,n.a*p),direction:A,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:O}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(an,p,u))return;const m=Object.assign({},p),x=a.a6.snow;for(const A of Object.keys(x))m[A]===void 0&&(m[A]=x[A].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Fe(this,p.call(Xa,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:a.a6})))}},qn=class extends a.E{constructor(p,n,u,m){super();const x=yi||(yi=new a.a9({density:new a.aa(a.a6.rain.density),intensity:new a.aa(a.a6.rain.intensity),color:new a.aa(a.a6.rain.color),opacity:new a.aa(a.a6.rain.opacity),vignette:new a.aa(a.a6.rain.vignette),"vignette-color":new a.aa(a.a6.rain["vignette-color"]),"center-thinning":new a.aa(a.a6.rain["center-thinning"]),direction:new a.aa(a.a6.rain.direction),"droplet-size":new a.aa(a.a6.rain["droplet-size"]),"distortion-strength":new a.aa(a.a6.rain["distortion-strength"])}));this._transitionable=new a.a8(x,u,new Map(m)),this.set(p,m),this._transitioning=this._transitionable.untransitioned(),this.properties=new a.ai(x),this.scope=u}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),u=this.properties.get("direction"),m=a.an(u[0]),x=-Math.max(a.an(u[1]),.01),A=[Math.cos(m)*Math.cos(x),Math.sin(m)*Math.cos(x),Math.sin(x)],S=this.properties.get("vignette-color");return S.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new a.ao(n.r,n.g,n.b,n.a*p),direction:A,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(p,n,u={}){if(this._validate(yr,p,u))return;const m=Object.assign({},p),x=a.a6.rain;for(const A of Object.keys(x))m[A]===void 0&&(m[A]=x[A].default);this._options=m,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,u){return(!u||u.validate!==!1)&&Fe(this,p.call(Xa,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:a.a6})))}};class on extends a.E{constructor(n,u,m,x){super(),this.scope=m,this._options=n,this.properties=new a.ai(u),this._transitionable=new a.a8(u,m,new Map(x)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,u){this._options=n,this._transitionable.setTransitionOrValue(n.properties,u)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Gn=()=>Xn||(Xn=new a.a9({color:new a.aa(a.a6.properties_light_ambient.color),"color-use-theme":new a.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.aa(a.a6.properties_light_ambient.intensity)}));let Nn;const jn=()=>Nn||(Nn=new a.a9({direction:new a.ap(a.a6.properties_light_directional.direction),color:new a.aa(a.a6.properties_light_directional.color),"color-use-theme":new a.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new a.aa(a.a6.properties_light_directional.intensity),"cast-shadows":new a.aa(a.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new a.aa(a.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new a.aa(a.a6.properties_light_directional["shadow-intensity"]),"shadow-draw-before-layer":new a.aa(a.a6.properties_light_directional["shadow-draw-before-layer"])}));class ti{constructor(n,u,m){this.screenBounds=n,this.cameraPoint=m.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=u,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,m)}static createFromScreenPoints(n,u){let m,x;if(n instanceof a.P||typeof n[0]=="number"){const A=a.P.convert(n);m=[A],x=u.isPointAboveHorizon(A)}else{const A=a.P.convert(n[0]),S=a.P.convert(n[1]),O=A.add(S)._div(2);m=[A,S],x=a.aq(A,S).every(D=>u.isPointAboveHorizon(D))&&u.isPointAboveHorizon(O)}return new ti(m,x,u)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return a.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],x=a.aq(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),a.ar(x,n)}bufferedCameraGeometryGlobe(n){const u=this.screenBounds[0],m=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],x=a.aq(u,m,n),A=this.cameraPoint.clone();switch(3*((A.y>u.y)+(A.y>m.y))+((A.x>u.x)+(A.x>m.x))){case 0:x[0]=A,x[4]=A.clone();break;case 1:x.splice(1,0,A);break;case 2:x[1]=A;break;case 3:x.splice(4,0,A);break;case 5:x.splice(2,0,A);break;case 6:x[3]=A;break;case 7:x.splice(3,0,A);break;case 8:x[2]=A}return x}containsTile(n,u,m,x=0){const A=Math.max(n.queryPadding,n.evaluateQueryRenderedFeaturePadding())/u._pixelsPerMercatorPixel+1,S=m?this._bufferedCameraMercator(A,u):this._bufferedScreenMercator(A,u);let O=n.tileID.wrap+(S.unwrapped?x:0);const D=S.polygon.map(ae=>a.as(n.tileTransform,ae,O));if(!a.at(D,0,0,a.al,a.al))return;O=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const F=this.screenGeometryMercator.polygon.map(ae=>a.au(n.tileTransform,ae,O)),N=F.map(ae=>new a.P(ae[0],ae[1])),Z=u.getFreeCameraOptions().position||new a.ae(0,0,0),$=a.au(n.tileTransform,Z,O),W=F.map(ae=>{const le=a.av(ae,ae,$);return a.aw(le,le),new a.ax($,le)}),ne=a.ay(n,1,u.zoom)*u._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:N,tilespaceRays:W,bufferedTilespaceGeometry:D,bufferedTilespaceBounds:(te=a.az(D),te.min.x=a.aA(te.min.x,0,a.al),te.min.y=a.aA(te.min.y,0,a.al),te.max.x=a.aA(te.max.x,0,a.al),te.max.y=a.aA(te.max.y,0,a.al),te),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:ne};var te}_bufferedScreenMercator(n,u){const m=ya(n);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),u):{polygon:this.bufferedScreenGeometry(n).map(A=>u.pointCoordinate3D(A)),unwrapped:!0},this._screenRaycastCache[m]=x,x}}_bufferedCameraMercator(n,u){const m=ya(n);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let x;return x=u.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),u):{polygon:this.bufferedCameraGeometry(n).map(A=>u.pointCoordinate3D(A)),unwrapped:!0},this._cameraRaycastCache[m]=x,x}}_projectAndResample(n,u){const m=(function(A,S){const O=a.aB([],S.pixelMatrix,S.globeMatrix),D=[0,-a.aD,0,1],F=[0,a.aD,0,1],N=[0,0,0,1];a.aC(D,D,O),a.aC(F,F,O),a.aC(N,N,O);const Z=new a.P(D[0]/D[3],D[1]/D[3]),$=new a.P(F[0]/F[3],F[1]/F[3]),W=a.aE(A,Z)&&D[3]<N[3],ne=a.aE(A,$)&&F[3]<N[3];if(!W&&!ne)return null;const te=(function(De,Me,Te){for(let Ne=1;Ne<De.length;Ne++){const Ve=Ba(Me.pointCoordinate3D(De[Ne-1]).x),He=Ba(Me.pointCoordinate3D(De[Ne]).x);if(Te<0){if(Ve<He)return{idx:Ne,t:-Ve/(He-1-Ve)}}else if(He<Ve)return{idx:Ne,t:(1-Ve)/(He+1-Ve)}}return null})(A,S,W?-1:1);if(!te)return null;const{idx:ae,t:le}=te;let be=ae>1?ki(A.slice(0,ae),S):[],xe=ae<A.length?ki(A.slice(ae),S):[];be=be.map(De=>new a.P(Ba(De.x),De.y)),xe=xe.map(De=>new a.P(Ba(De.x),De.y));const ye=[...be];ye.length===0&&ye.push(xe[xe.length-1]);const Re=a.ak(ye[ye.length-1].y,(xe.length===0?be[0]:xe[0]).y,le);let Ce;return Ce=W?[new a.P(0,Re),new a.P(0,0),new a.P(1,0),new a.P(1,Re)]:[new a.P(1,Re),new a.P(1,1),new a.P(0,1),new a.P(0,Re)],ye.push(...Ce),xe.length===0?ye.push(be[0]):ye.push(...xe),{polygon:ye.map(De=>new a.ae(De.x,De.y)),unwrapped:!1}})(n,u);if(m)return m;const x=(function(A,S){let O=!1,D=-1/0,F=0;for(let Z=0;Z<A.length-1;Z++)A[Z].x>D&&(D=A[Z].x,F=Z);for(let Z=0;Z<A.length-1;Z++){const $=(F+Z)%(A.length-1),W=A[$],ne=A[$+1];Math.abs(W.x-ne.x)>.5&&(W.x<ne.x?(W.x+=1,$===0&&(A[A.length-1].x+=1)):(ne.x+=1,$+1===A.length-1&&(A[0].x+=1)),O=!0)}const N=a.aF(S.center.lng);return O&&N<Math.abs(N-1)&&A.forEach(Z=>{Z.x-=1}),{polygon:A,unwrapped:O}})(ki(n,u).map(A=>new a.P(Ba(A.x),A.y)),u);return{polygon:x.polygon.map(A=>new a.ae(A.x,A.y)),unwrapped:x.unwrapped}}}function ki(p,n){return a.aG(p,u=>{const m=n.pointCoordinate3D(u);u.x=m.x,u.y=m.y},1/256)}function Ba(p){return p<0?1+p%1:p%1}function ya(p){return 100*p|0}function gc(p,n,u,m,x){const A=function(O,D){if(O)return x(O);if(D){if(p.url&&D.tiles&&p.tiles&&delete p.tiles,D.variants){if(!Array.isArray(D.variants))return x(new Error("variants must be an array"));for(const N of D.variants){if(N==null||typeof N!="object"||N.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(N.capabilities))return x(new Error("capabilities must be an array"));if(N.capabilities.length===1&&N.capabilities[0]==="meshopt"){D=Object.assign(D,N);break}}}const F=a.aH(Object.assign({},D,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);F.tiles=n.canonicalizeTileset(F,p.url),x(null,F)}},S=(function(O,D,F){if(!O)return null;if(!D&&!F)return O;F=F||O.worldview_default;const N=Object.values(O.language||{});if(N.length===0)return null;const Z=Object.values(O.worldview||{});if(Z.length===0)return null;const $=N.every(ne=>ne===D),W=Z.every(ne=>ne===F);return $&&W?O:D in(O.language_options||{})||F in(O.worldview_options||{})?null:O.language_options&&O.worldview_options?O:null})(p.data,u,m);return S?a.o.frame(()=>A(null,S)):p.url?a.m(n.transformRequest(n.normalizeSourceURL(p.url,null,u,m),a.R.Source),A):a.o.frame(()=>{const{data:O,...D}=p;A(null,D)})}function yo(p,n){const u=Math.pow(2,n.z),m=Math.floor(a.aF(p.getWest())*u),x=Math.floor(a.aJ(p.getNorth())*u),A=Math.ceil(a.aF(p.getEast())*u),S=Math.ceil(a.aJ(p.getSouth())*u);return n.x>=m&&n.x<A&&n.y>=x&&n.y<S}class Io{constructor(n,u,m){this.bounds=n?a.aI.convert(this.validateBounds(n)):null,this.minzoom=u||0,this.maxzoom=m||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}addExtraBounds(n){if(n){this.extraBounds||(this.extraBounds=[]);for(const u of n)this.extraBounds.push(a.aI.convert(this.validateBounds(u)))}}contains(n){if(n.z>this.maxzoom||n.z<this.minzoom||this.bounds&&!yo(this.bounds,n))return!1;if(!this.extraBounds)return!0;for(const u of this.extraBounds)if(yo(u,n))return!0;return!1}static fromTileJSON(n){if(!n.bounds&&!n.extra_bounds)return null;const u=new Io(n.bounds,n.minzoom,n.maxzoom);return u.addExtraBounds(n.extra_bounds),u}}class ul extends a.E{constructor(n,u,m,x){if(super(),this.id=n,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,a.aH(u,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},u),this._collectResourceTiming=!!u.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new a.aK}load(n){this._loaded=!1,this.fire(new a.z("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map.getWorldview();this._tileJSONRequest=gc(this._options,this.map._requestManager,u,m,(x,A)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),m&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new a.y(x));else if(A){if(Object.assign(this,A),this.hasWorldviews=!!A.worldview_options,A.worldview_default&&(this.worldviewDefault=A.worldview_default),A.vector_layers){this.vectorLayers=A.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const S of A.vector_layers)this.vectorLayerIds.push(S.id),A.worldview&&A.worldview[S.source]&&this.localizableLayerIds.add(S.id)}this.tileBounds=Io.fromTileJSON(A),Bt(A.tiles,this.map._requestManager._customAccessToken),this.fire(new a.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.z("data",{dataType:"source",sourceDataType:"content"}))}n&&n(x)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=a.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(n,u){const m=n.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(m),A=this.map._requestManager.transformRequest(x,a.R.Tile),S=this.map.style?this.map.style.getLut(this.scope):null,O=S?{image:S.image.clone()}:null,D={request:A,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:O,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault,indoor:this.map.getIndoorTileOptions(this.id,this.scope)};if(this.hasWorldviews&&a.h(m)&&(D.localizableLayerIds=this.localizableLayerIds),D.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=u:n.request=n.actor.send("reloadTile",D,F.bind(this));else if(n.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",D,F.bind(this),void 0,!0);else{const N=a.aL.call({deduped:this._deduped},D,(Z,$)=>{if(Z||!$)F.call(this,Z);else{const W=a.aM($.responseHeaders);D.data={rawData:$.rawData.slice(0),expires:W.expires,cacheControl:W.cacheControl},n.actor&&n.actor.send("loadTile",D,F.bind(this),void 0,!0)}},!0);n.request={cancel:N}}function F(N,Z){return delete n.request,n.aborted?u(null):N&&N instanceof a.aN&&N.status!==404?u(N):(Z&&Z.resourceTiming&&(n.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&n.setExpiryData(Z),n.loadVectorData(Z,this.map.painter),a.aO(this.dispatcher),u(null,Z),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Sa extends a.E{constructor(n,u,m,x){super(),this.id=n,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},u),Object.assign(this,a.aH(u,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new a.z("dataloading",{dataType:"source"}));const u=this.map.getWorldview();this._tileJSONRequest=gc(this._options,this.map._requestManager,null,u,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.y(m)):x&&(Object.assign(this,x),x.raster_layers&&(this.rasterLayers=x.raster_layers,this.rasterLayerIds=this.rasterLayers.map(A=>A.id)),this.tileBounds=Io.fromTileJSON(x),Bt(x.tiles),this.fire(new a.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.z("data",{dataType:"source",sourceDataType:"content"}))),n&&n(m)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=a.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,u){const m=a.o.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);n.request=a.n(this.map._requestManager.transformRequest(x,a.R.Tile),(A,S,O)=>{if(delete n.request,n.aborted)return n.state="unloaded",u(null);if(A)return n.state="errored",u(A);if(!S)return u(null);const D=a.aM(O);this.map._refreshExpiredTiles&&n.setExpiryData(D),n.setTexture(S,this.map.painter),n.state="loaded",a.aO(this.dispatcher),u(null)})}abortTile(n,u){n.request&&(n.request.cancel(),delete n.request),u&&u()}unloadTile(n,u){n.texture&&n.texture instanceof a.T?(n.destroy(!1),n.texture&&n.texture instanceof a.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),u&&u()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ho([p,n],u,m,{scaled:x=!0}={}){const{tileSize:A,buffer:S}=m,{x:O,y:D,z:F}=u;if(!isFinite(O)||!isFinite(D)||!isFinite(F))throw new Error("Invalid MRT header");const N=2**F,Z=N*a.aF(p),$=N*a.aJ(n);return(function([W,ne],te,{scaled:ae=!0}={}){if(!te)throw new Error("bandView is undefined");const{data:le,tileSize:be,buffer:xe,offset:ye,scale:Re,dimension:Ce}=te;if(W<-xe||W>be+xe||ne<-xe||ne>be+xe)throw new Error(`Point (${W}, ${ne}) out of bounds for tileSize=${be}, buffer=${xe}`);const De=(ne+xe)*(be+2*xe)+(W+xe);if(new Uint32Array(le.buffer)[De]===4294967295)return null;let Me=[];Me=ae?[]:new te.data.constructor(Ce);for(let Te=0;Te<Ce;Te++)Me[Te]=Math.round(1e12*(le[Ce*De+Te]*Re+ye))/1e12;return Me})([Math.min(Math.max(-S,Math.floor((Z-O)*A)),A-1+S),Math.min(Math.max(-S,Math.floor(($-D)*A)),A-1+S)],m,{scaled:x})}class Po extends Sa{constructor(n,u,m,x){super(n,u,m,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},u)}triggerRepaint(n){const u=this.map.painter._terrain,m=this.map.style.getSourceCache(this.id);u&&u.enabled&&m&&u._clearRenderCacheForTile(m.id,n.tileID),this.map.triggerRepaint()}loadTile(n,u){const m=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,a.R.Tile),A={request:x,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};n.source=this.id,n.scope=this.scope,n.requestParams=x,n.actor||(n.actor=this.dispatcher.getActor());const S=(O,D,F)=>{if(delete n.request,n.aborted)return n.state="unloaded",u(null);if(O)return O.name==="AbortError"?void 0:(n.state="errored",u(O));if(this.map._refreshExpiredTiles&&D){const N=a.aM(F);n.setExpiryData(N)}if(this.partial&&n.state!=="expired")n.state="empty";else if(!this.partial){if(!D)return u(null);n.state="loaded",n._isHeaderLoaded=!0,n._mrt=D}u(null)};n.request=this.partial?n.fetchHeader(void 0,S.bind(this)):n.actor.send("loadTile",A,S.bind(this),void 0,!0)}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,u){const m=n.texturePerLayer;if(n.flushAllQueues(),m.size){n.destroy(!1);for(const x of m.values())this.map.painter.saveTileTexture(x)}else n.destroy()}prepareTile(n,u,m,x){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBandForRender(u,m,x,(A,S)=>{if(A)return n.state="errored",this.fire(new a.y(A)),void this.triggerRepaint(n);S&&(n._isHeaderLoaded=!0,n.setTexturePerLayer(m,S,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const u=this.rasterLayers.find(({id:A})=>A===n),m=u&&u.fields,x=m&&m.bands&&m.bands;return x?x[0]:0}getTextureDescriptor(n,u,m){if(!n)return;const x=u.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let A=null;u instanceof a.aR?A=u.paint.get("raster-array-band"):u instanceof a.aS&&(A=u.paint.get("raster-particle-array-band"));const S=A||this.getInitialBand(x);if(S==null)return;if(!n.textureDescriptorPerLayer.get(u.id))return void this.prepareTile(n,x,u.id,S);if(n.updateNeeded(u.id,S)&&!m)return;const O=n.textureDescriptorPerLayer.get(u.id);return Object.assign({},O,{texture:n.texturePerLayer.get(u.id)})}getImages(n,u){const m=new Map;for(const x of n)for(const A of u){const[S,O]=A.split("/"),D=x.getLayer(S);if(!D||!D.hasBand(O)||!D.hasDataForBand(O))continue;const{bytes:F,tileSize:N,buffer:Z}=D.getBandView(O),$=N+2*Z,W={data:new a.q({width:$,height:$},F),pixelRatio:2,sdf:!1,usvg:!1,version:0};m.set(A,W)}return m}queryRasterArrayValueByBandId(n,u,m){const x=u._mrt;return new Promise(A=>{const S={},O=new Set;for(const[D,F]of Object.entries(x.layers)){if(m.layerName&&D!==m.layerName)continue;const N={};S[D]=N;for(const{bands:Z}of F.dataIndex)for(const $ of Z)m.bands&&!m.bands.includes($)||(O.add(a.B(D,$)),u.fetchBand(D,null,$,W=>{a.o.frame(()=>{N[$]=W?null:Ho([n.lng,n.lat],x,F.getBandView($)),O.delete(a.B(D,$)),O.size===0&&A(S)})},!1))}O.size===0&&A(S)})}_loadTileForQuery(n,u){if(this._loadTileLoaded[n.uid])return void u(null,n._mrt);if(this._loadTilePending[n.uid])return void this._loadTilePending[n.uid].push(u);this._loadTilePending[n.uid]=[u];const m=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(m,a.R.Tile);n.actor.send("loadTile",{request:x,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},(A,S,O)=>{if(A)return this._loadTilePending[n.uid].forEach(D=>D(A,null)),void delete this._loadTilePending[n.uid];if(!S)return this._loadTilePending[n.uid].forEach(D=>D(null,null)),void delete this._loadTilePending[n.uid];if(this.map._refreshExpiredTiles&&S){const D=a.aM(O);n.setExpiryData(D)}n._mrt=S,n._isHeaderLoaded=!0,n.state="loaded",this._loadTilePending[n.uid].forEach(D=>D(null,S)),this._loadTileLoaded[n.uid]=!0,delete this._loadTilePending[n.uid]},void 0,!0)}queryRasterArrayValueByAllBands(n,u,m){return new Promise((x,A)=>{this._loadTileForQuery(u,(S,O)=>{S?A(S):x(O?this.queryRasterArrayValueByBandId(n,u,m):null)})})}queryRasterArrayValue(n,u){const m=a.aT.convert(n),x=this.findLoadedParent(m);return x&&x._mrt?u.bands||!this.partial?this.queryRasterArrayValueByBandId(m,x,u):this.queryRasterArrayValueByAllBands(m,x,u):Promise.resolve(null)}findLoadedParent(n){const u=a.ae.fromLngLat(n,this.map.transform.tileSize),m=this.maxzoom+1,x=1<<m,A=Math.floor(u.x),S=Math.floor((u.x-A)*x),O=Math.floor(u.y*x),D=this.map.style.getSourceCache(this.id),F=new a.aQ(m,A,m,S,O);return D.findLoadedParent(F,this.minzoom)}}const zl={vector:ul,raster:Sa,"raster-dem":class extends Sa{constructor(p,n,u,m){super(p,n,u,m),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(x,A){x&&(p.state="errored",n(x)),A&&(p.dem=A,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",n(null))}p.request=a.n(this.map._requestManager.transformRequest(u,a.R.Tile),(function(x,A,S){if(delete p.request,p.aborted)p.state="unloaded",n(null);else if(x)p.state="errored",n(x);else if(A){const O=a.aM(S);this.map._refreshExpiredTiles&&p.setExpiryData(O);const D=ImageBitmap&&A instanceof ImageBitmap&&a.r(),F=1-(A.width-a.aP(A.width))/2;F<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const N=D?A:a.o.getImageData(A,F),Z={uid:p.uid,tileID:p.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:N,encoding:this.encoding,padding:F};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadTile",Z,m.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const n=p.canonical,u=Math.pow(2,n.z),m=(n.x-1+u)%u,x=n.x===0?p.wrap-1:p.wrap,A=(n.x+1+u)%u,S=n.x+1===u?p.wrap+1:p.wrap,O={};return O[new a.aQ(p.overscaledZ,x,n.z,m,n.y).key]={backfilled:!1},O[new a.aQ(p.overscaledZ,S,n.z,A,n.y).key]={backfilled:!1},n.y>0&&(O[new a.aQ(p.overscaledZ,x,n.z,m,n.y-1).key]={backfilled:!1},O[new a.aQ(p.overscaledZ,p.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},O[new a.aQ(p.overscaledZ,S,n.z,A,n.y-1).key]={backfilled:!1}),n.y+1<u&&(O[new a.aQ(p.overscaledZ,x,n.z,m,n.y+1).key]={backfilled:!1},O[new a.aQ(p.overscaledZ,p.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},O[new a.aQ(p.overscaledZ,S,n.z,A,n.y+1).key]={backfilled:!1}),O}},"raster-array":Po,geojson:class extends a.E{constructor(p,n,u,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=n.data,this._options=Object.assign({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const x=a.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*x,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*x,extent:a.al,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:a.al,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*x,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new a.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new a.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const u of this._data.features)n.set(u.id,u);for(const u of p.features)n.set(u.id,u);this._data.features=[...n.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterChildren(p,n){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterLeaves(p,n,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:n,offset:u},m),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.z("dataloading",{dataType:"source"})),this._loaded=!1;const n=Object.assign({append:p},this.workerOptions);n.scope=this.scope;const u=this._data;typeof u=="string"?(n.request=this.map._requestManager.transformRequest(a.o.resolveURL(u),a.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(u),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(m,x)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new a.y(m));else{const A={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(A.resourceTiming=x.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new a.z("data",A)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const p=a.B(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,n){const u=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const m=this.map.style?this.map.style.getLut(this.scope):null,x=m?{image:m.image.clone()}:null,A=this._partialReload,S={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:a.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:p.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:A,worldview:this.map.getWorldview(),indoor:this.map.getIndoorTileOptions(this.id,this.scope)};p.request=this.actor.send(u,S,(O,D)=>A&&!D?(p.state="loaded",n(null)):(delete p.request,p.destroy(!1),p.aborted?n(null):O?n(O):(p.loadVectorData(D,this.map.painter,u==="reloadTile"),n(null))),void 0,u==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,n){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aU{constructor(p,n,u,m){super(p,n,u,m),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const n of p.urls)this.urls.push(this.map._requestManager.transformRequest(n,a.R.Source).url);a.aV(this.urls,(n,u)=>{this._loaded=!0,n?this.fire(new a.y(n)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const n=this.video.seekable;p<n.start(0)||p>n.end(0)?this.fire(new a.y(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,n=p.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(p,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aU,model:a.aX,"batched-model":class extends a.E{constructor(p,n,u,m){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=u,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(m)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=a.B(this.id,this.scope);this.load(()=>this.map.style.clearSource(p))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new a.z("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,u=this.map.getWorldview();this._tileJSONRequest=gc(this._options,this.map._requestManager,n,u,(m,x)=>{this._tileJSONRequest=null,this._loaded=!0,m?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),u&&u.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${u}`),this.fire(new a.y(m))):x&&(Object.assign(this,x),x.bounds&&(this.tileBounds=new Io(x.bounds,this.minzoom,this.maxzoom)),Bt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new a.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.z("data",{dataType:"source",sourceDataType:"content"}))),p&&p(m)})}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,n){const u=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(u,a.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:a.o.devicePixelRatio,promoteId:this.promoteId};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=n;else{if(p.buckets){const A=Object.values(p.buckets);for(const S of A)S.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",m,x.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",m,x.bind(this),void 0,!0);function x(A,S){return p.aborted?n(null):A&&A.status!==404?n(A):(this.map._refreshExpiredTiles&&S&&p.setExpiryData(S),p.loadModelData(S,this.map.painter),p.state="loaded",void n(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends a.aU{constructor(p,n,u,m){super(p,n,u,m),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(A=>typeof A!="number"))||this.fire(new a.y(new a.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.y(new a.V(`sources.${p}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new a.y(new a.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new a.y(new a.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.y(new a.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof a.aW||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends a.E{constructor(p,n,u,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=u,this._implementation=n,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Io(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,a.aH(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new a.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:n,y:u,z:m}=p.canonical;return this._implementation.hasTile({x:n,y:u,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,n){const{x:u,y:m,z:x}=p.tileID.canonical,A=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:u,y:m,z:x},{signal:A.signal})).then((function(S){return delete p.request,p.aborted?(p.state="unloaded",n(null)):S===void 0?(p.state="errored",n(null)):S===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",n(null)):(function(O){return O instanceof ImageData||O instanceof HTMLCanvasElement||O instanceof ImageBitmap||O instanceof HTMLImageElement})(S)?(this.loadTileData(p,S),p.state="loaded",void n(null)):(p.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(S=>{S.name!=="AbortError"&&(p.state="errored",n(S))}),p.request.cancel=()=>A.abort()}loadTileData(p,n){p.setTexture(n,this.map.painter)}unloadTile(p,n){if(p.texture&&p.texture instanceof a.T?(p.destroy(!1),p.texture&&p.texture instanceof a.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:u,y:m,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:u,y:m,z:x})}n&&n()}abortTile(p,n){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){const p=a.B(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new a.z("data",{dataType:"source",sourceDataType:"content"}))}}},hl=function(p,n,u,m){const x=new zl[n.type](p,n,u,m);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return a.aY(["load","abort","unload","serialize","prepare"],x),x};function Is(p,n,u=""){return`${u}:${n.id||""}:${n.layer.id}:${(function(m){if("layerId"in m)return`layer:${m.layerId}`;{const{featuresetId:x,importId:A}=m;return`featureset:${x}${A?`:import:${A}`:""}`}})(p.target)}`}function zd(p,n,u,m=""){if(p.uniqueFeatureID){const x=Is(p,n,m);if(u.has(x))return!0;u.add(x)}return!1}function _c(p,n,u,m,x=!1,A=void 0){const S=n.sourceCache.transform,O=n.sourceCache.tilesIn(p,n.has3DLayers,x);O.sort(Am);const D=[];for(const F of O){const N=F.tile.queryRenderedFeatures(n,F,u,m,S,x,A);Object.keys(N).length&&D.push({wrappedTileID:F.tile.tileID.wrapped().key,queryResults:N})}for(const F in n.layers){const N=n.layers[F];if(N.styleLayer){const Z=N.styleLayer.queryRenderedFeatures(p,n.sourceCache,m);Object.keys(Z).length&&D.push({wrappedTileID:0,queryResults:Z})}}return D.length===0?{}:(function(F){const N={},Z={};for(const $ of F){const W=$.queryResults,ne=$.wrappedTileID,te=Z[ne]=Z[ne]||{};for(const ae in W){const le=W[ae],be=te[ae]=te[ae]||{},xe=N[ae]=N[ae]||[];for(const ye of le)be[ye.featureIndex]||(be[ye.featureIndex]=!0,xe.push(ye))}}return N})(D)}function ov(p,n,u,m,x,A){const S={},O=m.queryRenderedSymbols(p),D=[];for(const F of Object.keys(O).map(Number))D.push(x[F]);D.sort(Am);for(const F of D){const N=F.featureIndex.lookupSymbolFeatures(O[F.bucketInstanceId],F.bucketIndex,F.sourceLayerIndex,n,u,A);for(const Z in N){const $=S[Z]=S[Z]||[],W=N[Z];W.sort((ne,te)=>{const ae=F.featureSortOrder;if(ae){const le=ae.indexOf(ne.featureIndex);return ae.indexOf(te.featureIndex)-le}return te.featureIndex-ne.featureIndex});for(const ne of W)$.push(ne)}}return S}function t_(p,n){const u=p.getRenderableIds().map(A=>p.getTileByID(A)),m=[],x={};for(let A=0;A<u.length;A++){const S=u[A],O=S.tileID.canonical.key;x[O]||(x[O]=!0,S.querySourceFeatures(m,n))}return m}function Am(p,n){const u=p.tileID,m=n.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function Kf(p,n){const u={};if(!n)return u;for(const m of p){const x=m.layerIds.map(A=>n.getLayer(A)).filter(Boolean);if(x.length!==0){m.layers=x,m.stateDependentLayerIds&&(m.stateDependentLayers=m.stateDependentLayerIds.map(A=>x.filter(S=>S.id===A)[0]));for(const A of x)u[A.fqid]=m}}return u}const Za=32,Zs=33,dl=new Uint16Array(8184);for(let p=0;p<2046;p++){let n=p+2,u=0,m=0,x=0,A=0,S=0,O=0;for(1&n?x=A=S=Za:u=m=O=Za;(n>>=1)>1;){const F=u+x>>1,N=m+A>>1;1&n?(x=u,A=m,u=S,m=O):(u=x,m=A,x=S,A=O),S=F,O=N}const D=4*p;dl[D+0]=u,dl[D+1]=m,dl[D+2]=x,dl[D+3]=A}const ka=new Uint16Array(2178),fl=new Uint8Array(1089),Gu=new Uint16Array(1089);function Ll(p){return p===0?-.03125:p===32?.03125:0}const pl={type:2,extent:a.al,loadGeometry:()=>[[new a.P(0,0),new a.P(a.al+1,0),new a.P(a.al+1,a.al+1),new a.P(0,a.al+1),new a.P(0,0)]]};class Wc{constructor(n,u,m,x,A,S){this.tileID=n,this.uid=a.b2(),this.uses=0,this.tileSize=u,this.tileZoom=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=A,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection),this.worldview=S,this._hasAppearances=null}registerFadeDuration(n){const u=n+this.timeAdded;u<a.o.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,u,m){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=Kf(n.buckets,u.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const A=this.buckets[x];if(A instanceof a.b4){if(this.hasSymbolBuckets=!0,!m)break;A.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const A=this.buckets[x];if(A instanceof a.b4&&A.hasRTLText){this.hasRTLText=!0,a.b5();break}}this.queryPadding=0;for(const x in this.buckets){const A=this.buckets[x],S=u.style.getOwnLayer(x);if(!S)continue;const O=S.queryRadius(A);this.queryPadding=Math.max(this.queryPadding,O)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new a.b3}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,u,m){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets=Object.assign({},this.buckets,Kf(n.buckets,u.style)),n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n,u){for(const A in this.buckets){const S=this.buckets[A];if(S.uploadPending()){let O={},D=[],F={zoom:0,pitch:0,brightness:0,worldview:""};if(u){if(u.style){D=u.style.listImages();const N=S.layers[0],Z=N.sourceLayer||"_geojsonTileLayer",$=u.style.getLayerSourceCache(N);$&&(O=$._state.getState(Z,void 0))}F={zoom:u.transform.zoom||0,pitch:u.transform.pitch||0,brightness:u.style.getBrightness()||0,worldview:u.worldview||""}}S.upload(n,this.tileID.canonical,O,D,F)}}const m=n.gl,x=this.imageAtlas;x&&!x.uploaded&&(this.imageAtlasTexture=new a.T(n,x.image,m.RGBA8,{useMipmap:!!x.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(n,this.glyphAtlasImage,m.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(n,this.lineAtlas.image,m.R8),this.lineAtlas.uploaded=!0)}prepare(n,u,m){if(this.imageAtlas&&this.imageAtlasTexture&&u){const A=u.style.getLut(m);this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,m,A)}if(!u||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=u.style.getBrightness();this._hasAppearances===null&&(this._hasAppearances=this.hasAppearances(u)),(this._lastUpdatedBrightness||x||this._hasAppearances)&&(!this._hasAppearances&&this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(u,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}evaluateQueryRenderedFeaturePadding(){let n=0;for(const u in this.buckets){const m=this.buckets[u];m.evaluateQueryRenderedFeaturePadding&&(n=Math.max(n,m.evaluateQueryRenderedFeaturePadding()))}return n}queryRenderedFeatures(n,u,m,x,A,S,O){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=this.evaluateQueryRenderedFeaturePadding(),F=(function(N,Z){const $=a.bq([],[.5*N.width,.5*-N.height,1]);return a.br($,$,[1,-1,0]),a.aB($,$,N.calculateProjMatrix(Z.toUnwrapped())),Float32Array.from($)})(A,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:u,pixelPosMatrix:F,transform:x,availableImages:m,tileTransform:this.tileTransform,worldview:this.worldview,queryRadius:D,scope:O})}querySourceFeatures(n,u){const m=this.latestFeatureIndex;if(!m||!m.rawTileData)return;const x=m.loadVTLayers(),A=u?u.sourceLayer:"",S=x._geojsonTileLayer||x[A];if(!S)return;const O=a.b6(u&&u.filter),{z:D,x:F,y:N}=this.tileID.canonical,Z={z:D,x:F,y:N};for(let $=0;$<S.length;$++){const W=S.feature($);if(O.needGeometry){const ae=a.b7(W,!0);if(!O.filter(new a.ac(this.tileID.overscaledZ,{worldview:this.worldview}),ae,this.tileID.canonical))continue}else if(!O.filter(new a.ac(this.tileID.overscaledZ,{worldview:this.worldview}),W))continue;const ne=m.getId(W,A),te=new a.b8(W,D,F,N,ne);te.tile=Z,n.push(te)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(n){const u=this.expirationTime;if(n.cacheControl){const m=a.b9(n.cacheControl);m["max-age"]&&(this.expirationTime=Date.now()+1e3*m["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const m=Date.now();let x=!1;if(this.expirationTime>m)x=!1;else if(u)if(this.expirationTime<u)x=!0;else{const A=this.expirationTime-u;A?this.expirationTime=m+Math.max(A,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}hasAppearances(n){for(const u in this.buckets)if(n.style.hasLayer(u)&&this.buckets[u].layers.some(m=>m.appearances&&m.appearances.length>0))return!0;return!1}updateBuckets(n,u){if(!this.latestFeatureIndex||!n.style)return;const m=n.style.listImages(),x=n.style.getBrightness();for(const A in this.buckets){if(!n.style.hasLayer(A))continue;const S=this.buckets[A],O=S.layers[0],D=O.sourceLayer||"_geojsonTileLayer",F=n.style.getLayerSourceCache(O);let N={};F&&(N=F._state.getState(D,void 0));const Z=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},$=Object.keys(N).length>0&&!u;S.hasAppearances=S.layers.some(te=>te.appearances&&te.appearances.length>0);const W=$?S.stateDependentLayers:S.layers;if($&&S.stateDependentLayers.length!==0||u){const te=this.latestFeatureIndex.loadVTLayers();S.update(N,te[D],m,Z,W,u,x)}if($&&S.stateDependentLayers.length!==0||u||S.hasAppearances){const te={zoom:n.transform.zoom,pitch:n.transform.pitch,brightness:n.style.getBrightness()||0,worldview:n.worldview};S.updateAppearances(this.tileID.canonical,N,m,te,n.imageManager)}(S instanceof a.ba||S instanceof a.bb)&&n._terrain&&n._terrain.enabled&&F&&S.uploadPending()&&n._terrain._clearRenderCacheForTile(F.id,this.tileID);const ne=n&&n.style&&n.style.getOwnLayer(A);ne&&(this.queryPadding=Math.max(this.queryPadding,ne.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=a.o.now()+n}setTexture(n,u){const m=u.context,x=m.gl;this.texture=this.texture||u.getTileTexture(n.width),this.texture&&this.texture instanceof a.T?this.texture.update(n):(this.texture=new a.T(m,n,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(n,u){const m={};for(const x of u)m[x]=!0;this.dependencies[n]=m}hasDependency(n,u){for(const m of n){const x=this.dependencies[m];if(x){for(const A of u)if(x[A])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const m=a.bc(pl,this.tileID.canonical,this.tileTransform)[0],x=new a.bd,A=new a.be;for(let S=0;S<m.length;S++){const{x:O,y:D}=m[S];x.emplaceBack(O,D),A.emplaceBack(S)}A.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(A),this._tileDebugBuffer=n.createVertexBuffer(x,a.bf.members),this._tileDebugSegments=a.bg.simpleSegment(0,0,x.length,A.length)}_makeTileBoundsBuffers(n,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const m=a.bc(pl,this.tileID.canonical,this.tileTransform)[0];let x,A;if(this.isRaster){const S=(function(O,D){const F=a.aZ(O,D),N=Math.pow(2,O.z);for(let ae=0;ae<Zs;ae++)for(let le=0;le<Zs;le++){const be=a.a_((O.x+(le+Ll(le))/Za)/N),xe=a.a$((O.y+(ae+Ll(ae))/Za)/N),ye=D.project(be,xe),Re=ae*Zs+le;ka[2*Re+0]=Math.round((ye.x*F.scale-F.x)*a.al),ka[2*Re+1]=Math.round((ye.y*F.scale-F.y)*a.al)}fl.fill(0),Gu.fill(0);for(let ae=2045;ae>=0;ae--){const le=4*ae,be=dl[le+0],xe=dl[le+1],ye=dl[le+2],Re=dl[le+3],Ce=be+ye>>1,De=xe+Re>>1,Me=Ce+De-xe,Te=De+be-Ce,Ne=xe*Zs+be,Ve=Re*Zs+ye,He=De*Zs+Ce,Qe=Math.hypot((ka[2*Ne+0]+ka[2*Ve+0])/2-ka[2*He+0],(ka[2*Ne+1]+ka[2*Ve+1])/2-ka[2*He+1])>=16;fl[He]=fl[He]||(Qe?1:0),ae<1022&&(fl[He]=fl[He]||fl[(xe+Te>>1)*Zs+(be+Me>>1)]||fl[(Re+Te>>1)*Zs+(ye+Me>>1)])}const Z=new a.b1,$=new a.b0;let W=0;function ne(ae,le){const be=le*Zs+ae;return Gu[be]===0&&(Z.emplaceBack(ka[2*be+0],ka[2*be+1],ae*a.al/Za,le*a.al/Za),Gu[be]=++W),Gu[be]-1}function te(ae,le,be,xe,ye,Re){const Ce=ae+be>>1,De=le+xe>>1;if(Math.abs(ae-ye)+Math.abs(le-Re)>1&&fl[De*Zs+Ce])te(ye,Re,ae,le,Ce,De),te(be,xe,ye,Re,Ce,De);else{const Me=ne(ae,le),Te=ne(be,xe),Ne=ne(ye,Re);$.emplaceBack(Me,Te,Ne)}}return te(0,0,Za,Za,Za,0),te(Za,Za,0,0,0,Za),{vertices:Z,indices:$}})(this.tileID.canonical,u);x=S.vertices,A=S.indices}else{x=new a.b1,A=new a.b0;for(const{x:O,y:D}of m)x.emplaceBack(O,D,0,0);const S=a.bh(x.int16.subarray(0,4*x.length),void 0,4);for(let O=0;O<S.length;O+=3)A.emplaceBack(S[O],S[O+1],S[O+2])}this._tileBoundsBuffer=n.createVertexBuffer(x,a.bi.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(A),this._tileBoundsSegments=a.bg.simpleSegment(0,0,x.length,A.length)}_makeGlobeTileDebugBuffers(n,u){const m=u.projection;if(!m||m.name!=="globe"||u.freezeTileCoverage)return;const x=this.tileID.canonical,A=a.bj(x,u),S=a.bk(A),O=a.aj(u.zoom);let D;O>0&&(D=a.bl(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,x,u,S,D,O),this._makeGlobeTileDebugTextBuffer(n,x,u,S,D,O)}_globePoint(n,u,m,x,A,S,O){let D=a.bm(n,u,m);if(S){const F=1<<m.z,N=a.aF(x.center.lng),Z=a.aJ(x.center.lat),$=(m.x+.5)/F-N;let W=0;$>.5?W=-1:$<-.5&&(W=1);let ne=(n/a.al+m.x)/F+W,te=(u/a.al+m.y)/F;ne=(ne-N)*x._pixelsPerMercatorPixel+N,te=(te-Z)*x._pixelsPerMercatorPixel+Z;const ae=[ne*x.worldSize,te*x.worldSize,0];a.af(ae,ae,S),D=a.bn(D,ae,O)}return a.af(D,D,A)}_makeGlobeTileDebugBorderBuffer(n,u,m,x,A,S){const O=new a.bd,D=new a.be,F=new a.bo,N=($,W,ne,te,ae)=>{const le=(ne-$)/(ae-1),be=(te-W)/(ae-1),xe=O.length;for(let ye=0;ye<ae;ye++){const Re=$+ye*le,Ce=W+ye*be;O.emplaceBack(Re,Ce);const De=this._globePoint(Re,Ce,u,m,x,A,S);F.emplaceBack(De[0],De[1],De[2]),D.emplaceBack(xe+ye)}},Z=a.al;N(0,0,Z,0,16),N(Z,0,Z,Z,16),N(Z,Z,0,Z,16),N(0,Z,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(D),this._tileDebugBuffer=n.createVertexBuffer(O,a.bf.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(F,a.bp.members),this._tileDebugSegments=a.bg.simpleSegment(0,0,O.length,D.length)}_makeGlobeTileDebugTextBuffer(n,u,m,x,A,S){const O=a.al/4,D=new a.bd,F=new a.b0,N=new a.bo,Z=25;F.reserve(32),D.reserve(Z),N.reserve(Z);const $=(W,ne)=>Z*W+ne;for(let W=0;W<Z;W++){const ne=W*O;for(let te=0;te<Z;te++){const ae=te*O;D.emplaceBack(ae,ne);const le=this._globePoint(ae,ne,u,m,x,A,S);N.emplaceBack(le[0],le[1],le[2])}}for(let W=0;W<4;W++)for(let ne=0;ne<4;ne++){const te=$(W,ne),ae=$(W,ne+1),le=$(W+1,ne),be=$(W+1,ne+1);F.emplaceBack(te,ae,le),F.emplaceBack(le,ae,be)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(F),this._tileDebugTextBuffer=n.createVertexBuffer(D,a.bf.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(N,a.bp.members),this._tileDebugTextSegments=a.bg.simpleSegment(0,0,Z,32)}destroy(n=!0){for(const u in this.buckets)this.buckets[u].destroy(n);this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),n&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.emissiveTexture&&this.emissiveTexture instanceof a.T&&(this.emissiveTexture.destroy(),delete this.emissiveTexture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.bs.setPbf(a.bt);class Ld extends Wc{constructor(n,u,m,x,A){super(n,u,m,x,A),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(n){return this._mrt&&this._mrt.getLayer(n)}setTexturePerLayer(n,u,m){const x=m.context,A=x.gl;let S=this.texturePerLayer.get(n)||m.getTileTexture(u.width);S&&S instanceof a.T?S.update(u,{premultiply:!1}):S=new a.T(x,u,A.RGBA8,{premultiply:!1}),this.texturePerLayer.has(n)||this.texturePerLayer.set(n,S)}flushQueues(n){const u=this._workQueuePerLayer.get(n)||[],m=this._fetchQueuePerLayer.get(n)||[];for(;u.length;)u.pop()();for(;m.length;)m.pop()()}flushAllQueues(){for(const n of this._workQueuePerLayer.keys()){const u=this._workQueuePerLayer.get(n)||[];for(;u.length;)u.pop()()}for(const n of this._fetchQueuePerLayer.keys()){const u=this._fetchQueuePerLayer.get(n)||[];for(;u.length;)u.pop()()}}fetchHeader(n=16384,u){const m=this._mrt=new a.bs(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=a.bu(x,(A,S,O)=>{if(A)u(A);else try{const D=m.getHeaderLength(S);if(D>n)return void(this.request=this.fetchHeader(D,u));m.parseHeader(S),this._isHeaderLoaded=!0;let F=0;for(const N of Object.values(m.layers))F=Math.max(F,N.dataIndex[N.dataIndex.length-1].lastByte);S.byteLength>=F&&(this.entireBuffer=S),u(null,this.entireBuffer||S,O)}catch(D){u(D)}}),this.request}fetchBandForRender(n,u,m,x){this.fetchBand(n,u,m,A=>{if(A)return void x(A);this.updateTextureDescriptor(n,u,m);const S=this.textureDescriptorPerLayer.get(u);x(null,S?S.img:null)})}fetchBand(n,u,m,x,A=!0){const S=this._mrt;if(!this._isHeaderLoaded||!S)return void x(new Error("Tile header is not ready"));const O=this.actor;if(!O)return void x(new Error("Can't fetch tile band without an actor"));let D;const F=a.B(String(m),a.B(this.tileID.key,n));let N=this._taskQueue.get(F);N?N.add(x):(N=new Set,N.add(x),this._taskQueue.set(F,N));const Z=(te,ae)=>{D.complete(te,ae),te?x(te):(N.forEach(le=>le(null,ae)),this._taskQueue.delete(F))},$=(te,ae)=>{if(te)return x(te);const le=O.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:ae,task:D},Z,void 0,!0);if(u!==null){const be=this._workQueuePerLayer.get(u)||[];be.push(()=>{le&&le.cancel(),D.cancel()}),this._workQueuePerLayer.has(u)||this._workQueuePerLayer.set(u,be)}};let W;try{W=S.getLayer(n)}catch(te){if(this.state==="reloading")return;throw te}if(!W)return void x(new Error(`Unknown sourceLayer "${n}"`));if(W.hasDataForBand(m))return N.forEach(te=>te(null,null)),void this._taskQueue.delete(F);const ne=W.getDataRange([m]);if(D=S.createDecodingTask(ne),!D||D.tasks.length)if(u!==null&&this.flushQueues(u),this.entireBuffer)$(null,this.entireBuffer.slice(ne.firstByte,ne.lastByte+1));else{const te=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ne.firstByte}-${ne.lastByte}`}}),ae=a.bu(te,$);if(u!==null){const le=this._fetchQueuePerLayer.get(u)||[];le.push(()=>{ae.cancel(),D.cancel()}),this._fetchQueuePerLayer.has(u)||this._fetchQueuePerLayer.set(u,le)}}}updateNeeded(n,u){return(!this.textureDescriptorPerLayer.get(n)||this.textureDescriptorPerLayer.get(n).band!==u||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(n,u,m){if(!this._mrt)return;const x=this._mrt.getLayer(n);if(!x||!x.hasBand(m)||!x.hasDataForBand(m))return;const{bytes:A,tileSize:S,buffer:O,offset:D,scale:F}=x.getBandView(m),N=S+2*O,Z=new a.q({width:N,height:N},A),$=this.texturePerLayer.get(u);$&&$ instanceof a.T&&$.update(Z,{premultiply:!1}),this.textureDescriptorPerLayer.set(u,{layer:n,band:m,img:Z,buffer:O,offset:D,tileSize:S,format:x.pixelFormat,mix:[F,256*F,65536*F,16777216*F]})}destroy(n=!1){if(super.destroy(n),delete this._mrt,!n)for(const u of this.texturePerLayer.values())u&&u instanceof a.T&&u.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class r_{constructor(n,u){this.max=n,this.onRemove=u,this.reset()}reset(){for(const n in this.data)for(const u of this.data[n])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(n,u,m){const x=n.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const A={value:u,timeout:void 0};if(m!==void 0&&(A.timeout=setTimeout(()=>{this.remove(n,A)},m)),this.data[x].push(A),this.order.push(x),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value}getByKey(n){const u=this.data[n];return u?u[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,u){if(!this.has(n))return this;const m=n.wrapped().key,x=u===void 0?0:this.data[m].indexOf(u),A=this.data[m][x];return this.data[m].splice(x,1),A.timeout&&clearTimeout(A.timeout),this.data[m].length===0&&delete this.data[m],this.onRemove(A.value),this.order.splice(this.order.indexOf(m),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(n){const u=[];for(const m in this.data)for(const x of this.data[m])n(x.value)||u.push(x);for(const m of u)this.remove(m.value.tileID,m)}}class Bd{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,u,m){const x=String(u);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][x]=this.stateChanges[n][x]||{},Object.assign(this.stateChanges[n][x],m),this.deletedStates[n]===null){this.deletedStates[n]={};for(const A in this.state[n])A!==x&&(this.deletedStates[n][A]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][x]===null){this.deletedStates[n][x]={};for(const A in this.state[n][x])m[A]||(this.deletedStates[n][x][A]=null)}else for(const A in m)this.deletedStates[n]&&this.deletedStates[n][x]&&this.deletedStates[n][x][A]===null&&delete this.deletedStates[n][x][A]}removeFeatureState(n,u,m){if(this.deletedStates[n]===null)return;const x=String(u);if(this.deletedStates[n]=this.deletedStates[n]||{},m&&u!==void 0)this.deletedStates[n][x]!==null&&(this.deletedStates[n][x]=this.deletedStates[n][x]||{},this.deletedStates[n][x][m]=null);else if(u!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][x])for(m in this.deletedStates[n][x]={},this.stateChanges[n][x])this.deletedStates[n][x][m]=null;else this.deletedStates[n][x]=null;else this.deletedStates[n]=null}getState(n,u){const m=this.state[n]||{},x=this.stateChanges[n]||{},A=this.deletedStates[n];if(A===null)return{};if(u!==void 0){const O=String(u),D=Object.assign({},m[O],x[O]);if(A){const F=A[u];if(F===null)return{};for(const N in F)delete D[N]}return D}const S=Object.assign({},m,x);if(A)for(const O in A)delete S[O];return S}initializeTileState(n,u){n.refreshFeatureState(u)}coalesceChanges(n,u){const m={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const A={};for(const S in this.stateChanges[x])this.state[x][S]||(this.state[x][S]={}),Object.assign(this.state[x][S],this.stateChanges[x][S]),A[S]=this.state[x][S];m[x]=A}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const A={};if(this.deletedStates[x]===null)for(const S in this.state[x])A[S]={},this.state[x][S]={};else for(const S in this.deletedStates[x]){if(this.deletedStates[x][S]===null)this.state[x][S]={};else if(this.state[x][S])for(const O of Object.keys(this.deletedStates[x][S]))delete this.state[x][S][O];A[S]=this.state[x][S]}m[x]=m[x]||{},Object.assign(m[x],A)}if(this.stateChanges={},this.deletedStates={},Object.keys(m).length!==0)for(const x in n)n[x].refreshFeatureState(u)}}class va extends a.E{constructor(n,u,m){super(),this.id=n,this._onlySymbols=m,u.on("data",x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new r_(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Bd,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles)if(!this._tiles[n].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,u){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,u)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const m=this._tiles[u];m.upload(n,this.map?this.map.painter:void 0),m.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Bh).map(n=>n.key)}getRenderableIds(n,u){const m=[];for(const x in this._tiles)this._isIdRenderable(+x,n,u)&&m.push(this._tiles[x]);return n?m.sort((x,A)=>{const S=x.tileID,O=A.tileID,D=new a.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle),F=new a.P(O.canonical.x,O.canonical.y)._rotate(this.transform.angle);return S.overscaledZ-O.overscaledZ||F.y-D.y||F.x-D.x}).map(x=>x.tileID.key):m.map(x=>x.tileID).sort(Bh).map(x=>x.key)}hasRenderableParent(n){const u=this.findLoadedParent(n,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(n,u,m){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(u||!this._tiles[n].holdingForFade())&&(m||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,u){const m=this._tiles[n];m&&(m.state!=="loading"&&(m.state=u),this._loadTile(m,this._tileLoaded.bind(this,m,n,u)))}_tileLoaded(n,u,m,x,A){if(x){if(n.state="errored",x.status!==404)this._source.fire(new a.y(x,{tile:n}));else{if(this._source.fire(new a.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const O=this.map.painter.terrain;this.update(this.transform,O.getScaledDemTileSize(),!0),O.resetTileLookupCache(this.id)}else this.update(this.transform)}return}n.timeAdded=a.o.now(),m==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(u,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null);let S=new Map;A&&A.responseHeaders&&(S=A.responseHeaders),this._source.fire(new a.z("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id,responseHeaders:S}))}_backfillDEM(n){const u=this.getRenderableIds();for(let x=0;x<u.length;x++){const A=u[x];if(n.neighboringTiles&&n.neighboringTiles[A]){const S=this.getTileByID(A);m(n,S),m(S,n)}}function m(x,A){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let S=A.tileID.canonical.x-x.tileID.canonical.x;const O=A.tileID.canonical.y-x.tileID.canonical.y,D=Math.pow(2,x.tileID.canonical.z),F=A.tileID.key;S===0&&O===0||Math.abs(O)>1||(Math.abs(S)>1&&(Math.abs(S+D)===1?S+=D:Math.abs(S-D)===1&&(S-=D)),A.dem&&x.dem&&(x.dem.backfillBorder(A.dem,S,O),x.neighboringTiles&&x.neighboringTiles[F]&&(x.neighboringTiles[F].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,u,m,x){for(const A in this._tiles){let S=this._tiles[A];if(x[A]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>m)continue;let O=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const F=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[F.key],S&&S.hasData()&&(O=F)}let D=O;for(;D.overscaledZ>u;)if(D=D.scaledTo(D.overscaledZ-1),n[D.key]){x[O.key]=O;break}}}findLoadedParent(n,u){if(n.key in this._loadedParentTiles){const m=this._loadedParentTiles[n.key];return m&&m.tileID.overscaledZ>=u?m:null}for(let m=n.overscaledZ-1;m>=u;m--){const x=n.scaledTo(m),A=this._getLoadedTile(x);if(A)return A}}_getLoadedTile(n){const u=this._tiles[n.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,u){u=u||this._source.tileSize;const m=Math.ceil(n.width/u)+1,x=Math.ceil(n.height/u)+1,A=Math.floor(m*x*5),S=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,A):A,O=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(O)}handleWrapJump(n){const u=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,u){const m={};for(const x in this._tiles){const A=this._tiles[x];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+u),m[A.tileID.key]=A}this._tiles=m;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(n,u,m,x,A){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!m)return;this.updateCacheSize(n,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const S=this._source.type==="batched-model";let O,D=this._source.maxzoom;const F=this.map&&this.map.painter?this.map.painter._terrain:null;if(F&&F.sourceCache===this&&F.attenuationRange()){const $=F.attenuationRange()[0],W=Math.floor($)-Math.log2(F.getDemUpscale());D>W&&(D=W)}if(this.used||this.usedForTerrain){if(this._source.tileID)O=n.getVisibleUnwrappedCoordinates(this._source.tileID).map($=>new a.aQ($.canonical.z,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y));else if(this.tileCoverLift!==0){const $=n.clone();$.tileCoverLift=this.tileCoverLift,O=$.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.minzoom<=1&&n.projection.name==="globe"&&(O.push(new a.aQ(1,0,1,0,0)),O.push(new a.aQ(1,0,1,1,0)),O.push(new a.aQ(1,0,1,0,1)),O.push(new a.aQ(1,0,1,1,1)))}else if(O=n.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:D,roundZoom:this._source.roundZoom&&!m,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:S}),this._source.hasTile){const $=this._source.hasTile.bind(this._source);O=O.filter(W=>$(W))}}else O=[];if(O.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Yc(this._source.type)){const $=n.coveringZoomLevel({tileSize:u||this._source.tileSize,roundZoom:this._source.roundZoom&&!m}),W=Math.min($,this._source.maxzoom);if(S){const ne=n.extendTileCover(O,W);for(const te of ne)O.push(te)}else if(A){const ne=n.extendTileCoverToNearPlane(O,this.transform.getFrustum(W),W);for(const te of ne)O.push(te)}else if(this.castsShadows&&x){const ne=n.extendTileCover(O,W,x,16);for(const te of ne)this._shadowCasterTiles[te.key]=!0,O.push(te)}}const N=this._updateRetainedTiles(O);if(Yc(this._source.type)&&O.length!==0){const $={},W={},ne=Object.keys(N);for(const ae of ne){const le=N[ae],be=this._tiles[ae];if(!be||be.fadeEndTime&&be.fadeEndTime<=a.o.now())continue;const xe=this.findLoadedParent(le,Math.max(le.overscaledZ-va.maxOverzooming,this._source.minzoom));xe&&(this._addTile(xe.tileID),$[xe.tileID.key]=xe.tileID),W[ae]=le}const te=O[O.length-1].overscaledZ;for(const ae in this._tiles){const le=this._tiles[ae];if(N[ae]||!le.hasData())continue;let be=le.tileID;for(;be.overscaledZ>te;){be=be.scaledTo(be.overscaledZ-1);const xe=this._tiles[be.key];if(xe&&xe.hasData()&&W[be.key]){N[ae]=le.tileID;break}}}for(const ae in $)N[ae]||(this._coveredTiles[ae]=!0,N[ae]=$[ae])}for(const $ in N)this._tiles[$].clearFadeHold();const Z=a.bv(this._tiles,N);for(const $ of Z){const W=this._tiles[$];W.hasSymbolBuckets&&!W.holdingForFade()?W.setHoldDuration(this.map._fadeDuration):W.hasSymbolBuckets&&!W.symbolFadeFinished()||this._removeTile(+$)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const u={};if(n.length===0)return u;const m={},x=n.reduce((F,N)=>Math.min(F,N.overscaledZ),1/0),A=n[0].overscaledZ,S=Math.max(A-va.maxOverzooming,this._source.minzoom),O=Math.max(A+va.maxUnderzooming,this._source.minzoom),D={};for(const F of n){const N=this._addTile(F);u[F.key]=F,N.hasData()||x<this._source.maxzoom&&(D[F.key]=F)}this._retainLoadedChildren(D,x,O,u);for(const F of n){let N=this._tiles[F.key];if(N.hasData())continue;if(F.canonical.z>=this._source.maxzoom){const $=F.children(this._source.maxzoom)[0],W=this.getTile($);if(W&&W.hasData()){u[$.key]=$;continue}}else{const $=F.children(this._source.maxzoom);if(u[$[0].key]&&u[$[1].key]&&u[$[2].key]&&u[$[3].key])continue}let Z=N.wasRequested();for(let $=F.overscaledZ-1;$>=S;--$){const W=F.scaledTo($);if(m[W.key]||(m[W.key]=!0,N=this.getTile(W),!N&&Z&&(N=this._addTile(W)),N&&(u[W.key]=W,Z=N.wasRequested(),N.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const u=[];let m,x=this._tiles[n].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){m=this._loadedParentTiles[x.key];break}u.push(x.key);const A=x.scaledTo(x.overscaledZ-1);if(m=this._getLoadedTile(A),m)break;x=A}for(const A of u)this._loadedParentTiles[A]=m}}_addTile(n){let u=this._tiles[n.key];if(u)return u.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),u;u=this._cache.getAndRemove(n),u&&(this._setTileReloadTimer(n.key,u),u.tileID=n,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,u)));const m=!!u;if(!m){const x=this.map?this.map.painter:null,A=this._source.tileSize*n.overscaleFactor();u=this._source.type==="raster-array"?new Ld(n,A,this.transform.tileZoom,x,this._isRaster):new Wc(n,A,this.transform.tileZoom,x,this._isRaster,this._source.worldview),this._loadTile(u,this._tileLoaded.bind(this,u,n.key,u.state))}return u.uses++,this._tiles[n.key]=u,m||this._source.fire(new a.z("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(n,u){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const m=u.getExpiryTimeout();m&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},m))}_removeTile(n){const u=this._tiles[n];u&&(u.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),u.uses>0||(u.hasData()&&u.state!=="reloading"||u.state==="empty"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,u,m){const x=[],A=this.transform;if(!A)return x;const S=A.projection.name==="globe",O=a.aF(A.center.lng);for(const D in this._tiles){const F=this._tiles[D];if(m&&F.clearQueryDebugViz(),F.holdingForFade())continue;let N;if(S){const Z=F.tileID.canonical;if(Z.z===0){const $=[Math.abs(a.aA(O,...Xo(Z,-1))-O),Math.abs(a.aA(O,...Xo(Z,1))-O)];N=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(a.aA(O,...Xo(Z,-1))-O),Math.abs(a.aA(O,...Xo(Z,0))-O),Math.abs(a.aA(O,...Xo(Z,1))-O)];N=[$.indexOf(Math.min(...$))-1]}}else N=[0];for(const Z of N){const $=n.containsTile(F,A,u,Z);$&&x.push($)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,u){const m=this.getRenderableIds(n,u).map(A=>this._tiles[A].tileID),x=this.transform.projection.name==="globe";for(const A of m)A.projMatrix=this.transform.calculateProjMatrix(A.toUnwrapped()),A.expandedProjMatrix=x?this.transform.calculateProjMatrix(A.toUnwrapped(),!1,!0):A.projMatrix;return m}sortCoordinatesByDistance(n){const u=n.slice(),m=this.transform._camera.position,x=this.transform._camera.forward(),A={};for(const S of u){const O=1/(1<<S.canonical.z);A[S.key]=((S.canonical.x+.5)*O+S.wrap-m[0])*x[0]+((S.canonical.y+.5)*O-m[1])*x[1]-m[2]*x[2]}return u.sort((S,O)=>A[S.key]-A[O.key]),u}hasTransition(){if(this._source.hasTransition())return!0;if(Yc(this._source.type))for(const n in this._tiles){const u=this._tiles[n];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=a.o.now())return!0}return!1}setFeatureState(n,u,m){this._state.updateState(n=n||"_geojsonTileLayer",u,m)}removeFeatureState(n,u,m){this._state.removeFeatureState(n=n||"_geojsonTileLayer",u,m)}getFeatureState(n,u){return this._state.getState(n=n||"_geojsonTileLayer",u)}setDependencies(n,u,m){const x=this._tiles[n];x&&x.setDependencies(u,m)}reloadTilesForDependencies(n,u){for(const m in this._tiles)this._tiles[m].hasDependency(n,u)&&this._reloadTile(+m,"reloading");this._cache.filter(m=>!m.hasDependency(n,u))}_preloadTiles(n,u){if(!this._sourceLoaded){const D=()=>{this._sourceLoaded&&(this._source.off("data",D),this._preloadTiles(n,u))};return void this._source.on("data",D)}const m=new Map,x=Array.isArray(n)?n:[n],A=this.map.painter.terrain,S=this.usedForTerrain&&A?A.getScaledDemTileSize():this._source.tileSize;for(const D of x){const F=D.coveringTiles({tileSize:S,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const N of F)m.set(N.key,N);this.usedForTerrain&&D.updateElevation(!1)}const O=Array.from(m.values());a.bw(O,(D,F)=>{const N=new Wc(D,this._source.tileSize*D.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(N,Z=>{this._source.type==="raster-dem"&&N.dem&&this._backfillDEM(N),F(Z,N)})},u)}}function Bh(p,n){const u=Math.abs(2*p.wrap)-+(p.wrap<0),m=Math.abs(2*n.wrap)-+(n.wrap<0);return p.overscaledZ-n.overscaledZ||m-u||n.canonical.y-p.canonical.y||n.canonical.x-p.canonical.x}function Yc(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function Xo(p,n){const u=1<<p.z;return[p.x/u+n,(p.x+1)/u+n]}va.maxOverzooming=10,va.maxUnderzooming=3;class kh{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,u=!1;for(const m in this.style._mergedLayers){const x=this.style._mergedLayers[m];if(x.type==="fill-extrusion"||x.type==="building")this.layers.push({layer:x,visible:n,visibilityChanged:u});else if(x.type==="model"){const A=this.style.getLayerSource(x);A&&A.type==="batched-model"&&this.layers.push({layer:x,visible:n,visibilityChanged:u})}}}onNewFrame(n){this.layersGotHidden=!1;for(const u of this.layers){const m=u.layer;let x=!1;m.type==="fill-extrusion"?x=!m.isHidden(n)&&m.paint.get("fill-extrusion-opacity")>0:m.type==="building"?x=!m.isHidden(n)&&m.paint.get("building-opacity")>0:m.type==="model"&&(x=!m.isHidden(n)&&m.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&u.visible,u.visible=x}}updateZOffset(n,u){this.currentBuildingBuckets=[];for(const x of this.layers){const A=x.layer,S=this.style.getLayerSourceCache(A);let O=1;A.type==="fill-extrusion"?O=x.visible?A.paint.get("fill-extrusion-vertical-scale"):0:A.type==="building"&&(O=x.visible?A.paint.get("building-vertical-scale"):0);let D=S?S.getTile(u):null;if(!D&&S)for(const F in S._tiles){const N=S._tiles[F];if(u.canonical.isChildOf(N.tileID.canonical)){D=N;break}}this.currentBuildingBuckets.push({bucket:D?D.getBucket(A):null,tileID:D?D.tileID:u,verticalScale:O})}n.hasAnyZOffset=!1;let m=!1;for(let x=0;x<n.symbolInstances.length;x++){const A=n.symbolInstances.get(x),S=A.zOffset,O=this._getHeightAtTileOffset(u,A.tileAnchorX,A.tileAnchorY);A.zOffset=O!==Number.NEGATIVE_INFINITY?O:S,m||S===A.zOffset||(m=!0),n.hasAnyZOffset||A.zOffset===0||(n.hasAnyZOffset=!0)}m&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,u,m,x){let A=u,S=m;if(n.canonical.z!==x.canonical.z){const O=x.canonical,D=1/(1<<n.canonical.z-O.z);A=(u+n.canonical.x*a.al)*D-O.x*a.al|0,S=(m+n.canonical.y*a.al)*D-O.y*a.al|0}return{tileX:A,tileY:S}}_getHeightAtTileOffset(n,u,m){let x,A;for(let S=0;S<this.layers.length;++S){const O=this.layers[S].layer;if(O.type!=="fill-extrusion"&&O.type!=="building")continue;const{bucket:D,tileID:F,verticalScale:N}=this.currentBuildingBuckets[S];if(!D)continue;const{tileX:Z,tileY:$}=this._mapCoordToOverlappingTile(n,u,m,F),W=D.getHeightAtTileCoord(Z,$);W&&W.height!==void 0&&(W.hidden?x=W.height:A=Math.max(W.height*N,A||0))}if(A!==void 0)return A;for(let S=0;S<this.layers.length;++S){const O=this.layers[S];if(O.layer.type!=="model"||!O.visible)continue;const{bucket:D,tileID:F}=this.currentBuildingBuckets[S];if(!D)continue;const{tileX:N,tileY:Z}=this._mapCoordToOverlappingTile(n,u,m,F),$=D.getHeightAtTileCoord(N,Z);if($&&!$.hidden)return $.height===void 0&&x!==void 0?Math.min($.maxHeight,x)*$.verticalScale:$.height?$.height*$.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Tm(p,n){const u={};for(const m in p)m!=="ref"&&(u[m]=p[m]);return a.bx.forEach(m=>{m in n&&(u[m]=n[m])}),u}function Sm(p){p=p.slice();const n=Object.create(null);for(let u=0;u<p.length;u++)n[p[u].id]=p[u];for(let u=0;u<p.length;u++)"ref"in p[u]&&(p[u]=Tm(p[u],n[p[u].ref]));return p}const un={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Kc(p,n,u){u.push({command:un.addSource,args:[p,n[p]]})}function Qf(p,n,u){n.push({command:un.removeSource,args:[p]}),u[p]=!0}function os(p,n,u,m){Qf(p,u,m),Kc(p,n,u)}function $u(p,n,u){let m;for(m in p[u])if(p[u].hasOwnProperty(m)&&m!=="data"&&!a.by(p[u][m],n[u][m]))return!1;for(m in n[u])if(n[u].hasOwnProperty(m)&&m!=="data"&&!a.by(p[u][m],n[u][m]))return!1;return!0}function qu(p,n,u,m,x,A){let S;for(S in n=n||{},p=p||{})p.hasOwnProperty(S)&&(a.by(p[S],n[S])||u.push({command:A,args:[m,S,n[S],x]}));for(S in n)n.hasOwnProperty(S)&&!p.hasOwnProperty(S)&&(a.by(p[S],n[S])||u.push({command:A,args:[m,S,n[S],x]}))}function ml(p){return p.id}function Jf(p,n){return p[n.id]=n,p}function kd(p,n,u){const m=n.createTileMatrix(p,p.worldSize,u.toUnwrapped());return a.aB(new Float32Array(16),p.projMatrix,m)}function n_(p,n,u){if(n.projection.name===u.projection.name)return p.projMatrix;const m=u.clone();return m.setProjection(n.projection),kd(m,n.getProjection(),p)}function yc(p,n,u){return n.name===u.projection.name?p.projMatrix:kd(u,n,p)}class gl{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=a.aA(n,0,1);let u=1,m=this._distances[u];const x=n*this.paddedLength+this.padding;for(;m<x&&u<this._distances.length;)m=this._distances[++u];const A=u-1,S=this._distances[A],O=m-S,D=O>0?(x-S)/O:0;return this.points[A].mult(1-D).add(this.points[u].mult(D))}}class Fd{constructor(n,u,m){const x=this.boxCells=[],A=this.circleCells=[];this.xCellCount=Math.ceil(n/m),this.yCellCount=Math.ceil(u/m);for(let S=0;S<this.xCellCount*this.yCellCount;S++)x.push([]),A.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,m,x,A){this._forEachCell(u,m,x,A,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(A)}insertCircle(n,u,m,x){this._forEachCell(u-x,m-x,u+x,m+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(m),this.circles.push(x)}_insertBoxCell(n,u,m,x,A,S){this.boxCells[A].push(S)}_insertCircleCell(n,u,m,x,A,S){this.circleCells[A].push(S)}_query(n,u,m,x,A,S){if(m<0||n>this.width||x<0||u>this.height)return!A&&[];const O=[];if(n<=0&&u<=0&&this.width<=m&&this.height<=x){if(A)return!0;for(let D=0;D<this.boxKeys.length;D++)O.push({key:this.boxKeys[D],x1:this.bboxes[4*D],y1:this.bboxes[4*D+1],x2:this.bboxes[4*D+2],y2:this.bboxes[4*D+3]});for(let D=0;D<this.circleKeys.length;D++){const F=this.circles[3*D],N=this.circles[3*D+1],Z=this.circles[3*D+2];O.push({key:this.circleKeys[D],x1:F-Z,y1:N-Z,x2:F+Z,y2:N+Z})}return S?O.filter(S):O}return this._forEachCell(n,u,m,x,this._queryCell,O,{hitTest:A,seenUids:{box:{},circle:{}}},S),A?O.length>0:O}_queryCircle(n,u,m,x,A){const S=n-m,O=n+m,D=u-m,F=u+m;if(O<0||S>this.width||F<0||D>this.height)return!x&&[];const N=[];return this._forEachCell(S,D,O,F,this._queryCellCircle,N,{hitTest:x,circle:{x:n,y:u,radius:m},seenUids:{box:{},circle:{}}},A),x?N.length>0:N}query(n,u,m,x,A){return this._query(n,u,m,x,!1,A)}hitTest(n,u,m,x,A){return this._query(n,u,m,x,!0,A)}hitTestCircle(n,u,m,x){return this._queryCircle(n,u,m,!0,x)}_queryCell(n,u,m,x,A,S,O,D){const F=O.seenUids,N=this.boxCells[A];if(N!==null){const $=this.bboxes;for(const W of N)if(!F.box[W]){F.box[W]=!0;const ne=4*W;if(n<=$[ne+2]&&u<=$[ne+3]&&m>=$[ne+0]&&x>=$[ne+1]&&(!D||D(this.boxKeys[W]))){if(O.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[W],x1:$[ne],y1:$[ne+1],x2:$[ne+2],y2:$[ne+3]})}}}const Z=this.circleCells[A];if(Z!==null){const $=this.circles;for(const W of Z)if(!F.circle[W]){F.circle[W]=!0;const ne=3*W;if(this._circleAndRectCollide($[ne],$[ne+1],$[ne+2],n,u,m,x)&&(!D||D(this.circleKeys[W]))){if(O.hitTest)return S.push(!0),!0;{const te=$[ne],ae=$[ne+1],le=$[ne+2];S.push({key:this.circleKeys[W],x1:te-le,y1:ae-le,x2:te+le,y2:ae+le})}}}}}_queryCellCircle(n,u,m,x,A,S,O,D){const F=O.circle,N=O.seenUids,Z=this.boxCells[A];if(Z!==null){const W=this.bboxes;for(const ne of Z)if(!N.box[ne]){N.box[ne]=!0;const te=4*ne;if(this._circleAndRectCollide(F.x,F.y,F.radius,W[te+0],W[te+1],W[te+2],W[te+3])&&(!D||D(this.boxKeys[ne])))return S.push(!0),!0}}const $=this.circleCells[A];if($!==null){const W=this.circles;for(const ne of $)if(!N.circle[ne]){N.circle[ne]=!0;const te=3*ne;if(this._circlesCollide(W[te],W[te+1],W[te+2],F.x,F.y,F.radius)&&(!D||D(this.circleKeys[ne])))return S.push(!0),!0}}}_forEachCell(n,u,m,x,A,S,O,D){const F=this._convertToXCellCoord(n),N=this._convertToYCellCoord(u),Z=this._convertToXCellCoord(m),$=this._convertToYCellCoord(x);for(let W=F;W<=Z;W++)for(let ne=N;ne<=$;ne++)if(A.call(this,n,u,m,x,this.xCellCount*ne+W,S,O,D))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,m,x,A,S){const O=x-n,D=A-u,F=m+S;return F*F>O*O+D*D}_circleAndRectCollide(n,u,m,x,A,S,O){const D=(S-x)/2,F=Math.abs(n-(x+D));if(F>D+m)return!1;const N=(O-A)/2,Z=Math.abs(u-(A+N));if(Z>N+m)return!1;if(F<=D||Z<=N)return!0;const $=F-D,W=Z-N;return $*$+W*W<=m*m}}const sv=Math.tan(85*Math.PI/180);function Fh(p,n,u,m,x,A,S){const O=a.bC();if(u)if(A.name==="globe"){const D=a.bD(x,n);a.aB(O,O,D)}else{const D=a.bE([],S);O[0]=D[0],O[1]=D[1],O[4]=D[2],O[5]=D[3],m||a.bB(O,O,x.angle)}else a.aB(O,x.labelPlaneMatrix,p);return O}function Qc(p,n,u,m,x,A,S){const O=Fh(p,n,u,m,x,A,S);return A.name==="globe"&&u||(O[2]=O[6]=O[10]=O[14]=0),O}function Do(p,n,u,m,x,A,S){if(u){if(A.name==="globe"){const O=Fh(p,n,u,m,x,A,S);return a.bl(O,O),a.aB(O,p,O),O}{const O=a.bz(p),D=a.bA([]);return D[0]=S[0],D[1]=S[1],D[4]=S[2],D[5]=S[3],a.aB(O,O,D),m||a.bB(O,O,-x.angle),O}}return x.glCoordMatrix}function _l(p,n,u,m){const x=[p,n,u,1];u?a.aC(x,x,m):Mm(x,x,m);const A=x[3];return x[0]/=A,x[1]/=A,x[2]/=A,x}function Em(p,n){return Math.min(.5+p/n*.5,1.5)}function lv(p,n){const u=p[0]/p[3],m=p[1]/p[3];return u>=-n[0]&&u<=n[0]&&m>=-n[1]&&m<=n[1]}function Cn(p,n,u,m,x,A,S,O,D,F,N=1){const Z=u.transform,$=m?p.textSizeData:p.iconSizeData,W=a.bK($,u.transform.zoom,N),ne=Z.projection.name==="globe",te=[256/u.width*2+1,256/u.height*2+1],ae=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;ae.clear();let le=null;ne&&(le=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const be=p.lineVertexArray,xe=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,ye=u.transform.width/u.transform.height;let Re,Ce=!1;for(let De=0;De<xe.length;De++){const Me=xe.get(De),{numGlyphs:Te,writingMode:Ne}=Me;if(Ne!==a.bL.vertical||Ce||Re===a.bL.horizontal||(Ce=!0),Re=Ne,(Me.hidden||Ne===a.bL.vertical)&&!Ce){vo(Te,ae);continue}Ce=!1;const Ve=new a.P(Me.tileAnchorX,Me.tileAnchorY),He=p.elevationType==="road",Qe=!!Z.elevation||He;let{x:We,y:ut,z:wt}=Z.projection.projectTilePoint(Ve.x,Ve.y,F.canonical),et=null;if(Qe){const lr=He?p.getElevationFeatureForText(De):null;et={getElevation:D,elevation:Z.elevation,elevationFeature:lr};const[xr,Ir,Vr]=D(Ve,Z.elevation,lr);We+=xr,ut+=Ir,wt+=Vr}const je=[We,ut,wt,1];if(a.aC(je,je,n),!lv(je,te)){vo(Te,ae);continue}const mt=je[3],ot=Em(u.transform.getCameraToCenterDistance(Z.projection),mt),bt=a.bM($,W,Me),zt=S?bt/ot:bt*ot,qt=_l(We,ut,wt,x);if(qt[3]<=0){vo(Te,ae);continue}let kt={};const Lt=a.an(p.layers[0].layout.get("text-max-angle")),hr=Math.cos(Lt),sr=S?null:et,Zt=cv(Me,zt,!1,O,n,x,A,p.glyphOffsetArray,be,ae,le,qt,Ve,kt,ye,sr,Z.projection,F,S,hr);Ce=Zt.useVertical,sr&&Zt.needsFlipping&&(kt={}),(Zt.notEnoughRoom||Ce||Zt.needsFlipping&&cv(Me,zt,!0,O,n,x,A,p.glyphOffsetArray,be,ae,le,qt,Ve,kt,ye,sr,Z.projection,F,S,hr).notEnoughRoom)&&vo(Te,ae)}m?(p.text.dynamicLayoutVertexBuffer.updateData(ae),le&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(le)):(p.icon.dynamicLayoutVertexBuffer.updateData(ae),le&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(le))}function i_(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae){const{lineStartIndex:le,glyphStartIndex:be,segment:xe}=O,ye=be+O.numGlyphs,Re=le+O.lineLength,Ce=n.getoffsetX(be),De=n.getoffsetX(ye-1),Me=Nh(p*Ce,u,m,x,A,S,xe,le,Re,D,F,N,Z,$,!0,W,ne,te,ae);if(!Me)return null;const Te=Nh(p*De,u,m,x,A,S,xe,le,Re,D,F,N,Z,$,!0,W,ne,te,ae);return Te?{first:Me,last:Te}:null}function a_(p,n,u,m){return p===a.bL.horizontal&&Math.abs(m)>Math.abs(u)?{useVertical:!0}:p===a.bL.vertical?m>0?{needsFlipping:!0}:null:n!==0&&(function(x,A){return x===0||Math.abs(A/x)>sv})(u,m)?n===1?{needsFlipping:!0}:null:u<0?{needsFlipping:!0}:null}function cv(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be,xe){const ye=n/24,Re=p.lineOffsetX*ye,Ce=p.lineOffsetY*ye,{lineStartIndex:De,glyphStartIndex:Me,numGlyphs:Te,segment:Ne,writingMode:Ve,flipState:He}=p,Qe=De+p.lineLength,We=ut=>{if(N){const[mt,ot,bt]=ut.up,zt=F.length;a.bN(N,zt+0,mt,ot,bt),a.bN(N,zt+1,mt,ot,bt),a.bN(N,zt+2,mt,ot,bt),a.bN(N,zt+3,mt,ot,bt)}const[wt,et,je]=ut.point;a.bO(F,wt,et,je,ut.angle)};if(Te>1){const ut=i_(ye,O,Re,Ce,u,Z,$,p,D,A,W,te,!1,ae,le,be,xe);if(!ut)return{notEnoughRoom:!0};if(m&&!u){let[wt,et,je]=ut.first.point,[mt,ot,bt]=ut.last.point;[wt,et]=_l(wt,et,je,S),[mt,ot]=_l(mt,ot,bt,S);const zt=a_(Ve,He,(mt-wt)*ne,ot-et);if(p.flipState=zt&&zt.needsFlipping?1:2,zt)return zt}We(ut.first);for(let wt=Me+1;wt<Me+Te-1;wt++){const et=Nh(ye*O.getoffsetX(wt),Re,Ce,u,Z,$,Ne,De,Qe,D,A,W,te,!1,!1,ae,le,be,xe);if(!et)return F.length-=4*(wt-Me),{notEnoughRoom:!0};We(et)}We(ut.last)}else{if(m&&!u){const wt=_l($.x,$.y,0,x),et=De+Ne+1,je=new a.P(D.getx(et),D.gety(et)),mt=_l(je.x,je.y,0,x),ot=mt[3]>0?mt:o_($,je,wt,1,x,void 0,ae,le.canonical),bt=a_(Ve,He,(ot[0]-wt[0])*ne,ot[1]-wt[1]);if(p.flipState=bt&&bt.needsFlipping?1:2,bt)return bt}const ut=Nh(ye*O.getoffsetX(Me),Re,Ce,u,Z,$,Ne,De,Qe,D,A,W,te,!1,!1,ae,le,be,xe);if(!ut)return{notEnoughRoom:!0};We(ut)}return{}}function Dr(p,n,u,m,x){const{x:A,y:S,z:O}=m.projectTilePoint(p.x,p.y,n);if(!x)return _l(A,S,O,u);const[D,F,N]=x.getElevation(p,x.elevation,x.elevationFeature);return _l(A+D,S+F,O+N,u)}function o_(p,n,u,m,x,A,S,O){const D=Dr(p.sub(n)._unit()._add(p),O,x,S,A);return a.av(D,u,D),a.aw(D,D),a.bH(D,u,D,m)}function Nh(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be){const xe=m?p-n:p+n;let ye=xe>0?1:-1,Re=0;m&&(ye*=-1,Re=Math.PI),ye<0&&(Re+=Math.PI);let Ce=O+S+(ye>0?0:1)|0,De=x,Me=x,Te=0,Ne=0;const Ve=Math.abs(xe),He=[],Qe=[];let We=A,ut=We,wt=a.bF([]);const et=()=>o_(ut,We,Me,Ve-Te+1,N,$,te,ae.canonical);for(;Te+Ne<=Ve;){if(Ce+=ye,Ce<O||Ce>=D)return null;if(Me=De,ut=We,He.push(Me),W&&Qe.push(ut),We=new a.P(F.getx(Ce),F.gety(Ce)),De=Z[Ce],!De){const sr=Dr(We,ae.canonical,N,te,$);De=sr[3]>0?Z[Ce]=sr:et()}Te+=Ne;const Lt=a.av([],De,Me),hr=a.bG(Me,De);if(u&&hr>0&&Ne>0&&a.bJ(wt,Lt)/(Ne*hr)<be)return null;Ne=hr,wt=Lt}ne&&$&&(Z[Ce]&&(De=et(),Ne=a.bG(Me,De),wt=a.av([],De,Me)),Z[Ce]=De);const je=(Ve-Te)/Ne,mt=We.sub(ut)._mult(je)._add(ut),ot=a.bH([],Me,wt,je);let bt=[0,0,1],zt=wt[0],qt=wt[1];if(le&&(bt=te.upVector(ae.canonical,mt.x,mt.y),bt[0]!==0||bt[1]!==0||bt[2]!==1)){const Lt=[bt[2],0,-bt[0]],hr=a.bI([],bt,Lt);a.aw(Lt,Lt),a.aw(hr,hr),zt=a.bJ(wt,Lt),qt=a.bJ(wt,hr)}if(u){const Lt=a.bI([],bt,wt);a.aw(Lt,Lt),a.bH(ot,ot,Lt,u*ye)}const kt=Re+Math.atan2(qt,zt);return He.push(ot),W&&Qe.push(mt),{point:ot,angle:kt,path:He,tilePath:Qe,up:bt}}function vo(p,n){const u=n.length,m=u+4*p;n.resize(m),n.float32.fill(-1/0,4*u,4*m)}function Mm(p,n,u){const m=n[0],x=n[1];return p[0]=u[0]*m+u[4]*x+u[12],p[1]=u[1]*m+u[5]*x+u[13],p[3]=u[3]*m+u[7]*x+u[15],p}const ss=100;class _r{constructor(n,u,m=new Fd(n.width+200,n.height+200,25),x=new Fd(n.width+200,n.height+200,25)){this.transform=n,this.grid=m,this.ignoredGrid=x,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+ss,this.screenBottomBoundary=n.height+ss,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=u}placeCollisionBox(n,u,m,x,A,S,O,D,F,N,Z){let $=m.projectedAnchorX,W=m.projectedAnchorY,ne=m.projectedAnchorZ;const te=m.tileAnchorX,ae=m.tileAnchorY,le=m.elevation,be=m.tileID,xe=n.getProjection();if(le&&be){const[Qe,We,ut]=xe.upVector(be.canonical,m.tileAnchorX,m.tileAnchorY),wt=xe.upVectorScale(be.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;$+=Qe*le*wt,W+=We*le*wt,ne+=ut*le*wt}const ye=n.projection.name==="globe",Re=n.projection.name==="globe"?a.aj(this.transform.zoom):0;if(be&&ye&&Re<1&&!S){const Qe=1<<be.canonical.z,We=a.bP(te,ae);a.bQ(We,We,1/a.al),a.bR(We,We,a.bP(be.canonical.x,be.canonical.y)),a.bQ(We,We,1/Qe),a.bS(We,We,a.bP(x[0],x[1])),We[0]=a.bT(We[0],-.5,.5),a.bQ(We,We,a.al);const ut=a.bU(We[0],We[1],a.al/(2*Math.PI),1);a.aC(ut,ut,A),$=a.ak($,ut[0],Re),W=a.ak(W,ut[1],Re),ne=a.ak(ne,ut[2],Re)}const Ce=this.projectAndGetPerspectiveRatio(N,$,W,ne,m.tileID,xe.name==="globe"||!!le||this.transform.pitch>0,xe),De=F*Ce.perspectiveRatio,Me=(m.x1*u+O.x-m.padding)*De+Ce.point.x,Te=(m.y1*u+O.y-m.padding)*De+Ce.point.y,Ne=(m.x2*u+O.x+m.padding)*De+Ce.point.x,Ve=(m.y2*u+O.y+m.padding)*De+Ce.point.y,He=Ce.perspectiveRatio<=.55||Ce.occluded;return!this.isInsideGrid(Me,Te,Ne,Ve)||!D&&this.grid.hitTest(Me,Te,Ne,Ve,Z)||He?{box:[],offscreen:!1,occluded:Ce.occluded}:{box:[Me,Te,Ne,Ve],offscreen:this.isOffscreen(Me,Te,Ne,Ve),occluded:!1}}placeCollisionCircles(n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae){const le=[],be=this.transform.elevation,xe=n.getProjection(),ye=n.elevationType==="road",Re=!!be||ye,Ce=a.bV.getAtTileOffsetFunc(ae,this.transform.center.lat,this.transform.worldSize,xe),De=new a.P(m.tileAnchorX,m.tileAnchorY),Me=new a.P(m.tileAnchorX,m.tileAnchorY);let{x:Te,y:Ne,z:Ve}=xe.projectTilePoint(Me.x,Me.y,ae.canonical),He=null;if(Re){const hr=ye?n.getElevationFeatureForText(x):null;He={getElevation:Ce,elevation:be,elevationFeature:hr};const[sr,Zt,lr]=Ce(De,be,hr);Te+=sr,Ne+=Zt,Ve+=lr}const Qe=xe.name==="globe",We=this.projectAndGetPerspectiveRatio(D,Te,Ne,Ve,ae,Qe||!!be||this.transform.pitch>0,xe),{perspectiveRatio:ut}=We,wt=($?O/ut:O*ut)/a.bY,et=_l(Te,Ne,Ve,F),je=m.lineOffsetX*wt,mt=m.lineOffsetY*wt,ot=a.an(n.layers[0].layout.get("text-max-angle")),bt=Math.cos(ot),zt=We.signedDistanceFromCamera>0?i_(wt,S,je,mt,ye&&m.flipState===1,et,Me,m,A,F,{},Re&&!$?He:null,$&&Re,xe,ae,$,bt):null;let qt=!1,kt=!1,Lt=!0;if(zt&&!We.occluded){const hr=.5*ne*ut+te,sr=new a.P(-100,-100),Zt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),lr=new gl,{first:xr,last:Ir}=zt,Vr=xr.path.length;let tn=[];for(let Lr=Vr-1;Lr>=1;Lr--)tn.push(xr.path[Lr]);for(let Lr=1;Lr<Ir.path.length;Lr++)tn.push(Ir.path[Lr]);const Pr=2.5*hr;N&&(tn=tn.map(([Lr,yn,hn],Pn)=>(Re&&!Qe&&(hn=Ce(Pn<Vr-1?xr.tilePath[Vr-1-Pn]:Ir.tilePath[Pn-Vr+2],be,He.elevationFeature)[2]),_l(Lr,yn,hn,N))),tn.some(Lr=>Lr[3]<=0)&&(tn=[]));let Gr=[];if(tn.length>0){let Lr=1/0,yn=-1/0,hn=1/0,Pn=-1/0;for(const ln of tn)Lr=Math.min(Lr,ln[0]),hn=Math.min(hn,ln[1]),yn=Math.max(yn,ln[0]),Pn=Math.max(Pn,ln[1]);yn>=sr.x&&Lr<=Zt.x&&Pn>=sr.y&&hn<=Zt.y&&(Gr=[tn.map(ln=>new a.P(ln[0],ln[1]))],(Lr<sr.x||yn>Zt.x||hn<sr.y||Pn>Zt.y)&&(Gr=a.bW(Gr,sr.x,sr.y,Zt.x,Zt.y)))}for(const Lr of Gr){lr.reset(Lr,.25*hr);let yn=0;yn=lr.length<=.5*hr?1:Math.ceil(lr.paddedLength/Pr)+1;for(let hn=0;hn<yn;hn++){const Pn=hn/Math.max(yn-1,1),ln=lr.lerp(Pn),$r=ln.x+ss,mn=ln.y+ss;le.push($r,mn,hr,0);const hi=$r-hr,Dn=mn-hr,wn=$r+hr,Nr=mn+hr;if(Lt=Lt&&this.isOffscreen(hi,Dn,wn,Nr),kt=kt||this.isInsideGrid(hi,Dn,wn,Nr),!u&&this.grid.hitTestCircle($r,mn,hr,W)&&(qt=!0,!Z))return{circles:[],offscreen:!1,collisionDetected:qt,occluded:!1}}}}return{circles:!Z&&qt||!kt?[]:le,offscreen:Lt,collisionDetected:qt,occluded:We.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const u=[];let m=1/0,x=1/0,A=-1/0,S=-1/0;for(const N of n){const Z=new a.P(N.x+ss,N.y+ss);m=Math.min(m,Z.x),x=Math.min(x,Z.y),A=Math.max(A,Z.x),S=Math.max(S,Z.y),u.push(Z)}const O=this.grid.query(m,x,A,S).concat(this.ignoredGrid.query(m,x,A,S)),D={},F={};for(const N of O){const Z=N.key;if(D[Z.bucketInstanceId]===void 0&&(D[Z.bucketInstanceId]={}),D[Z.bucketInstanceId][Z.featureIndex])continue;const $=[new a.P(N.x1,N.y1),new a.P(N.x2,N.y1),new a.P(N.x2,N.y2),new a.P(N.x1,N.y2)];a.bX(u,$)&&(D[Z.bucketInstanceId][Z.featureIndex]=!0,F[Z.bucketInstanceId]===void 0&&(F[Z.bucketInstanceId]=[]),F[Z.bucketInstanceId].push(Z.featureIndex))}return F}insertCollisionBox(n,u,m,x,A){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:A},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,m,x,A){const S=u?this.ignoredGrid:this.grid,O={bucketInstanceId:m,featureIndex:x,collisionGroupID:A};for(let D=0;D<n.length;D+=4)S.insertCircle(O,n[D],n[D+1],n[D+2])}projectAndGetPerspectiveRatio(n,u,m,x,A,S,O){const D=[u,m,x,1];let F=!1;x||this.transform.pitch>0?(a.aC(D,D,n),this.fogState&&A&&O.name!=="globe"&&(F=(function($,W,ne,te,ae,le){const be=le.calculateFogTileMatrix(ae),xe=[W,ne,te];return a.af(xe,xe,be),dr($,a.ag(xe),le.pitch,le._fov)})(this.fogState,u,m,x,A.toUnwrapped(),this.transform)>.9)):Mm(D,D,n);const N=D[3];return{point:new a.P((D[0]/N+1)/2*this.transform.width+ss,(-D[1]/N+1)/2*this.transform.height+ss),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/N*.5,1.5),signedDistanceFromCamera:N,occluded:S&&D[2]>N||F}}isOffscreen(n,u,m,x){return m<ss||n>=this.screenRightBoundary||x<ss||u>this.screenBottomBoundary}isInsideGrid(n,u,m,x){return m>=0&&n<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=a.bA([]);return a.br(n,n,[-100,-100,0]),n}}class En{constructor(n,u,m,x){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):x&&m?1:0,this.placed=m}isHidden(){return this.opacity===0&&!this.placed}}class bn{constructor(n,u,m,x,A,S=!1){this.text=new En(n?n.text:null,u,m,A),this.icon=new En(n?n.icon:null,u,x,A),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Zo{constructor(n,u,m,x=!1){this.text=n,this.icon=u,this.skipFade=m,this.clipped=x}}class Nd{constructor(){this.invProjMatrix=a.bC(),this.viewportMatrix=a.bC(),this.circles=[]}}class Ln{constructor(n,u,m,x,A){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=x,this.tileID=A}}class Om{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[n]}}function jd(p,n,u,m,x){const{horizontalAlign:A,verticalAlign:S}=a.c1(p),O=-(A-.5)*n,D=-(S-.5)*u,F=a.c2(p,m);return new a.P(O+F[0]*x,D+F[1]*x)}function jh(p,n,u,m,x){const A=new a.P(p,n);return u&&A._rotate(m?x:-x),A}class Ro{constructor(n,u,m,x,A,S){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new _r(this.transform,A),this.buildingIndex=S,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Om(m),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={},this.lastReplacementSourceUpdateTime=0}getBucketParts(n,u,m,x,A=1){const S=m.getBucket(u),O=m.latestFeatureIndex;if(!S||!O||u.fqid!==S.layerIds[0])return;const D=S.layers[0].layout,F=S.layers[0].paint,N=m.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),$=m.tileSize/a.al,W=m.tileID.toUnwrapped();this.transform.setProjection(S.projection);const ne=(te=m.tileID,ae=S.getProjection(),le=this.transform,ae.name===this.projection?le.calculateProjMatrix(te.toUnwrapped()):kd(le,ae,te));var te,ae,le;const be=D.get("text-pitch-alignment")==="map",xe=D.get("text-rotation-alignment")==="map";u.compileFilter(u.options);const ye=u.dynamicFilter(),Re=u.dynamicFilterNeedsFeature(),Ce=this.transform.calculatePixelsToTileUnitsMatrix(m),De=Qc(ne,m.tileID.canonical,be,xe,this.transform,S.getProjection(),Ce);let Me=null;const Te=S.getProjection().createInversionMatrix(this.transform,m.tileID.canonical);if(be){const je=Do(ne,m.tileID.canonical,be,xe,this.transform,S.getProjection(),Ce);Me=a.aB([],this.transform.labelPlaneMatrix,je)}let Ne=null;ye&&m.latestFeatureIndex&&(Ne={unwrappedTileID:W,dynamicFilter:ye,dynamicFilterNeedsFeature:Re}),this.retainedQueryData[S.bucketInstanceId]=new Ln(S.bucketInstanceId,O,S.sourceLayerIndex,S.index,m.tileID);const[Ve,He]=S.layers[0].layout.get("text-size-scale-range"),Qe=a.aA(A,Ve,He),[We,ut]=D.get("icon-size-scale-range"),wt=a.aA(A,We,ut),et={bucket:S,layout:D,paint:F,posMatrix:ne,invMatrix:Te,mercatorCenter:[a.aF(this.transform.center.lng),a.aJ(this.transform.center.lat)],textLabelPlaneMatrix:De,labelToScreenMatrix:Me,clippingData:Ne,scale:Z,textPixelRatio:$,holdingForFade:m.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:a.bK(S.textSizeData,this.transform.zoom,Qe),partiallyEvaluatedIconSize:a.bK(S.iconSizeData,this.transform.zoom,wt),collisionGroup:this.collisionGroups.get(S.sourceID),latestFeatureIndex:m.latestFeatureIndex};if(x)for(const je of S.sortKeyRanges){const{sortKey:mt,symbolInstanceStart:ot,symbolInstanceEnd:bt}=je;n.push({sortKey:mt,symbolInstanceStart:ot,symbolInstanceEnd:bt,parameters:et})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:et})}attemptAnchorPlacement(n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be,xe,ye,Re){const{textOffset0:Ce,textOffset1:De,crossTileID:Me}=te,Te=[Ce,De],Ne=jd(n,S,O,Te,D),Ve=this.collisionIndex.placeCollisionBox(le,D,u,m,x,A,jh(Ne.x,Ne.y,F,N,this.transform.angle),ne,Z,$,W.predicate);if(xe){const He=le.getSymbolInstanceIconSize(Re,this.transform.zoom,te.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(le,He,xe,m,x,A,jh(Ne.x,Ne.y,F,N,this.transform.angle),ne,Z,$,W.predicate).box.length===0)return}if(Ve.box.length>0){let He;return this.prevPlacement&&this.prevPlacement.variableOffsets[Me]&&this.prevPlacement.placements[Me]&&this.prevPlacement.placements[Me].text&&(He=this.prevPlacement.variableOffsets[Me].anchor),this.variableOffsets[Me]={textOffset:Te,width:S,height:O,anchor:n,textScale:D,prevAnchor:He},this.markUsedJustification(le,n,te,be),le.allowVerticalPlacement&&(this.markUsedOrientation(le,be,te),this.placedOrientations[Me]=be),{shift:Ne,placedGlyphBoxes:Ve}}}placeLayerBucketPart(n,u,m,x,A=1){const{bucket:S,layout:O,paint:D,posMatrix:F,textLabelPlaneMatrix:N,labelToScreenMatrix:Z,clippingData:$,textPixelRatio:W,mercatorCenter:ne,invMatrix:te,holdingForFade:ae,collisionBoxArray:le,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:xe,collisionGroup:ye,latestFeatureIndex:Re}=n.parameters,Ce=O.get("text-optional"),De=O.get("icon-optional"),Me=O.get("text-allow-overlap"),Te=O.get("icon-allow-overlap"),Ne=O.get("text-rotation-alignment")==="map",Ve=O.get("icon-rotation-alignment")==="map",He=O.get("text-pitch-alignment")==="map",Qe=D.get("symbol-z-offset"),We=O.get("symbol-elevation-reference")==="sea",ut=O.get("symbol-placement"),[wt,et]=O.get("text-size-scale-range"),[je,mt]=O.get("icon-size-scale-range"),ot=a.aA(A,wt,et),bt=a.aA(A,je,mt),zt=O.get("text-variable-anchor"),qt=Ne&&ut!=="point",kt=Ve&&ut!=="point",Lt=zt&&S.hasTextData(),hr=S.hasIconTextFit()&&Lt&&S.hasIconData();this.transform.setProjection(S.projection);const sr=Lt||qt,Zt=kt||hr;let lr=Me&&(Te||!S.hasIconData()||De),xr=Te&&(Me||!S.hasTextData()||Ce);const Ir=!Qe.isConstant();!S.collisionArrays&&le&&S.deserializeCollisionBoxes(le),m&&x&&S.updateCollisionDebugBuffers(this.transform.zoom,le,ot,bt);const Vr=(Pr,Gr,Lr)=>{const{crossTileID:yn,numVerticalGlyphVertices:hn}=Pr;let Pn=null;if($&&$.dynamicFilterNeedsFeature||Ir){const xi=this.retainedQueryData[S.bucketInstanceId];Pn=Re.loadFeature({featureIndex:Pr.featureIndex,bucketIndex:xi.bucketIndex,sourceLayerIndex:xi.sourceLayerIndex,layoutVertexArrayOffset:0});const Hi=Pn.properties?Pn.properties.worldview:null;if(S.localizable&&S.worldview&&typeof Hi=="string")if(Hi==="all")Pn.properties.$localized=!0;else{if(!Hi.split(",").includes(S.worldview))return;Pn.properties.$localized=!0,Pn.properties.worldview=S.worldview}}if($&&!(0,$.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch,worldview:S.worldview},Pn,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new a.P(Pr.tileAnchorX,Pr.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[yn]=new Zo(!1,!1,!1,!0),void u.add(yn);const ln=Qe.evaluate(Pn,{});if(u.has(yn))return;if(ae)return void(this.placements[yn]=new Zo(!1,!1,!1));let $r=!1,mn=!1,hi=!0,Dn=!1,wn=!1,Nr=null,qr={box:null,offscreen:null,occluded:null},Kn={box:null},Ii=null,kn=null,Qn=null,Ao=0,Ka=0,Oa=0;Lr.textFeatureIndex?Ao=Lr.textFeatureIndex:Pr.useRuntimeCollisionCircles&&(Ao=Pr.featureIndex),Lr.verticalTextFeatureIndex&&(Ka=Lr.verticalTextFeatureIndex);const An=S.elevationFeatures?S.elevationFeatures[Pr.elevationFeatureIndex]:void 0,ms=xi=>{xi.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const Hi=this.transform.elevation;xi.elevation=We?ln:ln+a.bV.getAtTileOffset(xi.tileID,new a.P(xi.tileAnchorX,xi.tileAnchorY),Hi,An),xi.elevation+=Pr.zOffset},Qa=Lr.textBox;if(Qa){ms(Qa);const xi=ri=>{let Ji=a.bL.horizontal;if(S.allowVerticalPlacement&&!ri&&this.prevPlacement){const ba=this.prevPlacement.placedOrientations[yn];ba&&(this.placedOrientations[yn]=ba,Ji=ba,this.markUsedOrientation(S,Ji,Pr))}return Ji},Hi=(ri,Ji)=>{if(S.allowVerticalPlacement&&hn>0&&Lr.verticalTextBox){for(const ba of S.writingModes)if(ba===a.bL.vertical?(qr=Ji(),Kn=qr):qr=ri(),qr&&qr.box&&qr.box.length)break}else qr=ri()};if(zt){let ri=zt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[yn]){const Ei=this.prevPlacement.variableOffsets[yn];ri.indexOf(Ei.anchor)>0&&(ri=ri.filter(gs=>gs!==Ei.anchor),ri.unshift(Ei.anchor))}const Ji=(Ei,gs,Af)=>{const Jl=S.getSymbolInstanceTextSize(be,Pr,this.transform.zoom,Gr),_d=(Ei.x2-Ei.x1)*Jl+2*Ei.padding,yd=(Ei.y2-Ei.y1)*Jl+2*Ei.padding,_s=Pr.hasIconTextFit&&!Te?gs:null;_s&&ms(_s);let nl={box:[],offscreen:!1,occluded:!1};const ec=Me?2*ri.length:ri.length;for(let Ns=0;Ns<ec;++Ns){const oi=this.attemptAnchorPlacement(ri[Ns%ri.length],Ei,ne,te,sr,_d,yd,Jl,Ne,He,W,F,ye,Ns>=ri.length,Pr,Gr,S,Af,_s,be,xe);if(oi&&(nl=oi.placedGlyphBoxes,nl&&nl.box&&nl.box.length)){$r=!0,Nr=oi.shift;break}}return nl};Hi(()=>Ji(Qa,Lr.iconBox,a.bL.horizontal),()=>{const Ei=Lr.verticalTextBox;return Ei&&ms(Ei),S.allowVerticalPlacement&&!(qr&&qr.box&&qr.box.length)&&hn>0&&Ei?Ji(Ei,Lr.verticalIconBox,a.bL.vertical):{box:null,offscreen:null,occluded:null}}),qr&&($r=qr.box,hi=qr.offscreen,Dn=qr.occluded);const ba=xi(!(!qr||!qr.box));if(!$r&&this.prevPlacement){const Ei=this.prevPlacement.variableOffsets[yn];Ei&&(this.variableOffsets[yn]=Ei,this.markUsedJustification(S,Ei.anchor,Pr,ba))}}else{const ri=(Ji,ba)=>{const Ei=S.getSymbolInstanceTextSize(be,Pr,this.transform.zoom,Gr),gs=this.collisionIndex.placeCollisionBox(S,Ei,Ji,ne,te,sr,new a.P(0,0),Me,W,F,ye.predicate);return gs&&gs.box&&gs.box.length&&(this.markUsedOrientation(S,ba,Pr),this.placedOrientations[yn]=ba),gs};Hi(()=>ri(Qa,a.bL.horizontal),()=>{const Ji=Lr.verticalTextBox;return S.allowVerticalPlacement&&hn>0&&Ji?(ms(Ji),ri(Ji,a.bL.vertical)):{box:null,offscreen:null,occluded:null}}),xi(!!(qr&&qr.box&&qr.box.length))}}if(Ii=qr,$r=Ii&&Ii.box&&Ii.box.length>0,hi=Ii&&Ii.offscreen,Dn=Ii&&Ii.occluded,Pr.useRuntimeCollisionCircles){const xi=Pr.centerJustifiedTextSymbolIndex>=0?Pr.centerJustifiedTextSymbolIndex:Pr.verticalPlacedTextSymbolIndex,Hi=S.text.placedSymbolArray.get(xi),ri=a.bM(S.textSizeData,be,Hi),Ji=O.get("text-padding");kn=this.collisionIndex.placeCollisionCircles(S,Me,Hi,xi,S.lineVertexArray,S.glyphOffsetArray,ri,F,N,Z,m,He,ye.predicate,Pr.collisionCircleDiameter*ri/a.bY,Ji,this.retainedQueryData[S.bucketInstanceId].tileID),$r=Me||kn.circles.length>0&&!kn.collisionDetected,hi=hi&&kn.offscreen,Dn=kn.occluded}if(Lr.iconFeatureIndex&&(Oa=Lr.iconFeatureIndex),Lr.iconBox){const xi=Hi=>{ms(Hi);const ri=Pr.hasIconTextFit&&Nr?jh(Nr.x,Nr.y,Ne,He,this.transform.angle):new a.P(0,0),Ji=S.getSymbolInstanceIconSize(xe,this.transform.zoom,Pr.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Ji,Hi,ne,te,Zt,ri,Te,W,F,ye.predicate)};Kn&&Kn.box&&Kn.box.length&&Lr.verticalIconBox?(Qn=xi(Lr.verticalIconBox),mn=Qn.box.length>0):(Qn=xi(Lr.iconBox),mn=Qn.box.length>0),hi=hi&&Qn.offscreen,wn=Qn.occluded}const so=Ce||Pr.numHorizontalGlyphVertices===0&&hn===0,Fs=De||Pr.numIconVertices===0;if(so||Fs?Fs?so||(mn=mn&&$r):$r=mn&&$r:mn=$r=mn&&$r,$r&&Ii&&Ii.box&&this.collisionIndex.insertCollisionBox(Ii.box,O.get("text-ignore-placement"),S.bucketInstanceId,Kn&&Kn.box&&Ka?Ka:Ao,ye.ID),mn&&Qn&&this.collisionIndex.insertCollisionBox(Qn.box,O.get("icon-ignore-placement"),S.bucketInstanceId,Oa,ye.ID),kn&&($r&&this.collisionIndex.insertCollisionCircles(kn.circles,O.get("text-ignore-placement"),S.bucketInstanceId,Ao,ye.ID),m)){const xi=S.bucketInstanceId;let Hi=this.collisionCircleArrays[xi];Hi===void 0&&(Hi=this.collisionCircleArrays[xi]=new Nd);for(let ri=0;ri<kn.circles.length;ri+=4)Hi.circles.push(kn.circles[ri+0]),Hi.circles.push(kn.circles[ri+1]),Hi.circles.push(kn.circles[ri+2]),Hi.circles.push(kn.collisionDetected?1:0)}const Jo=S.projection.name!=="globe";lr=lr&&(Jo||!Dn),xr=xr&&(Jo||!wn),this.placements[yn]=new Zo($r||lr,mn||xr,hi||S.justReloaded),u.add(yn)},tn=this.retainedQueryData[S.bucketInstanceId].tileID;if(S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,tn),S.elevationType==="road"&&S.updateRoadElevation(tn.canonical),S.updateZOffset(),S.sortFeaturesByY){const Pr=S.getSortedSymbolIndexes(this.transform.angle);for(let Gr=Pr.length-1;Gr>=0;--Gr){const Lr=Pr[Gr];Vr(S.symbolInstances.get(Lr),Lr,S.collisionArrays[Lr])}S.hasAnyZOffset&&a.w(`${S.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(S.hasAnyZOffset){const Pr=S.getSortedIndexesByZOffset();for(let Gr=0;Gr<Pr.length;++Gr){const Lr=Pr[Gr];Vr(S.symbolInstances.get(Lr),Lr,S.collisionArrays[Lr])}}else for(let Pr=n.symbolInstanceStart;Pr<n.symbolInstanceEnd;Pr++)Vr(S.symbolInstances.get(Pr),Pr,S.collisionArrays[Pr]);if(m&&S.bucketInstanceId in this.collisionCircleArrays){const Pr=this.collisionCircleArrays[S.bucketInstanceId];a.bl(Pr.invProjMatrix,F),Pr.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(n,u,m,x){const{leftJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:D,crossTileID:F}=m,N=a.c3(u),Z=x===a.bL.vertical?D:N==="left"?A:N==="center"?S:N==="right"?O:-1;A>=0&&(n.text.placedSymbolArray.get(A).crossTileID=Z>=0&&A!==Z?0:F),S>=0&&(n.text.placedSymbolArray.get(S).crossTileID=Z>=0&&S!==Z?0:F),O>=0&&(n.text.placedSymbolArray.get(O).crossTileID=Z>=0&&O!==Z?0:F),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=Z>=0&&D!==Z?0:F)}markUsedOrientation(n,u,m){const x=u===a.bL.horizontal||u===a.bL.horizontalOnly?u:0,A=u===a.bL.vertical?u:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:F}=m,N=n.text.placedSymbolArray;S>=0&&(N.get(S).placedOrientation=x),O>=0&&(N.get(O).placedOrientation=x),D>=0&&(N.get(D).placedOrientation=x),F>=0&&(N.get(F).placedOrientation=A)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(n):1,A=u?u.opacities:{},S=u?u.variableOffsets:{},O=u?u.placedOrientations:{};for(const D in this.placements){const F=this.placements[D],N=A[D];N?(this.opacities[D]=new bn(N,x,F.text,F.icon,null,F.clipped),m=m||F.text!==N.text.placed||F.icon!==N.icon.placed):(this.opacities[D]=new bn(null,x,F.text,F.icon,F.skipFade,F.clipped),m=m||F.text||F.icon)}for(const D in A){const F=A[D];if(!this.opacities[D]){const N=new bn(F,x,!1,!1);N.isHidden()||(this.opacities[D]=N,m=m||F.text.placed||F.icon.placed)}}for(const D in S)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=S[D]);for(const D in O)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=O[D]);m?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u,m,x){x&&(this.lastReplacementSourceUpdateTime=x.updateTime);const A=new Set;for(const S of u){const O=S.getBucket(n);O&&S.latestFeatureIndex&&n.fqid===O.layerIds[0]&&(this.updateBucketOpacities(O,A,S,S.collisionBoxArray,m,x,S.tileID,n.scope),O.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(O,S.tileID),O.elevationType==="road"&&O.updateRoadElevation(S.tileID.canonical),O.updateZOffset())}}updateBucketOpacities(n,u,m,x,A,S,O,D){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const F=n.layers[0].layout,N=n.layers[0].paint,Z=!!n.layers[0].dynamicFilter(),$=new bn(null,0,!1,!1,!0),W=F.get("text-allow-overlap"),ne=F.get("icon-allow-overlap"),te=F.get("text-variable-anchor"),ae=F.get("text-rotation-alignment")==="map",le=F.get("text-pitch-alignment")==="map",be=N.get("symbol-z-offset"),xe=F.get("symbol-elevation-reference")==="sea",ye=!be.isConstant(),Re=new bn(null,0,W&&(ne||!n.hasIconData()||F.get("icon-optional")),ne&&(W||!n.hasTextData()||F.get("text-optional")),!0);!n.collisionArrays&&x&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(x);const Ce=(Me,Te,Ne)=>{for(let Ve=0;Ve<Te/4;Ve++)Me.opacityVertexArray.emplaceBack(Ne)};let De=0;S&&n.updateReplacement(O,S);for(let Me=0;Me<n.symbolInstances.length;Me++){const Te=n.symbolInstances.get(Me),{numHorizontalGlyphVertices:Ne,numVerticalGlyphVertices:Ve,crossTileID:He,numIconVertices:Qe,tileAnchorX:We,tileAnchorY:ut}=Te;let wt=null;const et=this.retainedQueryData[n.bucketInstanceId];ye&&Te&&et&&(wt=m.latestFeatureIndex.loadFeature({featureIndex:Te.featureIndex,bucketIndex:et.bucketIndex,sourceLayerIndex:et.sourceLayerIndex,layoutVertexArrayOffset:0}));const je=be.evaluate(wt,{}),mt=u.has(He);let ot=this.opacities[He];mt?ot=$:ot||(ot=Re,this.opacities[He]=ot),u.add(He);const bt=Ne>0||Ve>0,zt=Qe>0,qt=this.placedOrientations[He],kt=qt===a.bL.vertical,Lt=qt===a.bL.horizontal||qt===a.bL.horizontalOnly;!bt&&!zt||ot.isHidden()||De++;let hr=!1;if((bt||zt)&&S)for(const sr of n.activeReplacements){if(a.bZ(sr,A,a.b_.Symbol,D)||sr.min.x>We||We>sr.max.x||sr.min.y>ut||ut>sr.max.y)continue;const Zt=a.b$(We,ut,O.canonical,sr.footprintTileId.canonical);if(hr=a.c0(Zt,sr.footprint),hr)break}if(bt){const sr=hr?Wa:xo(ot.text);Ce(n.text,Ne,kt?Wa:sr),Ce(n.text,Ve,Lt?Wa:sr);const Zt=ot.text.isHidden(),{leftJustifiedTextSymbolIndex:lr,centerJustifiedTextSymbolIndex:xr,rightJustifiedTextSymbolIndex:Ir,verticalPlacedTextSymbolIndex:Vr}=Te,tn=n.text.placedSymbolArray,Pr=Zt||kt?1:0;lr>=0&&(tn.get(lr).hidden=Pr),xr>=0&&(tn.get(xr).hidden=Pr),Ir>=0&&(tn.get(Ir).hidden=Pr),Vr>=0&&(tn.get(Vr).hidden=Zt||Lt?1:0);const Gr=this.variableOffsets[He];Gr&&this.markUsedJustification(n,Gr.anchor,Te,qt);const Lr=this.placedOrientations[He];Lr&&(this.markUsedJustification(n,"left",Te,Lr),this.markUsedOrientation(n,Lr,Te))}if(zt){const sr=hr?Wa:xo(ot.icon),{placedIconSymbolIndex:Zt,verticalPlacedIconSymbolIndex:lr}=Te,xr=n.icon.placedSymbolArray,Ir=ot.icon.isHidden()?1:0;Zt>=0&&(Ce(n.icon,Qe,kt?Wa:sr),xr.get(Zt).hidden=Ir),lr>=0&&(Ce(n.icon,Te.numVerticalIconVertices,Lt?Wa:sr),xr.get(lr).hidden=Ir)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const sr=n.collisionArrays[Me];if(sr){let Zt=new a.P(0,0),lr=!0;if(sr.textBox||sr.verticalTextBox){if(te){const Ir=this.variableOffsets[He];Ir?(Zt=jd(Ir.anchor,Ir.width,Ir.height,Ir.textOffset,Ir.textScale),ae&&Zt._rotate(le?this.transform.angle:-this.transform.angle)):lr=!1}Z&&(lr=!ot.clipped),sr.textBox&&Wi(n.textCollisionBox.collisionVertexArray,ot.text.placed,!lr||kt,je,xe,Zt.x,Zt.y),sr.verticalTextBox&&Wi(n.textCollisionBox.collisionVertexArray,ot.text.placed,!lr||Lt,je,xe,Zt.x,Zt.y)}const xr=lr&&!!(!Lt&&sr.verticalIconBox);sr.iconBox&&Wi(n.iconCollisionBox.collisionVertexArray,ot.icon.placed,xr,je,xe,Te.hasIconTextFit?Zt.x:0,Te.hasIconTextFit?Zt.y:0),sr.verticalIconBox&&Wi(n.iconCollisionBox.collisionVertexArray,ot.icon.placed,!xr,je,xe,Te.hasIconTextFit?Zt.x:0,Te.hasIconTextFit?Zt.y:0)}}}if(n.fullyClipped=De===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const Me=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Me.invProjMatrix,n.placementViewportMatrix=Me.viewportMatrix,n.collisionCircleArray=Me.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>n}isStale(){return this.stale}setStale(){this.stale=!0}}function Wi(p,n,u,m,x,A,S){p.emplaceBack(n?1:0,u?1:0,A||0,S||0,m,x?1:0),p.emplaceBack(n?1:0,u?1:0,A||0,S||0,m,x?1:0),p.emplaceBack(n?1:0,u?1:0,A||0,S||0,m,x?1:0),p.emplaceBack(n?1:0,u?1:0,A||0,S||0,m,x?1:0)}const s_=Math.pow(2,25),Jc=Math.pow(2,24),l_=Math.pow(2,17),Ud=Math.pow(2,16),ep=Math.pow(2,9),Cm=Math.pow(2,8),tp=Math.pow(2,1);function xo(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const n=p.placed?1:0,u=Math.floor(127*p.opacity);return u*s_+n*Jc+u*l_+n*Ud+u*ep+n*Cm+u*tp+n}const Wa=0;class ls{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,u,m,x,A,S){const O=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(O,x,n[this._currentTileIndex],this._sortAcrossTiles,S),this._currentTileIndex++,A())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,O.sort((D,F)=>D.sortKey-F.sortKey));this._currentPartIndex<O.length;){const D=O[this._currentPartIndex];if(u.placeLayerBucketPart(D,this._seenCrossTileIDs,m,D.symbolInstanceStart===0,S),this._currentPartIndex++,A())return!0}return!1}}class c_{startNewPlacement(n,u,m,x,A,S,O,D){return this.placement=new Ro(n,x,A,S,O,D),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=!1,this._showCollisionBoxes=m,this._fadeDuration=x,this._done=!1,this._inProgressLayer=null,this}requestFullPlacement(){this._forceFullPlacement=!0}isFullPlacementRequested(){return this._forceFullPlacement}setStale(){this.placement&&(this.placement.stale=!0)}isStale(){return!!this.placement&&this.placement.stale}isDone(){return this._done}continuePlacement(n,u,m,x,A){const S=a.o.now(),O=()=>{const D=a.o.now()-S;return!this.isFullPlacementRequested()&&this._fadeDuration!==0&&D>2};for(;this._currentPlacementIndex>=0;){const D=u[n[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if(D.type==="symbol"&&D.visibility!=="none"&&(!D.minzoom||D.minzoom<=F)&&(!D.maxzoom||D.maxzoom>F)){const N=D,Z=N.layout.get("symbol-z-elevate"),$=N.layout.get("symbol-sort-key").constantOr(1)!==void 0,W=N.layout.get("symbol-z-order"),ne=W==="viewport-y"||W==="auto"&&!(W!=="viewport-y"&&$),te=N.layout.get("text-allow-overlap")||N.layout.get("icon-allow-overlap")||N.layout.get("text-ignore-placement")||N.layout.get("icon-ignore-placement"),ae=ne&&te,le=this._inProgressLayer=this._inProgressLayer||new ls(N),be=a.B(D.source,D.scope);if(le.continuePlacement(Z||ae?x[be]:m[be],this.placement,this._showCollisionBoxes,D,O,A))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._forceFullPlacement=!1,this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Hu=512/a.al/2;class xa{constructor(n,u,m){this.tileID=n,this.bucketInstanceId=m,this.index=new a.c4(u.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=n.canonical.x*a.al,A=n.canonical.y*a.al;for(let S=0;S<u.length;S++){const{key:O,crossTileID:D,tileAnchorX:F,tileAnchorY:N}=u.get(S),Z=Math.floor((x+F)*Hu),$=Math.floor((A+N)*Hu);this.index.add(Z,$),this.keys.push(O),this.crossTileIDs.push(D)}this.index.finish()}findMatches(n,u,m){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),A=Hu/Math.pow(2,u.canonical.z-this.tileID.canonical.z),S=u.canonical.x*a.al,O=u.canonical.y*a.al;for(let D=0;D<n.length;D++){const F=n.get(D);if(F.crossTileID)continue;const{key:N,tileAnchorX:Z,tileAnchorY:$}=F,W=Math.floor((S+Z)*A),ne=Math.floor((O+$)*A),te=this.index.range(W-x,ne-x,W+x,ne+x).sort((ae,le)=>ae-le);for(const ae of te){const le=this.crossTileIDs[ae];if(this.keys[ae]===N&&!m.has(le)){m.add(le),F.crossTileID=le;break}}}}}class Bl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ws{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(u!==0)for(const m in this.indexes){const x=this.indexes[m],A={};for(const S in x){const O=x[S];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+u),A[O.tileID.key]=O}this.indexes[m]=A}this.lng=n}addBucket(n,u,m){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let A=0;A<u.symbolInstances.length;A++)u.symbolInstances.get(A).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const x=this.usedCrossTileIDs[n.overscaledZ];for(const A in this.indexes){const S=this.indexes[A];if(Number(A)>n.overscaledZ)for(const O in S){const D=S[O];D.tileID.isChildOf(n)&&D.findMatches(u.symbolInstances,n,x)}else{const O=S[n.scaledTo(Number(A)).key];O&&O.findMatches(u.symbolInstances,n,x)}}for(let A=0;A<u.symbolInstances.length;A++){const S=u.symbolInstances.get(A);S.crossTileID||(S.crossTileID=m.generate(),x.add(S.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new xa(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const m of u.crossTileIDs)this.usedCrossTileIDs[n].delete(m)}removeStaleBuckets(n){let u=!1;for(const m in this.indexes){const x=this.indexes[m];for(const A in x)n[x[A].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,x[A]),delete x[A],u=!0)}return u}}class Yi{constructor(){this.layerIndexes={},this.crossTileIDs=new Bl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,m,x){let A=this.layerIndexes[n.fqid];A===void 0&&(A=this.layerIndexes[n.fqid]=new Ws);let S=!1;const O={};x.name!=="globe"&&A.handleWrapJump(m);for(const D of u){const F=D.getBucket(n);F&&n.fqid===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),A.addBucket(D.tileID,F,this.crossTileIDs)&&(S=!0),O[F.bucketInstanceId]=!0)}return A.removeStaleBuckets(O)&&(S=!0),S}pruneUnusedLayers(n){const u={};n.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const Xu=771;class zr{constructor(n,u,m,x){this.blendFunction=n,this.blendColor=u.toNonPremultipliedRenderColor(null),this.mask=m,this.blendEquation=x}}zr.Replace=[1,0,1,0],zr.disabled=new zr(zr.Replace,a.ao.transparent,[!1,!1,!1,!1]),zr.unblended=new zr(zr.Replace,a.ao.transparent,[!0,!0,!0,!0]),zr.alphaBlended=new zr([1,Xu,1,Xu],a.ao.transparent,[!0,!0,!0,!0]),zr.alphaBlendedNonPremultiplied=new zr([770,Xu,770,Xu],a.ao.transparent,[!0,!0,!0,!0]),zr.multiply=new zr([774,0,774,0],a.ao.transparent,[!0,!0,!0,!0]),zr.additive=new zr([1,1,1,1],a.ao.transparent,[!0,!0,!0,!0]);class mr{constructor(n,u,m){this.func=n,this.mask=u,this.range=m}}mr.ReadOnly=!1,mr.ReadWrite=!0,mr.disabled=new mr(519,mr.ReadOnly,[0,1]);const Uh=7680;class Rr{constructor(n,u,m,x,A,S){this.test=n,this.ref=u,this.mask=m,this.fail=x,this.depthFail=A,this.pass=S}}Rr.disabled=new Rr({func:519,mask:0},0,0,Uh,Uh,Uh);const Vd=1029,Gd=2305;class Cr{constructor(n,u,m){this.enable=n,this.mode=u,this.frontFace=m}}function Im(p,n){const u=a.ca(p,3);a.cc(p,n),a.cg(p,3,u)}function u_(p,n){const u=a.c7([]);return a.c8(u,u,-n),a.c9(u,u,-p),u}function vc(p,n){const u=[p[0],p[1],0],m=[n[0],n[1],0];if(a.ag(u)>=1e-15){const S=a.aw([],u);a.c5(m,S,a.bJ(m,S)),n[0]=m[0],n[1]=m[1]}const x=a.bI([],n,p);if(a.c6(x)<1e-15)return null;const A=Math.atan2(-x[1],x[0]);return u_(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),A)}Cr.disabled=new Cr(!1,Vd,Gd),Cr.backCCW=new Cr(!0,Vd,Gd),Cr.backCW=new Cr(!0,Vd,2304),Cr.frontCW=new Cr(!0,1028,2304),Cr.frontCCW=new Cr(!0,1028,Gd);class uv{constructor(n,u){this.position=n,this.orientation=u}get position(){return this._position}set position(n){if(n){const u=n instanceof a.ae?n:new a.ae(n[0],n[1],n[2]);this._renderWorldCopies&&(u.x=a.bT(u.x,0,1)),this._position=u}else this._position=null}lookAtPoint(n,u,m){if(this.orientation=null,!this.position)return;const x=this.position,A=m||(this._elevation?this._elevation.getAtPointOrZero(a.ae.fromLngLat(n)):0),S=a.ae.fromLngLat(n,A),O=[S.x-x.x,S.y-x.y,S.z-x.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=vc(O,u)}setPitchBearing(n,u){this.orientation=u_(a.an(n),a.an(-u))}}class $d{constructor(n,u){this._transform=a.bA([]),this.orientation=u,this.position=n}get mercatorPosition(){const n=this.position;return new a.ae(n[0],n[1],n[2])}get position(){const n=a.ca(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var u;n&&a.cg(this._transform,3,[(u=n)[0],u[1],u[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||a.c7([]),n&&Im(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,u){this._orientation=u_(n,u),Im(this._transform,this._orientation)}forward(){const n=a.ca(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=a.ca(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=a.ca(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,u){const m=new Float64Array(16);return a.bl(m,this.getWorldToCamera(n,u)),m}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,u,m){const x=this.position;a.c5(x,x,-n);const A=new Float64Array(16);return a.bq(A,[m,m,m]),a.br(A,A,x),A[10]*=u,A}getWorldToCamera(n,u){const m=new Float64Array(16),x=new Float64Array(4),A=this.position;return a.cb(x,this._orientation),a.c5(A,A,-n),a.cc(m,x),a.br(m,m,A),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(n,u,m,x){const A=new Float64Array(16);return a.cd(A,n,u,m,x),A}getCameraToClipOrthographic(n,u,m,x,A,S){const O=new Float64Array(16);return a.ce(O,n,u,m,x,A,S),O}getDistanceToElevation(n,u=!1){const m=n===0?0:a.cf(n,u?a.a$(this.position[1]):this.position[1]),x=this.forward();return(m-this.position[2])/x[2]}clone(){return new $d([...this.position],[...this.orientation])}}const cs=(p,n)=>({u_matrix:p,u_ground_shadow_factor:n});class us{constructor(n=0,u=0,m=0,x=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=m,this.right=x}interpolate(n,u,m){return u.top!=null&&n.top!=null&&(this.top=a.ak(n.top,u.top,m)),u.bottom!=null&&n.bottom!=null&&(this.bottom=a.ak(n.bottom,u.bottom,m)),u.left!=null&&n.left!=null&&(this.left=a.ak(n.left,u.left,m)),u.right!=null&&n.right!=null&&(this.right=a.ak(n.right,u.right,m)),this}getCenter(n,u){const m=a.aA((this.left+n-this.right)/2,0,n),x=a.aA((this.top+u-this.bottom)/2,0,u);return new a.P(m,x)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new us(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Ps=15;class rp{constructor(n,u,m,x,A,S,O){this.tileSize=512,this._renderWorldCopies=A===void 0||A,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=m??0,this._maxPitch=x??60,this.setProjection(S),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new a.aT(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new us,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new $d,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const n=new rp(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n._allowWorldUnderZoom=this._allowWorldUnderZoom,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Ps}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,u=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||m)&&this._updateCameraOnTerrain(),(n||m)&&this._constrainCamera(u),this._calcMatrices()}getProjection(){return a.aH(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const u=this.projection?this.getProjection():void 0;this.projection=a.cm(this.projectionOptions);const m=this.getProjection(),x=!a.by(u,m);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.cm({name:"mercator"});const u=n!==this.projection.name;return u&&this._calcMatrices(),u}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.cf(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bT(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const u=-n*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=a.cn(),a.co(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const u=a.aA(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=a.an(n),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,u=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!u||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const m=this._elevation;u||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&m.exaggeration()&&this._centerAltitudeValidForExaggeration!==m.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*m.exaggeration(),this._centerAltitudeValidForExaggeration=m.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=m.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const n=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let x=0,A=0;for(let S=0;S<u.length;S++){const O=new a.P(u[S][0]*this.width,m+u[S][1]*(this.height-m)),D=n.pointCoordinate(O);if(!D)continue;const F=1/Math.hypot(D[0]-this._camera.position[0],D[1]-this._camera.position[1]);x+=D[3]*F,A+=F}return A===0?NaN:x/A}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(n),A=this._mercatorZfromZoom(this._maxZoom),S=Math.max(x-m,A);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}equals(n){const u=this.elevation,m=n.elevation,x=u!=null!=(m!=null)||u&&m&&u.exaggeration()!==m.exaggeration();return this.width===n.width&&this.height===n.height&&this.center.lng===n.center.lng&&this.center.lat===n.center.lat&&this.zoom===n.zoom&&this.bearing===n.bearing&&this.pitch===n.pitch&&this.fov===n.fov&&this.projection.name===n.projection.name&&this._edgeInsets.equals(n.padding)&&!x}computeZoomRelativeTo(n){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let m;m=n.z<this._camera.position[2]?[u.x,u.y,u.z]:[n.x,n.y,n.z];const x=a.ag(a.av([],this._camera.position,m));return a.aA(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let u=!1;if(n.orientation&&!a.cp(n.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(n.orientation)),n.position){const m=[n.position.x,n.position.y,n.position.z];a.cq(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,u=new uv;return u.position=new a.ae(n[0],n[1],n[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(n){if(!a.cr(n))return!1;a.cs(n,n);const u=a.ct([],[0,0,-1],n),m=a.ct([],[0,-1,0],n);if(m[2]<0)return!1;const x=vc(u,m);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(n){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;n[2]=a.aA(n[2],x/m,x/u),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,m){this._unmodified=!1,this._edgeInsets.interpolate(n,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(n){const u=[new a.cu(0,n)];if(this.renderWorldCopies){const m=this.pointCoordinate(new a.P(0,0)),x=this.pointCoordinate(new a.P(this.width,0)),A=this.pointCoordinate(new a.P(this.width,this.height)),S=this.pointCoordinate(new a.P(0,this.height)),O=Math.floor(Math.min(m.x,x.x,A.x,S.x)),D=Math.floor(Math.max(m.x,x.x,A.x,S.x)),F=1;for(let N=O-F;N<=D+F;N++)N!==0&&u.push(new a.cu(N,n))}return u}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,u,m,x){let A=[];const S=m!=null,O=!S;if(O&&this.zoom<u||S&&m[0]===0&&m[1]===0)return A;const D=new Set,F=(Z,$,W,ne,te)=>{const ae=a.cY($,Z,W,ne,te);D.has(ae)||(A.push(new a.aQ(Z,$,W,ne,te)),D.add(ae))};for(let Z=0;Z<n.length;Z++){const $=n[Z];if(O&&$.canonical.z!==u||S&&x!==void 0&&x>$.canonical.z)continue;const W=$.canonical,ne=$.overscaledZ,te=$.wrap,ae=1<<W.z,le=W.x+1<ae,be=W.x>0,xe=W.y+1<ae,ye=W.y>0,Re=$.wrap-(be?0:1),Ce=$.wrap+(le?0:1),De=be?W.x-1:ae-1,Me=le?W.x+1:0;if(S)m[0]<0?(F(ne,Ce,W.z,Me,W.y),m[1]<0&&xe&&(F(ne,te,W.z,W.x,W.y+1),F(ne,Ce,W.z,Me,W.y+1)),m[1]>0&&ye&&(F(ne,te,W.z,W.x,W.y-1),F(ne,Ce,W.z,Me,W.y-1))):m[0]>0?(F(ne,Re,W.z,De,W.y),m[1]<0&&xe&&(F(ne,te,W.z,W.x,W.y+1),F(ne,Re,W.z,De,W.y+1)),m[1]>0&&ye&&(F(ne,te,W.z,W.x,W.y-1),F(ne,Re,W.z,De,W.y-1))):m[1]<0&&xe?F(ne,te,W.z,W.x,W.y+1):ye&&F(ne,te,W.z,W.x,W.y-1);else{const Te=$.visibleQuadrants;1&Te&&(F(ne,Re,W.z,De,W.y),ye&&(F(ne,te,W.z,W.x,W.y-1),F(ne,Re,W.z,De,W.y-1))),2&Te&&(F(ne,Ce,W.z,Me,W.y),ye&&(F(ne,te,W.z,W.x,W.y-1),F(ne,Ce,W.z,Me,W.y-1))),4&Te&&(F(ne,Re,W.z,De,W.y),xe&&(F(ne,te,W.z,W.x,W.y+1),F(ne,Re,W.z,De,W.y+1))),8&Te&&(F(ne,Ce,W.z,Me,W.y),xe&&(F(ne,te,W.z,W.x,W.y+1),F(ne,Ce,W.z,Me,W.y+1)))}}const N=[];for(const Z of A)A.some($=>Z.isChildOf($))||N.push(Z);if(A=N.filter(Z=>!n.some($=>!!(Z.overscaledZ<u&&$.isChildOf(Z))||Z.equals($)||Z.isChildOf($))),O){const Z=1<<u,$=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[Z*$.x,Z*$.y],ne=4,te=ne*ne;A=A.filter(ae=>{const le=ae.canonical.x+.5-W[0],be=ae.canonical.y+.5-W[1];return le*le+be*be<te})}return A}extendTileCoverToNearPlane(n,u,m){const x=[],A=new Set;for(const be of n)A.add(be.key);const S=(be,xe,ye,Re,Ce)=>{const De=a.cY(xe,be,ye,Re,Ce);A.has(De)||(x.push(new a.aQ(be,xe,ye,Re,Ce)),A.add(De))},O=n.reduce((be,xe)=>Math.max(be,xe.overscaledZ),m),D=1<<m,F=[new a.P(0,0),new a.P(a.al,0),new a.P(a.al,a.al),new a.P(0,a.al)],N=new a.P(0,0),Z=new a.P(0,0),$=(be,xe)=>{const ye=Math.floor(be[0]),Re=Math.floor(be[1]),Ce=(be[0]-ye)*a.al,De=(be[1]-Re)*a.al,Me=Math.floor(xe[0]),Te=Math.floor(xe[1]),Ne=(xe[0]-Me)*a.al,Ve=(xe[1]-Te)*a.al;for(let He=-1;He<=1;He++){const Qe=ye+He;if(!(Qe<0||Qe>=D)){N.x=Ce-He*a.al,Z.x=Ne-(Qe-Me)*a.al;for(let We=-1;We<=1;We++){const ut=Re+We;N.y=De-We*a.al,Z.y=Ve-(ut-Te)*a.al,a.cZ(N,Z,F)&&S(O,0,m,Qe,ut)}}}},W=u.points,ne=W[a.cv],te=W[a.cw],ae=this._projectToGround(ne,W[a.cx]),le=this._projectToGround(te,W[a.cy]);return $(ne,ae),$(te,le),x}_projectToGround(n,u){return a.cz(a.cA(),n,u,n[2]/(n[2]-u[2]))}coveringTiles(n){let u=this.coveringZoomLevel(n);const m=u,x=this.elevation&&this.elevation.exaggeration(),A=x&&!n.isTerrainDEM,S=this.projection.name==="mercator";if(n.minzoom!==void 0&&u<n.minzoom)return[];n.maxzoom!==void 0&&u>n.maxzoom&&(u=n.maxzoom);const O=this.locationCoordinate(this.center),D=this.center.lat,F=1<<u,N=[F*O.x,F*O.y,0],Z=this.projection.name==="globe",$=!Z,W=a.cB.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,$),ne=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),te=F*a.cf(1,this.center.lat),ae=this._camera.position[2]/a.cf(1,this.center.lat),le=[F*ne.x,F*ne.y,ae*($?1:te)],be=Z||x,xe=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),ye=this.isLODDisabled(!0)?u:0;let Re;if(this._elevation&&n.isTerrainDEM)Re=1e4*this._elevation.exaggeration();else if(this._elevation){const je=this._elevation.getMinMaxForVisibleTiles();Re=je?je.max:this._centerAltitude}else Re=this._centerAltitude;const Ce=n.isTerrainDEM?-Re:this._elevation?this._elevation.getMinElevationBelowMSL():0,De=this.projection.isReprojectedInTileSpace?a.cC(this):1,Me=je=>{const ot=new a.ae(je.x+25e-6,je.y,je.z),bt=new a.ae(je.x,je.y+25e-6,je.z),zt=je.toLngLat(),qt=ot.toLngLat(),kt=bt.toLngLat(),Lt=this.locationCoordinate(zt),hr=this.locationCoordinate(qt),sr=this.locationCoordinate(kt),Zt=Math.hypot(hr.x-Lt.x,hr.y-Lt.y),lr=Math.hypot(sr.x-Lt.x,sr.y-Lt.y);return Math.sqrt(Zt*lr)*De/25e-6},Te=je=>{const mt=Re,ot=Ce;return{aabb:a.cF(this,F,0,0,0,je,ot,mt,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:mt,wrap:je,fullyVisible:!1}},Ne=[];let Ve=[];const He=u,Qe=n.reparseOverscaled?m:u,We=(ae-this._centerAltitude)*te,ut=je=>{if(!this._elevation||!je.tileID||!S)return;const mt=this._elevation.getMinMaxForTile(je.tileID),ot=je.aabb;mt?(ot.min[2]=mt.min,ot.max[2]=mt.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(je.shouldSplit=et(je),je.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},wt=(je,mt)=>{if(.707*mt<je)return 1;const ot=mt/je;return ot/(1.4144271570014144+(Math.pow(1.1,ot-1.4144271570014144+1)-1)/(1.1-1)-1)},et=je=>{if(je.zoom<ye)return!0;if(je.zoom===He)return!1;if(je.shouldSplit!=null)return je.shouldSplit;const mt=je.aabb.distanceX(le),ot=je.aabb.distanceY(le);let bt=We,zt=1;if(Z){bt=je.aabb.distanceZ(le);const lr=Math.pow(2,je.zoom),xr=a.a$((je.y+1)/lr),Ir=a.a$(je.y/lr),Vr=Math.min(Math.max(D,xr),Ir),tn=a.d1(Vr)/a.d1(D);if(zt=Vr===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,tn/this._mercatorScaleRatio),this.zoom<=a.c_&&je.zoom===He-1&&tn>=.9)return!0}else if(A&&(bt=je.aabb.distanceZ(le)*te),this.projection.isReprojectedInTileSpace&&m<=5){const lr=Math.pow(2,je.zoom),xr=Me(new a.ae((je.x+.5)/lr,(je.y+.5)/lr));zt=xr>.85?1:xr}if(!S&&!Z){const lr=Math.sqrt(mt*mt+ot*ot+bt*bt);let xr=(1<<He-je.zoom)*xe*zt;return xr*=wt(Math.max(bt,We),lr),lr<xr}let qt=Number.MAX_VALUE,kt=0;const Lt=je.aabb.getCorners(),hr=[];for(const lr of Lt){a.av(hr,lr,le),Z||(A?hr[2]*=te:hr[2]=We);const xr=a.bJ(hr,this._camera.forward());xr<qt&&(qt=xr,kt=Math.abs(hr[2]))}let sr=(1<<He-je.zoom)*xe*zt;if(sr*=wt(Math.max(kt,We),qt),qt<sr)return!0;const Zt=je.aabb.closestPoint(N);return Zt[0]===N[0]&&Zt[1]===N[1]};if(this.renderWorldCopies)for(let je=1;je<=3;je++)Ne.push(Te(-je)),Ne.push(Te(je));for(Ne.push(Te(0));Ne.length>0;){const je=Ne.pop(),mt=je.x,ot=je.y;let bt=je.fullyVisible;const zt=()=>this.projection.name==="globe"&&(je.y===0||je.y===(1<<je.zoom)-1);if(!bt){let qt=be?je.aabb.intersects(W):je.aabb.intersectsFlat(W);if(qt===0&&zt()){const kt=new a.cD(je.zoom,mt,ot);qt=a.cE(this,F,kt,!0).intersects(W)}if(qt===0)continue;bt=qt===2}if(je.zoom===He||!et(je)){const qt=je.zoom===He?Qe:je.zoom;if(n.minzoom&&n.minzoom>qt)continue;let kt=0;if(!bt){let Zt=be?je.aabb.intersectsPrecise(W):je.aabb.intersectsPreciseFlat(W);if(Zt===0&&zt()){const lr=new a.cD(je.zoom,mt,ot);Zt=a.cE(this,F,lr,!0).intersectsPrecise(W)}if(Zt===0)continue;if(n.calculateQuadrantVisibility)if(W.containsPoint(je.aabb.center))kt=15;else for(let lr=0;lr<4;lr++)je.aabb.quadrant(lr).intersects(W)!==0&&(kt|=1<<lr)}const Lt=N[0]-(.5+mt+(je.wrap<<je.zoom))*(1<<u-je.zoom),hr=N[1]-.5-ot,sr=je.tileID?je.tileID:new a.aQ(qt,je.wrap,je.zoom,mt,ot);n.calculateQuadrantVisibility&&(sr.visibleQuadrants=kt),Ve.push({tileID:sr,distanceSq:Lt*Lt+hr*hr});continue}for(let qt=0;qt<4;qt++){const kt=(mt<<1)+qt%2,Lt=(ot<<1)+(qt>>1),hr={aabb:S?je.aabb.quadrant(qt):a.cF(this,F,je.zoom+1,kt,Lt,je.wrap,je.minZ,je.maxZ,this.projection),zoom:je.zoom+1,x:kt,y:Lt,wrap:je.wrap,fullyVisible:bt,tileID:void 0,shouldSplit:void 0,minZ:je.minZ,maxZ:je.maxZ};A&&!Z&&(hr.tileID=new a.aQ(je.zoom+1===He?Qe:je.zoom+1,je.wrap,je.zoom+1,kt,Lt),ut(hr)),Ne.push(hr)}}if(this.fogCullDistSq){const je=this.fogCullDistSq,mt=this.horizonLineFromTop();Ve=Ve.filter(ot=>{const bt=[0,0,0,1],zt=[a.al,a.al,0,1],qt=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());a.aC(bt,bt,qt),a.aC(zt,zt,qt);const kt=a.cG([],bt,zt),Lt=a.cH([],bt,zt),hr=a.c$(kt,Lt);if(hr===0)return!0;let sr=!1;const Zt=this._elevation;if(Zt&&hr>je&&mt!==0){const lr=this.calculateProjMatrix(ot.tileID.toUnwrapped());let xr;n.isTerrainDEM||(xr=Zt.getMinMaxForTile(ot.tileID)),xr||(xr={min:Ce,max:Re});const Ir=a.cI(this.rotation),Vr=[Ir[0]*a.al,Ir[1]*a.al,xr.max];a.af(Vr,Vr,lr),sr=(1-Vr[1])*this.height*.5<mt}return hr<je||sr})}return Ve.sort((je,mt)=>je.distanceSq-mt.distanceSq).map(je=>je.tileID)}resize(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log2(n)}project(n){const u=a.aA(n.lat,-a.cJ,a.cJ),m=this.projection.project(n.lng,u);return new a.P(m.x*this.worldSize,m.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.cf(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,u){let m,x;const A=this.centerPoint;if(this.projection.name==="globe"){const O=this.worldSize;m=(u.x-A.x)/O,x=(u.y-A.y)/O}else{const O=this.pointCoordinate(u),D=this.pointCoordinate(A);m=O.x-D.x,x=O.y-D.y}const S=this.locationCoordinate(n);this.setLocation(new a.ae(S.x-m,S.y-x))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n,u){return this.projection.locationPoint(this,n,u)}locationPoint3D(n,u){return this.projection.locationPoint(this,n,u,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n,u){return this.coordinateLocation(this.pointCoordinate3D(n,u))}locationCoordinate(n,u){const m=u?a.cf(u,n.lat):void 0,x=this.projection.project(n.lng,n.lat);return new a.ae(x.x,x.y,m)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,u){const m=u??this._centerAltitude,x=[n.x,n.y,0,1],A=[n.x,n.y,1,1];a.aC(x,x,this.pixelMatrixInverse),a.aC(A,A,this.pixelMatrixInverse);const S=A[3];a.cK(x,x,1/x[3]),a.cK(A,A,1/S);const O=x[2],D=A[2];return{p0:x,p1:A,t:O===D?0:(m-O)/(D-O)}}screenPointToMercatorRay(n){const u=[n.x,n.y,0,1],m=[n.x,n.y,1,1];return a.aC(u,u,this.pixelMatrixInverse),a.aC(m,m,this.pixelMatrixInverse),a.cK(u,u,1/u[3]),a.cK(m,m,1/m[3]),u[2]=a.cf(u[2],this._center.lat)*this.worldSize,m[2]=a.cf(m[2],this._center.lat)*this.worldSize,a.cK(u,u,1/this.worldSize),a.cK(m,m,1/this.worldSize),new a.ax([u[0],u[1],u[2]],a.aw([],a.av([],m,u)))}rayIntersectionCoordinate(n){const{p0:u,p1:m,t:x}=n,A=a.cf(u[2],this._center.lat),S=a.cf(m[2],this._center.lat);return new a.ae(a.ak(u[0],m[0],x)/this.worldSize,a.ak(u[1],m[1],x)/this.worldSize,a.ak(A,S,x))}pointCoordinate(n,u=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,u)}pointCoordinate3D(n,u){if(!this.elevation)return this.pointCoordinate(n,u);let m=this.projection.pointCoordinate3D(this,n.x,n.y);if(m)return new a.ae(m[0],m[1],m[2]);let x=0,A=this.horizonLineFromTop();if(n.y>A)return this.pointCoordinate(n,u);const S=.02*A,O=n.clone();for(let D=0;D<10&&A-x>S;D++){O.y=a.ak(x,A,.66);const F=this.projection.pointCoordinate3D(this,O.x,O.y);F?(A=O.y,m=F):x=O.y}return m?new a.ae(m[0],m[1],m[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=a.cL)return!this.isPointAboveHorizon(n);const u=this.pointCoordinate(n);return u.y>=0&&u.y<=1}_coordinatePoint(n,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,x=[n.x*this.worldSize,n.y*this.worldSize,m+n.toAltitude(),1];return a.aC(x,x,this.pixelMatrix),x[3]>0?new a.P(x[0]/x[3],x[1]/x[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:u}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,A=this.pointLocation3D(new a.P(u,n)),S=this.pointLocation3D(new a.P(x,n)),O=this.pointLocation3D(new a.P(x,m)),D=this.pointLocation3D(new a.P(u,m));let F=Math.min(A.lng,S.lng,O.lng,D.lng),N=Math.max(A.lng,S.lng,O.lng,D.lng),Z=Math.min(A.lat,S.lat,O.lat,D.lat),$=Math.max(A.lat,S.lat,O.lat,D.lat);const W=Math.pow(2,-this.zoom)/16*270,ne=this.projection.name==="globe"?1:4,te=(ae,le,be,xe,ye)=>{const Re=(ae+be)/2,Ce=(le+xe)/2,De=new a.P(Re,Ce),{lng:Me,lat:Te}=this.pointLocation3D(De),Ne=Math.max(0,F-Me,Z-Te,Me-N,Te-$);F=Math.min(F,Me),N=Math.max(N,Me),Z=Math.min(Z,Te),$=Math.max($,Te),(ye<ne||Ne>W)&&(te(ae,le,Re,Ce,ye+1),te(Re,Ce,be,xe,ye+1))};if(te(u,n,x,n,1),te(x,n,x,m,1),te(x,m,u,m,1),te(u,m,u,n,1),this.projection.name==="globe"){const[ae,le]=a.cM(this);ae?($=90,N=180,F=-180):le&&(Z=-90,N=180,F=-180)}return new a.aI(new a.aT(F,Z),new a.aT(N,$))}_getBoundsRectangular(n,u){const{top:m,left:x}=this._edgeInsets,A=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,O=new a.P(x,m),D=new a.P(S,m),F=new a.P(S,A),N=new a.P(x,A);let Z=this.pointCoordinate(O,n),$=this.pointCoordinate(D,n);const W=this.pointCoordinate(F,u),ne=this.pointCoordinate(N,u),te=(ae,le)=>(le.y-ae.y)/(le.x-ae.x);return Z.y>1&&$.y>=0?Z=new a.ae((1-ne.y)/te(ne,Z)+ne.x,1):Z.y<0&&$.y<=1&&(Z=new a.ae(-ne.y/te(ne,Z)+ne.x,0)),$.y>1&&Z.y>=0?$=new a.ae((1-W.y)/te(W,$)+W.x,1):$.y<0&&Z.y<=1&&($=new a.ae(-W.y/te(W,$)+W.x,0)),new a.aI().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation($)).extend(this.coordinateLocation(ne)).extend(this.coordinateLocation(W))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const u=n.visibleDemTiles.reduce((m,x)=>{if(x.dem){const A=x.dem.tree;m.min=Math.min(m.min,A.minimums[0]),m.max=Math.max(m.max,A.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(u.min*n.exaggeration(),u.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return n?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-a.cJ,this.maxLat=a.cJ,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.aF(this.minLng)*this.tileSize,this.worldMaxX=a.aF(this.maxLng)*this.tileSize,this.worldMinY=a.aJ(this.maxLat)*this.tileSize,this.worldMaxY=a.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,u){return this.projection.createTileMatrix(this,u,n)}calculateDistanceTileData(n){const u=n.key,m=this._distanceTileDataCache;if(m[u])return m[u];const x=n.canonical,A=1/this.height,S=this.cameraWorldSize,O=S/this.zoomScale(x.z),D=(x.x+Math.pow(2,x.z)*n.wrap)*O,F=x.y*O,N=this.point;N.x*=S/this.worldSize,N.y*=S/this.worldSize;const Z=this.angle,$=Math.sin(-Z),W=-Math.cos(-Z);return m[u]={bearing:[$,W],center:[(N.x-D)*A,(N.y-F)*A],scale:O/a.al*A},m[u]}calculateFogTileMatrix(n){const u=n.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return a.aB(x,this.worldToFogMatrix,x),m[u]=new Float32Array(x),m[u]}calculateProjMatrix(n,u=!1,m=!1){const x=n.key;let A;if(A=m?this._expandedProjMatrixCache:u?this._alignedProjMatrixCache:this._projMatrixCache,A[x])return A[x];const S=this.calculatePosMatrix(n,this.worldSize);let O;return O=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.expandedFarZProjMatrix:u?this.alignedProjMatrix:this.projMatrix,a.aB(S,O,S),A[x]=new Float32Array(S),A[x]}calculatePixelsToTileUnitsMatrix(n){const u=n.tileID.key,m=this._pixelsToTileUnitsCache;if(m[u])return m[u];const x=a.cN(n,this);return m[u]=x,m[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,u=a.bq([],[n,n,n]);return a.aB(u,u,this.globeMatrix),u}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const u=a.cf(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(u),x=this._camera.forward(),A=a.cf(1,this._center.lat);m[2]/=A,x[2]/=A,a.aw(x,x);const S=n.raycast(m,x,n.exaggeration());if(S){const O=a.bH([],m,x,S),D=new a.ae(O[0],O[1],a.cf(O[2],a.a$(O[1]))),F=(D.z+a.ag([D.x-m[0],D.y-m[1],D.z-m[2]*A]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(F),this._centerAltitude=D.toAltitude(),this._center=this.coordinateLocation(D),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const u=this._elevation,m=a.cf(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),A=u.getAtPointOrZero(new a.ae(...x)),S=this.pixelsPerMeter/this.worldSize*A,O=this._minimumHeightOverTerrain(),D=x[2]-S;if(D<=O)if(D<0||n){const F=this.locationCoordinate(this._center,this._centerAltitude),N=[x[0],x[1],F.z-x[2]],Z=a.ag(N);N[2]-=(O-D)/this._pixelsPerMercatorPixel;const $=a.ag(N);if($===0)return;a.c5(N,N,Z/$*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],F.z*this._pixelsPerMercatorPixel-N[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const $=this.center;return $.lat=a.aA($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&($.lng=a.aA($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const u=this._unmodified,{x:m,y:x}=this.point;let A=0,S=m,O=x;const D=this.width/2,F=this.height/2,N=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(x-F<N&&(O=N+F),x+F>Z&&(O=Z-F),Z-N<this.height&&(A=Math.max(A,this.height/(Z-N)),O=(Z+N)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,W=this.worldMaxX*this.scale,ne=this.worldSize/2-($+W)/2;S=(m+ne+this.worldSize)%this.worldSize-ne,S-D<$&&(S=$+D),S+D>W&&(S=W-D),W-$<this.width&&(A=Math.max(A,this.width/(W-$)),S=(W+$)/2)}S===m&&O===x||this._allowWorldUnderZoom||(this.center=this.unproject(new a.P(S,O))),A&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(A)),this._constrainCamera(),this._unmodified=u,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,u=this.projection.name==="globe",m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.cf(1,this.center.lat)/a.cf(1,a.d2));const x=a.cO(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const A=this.projection.zAxisUnit==="meters"?m:1,S=this._camera.getWorldToCamera(this.worldSize,A);let O;const D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(D[8]=2*-n.x/this.width,D[9]=2*n.y/this.height,this.isOrthographic){let Te=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Ne=Te*this.aspect,Ve=-Ne,He=-Te;Ne-=n.x,Ve-=n.x,Te+=n.y,He+=n.y,O=this._camera.getCameraToClipOrthographic(Ve,Ne,He,Te,this._nearZ,this._farZ),((Qe,We,ut,wt)=>{for(let et=0;et<16;et++)Qe[et]=a.ak(We[et],ut[et],wt)})(O,O,D,a.d0(this.pitch>=Ps?1:this.pitch/Ps))}else O=D;const F=a.cP([],D,S);let N=a.cP([],O,S);if(this.projection.isReprojectedInTileSpace){const Te=this.locationCoordinate(this.center),Ne=a.bA([]);a.br(Ne,Ne,[Te.x*this.worldSize,Te.y*this.worldSize,0]),a.aB(Ne,Ne,a.cQ(this)),a.br(Ne,Ne,[-Te.x*this.worldSize,-Te.y*this.worldSize,0]),a.aB(N,N,Ne),a.aB(F,F,Ne),this.inverseAdjustmentMatrix=a.cR(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.cS([],N,[this.worldSize,this.worldSize,this.worldSize/A,1]),this.projMatrix=N,this.invProjMatrix=a.bl(new Float64Array(16),this.projMatrix),u){const Te=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Te[8]=2*-n.x/this.width,Te[9]=2*n.y/this.height,this.expandedFarZProjMatrix=a.cP([],Te,S)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=a.bl([],O);this.frustumCorners=a.cT.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.cB.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!u);const $=new Float32Array(16);a.bA($),a.cS($,$,[1,-1,1]),a.cU($,$,this._pitch),a.bB($,$,this.angle);const W=a.cd(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.bz(W);const ne=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;W[8]=2*-n.x/this.width,W[9]=2*(n.y+ne)/this.height,this.skyboxMatrix=a.aB($,W,$);const te=this.point,ae=te.x,le=te.y,be=this.width%2/2,xe=this.height%2/2,ye=Math.cos(this.angle),Re=Math.sin(this.angle),Ce=ae-Math.round(ae)+ye*be+Re*xe,De=le-Math.round(le)+ye*xe+Re*be,Me=new Float64Array(N);if(a.br(Me,Me,[Ce>.5?Ce-1:Ce,De>.5?De-1:De,0]),this.alignedProjMatrix=Me,N=a.bC(),a.cS(N,N,[this.width/2,-this.height/2,1]),a.br(N,N,[1,-1,0]),this.labelPlaneMatrix=N,N=a.bC(),a.cS(N,N,[1,-1,1]),a.br(N,N,[-1,-1,0]),a.cS(N,N,[2/this.width,2/this.height,1]),this.glCoordMatrix=N,this.pixelMatrix=a.aB(new Float64Array(16),this.labelPlaneMatrix,F),this._calcFogMatrices(),this._distanceTileDataCache={},N=a.bl(new Float64Array(16),this.pixelMatrix),!N)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=N,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.cV(this);const Te=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.af(Te,Te,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=N;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,u=this.cameraPixelsPerMeter,m=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,A=[n,n,u];a.c5(A,A,x),a.c5(m,m,-1),a.cW(m,m,A);const S=a.bC();a.br(S,S,m),a.cS(S,S,A),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,u,x)}_computeCameraPosition(n){const u=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),x=this.point,A=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*u-n/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-m[0]*A,x.y/this.worldSize-m[1]*A,n/this.worldSize*this._centerAltitude-m[2]*A]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],x=n[2];let A=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(A=Math.min((u-m)/x,1)),this._camera.position=a.bH([],this._camera.position,n,A),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:x}=this._camera.getPitchBearing(),A=a.cf(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.an(this._maxPitch)),O=Math.max((n[2]-A)/Math.cos(m),S),D=this._zoomFromMercatorZ(O);a.bH(n,n,u,O),this._pitch=a.aA(m,a.an(this.minPitch),a.an(this.maxPitch)),this.angle=a.bT(x,-Math.PI,Math.PI),this._setZoom(a.aA(D,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.ae(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,n)*this.tileSize))}zoomFromMercatorZAdjusted(n){let u=0,m=a.cL,x=0,A=1/0;for(;m-u>1e-6&&m>u;){const S=u+.5*(m-u),O=this.tileSize*Math.pow(2,S),D=this.getCameraToCenterDistance(this.projection,S,O),F=this.scaleZoom(D/(Math.max(0,n)*this.tileSize)),N=Math.abs(S-F);N<A&&(A=N,x=S),S<F?u=S:m=S}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,u){const m=Math.min(n.x,u.x),x=Math.max(n.x,u.x),A=Math.min(n.y,u.y),S=Math.max(n.y,u.y);if(A<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const O=[new a.P(m,A),new a.P(x,S),new a.P(m,S),new a.P(x,A)],D=this.renderWorldCopies?-3:0,F=this.renderWorldCopies?4:1;for(const N of O){const Z=this.pointRayIntersection(N);if(Z.t<0)return!0;const $=this.rayIntersectionCoordinate(Z);if($.x<D||$.y<0||$.x>F||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.cX(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(n,u){const m=a.ag(a.av([],this._camera.position,n)),x=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const n=(function([u,m,x],A){const S=[u,m,x,1];a.aC(S,S,A);const O=S[3]=Math.max(S[3],1e-6);return S[0]/=O,S[1]/=O,S[2]/=O,S})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,n))}}getCameraToCenterDistance(n,u=this.zoom,m=this.worldSize){const x=a.cO(n,u,this.width,this.height,1024),A=n.pixelSpaceConversion(this.center.lat,m,x);let S=.5/Math.tan(.5*this._fov)*this.height*A;return this.isOrthographic&&(S=a.ak(1,S,a.d0(this.pitch>=Ps?1:this.pitch/Ps))),S}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.aB(n,n,this.globeMatrix),n}getFrustum(n){return a.cB.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Ys=(p,n)=>{if(n>0&&p.terrain&&a.w("Cutoff is currently disabled on terrain"),n<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const u=p.transform,m=Math.max(Math.abs(u._zoom-(p.minCutoffZoom-1)),1),x=u.isLODDisabled(!1)?a.ah(60,45,u.pitch):a.ah(30,15,u.pitch),A=u._farZ-u._nearZ,S=n*u.height,O=((1-(D=x))*u.cameraToCenterDistance+D*(u._farZ+S))*m;var D;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[u._nearZ,u._farZ,(O-u._nearZ)/A,(O-S-u._nearZ)/A]}}},eu=2048;class hv{constructor(n,u){this.aabb=n,this.lastCascade=u}}class Vh{add(n,u){const m=this.receivers[n.key];m!==void 0?(m.aabb.min[0]=Math.min(m.aabb.min[0],u.min[0]),m.aabb.min[1]=Math.min(m.aabb.min[1],u.min[1]),m.aabb.min[2]=Math.min(m.aabb.min[2],u.min[2]),m.aabb.max[0]=Math.max(m.aabb.max[0],u.max[0]),m.aabb.max[1]=Math.max(m.aabb.max[1],u.max[1]),m.aabb.max[2]=Math.max(m.aabb.max[2],u.max[2])):this.receivers[n.key]=new hv(u,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,u,m){const x=a.d9.fromPoints(n.points);let A=0;for(const S in this.receivers){const O=this.receivers[S];if(!O||!x.intersectsAabb(O.aabb))continue;O.aabb.min=x.closestPoint(O.aabb.min),O.aabb.max=x.closestPoint(O.aabb.max);const D=O.aabb.getCorners();for(let F=0;F<m.length;F++){let N=!0;for(const Z of D){const $=[Z[0]*u,Z[1]*u,Z[2]];if(a.af($,$,m[F].matrix),$[0]<-1||$[0]>1||$[1]<-1||$[1]>1){N=!1;break}}if(O.lastCascade=F,A=Math.max(A,F),N)break}}return A+1}}class np{constructor(n){this.painter=n,this._enabled=!1,this._drawShadowAfterLayer=-1,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Vh,this._depthMode=new mr(n.context.gl.LEQUAL,mr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,u){const m=this.painter;if(this._enabled=!1,this._drawShadowAfterLayer=-1,this._receivers.clear(),!u||!u.properties)return;const x=u.properties.get("shadow-intensity"),A=u.properties.get("shadow-draw-before-layer");if(!u.shadowsEnabled()||x<=0)return;let S=-1,O=0;for(const le of m.style.order){const be=m.style._mergedLayers[le];be.hasShadowPass()&&!be.isHidden(n.zoom)&&(S=O),A&&A===le&&(this._drawShadowAfterLayer=O>0?O-1:0),O+=1}if(this._enabled=S>=0,!this.enabled)return;this._drawShadowAfterLayer<0&&(this._drawShadowAfterLayer=S);const D=m.context,F=eu,N=eu;if(this._cascades.length===0||eu!==this._cascades[0].texture.size[0]){this._cascades=[];for(let le=0;le<2;++le){const be=m._shadowMapDebug,xe=D.gl,ye=D.createFramebuffer(F,N,be?1:0,"texture"),Re=new a.T(D,{width:F,height:N,data:null},xe.DEPTH_COMPONENT16);if(ye.depthAttachment.set(Re.texture),be){const Ce=new a.T(D,{width:F,height:N,data:null},xe.RGBA8);ye.colorAttachment0.set(Ce.texture)}this._cascades.push({framebuffer:ye,texture:Re,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.cB,scale:0})}}this.shadowDirection=Pm(u);let Z=0;if(n.elevation){const le=n.elevation,be=[1e4,-1e4];le.visibleDemTiles.filter(xe=>xe.dem).forEach(xe=>{const ye=xe.dem.tree;be[0]=Math.min(be[0],ye.minimums[0]),be[1]=Math.max(be[1],ye.maximums[0])}),be[0]!==1e4&&(Z=(be[1]-be[0])*le.exaggeration())}const $=1.5*n.cameraToCenterDistance,W=3*$,ne=new Float64Array(16);for(let le=0;le<this._cascades.length;++le){const be=this._cascades[le];let xe=n.height/50,ye=1;le===0?ye=$:(xe=$,ye=W);const[Re,Ce]=Dm(n,this.shadowDirection,xe,ye,eu,Z);be.scale=n.scale,be.matrix=Re,be.boundingSphereRadius=Ce,a.bl(ne,be.matrix),be.frustum=a.cB.fromInvProjectionMatrix(ne,1,0,!0),be.far=ye}const te=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[te].far,this._cascades[te].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=eu,this._uniformValues.u_shadowmap_0=11,this._uniformValues.u_shadowmap_1=12,this._groundShadowTiles=m.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ae=m.transform.elevation;for(const le of this._groundShadowTiles){let be={min:0,max:0};if(ae){const xe=ae.getMinMaxForTile(le);xe&&(be=xe)}this.addShadowReceiver(le.toUnwrapped(),be.min,be.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,u){if(!this.enabled)return;const m=this.painter,x=m.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(m.transform.getFrustum(0),m.transform.worldSize,this._cascades),x.viewport.set([0,0,eu,eu]);for(let A=0;A<this._numCascadesToRender;++A){m.currentShadowCascade=A,x.bindFramebuffer.set(this._cascades[A].framebuffer.framebuffer),x.clear({color:a.ao.white,depth:1});for(const S of n.order){const O=n._mergedLayers[S];if(!O.hasShadowPass()||O.isHidden(m.transform.zoom))continue;const D=n.getLayerSourceCache(O),F=D?u[D.id]:void 0;(O.type==="model"||F&&F.length)&&m.renderLayer(m,D,O,F)}}m.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,u=n.style,m=n.context,x=m.gl,A=u.directionalLight,S=u.ambientLight;if(!A||!S)return;const O=[],D=Ys(n,n.longestCutoffRange);D.shouldRenderCutoff&&O.push("RENDER_CUTOFF"),O.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&O.push("NORMAL_OFFSET");const F=Wo(u,A,S),N=new mr(x.LEQUAL,mr.ReadOnly,n.depthRangeFor3D),Z=new Rr({func:x.EQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.KEEP);for(const $ of this._groundShadowTiles){const W=$.toUnwrapped(),ne=n.isTileAffectedByFog($),te=n.getOrCreateProgram("groundShadow",{defines:O,overrideFog:ne});this.setupShadows(W,te),n.uploadCommonUniforms(m,te,W,null,D);const ae=cs(n.transform.calculateProjMatrix(W),F);te.draw(n,x.TRIANGLES,N,Z,zr.multiply,Cr.disabled,ae,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,null,n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?zr.unblended:zr.disabled}getShadowPassDepthMode(){return this._depthMode}getGroundShadowLayerIndex(){return this._drawShadowAfterLayer}calculateShadowPassMatrixFromTile(n){const u=this.painter.transform,m=u.calculatePosMatrix(n,u.worldSize);return a.aB(m,this._cascades[this.painter.currentShadowCascade].matrix,m),Float32Array.from(m)}calculateShadowPassMatrixFromMatrix(n){const u=a.bz(n);return a.aB(u,this._cascades[this.painter.currentShadowCascade].matrix,n),u}setupShadows(n,u,m){if(!this.enabled)return;const x=this.painter.transform,A=this.painter.context,S=A.gl,O=this._uniformValues,D=new Float64Array(16),F=x.calculatePosMatrix(n,x.worldSize);for(let N=0;N<this._cascades.length;N++)a.aB(D,this._cascades[N].matrix,F),O[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),A.activeTexture.set(S.TEXTURE0+11+N),this._cascades[N].texture.bindExtraParam(S.LINEAR,S.LINEAR,S.CLAMP_TO_EDGE,S.CLAMP_TO_EDGE,S.GREATER);if(this.useNormalOffset=!!m,this.useNormalOffset){const N=a.d7(n.canonical),Z=2/x.tileSize*a.al/eu,$=Z*this._cascades[0].boundingSphereRadius,W=Z*this._cascades[this._cascades.length-1].boundingSphereRadius,ne=(m==="vector-tile"?1:3)*(function(te){const ae=a.aA((te-22)/-22,0,1);return .125*(1-ae)+4*ae})(x.zoom);O.u_shadow_normal_offset=[N,$*ne,W*ne],O.u_shadow_bias=[1e-4,.0012,.012]}else O.u_shadow_bias=[36e-5,.0012,.012];u.setShadowUniformValues(A,O)}setupShadowsFromMatrix(n,u,m=!1){if(!this.enabled)return;const x=this.painter.context,A=x.gl,S=this._uniformValues,O=new Float64Array(16);for(let D=0;D<2;D++)a.aB(O,this._cascades[D].matrix,n),S[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(O),x.activeTexture.set(A.TEXTURE0+11+D),this._cascades[D].texture.bindExtraParam(A.LINEAR,A.LINEAR,A.CLAMP_TO_EDGE,A.CLAMP_TO_EDGE,A.GREATER);this.useNormalOffset=m,m?(S.u_shadow_normal_offset=[1,3,3],S.u_shadow_bias=[6e-5,.0012,.012]):S.u_shadow_bias=[36e-5,.0012,.012],u.setShadowUniformValues(x,S)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,u,m,x){if(x[2]>=0)return{};const A=(function(D,F,N){const Z=N/(1<<D.canonical.z);return new a.d9([D.canonical.x*Z+D.wrap*N,D.canonical.y*Z+D.wrap*N,0],[(D.canonical.x+1)*Z+D.wrap*N,(D.canonical.y+1)*Z+D.wrap*N,F])})(n,u,m).getCorners(),S=u/-x[2];x[0]<0?(a.d8(A[0],A[0],[x[0]*S,0,0]),a.d8(A[3],A[3],[x[0]*S,0,0])):x[0]>0&&(a.d8(A[1],A[1],[x[0]*S,0,0]),a.d8(A[2],A[2],[x[0]*S,0,0])),x[1]<0?(a.d8(A[0],A[0],[0,x[1]*S,0]),a.d8(A[1],A[1],[0,x[1]*S,0])):x[1]>0&&(a.d8(A[2],A[2],[0,x[1]*S,0]),a.d8(A[3],A[3],[0,x[1]*S,0]));const O={};return O.vertices=A,O.planes=[tu(A[1],A[0],A[4]),tu(A[2],A[1],A[5]),tu(A[3],A[2],A[6]),tu(A[0],A[3],A[7])],O}addShadowReceiver(n,u,m){this._receivers.add(n,a.d9.fromTileIdAndHeight(n,u,m))}getMaxCascadeForTile(n){const u=this._receivers.get(n);return u&&u.lastCascade?u.lastCascade:0}}function tu(p,n,u){const m=a.av([],u,n),x=a.av([],p,n),A=a.bI([],m,x),S=a.ag(A);return S===0?[0,0,1,0]:(a.c5(A,A,1/S),[A[0],A[1],A[2],-a.bJ(A,n)])}function Pm(p){const n=p.properties.get("direction"),u=a.d4(n.x,n.y,n.z);u[2]=a.aA(u[2],0,75);const m=a.d6([u[0],u[1],u[2]]);return a.d5(m.x,m.y,m.z)}function Wo(p,n,u){const m=n.properties.get("color-use-theme")==="none",x=n.properties.get("color"),A=n.properties.get("intensity"),S=n.properties.get("direction"),O=[S.x,S.y,S.z],D=u.properties.get("color-use-theme")==="none",F=u.properties.get("color"),N=u.properties.get("intensity"),Z=Math.max(a.bJ([0,0,1],O),0),$=[0,0,0];a.c5($,F.toPremultipliedRenderColor(D?null:p.getLut(n.scope)).toArray01Linear().slice(0,3),N);const W=[0,0,0];return a.c5(W,x.toPremultipliedRenderColor(m?null:p.getLut(u.scope)).toArray01Linear().slice(0,3),Z*A),a.db([$[0]>0?$[0]/($[0]+W[0]):0,$[1]>0?$[1]/($[1]+W[1]):0,$[2]>0?$[2]/($[2]+W[2]):0])}function Dm(p,n,u,m,x,A){const S=p.zoom,O=p.scale,D=p.worldSize,F=1/D,N=p.aspect,Z=Math.sqrt(1+N*N)*Math.tan(.5*p.fovX),$=Z*Z,W=m-u,ne=m+u;let te,ae;$>W/ne?(te=m,ae=m*Z):(te=.5*ne*(1+$),ae=.5*Math.sqrt(W*W+2*(m*m+u*u)*$+ne*ne*$*$));const le=p.projection.pixelsPerMeter(p.center.lat,D),be=p._camera.getCameraToWorldMercator(),xe=[0,0,-te*F];a.af(xe,xe,be);let ye=ae*F;const Re=function(bt){return bt[0]/=O,bt[1]/=O,bt[2]=a.cf(bt[2],p._center.lat),bt},Ce=p._edgeInsets;if(!(Ce.left===0&&Ce.top===0&&Ce.right===0&&Ce.bottom===0||Ce.left===Ce.right&&Ce.top===Ce.bottom)){const bt=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?le:1),zt=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,u,m);zt[8]=2*-p.centerOffset.x/p.width,zt[9]=2*p.centerOffset.y/p.height;const qt=new Float64Array(16);a.cP(qt,zt,bt);const kt=new Float64Array(16);a.bl(kt,qt);const Lt=a.cB.fromInvProjectionMatrix(kt,D,S,!0);for(const hr of Lt.points){const sr=Re(hr);ye=Math.max(ye,a.c6(a.da([],xe,sr)))}}ye*=x/(x-1);const De=Math.acos(n[2]),Me=Math.atan2(-n[0],-n[1]),Te=new $d;Te.position=xe,Te.setPitchBearing(De,Me);const Ne=Te.getWorldToCamera(D,le),Ve=ye*D,He=Math.min(p._mercatorZfromZoom(17)*D*-2,-2*Ve),Qe=Te.getCameraToClipOrthographic(-Ve,Ve,-Ve,Ve,He,(Ve+A*le)/n[2]),We=new Float64Array(16);a.aB(We,Qe,Ne);const ut=a.d5(Math.floor(1e6*xe[0])/1e6*D,Math.floor(1e6*xe[1])/1e6*D,0),wt=.5*x,et=[0,0,0];a.af(et,ut,We),a.c5(et,et,wt);const je=[Math.floor(et[0]),Math.floor(et[1]),Math.floor(et[2])],mt=[0,0,0];a.av(mt,et,je),a.c5(mt,mt,-1/wt);const ot=new Float64Array(16);return a.bA(ot),a.br(ot,ot,mt),a.aB(We,ot,We),[We,Ve]}class ip extends a.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(n,u){return a.dc(this.requestManager.transformRequest(u,a.R.Model).url).then(m=>{if(!m)return;const x=a.dd(m),A=new a.de(n,u,void 0,void 0,x);return A.computeBoundsAndApplyParent(),A}).catch(m=>{if(m&&m.status===404)return null;this.fire(new a.y(new Error(`Could not load model ${n} from ${u}: ${m.message}`)))})}load(n,u,m={forceReload:!1}){this.models[u]||(this.models[u]={});const x=Object.keys(n),A=[],S=[];for(const O of x){const D=n[O];this.hasURLBeenRequested(D)&&!m.forceReload||(this.modelByURL[D]={modelId:O,scope:u},A.push(this.loadModel(O,D)),S.push(O)),this.models[u][O]||(this.models[u][O]={model:null,numReferences:1})}this.numModelsLoading[u]=(this.numModelsLoading[u]||0)+S.length,Promise.allSettled(A).then(O=>{for(let D=0;D<O.length;D++){const{status:F}=O[D];if(F==="rejected")continue;const{value:N}=O[D];this.models[u][S[D]]||(this.models[u][S[D]]={model:null,numReferences:1}),this.models[u][S[D]].model=N}this.numModelsLoading[u]-=S.length,this.fire(new a.z("data",{dataType:"style"}))}).catch(O=>{this.fire(new a.y(new Error(`Could not load models: ${O.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,u,m={exactIdMatch:!1}){return!!(m.exactIdMatch?this.getModel(n,u):this.getModelByURL(this.modelUris[u][n]))}getModel(n,u){return this.models[u]||(this.models[u]={}),this.models[u][n]?this.models[u][n].model:void 0}getModelByURL(n){if(!n)return null;const u=this.modelByURL[n];return u?this.models[u.scope][u.modelId].model:null}hasModelBeenAdded(n,u){return this.models[u]&&this.models[u][n]!==void 0}getModelURIs(n){return this.modelUris[n]||{}}addModel(n,u,m){this.models[m]||(this.models[m]={}),this.modelUris[m]||(this.modelUris[m]={});const x=this.requestManager.normalizeModelURL(u);if((this.hasModel(n,m,{exactIdMatch:!0})||this.hasModelBeenAdded(n,m))&&this.modelUris[m][n]===x)this.models[m][n].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:A,modelId:S}=this.modelByURL[x];this.models[A][S].numReferences++}else this.modelUris[m][n]=x,this.load({[n]:this.modelUris[m][n]},m)}addModelURLs(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const m=this.modelUris[u];for(const x in n)m[x]=this.requestManager.normalizeModelURL(n[x])}reloadModels(n){this.load(this.modelUris[n],n,{forceReload:!0})}addModelsFromBucket(n,u){this.models[u]||(this.models[u]={}),this.modelUris[u]||(this.modelUris[u]={});const m={};for(const x of n)this.hasModel(x,u,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[u][x].numReferences++:this.modelUris[u][x]&&!this.hasURLBeenRequested(x)?m[x]=this.modelUris[u][x]:!this.hasURLBeenRequested(x)&&a.df(x,!1)&&(this.modelUris[u][x]=this.requestManager.normalizeModelURL(x),m[x]=this.modelUris[u][x]);this.load(m,u)}hasURLBeenRequested(n){return this.modelByURL[n]!==void 0}removeModel(n,u,m=!1,x=!1){if(this.models[u]&&this.models[u][n]&&(this.models[u][n].numReferences--,this.models[u][n].numReferences===0||x)){const A=this.modelUris[u][n];m||delete this.modelUris[u][n],delete this.modelByURL[A];const S=this.models[u][n].model;if(!S)return;delete this.models[u][n],S.destroy()}}destroy(){for(const n of Object.keys(this.models))for(const u of Object.keys(this.models[n])){const m=this.models[n][u].model;delete this.models[n][u],m&&m.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,u){this.models[u]||(this.models[u]={});for(const m in this.models[u])this.models[u][m].model&&this.models[u][m].model.upload(n.context)}}const kl=a.a6.colorTheme,Ks=new a.a9({data:new a.aa(kl.data)});function h_(p){if(!p.metadata||!p.metadata.content_area)return;const n=a.o.devicePixelRatio,{left:u,top:m,width:x,height:A}=p.metadata.content_area,S=u*n,O=m*n;return[S,O,S+x*n,O+A*n]}function d_(p){if(p)return p.map(([n,u])=>[n*a.o.devicePixelRatio,u*a.o.devicePixelRatio])}class Gh{constructor(n,u,m){this.id=n,this.scope=u,this.sourceCache=m,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(n){this.missingRequests.has(n.name)||this.pendingRequests.has(n.name)||this.pendingRequests.add(n.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const n=new Map;if(!this.sourceCache.loaded())return n;const u=this.sourceCache.getVisibleCoordinates();if(u.length===0)return n;const m=this.sourceCache.getSource();if(!(m instanceof Po))return n;const x=u.map(S=>this.sourceCache.getTile(S)),A=m.getImages(x,Array.from(this.pendingRequests));for(const[S,O]of A)n.set(a.I.from({name:S,iconsetId:this.id}),O),this.pendingRequests.delete(S);for(const S of this.pendingRequests)this.missingRequests.add(S);return this.pendingRequests.clear(),n}}class Rm{constructor(){a.aY(["_onIndoorUpdate"],this)}onAdd(n){return this._map=n,this._container=H("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.style&&this._map.style.indoorManager.on("selector-update",u=>this._onIndoorUpdate(u)),this._container}_createButton(n,u){const m=H("button",n,this._container);return m.type="button",m.addEventListener("click",u),m}_createSeparator(){return H("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(n,u){this._map&&(n.setAttribute("aria-label",u),n.textContent=u)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.style&&(this._map.style.indoorManager.off("selector-update",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(n){if(!n||!n.floors)return this._model=n,void(this._container.style.display="none");const u=this._model;this._model=n,this._container.style.display="inline-block",this._container.style.borderRadius="8px",u&&Array.from(this._container.children).forEach(m=>m.remove()),n.floors.length>0&&(this.addBuildingsToggleButton(),this.addCurrentFloors(n.floors,n.activeFloorsVisible),this._updateBuildingsButtonState())}addBuildingsToggleButton(){const n=this._createButton("mapboxgl-ctrl-buildings-toggle",()=>{const u=this._map;this._model&&u&&u._setIndoorActiveFloorsVisibility(!this._model.activeFloorsVisible)});H("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden","true"),n.classList.add("mapboxgl-ctrl-level-button","mapboxgl-ctrl-buildings-toggle"),this._model&&!this._model.activeFloorsVisible&&n.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(n),this._createSeparator()}_updateBuildingsButtonState(){const n=this._container.querySelector(".mapboxgl-ctrl-buildings-toggle");n&&this._model&&(this._model.activeFloorsVisible?n.classList.remove("mapboxgl-ctrl-level-button-selected"):n.classList.add("mapboxgl-ctrl-level-button-selected"))}addCurrentFloors(n,u){for(let m=0;m<n.length;m++){const x=n[m],A=this._createButton("mapboxgl-ctrl-level-button",()=>{this._map._selectIndoorFloor(x.id)}),S=(x.name||"").trim(),O=x.zIndex.toString(),D=S?Array.from(S).slice(0,3).join(""):O;this._setButtonTitle(A,D),this._model&&x.id===this._model.selectedFloorId&&u&&A.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(A),m<n.length-1&&this._createSeparator()}}}class dv extends a.E{constructor(n){super(),this._style=n,this._buildings={},this._indoorControl=null,this._activeFloors=new Set,this._activeFloorsVisible=!0,this._indoorState={selectedFloorId:null,lastActiveFloors:null,activeFloorsVisible:!0},a.aY(["_updateUI"],this),this._style.on("style.load",()=>{this._style.isIndoorEnabled()&&(this._style.map.on("load",this._updateUI),this._style.map.on("move",this._updateUI),this._style.map.on("idle",this._updateUI),this._updateUI())})}destroy(){this._buildings={},this._activeFloors=new Set,this._indoorState=null,this._removeIndoorControl()}selectFloor(n){n===this._selectedFloorId&&this._activeFloorsVisible||(this._selectedFloorId=n,this._activeFloorsVisible=!0,this._updateActiveFloors())}setActiveFloorsVisibility(n){this._activeFloorsVisible=n,this._updateActiveFloors(),this._updateIndoorSelector()}setIndoorData(n){for(const[u,m]of Object.entries(n.buildings))if(this._buildings[u])for(const x of m.floorIds)this._buildings[u].floors[x]||(this._buildings[u].floors[x]=m.floors[x]);else this._buildings[u]=m;for(const u of n.activeFloors)this._activeFloors.add(u);this._updateIndoorSelector()}getIndoorTileOptions(n,u){const m=this._style.getIndoorSourceLayers(n,u);return m&&this._indoorState?{sourceLayers:m,indoorState:this._indoorState}:null}_addIndoorControl(){this._indoorControl||(this._indoorControl=new Rm,this._style.map.addControl(this._indoorControl,"right"))}_removeIndoorControl(){this._indoorControl&&(this._indoorControl.onRemove(),this._indoorControl=null)}_updateUI(){const n=this._style.map.transform,u=(function(m,x,A,S){let O=null,D=Number.MAX_SAFE_INTEGER;if(S<16)return null;for(const[F,N]of Object.entries(m)){const Z=N.center;if(Z){const $=x.distanceTo(a.aT.convert(Z));$<D&&A.contains(Z)&&(D=$,O=F)}}return O})(this._buildings,n.center,n.getBounds(),n.zoom);u!==this._closestBuildingId&&(this._closestBuildingId=u,this._updateIndoorSelector())}_updateIndoorSelector(){const n=this._buildings,u=this._closestBuildingId,m=u&&n?n[u]:void 0;if(!m)return this._removeIndoorControl(),void this.fire(new a.z("selector-update",{selectedFloorId:null,activeFloorsVisible:this._activeFloorsVisible,floors:[]}));this._addIndoorControl();let x=null;for(const S of m.floorIds)if(this._activeFloors&&this._activeFloors.has(S)){x=S;break}const A=Array.from(m.floorIds).map(S=>({id:S,name:m.floors[S].name,zIndex:m.floors[S].zIndex})).sort((S,O)=>O.zIndex-S.zIndex).filter((S,O,D)=>O===0||S.zIndex!==D[O-1].zIndex);this.fire(new a.z("selector-update",{selectedFloorId:x,activeFloorsVisible:this._activeFloorsVisible,floors:A}))}_updateActiveFloors(){const n=this._activeFloors;this._activeFloors=new Set,this._indoorState={selectedFloorId:this._selectedFloorId,lastActiveFloors:n,activeFloorsVisible:this._activeFloorsVisible},this._style.updateIndoorDependentLayers()}}const xc=(p,n)=>Fe(p,n&&n.filter(u=>u.identifier!=="source.canvas")),fv=a.aH(un,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setLayerProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),pv=a.aH(un,["setCenter","setZoom","setBearing","setPitch"]),zm=new Set(["background","sky","slot","custom"]),Lm={version:8,layers:[],sources:{}},ru={duration:300,delay:0};class Yo extends a.E{constructor(n,u={}){super(),this.map=n,this.scope=u.scope||"",this.globalId=null,this.fragments=[],this.importDepth=u.importDepth||0,this.importsCache=u.importsCache||new Map,this.resolvedImports=u.resolvedImports||new Set,this.transition=Object.assign({},ru),this._buildingIndex=new kh(this),this.crossTileSymbolIndex=new Yi,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedIndoor={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._hasAppearances=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._importedAsBasemap=!1,this._changes=u.styleChanges||new _n,this._hasDataDrivenEmissive=!1,this.indoorManager=new dv(this),this.dispatcher=u.dispatcher?u.dispatcher:new a.D(a.dh(),this),u.imageManager?this.imageManager=u.imageManager:(this.imageManager=new da(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=u.glyphManager?u.glyphManager:new a.di(n._requestManager,u.localFontFamily?a.dj.all:u.localIdeographFontFamily?a.dj.ideographs:a.dj.none,u.localFontFamily||u.localIdeographFontFamily),u.modelManager?this.modelManager=u.modelManager:(this.modelManager=new ip(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=u.configOptions?u.configOptions:new Map,this._configDependentLayers=u.configDependentLayers?u.configDependentLayers:new Set,this._indoorDependentLayers=u.indoorDependentLayers?u.indoorDependentLayers:new Set,this._config=u.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:u.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=u.initialConfig,this.dispatcher.broadcast("setReferrer",a.dk());const m=this;this._rtlTextPluginCallback=Yo.registerForPluginStateChange(x=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(A,S)=>{if(a.dl(A),S&&S.every(O=>O))for(const O in m._sourceCaches){const D=m._sourceCaches[O],F=D.getSource().type;F!=="vector"&&F!=="geojson"||D.reload()}})}),this.on("data",x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const A=this.getOwnSource(x.sourceId);if(A&&A.vectorLayerIds)for(const S in this._layers){const O=this._layers[S];O.source===A.id&&this._validateLayer(O)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(a.h(n))return n;const u=a.dm(n);if(!u.startsWith("http"))try{return new URL(u,location.href).toString()}catch{return u}return u}return`json://${a.dn(JSON.stringify(n))}`}_diffStyle(n,u,m){this.globalId=this._getGlobalId(n);const x=(A,S)=>{try{S(null,this.setState(A,m))}catch(O){S(O,!1)}};if(typeof n=="string"){const A=this.map._requestManager.normalizeStyleURL(n),S=this.map._requestManager.transformRequest(A,a.R.Style);a.m(S,(O,D)=>{O?this.fire(new a.y(O)):D&&x(D,u)})}else typeof n=="object"&&x(n,u)}loadURL(n,u={}){this.fire(new a.z("dataloading",{dataType:"style"}));const m=typeof u.validate=="boolean"?u.validate:!a.h(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,u.accessToken),this.resolvedImports.add(n);const x=this.importsCache.get(n);if(x)return this._load(x,m);const A=this.map._requestManager.transformRequest(n,a.R.Style);this._request=a.m(A,(S,O)=>{if(this._request=null,S)this.fire(new a.y(S));else if(O)return this.importsCache.set(n,O),this._load(O,m)})}loadJSON(n,u={}){this.fire(new a.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=a.o.frame(()=>{this._request=null,this._load(n,u.validate!==!1)})}loadEmpty(){this.fire(new a.z("dataloading",{dataType:"style"})),this._load(Lm,!1)}_loadImports(n,u,m){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const A of n){const S=this._createFragmentStyle(A),O=new Promise(N=>{S.once("style.import.load",N),S.once("error",N)}).then(()=>this.mergeAll());if(x.push(O),this.resolvedImports.has(A.url)){S.loadEmpty();continue}const D=A.data||this.importsCache.get(A.url);D?(S.loadJSON(D,{validate:u}),this._isInternalStyle(D)&&(S.globalId=null)):A.url?S.loadURL(A.url,{validate:u}):S.loadEmpty();const F={style:S,id:A.id,config:A.config};if(m){const N=this.fragments.findIndex(({id:Z})=>Z===m);this.fragments=this.fragments.slice(0,N).concat(F).concat(this.fragments.slice(N))}else this.fragments.push(F)}return Promise.allSettled(x)}getImportGlobalIds(n=this,u=new Set){for(const m of n.fragments)m.style.globalId&&u.add(m.style.globalId),this.getImportGlobalIds(m.style,u);return[...u.values()]}_createFragmentStyle(n){const u=this.scope?a.B(n.id,this.scope):n.id;let m;const x=this._initialConfig&&this._initialConfig[u];(n.config||x)&&(m=Object.assign({},n.config,x));const A=new Yo(this.map,{scope:u,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:m,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers,indoorDependentLayers:this._indoorDependentLayers});return A.setEventedParent(this.map,{style:A}),A}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this._updateLayers(this._indoorDependentLayers),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,u){if(this._isInternalStyle(n)){const A=Object.assign({},Lm,{imports:[{id:"basemap",data:n,url:""}]},n.center?{center:n.center}:{},n.bearing?{bearing:n.bearing}:{},n.pitch?{pitch:n.pitch}:{},n.zoom?{zoom:n.zoom}:{},n.light?{light:n.light}:{});return this._importedAsBasemap=!0,void this._load(A,u)}if(this.updateConfig(this._config,n.schema),u&&xc(this,Xa(n)))return;this._loaded=!0,this.stylesheet=a.dp(n);const m=()=>{for(const D in n.sources)this.addSource(D,n.sources[D],{validate:!1,isInitialLoad:!0});if(n.iconsets)for(const D in n.iconsets)this.addIconset(D,n.iconsets[D]);n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&n.glyphs&&this.glyphManager.setURL(n.glyphs);const A=Sm(this.stylesheet.layers);if(this._order=A.map(D=>D.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const D=this.stylesheet.lights[0];this.light=new at(D.properties,D.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new at(this.stylesheet.light)),this._layers={};for(const D of A){const F=a.du(D,this.scope,this._styleColorTheme.lut,this.options);F.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(F.fqid),F.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(F.fqid),this._hasAppearances=this._hasAppearances||F.getAppearances().length!==0,F.setEventedParent(this,{layer:{id:F.id}}),this._layers[F.id]=F;const N=this.getOwnLayerSourceCache(F),Z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();N&&F.canCastShadows()&&Z&&(N.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const S=this.stylesheet.terrain;S&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(S,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.z("data",{dataType:"style"}));const O=this.isRootStyle();n.imports?this._loadImports(n.imports,u).then(()=>{this._reloadImports(),this.fire(new a.z(O?"style.load":"style.import.load"))}).catch(D=>{this.fire(new a.y(new Error("Failed to load imports",D))),this.fire(new a.z(O?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.z(O?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const A=this._evaluateColorThemeData(x);this._loadColorTheme(A).then(()=>{m()}).catch(S=>{a.w(`Couldn't load color theme from the stylesheet: ${S}`),m()})}else this._styleColorTheme.lut=null,m()}isRootStyle(){return this.importDepth===0}hasAppearances(){return this._hasAppearances||this.fragments.some(n=>n.style.hasAppearances())}mergeAll(){let n,u,m,x,A,S,O,D,F,N;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle($=>{if($.stylesheet){if($.light!=null&&(n=$.light),$.stylesheet.lights)for(const W of $.stylesheet.lights)W.type==="ambient"&&$.ambientLight!=null&&(u=$.ambientLight),W.type==="directional"&&$.directionalLight!=null&&(m=$.directionalLight);x=this._prioritizeTerrain(x,$.terrain,$.stylesheet.terrain),$.stylesheet.fog&&$.fog!=null&&(A=$.fog),$.stylesheet.snow&&$.snow!=null&&(S=$.snow),$.stylesheet.rain&&$.rain!=null&&(O=$.rain),$.stylesheet.camera!=null&&(N=$.stylesheet.camera),$.stylesheet.projection!=null&&(D=$.stylesheet.projection),$.stylesheet.transition!=null&&(F=$.stylesheet.transition),Z[$.scope]=$._styleColorTheme}}),this.light=n,this.ambientLight=u,this.directionalLight=m,this.fog=A,this.snow=S,this.rain=O,this._styleColorThemeForScope=Z,x===null?delete this.terrain:this.terrain=x,this.camera=N||{"camera-projection":"perspective"},this.projection=D||{name:"mercator"},this.transition=Object.assign({},ru,F),this.mergeSources(),this.mergeLayers(),this.mergeIndoor()}forEachFragmentStyle(n){const u=m=>{for(const x of m.fragments)u(x.style);n(m)};u(this)}_prioritizeTerrain(n,u,m){const x=n&&n.drapeRenderMode===0;return m===null?u&&u.drapeRenderMode===0?u:x?n:null:u!=null&&(!n||x||u&&u.drapeRenderMode===1)?u:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(u=>{n=this._prioritizeTerrain(n,u.terrain,u.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(u=>{u.stylesheet.projection!=null&&(n=u.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},u={},m={};this.forEachFragmentStyle(x=>{for(const A in x._sourceCaches){const S=a.B(A,x.scope);n[S]=x._sourceCaches[A]}for(const A in x._otherSourceCaches){const S=a.B(A,x.scope);u[S]=x._otherSourceCaches[A]}for(const A in x._symbolSourceCaches){const S=a.B(A,x.scope);m[S]=x._symbolSourceCaches[A]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=u,this._mergedSymbolSourceCaches=m}mergeIndoor(){this.forEachFragmentStyle(n=>{if(n.stylesheet&&n.stylesheet.indoor)for(const u of Object.values(n.stylesheet.indoor)){const m=u,x=a.B(m.sourceId,n.scope);this._mergedIndoor[x]=new Set(m.sourceLayers||[])}})}mergeLayers(){const n={},u=[],m={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(S=>{for(const O of S._order){const D=S._layers[O];if(D.type==="slot"){const F=a.dq(O);if(n[F])continue;n[F]=[]}D.slot&&n[D.slot]?n[D.slot].push(D):u.push(D)}}),this._mergedOrder=[];let x=-1;const A=(S=[])=>{for(const O of S)if(O.type==="slot"){const D=a.dq(O.id);n[D]&&A(n[D]),this._mergedSlots.push(D)}else{const D=a.B(O.id,O.scope);this._mergedOrder.push(D),m[D]=O,O.is3D(!!this.terrain)&&(this._has3DLayers=!0,x=this._mergedOrder.length-1),O.type==="circle"&&(this._hasCircleLayers=!0),O.type==="symbol"&&(this._hasSymbolLayers=!0),O.type==="clip"&&(this._clipLayerPresent=!0)}};if(A(u),this._has3DLayers){const S={};for(let O=0;O<this._mergedOrder.length;++O){const D=this._mergedOrder[O];S[D]=O===x?1:O<x?m[D].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort((O,D)=>S[O]-S[D])}this._mergedLayers=m,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged(),this._updateDataDrivenEmissiveStrength()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?(function(u,m,x){const A=Object.assign({},m);for(const O of Object.keys(kl))A[O]===void 0&&(A[O]=kl[O].default);const S=new a.a8(Ks,u,new Map(x));return S.setTransitionOrValue(A,x),S.untransitioned().possiblyEvaluate(new a.ac(0,{worldview:void 0}))})(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const u=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((m,x)=>{const A="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void m();let S=n;S.startsWith(A)||(S=A+S);const O=a.I.from("mapbox-reserved-lut"),D=new Image;D.src=S,D.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},D.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==u)return void m();this._styleColorTheme.lutLoading=!1;const{width:F,height:N,data:Z}=a.o.getImageData(D);if(N>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(F!==N*N)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(O)&&this.removeImage(O),this.addImage(O,{data:new a.q({width:F,height:N},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const $=this.imageManager.getImage(O,this.scope);$?(this._styleColorTheme.lut={image:$.data,data:n},m()):x(new Error("Missing LUT image."))}})}getLut(n){const u=this._styleColorThemeForScope[n];return u?u.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=(function(u,m,x){let A,S,O;const D=a.o.devicePixelRatio>1?"@2x":"";let F=a.m(m.transformRequest(m.normalizeSpriteURL(u,D,".json"),a.R.SpriteJSON),($,W)=>{F=null,O||(O=$,A=W,Z())}),N=a.n(m.transformRequest(m.normalizeSpriteURL(u,D,".png"),a.R.SpriteImage),($,W)=>{N=null,O||(O=$,S=W,Z())});function Z(){if(O)x(O);else if(A&&S){const $=a.o.getImageData(S),W={};for(const ne in A){const{width:te,height:ae,x:le,y:be,sdf:xe,pixelRatio:ye,stretchX:Re,stretchY:Ce,content:De}=A[ne],Me=new a.q({width:te,height:ae});a.q.copy($,Me,{x:le,y:be},{x:0,y:0},{width:te,height:ae},null),W[ne]={data:Me,pixelRatio:ye!==void 0?ye:1,sdf:xe!==void 0&&xe,stretchX:Re,stretchY:Ce,content:De,usvg:!1,version:0}}x(null,W)}}return{cancel(){F&&(F.cancel(),F=null),N&&(N.cancel(),N=null)}}})(n,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new a.y(u));else if(m){const x=new Map;for(const A in m)x.set(a.I.from(A),m[A]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.z("data",{dataType:"style"}))})}addIconset(n,u){if(u.type==="sprite")return void this._loadSprite(u.url);const m=this.getOwnSourceCache(u.source);if(!m)return void this.fire(new a.y(new Error(`Source "${u.source}" as specified by iconset "${n}" does not exist and cannot be used as an iconset source`)));const x=m.getSource();if(x.type!=="raster-array")return void this.fire(new a.y(new Error(`Source "${u.source}" as specified by iconset "${n}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const A=new Gh(n,this.scope,m);this.imageManager.addImageProvider(A,this.scope)}removeIconset(n){this.imageManager.removeImageProvider(n,this.scope)}_loadIconset(n){if(!a.h(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const u=this.map._spriteFormat==="auto";var m,x;this._spriteRequest=(x=(A,S)=>{if(this._spriteRequest=null,A)u?this._loadSprite(n):this.fire(new a.y(A));else if(S){const O=new Map;for(const D in S)O.set(a.I.from(D),S[D]);this.addImages(O)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.z("data",{dataType:"style"}))},a.bu((m=this.map._requestManager).transformRequest(m.normalizeIconsetURL(n),a.R.Iconset),(A,S)=>{if(A)return void x(A);const O={},D=a.dg(new a.bt(S));for(const F of D.icons){const N={version:1,pixelRatio:a.o.devicePixelRatio,content:h_(F),stretchX:F.metadata?d_(F.metadata.stretch_x_areas):void 0,stretchY:F.metadata?d_(F.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:F};O[F.name]=N}x(null,O)}))}_validateLayer(n){const u=this.getOwnSource(n.source);if(!u)return;const m=n.sourceLayer;m&&(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(m)===-1)&&this.fire(new a.y(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,u)=>{const m=this.fragments[u];return m&&m.style&&(n.data=m.style.serialize()),n})}_serializeSources(){const n={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();n[m.id]||(n[m.id]=m.serialize())}return n}_serializeLayers(n){const u=[];for(const m of n){const x=this._layers[m];x&&x.type!=="custom"&&u.push(x.serialize())}return u}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_updateDataDrivenEmissiveStrength(){for(const n in this._mergedLayers){const u=this._mergedLayers[n];if(u._transitionablePaint&&u._transitionablePaint._values){const m=u._transitionablePaint._values["line-emissive-strength"];if(m&&m.value&&m.value.isDataDriven())return void(this._hasDataDrivenEmissive=!0)}}this._hasDataDrivenEmissive=!1}hasDataDrivenEmissiveStrength(){return this._hasDataDrivenEmissive}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const u=this.getOwnLayer(n);if(u)return u;this.fire(new a.y(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const u=this.getOwnSource(n);if(u)return u;this.fire(new a.y(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,u){const m=this.map.painter;if(m)for(let x=n.minzoom||0;x<(n.maxzoom||25.5);x++){const A=n.getProgramIds();if(A)for(const S of A){const O=n.getDefaultProgramParams(S,u.zoom,this._styleColorTheme.lut);O&&(m.style=this,this.fog&&(m._fogVisible=!0,O.overrideFog=!0,m.getOrCreateProgram(S,O)),m._fogVisible=!1,O.overrideFog=!1,m.getOrCreateProgram(S,O),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(O.overrideRtt=!0,m.getOrCreateProgram(S,O)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const u=this.calculateLightsBrightness();n.brightness=u||0,u!==this._brightness&&(this._brightness=u,this.dispatcher.broadcast("setBrightness",u)),n.worldview!==this._worldview&&(this._worldview=n.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const m=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const O=this._changes.getLayerUpdatesByScope();for(const D in O){const{updatedIds:F,removedIds:N}=O[D];(F||N)&&(this._updateWorkerLayers(D,F,N),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const A={};for(const O in this._mergedSourceCaches){const D=this._mergedSourceCaches[O];A[O]=D.used,D.used=!1,D.tileCoverLift=0}for(const O of this._mergedOrder){const D=this._mergedLayers[O];if(D.visibility!=="none"&&D.recalculate(n,this._availableImages),!D.isHidden(n.zoom)){const F=this.getLayerSourceCache(D);F&&(F.used=!0,F.tileCoverLift=Math.max(F.tileCoverLift,D.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(D,n)}):this.precompilePrograms(D,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const S=this.imageManager.getPendingImageProviders();for(const O of S)O.sourceCache.used=!0;for(const O in A){const D=this._mergedSourceCaches[O];A[O]!==D.used&&D.getSource().fire(new a.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:D.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),m&&this.fire(new a.z("data",{dataType:"style"}))}updateImageProviders(){const n=this.imageManager.getPendingImageProviders();for(const u of n){const m=u.resolvePendingRequests(),x=this.getFragmentStyle(u.scope);x&&x.addImages(m)}}_updateTilesForChangedImages(){const n={};for(const u in this._mergedSourceCaches){const m=this._mergedSourceCaches[u].getSource().scope;n[m]=n[m]||this._changes.getUpdatedImages(m),n[m].length!==0&&this._mergedSourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n[m])}for(const u in n)this._changes.resetUpdatedImages(u)}_updateWorkerLayers(n,u,m){const x=this.getFragmentStyle(n);x&&this.dispatcher.broadcast("updateLayers",{layers:u?x._serializeLayers(u):[],scope:n,removedIds:m||[],options:x.options})}setState(n,u){if(this._checkLoaded(),xc(this,Xa(n)))return!1;(n=a.dp(n)).layers=Sm(n.layers);const m=(function(S,O){if(!S)return[{command:un.setStyle,args:[O]}];let D=[];try{if(!a.by(S.version,O.version))return[{command:un.setStyle,args:[O]}];if(a.by(S.center,O.center)||D.push({command:un.setCenter,args:[O.center]}),a.by(S.zoom,O.zoom)||D.push({command:un.setZoom,args:[O.zoom]}),a.by(S.bearing,O.bearing)||D.push({command:un.setBearing,args:[O.bearing]}),a.by(S.pitch,O.pitch)||D.push({command:un.setPitch,args:[O.pitch]}),a.by(S.sprite,O.sprite)||D.push({command:un.setSprite,args:[O.sprite]}),a.by(S.glyphs,O.glyphs)||D.push({command:un.setGlyphs,args:[O.glyphs]}),a.by(S.imports,O.imports)||(function(W=[],ne=[],te){ne=ne||[];const ae=(W=W||[]).map(ml),le=ne.map(ml),be=W.reduce(Jf,{}),xe=ne.reduce(Jf,{}),ye=ae.slice();let Re,Ce,De,Me;for(Re=0,Ce=0;Re<ae.length;Re++)De=ae[Re],xe.hasOwnProperty(De)?Ce++:(te.push({command:un.removeImport,args:[De]}),ye.splice(ye.indexOf(De,Ce),1));for(Re=0,Ce=0;Re<le.length;Re++)De=le[le.length-1-Re],ye[ye.length-1-Re]!==De&&(be.hasOwnProperty(De)?(te.push({command:un.removeImport,args:[De]}),ye.splice(ye.lastIndexOf(De,ye.length-Ce),1)):Ce++,Me=ye[ye.length-Re],te.push({command:un.addImport,args:[xe[De],Me]}),ye.splice(ye.length-Re,0,De));for(const Te of ne){const Ne=be[Te.id];Ne&&(delete Ne.data,a.by(Ne,Te)||te.push({command:un.updateImport,args:[Te.id,Te]}))}})(S.imports,O.imports,D),a.by(S.transition,O.transition)||D.push({command:un.setTransition,args:[O.transition]}),a.by(S.light,O.light)||D.push({command:un.setLight,args:[O.light]}),a.by(S.fog,O.fog)||D.push({command:un.setFog,args:[O.fog]}),a.by(S.snow,O.snow)||D.push({command:un.setSnow,args:[O.snow]}),a.by(S.rain,O.rain)||D.push({command:un.setRain,args:[O.rain]}),a.by(S.projection,O.projection)||D.push({command:un.setProjection,args:[O.projection]}),a.by(S.lights,O.lights)||D.push({command:un.setLights,args:[O.lights]}),a.by(S.camera,O.camera)||D.push({command:un.setCamera,args:[O.camera]}),a.by(S.iconsets,O.iconsets)||(function(W,ne,te){let ae;for(ae in ne=ne||{},W=W||{})W.hasOwnProperty(ae)&&(ne.hasOwnProperty(ae)||te.push({command:un.removeIconset,args:[ae]}));for(ae in ne){if(!ne.hasOwnProperty(ae))continue;const le=ne[ae];W.hasOwnProperty(ae)?a.by(W[ae],le)||(te.push({command:un.removeIconset,args:[ae]}),te.push({command:un.addIconset,args:[ae,le]})):te.push({command:un.addIconset,args:[ae,le]})}})(S.iconsets,O.iconsets,D),!a.by(S["color-theme"],O["color-theme"]))return[{command:un.setStyle,args:[O]}];const F={},N=[];(function(W,ne,te,ae){let le;for(le in ne=ne||{},W=W||{})W.hasOwnProperty(le)&&(ne.hasOwnProperty(le)||Qf(le,te,ae));for(le in ne){if(!ne.hasOwnProperty(le))continue;const be=ne[le];W.hasOwnProperty(le)?a.by(W[le],be)||(W[le].type==="geojson"&&be.type==="geojson"&&$u(W,ne,le)?te.push({command:un.setGeoJSONSourceData,args:[le,be.data]}):os(le,ne,te,ae)):Kc(le,ne,te)}})(S.sources,O.sources,N,F);const Z=[];S.layers&&S.layers.forEach(W=>{W.source&&F[W.source]?D.push({command:un.removeLayer,args:[W.id]}):Z.push(W)});let $=S.terrain;$&&F[$.source]&&(D.push({command:un.setTerrain,args:[void 0]}),$=void 0),D=D.concat(N),a.by($,O.terrain)||D.push({command:un.setTerrain,args:[O.terrain]}),(function(W,ne,te){ne=ne||[];const ae=(W=W||[]).map(ml),le=ne.map(ml),be=W.reduce(Jf,{}),xe=ne.reduce(Jf,{}),ye=ae.slice(),Re=Object.create(null);let Ce,De,Me,Te,Ne,Ve,He;for(Ce=0,De=0;Ce<ae.length;Ce++)Me=ae[Ce],xe.hasOwnProperty(Me)?De++:(te.push({command:un.removeLayer,args:[Me]}),ye.splice(ye.indexOf(Me,De),1));for(Ce=0,De=0;Ce<le.length;Ce++)Me=le[le.length-1-Ce],ye[ye.length-1-Ce]!==Me&&(be.hasOwnProperty(Me)?(te.push({command:un.removeLayer,args:[Me]}),ye.splice(ye.lastIndexOf(Me,ye.length-De),1)):De++,Ve=ye[ye.length-Ce],te.push({command:un.addLayer,args:[xe[Me],Ve]}),ye.splice(ye.length-Ce,0,Me),Re[Me]=!0);for(Ce=0;Ce<le.length;Ce++)if(Me=le[Ce],Te=be[Me],Ne=xe[Me],!Re[Me]&&!a.by(Te,Ne))if(a.by(Te.source,Ne.source)&&a.by(Te["source-layer"],Ne["source-layer"])&&a.by(Te.type,Ne.type)){for(He in qu(Te.layout,Ne.layout,te,Me,null,un.setLayoutProperty),qu(Te.paint,Ne.paint,te,Me,null,un.setPaintProperty),a.by(Te.slot,Ne.slot)||te.push({command:un.setSlot,args:[Me,Ne.slot]}),a.by(Te.filter,Ne.filter)||te.push({command:un.setFilter,args:[Me,Ne.filter]}),a.by(Te.minzoom,Ne.minzoom)&&a.by(Te.maxzoom,Ne.maxzoom)||te.push({command:un.setLayerZoomRange,args:[Me,Ne.minzoom,Ne.maxzoom]}),Te)Te.hasOwnProperty(He)&&He!=="layout"&&He!=="paint"&&He!=="filter"&&He!=="metadata"&&He!=="minzoom"&&He!=="maxzoom"&&He!=="slot"&&(He.indexOf("paint.")===0?qu(Te[He],Ne[He],te,Me,He.slice(6),un.setPaintProperty):a.by(Te[He],Ne[He])||te.push({command:un.setLayerProperty,args:[Me,He,Ne[He]]}));for(He in Ne)Ne.hasOwnProperty(He)&&!Te.hasOwnProperty(He)&&He!=="layout"&&He!=="paint"&&He!=="filter"&&He!=="metadata"&&He!=="minzoom"&&He!=="maxzoom"&&He!=="slot"&&(He.indexOf("paint.")===0?qu(Te[He],Ne[He],te,Me,He.slice(6),un.setPaintProperty):a.by(Te[He],Ne[He])||te.push({command:un.setLayerProperty,args:[Me,He,Ne[He]]}))}else te.push({command:un.removeLayer,args:[Me]}),Ve=ye[ye.lastIndexOf(Me)+1],te.push({command:un.addLayer,args:[Ne,Ve]})})(Z,O.layers,D)}catch(F){console.warn("Unable to compute style diff:",F),D=[{command:un.setStyle,args:[O]}]}return D})(this.serialize(),n).filter(S=>!(S.command in pv));if(m.length===0)return!1;const x=m.filter(S=>!(S.command in fv));if(x.length>0)throw new Error(`Unimplemented: ${x.map(S=>S.command).join(", ")}.`);const A=[];return m.forEach(S=>{A.push(this[S.command](...S.args))}),u&&Promise.all(A).then(u).catch(u),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(n){if(n.size===0)return this;for(const[u,m]of n.entries()){if(this.getImage(u))return this.fire(new a.y(new Error(`An image with the name "${u.name}" already exists.`)));this.imageManager.addImage(u,this.scope,m),this._changes.updateImage(u,this.scope)}return this._updateWorkerImages(),this.fire(new a.z("data",{dataType:"style"})),this}addImage(n,u){return this.getImage(n)?this.fire(new a.y(new Error(`An image with the name "${n.name}" already exists.`))):(this.imageManager.addImage(n,this.scope,u),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new a.z("data",{dataType:"style"})),this)}updateImage(n,u,m=!1){this.imageManager.updateImage(n,this.scope,u),m&&(this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new a.z("data",{dataType:"style"})))}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new a.z("data",{dataType:"style"})),this):this.fire(new a.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}getActualScope(){return this._importedAsBasemap?"basemap":this.scope}addModelURLs(n){return this.modelManager.addModelURLs(n,this.getActualScope()),this._updateWorkerModels(),this.fire(new a.z("data",{dataType:"style"})),this}addModel(n,u,m={}){return this._checkLoaded(),this._validate(ze,`models.${n}`,u,null,m)||(this.modelManager.addModel(n,u,this.getActualScope()),this.fire(new a.z("data",{dataType:"style"}))),this}hasModel(n){return this.modelManager.hasModel(n,this.getActualScope())}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.getActualScope(),!1,!0),this.fire(new a.z("data",{dataType:"style"})),this):this.fire(new a.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.getActualScope())}addSource(n,u,m={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(Tn,`sources.${n}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=hl(n,u,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id}));const A=S=>{const O=(S?"symbol:":"other:")+x.id,D=a.B(O,this.scope),F=this._sourceCaches[O]=new va(D,x,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=F,F.onAdd(this.map)};A(!1),u.type!=="vector"&&u.type!=="geojson"||A(!0),x.onAdd&&x.onAdd(this.map),m.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const u=this.getOwnSource(n);if(!u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===n)return this.fire(new a.y(new Error(`Source "${n}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new a.y(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find(([A,S])=>S.type==="source"&&S.source===n);if(x)return this.fire(new a.y(new Error(`Source "${n}" cannot be removed while iconset "${x[0]}" is using it.`)))}const m=this.getOwnSourceCaches(n);for(const x of m){const A=a.dq(x.id);delete this._sourceCaches[A],this._changes.discardSourceCacheUpdate(x.id),x.fire(new a.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,u){this._checkLoaded(),this.getOwnSource(n).setData(u),this._changes.setDirty()}getOwnSource(n){const u=this.getOwnSourceCache(n);return u&&u.getSource()}getOwnSources(){const n=[];for(const u in this._otherSourceCaches){const m=this.getOwnSourceCache(u);m&&n.push(m.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const u in n){const m=n[u]._tiles;for(const x in m){const A=m[x];if(A.state!=="loaded"&&A.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const u=this._getTransitionParameters();for(const A of n){if(this._validate(yt,"lights",A))return;switch(A.type){case"ambient":if(this.ambientLight){const S=this.ambientLight;S.set(A),S.updateTransitions(u)}else this.ambientLight=new on(A,Gn(),this.scope,this.options);break;case"directional":if(this.directionalLight){const S=this.directionalLight;S.set(A),S.updateTransitions(u)}else this.directionalLight=new on(A,jn(),this.scope,this.options)}}const m=Object.assign(u,{worldview:this.map.getWorldview()}),x=new a.ac(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,u=this.ambientLight;if(!n||!u)return;const m=$=>.2126*($[0]<=.03928?$[0]/12.92:Math.pow(($[0]+.055)/1.055,2.4))+.7152*($[1]<=.03928?$[1]/12.92:Math.pow(($[1]+.055)/1.055,2.4))+.0722*($[2]<=.03928?$[2]/12.92:Math.pow(($[2]+.055)/1.055,2.4)),x=n.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),A=n.properties.get("intensity"),S=n.properties.get("direction"),O=1-a.d4(S.x,S.y,S.z)[2]/90,D=m(x)*A*O,F=u.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),N=u.properties.get("intensity"),Z=m(F)*N;return Number(((D+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(n==null||n===""&&this.isRootStyle())return this;if(a.dr(n)){const u=a.ds(n),m=this.fragments.find(({id:A})=>A===u);if(!m)return;const x=a.dq(n);return m.style.getFragmentStyle(x)}{const u=this.fragments.find(({id:m})=>m===n);return u?u.style:void 0}}setFeaturesetSelectors(n){if(!n)return;const u={},m=(x,A="")=>`${x}::${A}`;this._featuresetSelectors={};for(const x in n){const A=this._featuresetSelectors[x]=[];for(const S of n[x].selectors){if(S.featureNamespace){const D=this.getOwnLayer(S.layer);if(!D){a.w(`Layer is undefined for selector: ${S.layer}`);continue}const F=m(D.source,D.sourceLayer);if(F in u&&u[F]!==S.featureNamespace){a.w(`"featureNamespace ${S.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}u[F]=S.featureNamespace}let O;if(S.properties)for(const D in S.properties){const F=a.U(S.properties[D]);F.result==="success"&&(O=O||{},O[D]=F.value)}A.push({layerId:S.layer,namespace:S.featureNamespace,properties:O,uniqueFeatureID:S._uniqueFeatureID})}}}getFeaturesetDescriptors(n){const u=this.getFragmentStyle(n);if(!u||!u.stylesheet.featuresets)return[];const m=[];for(const x in u.stylesheet.featuresets)m.push({featuresetId:x,importId:u.scope?u.scope:void 0});return m}getFeaturesetLayers(n,u){const m=this.getFragmentStyle(u),x=m.stylesheet.featuresets;if(!x||!x[n])return this.fire(new a.y(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const A=[];for(const S of x[n].selectors){const O=m.getOwnLayer(S.layer);O&&A.push(O)}return A}getConfigProperty(n,u){const m=this.getFragmentStyle(n);if(!m)return null;const x=a.B(u,m.scope),A=m.options.get(x),S=A?A.value||A.default:null;return S?S.serialize():null}isIndoorEnabled(){return Object.keys(this._mergedIndoor).length>0}getIndoorSourceLayers(n,u){const m=a.B(n,u);return this._mergedIndoor[m]}setIndoorData(n,u){this.indoorManager.setIndoorData(u)}updateIndoorDependentLayers(){this._updateLayers(this._indoorDependentLayers),this.map._styleDirty=!0,this.map.triggerRepaint()}setConfigProperty(n,u,m){const x=this.getFragmentStyle(n);if(!x)return;const A=x.stylesheet.schema;if(!A||!A[u])return;const S=a.U(m);if(S.result!=="success")return void xc(this,S.value);const O=S.value.expression,D=a.B(u,x.scope),F=x.options.get(D);if(!F)return;let N;const{minValue:Z,maxValue:$,stepValue:W,type:ne,values:te}=A[u],ae=a.U(A[u].default);ae.result==="success"&&(N=ae.value.expression),N?(this.options.set(D,Object.assign({},F,{value:O,default:N,minValue:Z,maxValue:$,stepValue:W,type:ne,values:te})),this.updateConfigDependencies(u)):this.fire(new a.y(new Error(`No schema defined for the config option "${u}" in the "${n}" fragment.`)))}getConfig(n){const u=this.getFragmentStyle(n);if(!u)return null;const m=u.stylesheet.schema;if(!m)return null;const x={};for(const A in m){const S=a.B(A,u.scope),O=u.options.get(S),D=O?O.value||O.default:null;x[A]=D?D.serialize():null}return x}setConfig(n,u){const m=this.getFragmentStyle(n);m&&(m.updateConfig(u,m.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const u=this.getFragmentStyle(n);return u?u.stylesheet.schema:null}setSchema(n,u){const m=this.getFragmentStyle(n);m&&(m.stylesheet.schema=u,m.updateConfig(m._config,u),this.updateConfigDependencies())}updateConfig(n,u){if(this._config=n,n||u)if(u)for(const m in u){let x,A;const S=a.U(u[m].default);if(S.result==="success"&&(x=S.value.expression),n&&n[m]!==void 0){const $=a.U(n[m]);$.result==="success"&&(A=$.value.expression)}const{minValue:O,maxValue:D,stepValue:F,type:N,values:Z}=u[m];if(x){const $=a.B(m,this.scope);this.options.set($,{default:x,value:A,minValue:O,maxValue:D,stepValue:F,type:N,values:Z})}else this.fire(new a.y(new Error(`No schema defined for config option "${m}".`)))}else this.fire(new a.y(new Error("Attempting to set config for a style without schema.")))}_updateLayers(n,u=()=>!0){for(const m of n){const x=this.getLayer(m);x&&u(x)&&(x.possiblyEvaluateVisibility(),this._updateLayer(x),this._changes.setDirty())}}updateConfigDependencies(n){this._updateLayers(this._configDependentLayers,u=>!n||u.expressionDependencies.configDependencies.has(n)),this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(u=>{const m=u._styleColorTheme.colorThemeOverride?u._styleColorTheme.colorThemeOverride:u._styleColorTheme.colorTheme;if(m){const x=u._evaluateColorThemeData(m);(!u._styleColorTheme.lut&&x!==""||u._styleColorTheme.lut&&x!==u._styleColorTheme.lut.data)&&u.setColorTheme(m)}}),this._changes.setDirty()}addLayer(n,u,m={}){this._checkLoaded();const x=n.id;if(this._layers[x])return void this.fire(new a.y(new Error(`Layer with id "${x}" already exists on this map`)));let A;if(n.type==="custom"){if(xc(this,a.dt(n)))return;A=a.du(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(x,n.source),n=a.dp(n),n=Object.assign(n,{source:x})),this._validate(Xe,`layers.${x}`,n,{arrayIndex:-1},m))return;A=a.du(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(A),A.setEventedParent(this,{layer:{id:x}})}const S=a.B(A.source,A.scope);A.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(S),A.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(S);let O=this._order.length;if(u){const Z=this._order.indexOf(u);if(Z===-1)return void this.fire(new a.y(new Error(`Layer with id "${u}" does not exist on this map.`)));A.slot&&A.slot!==this._layers[u].slot?a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`):O=Z}this._order.splice(O,0,x),this._handleLayerOrderChange(),this._layers[x]=A;const D=this.getOwnLayerSourceCache(A),F=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&A.canCastShadows()&&F&&(D.castsShadows=!0);const N=this._changes.getRemovedLayer(A);if(N&&A.source&&D&&A.type!=="custom"){this._changes.discardLayerRemoval(A);const Z=a.B(A.source,A.scope);N.type!==A.type?this._changes.updateSourceCache(Z,"clear"):(this._changes.updateSourceCache(Z,"reload"),D.pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map),A.scope=this.scope,this.mergeLayers()}moveLayer(n,u){this._checkLoaded();const m=this._checkLayer(n);if(!m||n===u)return;const x=this._order.indexOf(n);this._order.splice(x,1);let A=this._order.length;if(u){const S=this._order.indexOf(u);if(S===-1)return void this.fire(new a.y(new Error(`Layer with id "${u}" does not exist on this map.`)));m.slot&&m.slot!==this._layers[u].slot?a.w(`Layer with id "${u}" has a different slot. Layers can only be rearranged within the same slot.`):A=S}this._order.splice(A,0,n),this._changes.setDirty(),this._handleLayerOrderChange(),this.mergeLayers()}removeLayer(n){this._checkLoaded();const u=this._checkLayer(n);if(!u)return;u.setEventedParent(null);const m=this._order.indexOf(n);this._order.splice(m,1),delete this._layers[n],this._changes.setDirty(),this._handleLayerOrderChange(),this._configDependentLayers.delete(u.fqid),this._indoorDependentLayers.delete(u.fqid),this._changes.removeLayer(u);const x=this.getOwnLayerSourceCache(u);if(x&&x.castsShadows){let A=!1;for(const S in this._layers)if(this._layers[S].source===u.source&&this._layers[S].canCastShadows()){A=!0;break}x.castsShadows=A}u.onRemove&&u.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const u in this._layers)if(this._layers[u].type===n)return!0;return!1}setLayerZoomRange(n,u,m){this._checkLoaded();const x=this._checkLayer(n);x&&(x.minzoom===u&&x.maxzoom===m||(u!=null&&(x.minzoom=u),m!=null&&(x.maxzoom=m),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,u){this._checkLoaded();const m=this._checkLayer(n);m&&m.slot!==u&&(m.slot=u,this._updateLayer(m))}setFilter(n,u,m={}){this._checkLoaded();const x=this._checkLayer(n);if(x&&!a.by(x.filter,u))return u==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(ie,`layers.${x.id}.filter`,u,{layerType:x.type},m)||(x.filter=a.dp(u),this._updateLayer(x)))}getFilter(n){const u=this._checkLayer(n);if(u)return a.dp(u.filter)}setLayoutProperty(n,u,m,x={}){this._checkLoaded();const A=this._checkLayer(n);if(A&&!a.by(A.getLayoutProperty(u),m)){if(m!=null&&(!x||x.validate!==!1)&&xc(A,Ae.call(Xa,{key:`layers.${n}.layout.${u}`,layerType:A.type,objectKey:u,value:m,styleSpec:a.a6,style:{glyphs:!0,sprite:!0}})))return;A.setLayoutProperty(u,m),A.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),A.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(A.fqid),this._updateLayer(A)}}setLayerProperty(n,u,m,x={}){this._checkLoaded();const A=this._checkLayer(n);A&&(u==="appearances"?(A.setAppearances(m),this._changes.setDirty()):A.isPaintProperty(u)?this.setPaintProperty(n,u,m,x):this.setLayoutProperty(n,u,m,x))}getLayoutProperty(n,u){const m=this._checkLayer(n);if(m)return m.getLayoutProperty(u)}setPaintProperty(n,u,m,x={}){this._checkLoaded();const A=this._checkLayer(n);if(!A||a.by(A.getPaintProperty(u),m)||m!=null&&(!x||x.validate!==!1)&&xc(A,de.call(Xa,{key:`layers.${n}.paint.${u}`,layerType:A.type,objectKey:u,value:m,styleSpec:a.a6})))return;const S=A.setPaintProperty(u,m);A.expressionDependencies.configDependencies.size!==0&&this._configDependentLayers.add(A.fqid),A.expressionDependencies.isIndoorDependent&&this._indoorDependentLayers.add(A.fqid),S&&this._updateLayer(A),this._changes.updatePaintProperties(A)}getPaintProperty(n,u){const m=this._checkLayer(n);if(m)return m.getPaintProperty(u)}setFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:D,importId:F}=n.target,N=this.getFragmentStyle(F),Z=N.getFeaturesetLayers(D);for(const{source:$,sourceLayer:W}of Z)N.setFeatureState({id:n.id,source:$,sourceLayer:W},u)}else if("layerId"in n.target){const{layerId:D}=n.target,F=this.getLayer(D);this.setFeatureState({id:n.id,source:F.source,sourceLayer:F.sourceLayer},u)}return}const m=n.source,x=n.sourceLayer,A=this._checkSource(m);if(!A)return;const S=A.type;if(S==="geojson"&&x)return void this.fire(new a.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!x)return void this.fire(new a.y(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new a.y(new Error("The feature id parameter must be provided.")));const O=this.getOwnSourceCaches(m);for(const D of O)D.setFeatureState(x,n.id,u)}removeFeatureState(n,u){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:D,importId:F}=n.target,N=this.getFragmentStyle(F),Z=N.getFeaturesetLayers(D);for(const{source:$,sourceLayer:W}of Z)N.removeFeatureState({id:n.id,source:$,sourceLayer:W},u)}else if("layerId"in n.target){const{layerId:D}=n.target,F=this.getLayer(D);this.removeFeatureState({id:n.id,source:F.source,sourceLayer:F.sourceLayer},u)}return}const m=n.source,x=this._checkSource(m);if(!x)return;const A=x.type,S=A==="vector"?n.sourceLayer:void 0;if(A==="vector"&&!S)return void this.fire(new a.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new a.y(new Error("A feature id is required to remove its specific state property.")));const O=this.getOwnSourceCaches(m);for(const D of O)D.removeFeatureState(S,n.id,u)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let A;if("featuresetId"in n.target){const{featuresetId:S,importId:O}=n.target,D=this.getFragmentStyle(O),F=D.getFeaturesetLayers(S);for(const{source:N,sourceLayer:Z}of F){const $=D.getFeatureState({id:n.id,source:N,sourceLayer:Z});if($&&!A)A=$;else if(!a.by(A,$))return void this.fire(new a.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:S}=n.target,O=this.getLayer(S);A=this.getFeatureState({id:n.id,source:O.source,sourceLayer:O.sourceLayer})}return A}const u=n.source,m=n.sourceLayer,x=this._checkSource(u);if(x){if(x.type!=="vector"||m)return n.id===void 0&&this.fire(new a.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(u)[0].getFeatureState(m,n.id);this.fire(new a.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),u=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return a.dv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,featuresets:this.stylesheet.featuresets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:u,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,indoor:this.stylesheet.indoor,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateFilteredLayers(n){for(const u of Object.values(this._mergedLayers))n(u)&&this._updateLayer(u)}_updateLayer(n){this._changes.updateLayer(n);const u=this.getLayerSourceCache(n),m=a.B(n.source,n.scope),x=this._changes.getUpdatedSourceCaches();n.source&&!x[m]&&u&&u.getSource().type!=="raster"&&(this._changes.updateSourceCache(m,"reload"),u.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const u=O=>this._mergedLayers[O].is3D(!!this.terrain),m=this.order,x={},A=[];for(let O=m.length-1;O>=0;O--){const D=m[O];if(u(D)){x[D]=O;for(const F of n){const N=F[D];if(N)for(const Z of N)A.push(Z)}}}A.sort((O,D)=>D.intersectionZ-O.intersectionZ);const S=[];for(let O=m.length-1;O>=0;O--){const D=m[O];if(u(D))for(let F=A.length-1;F>=0;F--){const N=A[F].feature;if(N.layer&&x[N.layer.id]<O)break;S.push(N),A.pop()}else for(const F of n){const N=F[D];if(N)for(const Z of N)S.push(Z.feature)}}return S}queryRasterValue(n,u,m){const x=this.getOwnSource(n);return x?x.type!=="raster-array"?(this.fire(new a.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):x.queryRasterArrayValue(u,m):(this.fire(new a.y(new Error(`Source with id "${n}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(n,u,m){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ie,"queryRenderedFeatures.filter",u.filter,null,u),x=a.b6(u.filter));const A={},S=N=>{if(zm.has(N.type))return;const Z=this.getOwnLayerSourceCache(N),$=A[Z.id]=A[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};N.is3D(!!this.terrain)&&($.has3DLayers=!0),$.layers[N.fqid]=$.layers[N.fqid]||{styleLayer:N,targets:[]},$.layers[N.fqid].targets.push({filter:x})};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.y(new Error("parameters.layers must be an Array."))),[];for(const N of u.layers){const Z=this._layers[N];if(!Z)return this.fire(new a.y(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];S(Z)}}else for(const N in this._layers)S(this._layers[N]);const O=this._queryRenderedFeatures(n,A,m),D=this._flattenAndSortRenderedFeatures(O),F=[];for(const N of D)a.dw(N.layer.id)===this.scope&&F.push(N);return F}queryRenderedFeatureset(n,u,m){let x;u&&!Array.isArray(u)&&u.filter&&(this._validate(ie,"queryRenderedFeatures.filter",u.filter,null,u),x=a.b6(u.filter));const A="mock",S=[];if(u&&u.target)S.push(Object.assign({},u,{targetId:A,filter:x}));else{const N=this.getFeaturesetDescriptors();for(const Z of N)S.push({targetId:A,filter:x,target:Z});for(const{style:Z}of this.fragments){const $=Z.getFeaturesetDescriptors();for(const W of $)S.push({targetId:A,filter:x,target:W})}}const O=this.queryRenderedTargets(n,S,m),D=[],F=new Set;for(const N of O)for(const Z of N.variants[A])zd(Z,N,F)||D.push(new a.dx(N,Z));return D}queryRenderedTargets(n,u,m){const x={},A=(O,D,F,N)=>{const Z=x[D.id]=x[D.id]||{sourceCache:D,layers:{},has3DLayers:!1};if(Z.layers[O.fqid]=Z.layers[O.fqid]||{styleLayer:O,targets:[]},O.is3D(!!this.terrain)&&(Z.has3DLayers=!0),!N)return F.uniqueFeatureID=!1,void Z.layers[O.fqid].targets.push(F);Z.layers[O.fqid].targets.push(Object.assign({},F,{namespace:N.namespace,properties:N.properties,uniqueFeatureID:N.uniqueFeatureID}))};for(const O of u)if("featuresetId"in O.target){const{featuresetId:D,importId:F}=O.target,N=this.getFragmentStyle(F);if(!N||!N._featuresetSelectors)continue;const Z=N._featuresetSelectors[D];if(!Z){this.fire(new a.y(new Error(`The featureset '${D}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const $ of Z){const W=N.getOwnLayer($.layerId);W&&!zm.has(W.type)&&A(W,N.getOwnLayerSourceCache(W),O,$)}}else if("layerId"in O.target){const{layerId:D}=O.target,F=this.getLayer(D);if(!F||zm.has(F.type))continue;A(F,this.getLayerSourceCache(F),O)}const S=this._queryRenderedFeatures(n,x,m);return this._flattenAndSortRenderedFeatures(S)}_queryRenderedFeatures(n,u,m){const x=[],A=!!this.map._showQueryGeometry,S=ti.createFromScreenPoints(n,m);for(const O in u){const D=_c(S,u[O],this._availableImages,m,A,this.getActualScope());Object.keys(D).length&&x.push(D)}if(this.placement)for(const O in u){if(!u[O].sourceCache._onlySymbols)continue;const D=ov(S.screenGeometry,u[O],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(D).length&&x.push(D)}return x}querySourceFeatures(n,u){const m=u&&u.filter;m&&this._validate(ie,"querySourceFeatures.filter",m,null,u);let x=[];const A=this.getOwnSourceCaches(n);for(const S of A)x=x.concat(t_(S,u));return x}addSourceType(n,u,m){return Yo.getSourceType(n)?m(new Error(`A source type called "${n}" already exists.`)):(Yo.setSourceType(n,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:u.workerSourceURL},m):m(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,u,m={}){this._checkLoaded();const x=this.light.getLight();let A=!1;for(const O in n)if(!a.by(n[O],x[O])){A=!0;break}if(!A)return;const S=this._getTransitionParameters();this.light.setLight(n,u,m),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,u=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),u===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let m=n;const x=!("source"in n)||n.source==null;if(u===1){if(this.disableElevatedTerrain)return;if("source"in m&&typeof m.source=="object"){const O="terrain-dem-src";this.addSource(O,m.source),m=a.dp(m),m=Object.assign(m,{source:O})}const A=Object.assign({},m),S={};if(this.terrain&&x){A.source=this.terrain.get().source;const O=this.terrain?this.getFragmentStyle(this.terrain.scope):null;O&&(S.style=O.serialize())}if(this._validate(Or,"terrain",A,S))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&u!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,u),this.fire(new a.z("data",{dataType:"style"}))}else{const A=this.terrain,S=A.get();for(const O of Object.keys(a.a6.terrain))!m.hasOwnProperty(O)&&a.a6.terrain[O].default&&(m[O]=a.a6.terrain[O].default);for(const O in n)if(!a.by(n[O],S[O])){A.set(n,this.options),this.stylesheet.terrain=n;const D=this._getTransitionParameters({duration:0});A.updateTransitions(D),this.fire(new a.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const u=this.fog=new br(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}_createSnow(n){const u=this.snow=new Zn(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}_createRain(n){const u=this.rain=new qn(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog;if(!a.by(u.get(),n)){u.set(n,this.options),this.stylesheet.fog=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const u=this.snow;if(!a.by(u.get(),n)){u.set(n,this.options),this.stylesheet.snow=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const u=this.rain;if(!a.by(u.get(),n)){u.set(n,this.options),this.stylesheet.rain=u.get();const m=this._getTransitionParameters({duration:0});u.updateTransitions(m)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},u=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!u)return this._styleColorTheme.lut=null,void n();const m=this._evaluateColorThemeData(u);this._loadColorTheme(m).then(()=>{this.fire(new a.z("colorthemeset")),n()}).catch(x=>{a.w(`Couldn't set color theme: ${x}`)})}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&a.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,u){const m=this.getFragmentStyle(n);m&&(m._styleColorTheme.colorThemeOverride=u,m._reloadColorTheme())}_getTransitionParameters(n){return{now:a.o.now(),transition:Object.assign(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],u=[];for(const m of this._mergedOrder)this.isLayerDraped(this._mergedLayers[m])?n.push(m):u.push(m);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...u)}_createTerrain(n,u){const m=this.terrain=new vt(n,u,this.scope,this.options,this.map.getWorldview());u===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});m.updateTransitions(x)}_force3DLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="fill-extrusion"&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const u=this._layers[n];u.type==="symbol"&&this._updateLayer(u)}}_validate(n,u,m,x,A={}){if(A&&A.validate===!1)return!1;const S=Object.assign({},this.serialize());return xc(this,n.call(Xa,Object.assign({key:u,style:S,value:m,styleSpec:a.a6},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.dy.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.indoorManager.destroy(),this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(n){const u=this.getSourceCaches(n);for(const m of u)m.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}clearLayers(){for(const n in this._mergedLayers){const u=this._mergedLayers[n];u._clear&&u._clear()}}reloadSource(n){const u=this.getSourceCaches(n);for(const m of u)m.resume(),m.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(n=>{n.modelManager.reloadModels(n.scope)})}updateSources(n){let u;this.directionalLight&&(u=Pm(this.directionalLight));const m=new Set,x=new Set;for(const A in this._mergedLayers){const S=this._mergedLayers[A];S.type==="building"&&m.add(S.source),S.hasElevation()&&!x.has(S.source)&&x.add(S.source)}for(const A in this._mergedSourceCaches){const S=this._mergedSourceCaches[A],O=x.has(S._source.id);m.has(S._source.id)&&(S._source.reparseOverscaled=!1),S.update(n,void 0,void 0,u,O)}}_generateCollisionBoxes(){for(const n in this._sourceCaches){const u=this._sourceCaches[n];u.resume(),u.reload()}}_handleLayerOrderChange(){this._requestFullLabelPlacement(),this.fire(new a.z("neworder"))}_requestFullLabelPlacement(){this.pauseablePlacement||(this.pauseablePlacement=new c_),this.pauseablePlacement.requestFullPlacement()}_setLabelPlacementStale(){this.placement&&this.placement.setStale()}_updatePlacement(n,u,m,x,A){this.pauseablePlacement||(this.pauseablePlacement=new c_);let S=!1,O=!1;const D={},F={};for(const te of this._mergedOrder){const ae=this._mergedLayers[te];if(ae.type!=="symbol")continue;const le=a.B(ae.source,ae.scope);let be=D[le];if(!be){const ye=this.getLayerSourceCache(ae);if(!ye)continue;const Re=ye.getRenderableIds(!0).map(Ce=>ye.getTileByID(Ce));F[le]=Re.slice(),be=D[le]=Re.sort((Ce,De)=>De.tileID.overscaledZ-Ce.tileID.overscaledZ||(Ce.tileID.isLessThan(De.tileID)?-1:1))}const xe=this.crossTileSymbolIndex.addLayer(ae,be,n.center.lng,n.projection);S=S||xe}this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder);const N=!!(this.placement&&!n.equals(this.placement.transform)),Z=!!(this.placement&&(this.placement.lastReplacementSourceUpdateTime!==0&&!A||this.placement.lastReplacementSourceUpdateTime!==A.updateTime)),$=N||Z||S,W=($||this.pauseablePlacement.isStale())&&m===0,ne=this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.o.now(),n.zoom)&&m!==0;if((this.pauseablePlacement.isFullPlacementRequested()||!this.pauseablePlacement.placement||W||ne)&&(this.pauseablePlacement=this.pauseablePlacement.startNewPlacement(n,this._mergedOrder,u,m,x,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null,this._buildingIndex)),this.pauseablePlacement.isDone()?$&&m!==0&&this.pauseablePlacement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,D,F,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.o.now()),O=!0),S&&this.pauseablePlacement.setStale()),O||S){this._buildingIndex.onNewFrame(n.zoom);for(let te=0;te<this._mergedOrder.length;te++){const ae=this._mergedLayers[this._mergedOrder[te]];if(ae.type!=="symbol"||ae.visibility==="none")continue;const le=this.isLayerClipped(ae);this.placement.updateLayerOpacities(ae,D[a.B(ae.source,ae.scope)],te,le?A:null)}}return!this.pauseablePlacement.isDone()||this.placement.isStale()||this.placement.hasTransitions(a.o.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,u){this._checkLoaded();const m=this.stylesheet.imports=this.stylesheet.imports||[];if(m.findIndex(({id:A})=>A===n.id)!==-1)return void this.fire(new a.y(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!u)return m.push(n),this._loadImports([n],!0);const x=m.findIndex(({id:A})=>A===u);return x===-1&&this.fire(new a.y(new Error(`Import with id "${u}" does not exist on this map.`))),this.stylesheet.imports=m.slice(0,x).concat(n).concat(m.slice(x)),this._loadImports([n],!0,u)}updateImport(n,u){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(n);return x===-1?this:typeof u=="string"?(this.setImportUrl(n,u),this):(u.url&&u.url!==m[x].url&&this.setImportUrl(n,u.url),a.by(u.config,m[x].config)||this.setImportConfig(n,u.config,u.data.schema),a.by(u.data,m[x].data)||this.setImportData(n,u.data),this)}moveImport(n,u){this._checkLoaded();let m=this.stylesheet.imports||[];const x=this.getImportIndex(n);if(x===-1)return this;const A=this.getImportIndex(u);if(A===-1)return this;const S=m[x],O=this.fragments[x];return m=m.filter(({id:D})=>D!==n),this.fragments=this.fragments.filter(({id:D})=>D!==n),this.stylesheet.imports=m.slice(0,A).concat(S).concat(m.slice(A)),this.fragments=this.fragments.slice(0,A).concat(O).concat(this.fragments.slice(A)),this.mergeLayers(),this}setImportUrl(n,u){this._checkLoaded();const m=this.stylesheet.imports||[],x=this.getImportIndex(n);if(x===-1)return this;m[x].url=u;const A=this.fragments[x];return A.style=this._createFragmentStyle(m[x]),A.style.on("style.import.load",()=>this.mergeAll()),A.style.loadURL(u),this}setImportData(n,u){this._checkLoaded();const m=this.getImportIndex(n),x=this.stylesheet.imports||[];return m===-1?this:u?(this.fragments[m].style.setState(u),this._reloadImports(),this):(delete x[m].data,this.setImportUrl(n,x[m].url))}setImportConfig(n,u,m){this._checkLoaded();const x=this.getImportIndex(n),A=this.stylesheet.imports||[];if(x===-1)return this;u?A[x].config=u:delete A[x].config;const S=this.fragments[x];m&&S.style.stylesheet&&(S.style.stylesheet.schema=m);const O=S.style.stylesheet&&S.style.stylesheet.schema;return S.config=u,S.style.updateConfig(u,O),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const u=this.stylesheet.imports||[],m=this.getImportIndex(n);m!==-1&&(u.splice(m,1),this.fragments[m].style._remove(),this.fragments.splice(m,1),this._reloadImports())}getImportIndex(n){const u=(this.stylesheet.imports||[]).findIndex(m=>m.id===n);return u===-1&&this.fire(new a.y(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),u}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const u in this._mergedOtherSourceCaches){const m=this._mergedOtherSourceCaches[u];m&&n.push(m.getSource())}return n}getSource(n,u){const m=this.getSourceCache(n,u);return m&&m.getSource()}getLayerSource(n){const u=this.getLayerSourceCache(n);return u&&u.getSource()}getSourceCache(n,u){const m=a.B(n,u);return this._mergedOtherSourceCaches[m]}getLayerSourceCache(n){const u=a.B(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[u]:this._mergedOtherSourceCaches[u]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const u=[];return this._mergedOtherSourceCaches[n]&&u.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&u.push(this._mergedSymbolSourceCaches[n]),u}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const u in n){const m=n[u];m==="reload"?this.reloadSource(u):m==="clear"&&this.clearSource(u)}}updateLayers(n){const u=this._changes.getUpdatedPaintProperties();for(const m of u){const x=this.getLayer(m);x&&x.updateTransitions(n)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(n){this.stylesheet.glyphs=n,this.glyphManager.setURL(n)}getImages(n,u,m){this.imageManager.getImages(u.images,u.scope,m),this._updateTilesForChangedImages();const x=S=>{if(S){const O=u.images.map(D=>a.I.toString(D));S.setDependencies(u.tileID.key,u.type,O)}},A=a.B(u.source,u.scope);x(this._mergedOtherSourceCaches[A]),x(this._mergedSymbolSourceCaches[A]),u.images.some(S=>S.iconsetId)&&this.fire(new a.z("data",{dataType:"style"}))}rasterizeImages(n,u,m){this.imageManager.rasterizeImages(u,m)}getGlyphs(n,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(n,u,m){return a.dz(u,m)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const u=[];return this._otherSourceCaches[n]&&u.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&u.push(this._symbolSourceCaches[n]),u}_isSourceCacheLoaded(n){const u=this.getOwnSourceCaches(n);return u.length===0?(this.fire(new a.y(new Error(`There is no source with ID '${n}'`))),!1):u.every(m=>m.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,u){if(!this._clipLayerPresent&&n.type!=="fill-extrusion"&&n.type!=="building")return!1;const m=n.type==="fill-extrusion"&&(n.sourceLayer==="building"||n.sourceLayer==="procedural_buildings"),x=n.type==="building";if(n.is3D(!!this.terrain)){if(m||x||u&&u.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Yo.getSourceType=function(p){return zl[p]},Yo.setSourceType=function(p,n){zl[p]=n},Yo.registerForPluginStateChange=a.dA;var Qs=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,qd=`
#ifdef DUAL_SOURCE_BLENDING
layout(location=0,index=0) out vec4 glFragColor;layout(location=0,index=1) out vec4 glFragColorSrc1;
#else
layout(location=0) out vec4 glFragColor;
#endif
#ifdef USE_MRT1
layout(location=1) out vec4 out_Target1;
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,zo=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifndef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_id) attrib
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_id) attrib
#define DECLARE_MATERIAL_TABLE_INFO
#endif`,Fl="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ap=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;
#ifdef CLIP_ZERO_TO_ONE
coord.z=-1.0+2.0*coord.z; 
#endif
highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif`,$h=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ko=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,qh=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Gt=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Bm=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif`,Hd=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const bc=/#include\s+"([^"]+)"/g,wc=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,hs=/\b[A-Za-z_][A-Za-z0-9_]*\b/g,nu=new Set(["ifdef","ifndef","elif","if","defined"]),ds=new Set;ao(Qs,ds),ao(zo,ds),ao(qd,ds);const iu={"_prelude_fog.vertex.glsl":$h,"_prelude_terrain.vertex.glsl":ap,"_prelude_shadow.vertex.glsl":Bm,"_prelude_material_table.vertex.glsl":`#ifdef HAS_SHADER_STORAGE_BLOCK_material_buffer
#define MATERIAL_TABLE_DEBUG 0
uniform int u_material_offset;uniform int u_vertex_offset;layout(std140,binding=0)readonly buffer material_buffer{uvec4 material_data[];};struct MaterialInfo{uint dataOffset;
#if MATERIAL_TABLE_DEBUG
vec4 colorDebug;
#endif
};uint read_buf_no_offset(uint iDword) {return material_data[iDword/4u][iDword % 4u];}uint read_buf(uint iDword) {iDword+=uint(u_material_offset/4);return read_buf_no_offset(iDword);}float read_buf_float(uint iDword){return uintBitsToFloat(read_buf(iDword));}uint read_buf_uint8(uint iDword,uint iUint8){uint dwordOffset=iDword+(iUint8/4u);uint byteOffset=iUint8 & 3u;uint bitOffset=8u*byteOffset;uint mask=0xffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint read_buf_uint16(uint iDword,uint iUint16){uint dwordOffset=iDword+(iUint16 >> 1u);uint bitOffset=(iUint16 & 1u)*16u;uint mask=0xffffu << bitOffset;uint dwordVal=read_buf(dwordOffset);return (dwordVal & mask) >> bitOffset;}uint nrDwordsForVertexIdEntries(uint nrMaterialLookupEntries) {return nrMaterialLookupEntries;}uint nrDwordsForMaterialIdEntries(uint nrMaterialLookupEntries) {return (nrMaterialLookupEntries*2u+3u)/4u;}uint findRangeBinarySearch(uint vertexId,uint numRanges,uint dwordOffset) {uint left=0u;uint right=numRanges-1u;for (uint i=0u; i < 16u; i++) { 
if (left > right) {break;}uint mid=(left+right)/2u;uint start=read_buf(dwordOffset+mid);uint nextStart=(mid+1u < numRanges) ? read_buf(dwordOffset+mid+1u) : 0xffffffffu;if (vertexId >=start && vertexId < nextStart) {return mid;} else if (vertexId < start) {if (mid==0u) {break;}right=mid-1u;} else {left=mid+1u;}}return 0u; 
}uint readVertexId(uint dwordOffset,uint iMaterialLookupEntry) {return read_buf(dwordOffset+iMaterialLookupEntry);}uint findRange(uint vertexId,uint numRanges,uint dwordOffset) {uint iRange;if(numRanges <=64u){uint vertexBegin;for(iRange=0u; iRange < numRanges;++iRange) {vertexBegin=readVertexId(dwordOffset,iRange);if(vertexBegin > vertexId) {break;}}iRange=iRange==0u? 0u : iRange-1u;} else { 
iRange=findRangeBinarySearch(vertexId,numRanges,dwordOffset);}return iRange;}MaterialInfo read_material_info(uint vertex_id) {MaterialInfo info;
#if MATERIAL_TABLE_DEBUG
const vec4 red=vec4(1.0,0.0,0.0,1.0);const vec4 orange=vec4(1.0,0.5,0.0,1.0);const vec4 yellow=vec4(1.0,1.0,0.0,1.0);const vec4 green=vec4(0.0,1.0,0.0,1.0);const vec4 indigo=vec4(0.294,0.0,0.510,1.0);const vec4 blue=vec4(0.0,0.0,1.0,1.0);const vec4 purple=vec4(0.5,0.0,0.5,1.0);const vec4 pink=vec4(1.0,0.0,1.0,1.0);info.colorDebug=green;
#endif
uint offset=0u;
#if MATERIAL_TABLE_DEBUG
bool keepFinding=true;uint magic=read_buf(offset);if(magic !=0xCAFEBABEu) {info.colorDebug=red;keepFinding=false;return info;}
#endif
offset++;
#if MATERIAL_TABLE_DEBUG
uint nrMaterials=read_buf(offset);uint nrVertices=read_buf(offset+1u);if(keepFinding && vertex_id >=nrVertices) {info.colorDebug=red;keepFinding=false;}
#endif
offset+=2u;uint nrMaterialLookupEntries=read_buf(offset++);uint perMaterialEntrySizeDwords=read_buf(offset++);
#if MATERIAL_TABLE_DEBUG
if(keepFinding && perMaterialEntrySizeDwords !=1u) {info.colorDebug=red;keepFinding=false;}
#endif
uint iMaterialLookup=findRange(vertex_id,nrMaterialLookupEntries,offset);
#if MATERIAL_TABLE_DEBUG
if(keepFinding)
{uint vertexBeginCheck=readVertexId(offset,iMaterialLookup);if(vertexBeginCheck > vertex_id) {info.colorDebug=red;keepFinding=false;}if(iMaterialLookup < nrMaterialLookupEntries-1u) {uint vertexEndCheck=readVertexId(offset,iMaterialLookup+1u);if(vertexEndCheck <=vertex_id) {info.colorDebug=red;keepFinding=false;}}}
#endif
offset+=nrDwordsForVertexIdEntries(nrMaterialLookupEntries);uint materialId=iMaterialLookup;
#if MATERIAL_TABLE_DEBUG
if(keepFinding) {if(materialId >=nrMaterialLookupEntries) {info.colorDebug=red;}}
#endif
info.dataOffset=offset+materialId*perMaterialEntrySizeDwords;return info;}uint get_data_location(const MaterialInfo matInfo,uint attribOffsetBytes)
{uint attribFieldOffsetDwords=attribOffsetBytes/4u;return matInfo.dataOffset+attribFieldOffsetDwords;}vec4 read_material_vec4(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec4(read_buf_float(loc),read_buf_float(loc+1u),read_buf_float(loc+2u),read_buf_float(loc+3u));}vec2 read_material_vec2(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return vec2(read_buf_float(loc),read_buf_float(loc+1u));}float read_material_float(const MaterialInfo matInfo,uint attribOffsetBytes){uint loc=get_data_location(matInfo,attribOffsetBytes);return read_buf_float(loc);}
#define GET_ATTRIBUTE_float(attrib,matInfo,attrib_offset) read_material_float(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec4(attrib,matInfo,attrib_offset) read_material_vec4(matInfo,attrib_offset)
#define GET_ATTRIBUTE_vec2(attrib,matInfo,attrib_offset) read_material_vec2(matInfo,attrib_offset)
#define DECLARE_MATERIAL_TABLE_INFO MaterialInfo materialInfo=read_material_info(uint(gl_VertexID));
#define DECLARE_MATERIAL_TABLE_INFO_DEBUG(dbgColor) MaterialInfo materialInfo=read_material_info(uint(gl_VertexID)); dbgColor=materialInfo.colorDebug;
#endif`,"_prelude_fog.fragment.glsl":Ko,"_prelude_shadow.fragment.glsl":Hd,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif`,"_prelude_raster_array.glsl":qh,"_prelude_raster_particle.glsl":Gt},Hh={};sn("",ap),sn(Ko,$h),sn(Hd,Bm),sn(qh,""),sn(Gt,"");const Zu=sn(qd,zo),Xd=Qs,mv=[`
#if defined(GL_EXT_blend_func_extended) && defined(DUAL_SOURCE_BLENDING)
#extension GL_EXT_blend_func_extended : require
#endif`,"precision mediump float;",Xd,Zu.fragmentSource].join(`
`),km=["precision highp float;",Xd,Zu.vertexSource].join(`
`);var Fm={background:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;uniform mediump float u_emissive_strength;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;uniform mediump float u_emissive_strength;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
#ifdef FLOOD_LIGHT
in highp float v_flood_radius;in float v_has_flood_light;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;uniform vec3 u_flood_light_color;uniform float u_flood_light_intensity;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
#else
shadowed_lighting_factor=dot(xy_flipped_normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=linearTosRGB(color.rgb);
#ifdef FLOOD_LIGHT
float flood_radiance=(1.0-min(v_pos.z/v_flood_radius,1.0))*u_flood_light_intensity*v_has_flood_light;color.rgb=mix(color.rgb,u_flood_light_color,flood_radiance);
#endif
color.rgb=mix(color.rgb,linearTosRGB(base_color.rgb),emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in float a_flood_light_wall_radius_1i16;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#ifdef FLOOD_LIGHT
out highp float v_flood_radius;out float v_has_flood_light;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;const float FLOOD_LIGHT_MAX_RADIUS_METER=2048.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
#ifdef FLOOD_LIGHT
v_flood_radius=(a_flood_light_wall_radius_1i16/MAX_INT_16*FLOOD_LIGHT_MAX_RADIUS_METER);v_has_flood_light=step(0.0,v_flood_radius);
#endif
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;float depth_offset=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);float height=a_centroid_3.z;depth_offset=min(1000.0,height)*0.0000002;}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);gl_Position.z-=depth_offset*gl_Position.w;}`),buildingBloom:sn(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
#ifdef RENDER_CUTOFF
opacity*=v_cutoff_opacity;
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:sn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:sn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:sn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:sn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:sn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:sn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:sn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:sn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:sn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:sn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_material_table.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {DECLARE_MATERIAL_TABLE_INFO
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:sn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:sn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
#ifdef USE_MRT1
out_Target1=vec4(1.0-texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size)).a,0.0,0.0,0.0);
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:sn(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform highp vec2 u_trim_gradient_mix_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef VARIABLE_LINE_WIDTH
in float stub_side;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float side_z_offset
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
#pragma mapbox: define lowp float emissive_strength
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float side_z_offset
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
#pragma mapbox: initialize lowp float emissive_strength
float dist=length(v_normal)*v_width2.s;
#ifdef VARIABLE_LINE_WIDTH
blur=mix(blur,0.0,stub_side);
#endif
float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef VARIABLE_LINE_WIDTH
alpha=mix(alpha,1.0,stub_side);
#endif
alpha=side_z_offset > 0.0 ? 1.0-alpha : alpha;
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);highp float gradient_trim_color_mix_factor=0.0;
#ifdef RENDER_LINE_GRADIENT
gradient_trim_color_mix_factor=smoothstep(u_trim_gradient_mix_range.x,u_trim_gradient_mix_range.y,line_progress);
#endif
highp vec4 trim_color=mix(u_trim_color,out_color,gradient_trim_color_mix_factor);out_color=mix(u_trim_gradient_mix_range.x < 1.0 ? color : out_color,trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
#ifndef VARIABLE_LINE_WIDTH
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef DUAL_SOURCE_BLENDING
glFragColorSrc1=vec4(vec3(0.0),emissive_strength);
#else
#ifdef USE_MRT1
out_Target1=vec4(emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef VARIABLE_LINE_WIDTH
out float stub_side;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float side_z_offset
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float side_z_offset
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
#pragma mapbox: initialize lowp float emissive_strength
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;offset=-1.0*offset*u_width_scale;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
bool left=normal.y==1.0;float left_width=a_z_offset_width.y;float right_width=a_z_offset_width.z;halfwidth=(u_width_scale*(left ? left_width : right_width))/2.0;a_z_offset+=left ? side_z_offset : 0.0;v_normal=side_z_offset > 0.0 && left ? vec2(0.0) : v_normal;offset=border_width > 0.0 ? (left_width+right_width)*u_width_scale*0.5 : offset;halfwidth=border_width > 0.0 ? border_width*u_width_scale*0.5 : halfwidth;bool zero_right_width=border_width==0.0 && right_width==0.0;stub_side=zero_right_width ?-normal.y : 0.0;v_normal=!left && zero_right_width ? vec2(0.0) : v_normal;ANTIALIASING=!left && zero_right_width ? 0.0 : ANTIALIASING;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef DUAL_SOURCE_BLENDING
glFragColorSrc1=vec4(vec3(0.0),emissive_strength);
#else
#ifdef USE_MRT1
out_Target1=vec4(emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize lowp float emissive_strength
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
#ifdef USE_MRT1
out_Target1=vec4(u_emissive_strength*glFragColor.a,0.0,0.0,glFragColor.a);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),1.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:sn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:sn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:sn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:sn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#define USING_APPEARANCE 1.0
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float a_size_max= floor(a_size[1]*0.5);float a_apperance=a_size[1]-2.0*a_size_max;vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (a_apperance==USING_APPEARANCE) {size=a_size_max/128.0;} else if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size_max,u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
#ifdef Z_TEST_OCCLUSION
out_fade_opacity*=occlusion_opacity;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
uniform sampler2D u_image1;uniform float u_emissive_texture_available;
#endif
in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
float emissive_strength=u_emissive_texture_available > 0.5 ? texture(u_image1,v_pos0).r : image_color.a;vec3 unlit_base=image_color.rgb*(1.0-emissive_strength);vec3 emissive_base=image_color.rgb*emissive_strength;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
float emissive_strength=u_emissive_texture_available > 0.5 ? texture(u_image1,v_pos0).r : image_color.a;color.rgb=mix(color.rgb,image_color.rgb,emissive_strength);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:sn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:sn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Fl),skyboxGradient:sn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Fl),skyboxCapture:sn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
uniform sampler2D u_image1;uniform float u_emissive_texture_available;
#endif
uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
float emissive_strength=u_emissive_texture_available > 0.5 ? texture(u_image1,v_pos0).r : raster.a;raster=apply_lighting_with_emission_ground(raster,emissive_strength);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
float emissive_strength=u_emissive_texture_available > 0.5 ? texture(u_image1,v_pos0).r : color.a;color=apply_lighting_with_emission_ground(color,emissive_strength);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:sn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:sn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;
#ifdef DITHERED_DISCARD
uniform float u_dithered_discard_threshold;
#endif
uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef FLIP_Y
coord.y=1.0-coord.y;
#endif
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef DITHERED_DISCARD
if (abs(u_dithered_discard_threshold) < 1.0) {float ditherValue=fract(52.9829189*fract(0.06711056*gl_FragCoord.x+0.00583715*gl_FragCoord.y));float compareValue=mix(1.0-ditherValue,ditherValue,step(0.0,u_dithered_discard_threshold));if (abs(u_dithered_discard_threshold) < compareValue) {discard;}}
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#ifdef CLIP_ZERO_TO_ONE
v_depth=-1.0+2.0*v_depth; 
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:sn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:sn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:sn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:sn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:sn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:sn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function ao(p,n){const u=p.split(`
`);for(let m of u){if(m=m.trimStart(),m[0]!=="#"||!m.includes("if")||m.startsWith("#endif"))continue;const x=m.match(hs);if(x)for(const A of x)nu.has(A)||n.add(A)}}function sn(p,n){const u=new Set,m=[],x=[];p=p.replace(bc,(S,O)=>(x.push(O),"")),n=n.replace(bc,(S,O)=>(m.push(O),""));let A=new Set(ds);ao(p,A),ao(n,A);for(const S of[...m,...x])Hh[S]||(Hh[S]=new Set,ao(iu[S],Hh[S])),A=new Set([...A,...Hh[S]]);return{fragmentSource:p=p.replace(wc,(S,O,D,F,N)=>(u.add(N),O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
in ${D} ${F} ${N};
#else
uniform ${D} ${F} u_${N};
#endif
`:O==="initialize"?`
#ifdef HAS_UNIFORM_u_${N}
    ${D} ${F} ${N} = u_${N};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    in ${D} ${F} ${N};
#endif
`:O==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(wc,(S,O,D,F,N)=>{const Z=`MATERIAL_ATTRIBUTE_OFFSET_${N}`,$=F==="float"?"vec2":F,W=`GET_ATTRIBUTE_${$}(a_${N}, materialInfo, ${Z})`,ne=N.match(/color/)?"color":$;return O==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${N}
in ${D} ${F} a_${N};
#endif
`:u.has(N)?O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
    #if !defined(${Z})
        in ${D} ${$} a_${N};
    #endif
out ${D} ${F} ${N};
#else
uniform ${D} ${F} u_${N};
#endif
`:O==="initialize"?ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${D} ${F} ${N} = u_${N};
#endif
`:`
#if !defined(HAS_UNIFORM_u_${N})
    #ifdef ${Z}
        ${N} = unpack_mix_${ne}(${W}, u_${N}_t);
    #else
        ${N} = unpack_mix_${ne}(a_${N}, u_${N}_t);
    #endif
#else
    ${D} ${F} ${N} = u_${N};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    in ${D} ${F} a_${N};
    out ${D} ${F} ${N};
#endif
`:O==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    ${N} = a_${N};
#endif
`:void 0:O==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
    #if !defined(${Z})
        in ${D} ${$} a_${N};
    #endif
#else
uniform ${D} ${F} u_${N};
#endif
`:O==="define-instanced"?ne==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${N}0;
in vec4 a_${N}1;
in vec4 a_${N}2;
in vec4 a_${N}3;
#else
uniform ${D} ${F} u_${N};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${D} ${$} a_${N};
#else
uniform ${D} ${F} u_${N};
#endif
`:O==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${N}
    ${D} ${F} ${N} = a_${N};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    #ifdef ${Z}
        ${D} ${F} ${N} = ${W};
    #else
        ${D} ${F} ${N} = a_${N};
    #endif
#else
    ${D} ${F} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    #ifdef ${Z}
        ${D} ${F} ${N} = unpack_mix_${ne}(${W}, u_${N}_t);
    #else
        ${D} ${F} ${N} = unpack_mix_${ne}(a_${N}, u_${N}_t);
    #endif
#else
    ${D} ${F} ${N} = u_${N};
#endif
`}),usedDefines:A,vertexIncludes:m,fragmentIncludes:x}}class Zd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,u,m,x,A,S,O,D){this.context=n;let F=this.boundPaintVertexBuffers.length!==x.length;for(let Z=0;!F&&Z<x.length;Z++)this.boundPaintVertexBuffers[Z]!==x[Z]&&(F=!0);let N=this.boundDynamicVertexBuffers.length!==O.length;for(let Z=0;!N&&Z<O.length;Z++)this.boundDynamicVertexBuffers[Z]!==O[Z]&&(N=!0);if(!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==m||F||N||this.boundIndexBuffer!==A||this.boundVertexOffset!==S)this.freshBind(u,m,x,A,S,O,D);else{n.bindVertexArrayOES.set(this.vao);for(const Z of O)Z&&(Z.bind(),D&&Z.instanceCount&&Z.setVertexAttribDivisor(n.gl,u,D));A&&A.dynamicDraw&&A.bind()}}freshBind(n,u,m,x,A,S,O){const D=this.context,F=D.gl;this.vao&&this.destroy(),this.vao=D.gl.createVertexArray(),D.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=x,this.boundVertexOffset=A,this.boundDynamicVertexBuffers=S,u.enableAttributes(F,n),u.bind(),u.setVertexAttribPointers(F,n,A);for(const N of m)N.enableAttributes(F,n),N.bind(),N.setVertexAttribPointers(F,n,A);for(const N of S)N&&(N.enableAttributes(F,n),N.bind(),N.setVertexAttribPointers(F,n,A),O&&N.instanceCount&&N.setVertexAttribDivisor(F,n,O));x&&x.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Nm(p,n){const u=Math.pow(2,n.canonical.z),m=n.canonical.y;return[new a.ae(0,m/u).toLngLat().lat,new a.ae(0,(m+1)/u).toLngLat().lat]}function op(p,n,u,m,x,A,S){const O=p.context,D=O.gl,F=u.hillshadeFBO;if(!F)return;p.prepareDrawTile();const N=p.isTileAffectedByFog(n),Z=[];p.terrain&&p.terrain.renderingToTexture&&p.emissiveMode==="mrt-fallback"&&Z.push("USE_MRT1");const $=p.getOrCreateProgram("hillshade",{overrideFog:N,defines:Z});O.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,F.colorAttachment0.get());const W=((le,be,xe,ye)=>{const Re=xe.paint.get("hillshade-shadow-color"),Ce=xe.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",De=xe.paint.get("hillshade-highlight-color"),Me=xe.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Te=xe.paint.get("hillshade-accent-color"),Ne=xe.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",Ve=xe.paint.get("hillshade-emissive-strength");let He=a.an(xe.paint.get("hillshade-illumination-direction"));if(xe.paint.get("hillshade-illumination-anchor")==="viewport")He-=le.transform.angle;else if(le.style&&le.style.enable3dLights()&&le.style.directionalLight){const We=le.style.directionalLight.properties.get("direction"),ut=a.d4(We.x,We.y,We.z);He=a.an(ut[1])}const Qe=!le.options.moving;return{u_matrix:ye||le.transform.calculateProjMatrix(be.tileID.toUnwrapped(),Qe),u_image:0,u_latrange:Nm(0,be.tileID),u_light:[xe.paint.get("hillshade-exaggeration"),He],u_shadow:Re.toPremultipliedRenderColor(Ce?null:xe.lut),u_highlight:De.toPremultipliedRenderColor(Me?null:xe.lut),u_emissive_strength:Ve,u_accent:Te.toPremultipliedRenderColor(Ne?null:xe.lut)}})(p,u,m,p.terrain?n.projMatrix:null);p.uploadCommonUniforms(O,$,n.toUnwrapped());const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:te,tileBoundsSegments:ae}=p.getTileBoundsBuffers(u);$.draw(p,D.TRIANGLES,x,A,S,Cr.disabled,W,m.id,ne,te,ae)}function Ds(p,n,u){if(!n.needsDEMTextureUpload)return;const m=p.context,x=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||p.getTileTexture(u.stride);const A=u.getPixels();n.demTexture?n.demTexture.update(A,{premultiply:!1}):n.demTexture=new a.T(m,A,x.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function yl(p,n,u){const m=p.context,x=m.gl;if(!n.dem)return;const A=n.dem;if(m.activeTexture.set(x.TEXTURE1),Ds(p,n,A),!n.demTexture)return;n.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const S=A.dim;m.activeTexture.set(x.TEXTURE0);let O=n.hillshadeFBO;if(!O){const $=new a.T(m,{width:S,height:S,data:null},x.RGBA8);$.bind(x.LINEAR,x.CLAMP_TO_EDGE),O=n.hillshadeFBO=m.createFramebuffer(S,S,1,"renderbuffer"),O.colorAttachment0.set($.texture)}m.bindFramebuffer.set(O.framebuffer),m.viewport.set([0,0,S,S]);const{tileBoundsBuffer:D,tileBoundsIndexBuffer:F,tileBoundsSegments:N}=p.getMercatorTileBoundsBuffers(),Z=[];p.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),p.terrain&&p.terrain.renderingToTexture&&p.emissiveMode==="mrt-fallback"&&Z.push("USE_MRT1"),p.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(p,x.TRIANGLES,mr.disabled,Rr.disabled,zr.unblended,Cr.disabled,(($,W)=>{const ne=W.stride,te=a.bC();return a.ce(te,0,a.al,-a.al,0,0,1),a.br(te,te,[0,-a.al,0]),{u_matrix:te,u_image:1,u_dimension:[ne,ne],u_zoom:$.overscaledZ}})(n.tileID,A),u.id,D,F,N),n.needsHillshadePrepare=!1}class $n{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ac extends $n{getDefault(){return a.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Nl extends $n{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class jl extends $n{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class sp extends $n{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class lp extends $n{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class au extends $n{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Xh extends $n{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Fa extends $n{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Fi extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class ci extends $n{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Tc extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Js extends $n{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Wu extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class Ul extends $n{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class cp extends $n{getDefault(){return a.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class jm extends $n{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class ou extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class Vl extends $n{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Um extends $n{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let Wd=class extends $n{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class Vm extends $n{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class vl extends $n{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Sc extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Yu extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class su extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class f_ extends $n{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class up extends $n{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Ku extends $n{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class Yd extends $n{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class lu extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class bo extends $n{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Zh extends $n{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class hp extends Zh{constructor(n,u,m=0){super(n,u),this.attachmentPoint=n.gl.COLOR_ATTACHMENT0+m}setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachmentPoint,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Kd extends Zh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class dp extends Zh{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,this.attachment(),u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class gv extends Kd{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Si=(p,n,u,m)=>({u_matrix:p,u_image0:0,u_image1:1,u_skirt_height:n,u_ground_shadow_factor:u,u_emissive_texture_available:m}),Qd=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:u,u_zoom_transition:x,u_merc_center:A,u_image0:0,u_image1:1,u_frustum_tl:S,u_frustum_tr:O,u_frustum_br:D,u_frustum_bl:F,u_globe_pos:N,u_globe_radius:Z,u_viewport:$,u_grid_matrix:ae?Float32Array.from(ae):new Float32Array(9),u_skirt_height:W,u_far_z_cutoff:ne,u_emissive_texture_available:te});function cu(p,n){return p!=null&&n!=null&&!(!p.hasData()||!n.hasData())&&p.demTexture!=null&&n.demTexture!=null&&p.tileID.key!==n.tileID.key}const el=new class{constructor(){this.operations={}}newMorphing(p,n,u,m,x){if(p in this.operations){const A=this.operations[p];A.to.tileID.key!==u.tileID.key&&(A.queued=u)}else this.operations[p]={startTime:m,phase:0,duration:x,from:n,to:u,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const n=this.operations[p];return{from:n.from,to:n.to,phase:n.phase}}update(p){for(const n in this.operations){const u=this.operations[n];for(u.phase=(p-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,p)){delete this.operations[n];break}}}_nextOp(p,n){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=n,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Jd={0:null,1:"TERRAIN_VERTEX_MORPHING"};function uu(p,n,u){if(n===0)return 0;const m=n<1&&u===514?.25/n:1;return 6*Math.pow(1.5,22-p)*Math.max(n,1)*m}function Qu(p,n){const u=1<<p.z;return!n&&(p.x===0||p.x===u-1)||p.y===0||p.y===u-1}function ef(p,n){if(!p.style||!p.style.enable3dLights())return;const u=p.context,m=u.gl;u.activeTexture.set(m.TEXTURE1),n?n.bind(m.LINEAR,m.CLAMP_TO_EDGE):p.emptyTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}const tf=p=>({u_matrix:p});function fp(p,n,u,m,x){if(x>0){const A=a.o.now(),S=(A-p.timeAdded)/x,O=n?(A-n.timeAdded)/x:-1,D=u.getSource(),F=m.coveringZoomLevel({tileSize:D.tileSize,roundZoom:D.roundZoom}),N=!n||Math.abs(n.tileID.overscaledZ-F)>Math.abs(p.tileID.overscaledZ-F),Z=N&&p.refreshedUponExpiration?1:a.aA(N?S:1-O,0,1);return n?{opacity:1,mix:1-Z,isFading:S<1}:{opacity:Z,mix:0,isFading:S<1}}return{opacity:1,mix:0,isFading:!1}}class pp extends va{constructor(n){const u=hl("mock-dem",{type:"raster-dem",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,u){n.state="loaded",u(null)}}class hu extends va{constructor(n){const u=hl("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,u,m){if(n.freezeTileCoverage)return;this.transform=n;const x=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((A,S)=>{if(A[S.key]="",!this._tiles[S.key]){const O=new Wc(S,this._source.tileSize*S.overscaleFactor(),n.tileZoom,void 0,void 0,this._source.worldview);O.state="loaded",this._tiles[S.key]=O}return A},{});for(const A in this._tiles)A in x||(this.freeFBO(A),this._tiles[A].unloadVectorData(),delete this._tiles[A])}freeFBO(n){const u=this.proxyCachedFBO[n];if(u!==void 0){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class mp extends a.aQ{constructor(n,u,m){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class rf extends a.bV{constructor(n,u){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,x,A]=(function(){const D=new a.bd,F=new a.b0,N=131;D.reserve(17161),F.reserve(33800);const Z=a.al/128,$=a.al+Z/2,W=$+Z;for(let te=-Z;te<W;te+=Z)for(let ae=-Z;ae<W;ae+=Z){const le=ae<0||ae>$||te<0||te>$?24575:0,be=a.aA(Math.round(ae),0,a.al),xe=a.aA(Math.round(te),0,a.al);D.emplaceBack(be+le,xe)}const ne=(te,ae)=>{const le=ae*N+te;F.emplaceBack(le+1,le,le+N),F.emplaceBack(le+N,le+N+1,le+1)};for(let te=1;te<129;te++)for(let ae=1;ae<129;ae++)ne(ae,te);return[0,129].forEach(te=>{for(let ae=0;ae<130;ae++)ne(ae,te),ne(te,ae)}),[D,F,32768]})(),S=n.context;this.gridBuffer=S.createVertexBuffer(m,a.bf.members),this.gridIndexBuffer=S.createIndexBuffer(x),this.gridSegments=a.bg.simpleSegment(0,0,m.length,x.length),this.gridNoSkirtSegments=a.bg.simpleSegment(0,0,m.length,A),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hu(u.map),this.orthoMatrix=a.bC(),a.ce(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.al,0,a.al,0,1);const O=S.gl;this._overlapStencilMode=new Rr({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new pp(u.map),this._pendingGroundEffectLayers=[],this._emissiveTexture=!1}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,u,m){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const x=n.terrain.properties,A=n.terrain.drapeRenderMode===0,S=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.o.now();const O=n.terrain&&n.terrain.scope,D=x.get("source"),F=A?this._mockSourceCache:n.getSourceCache(D,O);if(!F)return void a.w(`Couldn't find terrain source "${D}".`);if(this.sourceCache=F,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=S?this.calculateExaggeration(u):x.get("exaggeration"),!u.projection.requiresDraping&&S&&this._exaggeration===0)return void this._disable();this.enabled=!0;const N=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(u,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,N(),this._initializing=!0),N(),u.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0,this._previousZoom=u.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const u=this._previousCameraAltitude,m=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=m;const x=u!=null?m-u:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const A=n.zoom,S=this._style.terrain;if(!this._previousUpdateTimestamp)return S.getExaggeration(A);let O=A-this._previousZoom;const D=this._previousUpdateTimestamp;let F=A;this._evaluationZoom!=null&&(F=this._evaluationZoom,Math.abs(A-F)>.5&&(O=.5*(A-F+O)),O*x<0&&(F+=O)),this._evaluationZoom=F;const N=S.getExaggeration(F),Z=N===S.getExaggeration(Math.max(0,F-.1));if(Z&&Math.abs(N-this._exaggeration)<.01)return N;let $=Math.min(.1,.00375*(this._updateTimestamp-D));return(Z||N<.1||Math.abs(O)<1e-4)&&($=Math.min(.2,4*$)),a.ak(this._exaggeration,N,$)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.dataType==="source"&&n.coord?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=m._centerAltitude===0&&this.getAtPointOrZero(a.ae.fromLngLat(m.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(D=>{const F=u.getTileByID(D).tileID;return F.projMatrix=m.calculateProjMatrix(F.toUnwrapped()),F});(function(D,F){const N=F.transform.pointCoordinate(F.transform.getCameraPoint()),Z=new a.P(N.x,N.y);D.sort(($,W)=>{if(W.overscaledZ-$.overscaledZ)return W.overscaledZ-$.overscaledZ;const ne=new a.P($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),te=new a.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),ae=Z.mult(1<<$.canonical.z);return ae.x-=.5,ae.y-=.5,ae.distSqr(ne)-ae.distSqr(te)})})(x,this.painter);const A=this.proxyToSource||{};this.proxyToSource={},x.forEach(D=>{this.proxyToSource[D.key]={}}),this.terrainTileForTile={};const S=this._style._mergedSourceCaches;for(const D in S){const F=S[D];if(!F.used||(F!==this.sourceCache&&this.resetTileLookupCache(F.id),this._setupProxiedCoordsForOrtho(F,n[D],A),F.usedForTerrain))continue;const N=n[D];F.getSource().reparseOverscaled&&this._assignTerrainTiles(N)}this.proxiedCoords[u.id]=x.map(D=>new mp(D,D.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(A),this.renderingToTexture=!1;const O={};this._visibleDemTiles=[];for(const D of this.proxyCoords){const F=this.terrainTileForTile[D.key];if(!F)continue;const N=F.tileID.key;N in O||(this._visibleDemTiles.push(F),O[N]=N)}}_assignTerrainTiles(n){this._initializing||n.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const n=this.painter.context,u=n.gl;for(const m in this.terrainTileForTile){const x=this.terrainTileForTile[m],A=x.dem;!A||x.demTexture&&!x.needsDEMTextureUpload||(n.activeTexture.set(u.TEXTURE1),Ds(this.painter,x,A))}}_prepareDemTileUniforms(n,u,m,x){if(!u||u.demTexture==null)return!1;const A=n.tileID.canonical,S=Math.pow(2,u.tileID.canonical.z-A.z),O=x||"";return m[`u_dem_tl${O}`]=[A.x*S%1,A.y*S%1],m[`u_dem_scale${O}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const u=this._visibleDemTiles.reduce((m,x)=>{if(!x.dem)return m;const A=x.dem.tree.minimums[0];return A>0&&n++,m+A},0);return n?u/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,u=n.gl;n.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),x=new a.dL({width:1,height:1},new Float32Array([m]));this._emptyDEMTextureDirty=!1;let A=this._emptyDEMTexture;return A?A.update(x,{premultiply:!1}):A=this._emptyDEMTexture=new a.T(n,x,u.R32F,{premultiply:!1}),A}setupElevationDraw(n,u,m){const x=this.painter.context,A=x.gl,S={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};S.u_exaggeration=this.exaggeration();let O=null,D=null,F=1;if(m&&m.morphing&&this._useVertexMorphing){const W=m.morphing.srcDemTile,ne=m.morphing.dstDemTile;F=m.morphing.phase,W&&ne&&(this._prepareDemTileUniforms(n,W,S,"_prev")&&(D=W),this._prepareDemTileUniforms(n,ne,S)&&(O=ne))}const N=W=>W&&W.demTexture&&this.painter.linearFloatFilteringSupported()?A.LINEAR:A.NEAREST;let Z=null;var $;if(this.enabled?D&&O?(Z=O.demTexture,x.activeTexture.set(A.TEXTURE4),D.demTexture.bind(N(D),A.CLAMP_TO_EDGE),S.u_dem_lerp=F):(O=this.terrainTileForTile[n.tileID.key],Z=this._prepareDemTileUniforms(n,O,S)?O.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,x.activeTexture.set(A.TEXTURE2),Z&&(S.u_dem_size=($=Z).size[0]===1?1:$.size[0]-2,Z.bind(N(O),A.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(m&&m.useDepthForOcclusion,u,S),m&&m.useMeterToDem&&O){const W=(1<<O.tileID.canonical.z)*a.cf(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=W}if(m&&m.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(x,S),this.painter.transform.projection.name==="globe"){const W=this.globeUniformValues(this.painter.transform,n.tileID.canonical,m&&m.useDenormalizedUpVectorScale);u.setGlobeUniformValues(x,W)}}globeUniformValues(n,u,m){const x=n.projection;return{u_tile_tl_up:x.upVector(u,0,0),u_tile_tr_up:x.upVector(u,a.al,0),u_tile_br_up:x.upVector(u,a.al,a.al),u_tile_bl_up:x.upVector(u,0,a.al),u_tile_up_scale:m?a.dM(1):x.upVectorScale(u,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const u=this.painter,m=this.painter.context;n.length!==0&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),u.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(x,A,S,O,D){if(x.transform.projection.name==="globe")(function(F,N,Z,$,W){const ne=F.context,te=ne.gl;let ae,le;const be=F.transform,xe=a.dE(F,ne,be),ye=(Qe,We)=>{if(le===We)return;const ut=[Jd[We],"PROJECTION_GLOBE_VIEW"];xe&&ut.push("CUSTOM_ANTIALIASING");const wt=F.isTileAffectedByFog(Qe);ae=F.getOrCreateProgram("globeRaster",{defines:ut,overrideFog:wt}),le=We},Re=F.colorModeForRenderPass(),Ce=new mr(te.LEQUAL,mr.ReadWrite,F.depthRangeFor3D);el.update(W);const De=a.dF(be),Me=[a.aF(be.center.lng),a.aJ(be.center.lat)],Te=F.globeSharedBuffers,Ne=[be.width*a.o.devicePixelRatio,be.height*a.o.devicePixelRatio],Ve=Float32Array.from(be.globeMatrix),He={useDenormalizedUpVectorScale:!0};{const Qe=F.transform,We=uu(Qe.zoom,N.exaggeration(),N.sourceCache._source.tileSize);le=-1;const ut=te.TRIANGLES;for(const wt of $){const et=Z.getTile(wt),je=Rr.disabled,mt=N.prevTerrainTileForTile[wt.key],ot=N.terrainTileForTile[wt.key];cu(mt,ot)&&el.newMorphing(wt.key,mt,ot,W,250),ef(F,et.emissiveTexture),ne.activeTexture.set(te.TEXTURE0),et.texture&&et.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);const bt=el.getMorphValuesForProxy(wt.key),zt=bt?1:0;bt&&Object.assign(He,{morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:a.dD(bt.phase)}});const qt=a.dG(wt.canonical),kt=a.dH(qt.getCenter().lat),Lt=a.dI(wt.canonical,qt,kt,Qe.worldSize/Qe._pixelsPerMercatorPixel),hr=a.bk(a.dJ(wt.canonical)),sr=F.emissiveMode==="mrt-fallback"?1:0,Zt=Qd(Qe.expandedFarZProjMatrix,Ve,De,hr,a.aj(Qe.zoom),Me,Qe.frustumCorners.TL,Qe.frustumCorners.TR,Qe.frustumCorners.BR,Qe.frustumCorners.BL,Qe.globeCenterInViewSpace,Qe.globeRadius,Ne,We,Qe._farZ,sr,Lt);if(ye(wt,zt),ae&&(N.setupElevationDraw(et,ae,He),F.uploadCommonUniforms(ne,ae,wt.toUnwrapped()),Te)){const[lr,xr,Ir]=Te.getGridBuffers(kt,We!==0);ae.draw(F,ut,Ce,je,Re,Cr.backCCW,Zt,"globe_raster",lr,xr,Ir)}}}if(Te&&(F.renderDefaultNorthPole||F.renderDefaultSouthPole)){const Qe=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];xe&&Qe.push("CUSTOM_ANTIALIASING"),ae=F.getOrCreateProgram("globeRaster",{defines:Qe});for(const We of $){const{x:ut,y:wt,z:et}=We.canonical,je=wt===0,mt=wt===(1<<et)-1,[ot,bt,zt,qt]=Te.getPoleBuffers(et,!1);if(qt&&(je||mt)){const kt=Z.getTile(We);ef(F,kt.emissiveTexture),ne.activeTexture.set(te.TEXTURE0),kt.texture&&kt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE);let Lt=a.dK(et,ut,be);const hr=a.bk(a.dJ(We.canonical)),sr=F.emissiveMode==="mrt-fallback"?1:0,Zt=(lr,xr)=>lr.draw(F,te.TRIANGLES,Ce,Rr.disabled,Re,Cr.disabled,Qd(be.expandedFarZProjMatrix,Lt,Lt,hr,0,Me,be.frustumCorners.TL,be.frustumCorners.TR,be.frustumCorners.BR,be.frustumCorners.BL,be.globeCenterInViewSpace,be.globeRadius,Ne,0,be._farZ,sr),"globe_pole_raster",xr,zt,qt);N.setupElevationDraw(kt,ae,He),F.uploadCommonUniforms(ne,ae,We.toUnwrapped()),je&&F.renderDefaultNorthPole&&Zt(ae,ot),mt&&F.renderDefaultSouthPole&&(Lt=a.cS(a.bC(),Lt,[1,-1,1]),Zt(ae,bt))}}}})(x,A,S,O,D);else{const F=x.context,N=F.gl;let Z,$;const W=x.shadowRenderer,ne=Ys(x,x.longestCutoffRange),te=Re=>{if($===Re)return;const Ce=[];Ce.push(Jd[Re]),ne.shouldRenderCutoff&&Ce.push("RENDER_CUTOFF"),W&&(Ce.push("RENDER_SHADOWS","DEPTH_TEXTURE"),W.useNormalOffset&&Ce.push("NORMAL_OFFSET")),Z=x.getOrCreateProgram("terrainRaster",{defines:Ce}),$=Re},ae=x.colorModeForRenderPass(),le=new mr(N.LEQUAL,mr.ReadWrite,x.depthRangeFor3D);el.update(D);const be=x.transform,xe=uu(be.zoom,A.exaggeration(),A.sourceCache._source.tileSize);let ye=[0,0,0];if(W){const Re=x.style.directionalLight,Ce=x.style.ambientLight;Re&&Ce&&(ye=Wo(x.style,Re,Ce))}{$=-1;const Re=N.TRIANGLES,[Ce,De]=[A.gridIndexBuffer,A.gridSegments];for(const Me of O){const Te=S.getTile(Me),Ne=Rr.disabled,Ve=A.prevTerrainTileForTile[Me.key],He=A.terrainTileForTile[Me.key];cu(Ve,He)&&el.newMorphing(Me.key,Ve,He,D,250),ef(x,Te.emissiveTexture),F.activeTexture.set(N.TEXTURE0),Te.texture&&Te.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE);const Qe=el.getMorphValuesForProxy(Me.key),We=Qe?1:0;let ut;Qe&&(ut={morphing:{srcDemTile:Qe.from,dstDemTile:Qe.to,phase:a.dD(Qe.phase)}});const wt=x.emissiveMode==="mrt-fallback"?1:0,et=Si(Me.projMatrix,Qu(Me.canonical,be.renderWorldCopies)?xe/10:xe,ye,wt);if(te(We),!Z)continue;A.setupElevationDraw(Te,Z,ut);const je=Me.toUnwrapped();W&&W.setupShadows(je,Z),x.uploadCommonUniforms(F,Z,je,null,ne),Z.draw(x,Re,le,Ne,ae,Cr.backCCW,et,"terrain_raster",A.gridBuffer,Ce,De)}}}})(u,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,u.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,x=this.proxySourceCache,A=this.proxiedCoords[x.id],S=this._drapedRenderBatches.shift(),O=u.style.order,D=[];this._updateFBOs(u.emissiveMode==="mrt-fallback");let F=0;for(const N of A){const Z=x.getTileByID(N.proxyTileKey),$=x.proxyCachedFBO[N.key]?x.proxyCachedFBO[N.key][n]:void 0,W=$!==void 0?x.renderCache[$]:this.pool[F++],ne=$!==void 0;if(Z.texture=W.tex,Z.emissiveTexture=W.emissiveTex,ne&&!W.dirty){D.push(Z.tileID);continue}m.bindFramebuffer.set(W.fb.framebuffer);const te=m.gl;let ae;te.drawBuffers(u.emissiveMode==="mrt-fallback"?[te.COLOR_ATTACHMENT0,te.COLOR_ATTACHMENT1]:[te.COLOR_ATTACHMENT0]),this.renderedToTile=!1,W.dirty&&(m.clear({color:a.ao.transparent,stencil:0}),W.dirty=!1);for(let le=S.start;le<=S.end;++le){const be=u.style._mergedLayers[O[le]];if(be.isHidden(u.transform.zoom))continue;const xe=u.style.getLayerSourceCache(be),ye=xe?this.proxyToSource[N.key][xe.id]:[N];if(!ye)continue;const Re=ye;m.viewport.set([0,0,W.fb.width,W.fb.height]),ae!==(xe?xe.id:null)&&(this._setupStencil(W,ye,be,xe),ae=xe?xe.id:null),u.renderLayer(u,xe,be,Re)}if(te.drawBuffers([te.COLOR_ATTACHMENT0]),this._drapedRenderBatches.length===0)for(const le of this._pendingGroundEffectLayers){const be=u.style._mergedLayers[O[le]];if(be.isHidden(u.transform.zoom))continue;const xe=u.style.getLayerSourceCache(be),ye=xe?this.proxyToSource[N.key][xe.id]:[N];if(!ye)continue;const Re=ye;m.viewport.set([0,0,W.fb.width,W.fb.height]),ae!==(xe?xe.id:null)&&(this._setupStencil(W,ye,be,xe),ae=xe?xe.id:null),u.renderLayer(u,xe,be,Re)}this.renderedToTile?(W.dirty=!0,D.push(Z.tileID)):ne||--F,F===5&&(F=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),S.end+1}postRender(){}isLayerOrderingCorrect(n){const u=n.order.length;let m=-1,x=u;for(let A=0;A<u;++A)this._style.isLayerDraped(n._mergedLayers[n.order[A]])?m=Math.max(m,A):x=Math.min(x,A);return x>m}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{n=Math.min(n,u.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,u,m){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(A=>A.dem).map(A=>{const S=A.tileID,O=1<<S.overscaledZ,{x:D,y:F}=S.canonical,N=D/O,Z=(D+1)/O,$=F/O,W=(F+1)/O;return{minx:N,miny:$,maxx:Z,maxy:W,t:A.dem.tree.raycastRoot(N,$,Z,W,n,u,m),tile:A}});x.sort((A,S)=>(A.t!==null?A.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const A of x){if(A.t==null)return null;const S=A.tile.dem.tree.raycast(A.minx,A.miny,A.maxx,A.maxy,n,u,m);if(S!=null)return S}return null}_createFBO(){const n=this.painter.context,u=n.gl,m=this.drapeBufferSize;n.activeTexture.set(u.TEXTURE0);const x=new a.T(n,{width:m[0],height:m[1],data:null},u.RGBA8);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const A=n.createFramebuffer(m[0],m[1],1,null);let S;return A.colorAttachment0.set(x.texture),this._emissiveTexture&&(S=new a.T(n,{width:m[0],height:m[1],data:null},u.R8),S.bind(u.LINEAR,u.CLAMP_TO_EDGE),A.createColorAttachment(n,1),A.colorAttachment1.set(S.texture)),A.depthAttachment=new gv(n,A.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,A.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):A.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&u.texParameterf(u.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:A,tex:x,emissiveTex:S,dirty:!1}}_updateFBOs(n){if(this._emissiveTexture!==n){for(const u of this.pool)this._updateFBO(u,n);for(const u of this.proxySourceCache.renderCache)this._updateFBO(u,n);this._emissiveTexture=n}}_updateFBO(n,u){const m=n.fb,x=this.painter.context,A=x.gl,S=this.drapeBufferSize;if(u){const O=new a.T(x,{width:S[0],height:S[1],data:null},A.R8);O.bind(A.LINEAR,A.CLAMP_TO_EDGE),n.emissiveTex=O,m.createColorAttachment(x,1),m.colorAttachment1.set(O.texture)}else n.emissiveTex=void 0,m.removeColorAttachment(x,1);n.dirty=!0}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const u=this._style._mergedLayers[n],m=u.isHidden(this.painter.transform.zoom);return u.type==="hillshade"||u.type==="custom"?!m&&u.shouldRedrape():!m&&u.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const m of this._style.getSources())if(m instanceof ul){n=!0;break}if(!n)return;const u={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],A=this._style.getLayerSourceCache(x);if(!A||u[A.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="line")continue;const S=x.widthExpression(),O=x.emissiveStrengthExpression();if(S instanceof a.ad||O instanceof a.ad){u[A.id]=!0;for(const D of this.proxyCoords){const F=this.proxyToSource[D.key][A.id];if(F)for(const N of F)this._clearRenderCacheForTile(A.id,N)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const m in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[m]._source instanceof Sa){n=!0;break}if(!n)return;const u={};for(let m=0;m<this._style.order.length;++m){const x=this._style._mergedLayers[this._style.order[m]],A=this._style.getLayerSourceCache(x);if(!A||u[A.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const S=x.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const D=this.proxyToSource[O.key][A.id];if(D)for(const F of D){const N=fp(A.getTile(F),A.findLoadedParent(F,0),A,this.painter.transform,S);(N.opacity!==1||N.mix!==0)&&this._clearRenderCacheForTile(A.id,F)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,u=n.length;if(u===0)return;const m=[];this._pendingGroundEffectLayers=[];let x,A=0,S=this._style._mergedLayers[n[A]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++A<u;)S=this._style._mergedLayers[n[A]];for(;A<u;++A){const O=this._style._mergedLayers[n[A]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?x===void 0&&(x=A):(O.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(A),x!==void 0&&(m.push({start:x,end:A-1}),x=void 0)))}if(x!==void 0&&m.push({start:x,end:A-1}),m.length!==0){const O=m[m.length-1];this._pendingGroundEffectLayers.every(D=>D>O.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=m}_setupRenderCache(n){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const S=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let O=0;O<S.length;++O){const D=Object.values(S[O]);u.renderCachePool.push(...D)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,x=this._tilesDirty;for(let S=m.length-1;S>=0;S--){const O=m[S];if(u.getTileByID(O.key),u.proxyCachedFBO[O.key]!==void 0){const D=n[O.key],F=this.proxyToSource[O.key];let N=0;for(const Z in F){const $=F[Z],W=D[Z];if(!W||W.length!==$.length||$.some((ne,te)=>ne!==W[te]||x[Z]&&x[Z].hasOwnProperty(ne.key))){N=-1;break}++N}for(const Z in u.proxyCachedFBO[O.key])u.renderCache[u.proxyCachedFBO[O.key][Z]].dirty=N<0||N!==Object.values(D).length}}const A=[...this._drapedRenderBatches];A.sort((S,O)=>O.end-O.start-(S.end-S.start));for(const S of A)for(const O of m){if(u.proxyCachedFBO[O.key])continue;let D=u.renderCachePool.pop();D===void 0&&u.renderCache.length<50&&(D=u.renderCache.length,u.renderCache.push(this._createFBO())),D!==void 0&&(u.proxyCachedFBO[O.key]={},u.proxyCachedFBO[O.key][S.start]=D,u.renderCache[D].dirty=!0)}this._tilesDirty={}}_setupStencil(n,u,m,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const A=this.painter.context,S=A.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let O;if(m.isTileClipped())O=u.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(A.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):Rr.disabled}_renderTileClippingMasks(n,u){const m=this.painter,x=this.painter.context,A=x.gl;m._tileClippingMaskIDs={},x.setColorMode(zr.disabled),x.setDepthMode(mr.disabled);const S=m.getOrCreateProgram("clippingMask");for(const O of n){const D=m._tileClippingMaskIDs[O.key]=--u;S.draw(m,A.TRIANGLES,mr.disabled,new Rr({func:A.ALWAYS,mask:0},D,255,A.KEEP,A.KEEP,A.REPLACE),zr.disabled,Cr.disabled,tf(O.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(n){const u=this.painter.transform;if(n.x<0||n.x>u.width||n.y<0||n.y>u.height)return null;const m=[n.x,n.y,1,1];a.aC(m,m,u.pixelMatrixInverse),a.cK(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const x=u._camera.position,A=a.cf(1,u.center.lat),S=[x[0],x[1],x[2]/A,0],O=a.da([],m.slice(0,3),S);a.aw(O,O);const D=this.raycast(S,O,this._exaggeration);return D!==null&&D?(a.bH(S,S,O,D),S[3]=S[2],S[2]*=A,S):null}_setupProxiedCoordsForOrtho(n,u,m){if(n.getSource()instanceof a.aU)return this._setupProxiedCoordsForImageSource(n,u,m);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const x=this.proxiedCoords[n.id]=[],A=this.proxyCoords;for(let D=0;D<A.length;D++){const F=A[D],N=this._findTileCoveringTileID(F,n);if(N){const Z=this._createProxiedId(F,N,m[F.key]&&m[F.key][n.id]);x.push(Z),this.proxyToSource[F.key][n.id]=[Z]}}let S=!1;const O=new Set;for(let D=0;D<u.length;D++){const F=n.getTile(u[D]);if(!F||!F.hasData())continue;const N=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(N&&N.tileID.canonical.z!==F.tileID.canonical.z){const Z=this.proxyToSource[N.tileID.key][n.id],$=this._createProxiedId(N.tileID,F,m[N.tileID.key]&&m[N.tileID.key][n.id]);Z?Z.splice(Z.length-1,0,$):this.proxyToSource[N.tileID.key][n.id]=[$];const W=this.proxyToSource[N.tileID.key][n.id];O.has(W)||O.add(W),x.push($),S=!0}}if(this._sourceTilesOverlap[n.id]=S,S&&this._debugParams.sortTilesHiZFirst)for(const D of O)D.sort((F,N)=>N.overscaledZ-F.overscaledZ)}_setupProxiedCoordsForImageSource(n,u,m){if(!n.getSource().loaded())return;const x=this.proxiedCoords[n.id]=[],A=this.proxyCoords,S=n.getSource(),O=S.tileID;if(!O)return;const D=new a.P(O.x,O.y)._div(1<<O.z),F=S.coordinates.map(a.ae.fromLngLat).reduce((Z,$)=>(Z.min.x=Math.min(Z.min.x,$.x-D.x),Z.min.y=Math.min(Z.min.y,$.y-D.y),Z.max.x=Math.max(Z.max.x,$.x-D.x),Z.max.y=Math.max(Z.max.y,$.y-D.y),Z),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),N=(Z,$)=>{const W=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ne=Z.canonical.y/(1<<Z.canonical.z),te=a.al/(1<<Z.canonical.z),ae=$.wrap+$.canonical.x/(1<<$.canonical.z),le=$.canonical.y/(1<<$.canonical.z);return W+te<ae+F.min.x||W>ae+F.max.x||ne+te<le+F.min.y||ne>le+F.max.y};for(let Z=0;Z<A.length;Z++){const $=A[Z];for(let W=0;W<u.length;W++){const ne=n.getTile(u[W]);if(!ne||!ne.hasData()||N($,ne.tileID))continue;const te=this._createProxiedId($,ne,m[$.key]&&m[$.key][n.id]),ae=this.proxyToSource[$.key][n.id];ae?ae.push(te):this.proxyToSource[$.key][n.id]=[te],x.push(te)}}}_createProxiedId(n,u,m){let x=this.orthoMatrix;if(m){const A=m.find(S=>S.key===u.tileID.key);if(A)return A}if(u.tileID.key!==n.key){const A=n.canonical.z-u.tileID.canonical.z;let S,O,D;x=a.bC();const F=u.tileID.wrap-n.wrap<<n.overscaledZ;A>0?(S=a.al>>A,O=S*((u.tileID.canonical.x<<A)-n.canonical.x+F),D=S*((u.tileID.canonical.y<<A)-n.canonical.y)):(S=a.al<<-A,O=a.al*(u.tileID.canonical.x-(n.canonical.x+F<<-A)),D=a.al*(u.tileID.canonical.y-(n.canonical.y<<-A))),a.ce(x,0,S,0,S,0,1),a.br(x,x,[O,D,0])}return new mp(u.tileID,n.key,x)}_findTileCoveringTileID(n,u){let m=u.getTile(n);if(m&&m.hasData())return m;const x=this._findCoveringTileCache[u.id],A=x[n.key];if(m=A?u.getTileByID(A):null,m&&m.hasData()||A===null)return m;let S=m?m.tileID:n,O=S.overscaledZ;const D=u.getSource().minzoom,F=[];if(!A){const Z=u.getSource().maxzoom;if(n.canonical.z>=Z){const $=n.canonical.z-Z;u.getSource().reparseOverscaled?(O=Math.max(n.canonical.z+2,u.transform.tileZoom),S=new a.aQ(O,n.wrap,Z,n.canonical.x>>$,n.canonical.y>>$)):$!==0&&(O=Z,S=new a.aQ(O,n.wrap,Z,n.canonical.x>>$,n.canonical.y>>$))}S.key!==n.key&&(F.push(S.key),m=u.getTile(S))}const N=Z=>{F.forEach($=>{x[$]=Z}),F.length=0};for(O-=1;O>=D&&(!m||!m.hasData());O--){m&&N(m.tileID.key);const Z=S.calculateScaledKey(O);if(m=u.getTileByID(Z),m&&m.hasData())break;const $=x[Z];if($===null)break;$===void 0?F.push(Z):m=u.getTileByID($)}return N(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,u){let m=this._tilesDirty[n];m||(m=this._tilesDirty[n]={}),m[u.key]=!0}}function Wh(p,n,u){const m=(function(O,D,F){const N=a.bJ(D,O),Z=a.bJ(F,[.2126,.7152,.0722]),$=(ne,te,ae)=>(1-ae)*ne+ae*te,W=$(1-.3*Math.min(Z,1),1,Math.min(N+1,1));return $(.92,1,Math.asin(a.aA(D[2],-1,1))/Math.PI+.5)*W})(p,[0,0,1],n),x=[0,0,0];a.c5(x,u.slice(0,3),m);const A=[0,0,0];a.c5(A,n.slice(0,3),p[2]);const S=[0,0,0];return a.d8(S,x,A),a.db(S)}const nf=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],p_=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","building","buildingBloom","elevatedStructures","model","symbol"];class gp{static cacheKey(n,u,m,x){const A=[u];x&&A.push(x.cacheKey);for(const S of m)n.usedDefines.has(S)&&A.push(S);return A.join("/")}constructor(n,u,m,x,A,S){const O=n.gl;this.program=O.createProgram(),this.configuration=x,this.name=u,this.fixedDefines=[...S];const D=`#version 300 es
${(x?x.defines():[]).concat(S.map(te=>`#define ${te}`)).join(`
`)}`,F=[D,mv];for(const te of m.fragmentIncludes)F.push(iu[te]);F.push(m.fragmentSource);const N=F.join(`
`),Z=[D,km];for(const te of m.vertexIncludes)Z.push(iu[te]);this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&m.vertexSource.includes("gl_InstanceID"),this.forceManualRenderingForInstanceIDShaders&&Z.push("uniform int u_instanceID;"),Z.push(m.vertexSource);let $=Z.join(`
`);this.forceManualRenderingForInstanceIDShaders&&($=$.replaceAll("gl_InstanceID","u_instanceID"));const W=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(W,N),O.compileShader(W),O.attachShader(this.program,W);const ne=O.createShader(O.VERTEX_SHADER);O.isContextLost()?this.failedToCreate=!0:(O.shaderSource(ne,$),O.compileShader(ne),O.attachShader(this.program,ne),this.attributes={},O.linkProgram(this.program),O.deleteShader(ne),O.deleteShader(W),this.fixedUniforms=A(n),this.fixedUniformsEntries=Object.entries(this.fixedUniforms),this.binderUniforms=x?x.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(te=>({u_instanceID:new a.ch(te)}))(n)),(S.includes("TERRAIN")||u.includes("symbol")||u.includes("circle"))&&(this.terrainUniforms=(te=>({u_dem:new a.ch(te),u_dem_prev:new a.ch(te),u_dem_tl:new a.ck(te),u_dem_scale:new a.cj(te),u_dem_tl_prev:new a.ck(te),u_dem_scale_prev:new a.cj(te),u_dem_size:new a.cj(te),u_dem_lerp:new a.cj(te),u_exaggeration:new a.cj(te),u_depth:new a.ch(te),u_depth_size_inv:new a.ck(te),u_depth_range_unpack:new a.ck(te),u_occluder_half_size:new a.cj(te),u_occlusion_depth_offset:new a.cj(te),u_meter_to_dem:new a.cj(te),u_label_plane_matrix_inv:new a.cl(te)}))(n)),S.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new a.ci(te),u_tile_tr_up:new a.ci(te),u_tile_br_up:new a.ci(te),u_tile_bl_up:new a.ci(te),u_tile_up_scale:new a.cj(te)}))(n)),S.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new a.cl(te),u_fog_range:new a.ck(te),u_fog_color:new a.d3(te),u_fog_horizon_blend:new a.cj(te),u_fog_vertical_limit:new a.ck(te),u_fog_temporal_offset:new a.cj(te),u_frustum_tl:new a.ci(te),u_frustum_tr:new a.ci(te),u_frustum_br:new a.ci(te),u_frustum_bl:new a.ci(te),u_globe_pos:new a.ci(te),u_globe_radius:new a.cj(te),u_globe_transition:new a.cj(te),u_is_globe:new a.ch(te),u_viewport:new a.ck(te)}))(n)),S.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(te=>({u_cutoff_params:new a.d3(te)}))(n)),S.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(te=>({u_lighting_ambient_color:new a.ci(te),u_lighting_directional_dir:new a.ci(te),u_lighting_directional_color:new a.ci(te),u_ground_radiance:new a.ci(te)}))(n)),S.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(te=>({u_light_matrix_0:new a.cl(te),u_light_matrix_1:new a.cl(te),u_fade_range:new a.ck(te),u_shadow_normal_offset:new a.ci(te),u_shadow_intensity:new a.cj(te),u_shadow_texel_size:new a.cj(te),u_shadow_map_resolution:new a.cj(te),u_shadow_direction:new a.ci(te),u_shadow_bias:new a.ci(te),u_shadowmap_0:new a.ch(te),u_shadowmap_1:new a.ch(te)}))(n)))}getAttributeLocation(n,u){let m=this.attributes[u];return m===void 0&&(m=this.attributes[u]=n.getAttribLocation(this.program,u)),m}setTerrainUniformValues(n,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)m[x]&&m[x].set(this.program,x,u[x])}}setGlobeUniformValues(n,u){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)m[x]&&m[x].set(this.program,x,u[x])}}setFogUniformValues(n,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)m[x].set(this.program,x,u[x])}}setCutoffUniformValues(n,u){if(!this.cutoffUniforms)return;const m=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)m[x].set(this.program,x,u[x])}}setLightsUniformValues(n,u){if(!this.lightsUniforms)return;const m=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)m[x].set(this.program,x,u[x])}}setShadowUniformValues(n,u){if(this.failedToCreate||!this.shadowUniforms)return;const m=this.shadowUniforms;n.program.set(this.program);for(const x in u)m[x].set(this.program,x,u[x])}_drawDebugWireframe(n,u,m,x,A,S,O,D,F,N){const Z=n.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const $=n.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||n._terrain&&n._terrain.renderingToTexture||!nf.includes(this.name))||!(!Z.layers3D||!p_.includes(this.name))))return;const W=$.gl,ne=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,A,$);if(!ne)return;const te=[...this.fixedDefines,"DEBUG_WIREFRAME"],ae=n.getOrCreateProgram(this.name,{config:this.configuration,defines:te});$.program.set(ae.program);const le=(ye,Re,Ce)=>{if(Re[ye]&&Ce[ye])for(const De in Re[ye])Ce[ye][De]&&Ce[ye][De].set(Ce.program,De,Re[ye][De].current)};F&&F.setUniforms(ae.program,$,ae.binderUniforms,O,{zoom:D}),le("fixedUniforms",this,ae),le("terrainUniforms",this,ae),le("globeUniforms",this,ae),le("fogUniforms",this,ae),le("lightsUniforms",this,ae),le("shadowUniforms",this,ae),ne.bind(),$.setColorMode(new zr([W.ONE,W.ONE_MINUS_SRC_ALPHA,W.ZERO,W.ONE],a.ao.transparent,[!0,!0,!0,!1])),$.setDepthMode(new mr(u.func===W.LESS?W.LEQUAL:u.func,mr.ReadOnly,u.range)),$.setStencilMode(Rr.disabled);const be=3*S.primitiveLength*2,xe=3*S.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const ye=N||1;for(let Re=0;Re<ye;++Re)ae.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Re),W.drawElements(W.LINES,be,W.UNSIGNED_SHORT,xe)}else N&&N>1?W.drawElementsInstanced(W.LINES,be,W.UNSIGNED_SHORT,xe,N):W.drawElements(W.LINES,be,W.UNSIGNED_SHORT,xe);A.bind(),$.program.set(this.program),$.setDepthMode(u),$.setStencilMode(m),$.setColorMode(x)}checkUniforms(n,u,m){if(this.fixedDefines.includes(u)){for(const x of Object.keys(m))if(!m[x].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${x} not set but required by ${u} being defined`)}}draw(n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae){const le=n.context,be=le.gl;if(this.failedToCreate)return;le.program.set(this.program),le.setDepthMode(m),le.setStencilMode(x),le.setColorMode(A),le.setCullFace(S);for(const[Me,Te]of this.fixedUniformsEntries)Te.set(this.program,Me,O[Me]);ne&&ne.setUniforms(this.program,le,this.binderUniforms,$,{zoom:W});const xe={[be.POINTS]:1,[be.LINES]:2,[be.TRIANGLES]:3,[be.LINE_STRIP]:1}[u];this.checkUniforms(D,"RENDER_SHADOWS",this.shadowUniforms);const ye=te||[],Re=ne?ne.getPaintVertexBuffers():[],Ce=u===be.TRIANGLES&&N,De=ae&&ae>0?1:void 0;for(const Me of Z.get()){const Te=Me.vaos||(Me.vaos={});if((Te[D]||(Te[D]=new Zd)).bind(le,this,F,Re,N,Me.vertexOffset,ye,De),this.forceManualRenderingForInstanceIDShaders){const Ne=ae||1;for(let Ve=0;Ve<Ne;++Ve)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ve),N?be.drawElements(u,Me.primitiveLength*xe,be.UNSIGNED_SHORT,Me.primitiveOffset*xe*2):be.drawArrays(u,Me.vertexOffset,Me.vertexLength)}else ae&&ae>1?be.drawElementsInstanced(u,Me.primitiveLength*xe,be.UNSIGNED_SHORT,Me.primitiveOffset*xe*2,ae):N?be.drawElements(u,Me.primitiveLength*xe,be.UNSIGNED_SHORT,Me.primitiveOffset*xe*2):be.drawArrays(u,Me.vertexOffset,Me.vertexLength);Ce&&this._drawDebugWireframe(n,m,x,A,N,Me,$,W,ne,ae)}}}function _p(p,n,u=0){const m=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,p.transform.tileZoom)/m,A=x*(n.tileID.canonical.x+n.tileID.wrap*m),S=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.ay(n,1,p.transform.tileZoom),u_pixel_coord_upper:[A>>16,S>>16],u_pixel_coord_lower:[65535&A,65535&S],u_pattern_transition:u}}const yp={terrain:0,flat:1},_v=a.bC(),Ec=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le)=>{const be=n.style.light,xe=be.properties.get("position"),ye=[xe.x,xe.y,xe.z],Re=a.dO();be.properties.get("anchor")==="viewport"&&(a.dP(Re,-n.transform.angle),a.dQ(ye,ye,Re));const Ce=be.properties.get("color").toPremultipliedRenderColor(null),De=n.transform,Me={u_matrix:p,u_lightpos:ye,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[Ce.r,Ce.g,Ce.b],u_vertical_gradient:+u,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:_v,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:yp[F],u_base_type:yp[N],u_ao:x,u_edge_radius:A,u_width_scale:S,u_flood_light_color:ne,u_vertical_scale:te,u_flood_light_intensity:ae,u_ground_shadow_factor:le};return De.projection.name==="globe"&&(Me.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Me.u_zoom_transition=Z,Me.u_inv_rot_matrix=W,Me.u_merc_center=$,Me.u_up_dir=De.projection.upVector(new a.cD(0,0,0),$[0]*a.al,$[1]*a.al),Me.u_height_lift=D),Me},du=(p,n,u,m,x,A)=>({u_matrix:p,u_edge_radius:n,u_width_scale:u,u_vertical_scale:m,u_height_type:yp[x],u_base_type:yp[A]}),m_=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le)=>{const be=Ec(p,n,u,m,x,A,S,O,F,N,Z,$,W,ne,te,ae,1,[0,0,0]),xe={u_height_factor:-Math.pow(2,O.overscaledZ)/D.tileSize/8};return Object.assign(be,_p(n,D,le),xe)},Ju=(p,n,u)=>({u_matrix:p,u_emissive_strength:n,u_ground_shadow_factor:u}),eh=(p,n,u,m,x,A=0)=>Object.assign(Ju(p,n,x),_p(u,m,A)),af=(p,n,u,m)=>({u_matrix:p,u_world:u,u_emissive_strength:n,u_ground_shadow_factor:m}),vp=(p,n,u,m,x,A,S=0)=>Object.assign(eh(p,n,u,m,A,S),{u_world:x}),Yh=(p,n)=>({u_matrix:p,u_depth_bias:n}),Gl=(p,n)=>({u_matrix:p,u_ground_shadow_factor:n}),th=(p,n,u,m,x)=>({u_matrix:p,u_camera_pos:[n[0],n[1],n[2]],u_depth_bias:u,u_height_scale:m,u_reset_depth:x}),Mc=(p,n,u,m,x,A,S,O,D)=>({u_matrix:p,u_normal_matrix:n,u_opacity:u,u_faux_facade_ao_intensity:m,u_camera_pos:x,u_tile_to_meter:A,u_facade_emissive_chance:S,u_flood_light_color:O,u_flood_light_intensity:D}),g_=p=>({u_matrix:p}),fs=p=>({u_matrix:p}),xp=(p,n,u,m,x,A,S,O)=>{const D=a.al/A.tileSize;return{u_matrix:p,u_inv_rot_matrix:n,u_camera_to_center_distance:u.getCameraToCenterDistance(O),u_extrude_scale:[u.pixelsToGLUnits[0]/D,u.pixelsToGLUnits[1]/D],u_zoom_transition:m,u_tile_id:S,u_merc_center:x}},of=(p,n,u,m)=>({u_matrix:p,u_inv_matrix:n,u_camera_to_center_distance:u.getCameraToCenterDistance(m),u_viewport_size:[u.width,u.height]}),Oc=(p,n,u=1)=>({u_matrix:p,u_color:n,u_overlay:0,u_overlay_scale:u}),fu=a.bC(),Kh=(p,n,u,m,x,A,S)=>{const O=p.transform,D=O.projection.name==="globe",F=D?a.dR(O.zoom,n.canonical)*O._pixelsPerMercatorPixel:a.ay(u,1,A),N={u_matrix:n.projMatrix,u_extrude_scale:F,u_intensity:S,u_inv_rot_matrix:fu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){N.u_inv_rot_matrix=m,N.u_merc_center=x,N.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],N.u_zoom_transition=a.aj(O.zoom);const Z=x[0]*a.al,$=x[1]*a.al;N.u_up_dir=O.projection.upVector(new a.cD(0,0,0),Z,$)}return N};function sf(p,[n,u,m,x],[A,S]){if(A===S)return[0,0,0,0];const O=255*(p-1)/(p*(S-A));return[n*O,u*O,m*O,x*O]}function Gm(p,n,[u,m]){return u===m?0:.5/p+(n-u)*(p-1)/(p*(m-u))}const Qh=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be,xe,ye)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:A,u_scale_parent:F,u_fade_t:N.mix,u_opacity:N.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:a.dT(Z.paint.get("raster-saturation")),u_contrast_factor:a.dS(Z.paint.get("raster-contrast")),u_spin_weights:pu(Z.paint.get("raster-hue-rotate")),u_perspective_transform:$,u_raster_elevation:W,u_zoom_transition:S,u_merc_center:O,u_cutoff_params:D,u_colorization_mix:sf(a.dU,te,le),u_colorization_offset:Gm(a.dU,ae,le),u_color_ramp:ne,u_texture_offset:[xe/(be+2*xe),be/(be+2*xe)],u_texture_res:[be+2*xe,be+2*xe],u_emissive_strength:ye});function pu(p){p*=Math.PI/180;const n=Math.sin(p),u=Math.cos(p);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const Jh=.05,yv=(p,n,u,m,x,A,S,O,D,F,N,Z)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:u,u_merc_matrix:m,u_grid_matrix:x,u_tl_parent:A,u_scale_parent:F,u_fade_t:N.mix,u_opacity:N.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:S,u_merc_center:O,u_cutoff_params:D}),ed=(p,n,u,m,x,A,S,O,D,F)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_tile_offset:u,u_velocity:m,u_color_ramp:A,u_velocity_res:x,u_max_speed:S,u_uv_offset:O,u_data_scale:[255*D[0],255*D[1]],u_data_offset:F,u_particle_pos_scale:1.1,u_particle_pos_offset:[Jh,Jh]}),$m=(p,n,u,m,x,A,S,O,D,F)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_velocity:u,u_velocity_res:m,u_max_speed:x,u_speed_factor:A,u_reset_rate:S,u_rand_seed:Math.random(),u_uv_offset:O,u_data_scale:[255*D[0],255*D[1]],u_data_offset:F,u_particle_pos_scale:1.1,u_particle_pos_offset:[Jh,Jh]}),bp=a.bC(),td=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be,xe,ye,Re,Ce,De)=>{const Me=x.transform,Te={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Me.getCameraToCenterDistance(be),u_rotate_symbol:+u,u_aspect_ratio:Me.width/Me.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:A,u_label_plane_matrix:S,u_coord_matrix:O,u_is_text:+F,u_elevation_from_sea:D?1:0,u_pitch_with_map:+m,u_texsize:N,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:bp,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:bp,u_up_vector:[0,-1,0],u_color_adj_mat:Re,u_icon_transition:Ce||0,u_gamma_scale:m?x.transform.getCameraToCenterDistance(be)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:a.o.devicePixelRatio,u_is_halo:1,u_scale_factor:De||1,u_ground_shadow_factor:xe,u_inv_matrix:a.bl(a.bC(),S),u_normal_scale:ye,u_lutTexture:10};return be.name==="globe"&&(Te.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],Te.u_zoom_transition=ne,Te.u_inv_rot_matrix=ae,Te.u_merc_center=te,Te.u_camera_forward=Me._camera.forward(),Te.u_ecef_origin=a.dV(Me.globeMatrix,W.toUnwrapped()),Te.u_tile_matrix=Float32Array.from(Me.globeMatrix),Te.u_up_vector=le),Te},Cc=(p,n,u,m)=>({u_matrix:p,u_emissive_strength:n,u_opacity:u,u_color:m}),Lo=(p,n,u,m,x,A,S,O,D)=>Object.assign((function(F,N,Z,$,W,ne){const{width:te,height:ae}=$.imageManager.getPixelSize(N),le=Math.pow(2,ne.tileID.overscaledZ),be=ne.tileSize*Math.pow(2,$.transform.tileZoom)/le,xe=be*(ne.tileID.canonical.x+ne.tileID.wrap*le),ye=be*ne.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[te,ae],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:W?[$.transform.width,-1*$.transform.height]:[1/a.ay(ne,1,$.transform.tileZoom),1/a.ay(ne,1,$.transform.tileZoom)],u_pixel_coord_upper:[xe>>16,ye>>16],u_pixel_coord_lower:[65535&xe,65535&ye]}})(0,A,S,m,O,D),{u_matrix:p,u_emissive_strength:n,u_opacity:u}),wo=new Float32Array(a.bA([])),$l=(p,n,u,m,x,A,S,O,D,F,N,Z,$,W=[0,0,0],ne,te,ae)=>{const le=x.style.light,be=le.properties.get("position"),xe=[-be.x,-be.y,be.z],ye=a.dO();le.properties.get("anchor")==="viewport"&&(a.dP(ye,-x.transform.angle),a.dQ(xe,xe,ye));const Re=N.alphaMode==="MASK",Ce=le.properties.get("color").toNonPremultipliedRenderColor(null),De=$.paint.get("model-ambient-occlusion-intensity"),Me=$.paint.get("model-color").constantOr(a.ao.white).toNonPremultipliedRenderColor(null);return Me.a=$.paint.get("model-color-mix-intensity").constantOr(0),ae&&(Me.r=ae[0],Me.g=ae[1],Me.b=ae[2],Me.a=ae[3]),te&&(Me.r=te.color.r,Me.g=te.color.g,Me.b=te.color.b,Me.a=te.colorMix,Z=te.emissionStrength,A*=te.opacity),{u_matrix:p,u_lighting_matrix:n,u_normal_matrix:u,u_node_matrix:m||wo,u_lightpos:xe,u_lightintensity:le.properties.get("intensity"),u_lightcolor:[Ce.r,Ce.g,Ce.b],u_camera_pos:W,u_opacity:A,u_baseTextureIsAlpha:0,u_alphaMask:+Re,u_alphaCutoff:N.alphaCutoff,u_baseColorFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:O.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:D,u_roughnessFactor:F,u_baseColorTexture:5,u_metallicRoughnessTexture:6,u_normalTexture:7,u_occlusionTexture:8,u_emissionTexture:9,u_lutTexture:10,u_color_mix:Me.toArray01(),u_aoIntensity:De,u_emissive_strength:Z,u_occlusionTextureTransform:ne||[0,0,0,0]}},rd=(p,n=wo,u=wo)=>({u_matrix:p,u_instance:n,u_node_matrix:u}),wp={fillExtrusion:p=>({u_matrix:new a.cl(p),u_lightpos:new a.ci(p),u_lightintensity:new a.cj(p),u_lightcolor:new a.ci(p),u_vertical_gradient:new a.cj(p),u_opacity:new a.cj(p),u_edge_radius:new a.cj(p),u_width_scale:new a.cj(p),u_ao:new a.ck(p),u_height_type:new a.ch(p),u_base_type:new a.ch(p),u_tile_id:new a.ci(p),u_zoom_transition:new a.cj(p),u_inv_rot_matrix:new a.cl(p),u_merc_center:new a.ck(p),u_up_dir:new a.ci(p),u_height_lift:new a.cj(p),u_flood_light_color:new a.ci(p),u_vertical_scale:new a.cj(p),u_flood_light_intensity:new a.cj(p),u_ground_shadow_factor:new a.ci(p)}),fillExtrusionDepth:p=>({u_matrix:new a.cl(p),u_edge_radius:new a.cj(p),u_width_scale:new a.cj(p),u_vertical_scale:new a.cj(p),u_height_type:new a.ch(p),u_base_type:new a.ch(p)}),fillExtrusionPattern:p=>({u_matrix:new a.cl(p),u_lightpos:new a.ci(p),u_lightintensity:new a.cj(p),u_lightcolor:new a.ci(p),u_vertical_gradient:new a.cj(p),u_height_factor:new a.cj(p),u_edge_radius:new a.cj(p),u_width_scale:new a.cj(p),u_ao:new a.ck(p),u_height_type:new a.ch(p),u_base_type:new a.ch(p),u_tile_id:new a.ci(p),u_zoom_transition:new a.cj(p),u_inv_rot_matrix:new a.cl(p),u_merc_center:new a.ck(p),u_up_dir:new a.ci(p),u_height_lift:new a.cj(p),u_image:new a.ch(p),u_texsize:new a.ck(p),u_pixel_coord_upper:new a.ck(p),u_pixel_coord_lower:new a.ck(p),u_tile_units_to_pixels:new a.cj(p),u_opacity:new a.cj(p),u_pattern_transition:new a.cj(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new a.cl(p),u_opacity:new a.cj(p),u_ao_pass:new a.cj(p),u_meter_to_tile:new a.cj(p),u_ao:new a.ck(p),u_flood_light_intensity:new a.cj(p),u_flood_light_color:new a.ci(p),u_attenuation:new a.cj(p),u_edge_radius:new a.cj(p),u_fb:new a.ch(p),u_fb_size:new a.cj(p),u_dynamic_offset:new a.cj(p)}),fill:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_ground_shadow_factor:new a.ci(p)}),fillPattern:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_image:new a.ch(p),u_texsize:new a.ck(p),u_pixel_coord_upper:new a.ck(p),u_pixel_coord_lower:new a.ck(p),u_tile_units_to_pixels:new a.cj(p),u_ground_shadow_factor:new a.ci(p),u_pattern_transition:new a.cj(p)}),fillOutline:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_world:new a.ck(p),u_ground_shadow_factor:new a.ci(p)}),fillOutlinePattern:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_world:new a.ck(p),u_image:new a.ch(p),u_texsize:new a.ck(p),u_pixel_coord_upper:new a.ck(p),u_pixel_coord_lower:new a.ck(p),u_tile_units_to_pixels:new a.cj(p),u_ground_shadow_factor:new a.ci(p),u_pattern_transition:new a.cj(p)}),building:p=>({u_matrix:new a.cl(p),u_normal_matrix:new a.cl(p),u_opacity:new a.cj(p),u_faux_facade_ao_intensity:new a.cj(p),u_camera_pos:new a.ci(p),u_tile_to_meter:new a.cj(p),u_facade_emissive_chance:new a.cj(p),u_flood_light_color:new a.ci(p),u_flood_light_intensity:new a.cj(p)}),buildingBloom:p=>({u_matrix:new a.cl(p)}),buildingDepth:p=>({u_matrix:new a.cl(p)}),elevatedStructuresDepth:p=>({u_matrix:new a.cl(p),u_depth_bias:new a.cj(p)}),elevatedStructures:p=>({u_matrix:new a.cl(p),u_ground_shadow_factor:new a.ci(p)}),elevatedStructuresDepthReconstruct:p=>({u_matrix:new a.cl(p),u_camera_pos:new a.ci(p),u_depth_bias:new a.cj(p),u_height_scale:new a.cj(p),u_reset_depth:new a.cj(p)}),circle:a.dY,collisionBox:p=>({u_matrix:new a.cl(p),u_inv_rot_matrix:new a.cl(p),u_camera_to_center_distance:new a.cj(p),u_extrude_scale:new a.ck(p),u_zoom_transition:new a.cj(p),u_merc_center:new a.ck(p),u_tile_id:new a.ci(p)}),collisionCircle:p=>({u_matrix:new a.cl(p),u_inv_matrix:new a.cl(p),u_camera_to_center_distance:new a.cj(p),u_viewport_size:new a.ck(p)}),debug:p=>({u_color:new a.dB(p),u_matrix:new a.cl(p),u_overlay:new a.ch(p),u_overlay_scale:new a.cj(p)}),clippingMask:p=>({u_matrix:new a.cl(p)}),heatmap:p=>({u_extrude_scale:new a.cj(p),u_intensity:new a.cj(p),u_matrix:new a.cl(p),u_inv_rot_matrix:new a.cl(p),u_merc_center:new a.ck(p),u_tile_id:new a.ci(p),u_zoom_transition:new a.cj(p),u_up_dir:new a.ci(p)}),heatmapTexture:p=>({u_image:new a.ch(p),u_color_ramp:new a.ch(p),u_opacity:new a.cj(p)}),hillshade:p=>({u_matrix:new a.cl(p),u_image:new a.ch(p),u_latrange:new a.ck(p),u_light:new a.ck(p),u_shadow:new a.dB(p),u_highlight:new a.dB(p),u_emissive_strength:new a.cj(p),u_accent:new a.dB(p)}),hillshadePrepare:p=>({u_matrix:new a.cl(p),u_image:new a.ch(p),u_dimension:new a.ck(p),u_zoom:new a.cj(p)}),line:a.dX,linePattern:a.dW,raster:p=>({u_matrix:new a.cl(p),u_normalize_matrix:new a.cl(p),u_globe_matrix:new a.cl(p),u_merc_matrix:new a.cl(p),u_grid_matrix:new a.dC(p),u_tl_parent:new a.ck(p),u_scale_parent:new a.cj(p),u_fade_t:new a.cj(p),u_opacity:new a.cj(p),u_image0:new a.ch(p),u_image1:new a.ch(p),u_brightness_low:new a.cj(p),u_brightness_high:new a.cj(p),u_saturation_factor:new a.cj(p),u_contrast_factor:new a.cj(p),u_spin_weights:new a.ci(p),u_perspective_transform:new a.ck(p),u_raster_elevation:new a.cj(p),u_zoom_transition:new a.cj(p),u_merc_center:new a.ck(p),u_cutoff_params:new a.d3(p),u_colorization_mix:new a.d3(p),u_colorization_offset:new a.cj(p),u_color_ramp:new a.ch(p),u_texture_offset:new a.ck(p),u_texture_res:new a.ck(p),u_emissive_strength:new a.cj(p)}),rasterParticle:p=>({u_matrix:new a.cl(p),u_normalize_matrix:new a.cl(p),u_globe_matrix:new a.cl(p),u_merc_matrix:new a.cl(p),u_grid_matrix:new a.dC(p),u_tl_parent:new a.ck(p),u_scale_parent:new a.cj(p),u_fade_t:new a.cj(p),u_opacity:new a.cj(p),u_image0:new a.ch(p),u_image1:new a.ch(p),u_raster_elevation:new a.cj(p),u_zoom_transition:new a.cj(p),u_merc_center:new a.ck(p),u_cutoff_params:new a.d3(p)}),rasterParticleTexture:p=>({u_texture:new a.ch(p),u_opacity:new a.cj(p)}),rasterParticleDraw:p=>({u_particle_texture:new a.ch(p),u_particle_texture_side_len:new a.cj(p),u_tile_offset:new a.ck(p),u_velocity:new a.ch(p),u_color_ramp:new a.ch(p),u_velocity_res:new a.ck(p),u_max_speed:new a.cj(p),u_uv_offset:new a.ck(p),u_data_scale:new a.ck(p),u_data_offset:new a.cj(p),u_particle_pos_scale:new a.cj(p),u_particle_pos_offset:new a.ck(p)}),rasterParticleUpdate:p=>({u_particle_texture:new a.ch(p),u_particle_texture_side_len:new a.cj(p),u_velocity:new a.ch(p),u_velocity_res:new a.ck(p),u_max_speed:new a.cj(p),u_speed_factor:new a.cj(p),u_reset_rate:new a.cj(p),u_rand_seed:new a.cj(p),u_uv_offset:new a.ck(p),u_data_scale:new a.ck(p),u_data_offset:new a.cj(p),u_particle_pos_scale:new a.cj(p),u_particle_pos_offset:new a.ck(p)}),symbol:p=>({u_is_size_zoom_constant:new a.ch(p),u_is_size_feature_constant:new a.ch(p),u_size_t:new a.cj(p),u_size:new a.cj(p),u_camera_to_center_distance:new a.cj(p),u_rotate_symbol:new a.ch(p),u_aspect_ratio:new a.cj(p),u_fade_change:new a.cj(p),u_matrix:new a.cl(p),u_label_plane_matrix:new a.cl(p),u_coord_matrix:new a.cl(p),u_is_text:new a.ch(p),u_elevation_from_sea:new a.ch(p),u_pitch_with_map:new a.ch(p),u_texsize:new a.ck(p),u_texsize_icon:new a.ck(p),u_texture:new a.ch(p),u_texture_icon:new a.ch(p),u_gamma_scale:new a.cj(p),u_device_pixel_ratio:new a.cj(p),u_tile_id:new a.ci(p),u_zoom_transition:new a.cj(p),u_inv_rot_matrix:new a.cl(p),u_merc_center:new a.ck(p),u_camera_forward:new a.ci(p),u_tile_matrix:new a.cl(p),u_up_vector:new a.ci(p),u_ecef_origin:new a.ci(p),u_is_halo:new a.ch(p),u_icon_transition:new a.cj(p),u_color_adj_mat:new a.cl(p),u_scale_factor:new a.cj(p),u_ground_shadow_factor:new a.ci(p),u_inv_matrix:new a.cl(p),u_normal_scale:new a.cj(p),u_lutTexture:new a.ch(p)}),background:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_opacity:new a.cj(p),u_color:new a.dB(p)}),backgroundPattern:p=>({u_matrix:new a.cl(p),u_emissive_strength:new a.cj(p),u_opacity:new a.cj(p),u_image:new a.ch(p),u_pattern_tl:new a.ck(p),u_pattern_br:new a.ck(p),u_texsize:new a.ck(p),u_pattern_size:new a.ck(p),u_pixel_coord_upper:new a.ck(p),u_pixel_coord_lower:new a.ck(p),u_pattern_units_to_pixels:new a.ck(p)}),terrainRaster:p=>({u_matrix:new a.cl(p),u_image0:new a.ch(p),u_image1:new a.ch(p),u_skirt_height:new a.cj(p),u_ground_shadow_factor:new a.ci(p),u_emissive_texture_available:new a.cj(p)}),skybox:p=>({u_matrix:new a.cl(p),u_sun_direction:new a.ci(p),u_cubemap:new a.ch(p),u_opacity:new a.cj(p),u_temporal_offset:new a.cj(p)}),skyboxGradient:p=>({u_matrix:new a.cl(p),u_color_ramp:new a.ch(p),u_center_direction:new a.ci(p),u_radius:new a.cj(p),u_opacity:new a.cj(p),u_temporal_offset:new a.cj(p)}),skyboxCapture:p=>({u_matrix_3f:new a.dC(p),u_sun_direction:new a.ci(p),u_sun_intensity:new a.cj(p),u_color_tint_r:new a.d3(p),u_color_tint_m:new a.d3(p),u_luminance:new a.cj(p)}),globeRaster:p=>({u_proj_matrix:new a.cl(p),u_globe_matrix:new a.cl(p),u_normalize_matrix:new a.cl(p),u_merc_matrix:new a.cl(p),u_zoom_transition:new a.cj(p),u_merc_center:new a.ck(p),u_image0:new a.ch(p),u_image1:new a.ch(p),u_grid_matrix:new a.dC(p),u_skirt_height:new a.cj(p),u_far_z_cutoff:new a.cj(p),u_frustum_tl:new a.ci(p),u_frustum_tr:new a.ci(p),u_frustum_br:new a.ci(p),u_frustum_bl:new a.ci(p),u_globe_pos:new a.ci(p),u_globe_radius:new a.cj(p),u_viewport:new a.ck(p),u_emissive_texture_available:new a.cj(p)}),globeAtmosphere:p=>({u_frustum_tl:new a.ci(p),u_frustum_tr:new a.ci(p),u_frustum_br:new a.ci(p),u_frustum_bl:new a.ci(p),u_horizon:new a.cj(p),u_transition:new a.cj(p),u_fadeout_range:new a.cj(p),u_atmosphere_fog_color:new a.d3(p),u_high_color:new a.d3(p),u_space_color:new a.d3(p),u_temporal_offset:new a.cj(p),u_horizon_angle:new a.cj(p)}),model:p=>({u_matrix:new a.cl(p),u_lighting_matrix:new a.cl(p),u_normal_matrix:new a.cl(p),u_node_matrix:new a.cl(p),u_lightpos:new a.ci(p),u_lightintensity:new a.cj(p),u_lightcolor:new a.ci(p),u_camera_pos:new a.ci(p),u_opacity:new a.cj(p),u_baseColorFactor:new a.d3(p),u_emissiveFactor:new a.d3(p),u_metallicFactor:new a.cj(p),u_roughnessFactor:new a.cj(p),u_baseTextureIsAlpha:new a.ch(p),u_alphaMask:new a.ch(p),u_alphaCutoff:new a.cj(p),u_baseColorTexture:new a.ch(p),u_metallicRoughnessTexture:new a.ch(p),u_normalTexture:new a.ch(p),u_occlusionTexture:new a.ch(p),u_emissionTexture:new a.ch(p),u_lutTexture:new a.ch(p),u_color_mix:new a.d3(p),u_aoIntensity:new a.cj(p),u_emissive_strength:new a.cj(p),u_occlusionTextureTransform:new a.d3(p)}),modelDepth:p=>({u_matrix:new a.cl(p),u_instance:new a.cl(p),u_node_matrix:new a.cl(p)}),groundShadow:p=>({u_matrix:new a.cl(p),u_ground_shadow_factor:new a.ci(p)}),stars:p=>({u_matrix:new a.cl(p),u_up:new a.ci(p),u_right:new a.ci(p),u_intensity_multiplier:new a.cj(p)}),snowParticle:p=>({u_modelview:new a.cl(p),u_projection:new a.cl(p),u_time:new a.cj(p),u_cam_pos:new a.ci(p),u_velocityConeAperture:new a.cj(p),u_velocity:new a.cj(p),u_horizontalOscillationRadius:new a.cj(p),u_horizontalOscillationRate:new a.cj(p),u_boxSize:new a.cj(p),u_billboardSize:new a.cj(p),u_simpleShapeParameters:new a.ck(p),u_screenSize:new a.ck(p),u_thinningCenterPos:new a.ck(p),u_thinningShape:new a.ci(p),u_thinningAffectedRatio:new a.cj(p),u_thinningParticleOffset:new a.cj(p),u_particleColor:new a.d3(p),u_direction:new a.ci(p)}),rainParticle:p=>({u_modelview:new a.cl(p),u_projection:new a.cl(p),u_time:new a.cj(p),u_cam_pos:new a.ci(p),u_texScreen:new a.ch(p),u_velocityConeAperture:new a.cj(p),u_velocity:new a.cj(p),u_boxSize:new a.cj(p),u_rainDropletSize:new a.ck(p),u_distortionStrength:new a.cj(p),u_rainDirection:new a.ci(p),u_color:new a.d3(p),u_screenSize:new a.ck(p),u_thinningCenterPos:new a.ck(p),u_thinningShape:new a.ci(p),u_thinningAffectedRatio:new a.cj(p),u_thinningParticleOffset:new a.cj(p),u_shapeDirectionalPower:new a.cj(p),u_shapeNormalPower:new a.cj(p),u_mode:new a.cj(p)}),vignette:p=>({u_vignetteShape:new a.ci(p),u_vignetteColor:new a.d3(p)}),occlusion:p=>({u_matrix:new a.cl(p),u_anchorPos:new a.ci(p),u_screenSizePx:new a.ck(p),u_occluderSizePx:new a.ck(p),u_color:new a.d3(p)})};class Bo{constructor(n,u,m,x){this.id=Bo.uniqueIdxCounter,Bo.uniqueIdxCounter++,this.context=n;const A=n.gl;this.buffer=A.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),A.bufferData(A.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||x||u.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=Bo.uniqueIdxCounter,Bo.uniqueIdxCounter++;const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Bo.uniqueIdxCounter=0;const Rs={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Na{constructor(n,u,m,x,A,S){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.instanceCount=S,this.context=n;const O=n.gl;this.buffer=O.createBuffer(),n.bindVertexBuffer.set(this.buffer),O.bufferData(O.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?O.DYNAMIC_DRAW:O.STATIC_DRAW),this.dynamicDraw||A||u.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let m=0;m<this.attributes.length;m++){const x=u.getAttributeLocation(n,this.attributes[m].name);x!==-1&&n.enableVertexAttribArray(x)}}setVertexAttribPointers(n,u,m){for(let x=0;x<this.attributes.length;x++){const A=this.attributes[x],S=u.getAttributeLocation(n,A.name);S!==-1&&n.vertexAttribPointer(S,A.components,n[Rs[A.type]],!1,this.itemSize,A.offset+this.itemSize*(m||0))}}setVertexAttribDivisor(n,u,m){for(let x=0;x<this.attributes.length;x++){const A=u.getAttributeLocation(n,this.attributes[x].name);A!==-1&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(A,m)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ic{constructor(n,u,m,x,A){this.context=n,this.width=u,this.height=m;const S=this.framebuffer=n.gl.createFramebuffer();x>0&&(this.colorAttachment0=new hp(n,S,0)),x>1&&(this.colorAttachment1=new hp(n,S,1)),A&&(this.depthAttachmentType=A,this.depthAttachment=A==="renderbuffer"?new Kd(n,S):new dp(n,S))}createColorAttachment(n,u){u===0?this.colorAttachment0=new hp(n,this.framebuffer,0):u===1&&(this.colorAttachment1=new hp(n,this.framebuffer,1))}removeColorAttachment(n,u){const m=this.context.gl;let x;u===0?(x=this.colorAttachment0.get(),this.colorAttachment0=void 0):u===1&&(x=this.colorAttachment1.get(),this.colorAttachment1=void 0),x&&m.deleteTexture(x)}destroy(){const n=this.context.gl;if(this.colorAttachment0){const u=this.colorAttachment0.get();u&&n.deleteTexture(u)}if(this.colorAttachment1){const u=this.colorAttachment1.get();u&&n.deleteTexture(u)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const u=this.depthAttachment.get();u&&n.deleteRenderbuffer(u)}else{const u=this.depthAttachment.get();u&&n.deleteTexture(u)}n.deleteFramebuffer(this.framebuffer)}}class xl{constructor(n,u){this.gl=n,this.clearColor=new Ac(this),this.clearDepth=new Nl(this),this.clearStencil=new jl(this),this.colorMask=new sp(this),this.depthMask=new lp(this),this.stencilMask=new au(this),this.stencilFunc=new Xh(this),this.stencilOp=new Fa(this),this.stencilTest=new Fi(this),this.depthRange=new ci(this),this.depthTest=new Tc(this),this.depthFunc=new Js(this),this.blend=new Wu(this),this.blendFunc=new Ul(this),this.blendColor=new cp(this),this.blendEquation=new jm(this),this.cullFace=new ou(this),this.cullFaceSide=new Vl(this),this.frontFace=new Um(this),this.program=new Wd(this),this.activeTexture=new Vm(this),this.viewport=new vl(this),this.bindFramebuffer=new Sc(this),this.bindRenderbuffer=new Yu(this),this.bindTexture=new su(this),this.bindVertexBuffer=new f_(this),this.bindElementBuffer=new up(this),this.bindVertexArrayOES=new Ku(this),this.pixelStoreUnpack=new Yd(this),this.pixelStoreUnpackPremultiplyAlpha=new lu(this),this.pixelStoreUnpackFlipY=new bo(this),this.options=u?Object.assign({},u):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=u&&!!u.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.extBlendFuncExtended=n.getExtension("WEBGL_blend_func_extended")}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u,m){return new Bo(this,n,u,m)}createVertexBuffer(n,u,m,x,A){return new Na(this,n,u,m,x,A)}createRenderbuffer(n,u,m){const x=this.gl,A=x.createRenderbuffer();return this.bindRenderbuffer.set(A),x.renderbufferStorage(x.RENDERBUFFER,n,u,m),this.bindRenderbuffer.set(null),A}createFramebuffer(n,u,m,x){return new Ic(this,n,u,m,x)}clear({color:n,depth:u,stencil:m,colorMask:x}){const A=this.gl;let S=0;n&&(S|=A.COLOR_BUFFER_BIT,this.clearColor.set(n.toNonPremultipliedRenderColor(null)),this.colorMask.set(x||[!0,!0,!0,!0])),u!==void 0&&(S|=A.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),m!==void 0&&(S|=A.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),A.clear(S)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){a.by(n.blendFunction,zr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let jt;function Ni(p,n,u,m,x,A,S){const O=p.context,D=O.gl,F=p.transform,N=[a.aF(F.center.lng),a.aJ(F.center.lat)],Z=u.layout.get("symbol-placement"),$=u.layout.get("text-variable-anchor"),W=u.layout.get("icon-rotation-alignment")==="map",ne=u.layout.get("text-rotation-alignment")==="map",te=Z!=="point",ae=[];let le=0,be=0;for(let Me=0;Me<m.length;Me++){const Te=m[Me],Ne=n.getTile(Te),Ve=Ne.getBucket(u);if(!Ve)continue;const He=Ve.getProjection().createInversionMatrix(F,Te.canonical),Qe=[],We=n_(Te,Ve,F),ut=!S&&W&&te,wt=S&&ne&&te,et=$&&Ve.hasTextData(),je=Ve.hasIconTextFit()&&et&&Ve.hasIconData(),mt=ut||wt||S&&et||je,ot=Ve.projection.name==="globe",bt=ot?a.aj(F.zoom):0;ot&&(Qe.push("PROJECTION_GLOBE_VIEW"),mt&&Qe.push("PROJECTED_POS_ON_VIEWPORT"));const zt=p.getOrCreateProgram("collisionBox",{defines:Qe});let qt=We;x[0]===0&&x[1]===0||(qt=p.translatePosMatrix(We,Ne,x,A));const kt=S?Ve.textCollisionBox:Ve.iconCollisionBox,Lt=Ve.collisionCircleArray;if(Lt.length>0){const sr=a.bC(),Zt=qt;a.cP(sr,Ve.placementInvProjMatrix,F.glCoordMatrix),a.cP(sr,sr,Ve.placementViewportMatrix),ae.push({circleArray:Lt,circleOffset:be,transform:Zt,invTransform:sr,projection:Ve.getProjection()}),le+=Lt.length/4,be=le}if(!kt)continue;p.terrain&&p.terrain.setupElevationDraw(Ne,zt);const hr=ot?[Te.canonical.x,Te.canonical.y,1<<Te.canonical.z]:[0,0,0];zt.draw(p,D.LINES,mr.disabled,Rr.disabled,p.colorModeForRenderPass(),Cr.disabled,xp(qt,He,F,bt,N,Ne,hr,Ve.getProjection()),u.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,null,F.zoom,null,[kt.collisionVertexBuffer,kt.collisionVertexBufferExt])}if(!S||!ae.length)return;const xe=p.getOrCreateProgram("collisionCircle"),ye=new a.dZ;ye.resize(4*le),ye._trim();let Re=0;for(const Me of ae)for(let Te=0;Te<Me.circleArray.length/4;Te++){const Ne=4*Te,Ve=Me.circleArray[Ne+0],He=Me.circleArray[Ne+1],Qe=Me.circleArray[Ne+2],We=Me.circleArray[Ne+3];ye.emplace(Re++,Ve,He,Qe,We,0),ye.emplace(Re++,Ve,He,Qe,We,1),ye.emplace(Re++,Ve,He,Qe,We,2),ye.emplace(Re++,Ve,He,Qe,We,3)}(!jt||jt.length<2*le)&&(jt=(function(Me){const Te=2*Me,Ne=new a.b0;Ne.resize(Te),Ne._trim();for(let Ve=0;Ve<Te;Ve++){const He=6*Ve;Ne.uint16[He+0]=4*Ve+0,Ne.uint16[He+1]=4*Ve+1,Ne.uint16[He+2]=4*Ve+2,Ne.uint16[He+3]=4*Ve+2,Ne.uint16[He+4]=4*Ve+3,Ne.uint16[He+5]=4*Ve+0}return Ne})(le));const Ce=O.createIndexBuffer(jt,!0),De=O.createVertexBuffer(ye,a.d_.members,!0);for(const Me of ae){const Te=of(Me.transform,Me.invTransform,F,Me.projection);xe.draw(p,D.TRIANGLES,mr.disabled,Rr.disabled,p.colorModeForRenderPass(),Cr.disabled,Te,u.id,De,Ce,a.bg.simpleSegment(0,2*Me.circleOffset,Me.circleArray.length,Me.circleArray.length/2),null,F.zoom)}De.destroy(),Ce.destroy()}const ji=a.bC();function bl(p){const n=p._camera.getWorldToCamera(p.worldSize,1),u=a.aB([],n,p.globeMatrix);a.bl(u,u);const m=[0,0,0],x=[0,1,0,0];return a.aC(x,x,u),m[0]=x[0],m[1]=x[1],m[2]=x[2],a.aw(m,m),m}function nd({width:p,height:n,anchor:u,textOffset:m,textScale:x},A){const{horizontalAlign:S,verticalAlign:O}=a.c1(u),D=-(S-.5)*p,F=-(O-.5)*n,N=a.c2(u,m);return new a.P((D/x+N[0])*A,(F/x+N[1])*A)}function rh(p,n,u,m,x,A,S,O,D,F){const N=p.text.placedSymbolArray,Z=p.text.dynamicLayoutVertexArray,$=p.icon.dynamicLayoutVertexArray,W={},ne=p.getProjection(),te=yc(S,ne,x),ae=x.elevation,le=ne.upVectorScale(S.canonical,x.center.lat,x.worldSize).metersToTile;Z.clear();for(let be=0;be<N.length;be++){const xe=N.get(be),{tileAnchorX:ye,tileAnchorY:Re,numGlyphs:Ce}=xe,De=xe.hidden||!xe.crossTileID||p.allowVerticalPlacement&&!xe.placedOrientation?null:m[xe.crossTileID];if(De){let Me=0,Te=0,Ne=0;const Ve=p.elevationType==="road";if(ae||Ve){const ot=Ve?p.getElevationFeatureForText(be):null,bt=a.bV.getAtTileOffset(S,new a.P(ye,Re),ae,ot),[zt,qt,kt]=ne.upVector(S.canonical,ye,Re);Me=bt*zt*le,Te=bt*qt*le,Ne=bt*kt*le}let[He,Qe,We,ut]=_l(xe.projectedAnchorX+Me,xe.projectedAnchorY+Te,xe.projectedAnchorZ+Ne,u?te:A);const wt=Em(x.getCameraToCenterDistance(ne),ut);let et=a.bM(p.textSizeData,D,xe)*wt/a.bY;u&&(et*=p.tilePixelRatio/O);const je=nd(De,et);u?({x:He,y:Qe,z:We}=ne.projectTilePoint(ye+je.x,Re+je.y,S.canonical),[He,Qe,We]=_l(He+Me,Qe+Te,We+Ne,A)):(n&&je._rotate(-x.angle),He+=je.x,Qe+=je.y,We=0);const mt=p.allowVerticalPlacement&&xe.placedOrientation===a.bL.vertical?Math.PI/2:0;for(let ot=0;ot<Ce;ot++)a.bO(Z,He,Qe,We,mt);F&&xe.associatedIconIndex>=0&&(W[xe.associatedIconIndex]={x:He,y:Qe,z:We,angle:mt})}else vo(Ce,Z)}if(F){$.clear();const be=p.icon.placedSymbolArray;for(let xe=0;xe<be.length;xe++){const ye=be.get(xe),{numGlyphs:Re}=ye,Ce=W[xe];if(ye.hidden||!Ce)vo(Re,$);else{const{x:De,y:Me,z:Te,angle:Ne}=Ce;for(let Ve=0;Ve<Re;Ve++)a.bO($,De,Me,Te,Ne)}}p.icon.dynamicLayoutVertexBuffer.updateData($)}p.text.dynamicLayoutVertexBuffer.updateData(Z)}function id(p,n,u,m,x,A,S={}){const O=u.paint.get("icon-translate"),D=u.paint.get("text-translate"),F=u.paint.get("icon-translate-anchor"),N=u.paint.get("text-translate-anchor"),Z=u.layout.get("icon-rotation-alignment"),$=u.layout.get("text-rotation-alignment"),W=u.layout.get("icon-pitch-alignment"),ne=u.layout.get("text-pitch-alignment"),te=u.layout.get("icon-keep-upright"),ae=u.layout.get("text-keep-upright"),le=u.paint.get("icon-color-saturation"),be=u.paint.get("icon-color-contrast"),xe=u.paint.get("icon-color-brightness-min"),ye=u.paint.get("icon-color-brightness-max"),Re=u.layout.get("symbol-elevation-reference")==="sea",Ce=u.layout.get("icon-image-use-theme")==="none",De=p.context,Me=De.gl,Te=p.transform,Ne=Z==="map",Ve=$==="map",He=W==="map",Qe=ne==="map",We=u.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ut=!1;const wt=p.depthModeForSublayer(0,mr.ReadOnly),et=new mr(p.context.gl.LEQUAL,mr.ReadOnly,p.depthRangeFor3D),je=[a.aF(Te.center.lng),a.aJ(Te.center.lat)],mt=u.layout.get("text-variable-anchor"),ot=Te.projection.name==="globe",bt=[],zt=[0,-1,0];for(const qt of m){const kt=n.getTile(qt),Lt=kt.getBucket(u);if(!Lt||Lt.projection.name==="mercator"&&ot||Lt.fullyClipped)continue;const hr=Lt.projection.name==="globe",sr=hr?a.aj(Te.zoom):0,Zt=yc(qt,Lt.getProjection(),Te),lr=Te.calculatePixelsToTileUnitsMatrix(kt),xr=mt&&Lt.hasTextData(),Ir=Lt.hasIconTextFit()&&xr&&Lt.hasIconData(),Vr=Lt.getProjection().createInversionMatrix(Te,qt.canonical),tn=(1<<kt.tileID.canonical.z)*a.al/p.transform.worldSize,Pr=wn=>{let Nr=[0,0,0];if(wn){const qr=p.style.directionalLight,Kn=p.style.ambientLight;qr&&Kn&&(Nr=Wo(p.style,qr,Kn))}return Nr},Gr=wn=>{Te.depthOcclusionForSymbolsAndCircles&&(u.hasOcclusionOpacityProperties||p.terrain)&&(wn.push("DEPTH_D24"),wn.push("DEPTH_OCCLUSION"))},Lr=wn=>{u.lut&&!Ce&&(u.lut.texture||(u.lut.texture=new a.d$(p.context,u.lut.image,[u.lut.image.height,u.lut.image.height,u.lut.image.height],De.gl.RGBA8)),De.activeTexture.set(De.gl.TEXTURE0+10),u.lut.texture&&u.lut.texture.bind(De.gl.LINEAR,De.gl.CLAMP_TO_EDGE),wn.push("APPLY_LUT_ON_GPU"))},yn=()=>{const wn=Ne&&u.layout.get("symbol-placement")!=="point",Nr=[];Gr(Nr),Lr(Nr);const qr=wn||Ir,Kn=Lt.elevationType==="road",Ii=p.shadowRenderer,kn=Kn&&He&&!!Ii&&Ii.enabled,Qn=Pr(kn),Ao=Kn&&He&&!p.terrain?et:wt,Ka=u.paint.get("icon-image-cross-fade");p.terrainRenderModeElevated()&&He&&Nr.push("PITCH_WITH_MAP_TERRAIN"),hr&&(Nr.push("PROJECTION_GLOBE_VIEW"),qr&&Nr.push("PROJECTED_POS_ON_VIEWPORT")),Ka>0&&Lt.hasAnySecondaryIcon&&Nr.push("ICON_TRANSITION"),!Lt.icon.zOffsetVertexBuffer||Kn&&p.terrain||Nr.push("Z_OFFSET"),le===0&&be===0&&xe===0&&ye===1||Nr.push("COLOR_ADJUSTMENT"),Lt.sdfIcons&&Nr.push("RENDER_SDF"),kn&&Nr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Kn&&He&&!p.terrain&&Lt.icon.orientationVertexBuffer&&Nr.push("ELEVATED_ROADS");const Oa=Lt.icon.programConfigurations.get(u.id),An=p.getOrCreateProgram("symbol",{config:Oa,defines:Nr}),ms=kt.imageAtlasTexture?kt.imageAtlasTexture.size:[0,0],Qa=Lt.iconSizeData,so=a.bK(Qa,Te.zoom),Fs=He||!Te.isOrthographic,Jo=Fh(Zt,kt.tileID.canonical,He,Ne,Te,Lt.getProjection(),lr),xi=Do(Zt,kt.tileID.canonical,He,Ne,Te,Lt.getProjection(),lr),Hi=p.translatePosMatrix(xi,kt,O,F,!0),ri=p.translatePosMatrix(Zt,kt,O,F),Ji=qr?ji:Jo,ba=Ne&&!He&&!wn;let Ei=zt;!ot&&!Te.mercatorFromTransition||Ne||(Ei=bl(Te));const gs=hr?Ei:zt,Af=u.getColorAdjustmentMatrix(le,be,xe,ye),Jl=td(Qa.kind,so,ba,He,p,ri,Ji,Hi,Re,!1,ms,[0,0],0,qt,sr,je,Vr,gs,Lt.getProjection(),Qn,tn,Af,Ka,null),_d=kt.imageAtlasTexture?kt.imageAtlasTexture:null,yd=u.layout.get("icon-size").constantOr(0)!==1||Lt.iconsNeedLinear,_s=Lt.sdfIcons||p.options.rotating||p.options.zooming||yd||Fs?Me.LINEAR:Me.NEAREST,nl=Lt.sdfIcons&&u.paint.get("icon-halo-width").constantOr(1)!==0,ec=p.terrain&&He&&wn?a.bl(a.bC(),Jo):ji;if(wn&&Lt.icon){const Ns=a.bV.getAtTileOffsetFunc(qt,Te.center.lat,Te.worldSize,Lt.getProjection()),oi=Qc(Zt,kt.tileID.canonical,He,Ne,Te,Lt.getProjection(),lr),bu=u.layout.get("icon-size-scale-range"),dg=a.aA(p.scaleFactor,bu[0],bu[1]);Cn(Lt,Zt,p,!1,oi,xi,He,te,Ns,qt,dg)}return{program:An,buffers:Lt.icon,uniformValues:Jl,atlasTexture:_d,atlasTextureIcon:null,atlasInterpolation:_s,atlasInterpolationIcon:null,isSDF:Lt.sdfIcons,hasHalo:nl,depthMode:Ao,tile:kt,renderWithShadows:kn,labelPlaneMatrixInv:ec}},hn=()=>{const wn=Ve&&u.layout.get("symbol-placement")!=="point",Nr=[],qr=wn||mt||Ir,Kn=Lt.elevationType==="road",Ii=p.shadowRenderer,kn=Kn&&Qe&&!!Ii&&Ii.enabled,Qn=Pr(kn),Ao=Kn&&Qe&&!p.terrain?et:wt;p.terrainRenderModeElevated()&&Qe&&Nr.push("PITCH_WITH_MAP_TERRAIN"),hr&&(Nr.push("PROJECTION_GLOBE_VIEW"),qr&&Nr.push("PROJECTED_POS_ON_VIEWPORT")),!Lt.text.zOffsetVertexBuffer||Kn&&p.terrain||Nr.push("Z_OFFSET"),Lt.iconsInText&&Nr.push("RENDER_TEXT_AND_SYMBOL"),Nr.push("RENDER_SDF"),kn&&Nr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Kn&&Qe&&!p.terrain&&Lt.text.orientationVertexBuffer&&Nr.push("ELEVATED_ROADS"),Gr(Nr);const Ka=Lt.text.programConfigurations.get(u.id),Oa=p.getOrCreateProgram("symbol",{config:Ka,defines:Nr});let An,ms=[0,0],Qa=null;const so=Lt.textSizeData;Lt.iconsInText&&(ms=kt.imageAtlasTexture?kt.imageAtlasTexture.size:[0,0],Qa=kt.imageAtlasTexture?kt.imageAtlasTexture:null,An=Qe||!Te.isOrthographic||p.options.rotating||p.options.zooming||so.kind==="composite"||so.kind==="camera"?Me.LINEAR:Me.NEAREST);const Fs=kt.glyphAtlasTexture?kt.glyphAtlasTexture.size:[0,0],Jo=u.layout.get("text-size-scale-range"),xi=a.aA(p.scaleFactor,Jo[0],Jo[1]),Hi=a.bK(so,Te.zoom,xi),ri=Fh(Zt,kt.tileID.canonical,Qe,Ve,Te,Lt.getProjection(),lr),Ji=Do(Zt,kt.tileID.canonical,Qe,Ve,Te,Lt.getProjection(),lr),ba=p.translatePosMatrix(Ji,kt,D,N,!0),Ei=p.translatePosMatrix(Zt,kt,D,N),gs=qr?ji:ri,Af=Ve&&!Qe&&!wn;let Jl=zt;!ot&&!Te.mercatorFromTransition||Ve||(Jl=bl(Te));const _d=td(so.kind,Hi,Af,Qe,p,Ei,gs,ba,Re,!0,Fs,ms,0,qt,sr,je,Vr,hr?Jl:zt,Lt.getProjection(),Qn,tn,null,null,xi),yd=kt.glyphAtlasTexture?kt.glyphAtlasTexture:null,_s=Me.LINEAR,nl=u.paint.get("text-halo-width").constantOr(1)!==0,ec=p.terrain&&Qe&&wn?a.bl(a.bC(),ri):ji;if(wn&&Lt.text){const Ns=a.bV.getAtTileOffsetFunc(qt,Te.center.lat,Te.worldSize,Lt.getProjection()),oi=Qc(Zt,kt.tileID.canonical,Qe,Ve,Te,Lt.getProjection(),lr);Cn(Lt,Zt,p,!0,oi,Ji,Qe,ae,Ns,qt,xi)}return{program:Oa,buffers:Lt.text,uniformValues:_d,atlasTexture:yd,atlasTextureIcon:Qa,atlasInterpolation:_s,atlasInterpolationIcon:An,isSDF:!0,hasHalo:nl,depthMode:Ao,tile:kt,renderWithShadows:kn,labelPlaneMatrixInv:ec}},Pn=Lt.icon.segments.get().length,ln=Lt.text.segments.get().length,$r=Pn&&!S.onlyText?yn():null,mn=ln&&!S.onlyIcons?hn():null,hi=u.paint.get("icon-opacity").constantOr(1),Dn=u.paint.get("text-opacity").constantOr(1);if(We&&Lt.canOverlap){ut=!0;const wn=hi&&!S.onlyText?Lt.icon.segments.get():[],Nr=Dn&&!S.onlyIcons?Lt.text.segments.get():[];for(const qr of wn)bt.push({segments:new a.bg([qr]),sortKey:qr.sortKey,state:$r});for(const qr of Nr)bt.push({segments:new a.bg([qr]),sortKey:qr.sortKey,state:mn})}else S.onlyText||bt.push({segments:hi?Lt.icon.segments:new a.bg([]),sortKey:0,state:$r}),S.onlyIcons||bt.push({segments:Dn?Lt.text.segments:new a.bg([]),sortKey:0,state:mn})}ut&&bt.sort((qt,kt)=>qt.sortKey-kt.sortKey);for(const qt of bt){const kt=qt.state;if(kt)if(p.terrain?p.terrain.setupElevationDraw(kt.tile,kt.program,{useDepthForOcclusion:Te.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:kt.labelPlaneMatrixInv}):p.setupDepthForOcclusion(Te.depthOcclusionForSymbolsAndCircles,kt.program),De.activeTexture.set(Me.TEXTURE0),kt.atlasTexture&&kt.atlasTexture.bind(kt.atlasInterpolation,Me.CLAMP_TO_EDGE,!0),kt.atlasTextureIcon&&(De.activeTexture.set(Me.TEXTURE1),kt.atlasTextureIcon&&kt.atlasTextureIcon.bind(kt.atlasInterpolationIcon,Me.CLAMP_TO_EDGE,!0)),kt.renderWithShadows&&p.shadowRenderer.setupShadows(kt.tile.tileID.toUnwrapped(),kt.program,"vector-tile"),p.uploadCommonLightUniforms(p.context,kt.program),kt.hasHalo){const Lt=kt.uniformValues;Lt.u_is_halo=1,nh(kt.buffers,qt.segments,u,p,kt.program,kt.depthMode,x,A,Lt,2),Lt.u_is_halo=0}else{if(kt.isSDF){const Lt=kt.uniformValues;kt.hasHalo&&(Lt.u_is_halo=1,nh(kt.buffers,qt.segments,u,p,kt.program,kt.depthMode,x,A,Lt,1)),Lt.u_is_halo=0}nh(kt.buffers,qt.segments,u,p,kt.program,kt.depthMode,x,A,kt.uniformValues,1)}}}function nh(p,n,u,m,x,A,S,O,D,F){const N=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer,p.orientationVertexBuffer];x.draw(m,m.context.gl.TRIANGLES,A,S,O,Cr.disabled,D,u.id,p.layoutVertexBuffer,p.indexBuffer,n,u.paint,m.transform.zoom,p.programConfigurations.get(u.id),N,F)}function ih(p,n){const u=1<<p.canonical.z,m=(n.x*u-p.canonical.x-p.wrap*u)*a.al,x=(n.y*u-p.canonical.y)*a.al,A=a.e8(n.z,n.y);return a.d5(m,x,A)}function __(p,n,u,m,x){if(!u.layout||u.layout.get("fill-elevation-reference")==="none"||u.paint.get("fill-opacity").constantOr(1)===0)return;const A=p.context.gl,S=new mr(p.context.gl.LEQUAL,mr.ReadWrite,p.depthRangeFor3D),O=new mr(p.context.gl.GREATER,mr.ReadWrite,p.depthRangeFor3D),D=(function(W){let ne=.01;return W.isOrthographic&&(ne=a.ak(1e-4,ne,a.d0(W.pitch>=Ps?1:W.pitch/Ps))),2*ne})(p.transform),F=p.transform.getFreeCameraOptions().position,N="elevatedStructuresDepthReconstruct",Z=p.getOrCreateProgram(N,{defines:["DEPTH_RECONSTRUCTION"]}),$=p.getOrCreateProgram(N);for(const W of m){const ne=n.getTile(W),te=ne.getBucket(u);if(!te)continue;const ae=te.elevatedStructures;if(!ae)continue;const le=te.elevationBufferData.heightRange,be=ih(W.toUnwrapped(),F),xe=p.translatePosMatrix(W.projMatrix,ne,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));let ye,Re,Ce,De;if(x==="initialize"){if(!le||le.min>=1||ae.depthSegments.segments[0].primitiveLength===0)continue;ye=th(xe,be,D,1,0),Re=S,Ce=ae.depthSegments,De=Z}else if(x==="reset"){if(!le||le.min>=0||ae.maskSegments.segments[0].primitiveLength===0)continue;ye=th(xe,be,0,0,1),Re=O,Ce=ae.maskSegments,De=Z}else if(x==="geometry"){if(ae.depthSegments.segments[0].primitiveLength===0)continue;ye=th(xe,be,D,1,0),Re=S,Ce=ae.depthSegments,De=$}De.draw(p,A.TRIANGLES,Re,Rr.disabled,zr.disabled,Cr.disabled,ye,u.id,ae.vertexBuffer,ae.indexBuffer,Ce,u.paint,p.transform.zoom)}}function Ki(p,n,u,m){const{painter:x,sourceCache:A,layer:S,coords:O,colorMode:D,elevationType:F,terrainEnabled:N,pass:Z}=p,$=x.context.gl,W=S.paint.get("fill-pattern"),ne=S.paint.get("fill-pattern-cross-fade"),te=W.constantOr(null);let ae=F;F!=="road"||n&&!N||(ae="none");const le=ae==="road",be=p.painter.shadowRenderer,xe=le&&!!be&&be.enabled,ye=new mr(x.context.gl.LEQUAL,mr.ReadOnly,x.depthRangeFor3D);let Re=[0,0,0];if(xe){const Te=x.style.directionalLight,Ne=x.style.ambientLight;Te&&Ne&&(Re=Wo(x.style,Te,Ne))}const Ce=W&&W.constantOr(1),De=x.terrain&&x.terrain.renderingToTexture,Me=(Te,Ne)=>{let Ve,He,Qe,We,ut;Ne?(Ve=Ce&&!S.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Qe=$.LINES):(Ve=Ce?"fillPattern":"fill",Qe=$.TRIANGLES);for(const wt of O){const et=A.getTile(wt);if(Ce&&!et.patternsLoaded())continue;const je=et.getBucket(S);if(!je)continue;const mt=n?je.elevationBufferData:je.bufferData;if(mt.isEmpty())continue;x.prepareDrawTile();const ot=mt.programConfigurations.get(S.id),bt=x.isTileAffectedByFog(wt),zt=[],qt=[];le&&(zt.push("ELEVATED_ROADS"),qt.push(mt.elevatedLayoutVertexBuffer)),xe&&zt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),De&&u&&zt.push("USE_MRT1"),Ce&&(x.context.activeTexture.set($.TEXTURE0),et.imageAtlasTexture&&et.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ot.updatePaintBuffers());let kt=!1;if(te&&et.imageAtlas){const lr=et.imageAtlas,xr=a.e3.from(te),Ir=xr.getPrimary().scaleSelf(a.o.devicePixelRatio).toString(),Vr=xr.getSecondary(),tn=lr.patternPositions.get(Ir),Pr=Vr?lr.patternPositions.get(Vr.scaleSelf(a.o.devicePixelRatio).toString()):null;kt=!!tn&&!!Pr,tn&&ot.setConstantPatternPositions(tn,Pr)}ne>0&&(kt||ot.getPatternTransitionVertexBuffer("fill-pattern"))&&zt.push("FILL_PATTERN_TRANSITION");const Lt=x.getOrCreateProgram(Ve,{config:ot,overrideFog:bt,defines:zt}),hr=x.translatePosMatrix(wt.projMatrix,et,S.paint.get("fill-translate"),S.paint.get("fill-translate-anchor"));xe&&be.setupShadows(et.tileID.toUnwrapped(),Lt,"vector-tile");const sr=S.paint.get("fill-emissive-strength");if(Ne){We=mt.lineIndexBuffer,ut=mt.lineSegments;const lr=x.terrain&&x.terrain.renderingToTexture?x.terrain.drapeBufferSize:[$.drawingBufferWidth,$.drawingBufferHeight];He=Ve==="fillOutlinePattern"&&Ce?vp(hr,sr,x,et,lr,Re,ne):af(hr,sr,lr,Re)}else We=mt.indexBuffer,ut=mt.triangleSegments,He=Ce?eh(hr,sr,x,et,Re,ne):Ju(hr,sr,Re);x.uploadCommonUniforms(x.context,Lt,wt.toUnwrapped());let Zt=Te;(F==="road"&&!N||F==="offset")&&(Zt=ye),Lt.draw(x,Qe,Zt,m||x.stencilModeForClipping(wt),D,Cr.disabled,He,S.id,mt.layoutVertexBuffer,We,ut,S.paint,x.transform.zoom,ot,qt)}};x.renderPass===Z&&Me(x.depthModeForSublayer(1,x.renderPass==="opaque"?mr.ReadWrite:mr.ReadOnly),!1),ae==="none"&&x.renderPass==="translucent"&&S.paint.get("fill-antialias")&&Me(x.depthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,mr.ReadOnly),!0)}function ah(p,n,u,m,x,A,S,O){u.resetLayerRenderingStats(p);const D=p.context,F=D.gl,N=p.transform,Z=u.paint.get("fill-extrusion-pattern"),$=u.paint.get("fill-extrusion-pattern-cross-fade"),W=Z.constantOr(null),ne=Z.constantOr(1),te=u.paint.get("fill-extrusion-opacity"),ae=p.style.enable3dLights(),le=u.paint.get(ae&&!ne?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[u.paint.get("fill-extrusion-ambient-occlusion-intensity"),le],xe=u.layout.get("fill-extrusion-edge-radius"),ye=xe>0&&!u.paint.get("fill-extrusion-rounded-roof"),Re=ye?0:xe,Ce=N.projection.name==="globe"?a.eb():0,De=N.projection.name==="globe",Me=De?a.aj(N.zoom):0,Te=[a.aF(N.center.lng),a.aJ(N.center.lat)],Ne=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ve=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Ne?null:u.lut).toArray01().slice(0,3),He=u.paint.get("fill-extrusion-flood-light-intensity"),Qe=u.paint.get("fill-extrusion-vertical-scale"),We=u.paint.get("fill-extrusion-line-width").constantOr(1)!==0,ut=u.paint.get("fill-extrusion-height-alignment"),wt=u.paint.get("fill-extrusion-base-alignment"),et=Ys(p,u.paint.get("fill-extrusion-cutoff-fade-range")),je=[];let mt;De&&je.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&je.push("FAUX_AO"),ye&&je.push("ZERO_ROOF_RADIUS"),O&&je.push("HAS_CENTROID"),He>0&&je.push("FLOOD_LIGHT"),et.shouldRenderCutoff&&je.push("RENDER_CUTOFF"),We&&je.push("RENDER_WALL_MODE");const ot=p.renderPass==="shadow",bt=p.shadowRenderer,zt=ot&&!!bt,qt=ot?Cr.disabled:Cr.backCCW;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let kt=[0,0,0];if(bt){const sr=p.style.directionalLight,Zt=p.style.ambientLight;sr&&Zt&&(kt=Wo(p.style,sr,Zt)),ot||(je.push("RENDER_SHADOWS","DEPTH_TEXTURE"),bt.useNormalOffset&&je.push("NORMAL_OFFSET")),mt=je.concat(["SHADOWS_SINGLE_CASCADE"])}const Lt=zt?"fillExtrusionDepth":ne?"fillExtrusionPattern":"fillExtrusion",hr=u.getLayerRenderingStats();for(const sr of m){const Zt=n.getTile(sr),lr=Zt.getBucket(u);if(!lr||lr.projection.name!==N.projection.name)continue;let xr=!1;bt&&(xr=bt.getMaxCascadeForTile(sr.toUnwrapped())===0);const Ir=p.isTileAffectedByFog(sr),Vr=lr.programConfigurations.get(u.id);let tn=!1;if(W&&Zt.imageAtlas){const ln=Zt.imageAtlas,$r=a.e3.from(W),mn=$r.getPrimary().scaleSelf(a.o.devicePixelRatio).toString(),hi=$r.getSecondary(),Dn=ln.patternPositions.get(mn),wn=hi?ln.patternPositions.get(hi.scaleSelf(a.o.devicePixelRatio).toString()):null;tn=!!Dn&&!!wn,Dn&&Vr.setConstantPatternPositions(Dn,wn)}$>0&&(tn||Vr.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&je.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Pr=p.getOrCreateProgram(Lt,{config:Vr,defines:xr?mt:je,overrideFog:Ir});if(p.terrain&&p.terrain.setupElevationDraw(Zt,Pr,{useMeterToDem:!0}),!lr.centroidVertexBuffer){const ln=Pr.getAttributeLocation(F,"a_centroid_pos");ln!==-1&&F.vertexAttrib2f(ln,0,0)}!ot&&bt&&bt.setupShadows(Zt.tileID.toUnwrapped(),Pr,"vector-tile"),ne&&(p.context.activeTexture.set(F.TEXTURE0),Zt.imageAtlasTexture&&Zt.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Vr.updatePaintBuffers());const Gr=u.paint.get("fill-extrusion-vertical-gradient"),Lr=1/lr.tileToMeter;let yn;if(ot&&bt){if(Ap(Zt.tileID,lr.maxHeight,p))continue;const ln=bt.calculateShadowPassMatrixFromTile(Zt.tileID.toUnwrapped());yn=du(ln,Re,Lr,Qe,ut,wt)}else{const ln=p.translatePosMatrix(sr.expandedProjMatrix,Zt,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),$r=N.projection.createInversionMatrix(N,sr.canonical);yn=ne?m_(ln,p,Gr,te,be,Re,Lr,sr,Zt,Ce,ut,wt,Me,Te,$r,Ve,Qe,$):Ec(ln,p,Gr,te,be,Re,Lr,sr,Ce,ut,wt,Me,Te,$r,Ve,Qe,He,kt)}p.uploadCommonUniforms(D,Pr,sr.toUnwrapped(),null,et);let hn=lr.segments;if(N.projection.name==="mercator"&&!ot&&(hn=lr.getVisibleSegments(Zt.tileID,p.terrain,p.transform.getFrustum(0)),!hn.get().length))continue;if(hr)if(ot)for(const ln of hn.get())hr.numRenderedVerticesInShadowPass+=ln.primitiveLength;else for(const ln of hn.get())hr.numRenderedVerticesInTransparentPass+=ln.primitiveLength;const Pn=[];(p.terrain||O)&&Pn.push(lr.centroidVertexBuffer),De&&Pn.push(lr.layoutVertexExtBuffer),We&&Pn.push(lr.wallVertexBuffer),Pr.draw(p,D.gl.TRIANGLES,x,A,S,qt,yn,u.id,lr.layoutVertexBuffer,lr.indexBuffer,hn,u.paint,p.transform.zoom,Vr,Pn)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}class ad{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function ql(p,n,u,m,x,A,S,O,D,F,N,Z,$,W,ne,te,ae,le,be,xe){const ye=n.context,Re=ye.gl,Ce=n.transform,De=n.transform.zoom,Me=[],Te=p.translate,Ne=p.translateAnchor,Ve=p.edgeRadius,He=Ys(n,p.cutoffFadeRange);N==="clear"?(Me.push("CLEAR_SUBPASS"),xe&&(Me.push("CLEAR_FROM_TEXTURE"),ye.activeTexture.set(Re.TEXTURE0),xe.bind(Re.LINEAR,Re.CLAMP_TO_EDGE))):N==="sdf"?Me.push("SDF_SUBPASS"):N==="emissive"&&(Me.push("USE_MRT1"),ye.activeTexture.set(Re.TEXTURE0),xe.bind(Re.LINEAR,Re.CLAMP_TO_EDGE)),le&&Me.push("HAS_CENTROID"),He.shouldRenderCutoff&&Me.push("RENDER_CUTOFF");const Qe=(We,ut,wt,et,je)=>{let mt=Me;ut.groundRadiusBuffer!=null&&(mt=Me.concat("HAS_ATTRIBUTE_a_flood_light_ground_radius"));const ot=ut.programConfigurations.get(m.id),bt=n.isTileAffectedByFog(We),zt=n.getOrCreateProgram("fillExtrusionGroundEffect",{config:ot,defines:mt,overrideFog:bt}),qt=((Lt,hr,sr,Zt,lr,xr,Ir,Vr,tn,Pr,Gr)=>({u_matrix:hr,u_opacity:sr,u_ao_pass:Zt?1:0,u_meter_to_tile:lr,u_ao:xr,u_flood_light_intensity:Ir,u_flood_light_color:Vr,u_attenuation:tn,u_edge_radius:Pr,u_fb:0,u_fb_size:Gr,u_dynamic_offset:1}))(0,et,Z,F,je,[$,W*je],ne,te,ae,De>=17?0:Ve*je,xe?xe.size[0]:0),kt=[];le&&kt.push(ut.hiddenByLandmarkVertexBuffer),ut.groundRadiusBuffer!=null&&kt.push(ut.groundRadiusBuffer),n.uploadCommonUniforms(ye,zt,We.toUnwrapped(),null,He),zt.draw(n,ye.gl.TRIANGLES,A,S,O,D,qt,m.id,ut.vertexBuffer,ut.indexBuffer,wt,m.paint,De,ot,kt)};for(const We of x){const ut=u.getTile(We),wt=ut.getBucket(m);if(!wt||wt.projection.name!==Ce.projection.name||!wt.groundEffect||wt.groundEffect&&!wt.groundEffect.hasData())continue;const et=wt.groundEffect,je=1/wt.tileToMeter;{const mt=n.translatePosMatrix(We.projMatrix,ut,Te,Ne),ot=et.getDefaultSegment();Qe(We,et,ot,mt,je)}if(be)for(let mt=0;mt<4;mt++){const ot=a.e9[mt](We),bt=u.getTile(ot);if(!bt)continue;const zt=bt.getBucket(m);if(!zt||zt.projection.name!==Ce.projection.name||!zt.groundEffect||zt.groundEffect&&!zt.groundEffect.hasData())continue;const qt=zt.groundEffect;let kt,Lt;mt===0?(kt=[-a.al,0,0],Lt=1):mt===1?(kt=[a.al,0,0],Lt=0):mt===2?(kt=[0,-a.al,0],Lt=3):(kt=[0,a.al,0],Lt=2);const hr=qt.regionSegments[Lt];if(!hr)continue;const sr=new Float32Array(16);a.br(sr,We.projMatrix,kt),Qe(We,qt,hr,n.translatePosMatrix(sr,ut,Te,Ne),je)}}}function y_(p,n,u,m,x,A,S){m.centroidVertexArray.length===0&&m.createCentroidsBuffer();const O=A?A.findDEMTileFor(u):null;if(!(O&&O.dem||S))return;A&&O&&O.dem&&m.selfDEMTileTimestamp!==O.dem._timestamp&&(m.borderDoneWithNeighborZ=[-1,-1,-1,-1],m.selfDEMTileTimestamp=O.dem._timestamp);const D=(ae,le)=>{(ae.flags|le.flags)&a.ec?(ae.flags|=a.ec,le.flags|=a.ec):(ae.flags&=~a.ec,le.flags&=~a.ec)},F=ae=>new a.P(Math.ceil((ae+a.ed)*a.ee),0),N=ae=>{const le=n.getSource().minzoom,be=ye=>{const Re=n.getTileByID(ye);if(Re&&Re.hasData())return Re.getBucket(x)},xe=[0,-1,1];for(const ye of xe){if(ae.overscaledZ+ye<le)continue;const Re=be(ae.calculateScaledKey(ae.overscaledZ+ye));if(Re)return Re}},Z=[0,0,0],$=(ae,le)=>(Z[0]=Math.min(ae.min.y,le.min.y),Z[1]=Math.max(ae.max.y,le.max.y),Z[2]=a.al-le.min.x>ae.max.x?le.min.x-a.al:ae.max.x,Z),W=(ae,le)=>(Z[0]=Math.min(ae.min.x,le.min.x),Z[1]=Math.max(ae.max.x,le.max.x),Z[2]=a.al-le.min.y>ae.max.y?le.min.y-a.al:ae.max.y,Z),ne=[(ae,le)=>$(ae,le),(ae,le)=>$(le,ae),(ae,le)=>W(ae,le),(ae,le)=>W(le,ae)],te=(ae,le,be,xe,ye,Re,Ce)=>{if(!A)return 0;const De=[[Re?be:ae,Re?ae:be,0],[Re?be:le,Re?le:be,0]],Me=Ce<0?a.al+Ce:Ce,Te=[Re?Me:(ae+le)/2,Re?(ae+le)/2:Me,0];return be===0&&Ce<0||be!==0&&Ce>0?A.getForTilePoints(ye,[Te],!0,xe):De.push(Te),A.getForTilePoints(u,De,!0,O),Math.max(De[0][2],De[1][2],Te[2])/A.exaggeration()};for(let ae=0;ae<4;ae++){const le=m.borderFeatureIndices[ae];if(le.length===0)continue;const be=a.e9[ae](u),xe=N(be);if(!(xe&&xe instanceof a.ea))continue;const ye=A?A.findDEMTileFor(be):null;if(!(ye&&ye.dem||S)||(A&&ye&&ye.dem&&m.borderDEMTileTimestamp[ae]!==ye.dem._timestamp&&(m.borderDoneWithNeighborZ[ae]=-1,m.borderDEMTileTimestamp[ae]=ye.dem._timestamp),m.borderDoneWithNeighborZ[ae]===xe.canonical.z))continue;xe.centroidVertexArray.length===0&&xe.createCentroidsBuffer();const Re=(ae<2?1:5)-ae,Ce=xe.borderDoneWithNeighborZ[Re]!==m.canonical.z,De=xe.borderFeatureIndices[Re];let Me=0;if(m.canonical.z!==xe.canonical.z){for(const Te of le)m.showCentroid(m.featuresOnBorder[Te]);if(Ce)for(const Te of De)xe.showCentroid(xe.featuresOnBorder[Te]);m.borderDoneWithNeighborZ[ae]=xe.canonical.z,xe.borderDoneWithNeighborZ[Re]=m.canonical.z}for(const Te of le){const Ne=m.featuresOnBorder[Te],Ve=m.centroidData[Ne.centroidDataIndex],He=Ne.borders[ae];let Qe;for(;Me<De.length;){Qe=xe.featuresOnBorder[De[Me]];const We=Qe.borders[Re];if(We[1]>He[0]+3||We[0]>He[0]-3)break;xe.showCentroid(Qe),Me++}if(Qe&&Me<De.length){const We=Me;let ut=0;for(;!(Qe.borders[Re][0]>He[1]-3)&&(ut++,++Me!==De.length);)Qe=xe.featuresOnBorder[De[Me]];Qe=xe.featuresOnBorder[De[We]];let wt=!1;if(ut>=1){const mt=Qe.borders[Re];Math.abs(He[0]-mt[0])<3&&Math.abs(He[1]-mt[1])<3&&(ut=1,wt=!0,Me=We+1)}else if(ut===0){m.showCentroid(Ne);continue}const et=xe.centroidData[Qe.centroidDataIndex];S&&wt&&D(Ve,et);const je=Ne.intersectsCount()>1||Qe.intersectsCount()>1;if(ut>1)Me=We,Ve.centroidXY=et.centroidXY=new a.P(0,0);else if(ye&&ye.dem&&!je){const mt=ne[ae](Ve,et),ot=ae%2?a.al-1:0,bt=te(mt[0],Math.min(a.al-1,mt[1]),ot,ye,be,ae<2,mt[2]);Ve.centroidXY=et.centroidXY=F(bt)}else je?Ve.centroidXY=et.centroidXY=new a.P(0,0):(Ve.centroidXY=m.encodeBorderCentroid(Ne),et.centroidXY=xe.encodeBorderCentroid(Qe));m.writeCentroidToBuffer(Ve),xe.writeCentroidToBuffer(et)}else m.showCentroid(Ne)}m.borderDoneWithNeighborZ[ae]=xe.canonical.z,xe.borderDoneWithNeighborZ[Re]=m.canonical.z}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&m.centroidVertexArray.length!==0)&&m.uploadCentroid(p)}const vv=[1,0,0],qm=[0,1,0],Hm=[0,0,1];function Ap(p,n,u){const m=u.transform,x=u.shadowRenderer;if(!x)return!0;const A=p.toUnwrapped(),S=m.tileSize*x._cascades[u.currentShadowCascade].scale;let O=n;if(m.elevation){const te=m.elevation.getMinMaxForTile(p);te&&(O+=te.max)}const D=[...x.shadowDirection];D[2]=-D[2];const F=x.computeSimplifiedTileShadowVolume(A,O,S,D);if(!F)return!1;const N=[vv,qm,Hm,D,[D[0],0,D[2]],[0,D[1],D[2]]],Z=m.projection.name==="globe",$=m.scaleZoom(S),W=a.cB.fromInvProjectionMatrix(m.invProjMatrix,m.worldSize,$,!Z),ne=x.getCurrentCascadeFrustum();return W.intersectsPrecise(F.vertices,F.planes,N)===0||ne.intersectsPrecise(F.vertices,F.planes,N)===0}function Ya(p){const{painter:n,source:u,layer:m,coords:x}=p;let A=p.defines;const S=n.context,O=n.renderPass==="shadow",D=n.renderPass==="light-beam",F=n.shadowRenderer,N=a.ef(n.transform.center.lat,n.transform.zoom),Z=Ys(n,m.paint.get("building-cutoff-fade-range"));Z.shouldRenderCutoff&&(A=A.concat("RENDER_CUTOFF")),p.floodLightIntensity>0&&(A=A.concat("FLOOD_LIGHT"));for(const $ of x){const W=u.getTile($),ne=W.getBucket(m);if(!ne)continue;F&&F.getMaxCascadeForTile($.toUnwrapped())===0&&(A=A.concat("SHADOWS_SINGLE_CASCADE"));const te=ne.programConfigurations.get(m.id);let ae,le,be,xe=n.translatePosMatrix($.expandedProjMatrix,W,[0,0],"map");if(xe=a.cS(a.bC(),xe,[1,1,p.verticalScale]),O&&F){if(Ap(W.tileID,ne.maxHeight*N,n))continue;let Re=F.calculateShadowPassMatrixFromTile(W.tileID.toUnwrapped());Re=a.cS(a.bC(),Re,[1,1,p.verticalScale]),be=fs(Re),ae=le=n.getOrCreateProgram("buildingDepth",{config:te,defines:A,overrideFog:!1})}else if(D)ae=le=n.getOrCreateProgram("buildingBloom",{config:te,defines:A,overrideFog:!1}),be=g_(xe);else{const Re=n.transform.calculatePosMatrix($.toUnwrapped(),n.transform.worldSize);a.cS(Re,Re,[1,1,p.verticalScale]);const Ce=a.bC();a.cS(Ce,Re,[1,-1,1/N]),a.bl(Ce,Ce),a.eg(Ce,Ce);const De=n.transform.getFreeCameraOptions().position,Me=1<<$.canonical.z;if(be=Mc(xe,Ce,p.opacity,p.facadeAOIntensity,[((De.x-$.wrap)*Me-$.canonical.x)*a.al,(De.y*Me-$.canonical.y)*a.al,De.z*Me*a.al],ne.tileToMeter,p.facadeEmissiveChance,p.floodLightColor,p.floodLightIntensity),le=n.getOrCreateProgram("building",{config:te,defines:A,overrideFog:!1}),p.depthOnly===!0)ae=le;else{const Te=A.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);ae=n.getOrCreateProgram("building",{config:te,defines:Te,overrideFog:!1})}F&&(F.setupShadowsFromMatrix(Re,le,!0),ae!==le&&F.setupShadowsFromMatrix(Re,ae,!0))}const ye=(Re,Ce)=>{if(D){const De=Re.entranceBloom;Ce.draw(n,S.gl.TRIANGLES,p.depthMode,Rr.disabled,p.blendMode,Cr.disabled,be,m.id,De.layoutVertexBuffer,De.indexBuffer,De.segmentsBucket,m.paint,n.transform.zoom,te,[De.layoutAttenuationBuffer,De.layoutColorBuffer])}else{const De=Re.segmentsBucket;let Me=[Re.layoutNormalBuffer,Re.layoutCentroidBuffer,Re.layoutColorBuffer,Re.layoutFloodLightDataBuffer];Re.layoutFacadePaintBuffer&&(Me=Me.concat([Re.layoutFacadeDataBuffer,Re.layoutFacadeVerticalRangeBuffer,Re.layoutFacadePaintBuffer])),Ce.draw(n,S.gl.TRIANGLES,p.depthMode,Rr.disabled,p.blendMode,O?Cr.disabled:Cr.backCW,be,m.id,Re.layoutVertexBuffer,Re.indexBuffer,De,m.paint,n.transform.zoom,te,Me)}};n.uploadCommonUniforms(S,le,$.toUnwrapped(),null,Z),ne.buildingWithoutFacade&&ye(ne.buildingWithoutFacade,le),ne.buildingWithFacade&&(ae!==le&&n.uploadCommonUniforms(S,ae,$.toUnwrapped(),null,Z),ye(ne.buildingWithFacade,ae))}}function fa(p,n,u,m,x,A,S,O,D,F,N,Z,$){const W=p.context.gl,ne=p.depthModeForSublayer(1,mr.ReadOnly,W.LEQUAL,!0),te=.1*(1-(ae=N))+3*ae;var ae;const le=p._showOverdrawInspector,be=Z,xe=new ad;le||ql(xe,p,n,u,m,ne,new Rr({func:W.ALWAYS,mask:255},255,255,W.KEEP,W.KEEP,W.REPLACE),new zr([W.ONE,W.ONE,W.ONE,W.ONE],a.ao.transparent,[!1,!1,!1,!0],W.MIN),Cr.disabled,x,"sdf",A,S,O,D,F,te,be,!1);{const ye=le?Rr.disabled:new Rr({func:W.EQUAL,mask:255},255,255,W.KEEP,W.DECR,W.DECR),Re=le?p.colorModeForRenderPass():new zr([W.ONE_MINUS_DST_ALPHA,W.DST_ALPHA,W.ONE,W.ONE],a.ao.transparent,[!0,!0,!0,!0]);ql(xe,p,n,u,m,ne,ye,Re,Cr.disabled,x,"color",A,S,O,D,F,te,be,!1)}}function lf(p){return[p[0]*a.eh,p[1]*a.eh,p[2]*a.eh,0]}function oh(p,n,u,m,x,A,S,O,D){const F=m.getSource(),N=u.globeSharedBuffers;if(!N)return;let Z,$,W;if(n&&(Z=m.getTile(n)),F instanceof a.aU?($=F.texture,W=a.dK(0,0,u.transform)):Z&&n&&($=Z.texture,W=a.dK(n.canonical.z,n.canonical.x,u.transform)),!$||!W)return;p||(W=a.cS(a.bC(),W,[1,-1,1]));const ne=u.context,te=ne.gl,ae=x.paint.get("raster-resampling")==="nearest"?te.NEAREST:te.LINEAR,le=u.colorModeForDrapableLayerRenderPass(A),be=S.defines;be.push("GLOBE_POLES");const xe=new mr(te.LEQUAL,mr.ReadWrite,u.depthRangeFor3D),ye=Float32Array.from(u.transform.expandedFarZProjMatrix),Re=Float32Array.from(a.bk(a.dJ(new a.cD(0,0,0))));u.terrain&&u.terrain.prepareDrawTile(),ne.activeTexture.set(te.TEXTURE0),$.bind(ae,te.CLAMP_TO_EDGE),ne.activeTexture.set(te.TEXTURE1),$.bind(ae,te.CLAMP_TO_EDGE),"useMipmap"in $&&ne.extTextureFilterAnisotropic&&u.transform.pitch>20&&te.texParameterf(te.TEXTURE_2D,ne.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ne.extTextureFilterAnisotropicMax);const[Ce,De,Me,Te]=n?N.getPoleBuffers(n.canonical.z,!1):N.getPoleBuffers(0,!0),Ne=x.paint.get("raster-elevation");let Ve;p?(Ve=Ce,u.renderDefaultNorthPole=Ne!==0):(Ve=De,u.renderDefaultSouthPole=Ne!==0);const He=lf(S.mix),Qe=((ut,wt,et,je,mt,ot,bt,zt,qt,kt,Lt,hr,sr)=>Qh(ut,wt,et,new Float32Array(16),new Float32Array(9),[0,0],je,[0,0],[0,0,0,0],1,{opacity:1,mix:0},ot,[0,0],zt,2,kt,Lt,hr,1,0,sr))(ye,Re,W,a.aj(u.transform.zoom),0,x,0,Ne,0,He,S.offset,S.range,A),We=u.getOrCreateProgram("raster",{defines:be});u.uploadCommonUniforms(ne,We,null),We.draw(u,te.TRIANGLES,xe,D,le,O,Qe,x.id,Ve,Me,Te)}function Tp(p){if(p.isOrthographic)return[0,0,0,0];const n=p._nearZ,u=p.projection.farthestPixelDistance(p),m=u-n,x=.2*p.height,A=n+x;return[n,u,(A-x-n)/m,(A-n)/m]}function Xm(p,n,u,m){if(p)return n instanceof Po&&p instanceof Ld?n.getTextureDescriptor(p,u,!0):{texture:p.texture,mix:lf(m.mix),offset:m.offset,buffer:0,tileSize:1}}var Hl=a.ei([{name:"a_index",type:"Int16",components:1}]);class Sp{constructor(n,u,m,x){const A={width:m[0],height:m[1],data:null},S=n.gl;this.targetColorTexture=new a.T(n,A,S.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(n,A,S.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(u,x),this.lastInvalidatedAt=0}updateParticleTexture(n,u){if(this.particleTextureDimension===u.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const m=this.context.gl,x=u.width*u.height;this.particleTexture0=new a.T(this.context,u,m.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,u,m.RGBA8,{premultiply:!1,useMipmap:!1});const A=new a.ej;A.reserve(x);for(let S=0;S<x;S++)A.emplaceBack(S);this.particleIndexBuffer=this.context.createVertexBuffer(A,Hl.members,!0),this.particleSegment=a.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=u.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=a.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Ep(p,n,u){if(!p)return null;const m=n.getTextureDescriptor(p,u,!0);if(!m)return null;let{texture:x,mix:A,offset:S,tileSize:O,buffer:D,format:F}=m;if(!x||!F)return null;let N=!1;return F==="uint32"&&(N=!0,A[3]=0,A=sf(a.ek,A,[0,u.paint.get("raster-particle-max-speed")]),S=Gm(a.ek,S,[0,u.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[D/(O+2*D),O/(O+2*D)],tileSize:O,scalarData:N,scale:A,offset:S,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[F]]}}function Zm(p){const n=p._nearZ,u=p.projection.farthestPixelDistance(p),m=u-n,x=.2*p.height,A=n+x;return[n,u,(A-x-n)/m,(A-n)/m]}const Wm=new a.ao(1,0,0,1),Ym=new a.ao(0,1,0,1),Km=new a.ao(0,0,1,1),xv=new a.ao(1,0,1,1),bv=new a.ao(0,1,1,1);function v_(p,n,u,m,x,A){for(let S=0;S<u.length;S++)if(x){const F=new a.ao(m.r*.8,m.g*.8,m.b*.8,1);Pc(p,n,u[S],m,-1,-1,A),Pc(p,n,u[S],m,-1,1,A),Pc(p,n,u[S],m,1,1,A),Pc(p,n,u[S],m,1,-1,A),Pc(p,n,u[S],F,0,0,A)}else Pc(p,n,u[S],m,0,0,A)}function Pc(p,n,u,m,x,A,S){const O=p.context,D=p.transform,F=O.gl,N=D.projection.name==="globe",Z=N?["PROJECTION_GLOBE_VIEW"]:[];let $=a.bz(u.projMatrix);if(N&&a.aj(D.zoom)>0){const He=a.bj(u.canonical,D),Qe=a.el(He);$=a.aB(new Float32Array(16),D.globeMatrix,Qe),a.aB($,D.projMatrix,$)}const W=a.bC();W[12]+=2*x/(a.o.devicePixelRatio*D.width),W[13]+=2*A/(a.o.devicePixelRatio*D.height),a.aB($,W,$);const ne=p.getOrCreateProgram("debug",{defines:Z}),te=n.getTileByID(u.key);p.terrain&&p.terrain.setupElevationDraw(te,ne);const ae=mr.disabled,le=Rr.disabled,be=p.colorModeForRenderPass(),xe="$debug";O.activeTexture.set(F.TEXTURE0),p.emptyTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),N?te._makeGlobeTileDebugBuffers(p.context,D):te._makeDebugTileBoundsBuffers(p.context,D.projection);const ye=te._tileDebugBuffer||p.debugBuffer,Re=te._tileDebugIndexBuffer||p.debugIndexBuffer,Ce=te._tileDebugSegments||p.debugSegments;if(ne.draw(p,F.LINE_STRIP,ae,le,be,Cr.disabled,Oc($,m.toPremultipliedRenderColor(null)),xe,ye,Re,Ce,null,null,null,[te._globeTileDebugBorderBuffer]),S){const He=te.latestRawTileData,Qe=Math.floor((He&&He.byteLength||0)/1024);let We=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(We+=` => ${u.overscaledZ}`),We+=` ${te.state}`,We+=` ${Qe}kb`,(function(ut,wt){ut.initDebugOverlayCanvas();const et=ut.debugOverlayCanvas,je=ut.context.gl,mt=ut.debugOverlayCanvas.getContext("2d");mt.clearRect(0,0,et.width,et.height),mt.shadowColor="white",mt.shadowBlur=2,mt.lineWidth=1.5,mt.strokeStyle="white",mt.textBaseline="top",mt.font="bold 36px Open Sans, sans-serif",mt.fillText(wt,5,5),mt.strokeText(wt,5,5),ut.debugOverlayTexture.update(et),ut.debugOverlayTexture.bind(je.LINEAR,je.CLAMP_TO_EDGE)})(p,We)}const De=n.getTile(u).tileSize,Me=512/Math.min(De,512)*(u.overscaledZ/D.zoom)*.5,Te=te._tileDebugTextBuffer||p.debugBuffer,Ne=te._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,Ve=te._tileDebugTextSegments||p.debugSegments;ne.draw(p,F.TRIANGLES,ae,le,zr.alphaBlended,Cr.disabled,Oc($,a.ao.transparent.toPremultipliedRenderColor(null),Me),xe,Te,Ne,Ve,null,null,null,[te._globeTileDebugTextBuffer])}function x_(p,n,u,m){Mp(p,0,n+u/2,p.transform.width,u,m)}function b_(p,n,u,m){Mp(p,n-u/2,0,u,p.transform.height,m)}function Mp(p,n,u,m,x,A){const S=p.context,O=S.gl;O.enable(O.SCISSOR_TEST),O.scissor(n*a.o.devicePixelRatio,u*a.o.devicePixelRatio,m*a.o.devicePixelRatio,x*a.o.devicePixelRatio),S.clear({color:A}),O.disable(O.SCISSOR_TEST)}const w_=a.ei([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:wv}=w_;function Dc(p,n,u,m){p.emplaceBack(n,u,m)}class Qo{constructor(n){this.vertexArray=new a.em,this.indices=new a.b0,Dc(this.vertexArray,-1,-1,1),Dc(this.vertexArray,1,-1,1),Dc(this.vertexArray,-1,1,1),Dc(this.vertexArray,1,1,1),Dc(this.vertexArray,-1,-1,-1),Dc(this.vertexArray,1,-1,-1),Dc(this.vertexArray,-1,1,-1),Dc(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,wv),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=a.bg.simpleSegment(0,0,36,12)}}function mu(p,n,u,m,x,A){const S=p.context.gl,O=n.paint.get("sky-atmosphere-color"),D=n.paint.get("sky-atmosphere-halo-color"),F=n.paint.get("sky-atmosphere-sun-intensity"),N=((Z,$,W,ne,te)=>({u_matrix_3f:Z,u_sun_direction:$,u_sun_intensity:W,u_color_tint_r:[ne.r,ne.g,ne.b,ne.a],u_color_tint_m:[te.r,te.g,te.b,te.a],u_luminance:5e-5}))(a.eo(a.dO(),m),x,F,O.toPremultipliedRenderColor(null),D.toPremultipliedRenderColor(null));S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+A,n.skyboxTexture,0),u.draw(p,S.TRIANGLES,mr.disabled,Rr.disabled,zr.unblended,Cr.frontCW,N,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const ko=a.ei([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class gu{constructor(n){const u=new a.ep;u.emplaceBack(-1,1,1,0,0),u.emplaceBack(1,1,1,1,0),u.emplaceBack(1,-1,1,1,1),u.emplaceBack(-1,-1,1,0,1);const m=new a.b0;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(u,ko.members),this.indexBuffer=n.createIndexBuffer(m),this.segments=a.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const A_=a.ei([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class T_{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Qm{constructor(n){this.colorModeAlphaBlendedWriteRGB=new zr([1,Xu,1,Xu],a.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new zr([1,0,1,0],a.ao.transparent,[!1,!1,!1,!0]),this.params=new T_,this.updateNeeded=!0}update(n){const u=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new gu(u);const m=this.params.sizeRange,x=this.params.intensityRange,A=(function(N){const Z=a.eq(30),$=[];for(let W=0;W<N;++W){const ne=2*Math.PI*Z(),te=Math.acos(1-2*Z())-.5*Math.PI;$.push(a.d5(Math.cos(te)*Math.cos(ne),Math.cos(te)*Math.sin(ne),Math.sin(te)))}return $})(this.params.starsCount),S=a.eq(300),O=new a.er,D=new a.b0;let F=0;for(let N=0;N<A.length;++N){const Z=a.c5([],A[N],200),$=Math.max(0,1+.01*m*(1*S()-.5)),W=Math.max(0,1+.01*x*(1*S()-.5));O.emplaceBack(Z[0],Z[1],Z[2],-1,-1,$,W),O.emplaceBack(Z[0],Z[1],Z[2],1,-1,$,W),O.emplaceBack(Z[0],Z[1],Z[2],1,1,$,W),O.emplaceBack(Z[0],Z[1],Z[2],-1,1,$,W),D.emplaceBack(F+0,F+1,F+2),D.emplaceBack(F+0,F+2,F+3),F+=4}this.starsVx=u.createVertexBuffer(O,A_.members),this.starsIdx=u.createIndexBuffer(D),this.starsSegments=a.bg.simpleSegment(0,0,O.length,D.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,u){const m=n.context,x=m.gl,A=n.transform,S=new mr(x.LEQUAL,mr.ReadOnly,[0,1]),O=a.aj(A.zoom),D=n.style.getLut(u.scope),F=u.properties.get("color-use-theme")==="none",N=u.properties.get("color").toNonPremultipliedRenderColor(F?null:D),Z=u.properties.get("high-color-use-theme")==="none",$=u.properties.get("high-color").toNonPremultipliedRenderColor(Z?null:D),W=u.properties.get("space-color-use-theme")==="none",ne=u.properties.get("space-color").toNonPremultipliedRenderColor(W?null:D),te=5e-4,ae=a.es(u.properties.get("horizon-blend"),0,1,te,.25),le=a.dE(n,m,A)&&ae===te?A.worldSize/(2*Math.PI*1.025)-1:A.globeRadius,be=n.frameCounter/1e3%1,xe=a.ag(A.globeCenterInViewSpace),ye=Math.sqrt(Math.pow(xe,2)-Math.pow(le,2)),Re=Math.acos(ye/xe),Ce=De=>{const Me=A.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];De&&Me.push("ALPHA_PASS");const Te=n.getOrCreateProgram("globeAtmosphere",{defines:Me}),Ne=((He,Qe,We,ut,wt,et,je,mt,ot,bt,zt,qt)=>({u_frustum_tl:He,u_frustum_tr:Qe,u_frustum_br:We,u_frustum_bl:ut,u_horizon:wt,u_transition:et,u_fadeout_range:je,u_atmosphere_fog_color:mt.toArray01(),u_high_color:ot.toArray01(),u_space_color:bt.toArray01(),u_temporal_offset:zt,u_horizon_angle:qt}))(A.frustumCorners.TL,A.frustumCorners.TR,A.frustumCorners.BR,A.frustumCorners.BL,A.frustumCorners.horizon,O,ae,N,$,ne,be,Re);n.uploadCommonUniforms(m,Te);const Ve=this.atmosphereBuffer;Ve&&Te.draw(n,x.TRIANGLES,S,Rr.disabled,De?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Cr.backCW,Ne,De?"atmosphere_glow_alpha":"atmosphere_glow",Ve.vertexBuffer,Ve.indexBuffer,Ve.segments)};Ce(!1),Ce(!0)}drawStars(n,u){const m=a.aA(u.properties.get("star-intensity"),0,1);if(m===0)return;const x=n.context,A=x.gl,S=n.transform,O=n.getOrCreateProgram("stars"),D=a.c7([]);a.c9(D,D,-S._pitch),a.c8(D,D,-S.angle),a.c9(D,D,a.an(S._center.lat)),a.et(D,D,-a.an(S._center.lng));const F=a.cc(new Float32Array(16),D),N=a.aB([],S.starsProjMatrix,F),Z=a.eo([],F),$=a.eu([],Z),W=[0,1,0];a.dQ(W,W,$),a.c5(W,W,this.params.sizeMultiplier);const ne=[1,0,0];a.dQ(ne,ne,$),a.c5(ne,ne,this.params.sizeMultiplier);const te=(ae=W,le=ne,be=m,{u_matrix:Float32Array.from(N),u_up:ae,u_right:le,u_intensity_multiplier:be});var ae,le,be;n.uploadCommonUniforms(x,O),this.starsVx&&this.starsIdx&&O.draw(n,A.TRIANGLES,mr.disabled,Rr.disabled,this.colorModeAlphaBlendedWriteRGB,Cr.disabled,te,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class sh{constructor(){this.visibleTiles=[]}updateBorders(n,u){const m=[],x=[],A=n._getRenderableCoordinates(!1,!0);for(const D of A){const F=n.getTile(D);if(!F.hasData())continue;const N=F.getBucket(u);N&&(N.isEmpty()||(m.push(D.key),x.push({bucket:N,tileID:D.canonical})))}let S=m.length!==this.visibleTiles.length;if(!S){m.sort();for(let D=0;D<m.length;D++)if(m[D]!==this.visibleTiles[D]){S=!0;break}}if(!S)return;const O=new Set;this.visibleTiles=m,x.sort((D,F)=>D.tileID.z-F.tileID.z||D.tileID.x-F.tileID.x||D.tileID.y-F.tileID.y);for(const D of x){const F=new Array,N=new Array,Z=D.bucket;for(const $ of Z.featuresOnBorder)O.has($.featureId)?N.push($.footprintIndex):(O.add($.featureId),F.push($.footprintIndex));Z.updateFootprintHiddenFlags(F,a.ev,!1),Z.updateFootprintHiddenFlags(N,a.ev,!0)}}}function Jm(p,n){const u=[...p],m=n.cameraWorldSizeForFog/n.worldSize,x=a.bA([]);return a.cS(x,x,[m,m,1]),a.aB(u,x,u),a.aB(u,n.worldToFogMatrix,u),u}function zs(p,n,u,m,x){const A=u.material,S=m.context,{baseColorTexture:O,metallicRoughnessTexture:D}=A.pbrMetallicRoughness,{normalTexture:F,occlusionTexture:N,emissionTexture:Z}=A;function $(ne,te,ae){if(ne&&(p.push(te),S.activeTexture.set(S.gl.TEXTURE0+ae),ne.gfxTexture)){const{minFilter:le,magFilter:be,wrapS:xe,wrapT:ye}=ne.sampler;ne.gfxTexture.bindExtraParam(le,be,xe,ye)}}$(O,"HAS_TEXTURE_u_baseColorTexture",5),$(D,"HAS_TEXTURE_u_metallicRoughnessTexture",6),$(F,"HAS_TEXTURE_u_normalTexture",7),$(N,"HAS_TEXTURE_u_occlusionTexture",8),$(Z,"HAS_TEXTURE_u_emissionTexture",9),x&&(x.texture||(x.texture=new a.d$(m.context,x.image,[x.image.height,x.image.height,x.image.height],S.gl.RGBA8)),S.activeTexture.set(S.gl.TEXTURE0+10),x.texture&&x.texture.bind(S.gl.LINEAR,S.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),u.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(u.texcoordBuffer)),u.colorBuffer&&(p.push(u.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(u.colorBuffer)),u.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(u.normalBuffer)),u.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(u.pbrBuffer)),A.alphaMode!=="OPAQUE"&&A.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),A.defined||p.push("DIFFUSE_SHADED");const W=m.shadowRenderer;W&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),W.useNormalOffset&&p.push("NORMAL_OFFSET"))}function In(p,n,u,m,x,A){const S=p.modelOpacity,O=n.context,D=new mr(n.context.gl.LEQUAL,p.isLightMesh?mr.ReadOnly:mr.ReadWrite,n.depthRangeFor3D),F=n.transform,N=p.mesh,Z=N.material,$=Z.pbrMetallicRoughness,W=n.style.fog;let ne;ne=n.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:a.aB([],m.zScaleMatrix,p.nodeModelMatrix),a.aB(ne,m.negCameraPosMatrix,ne);const te=a.bl([],ne);a.eg(te,te);const ae=u.paint.get("model-color-use-theme").constantOr("default")==="none",le=u.paint.get("model-emissive-strength").constantOr(0),be=$l(new Float32Array(p.worldViewProjection),new Float32Array(ne),new Float32Array(te),null,n,S,$.baseColorFactor,Z.emissiveFactor,$.metallicFactor,$.roughnessFactor,Z,le,u,void 0,void 0,p.materialOverride,p.modelColor),xe={defines:[]},ye=[],Re=n.shadowRenderer;Re&&(Re.useNormalOffset=!1),zs(xe.defines,ye,N,n,ae?null:u.lut);let Ce=null;if(W){const Te=Jm(p.nodeModelMatrix,n.transform);if(Ce=new Float32Array(Te),F.projection.name!=="globe"){const Ne=N.aabb.min,Ve=N.aabb.max,[He,Qe]=W.getOpacityForBounds(Te,Ne[0],Ne[1],Ve[0],Ve[1]);xe.overrideFog=He>=Wt||Qe>=Wt}}const De=Ys(n,u.paint.get("model-cutoff-fade-range"));De.shouldRenderCutoff&&xe.defines.push("RENDER_CUTOFF");const Me=n.getOrCreateProgram("model",xe);n.uploadCommonUniforms(O,Me,null,Ce,De),n.renderPass!=="shadow"&&Re&&Re.setupShadowsFromMatrix(p.nodeModelMatrix,Me),Me.draw(n,O.gl.TRIANGLES,D,x,A,N.material.doubleSided?Cr.disabled:Cr.backCCW,be,u.id,N.vertexBuffer,N.indexBuffer,N.segments,u.paint,n.transform.zoom,void 0,ye)}function cf(p,n){return p.style._importedAsBasemap?"basemap":n.scope}function od(p,n,u,m,x,A,S,O,D,F){const N=p.transform,Z=!!n.isGeometryBloom&&n.isGeometryBloom;if(Z&&p.renderPass==="shadow")return;const $=N.projection.name==="globe"?a.eD(u,N):[...u];a.aB($,$,n.globalMatrix);const W=a.aB([],m,$);if(n.meshes)for(const ne of n.meshes){const te=O.get(ne.material.name);if(te&&te.opacity<=0)continue;if(ne.material.alphaMode!=="BLEND"){S.push({mesh:ne,depth:0,modelIndex:x,worldViewProjection:W,nodeModelMatrix:$,isLightMesh:Z,materialOverride:te,modelOpacity:D,modelColor:F});continue}const ae=a.af([],ne.centroid,W);!N.isOrthographic&&ae[2]<=0||A.push({mesh:ne,depth:ae[2],modelIndex:x,worldViewProjection:W,nodeModelMatrix:$,isLightMesh:Z,materialOverride:te,modelOpacity:D,modelColor:F})}if(n.children)for(const ne of n.children)od(p,ne,u,m,x,A,S,O,D,F)}function uf(p,n,u,m){const x=u.shadowRenderer;if(!x)return;const A=x.getShadowPassDepthMode(),S=x.getShadowPassColorMode(),O=x.calculateShadowPassMatrixFromMatrix(n),D=rd(O);u.getOrCreateProgram("modelDepth",{defines:u._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(u,u.context.gl.TRIANGLES,A,Rr.disabled,S,Cr.disabled,D,m.id,p.vertexBuffer,p.indexBuffer,p.segments,m.paint,u.transform.zoom,void 0,void 0)}function S_(p,n,u,m,x,A){for(const S of x){const O=Object.assign({},m);O.part=S;const D={type:"Unknown",id:n,properties:O},F={orientation:p.paint.get("model-rotation").evaluate(D,u)};A.set(S,F)}}function E_(p,n,u,m,x,A){for(const S of x){const O=Object.assign({},m);O.part=S;const D={type:"Unknown",id:n,properties:O},F={color:p.paint.get("model-color").evaluate(D,u),colorMix:p.paint.get("model-color-mix-intensity").evaluate(D,u),opacity:p.paint.get("model-opacity").evaluate(D,u),emissionStrength:p.paint.get("model-emissive-strength").evaluate(D,u)};A.set(S,F)}}function eg(p,n,u,m,x){let A=!1;for(const O of m)O.modelOpacity!==1&&(In(O,p,n,x[O.modelIndex],Rr.disabled,zr.disabled),A=!0);for(const O of m)In(O,p,n,x[O.modelIndex],O.modelOpacity!==1?p.stencilModeFor3D():Rr.disabled,p.colorModeForRenderPass());A&&p.resetStencilClippingMasks();const S=zr.additive;for(const O of u)In(O,p,n,x[O.modelIndex],Rr.disabled,O.isLightMesh?S:p.colorModeForRenderPass())}function lh(p,n,u){const m=n.updateZoomBasedPaintProperties(),x=(function(A,S,O){let D,F,N,Z=A.terrain?A.terrain.exaggeration():0;if(A.terrain&&Z>0){const $=A.terrain,W=$.findDEMTileFor(O);W&&W.dem?D=a.eF.create($,O,W):Z=0}if(Z===0&&(S.terrainElevationMin=0,S.terrainElevationMax=0),Z===S.validForExaggeration&&(Z===0||D&&D._demTile&&D._demTile.tileID===S.validForDEMTile.id&&D._dem._timestamp===S.validForDEMTile.timestamp))return!1;for(const $ in S.instancesPerModel){const W=S.instancesPerModel[$];for(let ne=0;ne<W.instancedDataArray.length;++ne){const te=(D?Z*D.getElevationAt(0|W.instancedDataArray.float32[16*ne],0|W.instancedDataArray.float32[16*ne+1],!0,!0):0)+W.instancesEvaluatedElevation[ne];W.instancedDataArray.float32[16*ne+6]=te,F=F?Math.min(S.terrainElevationMin,te):te,N=N?Math.max(S.terrainElevationMax,te):te}}return S.terrainElevationMin=F||0,S.terrainElevationMax=N||0,S.validForExaggeration=Z,S.validForDEMTile=D&&D._demTile?{id:D._demTile.tileID,timestamp:D._dem._timestamp}:{id:void 0,timestamp:0},!0})(p,n,u);(m||x)&&(n.uploaded=!1,n.upload(p.context))}const Fo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.d9([0,0,0],[a.al,a.al,0])};function Ft(p,n){const u=1<<p.canonical.z,m=n.getFreeCameraOptions().position,x=n.elevation,A=p.canonical.x/u,S=(p.canonical.x+1)/u,O=p.canonical.y/u,D=(p.canonical.y+1)/u;let F=n._centerAltitude;if(x){const W=x.getMinMaxForTile(p);W&&W.max>F&&(F=W.max)}const N=a.aA(m.x,A,S)-m.x,Z=a.aA(m.y,O,D)-m.y,$=a.cf(F,n.center.lat)-m.z;return n._zoomFromMercatorZ(Math.sqrt(N*N+Z*Z+$*$))}function Qt(p,n,u,m,x,A,S){const O=p.context,D=p.renderPass==="shadow",F=p.shadowRenderer,N=D&&F?F.getShadowPassDepthMode():new mr(O.gl.LEQUAL,mr.ReadWrite,p.depthRangeFor3D),Z=p.isTileAffectedByFog(A),$=p.transform.projection.name==="globe";if(u.meshes)for(const W of u.meshes){const ne=$?[]:["MODEL_POSITION_ON_GPU"],te=[];let ae,le,be;const xe=!$&&m.instancedDataArray.length>20;xe&&ne.push("INSTANCED_ARRAYS");const ye=Ys(p,n.paint.get("model-cutoff-fade-range"));if(ye.shouldRenderCutoff&&ne.push("RENDER_CUTOFF"),D&&F)ae=p.getOrCreateProgram("modelDepth",{defines:ne}),le=rd(S.shadowTileMatrix,S.shadowTileMatrix,Float32Array.from(u.globalMatrix)),be=F.getShadowPassColorMode();else{zs(ne,te,W,p,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),ae=p.getOrCreateProgram("model",{defines:ne,overrideFog:Z});const Ce=W.material,De=Ce.pbrMetallicRoughness,Me=n.paint.get("model-opacity").constantOr(1),Te=n.paint.get("model-emissive-strength").constantOr(0);le=$l(A.expandedProjMatrix,Float32Array.from(u.globalMatrix),new Float32Array(16),null,p,Me,De.baseColorFactor,Ce.emissiveFactor,De.metallicFactor,De.roughnessFactor,Ce,Te,n,x),F&&(S.shadowUniformsInitialized?ae.setShadowUniformValues(O,F.getShadowUniformValues()):(F.setupShadows(A.toUnwrapped(),ae,"model-tile"),S.shadowUniformsInitialized=!0)),be=ye.shouldRenderCutoff||Me<1||Ce.alphaMode!=="OPAQUE"?zr.alphaBlended:zr.unblended}p.uploadCommonUniforms(O,ae,A.toUnwrapped(),null,ye);const Re=W.material.doubleSided?Cr.disabled:Cr.backCCW;if(xe)te.push(m.instancedDataBuffer),ae.draw(p,O.gl.TRIANGLES,N,Rr.disabled,be,Re,le,n.id,W.vertexBuffer,W.indexBuffer,W.segments,n.paint,p.transform.zoom,void 0,te,m.instancedDataArray.length);else{const Ce=D?"u_instance":"u_normal_matrix";for(let De=0;De<m.instancedDataArray.length;++De)le[Ce]=new Float32Array(m.instancedDataArray.arrayBuffer,64*De,16),ae.draw(p,O.gl.TRIANGLES,N,Rr.disabled,be,Re,le,n.id,W.vertexBuffer,W.indexBuffer,W.segments,n.paint,p.transform.zoom,void 0,te)}}if(u.children)for(const W of u.children)Qt(p,n,W,m,x,A,S)}const sd=[1,-1,1];function vi(p,n,u,m){if(!u.modelManager)return!0;const x=u.modelManager;if(!u.shadowRenderer)return!0;const A=u.shadowRenderer,S=n.aabb;let O=!0,D=p.maxHeight;if(D===0){let N=0;for(const Z in p.instancesPerModel){const $=x.getModel(Z,m);$?N=Math.max(N,Math.max(Math.max($.aabb.max[0],$.aabb.max[1]),$.aabb.max[2])):O=!1}D=p.maxScale*N*1.41+p.maxVerticalOffset,O&&(p.maxHeight=D)}S.max[2]=D,S.min[2]+=p.terrainElevationMin,S.max[2]+=p.terrainElevationMax,a.af(S.min,S.min,n.tileMatrix),a.af(S.max,S.max,n.tileMatrix);const F=S.intersects(A.getCurrentCascadeFrustum());return u.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=F===2),F===0}function Ye(p,n){const u=p.uniformValues.u_cutoff_params[0],m=p.uniformValues.u_cutoff_params[1],x=p.uniformValues.u_cutoff_params[2],A=p.uniformValues.u_cutoff_params[3];return m===u||A===x?1:a.aA(((n-u)/(m-u)-x)/(A-x),0,1)}function M_(p,n,u,m){if(n.pitch<20)return 1;const x=n.getWorldToCameraMatrix();a.aB(x,x,p);const A=a.bU(u.min[0],u.min[1],u.min[2],1);let S=a.aC(a.eG(),A,x),O=S,D=S;A[1]=u.max[1],S=a.aC(a.eG(),A,x),O=S[1]<O[1]?S:O,D=S[1]>D[1]?S:D,A[0]=u.max[0],S=a.aC(a.eG(),A,x),O=S[1]<O[1]?S:O,D=S[1]>D[1]?S:D,A[1]=u.min[1],S=a.aC(a.eG(),A,x),O=S[1]<O[1]?S:O,D=S[1]>D[1]?S:D;const F=a.aA(m[0],0,1),N=100*n.pixelsPerMeter*a.aA(m[1],0,1),Z=a.aA(m[2],0,1),$=a.eH(a.eG(),O,D,F),W=Math.tan(.5*n.fovX),ne=-$[2]*W;if(N===0)return $[1]<-Math.abs(ne)?Z:1;const te=(-Math.abs(ne)-$[1])/N,ae=(be,xe,ye)=>(1-ye)*be+ye*xe,le=a.aA(ae(1,Z,te),Z,1);return ae(1,le,a.aA((n.pitch-20)/20,0,1))}class tg{}class Op{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,u,m){{const Z=this._storage.get(u.id);if(Z)return Z.lastUsedFrameIdx=n,Z.buf}const x=m.gl,A=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),S=new ArrayBuffer(A),O=new Int16Array(S);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(S));const D=new a.eJ;for(let Z=0;Z<A/2;Z+=3){const $=O[Z],W=O[Z+1],ne=O[Z+2];D.emplaceBack($,W),D.emplaceBack(W,ne),D.emplaceBack(ne,$)}const F=m.bindVertexArrayOES.current,N=new tg;return N.buf=new Bo(m,D),N.lastUsedFrameIdx=n,this._storage.set(u.id,N),m.bindVertexArrayOES.set(F),N.buf}update(n){for(const[u,m]of this._storage)n-m.lastUsedFrameIdx>30&&(m.buf.destroy(),this._storage.delete(u))}destroy(){for(const[n,u]of this._storage)u.buf.destroy(),this._storage.delete(n)}}class rg{constructor(){this.occluderSize=30,this.depthOffset=-1e-4}}const O_=a.ei([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Cp{constructor(n){this.revealStart=11,this.revealRange=2}}const ld=a.ei([{type:"Float32",name:"a_pos_2f",components:2}]);class Av{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,u){const m=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const S=new a.eK,O=new a.b0;S.emplaceBack(-1,-1),S.emplaceBack(1,-1),S.emplaceBack(1,1),S.emplaceBack(-1,1),O.emplaceBack(0,1,2),O.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(S,ld.members),this.vignetteIdx=n.context.createIndexBuffer(O)}const x=a.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,m);const S={u_vignetteShape:(A={vignetteShape:[u.start,u.range,Math.pow(10,u.fadePower)],vignetteColor:[u.color.r,u.color.g,u.color.b,u.color.a*u.strength]}).vignetteShape,u_vignetteColor:A.vignetteColor};m.draw(n,n.context.gl.TRIANGLES,mr.disabled,Rr.disabled,zr.alphaBlended,Cr.disabled,S,"vignette",this.vignetteVx,this.vignetteIdx,x)}var A}}class Tx{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,u){const m=n.getFreeCameraOptions().position,x=m.toAltitude(),A=m.toLngLat(),S=a.an(A.lng),O=a.an(A.lat),D=n.pixelsPerMeter/u,F=S*a.eM,N=a.eM*Math.log(Math.tan(Math.PI/4+O/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+N,$=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+F)*D,this._accumulatedOffsetY+=Z*D,this._accumulatedElevation+=$*D,this._offsetXPrev=F,this._offsetYPrev=N,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function C_(p,n){return[-(p[0]-Math.floor(p[0]/n)*n),-(p[1]-Math.floor(p[1]/n)*n),-(p[2]-Math.floor(p[2]/n)*n)]}function hf(p){const n=a.eq(1323123451230),u=[];for(let m=0;m<p;++m){const x=2*n()-1,A=2*n()-1,S=2*n()-1;u.push(a.d5(x,A,S))}return u}function Ls(p,n,u,m,x){const A=a.aA((x-u)/(m-u),0,1);return(1-A)*p+A*n}class Ip{constructor(n){this._movement=new Tx,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Av,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,u){const m=n.transform;this._movement.update(m,this._ppmScaleFactor);const x=m.starsProjMatrix,A=a.c7([]);a.c9(A,A,a.an(90)-m._pitch),a.c8(A,A,-m.angle);const S=a.cc(new Float32Array(16),A),O=a.eL(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),D=a.eg([],O),F=a.aB([],D,S),N=Date.now()/1e3;return this._accumulatedTimeFromStart+=(N-this._prevTime)*u,this._prevTime=N,{projectionMatrix:x,modelviewMatrix:F}}}class Pp extends Ip{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new Cp("Precipitation > Rain"),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const m=hf(this.particlesCount),x=new a.eN,A=new a.b0;let S=0;const O=a.eq(1323123451230);for(let D=0;D<m.length;++D){const F=m[D],N=[2*O()-1,O(),O(),O()];x.emplaceBack(F[0],F[1],F[2],-1,-1,...N),x.emplaceBack(F[0],F[1],F[2],1,-1,...N),x.emplaceBack(F[0],F[1],F[2],1,1,...N),x.emplaceBack(F[0],F[1],F[2],-1,1,...N),A.emplaceBack(S+0,S+1,S+2),A.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(x,O_.members),this.particlesIdx=u.createIndexBuffer(A)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const u=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},m=n.transform.zoom;if(u.revealStart>m)return;const x=Ls(0,1,u.revealStart,u.revealStart+u.revealRange,m);if(!this.particlesVx||!this.particlesIdx)return;const A=structuredClone(this._params);let S=[-A.direction.x,A.direction.y,-100];a.aw(S,S);const O=structuredClone(this._vignetteParams);O.strength*=x,A.overrideStyleParameters||(A.intensity=n.style.rain.state.density,A.timeFactor=n.style.rain.state.intensity,A.color=structuredClone(n.style.rain.state.color),S=structuredClone(n.style.rain.state.direction),A.screenThinning.intensity=n.style.rain.state.centerThinning,A.dropletSizeX=n.style.rain.state.dropletSize[0],A.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],A.distortionStrength=100*n.style.rain.state.distortionStrength,O.strength=1,O.color=structuredClone(n.style.rain.state.vignetteColor));const D=this.updateOnRender(n,A.timeFactor),F=n.context,N=F.gl,Z=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new a.T(F,{width:n.width,height:n.height,data:null},N.RGBA8)),A.distortionStrength>0&&(F.activeTexture.set(N.TEXTURE0),this.screenTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),N.copyTexSubImage2D(N.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const $=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(F,$),F.activeTexture.set(N.TEXTURE0),this.screenTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE);const W=[A.color.r,A.color.g,A.color.b,A.color.a],ne=(te,ae)=>{const le=C_(this._movement.getPosition(),te),be=A.dropletSizeX,xe=A.dropletSizeX*A.dropletSizeYScale,ye=n.width/2,Re=n.height/2,Ce=Ls(0,A.screenThinning.start,0,1,A.screenThinning.intensity),De=Ls(.001,A.screenThinning.range,0,1,A.screenThinning.intensity),Me=Ls(0,A.screenThinning.particleOffset,0,1,A.screenThinning.intensity),Te=(Ne={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:le,velocityConeAperture:A.velocityConeAperture,velocity:A.velocity,boxSize:te,rainDropletSize:[be,xe],distortionStrength:A.distortionStrength,rainDirection:S,color:W,screenSize:[Z.width,Z.height],thinningCenterPos:[ye,Re],thinningShape:[Ce,De,Math.pow(10,A.screenThinning.fadePower)],thinningAffectedRatio:A.screenThinning.affectedRatio,thinningParticleOffset:Me,shapeDirectionalPower:A.shapeDirPower,shapeNormalPower:A.shapeNormalPower,mode:ae?0:1},{u_modelview:Float32Array.from(Ne.modelview),u_projection:Float32Array.from(Ne.projection),u_time:Ne.time,u_cam_pos:Ne.camPos,u_texScreen:0,u_velocityConeAperture:Ne.velocityConeAperture,u_velocity:Ne.velocity,u_boxSize:Ne.boxSize,u_rainDropletSize:Ne.rainDropletSize,u_distortionStrength:Ne.distortionStrength,u_rainDirection:Ne.rainDirection,u_color:Ne.color,u_screenSize:Ne.screenSize,u_thinningCenterPos:Ne.thinningCenterPos,u_thinningShape:Ne.thinningShape,u_thinningAffectedRatio:Ne.thinningAffectedRatio,u_thinningParticleOffset:Ne.thinningParticleOffset,u_shapeDirectionalPower:Ne.shapeDirectionalPower,u_shapeNormalPower:Ne.shapeNormalPower,u_mode:Ne.mode});var Ne;const Ve=Math.round(A.intensity*this.particlesCount),He=a.bg.simpleSegment(0,0,4*Ve,2*Ve);$.draw(n,N.TRIANGLES,mr.disabled,Rr.disabled,zr.alphaBlended,Cr.disabled,Te,"rain_particles",this.particlesVx,this.particlesIdx,He)};A.distortionStrength>0&&ne(A.boxSize,!0),ne(A.boxSize,!1),this._vignette.draw(n,O)}}const Dp=a.ei([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class df extends Ip{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new Cp("Precipitation > Snow"),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const u=n.context;if(!this.particlesVx){const m=hf(this.particlesCount),x=new a.eO,A=new a.b0;let S=0;const O=a.eq(1323123451230);for(let D=0;D<m.length;++D){const F=m[D],N=O(),Z=O(),$=O(),W=[D/m.length,N,Z,$],ne=[O(),O()];x.emplaceBack(F[0],F[1],F[2],-1,-1,...W,...ne),x.emplaceBack(F[0],F[1],F[2],1,-1,...W,...ne),x.emplaceBack(F[0],F[1],F[2],1,1,...W,...ne),x.emplaceBack(F[0],F[1],F[2],-1,1,...W,...ne),A.emplaceBack(S+0,S+1,S+2),A.emplaceBack(S+0,S+2,S+3),S+=4}this.particlesVx=u.createVertexBuffer(x,Dp.members),this.particlesIdx=u.createIndexBuffer(A)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const u=structuredClone(this._params);let m=[-u.direction.x,u.direction.y,-100];a.aw(m,m);const x=structuredClone(this._vignetteParams),A=u.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},S=n.transform.zoom;if(A.revealStart>S)return;const O=Ls(0,1,A.revealStart,A.revealStart+A.revealRange,S);x.strength*=O,u.overrideStyleParameters||(u.intensity=n.style.snow.state.density,u.timeFactor=n.style.snow.state.intensity,u.color=structuredClone(n.style.snow.state.color),m=structuredClone(n.style.snow.state.direction),u.screenThinning.intensity=n.style.snow.state.centerThinning,u.billboardSize=2.79*n.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(n.style.snow.state.vignetteColor));const D=this.updateOnRender(n,u.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const F=n.context,N=F.gl,Z=n.transform,$=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(F,$),((W,ne,te)=>{const ae=C_(this._movement.getPosition(),W),le=Z.width/2,be=Z.height/2,xe=Ls(0,te.screenThinning.start,0,1,te.screenThinning.intensity),ye=Ls(.001,te.screenThinning.range,0,1,te.screenThinning.intensity),Re=Ls(0,te.screenThinning.particleOffset,0,1,te.screenThinning.intensity),Ce=(De={modelview:D.modelviewMatrix,projection:D.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ae,velocityConeAperture:te.velocityConeAperture,velocity:te.velocity,horizontalOscillationRadius:te.horizontalOscillationRadius,horizontalOscillationRate:te.horizontalOscillationRate,boxSize:W,billboardSize:1*te.billboardSize,simpleShapeParameters:[te.shapeFadeStart,te.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[le,be],thinningShape:[xe,ye,Math.pow(10,te.screenThinning.fadePower)],thinningAffectedRatio:te.screenThinning.affectedRatio,thinningParticleOffset:Re,color:[te.color.r,te.color.g,te.color.b,te.color.a],direction:m},{u_modelview:Float32Array.from(De.modelview),u_projection:Float32Array.from(De.projection),u_time:De.time,u_cam_pos:De.camPos,u_velocityConeAperture:De.velocityConeAperture,u_velocity:De.velocity,u_horizontalOscillationRadius:De.horizontalOscillationRadius,u_horizontalOscillationRate:De.horizontalOscillationRate,u_boxSize:De.boxSize,u_billboardSize:De.billboardSize,u_simpleShapeParameters:De.simpleShapeParameters,u_screenSize:De.screenSize,u_thinningCenterPos:De.thinningCenterPos,u_thinningShape:De.thinningShape,u_thinningAffectedRatio:De.thinningAffectedRatio,u_thinningParticleOffset:De.thinningParticleOffset,u_particleColor:De.color,u_direction:De.direction});var De;const Me=Math.round(te.intensity*this.particlesCount),Te=a.bg.simpleSegment(0,0,4*Me,2*Me);this.particlesVx&&this.particlesIdx&&$.draw(n,N.TRIANGLES,mr.disabled,Rr.disabled,zr.alphaBlended,Cr.disabled,Ce,"snow_particles",this.particlesVx,this.particlesIdx,Te)})(u.boxSize,0,u),this._vignette.draw(n,x)}}const Xl={symbol:function(p,n,u,m,x){if(p.renderPass!=="translucent")return;const A=Rr.disabled,S=p.colorModeForRenderPass(),O=u.layout.get("text-variable-anchor"),D=u.layout.get("text-size-scale-range"),F=a.aA(p.scaleFactor,D[0],D[1]);O&&(function($,W,ne,te,ae,le,be,xe){const ye=W.transform,Re=ae==="map",Ce=le==="map";for(const De of $){const Me=te.getTile(De),Te=Me.getBucket(ne);if(!Te||!Te.text||!Te.text.segments.get().length)continue;const Ne=a.bK(Te.textSizeData,ye.zoom,xe),Ve=yc(De,Te.getProjection(),ye),He=ye.calculatePixelsToTileUnitsMatrix(Me),Qe=Fh(Ve,Me.tileID.canonical,Ce,Re,ye,Te.getProjection(),He),We=Te.hasIconTextFit()&&Te.hasIconData();Ne&&rh(Te,Re,Ce,be,ye,Qe,De,Math.pow(2,ye.zoom-Me.tileID.overscaledZ),Ne,We)}})(m,p,u,n,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x,F);const N=u.paint.get("icon-opacity").constantOr(1)!==0,Z=u.paint.get("text-opacity").constantOr(1)!==0;u.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(N||Z)?id(p,n,u,m,A,S):(N&&id(p,n,u,m,A,S,{onlyIcons:!0}),Z&&id(p,n,u,m,A,S,{onlyText:!0})),n.map.showCollisionBoxes&&(Ni(p,n,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Ni(p,n,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(p,n,u,m){if(p.renderPass!=="translucent")return;const x=u.paint.get("circle-opacity"),A=u.paint.get("circle-stroke-width"),S=u.paint.get("circle-stroke-opacity"),O=u.layout.get("circle-sort-key").constantOr(1)!==void 0,D=u.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(A.constantOr(1)===0||S.constantOr(1)===0))return;const F=p.context,N=F.gl,Z=p.transform,$=!(!p.terrain||!p.terrain.enabled),W=u.layout.get("circle-elevation-reference"),ne=p.depthModeForSublayer(0,mr.ReadOnly),te=new mr(p.context.gl.LEQUAL,mr.ReadOnly,p.depthRangeFor3D),ae=W==="none"||$?ne:te,le=Rr.disabled,be=p.colorModeForDrapableLayerRenderPass(D),xe=Z.projection.name==="globe",ye=[a.aF(Z.center.lng),a.aJ(Z.center.lat)],Re=[];for(let De=0;De<m.length;De++){const Me=m[De],Te=n.getTile(Me),Ne=Te.getBucket(u);if(!Ne||Ne.projection.name!==Z.projection.name)continue;const Ve=Ne.programConfigurations.get(u.id),He=Ne.layoutVertexBuffer,Qe=Ne.globeExtVertexBuffer,We=Ne.indexBuffer,ut=a.e0(u),wt=[Qe],et=p.isTileAffectedByFog(Me);xe&&ut.push("PROJECTION_GLOBE_VIEW"),ut.push("DEPTH_D24"),p.terrain&&Z.depthOcclusionForSymbolsAndCircles&&ut.push("DEPTH_OCCLUSION"),Ne.hasElevation&&!p.terrain&&(ut.push("ELEVATED_ROADS"),wt.push(Ne.elevatedLayoutVertexBuffer));const je=p.getOrCreateProgram("circle",{config:Ve,defines:ut,overrideFog:et}),mt=Z.projection.createInversionMatrix(Z,Me.canonical),ot={programConfiguration:Ve,program:je,layoutVertexBuffer:He,dynamicBuffers:wt,indexBuffer:We,uniformValues:a.e1(p,Me,Te,mt,ye,u),tile:Te};if(O){const bt=Ne.segments.get();for(const zt of bt)Re.push({segments:new a.bg([zt]),sortKey:zt.sortKey,state:ot})}else Re.push({segments:Ne.segments,sortKey:0,state:ot})}O&&Re.sort((De,Me)=>De.sortKey-Me.sortKey);const Ce={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const De of Re){const{programConfiguration:Me,program:Te,layoutVertexBuffer:Ne,dynamicBuffers:Ve,indexBuffer:He,uniformValues:Qe,tile:We}=De.state,ut=De.segments;p.terrain&&p.terrain.setupElevationDraw(We,Te,Ce),p.uploadCommonUniforms(F,Te,We.tileID.toUnwrapped()),Te.draw(p,N.TRIANGLES,ae,le,be,Cr.disabled,Qe,u.id,Ne,He,ut,u.paint,Z.zoom,Me,Ve)}},heatmap:function(p,n,u,m){if(u.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,A=x.gl,S=Rr.disabled,O=new zr([A.ONE,A.ONE,A.ONE,A.ONE],a.ao.transparent,[!0,!0,!0,!0]);(function(W,ne,te,ae){const le=W.gl,be=ne.width*ae,xe=ne.height*ae;W.activeTexture.set(le.TEXTURE1),W.viewport.set([0,0,be,xe]);let ye=te.heatmapFbo;if(!ye||ye&&(ye.width!==be||ye.height!==xe)){ye&&ye.destroy();const Re=le.createTexture();le.bindTexture(le.TEXTURE_2D,Re),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_S,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_WRAP_T,le.CLAMP_TO_EDGE),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MIN_FILTER,le.LINEAR),le.texParameteri(le.TEXTURE_2D,le.TEXTURE_MAG_FILTER,le.LINEAR),ye=te.heatmapFbo=W.createFramebuffer(be,xe,1,null),(function(Ce,De,Me,Te,Ne,Ve){const He=Ce.gl;He.texImage2D(He.TEXTURE_2D,0,Ce.extRenderToTextureHalfFloat?He.RGBA16F:He.RGBA,Ne,Ve,0,He.RGBA,Ce.extRenderToTextureHalfFloat?He.HALF_FLOAT:He.UNSIGNED_BYTE,null),Te.colorAttachment0.set(Me)})(W,0,Re,ye,be,xe)}else le.bindTexture(le.TEXTURE_2D,ye.colorAttachment0.get()),W.bindFramebuffer.set(ye.framebuffer)})(x,p,u,p.transform.projection.name==="globe"?.5:.25),x.clear({color:a.ao.transparent});const D=p.transform,F=D.projection.name==="globe",N=F?["PROJECTION_GLOBE_VIEW"]:[],Z=F?Cr.frontCCW:Cr.disabled,$=[a.aF(D.center.lng),a.aJ(D.center.lat)];for(let W=0;W<m.length;W++){const ne=m[W];if(n.hasRenderableParent(ne))continue;const te=n.getTile(ne),ae=te.getBucket(u);if(!ae||ae.projection.name!==D.projection.name)continue;const le=p.isTileAffectedByFog(ne),be=ae.programConfigurations.get(u.id),xe=p.getOrCreateProgram("heatmap",{config:be,defines:N,overrideFog:le}),{zoom:ye}=p.transform;p.terrain&&p.terrain.setupElevationDraw(te,xe),p.uploadCommonUniforms(x,xe,ne.toUnwrapped());const Re=D.projection.createInversionMatrix(D,ne.canonical);xe.draw(p,A.TRIANGLES,mr.disabled,S,O,Z,Kh(p,ne,te,Re,$,ye,u.paint.get("heatmap-intensity")),u.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,u.paint,p.transform.zoom,be,F?[ae.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),(function(x,A){const S=x.context,O=S.gl,D=A.heatmapFbo;if(!D)return;S.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,D.colorAttachment0.get()),S.activeTexture.set(O.TEXTURE1);let F=A.colorRampTexture;F||(F=A.colorRampTexture=new a.T(S,A.colorRamp,O.RGBA8)),F.bind(O.LINEAR,O.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,O.TRIANGLES,mr.disabled,Rr.disabled,x.colorModeForRenderPass(),Cr.disabled,((N,Z)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,A),A.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,A.paint,x.transform.zoom)})(p,u))},line:function(p,n,u,m){if(p.renderPass!=="translucent")return;const x=u.paint.get("line-opacity"),A=u.paint.get("line-width");if(x.constantOr(1)===0||A.constantOr(1)===0)return;const S=u.paint.get("line-emissive-strength").isConstant(),O=u.paint.get("line-emissive-strength").constantOr(0),D=u.paint.get("line-occlusion-opacity"),F=u.layout.get("line-elevation-reference"),N=u.layout.get("line-width-unit")==="meters",Z=F==="sea",$=!(!p.terrain||!p.terrain.enabled),W=p.context,ne=W.gl;if(u.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const te=u.layout.get("line-cross-slope"),ae=te!==void 0,le=te<1,be=p.colorModeForDrapableLayerRenderPass(S?O:null),xe=p.terrain&&p.terrain.renderingToTexture,ye=xe?1:a.o.devicePixelRatio,Re=u.paint.get("line-dasharray"),Ce=Re.constantOr(1),De=u.layout.get("line-cap"),Me=Re.constantOr(null),Te=De.constantOr(null),Ne=u.paint.get("line-pattern"),Ve=Ne.constantOr(1),He=u.paint.get("line-pattern-cross-fade"),Qe=Ne.constantOr(null),We=u.paint.get("line-opacity").constantOr(1);let ut=!Ve&&We!==1||p.depthOcclusion&&D>0&&D<1;const wt=u.paint.get("line-gradient"),et=Ve?"linePattern":"line",je=a.e2(u);let mt;if(xe&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(ut=!1),D!==0&&p.depthOcclusion){const qt=u.paint._values["line-opacity"];qt&&qt.value&&qt.value.kind==="constant"?mt=qt.value:a.w(`Occlusion opacity for layer ${u.id} is supported only when line-opacity isn't data-driven.`)}A.value.kind!=="constant"&&A.value.isLineProgressConstant===!1&&je.push("VARIABLE_LINE_WIDTH"),xe&&(p.emissiveMode!=="dual-source-blending"||S?p.emissiveMode==="mrt-fallback"&&je.push("USE_MRT1"):je.push("DUAL_SOURCE_BLENDING"));const ot=(qt,kt,Lt,hr,sr,Zt)=>{for(const lr of qt){const xr=n.getTile(lr);if(Ve&&!xr.patternsLoaded())continue;const Ir=xr.getBucket(u);if(!Ir||Ir.elevationType!=="none"&&!sr||Ir.elevationType==="none"&&sr)continue;p.prepareDrawTile();const Vr=[...kt],tn=p.shadowRenderer,Pr=Ir.elevationType==="road"&&!!tn&&tn.enabled;let Gr=[0,0,0];if(Pr){const qr=p.style.directionalLight,Kn=p.style.ambientLight;qr&&Kn&&(Gr=Wo(p.style,qr,Kn)),Vr.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Lr=Ir.programConfigurations.get(u.id);let yn=!1;if(Qe&&xr.imageAtlas){const qr=a.e3.from(Qe),Kn=qr.getPrimary().scaleSelf(ye).toString(),Ii=xr.imageAtlas.patternPositions.get(Kn),kn=qr.getSecondary(),Qn=kn?xr.imageAtlas.patternPositions.get(kn.scaleSelf(ye).toString()):null;yn=!!Ii&&!!Qn,Ii&&Lr.setConstantPatternPositions(Ii,Qn)}He>0&&(yn||Lr.getPatternTransitionVertexBuffer("line-pattern"))&&Vr.push("LINE_PATTERN_TRANSITION");const hn=p.isTileAffectedByFog(lr),Pn=p.getOrCreateProgram(et,{config:Lr,defines:Vr,overrideFog:hn});if(!Ve&&Me&&Te&&xr.lineAtlas){const qr=xr.lineAtlas.getDash(Me,Te);qr&&Lr.setConstantPatternPositions(qr)}Pr&&tn.setupShadows(xr.tileID.toUnwrapped(),Pn,"vector-tile");let[ln,$r]=u.paint.get("line-trim-offset");(Te==="round"||Te==="square")&&ln!==$r&&(ln===0&&(ln-=1),$r===1&&($r+=1));const mn=xe?lr.projMatrix:null,hi=N?1/Ir.tileToMeter/a.ay(xr,1,p.transform.zoom):1,Dn=N?1/Ir.tileToMeter/a.ay(xr,1,Math.floor(p.transform.zoom)):1,wn=Ve?a.e4(p,xr,u,mn,ye,hi,Dn,[ln,$r],Gr,He):a.e5(p,xr,u,mn,Ir.lineClipsArray.length,ye,hi,Dn,[ln,$r],Gr);if(wt){const qr=Ir.gradients[u.id];let Kn=qr.texture;if(u.gradientVersion!==qr.version){let Ii=256;if(u.stepInterpolant){const kn=n.getSource().maxzoom,Qn=lr.canonical.z===kn?Math.ceil(1<<p.transform.maxZoom-lr.canonical.z):1;Ii=a.aA(a.e6(Ir.maxLineLength/a.al*1024*Qn),256,W.maxTextureSize)}qr.gradient=a.e7({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Ii,image:qr.gradient||void 0,clips:Ir.lineClipsArray}),qr.texture?qr.texture.update(qr.gradient):qr.texture=new a.T(W,qr.gradient,ne.RGBA8),qr.version=u.gradientVersion,Kn=qr.texture}W.activeTexture.set(ne.TEXTURE1),Kn.bind(u.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}Ce&&(W.activeTexture.set(ne.TEXTURE0),xr.lineAtlasTexture&&xr.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),Lr.updatePaintBuffers()),Ve&&(W.activeTexture.set(ne.TEXTURE0),xr.imageAtlasTexture&&xr.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Lr.updatePaintBuffers()),sr&&!Z&&p.terrain.setupElevationDraw(xr,Pn),p.uploadCommonUniforms(W,Pn,lr.toUnwrapped());const Nr=qr=>{mt!=null&&(mt.value=We*D),Pn.draw(p,ne.TRIANGLES,Lt,qr,be,Cr.disabled,wn,u.id,Ir.layoutVertexBuffer,Ir.indexBuffer,Ir.segments,u.paint,p.transform.zoom,Lr,[Ir.layoutVertexBuffer2,Ir.patternVertexBuffer,Ir.zOffsetVertexBuffer]),mt!=null&&(mt.value=We)};if(ut&&!sr){const qr=p.stencilModeForClipping(lr).ref;qr===0&&xe&&W.clear({stencil:0});const Kn={func:ne.EQUAL,mask:255};wn.u_alpha_discard_threshold=.8,Nr(new Rr(Kn,qr,255,ne.KEEP,ne.KEEP,ne.INVERT)),wn.u_alpha_discard_threshold=0,Nr(new Rr(Kn,qr,255,ne.KEEP,ne.KEEP,ne.KEEP))}else wn.u_alpha_discard_threshold=ut&&sr&&Zt?.8:0,Nr(sr?hr:p.stencilModeForClipping(lr))}};let bt=p.depthModeForSublayer(0,mr.ReadOnly);const zt=new mr(p.depthOcclusion?ne.GREATER:ne.LEQUAL,mr.ReadOnly,p.depthRangeFor3D);if(u.hasNonElevatedBuckets){const qt=!xe&&p.terrain;D!==0&&qt?a.w(`Occlusion opacity for layer ${u.id} is supported on terrain only if the layer has line-z-offset enabled.`):qt?a.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${u.id}.`):ot(m,je,bt,Rr.disabled,!1,!0)}if(u.hasElevatedBuckets){F==="hd-road-markup"?$||(bt=zt,je.push("ELEVATED_ROADS")):(je.push("ELEVATED"),bt=zt,ae&&je.push(le?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),Z&&je.push("ELEVATION_REFERENCE_SEA"));const qt=ut?p.stencilModeFor3D():Rr.disabled;p.forceTerrainMode=!0,ot(m,je,bt,qt,!0,!0),ut&&ot(m,je,bt,qt,!0,!1),p.forceTerrainMode=!1}ut&&(p.resetStencilClippingMasks(),xe&&W.clear({stencil:0})),D===0||p.depthOcclusion||xe||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,n,u,m){const x=u.paint.get("fill-color"),A=u.paint.get("fill-opacity");if(A.constantOr(1)===0)return;const S=u.paint.get("fill-emissive-strength"),O=p.colorModeForDrapableLayerRenderPass(S),D=u.paint.get("fill-pattern"),F=p.opaquePassEnabledForLayer()&&!D.constantOr(1)&&x.constantOr(a.ao.transparent).a===1&&A.constantOr(0)===1?"opaque":"translucent";let N="none";u.layout.get("fill-elevation-reference")!=="none"?N="road":u.paint.get("fill-z-offset").constantOr(1)!==0&&(N="offset");const Z=!(!p.terrain||!p.terrain.enabled),$={painter:p,sourceCache:n,layer:u,coords:m,colorMode:O,elevationType:N,terrainEnabled:Z,pass:F};if(p.renderPass==="shadow")return void(p.shadowRenderer&&N==="road"&&!Z&&(function(ne){const{painter:te,sourceCache:ae,layer:le,coords:be}=ne,xe=te.context.gl,ye=ne.painter.shadowRenderer;for(const Re of be){const Ce=ae.getTile(Re),De=Ce.getBucket(le);if(!De)continue;const Me=De.elevatedStructures;if(!Me||!Me.shadowCasterSegments||Me.shadowCasterSegments.segments[0].primitiveLength===0)continue;te.prepareDrawTile();const Te=De.bufferData.programConfigurations.get(le.id),Ne=te.isTileAffectedByFog(Re),Ve=te.getOrCreateProgram("elevatedStructuresDepth",{config:Te,overrideFog:Ne}),He=ye.calculateShadowPassMatrixFromTile(Ce.tileID.toUnwrapped());te.uploadCommonUniforms(te.context,Ve,Re.toUnwrapped());const Qe=Yh(He,0);Ve.draw(te,xe.TRIANGLES,ye.getShadowPassDepthMode(),Rr.disabled,ye.getShadowPassColorMode(),Cr.disabled,Qe,le.id,Me.vertexBuffer,Me.indexBuffer,Me.shadowCasterSegments,le.paint,te.transform.zoom,Te)}})($));const W=p.emissiveMode==="mrt-fallback";if(N!=="offset"){if(Ki($,!1,W),N==="road"){const ne=!Z&&p.renderPass==="translucent";ne&&__(p,n,u,m,"geometry"),Ki($,!0,W,Rr.disabled),ne&&(function(te){const{painter:ae,sourceCache:le,layer:be,coords:xe,colorMode:ye}=te,Re=ae.context.gl,Ce=te.painter.shadowRenderer,De=!!Ce&&Ce.enabled,Me=new mr(ae.context.gl.LEQUAL,mr.ReadOnly,ae.depthRangeFor3D);let Te=[0,0,0];if(De){const Ve=ae.style.directionalLight,He=ae.style.ambientLight;Ve&&He&&(Te=Wo(ae.style,Ve,He))}const Ne=Ve=>{for(const He of xe){const Qe=le.getTile(He),We=Qe.getBucket(be);if(!We)continue;const ut=We.elevatedStructures;if(!ut)continue;let wt,et;if(Ve?(wt=ut.renderableBridgeSegments,et=ut.bridgeProgramConfigurations.get(be.id)):(wt=ut.renderableTunnelSegments,et=ut.tunnelProgramConfigurations.get(be.id)),!wt||wt.segments[0].primitiveLength===0)continue;et.updatePaintBuffers(),ae.prepareDrawTile();const je=ae.isTileAffectedByFog(He),mt=[];De&&mt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const ot=ae.getOrCreateProgram("elevatedStructures",{config:et,overrideFog:je,defines:mt}),bt=ae.translatePosMatrix(He.projMatrix,Qe,be.paint.get("fill-translate"),be.paint.get("fill-translate-anchor"));De&&Ce.setupShadows(Qe.tileID.toUnwrapped(),ot,"vector-tile");const zt=Gl(bt,Te);ae.uploadCommonUniforms(ae.context,ot,He.toUnwrapped()),ot.draw(ae,Re.TRIANGLES,Me,Rr.disabled,ye,Cr.backCCW,zt,be.id,ut.vertexBuffer,ut.indexBuffer,wt,be.paint,ae.transform.zoom,et,[ut.vertexBufferNormal])}};Ne(!0),Ne(!1)})($)}}else Ki($,!1,W,p.stencilModeFor3D())},"fill-extrusion":function(p,n,u,m){const x=u.paint.get("fill-extrusion-opacity"),A=p.context,S=A.gl,O=p.terrain,D=O&&O.renderingToTexture;if(x===0)return;const F=p.emissiveMode==="mrt-fallback",N=p.conflationActive&&p.style.isLayerClipped(u,n.getSource()),Z=p.style.order.indexOf(u.fqid);if(N&&(function($,W,ne,te,ae){for(const le of te){const be=W.getTile(le).getBucket(ne);be&&(be.updateReplacement(le,$.replacementSource,ae),be.uploadCentroid($.context))}})(p,n,u,m,Z),O||N)for(const $ of m){const W=n.getTile($).getBucket(u);W&&y_(p.context,n,$,W,u,O,N)}if(p.renderPass==="shadow"&&p.shadowRenderer){const $=p.shadowRenderer;if(O&&x<.65&&u._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.ad)return;const W=$.getShadowPassDepthMode(),ne=$.getShadowPassColorMode();ah(p,n,u,m,W,Rr.disabled,ne,N)}else if(p.renderPass==="translucent"){const $=!u.paint.get("fill-extrusion-pattern").constantOr(1),W=u.paint.get("fill-extrusion-color").constantOr(a.ao.white);if(!D&&W.a!==0){const ne=new mr(p.context.gl.LEQUAL,mr.ReadWrite,p.depthRangeFor3D);x===1&&$?ah(p,n,u,m,ne,Rr.disabled,zr.unblended,N):(ah(p,n,u,m,ne,Rr.disabled,zr.disabled,N),ah(p,n,u,m,ne,p.stencilModeFor3D(),p.colorModeForRenderPass(),N),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&$&&(!O&&p.transform.projection.name!=="globe"||D)){const ne=u.paint.get("fill-extrusion-opacity"),te=u.paint.get("fill-extrusion-ambient-occlusion-intensity"),ae=u.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),le=u.paint.get("fill-extrusion-flood-light-intensity"),be=u.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",xe=u.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(be?null:u.lut).toArray01().slice(0,3),ye=te>0&&ae>0,Re=le>0,Ce=(Te,Ne,Ve)=>(1-Ve)*Te+Ve*Ne,De=new ad;De.translate=u.paint.get("fill-extrusion-translate"),De.translateAnchor=u.paint.get("fill-extrusion-translate-anchor"),De.edgeRadius=u.layout.get("fill-extrusion-edge-radius"),De.cutoffFadeRange=u.paint.get("fill-extrusion-cutoff-fade-range");const Me=Te=>{const Ne=p.depthModeForSublayer(1,mr.ReadOnly,S.LEQUAL,!0),Ve=u.paint.get(Te?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),He=Ce(.1,3,Ve),Qe=p._showOverdrawInspector;if(!Qe){const We=new Rr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),ut=new zr([S.ONE,S.ONE,S.ONE,S.ONE],a.ao.transparent,[!1,!1,!1,!0],S.MIN);ql(De,p,n,u,m,Ne,We,ut,Cr.disabled,Te,"sdf",ne,te,ae,le,xe,He,N,!1)}{const We=Qe?Rr.disabled:new Rr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),ut=Qe?p.colorModeForRenderPass():new zr([S.ONE_MINUS_DST_ALPHA,S.DST_ALPHA,S.ONE,S.ONE],a.ao.transparent,[!0,!0,!0,!0]);ql(De,p,n,u,m,Ne,We,ut,Cr.disabled,Te,"color",ne,te,ae,le,xe,He,N,!1)}};if(D){const Te=()=>{const Ve=O.drapeBufferSize[0],He=O.drapeBufferSize[1];let Qe=O.framebufferCopyTexture;return Qe&&(!Qe||Qe.size[0]===Ve&&Qe.size[1]===He)||(Qe&&Qe.destroy(),Qe=O.framebufferCopyTexture=new a.T(A,new a.q({width:Ve,height:He}),S.RGBA8)),Qe.bind(S.LINEAR,S.CLAMP_TO_EDGE),S.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,0,0,Ve,He),Qe},Ne=(Ve,He,Qe)=>{const We=p.depthModeForSublayer(1,mr.ReadOnly,S.LEQUAL,!1),ut=u.paint.get(Ve?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),wt=Ce(.1,3,ut);{const et=new zr([S.ONE,S.ONE,S.ONE,S.ONE],a.ao.transparent,[!1,!1,!1,!0]);ql(De,p,n,u,m,We,Rr.disabled,et,Cr.disabled,Ve,"clear",ne,te,ae,le,xe,wt,N,He)}{const et=new Rr({func:S.ALWAYS,mask:255},255,255,S.KEEP,S.KEEP,S.REPLACE),je=new zr([S.ONE,S.ONE,S.ONE,S.ONE],a.ao.transparent,[!1,!1,!1,!0],S.MIN);ql(De,p,n,u,m,We,et,je,Cr.disabled,Ve,"sdf",ne,te,ae,le,xe,wt,N,He)}F&&!Ve&&(Qe=Te());{const et=Ve?S.ZERO:S.ONE_MINUS_DST_ALPHA,je=new Rr({func:S.EQUAL,mask:255},255,255,S.KEEP,S.DECR,S.DECR),mt=new zr([et,S.DST_ALPHA,S.ONE_MINUS_DST_ALPHA,S.ZERO],a.ao.transparent,[!0,!0,!0,!0]);ql(De,p,n,u,m,We,je,mt,Cr.disabled,Ve,"color",ne,te,ae,le,xe,wt,N,He)}if(!F||Ve){const et=new zr([S.ONE,S.ONE,S.ONE,Ve?S.ZERO:S.ONE],a.ao.transparent,[!1,!1,!1,!0],Ve?S.FUNC_ADD:S.MAX);ql(De,p,n,u,m,We,Rr.disabled,et,Cr.disabled,Ve,"clear",ne,te,ae,le,xe,wt,N,He,Qe)}else{S.drawBuffers([S.NONE,S.COLOR_ATTACHMENT1]);const et=new Rr({func:S.EQUAL,mask:255},254,255,S.KEEP,S.DECR,S.DECR),je=new zr([S.ONE,S.ONE,S.ONE,S.ONE],a.ao.transparent,[!0,!1,!1,!1],S.MAX);ql(De,p,n,u,m,We,et,je,Cr.disabled,Ve,"emissive",ne,te,ae,le,xe,wt,N,He,Qe),S.drawBuffers([S.COLOR_ATTACHMENT0])}};if(ye||Re){let Ve;p.prepareDrawTile(),F&&!ye||(Ve=Te()),ye&&Ne(!0,!1,Ve),Re&&Ne(!1,!0,Ve)}}else ye&&Me(!0),Re&&Me(!1),(ye||Re)&&p.resetStencilClippingMasks()}}},building:function(p,n,u,m){p.currentLayer<p.firstLightBeamLayer&&(p.firstLightBeamLayer=p.currentLayer);const x=u.paint.get("building-ambient-occlusion-ground-intensity"),A=u.paint.get("building-ambient-occlusion-ground-radius"),S=u.paint.get("building-ambient-occlusion-ground-attenuation"),O=u.paint.get("building-opacity");if(O<=0)return;let D=x>0&&A>0,F=!0;const N=u.paint.get("building-vertical-scale");if(N<=0)return;p.shadowRenderer||(F=!1);const Z=p.conflationActive&&p.style.isLayerClipped(u,n.getSource()),$=p.style.order.indexOf(u.fqid);if((function(W,ne,te,ae,le,be){for(const xe of be){const ye=ne.getTile(xe).getBucket(te);ye&&(le&&ye.updateReplacement(xe,W.replacementSource,ae),ye.uploadUpdatedIndexBuffer(W.context))}})(p,n,u,$,Z,m),(function(W,ne,te,ae){for(const le of ae){const be=ne.getTile(le).getBucket(te);be&&be.needsEvaluation()&&be.uploadUpdatedColorBuffer(W.context)}})(p,n,u,m),u.resetLayerRenderingStats(p),p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0),p.renderPass==="shadow"&&p.shadowRenderer){const W=p.shadowRenderer,ne=[],te=W.getShadowPassDepthMode();Ya({painter:p,source:n,layer:u,coords:m,defines:ne,blendMode:W.getShadowPassColorMode(),depthMode:te,opacity:O,verticalScale:N,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}else if(p.renderPass==="translucent"){let W=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];F&&(W=W.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),p.shadowRenderer&&p.shadowRenderer.useNormalOffset&&(W=W.concat("NORMAL_OFFSET"));const ne=u.paint.get("building-facade-emissive-chance"),te=u.paint.get("building-ambient-occlusion-intensity"),ae=u.paint.get("building-flood-light-intensity"),le=u.paint.get("building-flood-light-color-use-theme").constantOr("default")==="none",be=u.paint.get("building-flood-light-color").toNonPremultipliedRenderColor(le?null:u.lut).toArray01().slice(0,3),xe=u.paint.get("building-flood-light-ground-attenuation"),ye=ae>0,Re=new mr(p.context.gl.LEQUAL,mr.ReadWrite,p.depthRangeFor3D);O<1&&Ya({painter:p,source:n,layer:u,coords:m,defines:W,blendMode:zr.disabled,depthMode:Re,opacity:O,verticalScale:N,facadeEmissiveChance:ne,facadeAOIntensity:te,floodLightIntensity:ae,floodLightColor:be,depthOnly:!0});const Ce=p.colorModeForRenderPass();Ya({painter:p,source:n,layer:u,coords:m,defines:W,blendMode:Ce,depthMode:Re,opacity:O,verticalScale:N,facadeEmissiveChance:ne,facadeAOIntensity:te,floodLightIntensity:ae,floodLightColor:be}),D&&fa(p,n,u,m,!0,O,x,A,ae,be,S,Z),ye&&fa(p,n,u,m,!1,O,x,A,ae,be,xe,Z)}else if(p.renderPass==="light-beam"){const W=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],ne=new mr(p.context.gl.LEQUAL,mr.ReadOnly,p.depthRangeFor3D);Ya({painter:p,source:n,layer:u,coords:m,defines:W,blendMode:zr.alphaBlended,depthMode:ne,opacity:O,verticalScale:N,facadeEmissiveChance:0,facadeAOIntensity:0,floodLightIntensity:0,floodLightColor:[0,0,0]})}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1),p.resetStencilClippingMasks()},hillshade:function(p,n,u,m){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const x=p.context,A=p.terrain&&p.terrain.renderingToTexture,[S,O]=p.renderPass!=="translucent"||A?[{},m]:p.stencilConfigForOverlap(m);for(const D of O){const F=n.getTile(D);if(F.needsHillshadePrepare&&p.renderPass==="offscreen")yl(p,F,u);else if(p.renderPass==="translucent"){const N=p.depthModeForSublayer(0,mr.ReadOnly),Z=u.paint.get("hillshade-emissive-strength"),$=p.colorModeForDrapableLayerRenderPass(Z),W=A&&p.terrain?p.terrain.stencilModeForRTTOverlap(D):S[D.overscaledZ];op(p,D,F,u,N,W,$)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,n,u,m,x,A){if(p.renderPass!=="translucent"||u.paint.get("raster-opacity")===0)return;const S=p.transform.projection.name==="globe",O=u.paint.get("raster-elevation")!==0,D=O&&S;if(p.renderElevatedRasterBackface&&!D)return;const F=p.context,N=F.gl,Z=n.getSource(),$=(function(Ce,De,Me,Te,Ne){const Ve=De.paint.get("raster-color"),He=Ce.type==="raster-array",Qe=[],We=De.paint.get("raster-resampling"),ut=De.paint.get("raster-color-mix");let wt=De.paint.get("raster-color-range");const et=[ut[0],ut[1],ut[2],0],je=ut[3];let mt=We==="nearest"?Te.NEAREST:Te.LINEAR;if(He&&(Qe.push("RASTER_ARRAY"),Ve||Qe.push("RASTER_COLOR"),We==="linear"&&Qe.push("RASTER_ARRAY_LINEAR"),mt=Te.NEAREST,!wt&&Ce.rasterLayers)){const ot=Ce.rasterLayers.find(({id:bt})=>bt===De.sourceLayer);ot&&ot.fields&&ot.fields.range&&(wt=ot.fields.range)}if(wt=wt||[0,1],Ve){Qe.push("RASTER_COLOR"),Me.activeTexture.set(Te.TEXTURE2),De.updateColorRamp(wt);let ot=De.colorRampTexture;ot||(ot=De.colorRampTexture=new a.T(Me,De.colorRamp,Te.RGBA8)),ot.bind(mt,Te.CLAMP_TO_EDGE)}return Ne&&Qe.push("USE_MRT1"),{mix:et,range:wt,offset:je,defines:Qe,resampling:mt}})(Z,u,F,N,p.terrain&&p.terrain.renderingToTexture&&p.emissiveMode==="mrt-fallback");if(Z instanceof a.aU&&!m.length&&!S)return;const W=u.paint.get("raster-emissive-strength"),ne=p.colorModeForDrapableLayerRenderPass(W),te=p.terrain&&p.terrain.renderingToTexture,ae=!p.options.moving,le=u.paint.get("raster-resampling")==="nearest"?N.NEAREST:N.LINEAR;if(Z instanceof a.aU&&!m.length&&(Z.onNorthPole||Z.onSouthPole)){const Ce=O?p.stencilModeFor3D():Rr.disabled;return void oh(!!Z.onNorthPole,null,p,n,u,W,$,Cr.disabled,Ce)}if(!m.length)return;const[be,xe]=Z instanceof a.aU||te?[{},m]:p.stencilConfigForOverlap(m),ye=xe[xe.length-1].overscaledZ;D&&$.defines.push("PROJECTION_GLOBE_VIEW"),O&&$.defines.push("RENDER_CUTOFF");const Re=(Ce,De,Me)=>{for(const Te of Ce){const Ne=Te.toUnwrapped(),Ve=n.getTile(Te);if(te&&(!Ve||!Ve.hasData()))continue;F.activeTexture.set(N.TEXTURE0);const He=Xm(Ve,Z,u,$);if(!He||!He.texture)continue;const{texture:Qe,mix:We,offset:ut,tileSize:wt,buffer:et}=He;let je,mt;te?(je=mr.disabled,mt=Te.projMatrix):O?(je=new mr(N.LEQUAL,mr.ReadWrite,p.depthRangeFor3D),mt=S?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(Ne,ae)):(je=p.depthModeForSublayer(Te.overscaledZ-ye,u.paint.get("raster-opacity")===1?mr.ReadWrite:mr.ReadOnly,N.LESS),mt=p.transform.calculateProjMatrix(Ne,ae));const ot=p.terrain&&te?p.terrain.stencilModeForRTTOverlap(Te):be[Te.overscaledZ],bt=A?0:u.paint.get("raster-fade-duration");Ve.registerFadeDuration(bt);const zt=n.findLoadedParent(Te,0),qt=fp(Ve,zt,n,p.transform,bt);let kt,Lt;!qt.isFading&&Ve.refreshedUponExpiration&&(Ve.refreshedUponExpiration=!1),p.terrain&&p.terrain.prepareDrawTile(),F.activeTexture.set(N.TEXTURE0),Qe.bind(le,N.CLAMP_TO_EDGE),F.activeTexture.set(N.TEXTURE1),zt?(zt.texture&&zt.texture.bind(le,N.CLAMP_TO_EDGE),kt=Math.pow(2,zt.tileID.overscaledZ-Ve.tileID.overscaledZ),Lt=[Ve.tileID.canonical.x*kt%1,Ve.tileID.canonical.y*kt%1]):Qe.bind(le,N.CLAMP_TO_EDGE),"useMipmap"in Qe&&F.extTextureFilterAnisotropic&&p.transform.pitch>20&&N.texParameterf(N.TEXTURE_2D,F.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,F.extTextureFilterAnisotropicMax);const hr=p.transform;let sr;const Zt=O?Tp(hr):[0,0,0,0];let lr,xr,Ir,Vr,tn,Pr=0;if(D&&Z instanceof a.aU&&Z.coordinates.length>3)lr=Float32Array.from(a.bk(a.dJ(new a.cD(0,0,0)))),xr=Float32Array.from(hr.globeMatrix),Ir=Float32Array.from(a.dF(hr)),Vr=[a.aF(hr.center.lng),a.aJ(hr.center.lat)],sr=Z.elevatedGlobePerspectiveTransform,tn=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(D){const hn=a.dG(Te.canonical);Pr=a.dH(hn.getCenter().lat),lr=Float32Array.from(a.bk(a.dJ(Te.canonical))),xr=Float32Array.from(hr.globeMatrix),Ir=Float32Array.from(a.dF(hr)),Vr=[a.aF(hr.center.lng),a.aJ(hr.center.lat)],sr=[0,0],tn=Float32Array.from(a.dI(Te.canonical,hn,Pr,hr.worldSize/hr._pixelsPerMercatorPixel))}else sr=Z instanceof a.aU?Z.perspectiveTransform:[0,0],lr=new Float32Array(16),xr=new Float32Array(9),Ir=new Float32Array(16),Vr=[0,0],tn=new Float32Array(9);const Gr=Qh(mt,lr,xr,Ir,tn,Lt||[0,0],a.aj(p.transform.zoom),Vr,Zt,kt||1,qt,u,sr,O?u.paint.get("raster-elevation"):0,2,We,ut,$.range,wt,et,W),Lr=p.isTileAffectedByFog(Te),yn=p.getOrCreateProgram("raster",{defines:$.defines,overrideFog:Lr});if(p.uploadCommonUniforms(F,yn,Ne),Z instanceof a.aU){const hn=Z.elevatedGlobeVertexBuffer,Pn=Z.elevatedGlobeIndexBuffer;if(te||!S)Z.boundsBuffer&&Z.boundsSegments&&yn.draw(p,N.TRIANGLES,je,Rr.disabled,ne,Cr.disabled,Gr,u.id,Z.boundsBuffer,p.quadTriangleIndexBuffer,Z.boundsSegments);else if(hn&&Pn){const ln=hr.zoom<=a.c_?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(hr.center.lng);ln&&yn.draw(p,N.TRIANGLES,je,Rr.disabled,ne,De,Gr,u.id,hn,Pn,ln)}}else if(D){je=new mr(N.LEQUAL,mr.ReadOnly,p.depthRangeFor3D);const hn=p.globeSharedBuffers;if(hn){const[Pn,ln,$r]=hn.getGridBuffers(Pr,!1);yn.draw(p,N.TRIANGLES,je,Me||ot,p.colorModeForRenderPass(),De,Gr,u.id,Pn,ln,$r)}}else{const{tileBoundsBuffer:hn,tileBoundsIndexBuffer:Pn,tileBoundsSegments:ln}=p.getTileBoundsBuffers(Ve);yn.draw(p,N.TRIANGLES,je,ot,ne,Cr.disabled,Gr,u.id,hn,Pn,ln)}}if(!(Z instanceof a.aU)&&D)for(const Te of Ce){const Ne=Te.canonical.y===(1<<Te.canonical.z)-1;Te.canonical.y===0&&oh(!0,Te,p,n,u,W,$,De,Me||Rr.disabled),Ne&&oh(!1,Te,p,n,u,W,$,De===Cr.frontCW?Cr.backCW:Cr.frontCW,Me||Rr.disabled)}};D?Re(xe,p.renderElevatedRasterBackface?Cr.backCW:Cr.frontCW,p.stencilModeFor3D()):Re(xe,Cr.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,n,u,m,x,A){p.renderPass==="offscreen"&&(function(S,O,D,F){if(!F.length)return;const N=S.context,Z=N.gl,$=O.getSource();if(!($ instanceof Po))return;const W=Math.ceil(Math.sqrt(D.paint.get("raster-particle-count")));let ne=D.particlePositionRGBAImage;if(!ne||ne.width!==W){const xe=(function(ye){const Re=ye*ye,Ce=new Uint8Array(4*Re),De=function(Te){return Te|=0,Te=Math.imul(2747636419^Te,2654435769),Te=Math.imul(Te^Te>>>16,2654435769),((Te=Math.imul(Te^Te>>>16,2654435769))>>>0)/4294967296},Me=.9090909090909091;for(let Te=0;Te<Re;Te++){const Ne=Me*(De(2*Te+0)+Jh),Ve=Me*(De(2*Te+1)+Jh),He=255*Ne%1,Qe=255*Ve%1,We=He,ut=Ve-Qe/255,wt=Qe;Ce[4*Te+0]=255*(Ne-He/255),Ce[4*Te+1]=255*We,Ce[4*Te+2]=255*ut,Ce[4*Te+3]=255*wt}return Ce})(W);ne=D.particlePositionRGBAImage=new a.q({width:W,height:W},xe)}let te=D.particleFramebuffer;te?te.width!==W&&(te.destroy(),te=D.particleFramebuffer=N.createFramebuffer(W,W,1,null)):te=D.particleFramebuffer=N.createFramebuffer(W,W,1,null);const ae=[];for(const xe of F){const ye=O.getTile(xe);if(!(ye instanceof Ld))continue;const Re=Ep(ye,$,D);if(!Re)continue;const Ce=[ye.tileSize,ye.tileSize];let De=D.tileFramebuffer;De||(De=D.tileFramebuffer=N.createFramebuffer(Ce[0],Ce[1],1,null));let Me=ye.rasterParticleState;Me||(Me=ye.rasterParticleState=new Sp(N,xe,Ce,ne));const Te=Me.update(D.lastInvalidatedAt);Me.particleTextureDimension!==W&&Me.updateParticleTexture(xe,ne);const Ne=Me.targetColorTexture;Me.targetColorTexture=Me.backgroundColorTexture,Me.backgroundColorTexture=Ne;const Ve=Me.particleTexture0;Me.particleTexture0=Me.particleTexture1,Me.particleTexture1=Ve,ae.push([xe,Re,Me,Te])}if(ae.length===0)return;const le=a.o.now(),be=D.previousDrawTimestamp?.001*(le-D.previousDrawTimestamp):.0167;if(D.previousDrawTimestamp=le,D.hasColorMap()){N.activeTexture.set(Z.TEXTURE0+2);let xe=D.colorRampTexture;xe||(xe=D.colorRampTexture=new a.T(N,D.colorRamp,Z.RGBA8)),xe.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}N.bindFramebuffer.set(D.tileFramebuffer.framebuffer),(function(xe,ye,Re){const Ce=xe.context,De=Ce.gl,Me=ye.tileFramebuffer;Ce.activeTexture.set(De.TEXTURE0);const Te={u_texture:0,u_opacity:1.05*(Ve=ye.paint.get("raster-particle-fade-opacity-factor"))/(Ve+.05)},Ne=xe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Ve;for(const He of Re){const[,,Qe,We]=He;Me.colorAttachment0.set(Qe.targetColorTexture.texture),Ce.viewport.set([0,0,Me.width,Me.height]),Ce.clear({color:a.ao.transparent}),We&&(Qe.backgroundColorTexture.bind(De.NEAREST,De.CLAMP_TO_EDGE),Ne.draw(xe,De.TRIANGLES,mr.disabled,Rr.disabled,zr.alphaBlended,Cr.disabled,Te,ye.id,xe.viewportBuffer,xe.quadTriangleIndexBuffer,xe.viewportSegments))}})(S,D,ae),(function(xe,ye,Re,Ce){const De=xe.context,Me=De.gl,Te=Re.tileFramebuffer,Ne=xe.transform.projection.name==="globe",Ve=Re.paint.get("raster-particle-max-speed");for(const He of Ce){const[Qe,We,ut]=He;De.activeTexture.set(Me.TEXTURE0+0),We.texture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE),Te.colorAttachment0.set(ut.targetColorTexture.texture);const wt=xe.getOrCreateProgram("rasterParticleDraw",{defines:We.defines,overrideFog:!1});De.activeTexture.set(Me.TEXTURE0+1);const et=We.scalarData?[]:[0,1,2,3].map(ot=>a.e9[ot](Qe));et.push(Qe);const je=Qe.canonical.x,mt=Qe.canonical.y;for(const ot of et){const bt=ye.getTile(Ne?ot.wrapped():ot);if(!bt)continue;const zt=bt.rasterParticleState;if(!zt)continue;const qt=ot.canonical.x+(1<<ot.canonical.z)*(ot.wrap-Qe.wrap),kt=ot.canonical.y;zt.particleTexture0.bind(Me.NEAREST,Me.CLAMP_TO_EDGE);const Lt=ed(1,zt.particleTexture0.size[0],[qt-je,kt-mt],0,We.texture.size,2,Ve,We.textureOffset,We.scale,We.offset);wt.draw(xe,Me.POINTS,mr.disabled,Rr.disabled,zr.alphaBlended,Cr.disabled,Lt,Re.id,zt.particleIndexBuffer,void 0,zt.particleSegment)}}})(S,O,D,ae),N.bindFramebuffer.set(D.particleFramebuffer.framebuffer),(function(xe,ye,Re,Ce){const De=xe.context,Me=De.gl,Te=ye.paint.get("raster-particle-max-speed"),Ne=Ce*ye.paint.get("raster-particle-speed-factor")*.15,Ve=(function(Qe){return Math.pow(Qe,6)})(.01+1*ye.paint.get("raster-particle-reset-rate-factor")),He=ye.particleFramebuffer;De.viewport.set([0,0,He.width,He.height]);for(const Qe of Re){const[,We,ut]=Qe;De.activeTexture.set(Me.TEXTURE0+0),We.texture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE),De.activeTexture.set(Me.TEXTURE0+1);const wt=ut.particleTexture0;wt.bind(Me.NEAREST,Me.CLAMP_TO_EDGE);const et=$m(1,wt.size[0],0,We.texture.size,Te,Ne,Ve,We.textureOffset,We.scale,We.offset);He.colorAttachment0.set(ut.particleTexture1.texture),De.clear({color:a.ao.transparent}),xe.getOrCreateProgram("rasterParticleUpdate",{defines:We.defines}).draw(xe,Me.TRIANGLES,mr.disabled,Rr.disabled,zr.unblended,Cr.disabled,et,ye.id,xe.viewportBuffer,xe.quadTriangleIndexBuffer,xe.viewportSegments)}})(S,D,ae,be)})(p,n,u,m),p.renderPass==="translucent"&&((function(S,O,D,F){const N=S.context,Z=N.gl,$=O.getSource().tileSize,W=5*(1-a.ah(a.cL,a.cL+1,S.transform.zoom))*$+D.paint.get("raster-particle-elevation"),ne=!S.options.moving,te=S.transform.projection.name==="globe";if(!F.length)return;const[ae,le]=S.stencilConfigForOverlap(F),be=[];te&&be.push("PROJECTION_GLOBE_VIEW");const xe=S.stencilModeFor3D();for(const ye of le){const Re=ye.toUnwrapped(),Ce=O.getTile(ye);if(!Ce.rasterParticleState)continue;const De=Ce.rasterParticleState,Me=100;Ce.registerFadeDuration(Me);const Te=O.findLoadedParent(ye,0),Ne=fp(Ce,Te,O,S.transform,Me);let Ve,He;S.terrain&&S.terrain.prepareDrawTile(),N.activeTexture.set(Z.TEXTURE0),De.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),N.activeTexture.set(Z.TEXTURE1),Te&&Te.rasterParticleState?(Te.rasterParticleState.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),Ve=Math.pow(2,Te.tileID.overscaledZ-Ce.tileID.overscaledZ),He=[Ce.tileID.canonical.x*Ve%1,Ce.tileID.canonical.y*Ve%1]):De.targetColorTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE);const Qe=te?Float32Array.from(S.transform.expandedFarZProjMatrix):S.transform.calculateProjMatrix(Re,ne),We=S.transform,ut=Zm(We),wt=a.dG(ye.canonical),et=a.dH(wt.getCenter().lat);let je,mt,ot,bt,zt;te?(je=Float32Array.from(a.bk(a.dJ(ye.canonical))),mt=Float32Array.from(We.globeMatrix),ot=Float32Array.from(a.dF(We)),bt=[a.aF(We.center.lng),a.aJ(We.center.lat)],zt=Float32Array.from(a.dI(ye.canonical,wt,et,We.worldSize/We._pixelsPerMercatorPixel))):(je=new Float32Array(16),mt=new Float32Array(9),ot=new Float32Array(16),bt=[0,0],zt=new Float32Array(9));const qt=yv(Qe,je,mt,ot,zt,He||[0,0],a.aj(S.transform.zoom),bt,ut,Ve||1,Ne,W),kt=S.isTileAffectedByFog(ye),Lt=S.getOrCreateProgram("rasterParticle",{defines:be,overrideFog:kt});if(S.uploadCommonUniforms(N,Lt,Re),te){const hr=new mr(Z.LEQUAL,mr.ReadOnly,S.depthRangeFor3D),sr=0,Zt=S.globeSharedBuffers;if(Zt){const[lr,xr,Ir]=Zt.getGridBuffers(et,sr!==0);Lt.draw(S,Z.TRIANGLES,hr,xe,zr.alphaBlended,S.renderElevatedRasterBackface?Cr.frontCCW:Cr.backCCW,qt,D.id,lr,xr,Ir)}}else{const hr=S.depthModeForSublayer(0,mr.ReadOnly),sr=ae[ye.overscaledZ],{tileBoundsBuffer:Zt,tileBoundsIndexBuffer:lr,tileBoundsSegments:xr}=S.getTileBoundsBuffers(Ce);Lt.draw(S,Z.TRIANGLES,hr,sr,zr.alphaBlended,Cr.disabled,qt,D.id,Zt,lr,xr)}}S.resetStencilClippingMasks()})(p,n,u,m),p.style.map.triggerRepaint())},background:function(p,n,u,m){const x=u.paint.get("background-color"),A=u.paint.get("background-color-use-theme").constantOr("default")==="none",S=u.paint.get("background-opacity"),O=u.paint.get("background-emissive-strength"),D=u.paint.get("background-pitch-alignment")==="viewport";if(S===0)return;const F=p.context,N=F.gl,Z=p.transform,$=Z.tileSize,W=u.paint.get("background-pattern");let ne;if(W!==void 0&&(W===null||(ne=p.imageManager.getPattern(a.I.from(W.toString()),u.scope,p.style.getLut(u.scope)),!ne)))return;const te=!W&&x.a===1&&S===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==te)return;const ae=Rr.disabled,le=p.depthModeForSublayer(0,te==="opaque"?mr.ReadWrite:mr.ReadOnly),be=p.colorModeForDrapableLayerRenderPass(O),xe=W?"backgroundPattern":"background";let ye,Re=m;Re||(ye=p.getBackgroundTiles(),Re=Object.values(ye).map(De=>De.tileID)),W&&(F.activeTexture.set(N.TEXTURE0),p.imageManager.bind(p.context,u.scope));const Ce=[];if(p.terrain&&p.terrain.renderingToTexture&&p.emissiveMode==="mrt-fallback"&&Ce.push("USE_MRT1"),D){const De=p.getOrCreateProgram(xe,{overrideFog:!1,overrideRtt:!0,defines:Ce}),Me=new Float32Array(a.bA([])),Te=new a.aQ(0,0,0,0,0),Ne=W?Lo(Me,O,S,p,0,u.scope,ne,D,{tileID:Te,tileSize:$}):Cc(Me,O,S,x.toPremultipliedRenderColor(A?null:u.lut));return void De.draw(p,N.TRIANGLES,le,ae,be,Cr.disabled,Ne,u.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}for(const De of Re){const Me=p.isTileAffectedByFog(De),Te=p.getOrCreateProgram(xe,{overrideFog:Me,defines:Ce}),Ne=De.toUnwrapped(),Ve=m?De.projMatrix:p.transform.calculateProjMatrix(Ne);p.prepareDrawTile();const He=n?n.getTile(De):ye?ye[De.key]:new Wc(De,$,Z.zoom,p),Qe=W?Lo(Ve,O,S,p,0,u.scope,ne,D,{tileID:De,tileSize:$}):Cc(Ve,O,S,x.toPremultipliedRenderColor(A?null:u.lut));p.uploadCommonUniforms(F,Te,Ne);const{tileBoundsBuffer:We,tileBoundsIndexBuffer:ut,tileBoundsSegments:wt}=p.getTileBoundsBuffers(He);Te.draw(p,N.TRIANGLES,le,ae,be,Cr.disabled,Qe,u.id,We,ut,wt)}},sky:function(p,n,u){const m=p._atmosphere?a.aj(p.transform.zoom):1,x=u.paint.get("sky-opacity")*m;if(x===0)return;const A=p.context,S=u.paint.get("sky-type"),O=new mr(A.gl.LEQUAL,mr.ReadOnly,[0,1]),D=p.frameCounter/1e3%1;S==="atmosphere"?p.renderPass==="offscreen"?u.needsSkyboxCapture(p)&&((function(F,N){const Z=F.context,$=Z.gl;let W=N.skyboxFbo;if(!W){W=N.skyboxFbo=Z.createFramebuffer(32,32,1,null),N.skyboxGeometry=new Qo(Z),N.skyboxTexture=Z.gl.createTexture(),$.bindTexture($.TEXTURE_CUBE_MAP,N.skyboxTexture),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_CUBE_MAP,$.TEXTURE_MAG_FILTER,$.LINEAR);for(let le=0;le<6;++le)$.texImage2D($.TEXTURE_CUBE_MAP_POSITIVE_X+le,0,$.RGBA,32,32,0,$.RGBA,$.UNSIGNED_BYTE,null)}Z.bindFramebuffer.set(W.framebuffer),Z.viewport.set([0,0,32,32]);const ne=N.getCenter(F,!0),te=F.getOrCreateProgram("skyboxCapture"),ae=new Float64Array(16);a.bA(ae),a.en(ae,ae,.5*-Math.PI),mu(F,N,te,ae,ne,0),a.bA(ae),a.en(ae,ae,.5*Math.PI),mu(F,N,te,ae,ne,1),a.bA(ae),a.cU(ae,ae,.5*-Math.PI),mu(F,N,te,ae,ne,2),a.bA(ae),a.cU(ae,ae,.5*Math.PI),mu(F,N,te,ae,ne,3),a.bA(ae),mu(F,N,te,ae,ne,4),a.bA(ae),a.en(ae,ae,Math.PI),mu(F,N,te,ae,ne,5),Z.viewport.set([0,0,F.width,F.height])})(p,u),u.markSkyboxValid(p)):p.renderPass==="sky"&&(function(F,N,Z,$,W){const ne=F.context,te=ne.gl,ae=F.transform,le=F.getOrCreateProgram("skybox");ne.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_CUBE_MAP,N.skyboxTexture);const be=((xe,ye,Re,Ce,De)=>({u_matrix:xe,u_sun_direction:ye,u_cubemap:0,u_opacity:Ce,u_temporal_offset:De}))(ae.skyboxMatrix,N.getCenter(F,!1),0,$,W);F.uploadCommonUniforms(ne,le),le.draw(F,te.TRIANGLES,Z,Rr.disabled,F.colorModeForRenderPass(),Cr.backCW,be,"skybox",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)})(p,u,O,x,D):S==="gradient"&&p.renderPass==="sky"&&(function(F,N,Z,$,W){const ne=F.context,te=ne.gl,ae=F.transform,le=F.getOrCreateProgram("skyboxGradient");N.skyboxGeometry||(N.skyboxGeometry=new Qo(ne)),ne.activeTexture.set(te.TEXTURE0);let be=N.colorRampTexture;be||(be=N.colorRampTexture=new a.T(ne,N.colorRamp,te.RGBA8)),be.bind(te.LINEAR,te.CLAMP_TO_EDGE);const xe=((ye,Re,Ce,De,Me)=>({u_matrix:ye,u_color_ramp:0,u_center_direction:Re,u_radius:a.an(Ce),u_opacity:De,u_temporal_offset:Me}))(ae.skyboxMatrix,N.getCenter(F,!1),N.paint.get("sky-gradient-radius"),$,W);F.uploadCommonUniforms(ne,le),le.draw(F,te.TRIANGLES,Z,Rr.disabled,F.colorModeForRenderPass(),Cr.backCW,xe,"skyboxGradient",N.skyboxGeometry.vertexBuffer,N.skyboxGeometry.indexBuffer,N.skyboxGeometry.segment)})(p,u,O,x,D)},custom:function(p,n,u,m){const x=p.context,A=u.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&u.isDraped(n)){if(p.renderPass==="offscreen"){const S=A.prerender;if(S){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const O=p.transform.pointMerc;S.call(A,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.aj(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else S.call(A,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const O=A.renderToTile;if(O){const D=m[0].canonical,F={x:D.x+m[0].wrap*(A.wrapTileId?0:1<<D.z),y:D.y,z:D.z};x.setDepthMode(mr.disabled),x.setStencilMode(Rr.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),O.call(A,x.gl,F),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(Rr.disabled);const S=A.renderingMode==="3d"?new mr(p.context.gl.LEQUAL,mr.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,mr.ReadOnly);if(x.setDepthMode(S),p.transform.projection.name==="globe"){const O=p.transform.pointMerc;A.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),a.aj(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else A.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,n,u,m){if(p.renderPass==="opaque")return;const x=u.paint.get("model-opacity").constantOr(1),A=u.paint.get("model-elevation-reference"),S=A==="ground",O=A==="ground";if(x===0)return;const D=u.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!D||p.terrain&&x<.65&&u._transitionablePaint._values["model-opacity"].value.expression instanceof a.ad))return;const F=p.shadowRenderer,N=u.paint.get("model-receive-shadows");F&&(F.useNormalOffset=!0,N||(F.enabled=!1));const Z=()=>{F&&(F.useNormalOffset=!0,N||(F.enabled=!0))},$=n.getSource();if(p.renderPass==="light-beam"&&$.type!=="batched-model")return;if($.type==="vector"||$.type==="geojson")return(function(ye,Re,Ce,De,Me){const Te=ye.transform,Ne=Te.projection.name==="globe",Ve=Te.getFreeCameraOptions().position;if(!ye.modelManager)return;const He=ye.modelManager;Ce.modelManager=He;const Qe=ye.shadowRenderer;if(!Ce._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const We=Ce._unevaluatedLayout._values["model-id"],ut=Object.assign({},Ce.layout.get("model-id").parameters),wt=ye.style.order.indexOf(Ce.fqid),et=Ce.paint.get("model-opacity").constantOr(1);for(const je of De){const mt=Re.getTile(je).getBucket(Ce);if(!mt||mt.projection.name!==Te.projection.name)continue;const ot=mt.getModelUris();if(ot&&!mt.modelsRequested&&(He.addModelsFromBucket(ot,Me),mt.modelsRequested=!0),Ne)ut.zoom=je.overscaledZ;else{const Zt=Ft(je,Te);ut.zoom=Zt}const bt=We.possiblyEvaluate(ut);if(lh(ye,mt,je),Fo.shadowUniformsInitialized=!1,Fo.useSingleShadowCascade=!!Qe&&Qe.getMaxCascadeForTile(je.toUnwrapped())===0,ye.renderPass==="shadow"&&Qe){if(ye.currentShadowCascade===1&&mt.isInsideFirstShadowMapFrustum)continue;const Zt=Te.calculatePosMatrix(je.toUnwrapped(),Te.worldSize);if(Fo.tileMatrix.set(Zt),Fo.shadowTileMatrix=Float32Array.from(Qe.calculateShadowPassMatrixFromMatrix(Zt)),Fo.aabb.min=[0,0,0],Fo.aabb.max[0]=Fo.aabb.max[1]=a.al,Fo.aabb.max[2]=0,vi(mt,Fo,ye,Ce.scope))continue}const zt=1<<je.canonical.z,qt=[((Ve.x-je.wrap)*zt-je.canonical.x)*a.al,(Ve.y*zt-je.canonical.y)*a.al,Ve.z*zt*a.al];ye.conflationActive&&Object.keys(mt.instancesPerModel).length>0&&ye.style.isLayerClipped(Ce,Re.getSource())&&mt.updateReplacement(je,ye.replacementSource,wt,Ce.scope)&&(mt.uploaded=!1,mt.upload(ye.context));let kt=0;const Lt=new Array,hr=new Array,sr=new Array;for(let Zt in mt.instancesPerModel){const lr=mt.instancesPerModel[Zt];lr.features.length>0&&!Ne&&(Zt=bt.evaluate(lr.features[0].feature,{}));const xr=He.getModel(Zt,Me);if(xr||He.hasURLBeenRequested(Zt)||mt.modelUris.includes(Zt)||(mt.modelUris.push(Zt),mt.modelsRequested=!1),xr&&xr.uploaded)if(Ne){const Ir=a.c5([],[Ve.x,Ve.y,Ve.z],ye.transform.worldSize);a.ew(Ir,Ir);for(let Vr=0;Vr<lr.instancedDataArray.length;++Vr){const tn=[0,0,0],Pr=[1,1,1],Gr=a.ex(),Lr=lr.tileCoordinatesForInstance(Vr),yn=lr.transformForInstance(Vr);a.ey(Pr,yn),a.ez(Gr,yn),a.eA(tn,Gr);const hn=lr.translationForInstance(Vr),Pn=new a.aT(0,0);a.eB(mt.canonical,Pn,Lr.x,Lr.y);const ln=a.bC();a.eC(ln,xr,ye.transform,Pn,tn,Pr,hn,!0,!1,!1);const $r=lr.colorForInstance(Vr),mn=a.bA([]),hi=a.ef(Pn.lat,ye.transform.zoom),Dn=a.bq([],[1,1,1/hi]);a.br(mn,mn,Ir),sr.push({zScaleMatrix:Dn,negCameraPosMatrix:mn});for(const wn of xr.nodes)od(ye,wn,ln,ye.transform.expandedFarZProjMatrix,kt,Lt,hr,xr.materialOverrides,et,$r);++kt}}else for(const Ir of xr.nodes)Qt(ye,Ce,Ir,lr,qt,je,Fo)}if(Ne)if(ye.renderPass==="shadow"){for(const Zt of hr)uf(Zt.mesh,Zt.nodeModelMatrix,ye,Ce);for(const Zt of Lt)uf(Zt.mesh,Zt.nodeModelMatrix,ye,Ce)}else eg(ye,Ce,Lt,hr,sr)}})(p,n,u,m,cf(p,u)),void Z();if(!$.loaded())return;if($.type==="batched-model")return(function(ye,Re,Ce,De){Ce.resetLayerRenderingStats(ye);const Me=ye.context,Te=ye.transform,Ne=ye.style.fog,Ve=ye.shadowRenderer;if(Te.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${Te.projection.name} projection is not yet implemented`);const He=ye.transform.getFreeCameraOptions().position,Qe=a.c5([],[He.x,He.y,He.z],ye.transform.worldSize),We=a.ew([],Qe),ut=a.bA([]),wt=a.ef(Te.center.lat,Te.zoom),et=a.bq([],[1,1,1/wt]);a.br(ut,ut,We);const je=Ce.paint.get("model-opacity").constantOr(1),mt=new mr(Me.gl.LEQUAL,mr.ReadWrite,ye.depthRangeFor3D),ot=new mr(Me.gl.LEQUAL,mr.ReadOnly,ye.depthRangeFor3D),bt=new a.d9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),zt=ye.renderPass==="shadow",qt=zt&&Ve?Ve.getCurrentCascadeFrustum():Te.getFrustum(Te.scaleZoom(Te.worldSize)),kt=Ce.paint.get("model-front-cutoff"),Lt=kt[2]<1,hr=Ys(ye,Ce.paint.get("model-cutoff-fade-range")),sr=Ce.getLayerRenderingStats();(function(Zt,lr,xr,Ir){const Vr=Zt.terrain?Zt.terrain.exaggeration():0,tn=Zt.transform.zoom;for(const Pr of Ir){const Gr=lr.getTile(Pr).getBucket(xr);Gr&&(Gr.setFilter(xr.filter),Zt.conflationActive&&Gr.updateReplacement(Pr,Zt.replacementSource),Gr.evaluateTransform(Zt,xr),Zt.terrain&&Vr>0&&Gr.elevationUpdate(Zt.terrain,Vr,Pr,xr.source),Gr.needsReEvaluation(Zt,tn,xr)&&Gr.evaluate(xr))}})(ye,Re,Ce,De),(function(){let Zt,lr,xr;Lt?(Zt=De.length-1,lr=-1,xr=-1):(Zt=0,lr=De.length,xr=1);const Ir=new Float64Array(16),Vr=a.cA(),tn=new a.P(0,0);for(let Pr=Zt;Pr!==lr;Pr+=xr){const Gr=De[Pr],Lr=Re.getTile(Gr).getBucket(Ce);if(!Lr||!Lr.uploaded)continue;let yn=!1;Ve&&(yn=Ve.getMaxCascadeForTile(Gr.toUnwrapped())===0);const hn=Te.calculatePosMatrix(Gr.toUnwrapped(),Te.worldSize),Pn=Lr.modelTraits;!zt&&Lt&&(a.bl(Ir,hn),a.af(Vr,Qe,Ir),tn.x=Vr[0],tn.y=Vr[1]);const ln=[];Lr.setFilter(Ce.filter);for(const $r of Lr.getNodesInfo()){if($r.hiddenByReplacement||!$r.node.meshes)continue;const mn=$r.node;let hi=0;ye.terrain&&mn.elevation&&(hi=mn.elevation*ye.terrain.exaggeration());const Dn=(()=>{const An=$r.aabb;return bt.min=[...An.min],bt.max=[...An.max],bt.min[2]+=hi,bt.max[2]+=hi,a.af(bt.min,bt.min,hn),a.af(bt.max,bt.max,hn),bt})(),wn=$r.evaluatedScale;if(wn[0]<=1&&wn[1]<=1&&wn[2]<=1&&Dn.intersects(qt)===0)continue;if(!zt&&Lt){const An=.16666666666666666;$r.cameraCollisionOpacity=Qe[0]>Dn.min[0]&&Qe[0]<Dn.max[0]&&Qe[1]>Dn.min[1]&&Qe[1]<Dn.max[1]&&Qe[2]*wt<Dn.max[2]&&mn.footprint&&a.c0(tn,mn.footprint)?Math.max($r.cameraCollisionOpacity-An,0):Math.min(1,$r.cameraCollisionOpacity+An)}const Nr=[...hn],qr=1/a.d7(Gr.canonical),Kn=mn.anchor?mn.anchor[0]:0,Ii=mn.anchor?mn.anchor[1]:0;a.br(Nr,Nr,[Kn*(wn[0]-1)+$r.evaluatedTranslation[0]*qr,Ii*(wn[1]-1)+$r.evaluatedTranslation[1]*qr,hi+$r.evaluatedTranslation[2]]),a.cq(wn,a.eE)||a.cS(Nr,Nr,wn);const kn=a.aB([],Nr,mn.globalMatrix),Qn=a.aB([],Te.expandedFarZProjMatrix,kn),Ao=a.aB([],Te.expandedFarZProjMatrix,Nr),Ka=a.aC([],[Kn,Ii,hi,1],Qn)[2];mn.hidden=!1;let Oa=je;zt||(Lt&&(Oa*=$r.cameraCollisionOpacity,Oa*=M_(Nr,Te,$r.aabb,kt)),Oa*=Ye(hr,Ka)),Oa!==0?ln.push({nodeInfo:$r,depth:Ka,opacity:Oa,wvpForNode:Qn,wvpForTile:Ao,nodeModelMatrix:kn,tileModelMatrix:Nr}):mn.hidden=!0}zt||ln.sort(($r,mn)=>!Lt||$r.opacity===1&&mn.opacity===1?$r.depth<mn.depth?-1:1:$r.opacity===1?-1:mn.opacity===1?1:$r.depth>mn.depth?-1:1);for(const $r of ln){const mn=$r.nodeInfo,hi=mn.node;let Dn=a.aB([],et,$r.tileModelMatrix);a.aB(Dn,ut,Dn);const wn=a.bl([],Dn);a.eg(wn,wn),a.cS(wn,wn,sd),Dn=a.aB(Dn,Dn,hi.globalMatrix);const Nr=ye.renderPass==="light-beam",qr=Ce.paint.get("model-color-use-theme").constantOr("default")==="none",Kn=Pn&a.eI.HasMapboxMeshFeatures,Ii=Kn?0:mn.evaluatedRMEA[0][2];for(let kn=0;kn<hi.meshes.length;++kn){const Qn=hi.meshes[kn],Ao=kn===hi.lightMeshIndex;let Ka=$r.wvpForNode;if(Ao){if(!Nr&&!ye.terrain&&ye.shadowRenderer){ye.currentLayer<ye.firstLightBeamLayer&&(ye.firstLightBeamLayer=ye.currentLayer);continue}Ka=$r.wvpForTile}else if(Nr)continue;const Oa={defines:[]},An=[];if(!zt&&Ve&&(Ve.useNormalOffset=!!Qn.normalBuffer),zs(Oa.defines,An,Qn,ye,qr?null:Ce.lut),Kn||Oa.defines.push("DIFFUSE_SHADED"),yn&&Oa.defines.push("SHADOWS_SINGLE_CASCADE"),sr&&(zt?sr.numRenderedVerticesInShadowPass+=Qn.vertexArray.length:sr.numRenderedVerticesInTransparentPass+=Qn.vertexArray.length),zt){uf(Qn,$r.nodeModelMatrix,ye,Ce);continue}let ms=null;if(Ne){const Hi=Jm($r.nodeModelMatrix,ye.transform);if(ms=new Float32Array(Hi),Te.projection.name!=="globe"){const ri=Qn.aabb.min,Ji=Qn.aabb.max,[ba,Ei]=Ne.getOpacityForBounds(Hi,ri[0],ri[1],Ji[0],Ji[1]);Oa.overrideFog=ba>=Wt||Ei>=Wt}}const Qa=Qn.material;let so;Qa.occlusionTexture&&Qa.occlusionTexture.offsetScale&&(so=Qa.occlusionTexture.offsetScale,Oa.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Fs=ye.getOrCreateProgram("model",Oa);!zt&&Ve&&Ve.setupShadowsFromMatrix($r.tileModelMatrix,Fs,Ve.useNormalOffset),ye.uploadCommonUniforms(Me,Fs,null,ms);const Jo=Qa.pbrMetallicRoughness;Jo.metallicFactor=.9,Jo.roughnessFactor=.5;const xi=$l(new Float32Array(Ka),new Float32Array(Dn),new Float32Array(wn),new Float32Array(hi.globalMatrix),ye,$r.opacity,Jo.baseColorFactor,Qa.emissiveFactor,Jo.metallicFactor,Jo.roughnessFactor,Qa,Ii,Ce,[0,0,0],so);!Ao&&(mn.hasTranslucentParts||$r.opacity<1)&&Fs.draw(ye,Me.gl.TRIANGLES,mt,Rr.disabled,zr.disabled,Cr.backCCW,xi,Ce.id,Qn.vertexBuffer,Qn.indexBuffer,Qn.segments,Ce.paint,ye.transform.zoom,void 0,An),Fs.draw(ye,Me.gl.TRIANGLES,Ao?ot:mt,Rr.disabled,Ao||$r.opacity<1||mn.hasTranslucentParts?zr.alphaBlended:zr.unblended,Cr.backCCW,xi,Ce.id,Qn.vertexBuffer,Qn.indexBuffer,Qn.segments,Ce.paint,ye.transform.zoom,void 0,An)}}}})()})(p,n,u,m),void Z();if($.type!=="model")return;const W=$.getModels(),ne=[],te=p.transform.getFreeCameraOptions().position,ae=a.c5([],[te.x,te.y,te.z],p.transform.worldSize);a.ew(ae,ae);const le=[],be=[];let xe=0;for(const ye of W){const Re=n.getFeatureState("",ye.id),Ce={type:"Unknown",id:ye.id,properties:ye.featureProperties},De=u.paint.get("model-rotation").evaluate(Ce,Re),Me=u.paint.get("model-scale").evaluate(Ce,Re),Te=u.paint.get("model-translation").evaluate(Ce,Re),Ne=u.paint.get("model-opacity").evaluate(Ce,Re);S_(u,ye.id,Re,ye.featureProperties,ye.nodeOverrideNames,ye.nodeOverrides),E_(u,ye.id,Re,ye.featureProperties,ye.materialOverrideNames,ye.materialOverrides),ye.nodeOverrides.size>0&&ye.computeBoundsAndApplyParent(),ye.computeModelMatrix(p,De,Me,Te,O,S,!1);const Ve=a.bA([]),He=a.ef(ye.position.lat,p.transform.zoom),Qe=a.bq([],[1,1,1/He]);a.br(Ve,Ve,ae),ne.push({zScaleMatrix:Qe,negCameraPosMatrix:Ve});for(const We of ye.nodes)od(p,We,ye.matrix,p.transform.expandedFarZProjMatrix,xe,le,be,ye.materialOverrides,Ne);xe++}if(le.sort((ye,Re)=>Re.depth-ye.depth),p.renderPass!=="shadow")eg(p,u,le,be,ne),Z();else{for(const ye of be)uf(ye.mesh,ye.nodeModelMatrix,p,u);for(const ye of le)uf(ye.mesh,ye.nodeModelMatrix,p,u);Z()}}},ng={line:function(p,n,u){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(n){const m=n.getVisibleCoordinates();for(const x of m){const A=n.getTile(x).getBucket(p);if(A&&(A.elevationType!=="none"?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,n,u){const m=n.getSource();if(!m.loaded())return;if(m.type==="vector"||m.type==="geojson")return void(u.modelManager&&u.modelManager.upload(u,cf(u,p)));if(m.type==="batched-model"||m.type!=="model")return;const x=m.getModels();for(const A of x)A.upload(u.context)},raster:function(p,n,u){const m=n.getSource();if(!(m instanceof Po&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const A=p.paint.get("raster-array-band")||m.getInitialBand(x);if(A==null)return;const S=n.getIds().map(O=>n.getTileByID(O));for(const O of S)O.updateNeeded(p.id,A)&&m.prepareTile(O,x,p.id,A)},"raster-particle":function(p,n,u){const m=n.getSource();if(!(m instanceof Po&&m.loaded()))return;const x=p.sourceLayer||m.rasterLayerIds&&m.rasterLayerIds[0];if(!x)return;const A=p.paint.get("raster-particle-array-band")||m.getInitialBand(x);if(A==null)return;const S=n.getIds().map(O=>n.getTileByID(O));for(const O of S)O.updateNeeded(p.id,A)&&m.prepareTile(O,x,p.id,A)}},Rp={fill:__},I_={fill:function(p,n,u,m){if(!u.layout||u.layout.get("fill-elevation-reference")==="none"||u.paint.get("fill-opacity").constantOr(1)===0)return;const x=p.context.gl,A=new mr(x.LEQUAL,mr.ReadOnly,p.depthRangeFor3D),S=new Rr({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),O=p.transform.getFreeCameraOptions().position,D=p.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const F of m){const N=n.getTile(F),Z=N.getBucket(u);if(!Z)continue;const $=Z.elevatedStructures;if(!$||$.depthSegments.segments[0].primitiveLength===0)continue;const W=ih(F.toUnwrapped(),O),ne=p.translatePosMatrix(F.projMatrix,N,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor")),te=th(ne,W,0,1,0);D.draw(p,x.TRIANGLES,A,S,zr.disabled,Cr.disabled,te,u.id,$.vertexBuffer,$.indexBuffer,$.depthSegments,u.paint,p.transform.zoom)}}};class ig{constructor(n,u,m,x,A){this.context=new xl(n,u),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this._timeStamp=a.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const S=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const D of S)this._debugParams.enabledLayers[D]=!0;for(const D of S);this.occlusionParams=new rg,this.setup(),this.numSublayers=va.maxUnderzooming+va.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.eP,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new np(this),this._wireframeDebugCache=new Op,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const O=new a.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,O,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x,this.worldview=A,this._forceEmissiveMode=!1,this.emissiveMode="constant"}updateTerrain(n,u){const m=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new rf(this,n));const x=this._terrain;this.transform.elevation=m?x:null,x.update(n,this.transform,u),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(n){const u=n.fog;if(!u||this.transform.projection.name==="globe"||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,x]=u.getFovAdjustedRange(this.transform._fov);if(m>x)return void(this.transform.fogCullDistSq=null);const A=m+.78*(x-m);this.transform.fogCullDistSq=A*A}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new rf(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,u){if(this.width=n*a.o.devicePixelRatio,this.height=u*a.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._mergedLayers[m].resize()}setup(){const n=this.context,u=new a.bd;u.emplaceBack(0,0),u.emplaceBack(a.al,0),u.emplaceBack(0,a.al),u.emplaceBack(a.al,a.al),this.tileExtentBuffer=n.createVertexBuffer(u,a.bf.members),this.tileExtentSegments=a.bg.simpleSegment(0,0,4,2);const m=new a.bd;m.emplaceBack(0,0),m.emplaceBack(a.al,0),m.emplaceBack(0,a.al),m.emplaceBack(a.al,a.al),this.debugBuffer=n.createVertexBuffer(m,a.bf.members),this.debugSegments=a.bg.simpleSegment(0,0,4,5);const x=new a.bd;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(x,a.bf.members),this.viewportSegments=a.bg.simpleSegment(0,0,4,2);const A=new a.b1;A.emplaceBack(0,0,0,0),A.emplaceBack(a.al,0,a.al,0),A.emplaceBack(0,a.al,0,a.al),A.emplaceBack(a.al,a.al,a.al,a.al),this.mercatorBoundsBuffer=n.createVertexBuffer(A,a.bi.members),this.mercatorBoundsSegments=a.bg.simpleSegment(0,0,4,2);const S=new a.b0;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S);const O=new a.be;for(const F of[0,1,3,2,0])O.emplaceBack(F);this.debugIndexBuffer=n.createIndexBuffer(O),this.emptyTexture=new a.T(n,new a.q({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=a.bC();const D=this.context.gl;this.stencilClearMode=new Rr({func:D.ALWAYS,mask:0},0,255,D.ZERO,D.ZERO,D.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,mr.disabled,this.stencilClearMode,zr.disabled,Cr.disabled,tf(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,u,m){if(!u||this.currentStencilSource===u.id||!n.isTileClipped()||!m||m.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const D of m)if(this._tileClippingMaskIDs[D.key]===void 0){O=!0;break}if(!O)return}this.currentStencilSource=u.id;const x=this.context,A=x.gl;this.nextStencilID+m.length>256&&this.clearStencil(),x.setColorMode(zr.disabled),x.setDepthMode(mr.disabled);const S=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of m){const D=u.getTile(O),F=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:N,tileBoundsIndexBuffer:Z,tileBoundsSegments:$}=this.getTileBoundsBuffers(D);S.draw(this,A.TRIANGLES,mr.disabled,new Rr({func:A.ALWAYS,mask:0},F,255,A.KEEP,A.KEEP,A.REPLACE),zr.disabled,Cr.disabled,tf(O.projMatrix),"$clipping",N,Z,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new Rr({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const u=this.context.gl;return new Rr({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(n){const u=this.context.gl,m=n.sort((S,O)=>O.overscaledZ-S.overscaledZ),x=m[m.length-1].overscaledZ,A=m[0].overscaledZ-x+1;if(A>1){this.currentStencilSource=void 0,this.nextStencilID+A>256&&this.clearStencil();const S={};for(let O=0;O<A;O++)S[O+x]=new Rr({func:u.GEQUAL,mask:255},O+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=A,[S,m]}return[{[x]:Rr.disabled},m]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new zr([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new a.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?zr.unblended:zr.alphaBlended}colorModeForDrapableLayerRenderPass(n){const u=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?n!=null&&this.emissiveMode!=="mrt-fallback"||this.emissiveMode==="constant"?new zr([u.ONE,u.ONE_MINUS_SRC_ALPHA,u.CONSTANT_ALPHA,u.ONE_MINUS_SRC_ALPHA],new a.ao(0,0,0,n??0),[!0,!0,!0,!0]):this.emissiveMode==="dual-source-blending"?new zr([u.ONE,u.ONE_MINUS_SRC_ALPHA,this.context.extBlendFuncExtended.SRC1_ALPHA_WEBGL,u.ONE_MINUS_SRC_ALPHA],a.ao.transparent,[!0,!0,!0,!0]):this.colorModeForRenderPass():this.colorModeForRenderPass()}depthModeForSublayer(n,u,m,x=!1){if(this.depthOcclusion)return new mr(this.context.gl.GREATER,mr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return mr.disabled;const A=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new mr(m||this.context.gl.LEQUAL,u,[A,A])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,u=Math.ceil(this.width),m=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),A=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===u&&this.depthFBO.height===m||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),u!==0&&m!==0&&(this.depthFBO=new Ic(this.context,u,m,0,"texture"),this.depthTexture=new a.T(this.context,{width:u,height:m,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),n.bindTexture(n.TEXTURE_2D,A),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,u,m,0,0,u,m,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,u)=>n+u/this._fpsHistory.length,0))}render(n,u){const m=a.o.now();this._dt=m-this._timeStamp,this._timeStamp=m,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=u;const x=this.style._mergedLayers,A=!(!this.terrain||!this.terrain.enabled),S=()=>this.style._getOrder(A).filter(et=>{const je=x[et];return!(je.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[je.type]});let O=S(),D=!1,F=!1,N=null,Z=0,$=!1;for(const et of O){const je=x[et];je.visibility!=="none"&&(je.type==="circle"?D=!0:je.type==="building"?(N=je,++Z):je.type==="symbol"&&(je.hasOcclusionOpacityProperties?F=!0:D=!0))}this.updateEmissiveMode();let W=O.map(et=>x[et]);const ne=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.o.now()),this.imageManager.beginFrame();for(const et in ne){const je=ne[et];je.used&&(je.prepare(this.context),je.getSource().usedInConflation&&++Z)}let te=!1;for(const et of W)et.isHidden(this.transform.zoom)||(et.type==="clip"&&(te=!0),this.prepareLayer(et));const ae={},le={},be={},xe={},ye={};for(const et in ne){const je=ne[et];ae[et]=je.getVisibleCoordinates(),le[et]=ae[et].slice().reverse(),be[et]=je.getVisibleCoordinates(!0).reverse(),xe[et]=je.getShadowCasterCoordinates(),ye[et]=je.sortCoordinatesByDistance(ae[et])}const Re=et=>{const je=this.style.getLayerSourceCache(et);return je&&je.used?je.getSource():null};if(Z||te||this._clippingActiveLastFrame){const et=[],je=[];let mt=0;for(const ot of W)this.isSourceForClippingOrConflation(ot,Re(ot))&&(et.push(ot),je.push(mt)),mt++;if(et&&(te||et.length>1)||this._clippingActiveLastFrame){te=!1;const ot=[];for(let bt=0;bt<et.length;bt++){const zt=et[bt],qt=je[bt],kt=this.style.getLayerSourceCache(zt);if(!kt||!kt.used||!kt.getSource().usedInConflation&&zt.type!=="clip"&&zt.type!=="building")continue;let Lt=a.eQ,hr=a.b_.None;const sr=[];let Zt=!0;if(zt.type==="building")Lt=a.eS;else if(zt.type==="clip")if(Lt=qt,zt.isHidden(this.transform.zoom))Zt=!1;else{if(!zt.layout){Zt=!1;continue}for(const lr of zt.layout.get("clip-layer-types"))hr|=lr==="model"?a.b_.Model:lr==="symbol"?a.b_.Symbol:a.b_.FillExtrusion;for(const lr of zt.layout.get("clip-layer-scope"))sr.push(lr);te=!0}Zt&&ot.push({layer:zt.fqid,cache:kt,order:Lt,clipMask:hr,clipScope:sr})}this.replacementSource.setSources(ot),$=!0}}this._clippingActiveLastFrame=te,$||this.replacementSource.clear(),this.conflationActive=$,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let et=0;et<W.length;et++){const je=W[et];if(je.visibility==="none")continue;const mt=je.cutoffRange();if(this.longestCutoffRange=Math.max(mt,this.longestCutoffRange),mt>0){const ot=Re(je);ot&&(this.minCutoffZoom=Math.max(ot.minzoom,this.minCutoffZoom)),je.minzoom&&(this.minCutoffZoom=Math.max(je.minzoom,this.minCutoffZoom))}je.is3D(A)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=et),this._lastOcclusionLayer=et)}const Ce=this.style&&this.style.fog;Ce?(this._fogVisible=Ce.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ce.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(be),this.opaquePassCutoff=0,O=S(),W=O.map(et=>x[et]));const De=this._shadowRenderer;if(De){De.updateShadowParameters(this.transform,this.style.directionalLight);for(const et in ne)for(const je of ae[et]){let mt={min:0,max:0};this.terrain&&(mt=this.terrain.getMinMaxForTile(je)||mt),De.addShadowReceiver(je.toUnwrapped(),mt.min,mt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.eR(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Qm(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Me=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Te=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Me&&!this._snow&&(this._snow=new df(this)),!Me&&this._snow&&(this._snow.destroy(),delete this._snow),Te&&!this._rain&&(this._rain=new Pp(this)),!Te&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),N){this.buildingTileBorderManager||(this.buildingTileBorderManager=new sh);const et=this.style.getLayerSourceCache(N);this.buildingTileBorderManager.updateBorders(et,N)}if(!Fn.has(this.context.gl))return;this.renderPass="offscreen";for(const et of W){const je=n.getLayerSourceCache(et);if(!et.hasOffscreenPass()||et.isHidden(this.transform.zoom))continue;const mt=je?le[je.id]:void 0;(et.type==="custom"||et.type==="raster"||et.type==="raster-particle"||et.isSky()||mt&&mt.length)&&this.renderLayer(this,je,et,mt)}this.depthRangeFor3D=[0,1-(W.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,xe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ne=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ve=(()=>{if(u.showOverdrawInspector)return a.ao.black;const et=this.style.fog;if(et&&this.transform.projection.supportsFog){const je=this.style.getLut(et.scope);if(!Ne){const mt=et.properties.get("color-use-theme")==="none",ot=et.properties.get("color").toNonPremultipliedRenderColor(mt?null:je).toArray01();return new a.ao(...ot)}if(Ne){const mt=et.properties.get("space-color-use-theme")==="none",ot=et.properties.get("space-color").toNonPremultipliedRenderColor(mt?null:je).toArray01();return new a.ao(...ot)}}return a.ao.transparent})();if(this.context.clear({color:Ve,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=O.length-1;this.currentLayer>=0;this.currentLayer--){const et=W[this.currentLayer],je=n.getLayerSourceCache(et);if(et.isSky())continue;const mt=je?(et.is3D(A)?ye:le)[je.id]:void 0;this._renderTileClippingMasks(et,je,mt),this.renderLayer(this,je,et,mt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ne&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<O.length;this.currentLayer++){const et=W[this.currentLayer],je=n.getLayerSourceCache(et);et.isSky()&&this.renderLayer(this,je,et,je?le[je.id]:void 0)}function He(et,je){let mt;return je&&(mt=(et.type==="symbol"?be:et.is3D(A)?ye:le)[je.id]),mt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<O.length;){const et=W[this.currentLayer];if(et.type==="raster"||et.type==="raster-particle"){const je=n.getLayerSourceCache(et);this.renderLayer(this,je,et,He(et,je))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;const Qe=De?De.getGroundShadowLayerIndex():-1;let We=!1,ut=-1;for(let et=0;et<O.length;++et){const je=W[et];je.isHidden(this.transform.zoom)||je.is3D(A)&&(ut=et)}F&&ut===-1&&(D=!0);let wt=!1;for(;this.currentLayer<O.length;){const et=W[this.currentLayer],je=n.getLayerSourceCache(et);if(et.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(et)){if(et.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!wt&&et.is3D(A)&&!A){const mt=this.currentLayer,ot=bt=>{for(this.currentLayer=0;this.currentLayer<W.length;this.currentLayer++){const zt=W[this.currentLayer];if(Rp[zt.type]){const qt=this.style.getLayerSourceCache(zt);Rp[zt.type](this,qt,zt,He(zt,qt),bt)}}};ot("initialize"),ot("reset"),this.currentLayer=mt,wt=!0}if(D&&!We&&this.terrain&&!this.transform.isOrthographic&&(We=!0,this.blitDepth()),F&&ut!==-1&&this.currentLayer===ut+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(et,je,je?ae[je.id]:void 0),this.renderLayer(this,je,et,He(et,je)),!this.terrain&&De&&this.currentLayer===Qe){{this.clearStencil(),this.resetStencilClippingMasks();const mt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<W.length;this.currentLayer++){const ot=W[this.currentLayer];if(I_[ot.type]){const bt=this.style.getLayerSourceCache(ot);I_[ot.type](this,bt,ot,He(ot,bt))}}this.currentLayer=mt}if(De.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const mt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=mt;this.currentLayer++){const ot=W[this.currentLayer];if(!ot.hasLightBeamPass())continue;const bt=n.getLayerSourceCache(ot);this.renderLayer(this,bt,ot,bt?le[bt.id]:void 0)}this.currentLayer=mt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const mt=this.currentLayer;this.depthOcclusion=!0;for(const ot of this.layersWithOcclusionOpacity){this.currentLayer=ot;const bt=W[this.currentLayer],zt=n.getLayerSourceCache(bt),qt=zt?le[zt.id]:void 0;this.terrain||this._renderTileClippingMasks(bt,zt,zt?ae[zt.id]:void 0),this.renderLayer(this,zt,bt,qt)}this.depthOcclusion=!1,this.currentLayer=mt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let et=null;W.forEach(je=>{const mt=n.getLayerSourceCache(je);mt&&!je.isHidden(this.transform.zoom)&&mt.getVisibleCoordinates().length&&(!et||et.getSource().maxzoom<mt.getSource().maxzoom)&&(et=mt)}),et&&this.options.showTileBoundaries&&v_(this,et,et.getVisibleCoordinates(),a.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&v_(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(et){const je=et.transform.padding;x_(et,et.transform.height-(je.top||0),3,Wm),x_(et,je.bottom||0,3,Ym),b_(et,je.left||0,3,Km),b_(et,et.transform.width-(je.right||0),3,xv);const mt=et.transform.centerPoint;(function(ot,bt,zt,qt){Mp(ot,bt-1,zt-10,2,20,qt),Mp(ot,bt-10,zt-1,20,2,qt)})(et,mt.x,et.transform.height-mt.y,bv)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),$||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:u}=this.transform.projection,m=!u||!u.includes(n.type);if(ng[n.type]&&(m||this.terrain&&n.type==="custom")){const x=this.style.getLayerSourceCache(n);ng[n.type](n,x,this)}this.gpuTimingEnd()}renderLayer(n,u,m,x){m.isHidden(this.transform.zoom)||(m.type==="background"||m.type==="sky"||m.type==="custom"||m.type==="model"||m.type==="raster"||m.type==="raster-particle"||x&&x.length)&&(this.id=m.id,this.gpuTimingStart(m),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(m.type)&&(!n.terrain||m.type!=="custom")||m.type==="clip"||Xl[m.type](n,u,m,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery,m=this.context.gl;let x=this.gpuTimers[n.id];x||(x=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:m.createQuery()}),x.calls++,m.beginQuery(u.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,u=this.context.gl,m=u.createQuery();this.deferredRenderGpuTimeQueries.push(m),u.beginQuery(n.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const u={};for(const m in n){const x=n[m],A=this.context.extTimerQuery,S=A.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;A.deleteQueryEXT(x.query),u[m]=S}return u}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const u=this.context.gl;let m=0;for(const x of n)m+=u.getQueryParameter(x,u.QUERY_RESULT)/1e6,u.deleteQuery(x);return m}translatePosMatrix(n,u,m,x,A){if(!m[0]&&!m[1])return n;const S=A?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(S){const F=Math.sin(S),N=Math.cos(S);m=[m[0]*N-m[1]*F,m[0]*F+m[1]*N]}const O=[A?m[0]:a.ay(u,m[0],this.transform.zoom),A?m[1]:a.ay(u,m[1],this.transform.zoom),0],D=new Float32Array(16);return a.br(D,n,O),D}saveTileTexture(n){if(n.context!==this.context)return;const u=n.size[0],m=this._tileTextures[u];m?m.push(n):this._tileTextures[u]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,u,m){const x=m===void 0?this.terrain&&this.terrain.renderingToTexture:m,A=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(A.push("LIGHTING_3D_MODE"),A.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||A.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||A.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(A.push("TERRAIN"),this.linearFloatFilteringSupported()&&A.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&A.push("GLOBE"),!this._fogVisible||x||u!==void 0&&!u||A.push("FOG"),x&&A.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&A.push("OVERDRAW_INSPECTOR"),A}getOrCreateProgram(n,u){this.cache=this.cache||{};const m=u&&u.defines||[],x=u&&u.config,A=this.currentGlobalDefines(n,u&&u.overrideFog,u&&u.overrideRtt).concat(m),S=gp.cacheKey(Fm[n],n,A,x);return this.cache[S]||(this.cache[S]=new gp(this.context,n,Fm[n],x,wp[n],A)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,u){if(this.style.enable3dLights()){const m=this.style.directionalLight,x=this.style.ambientLight;if(m&&x){const A=((S,O,D)=>{const F=S.properties.get("direction"),N=S.properties.get("color-use-theme")==="none",Z=S.properties.get("color").toNonPremultipliedRenderColor(N?null:D.getLut(S.scope)).toArray01(),$=S.properties.get("intensity"),W=O.properties.get("color-use-theme")==="none",ne=O.properties.get("color").toNonPremultipliedRenderColor(W?null:D.getLut(O.scope)).toArray01(),te=O.properties.get("intensity"),ae=[F.x,F.y,F.z],le=a.dN(ne,te),be=a.dN(Z,$);return{u_lighting_ambient_color:le,u_lighting_directional_dir:ae,u_lighting_directional_color:be,u_ground_radiance:Wh(ae,be,le)}})(m,x,this.style);u.setLightsUniformValues(n,A)}}}uploadCommonUniforms(n,u,m,x,A){if(this.uploadCommonLightUniforms(n,u),this.terrain&&this.terrain.renderingToTexture)return;const S=this.style.fog;if(S){const O=S.getOpacity(this.transform.pitch),D=((F,N,Z,$,W,ne,te,ae,le,be,xe,ye)=>{const Re=F.transform,Ce=N.properties.get("color-use-theme")==="none",De=N.properties.get("color").toNonPremultipliedRenderColor(Ce?null:F.style.getLut(N.scope)).toArray01();De[3]=$;const Me=F.frameCounter/1e3%1,[Te,Ne]=N.properties.get("vertical-range");return{u_fog_matrix:Z?Re.calculateFogTileMatrix(Z):ye||F.identityMat,u_fog_range:N.getFovAdjustedRange(Re._fov),u_fog_color:De,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Te,Ne),Ne],u_fog_temporal_offset:Me,u_frustum_tl:W,u_frustum_tr:ne,u_frustum_br:te,u_frustum_bl:ae,u_globe_pos:le,u_globe_radius:be,u_viewport:xe,u_globe_transition:a.aj(Re.zoom),u_is_globe:+(Re.projection.name==="globe")}})(this,S,m,O,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.o.devicePixelRatio,this.transform.height*a.o.devicePixelRatio],x);u.setFogUniformValues(n,D)}A&&u.setCutoffUniformValues(n,A.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,u=n.createTexture();return n.bindTexture(n.TEXTURE_2D,u),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,u=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const x of m)u[x.key]=n[x.key]||new Wc(x,512,this.transform.tileZoom,this,void 0,this.worldview);return u}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,u){return!(!n.is3D(!(!this.terrain||!this.terrain.enabled))||n.type!=="clip"&&n.type!=="building"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building"&&n.sourceLayer!=="procedural_buildings")&&(!u||u.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let u=this._cachedTileFogOpacities[n.key];return u||(this._cachedTileFogOpacities[n.key]=u=this.style.fog.getOpacityForTile(n)),u[0]>=Wt||u[1]>=Wt}setupDepthForOcclusion(n,u,m){const x=this.context,A=x.gl,S=!!m;var O;m||(m={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(A.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),m.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],m.u_depth_range_unpack=[2/((O=this.depthRangeFor3D)[1]-O[0]),-1-2*O[0]/(O[1]-O[0])],m.u_occluder_half_size=.5*this.occlusionParams.occluderSize,m.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(A.NEAREST,A.CLAMP_TO_EDGE),x.activeTexture.set(A.TEXTURE0),S||u.setTerrainUniformValues(x,m)}updateEmissiveMode(){if(this._forceEmissiveMode)return;const n=this.style.hasDataDrivenEmissiveStrength();this.emissiveMode=n?this.context.extBlendFuncExtended?"dual-source-blending":"mrt-fallback":"constant"}}function ag(p,n){let u=!1,m=null;const x=()=>{m=null,u&&(p(),m=setTimeout(x,n),u=!1)};return()=>(u=!0,m||x(),m)}class No{constructor(n){this._hashName=n&&encodeURIComponent(n),a.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ag(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const u=P_(n);if(this._hashName){const m=this._hashName;let x=!1;const A=location.hash.slice(1).split("&").map(S=>{const O=S.split("=")[0];return O===m?(x=!0,`${O}=${u}`):S}).filter(S=>S);return x||A.push(`${m}=${u}`),`#${A.join("&")}`}return`#${u}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const u=this._getCurrentHash();if(u.length>=3&&!u.some(m=>isNaN(Number(m)))){const m=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(u[3]||0):n.getBearing();return n.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:m,pitch:+(u[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function P_(p,n){const u=p.getCenter(),m=Math.round(100*p.getZoom())/100,x=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),A=Math.pow(10,x),S=Math.round(u.lng*A)/A,O=Math.round(u.lat*A)/A,D=p.getBearing(),F=p.getPitch();let N=n?`/${S}/${O}/${m}`:`${m}/${O}/${S}`;return(D||F)&&(N+="/"+Math.round(10*D)/10),F&&(N+=`/${Math.round(F)}`),N}const Bs={linearity:.3,easing:a.eT(0,0,.3,1)},Tv=Object.assign({deceleration:2500,maxSpeed:1400},Bs),ai=Object.assign({deceleration:20,maxSpeed:1400},Bs),en=Object.assign({deceleration:1e3,maxSpeed:360},Bs),zp=Object.assign({deceleration:1e3,maxSpeed:90},Bs);class _u{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.o.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=a.o.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const u={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:A}of this._inertiaBuffer)u.zoom+=A.zoomDelta||0,u.bearing+=A.bearingDelta||0,u.pitch+=A.pitchDelta||0,A.panDelta&&u.pan._add(A.panDelta),A.around&&(u.around=A.around),A.pinchAround&&(u.pinchAround=A.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const A=Rc(u.pan.mag(),m,Object.assign({},Tv,n||{}));x.offset=u.pan.mult(A.amount/u.pan.mag()),x.center=this._map.transform.center,Zl(x,A)}if(u.zoom){const A=Rc(u.zoom,m,ai);x.zoom=this._map.transform.zoom+A.amount,Zl(x,A)}if(u.bearing){const A=Rc(u.bearing,m,en);x.bearing=this._map.transform.bearing+a.aA(A.amount,-179,179),Zl(x,A)}if(u.pitch){const A=Rc(u.pitch,m,zp);x.pitch=this._map.transform.pitch+A.amount,Zl(x,A)}if(x.zoom||x.bearing){const A=u.pinchAround===void 0?u.around:u.pinchAround;x.around=A?this._map.unproject(A):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Zl(p,n){(!p.duration||p.duration<n.duration)&&(p.duration=n.duration,p.easing=n.easing)}function Rc(p,n,u){const{maxSpeed:m,linearity:x,deceleration:A}=u,S=a.aA(p*x/(n/1e3),-m,m),O=Math.abs(S)/(A*x);return{easing:u.easing,duration:1e3*O,amount:S*(O/2)}}class ja extends a.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,m,x={}){const A=Le(u.getCanvasContainer(),m),S=u.unproject(A);super(n,Object.assign({point:A,lngLat:S,originalEvent:m},x)),this._defaultPrevented=!1,this.target=u}}class ff extends a.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,m){const x=n==="touchend"?m.changedTouches:m.touches,A=Ue(u.getCanvasContainer(),x),S=A.map(D=>u.unproject(D)),O=A.reduce((D,F,N,Z)=>D.add(F.div(Z.length)),new a.P(0,0));super(n,{points:A,point:O,lngLats:S,lngLat:u.unproject(O),originalEvent:m}),this._defaultPrevented=!1}}class Lp extends a.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u){super("wheel",{originalEvent:u}),this._defaultPrevented=!1}}class Ea{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new Lp(this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new ja(n.type,this._map,n))}mouseup(n){this._map.fire(new ja(n.type,this._map,n))}preclick(n){const u=new MouseEvent("preclick",n);this._map.fire(new ja(u.type,this._map,u))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(n),this._map.fire(new ja(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new ja(n.type,this._map,n))}mouseover(n){this._map.fire(new ja(n.type,this._map,n))}mouseout(n){this._map.fire(new ja(n.type,this._map,n))}touchstart(n){return this._firePreventable(new ff(n.type,this._map,n))}touchmove(n){this._map.fire(new ff(n.type,this._map,n))}touchend(n){this._map.fire(new ff(n.type,this._map,n))}touchcancel(n){this._map.fire(new ff(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oo{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new ja(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ja("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ja(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class tl{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(ge(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const m=u,x=this._startPos,A=this._lastPos;if(!x||!A||A.equals(m)||!this._box&&m.dist(x)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=H("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const S=Math.min(x.x,m.x),O=Math.max(x.x,m.x),D=Math.min(x.y,m.y),F=Math.max(x.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${D}px)`,this._box.style.width=O-S+"px",this._box.style.height=F-D+"px")})}mouseupWindow(n,u){if(!this._active)return;const m=this._startPos,x=u;if(m&&n.button===0){if(this.reset(),ve(),m.x!==x.x||m.y!==x.y)return this._map.fire(new a.z("boxzoomend",{originalEvent:n})),{cameraAnimation:A=>A.fitScreenCoordinates(m,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),se(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new a.z(n,{originalEvent:u}))}}function Wl(p,n){const u={};for(let m=0;m<p.length;m++)u[p[m].identifier]=n[m];return u}class cd{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),m.length===this.numTouches&&(this.centroid=(function(x){const A=new a.P(0,0);for(const S of x)A._add(S);return A.div(x.length)})(u),this.touches=Wl(m,u)))}touchmove(n,u,m){if(this.aborted||!this.centroid)return;const x=Wl(m,u);for(const A in this.touches){const S=x[A];(!S||S.dist(this.touches[A])>30)&&(this.aborted=!0)}}touchend(n,u,m){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),m.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class ud{constructor(n){this.singleTap=new cd(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,u,m){this.singleTap.touchstart(n,u,m)}touchmove(n,u,m){this.singleTap.touchmove(n,u,m)}touchend(n,u,m){const x=this.singleTap.touchend(n,u,m);if(x){const A=n.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(x)<30;if(A&&S||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class hd{constructor(){this._zoomIn=new ud({numTouches:1,numTaps:2}),this._zoomOut=new ud({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,m){this._zoomIn.touchstart(n,u,m),this._zoomOut.touchstart(n,u,m)}touchmove(n,u,m){this._zoomIn.touchmove(n,u,m),this._zoomOut.touchmove(n,u,m)}touchend(n,u,m){const x=this._zoomIn.touchend(n,u,m),A=this._zoomOut.touchend(n,u,m);return x?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(x)},{originalEvent:n})}):A?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(A)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const og=0,Yl=2,sg={[og]:1,[Yl]:2},rl={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class ch{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,u){return!1}_move(n,u){return{}}mousedown(n,u){if(this._lastPoint)return;const m=tt(n);this._correctButton(n,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(n,u){const m=this._lastPoint;if(m){if(n.preventDefault(),this._eventButton!=null&&(function(x,A){const S=sg[A];return x.buttons===void 0||(x.buttons&S)!==S})(n,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}}mouseupWindow(n){this._lastPoint&&tt(n)===this._eventButton&&(this._moved&&ve(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pf extends ch{mousedown(n,u){super.mousedown(n,u),this._lastPoint&&(this._active=!0)}_correctButton(n,u){return u===0&&!n.ctrlKey}_move(n,u){return{around:u,panDelta:u.sub(n)}}}class Bp extends ch{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?rl[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const m=.8*(u.x-n.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class kp extends ch{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?rl[n.pitchRotateKey]:void 0}_correctButton(n,u){return this._pitchRotateKey?u===0&&n[this._pitchRotateKey]:u===0&&n.ctrlKey||u===2}_move(n,u){const m=-.5*(u.y-n.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class pa{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(n,u,m){return this._calculateTransform(n,u,m)}touchmove(n,u,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(m.length===1&&!a.eU())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,u,m)}}touchend(n,u,m){this._calculateTransform(n,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,m){m.length>0&&(this._active=!0);const x=Wl(m,u),A=new a.P(0,0),S=new a.P(0,0);let O=0;for(const F in x){const N=x[F],Z=this._touches[F];Z&&(A._add(N),S._add(N.sub(Z)),O++,x[F]=N)}if(this._touches=x,O<this._minTouches||!S.mag())return;const D=S.div(O);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:A.div(O),panDelta:D}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=H("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class dd{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,u,m){return{}}touchstart(n,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,m){const x=this._firstTwoTouches;if(!x)return;n.preventDefault();const[A,S]=x,O=uh(m,u,A),D=uh(m,u,S);if(!O||!D)return;const F=this._aroundCenter?null:O.add(D).div(2);return this._move([O,D],F,n)}touchend(n,u,m){if(!this._firstTwoTouches)return;const[x,A]=this._firstTwoTouches,S=uh(m,u,x),O=uh(m,u,A);S&&O||(this._active&&ve(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function uh(p,n,u){for(let m=0;m<p.length;m++)if(p[m].identifier===u)return n[m]}function mf(p,n){return Math.log2(p/n)}class hh extends dd{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const m=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(mf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mf(this._distance,m),pinchAround:u}}}function gf(p,n){return 180*p.angleWith(n)/Math.PI}class _f extends dd{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u){const m=this._vector;if(this._vector=n[0].sub(n[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:gf(this._vector,m),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const x=gf(n,m);return Math.abs(x)<u}}function fd(p){return Math.abs(p.y)>Math.abs(p.x)}class dh extends dd{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,fd(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,m){const x=this._lastPoints;if(!x)return;const A=n[0].sub(x[0]),S=n[1].sub(x[1]);return this._map._cooperativeGestures&&!a.eU()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(A,S,m.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(A.y+S.y)/2*-.5})}gestureBeginsVertically(n,u,m){if(this._valid!==void 0)return this._valid;const x=n.mag()>=2,A=u.mag()>=2;if(!x&&!A)return;if(!x||!A)return this._firstMove==null&&(this._firstMove=m),m-this._firstMove<100&&void 0;const S=n.y>0==u.y>0;return fd(n)&&fd(u)&&S}}const Fp={panStep:100,bearingStep:15,pitchStep:10};class yf{constructor(){const n=Fp;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,m=0,x=0,A=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?m=-1:(n.preventDefault(),A=-1);break;case 39:n.shiftKey?m=1:(n.preventDefault(),A=1);break;case 38:n.shiftKey?x=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?x=-1:(n.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(m=0,x=0),{cameraAnimation:O=>{const D=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:Kl,zoom:u?Math.round(D)+u*(n.shiftKey?2:1):D,bearing:O.getBearing()+m*this._bearingStep,pitch:O.getPitch()+x*this._pitchStep,offset:[-A*this._panStep,-S*this._panStep],center:O.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Kl(p){return p*(2-p)}const pd=4.000244140625,D_=1/450;class Np{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._handler=u,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=D_,a.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||a.eU()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const m=a.o.now(),x=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,u!==0&&u%pd===0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Le(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const u=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>pd?this._wheelZoomRate:this._defaultZoomRate;let N=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&N!==0&&(N=1/N);const Z=u(),$=Math.pow(2,Z),W=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):$;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(W*N))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const m=typeof this._targetZoom=="number"?this._targetZoom:u(),x=this._startZoom,A=this._easing;let S,O=!1;if(this._type==="wheel"&&x&&A){const F=Math.min((a.o.now()-this._lastWheelEventTime)/200,1),N=A(F);S=a.ak(x,m,N),F<1?this._frameId||(this._frameId=!0):O=!0}else S=m,O=!0;this._active=!0,O&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let D=S-u();return D*this._lastDelta<0&&(D=0),{noInertia:!0,needsRenderFrame:!O,zoomDelta:D,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=a.eV;if(this._prevEase){const m=this._prevEase,x=(a.o.now()-m.start)/m.duration,A=m.easing(x+.01)-m.easing(x),S=.27/Math.sqrt(A*A+1e-4)*.01,O=Math.sqrt(.0729-S*S);u=a.eT(S,O,.25,1)}return this._prevEase={start:a.o.now(),duration:n,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=H("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class zc{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class lg{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,u){return n.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(n.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class R_{constructor(){this._tap=new ud({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,u,m){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(n,u,m))}touchmove(n,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const x=u[0],A=x.y-this._swipePoint.y;return this._swipePoint=x,n.preventDefault(),this._active=!0,{zoomDelta:A/128}}}else this._tap.touchmove(n,u,m)}touchend(n,u,m){this._tapTime?this._swipePoint&&m.length===0&&this.reset():this._tap.touchend(n,u,m)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jp{constructor(n,u,m){this._el=n,this._mousePan=u,this._touchPan=m}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vf{constructor(n,u,m){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ia{constructor(n,u,m,x){this._el=n,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Up=p=>p.zoom||p.drag||p.pitch||p.rotate;class Sv extends a.z{}class z_{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,u){const m=a.av([],u,n);this.radius=a.ag(m[2]<0?a.eX([],m,this.constants):[m[0],m[1],0])}projectRay(n){a.eX(n,n,this.constants),a.aw(n,n),a.eY(n,n,this.constants);const u=a.c5([],n,this.radius);if(u[2]>0){const m=a.c5([],[0,0,1],a.bJ(u,[0,0,1])),x=a.c5([],a.aw([],[u[0],u[1],0]),this.radius),A=a.d8([],u,a.c5([],a.av([],a.d8([],x,m),u),2));u[0]=A[0],u[1]=A[1]}return u}}function yu(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class vu{constructor(n,u){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _u(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new z_,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.aY(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,A,S]of this._listeners){const O=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(A,O,S)}}destroy(){for(const[n,u,m]of this._listeners){const x=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(u,x,m)}}_addDefaultHandlers(n){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new Ea(u,n));const x=u.boxZoom=new tl(u,n);this._add("boxZoom",x);const A=new hd,S=new lg;u.doubleClickZoom=new zc(S,A),this._add("tapZoom",A),this._add("clickZoom",S);const O=new R_;this._add("tapDragZoom",O);const D=u.touchPitch=new dh(u);this._add("touchPitch",D);const F=new Bp(n),N=new kp(n);u.dragRotate=new vf(n,F,N),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]);const Z=new pf(n),$=new pa(u,n);u.dragPan=new jp(m,Z,$),this._add("mousePan",Z),this._add("touchPan",$,["touchZoom","touchRotate"]);const W=new _f,ne=new hh;u.touchZoomRotate=new ia(m,ne,W,O),this._add("touchRotate",W,["touchPan","touchZoom"]),this._add("touchZoom",ne,["touchPan","touchRotate"]),this._add("blockableMapEvent",new oo(u));const te=u.scrollZoom=new Np(u,this);this._add("scrollZoom",te,["mousePan"]);const ae=u.keyboard=new yf;this._add("keyboard",ae);for(const le of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[le]&&u[le].enable(n[le])}_add(n,u,m){this._handlers.push({handlerName:n,handler:u,allowed:m}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Up(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,u,m){for(const x in n)if(x!==m&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const u=[];for(const m of n)this._el.contains(m.target)&&u.push(m);return u}handleEvent(n,u){this._updatingCamera=!0;const m=n.type==="renderFrame",x=m?void 0:n,A={needsRenderFrame:!1},S={},O={},D=n.touches?this._getMapTouches(n.touches):void 0,F=D?Ue(this._el,D):m?void 0:Le(this._el,n);for(const{handlerName:$,handler:W,allowed:ne}of this._handlers){if(!W.isEnabled())continue;let te;this._blockedByActive(O,ne,$)?W.reset():W[u||n.type]&&(te=W[u||n.type](n,F,D),this.mergeHandlerResult(A,S,te,$,x),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||W.isActive())&&(O[$]=W)}const N={};for(const $ in this._previousActiveHandlers)O[$]||(N[$]=x);this._previousActiveHandlers=O,(Object.keys(N).length||yu(A))&&(this._changes.push([A,S,N]),this._triggerRenderFrame()),(Object.keys(O).length||yu(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=A;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(n,u,m,x,A){if(!m)return;Object.assign(n,m);const S={handlerName:x,originalEvent:m.originalEvent||A};m.zoomDelta!==void 0&&(u.zoom=S),m.panDelta!==void 0&&(u.drag=S),m.pitchDelta!==void 0&&(u.pitch=S),m.bearingDelta!==void 0&&(u.rotate=S)}_applyChanges(){const n={},u={},m={};for(const[x,A,S]of this._changes)x.panDelta&&(n.panDelta=(n.panDelta||new a.P(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(n.around=x.around),x.aroundCoord!==void 0&&(n.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),Object.assign(u,A),Object.assign(m,S);this._updateMapTransform(n,u,m),this._changes=[]}_updateMapTransform(n,u,m){const x=this._map,A=x.transform,S=be=>[be.x,be.y,be.z];if((()=>{const be=this._eventsInProgress.drag;return be&&!this._handlersById[be.handlerName].isActive()})()&&!yu(n)){const be=A.zoom;A.cameraElevationReference="sea",this._originalZoom!=null&&A._orthographicProjectionAtLowPitch&&A.projection.name!=="globe"&&A.pitch===0?(A.cameraElevationReference="ground",A.zoom=this._originalZoom):(A.recenterOnTerrain(),A.cameraElevationReference="ground"),be!==A.zoom&&this._map._update(!0)}if(A._isCameraConstrained&&x._stop(!0),!yu(n))return void this._fireEvents(u,m,!0);let{panDelta:O,zoomDelta:D,bearingDelta:F,pitchDelta:N,around:Z,aroundCoord:$,pinchAround:W}=n;A._isCameraConstrained&&(D>0&&(D=0),A._isCameraConstrained=!1),W!==void 0&&(Z=W),(D||(be=>u[be]&&!this._eventsInProgress[be])("drag"))&&Z&&(this._dragOrigin=S(A.pointCoordinate3D(Z)),this._originalZoom=A.zoom,this._trackingEllipsoid.setup(A._camera.position,this._dragOrigin)),A.cameraElevationReference="sea",x._stop(!0),Z=Z||x.transform.centerPoint,F&&(A.bearing+=F),N&&(A.pitch+=N),A._updateCameraState();const ne=[0,0,0];if(O)if(A.projection.name==="mercator"){const be=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(Z).dir),xe=this._trackingEllipsoid.projectRay(A.screenPointToMercatorRay(Z.sub(O)).dir);ne[0]=xe[0]-be[0],ne[1]=xe[1]-be[1]}else{const be=A.pointCoordinate(Z);if(A.projection.name==="globe"){O=O.rotate(-A.angle);const xe=A._pixelsPerMercatorPixel/A.worldSize;ne[0]=-O.x*a.eW(a.a$(be.y))*xe,ne[1]=-O.y*a.eW(A.center.lat)*xe}else{const xe=A.pointCoordinate(Z.sub(O));be&&xe&&(ne[0]=xe.x-be.x,ne[1]=xe.y-be.y)}}const te=A.zoom,ae=[0,0,0];if(D){const be=S($||A.pointCoordinate3D(Z)),xe={dir:a.aw([],a.av([],be,A._camera.position))};if(xe.dir[2]<0){const ye=A.zoomDeltaToMovement(be,D);a.c5(ae,xe.dir,ye)}}const le=a.d8(ne,ne,ae);A._translateCameraConstrained(le),D&&Math.abs(A.zoom-te)>1e-4&&A.recenterOnTerrain(),A.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,m,!0)}_fireEvents(n,u,m){const x=Up(this._eventsInProgress),A=Up(n),S={};for(const N in n){const{originalEvent:Z}=n[N];this._eventsInProgress[N]||(S[`${N}start`]=Z),this._eventsInProgress[N]=n[N]}!x&&A&&this._fireEvent("movestart",A.originalEvent);for(const N in S)this._fireEvent(N,S[N]);A&&this._fireEvent("move",A.originalEvent);for(const N in n){const{originalEvent:Z}=n[N];this._fireEvent(N,Z)}const O={};let D;for(const N in this._eventsInProgress){const{handlerName:Z,originalEvent:$}=this._eventsInProgress[N];this._handlersById[Z].isActive()||(delete this._eventsInProgress[N],D=u[Z]||$,O[`${N}end`]=D)}for(const N in O)this._fireEvent(N,O[N]);const F=Up(this._eventsInProgress);if(m&&(x||A)&&!F){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;N?(Z(N.bearing||this._map.getBearing())&&(N.bearing=0),this._map.easeTo(N,{originalEvent:D})):(this._map.fire(new a.z("moveend",{originalEvent:D})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new a.z(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Sv("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const cg="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class L_ extends a.E{constructor(n,u){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=u.bearingSnap,this._respectPrefersReducedMotion=u.respectPrefersReducedMotion!==!1,a.aY(["_renderFrameCallback"],this)}getCenter(){return new a.aT(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}panBy(n,u,m){return n=a.P.convert(n).mult(-1),this.panTo(this.transform.center,Object.assign({offset:n},u),m)}panTo(n,u,m){return this.easeTo(Object.assign({center:n},u),m)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,m){return this.easeTo(Object.assign({zoom:n},u),m)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,m){return this.easeTo(Object.assign({bearing:n},u),m)}resetNorth(n,u){return this.rotateTo(0,Object.assign({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}cameraForBounds(n,u){n=a.aI.convert(n);const m=u&&u.bearing||0,x=u&&u.pitch||0,A=n.getNorthWest(),S=n.getSouthEast();return this._cameraForBounds(this.transform,A,S,m,x,u)}_extendPadding(n){const u={top:0,right:0,bottom:0,left:0};return n==null?Object.assign({},u,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:Object.assign({},u,n)}_extendCameraOptions(n){return(n=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,u){const m=u.max[0]-u.min[0],x=u.max[1]-u.min[1];return m/x>n.aspect?m/(2*Math.tan(.5*n.fovX)*n.aspect):x/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,u,m,x,A,S){const O=n.clone(),D=this._extendCameraOptions(S);O.bearing=x,O.pitch=A;const F=a.aT.convert(u),N=a.aT.convert(m),Z=.5*(F.lat+N.lat),$=.5*(F.lng+N.lng),W=a.eZ(Z,$),ne=a.aw([],W),te=a.aw([],a.bI([],ne,[0,1,0])),ae=a.bI([],te,ne),le=[te[0],te[1],te[2],0,ae[0],ae[1],ae[2],0,ne[0],ne[1],ne[2],0,0,0,0,1],be=[W,a.eZ(F.lat,F.lng),a.eZ(N.lat,F.lng),a.eZ(N.lat,N.lng),a.eZ(F.lat,N.lng),a.eZ(Z,F.lng),a.eZ(Z,N.lng),a.eZ(F.lat,$),a.eZ(N.lat,$)];let xe=a.d9.fromPoints(be.map(ot=>[a.bJ(te,ot),a.bJ(ae,ot),a.bJ(ne,ot)]));const ye=a.af([],xe.center,le);a.e_(ye)===0&&a.e$(ye,0,0,1),a.aw(ye,ye),a.c5(ye,ye,a.aD),O.center=a.f0(ye);const Re=O.getWorldToCameraMatrix(),Ce=a.bl(new Float64Array(16),Re);xe=a.d9.applyTransform(xe,a.aB([],Re,le));const De=this._extendAABB(xe,O,D,x);if(!De)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");xe=De,a.af(ye,ye,Re);const Me=.5*(xe.max[2]-xe.min[2]),Te=this._minimumAABBFrustumDistance(O,xe),Ne=a.c5([],[0,0,1],Me),Ve=a.d8(Ne,ye,Ne),He=Te+(O.pitch===0?0:a.bG(ye,Ve)),Qe=O.globeCenterInViewSpace,We=a.av([],ye,[Qe[0],Qe[1],Qe[2]]);a.aw(We,We),a.c5(We,We,He);const ut=a.d8([],ye,We);a.af(ut,ut,Ce);const wt=a.eM/a.aD,et=a.ag(ut),je=a.cf(Math.max(et*wt-a.eM,Number.EPSILON),0),mt=Math.min(O.zoomFromMercatorZAdjusted(je),D.maxZoom);return mt>.5*(a.c_+a.cL)?(O.setProjection({name:"mercator"}),O.zoom=mt,this._cameraForBounds(O,u,m,x,A,S)):{center:O.center,zoom:mt,bearing:x,pitch:A}}_extendAABB(n,u,m,x){const A=.5*((m.padding.left||0)+(m.padding.right||0)),S=.5*((m.padding.top||0)+(m.padding.bottom||0)),O=S,D=A,F=A,N=S,Z=u.width-(D+F),$=u.height-(O+N),W=a.av([],n.max,n.min),ne=Math.min(Z/W[0],$/W[1]),te=Math.min(u.scaleZoom(u.scale*ne),m.maxZoom);if(isNaN(te))return null;const ae=u.scale/u.zoomScale(te),le=new a.d9([n.min[0]-D*ae,n.min[1]-N*ae,n.min[2]],[n.max[0]+F*ae,n.max[1]+O*ae,n.max[2]]),be=(typeof m.offset.x=="number"&&typeof m.offset.y=="number"?new a.P(m.offset.x,m.offset.y):a.P.convert(m.offset)).rotate(-a.an(x));return le.center[0]-=be.x*ae,le.center[1]+=be.y*ae,le}queryTerrainElevation(n,u){const m=this.transform.elevation;return m?(u=Object.assign({},{exaggerated:!0},u),m.getAtPoint(a.ae.fromLngLat(n),null,u.exaggerated)):null}_cameraForBounds(n,u,m,x,A,S){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,u,m,x,A,S);const O=n.clone(),D=this._extendCameraOptions(S);O.bearing=x,O.pitch=A;const F=a.aT.convert(u),N=a.aT.convert(m),Z=new a.aT(F.lng,N.lat),$=new a.aT(N.lng,F.lat),W=O.project(F),ne=O.project(N),te=this.queryTerrainElevation(F),ae=this.queryTerrainElevation(N),le=this.queryTerrainElevation(Z),be=this.queryTerrainElevation($),xe=[[W.x,W.y,Math.min(te||0,ae||0,le||0,be||0)],[ne.x,ne.y,Math.max(te||0,ae||0,le||0,be||0)]];let ye=a.d9.fromPoints(xe);const Re=O.getWorldToCameraMatrix(),Ce=a.bl(new Float64Array(16),Re);ye=a.d9.applyTransform(ye,Re);const De=this._extendAABB(ye,O,D,x);if(!De)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ye=De;const Me=.5*a.av([],ye.max,ye.min)[2],Te=this._minimumAABBFrustumDistance(O,ye),Ne=[0,0,1,0];a.aC(Ne,Ne,Re),a.f1(Ne,Ne);const Ve=a.c5([],Ne,Te+Me),He=a.d8([],ye.center,Ve);a.af(ye.center,ye.center,Ce),a.af(He,He,Ce);const Qe=O.unproject(new a.P(ye.center[0],ye.center[1])),We=a.f2(O.projection,Qe),ut=Math.pow(2,We),wt=Math.min(O._zoomFromMercatorZ(He[2]*O.pixelsPerMeter*ut/O.worldSize),D.maxZoom);return O.mercatorFromTransition&&wt<.5*(a.c_+a.cL)?(O.setProjection({name:"globe"}),O.zoom=wt,this._cameraForBounds(O,u,m,x,A,S)):{center:Qe,zoom:wt,bearing:x,pitch:A}}fitBounds(n,u,m){const x=this.cameraForBounds(n,u);return this._fitInternal(x,u,m)}fitScreenCoordinates(n,u,m,x,A){const S=a.P.convert(n),O=a.P.convert(u),D=new a.P(Math.min(S.x,O.x),Math.min(S.y,O.y)),F=new a.P(Math.max(S.x,O.x),Math.max(S.y,O.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,O))return this;const N=this.transform.pointLocation3D(D),Z=this.transform.pointLocation3D(F),$=this.transform.pointLocation3D(new a.P(D.x,F.y)),W=this.transform.pointLocation3D(new a.P(F.x,D.y)),ne=[Math.min(N.lng,Z.lng,$.lng,W.lng),Math.min(N.lat,Z.lat,$.lat,W.lat)],te=[Math.max(N.lng,Z.lng,$.lng,W.lng),Math.max(N.lat,Z.lat,$.lat,W.lat)],ae=x&&x.pitch?x.pitch:this.getPitch(),le=this._cameraForBounds(this.transform,ne,te,m,ae,x);return this._fitInternal(le,x,A)}_fitInternal(n,u,m){return n?(u=Object.assign(n,u)).linear?this.easeTo(u,m):this.flyTo(u,m):this}jumpTo(n,u){this.stop();const m=n.preloadOnly?this.transform.clone():this.transform;let x=!1,A=!1,S=!1;"zoom"in n&&m.zoom!==+n.zoom&&(x=!0,m.zoom=+n.zoom),n.center!==void 0&&(m.center=a.aT.convert(n.center)),"bearing"in n&&m.bearing!==+n.bearing&&(A=!0,m.bearing=+n.bearing),"pitch"in n&&m.pitch!==+n.pitch&&(S=!0,m.pitch=+n.pitch);const O=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!m.isPaddingEqual(O))if(n.retainPadding===!1){const D=m.clone();D.padding=O,m.setLocationAtPoint(m.center,D.centerPoint)}else m.padding=O;return n.preloadOnly?(this._preloadTiles(m),this):(this.fire(new a.z("movestart",u)).fire(new a.z("move",u)),x&&this.fire(new a.z("zoomstart",u)).fire(new a.z("zoom",u)).fire(new a.z("zoomend",u)),A&&this.fire(new a.z("rotatestart",u)).fire(new a.z("rotate",u)).fire(new a.z("rotateend",u)),S&&this.fire(new a.z("pitchstart",u)).fire(new a.z("pitch",u)).fire(new a.z("pitchend",u)),this.fire(new a.z("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(cg),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,u){const m=this.transform;if(!m.projection.supportsFreeCamera)return a.w(cg),this;this.stop();const x=m.zoom,A=m.pitch,S=m.bearing;m.setFreeCameraOptions(n);const O=x!==m.zoom,D=A!==m.pitch,F=S!==m.bearing;return this.fire(new a.z("movestart",u)).fire(new a.z("move",u)),O&&this.fire(new a.z("zoomstart",u)).fire(new a.z("zoom",u)).fire(new a.z("zoomend",u)),F&&this.fire(new a.z("rotatestart",u)).fire(new a.z("rotate",u)).fire(new a.z("rotateend",u)),D&&this.fire(new a.z("pitchstart",u)).fire(new a.z("pitch",u)).fire(new a.z("pitchend",u)),this.fire(new a.z("moveend",u)),this}easeTo(n,u){this._stop(!1,n.easeId),((n=Object.assign({offset:[0,0],duration:500,easing:a.eV},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const m=this.transform,x=this.getZoom(),A=this.getBearing(),S=this.getPitch(),O=this.getPadding(),D="zoom"in n?+n.zoom:x,F="bearing"in n?this._normalizeBearing(n.bearing,A):A,N="pitch"in n?+n.pitch:S,Z=this._extendPadding(n.padding),$=a.P.convert(n.offset);let W,ne,te;if(m.projection.name==="globe"){const Ne=a.ae.fromLngLat(m.center),Ve=$.rotate(-m.angle);Ne.x+=Ve.x/m.worldSize,Ne.y+=Ve.y/m.worldSize;const He=Ne.toLngLat(),Qe=a.aT.convert(n.center||He);this._normalizeCenter(Qe),W=m.centerPoint.add(Ve),ne=new a.P(Ne.x,Ne.y).mult(m.worldSize),te=new a.P(a.aF(Qe.lng),a.aJ(Qe.lat)).mult(m.worldSize).sub(ne)}else{W=m.centerPoint.add($);const Ne=m.pointLocation(W),Ve=a.aT.convert(n.center||Ne);this._normalizeCenter(Ve),ne=m.project(Ne),te=m.project(Ve).sub(ne)}const ae=m.zoomScale(D-x);let le,be;n.around&&(le=a.aT.convert(n.around),be=m.locationPoint(le));const xe=this._zooming||D!==x,ye=this._rotating||A!==F,Re=this._pitching||N!==S,Ce=!m.isPaddingEqual(Z),De=n.retainPadding===!1?m.clone():m,Me=Ne=>Ve=>{if(xe&&(Ne.zoom=a.ak(x,D,Ve)),ye&&(Ne.bearing=a.ak(A,F,Ve)),Re&&(Ne.pitch=a.ak(S,N,Ve)),Ce&&(De.interpolatePadding(O,Z,Ve),W=De.centerPoint.add($)),le)Ne.setLocationAtPoint(le,be);else{const He=Ne.zoomScale(Ne.zoom-x),Qe=D>x?Math.min(2,ae):Math.max(.5,ae),We=Math.pow(Qe,1-Ve),ut=Ne.unproject(ne.add(te.mult(Ve*We)).mult(He));Ne.setLocationAtPoint(Ne.renderWorldCopies?ut.wrap():ut,W)}return n.preloadOnly||this._fireMoveEvents(u),Ne};if(n.preloadOnly){const Ne=this._emulate(Me,n.duration,m);return this._preloadTiles(Ne),this}const Te={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=xe,this._rotating=ye,this._pitching=Re,this._padding=Ce,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,Te),this._ease(Me(m),Ne=>{m.cameraElevationReference==="sea"&&m.recenterOnTerrain(),this._afterEase(u,Ne)},n),this}_prepareEase(n,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),u||m.moving||this.fire(new a.z("movestart",n)),this._zooming&&!m.zooming&&this.fire(new a.z("zoomstart",n)),this._rotating&&!m.rotating&&this.fire(new a.z("rotatestart",n)),this._pitching&&!m.pitching&&this.fire(new a.z("pitchstart",n))}_fireMoveEvents(n){this.fire(new a.z("move",n)),this._zooming&&this.fire(new a.z("zoom",n)),this._rotating&&this.fire(new a.z("rotate",n)),this._pitching&&this.fire(new a.z("pitch",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,x=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new a.z("zoomend",n)),x&&this.fire(new a.z("rotateend",n)),A&&this.fire(new a.z("pitchend",n)),this.fire(new a.z("moveend",n))}flyTo(n,u){if(this._prefersReducedMotion(n)){const ot=a.aH(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(ot,u)}this.stop(),n=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:a.eV},n);const m=this.transform,x=this.getZoom(),A=this.getBearing(),S=this.getPitch(),O=this.getPadding(),D="zoom"in n?a.aA(+n.zoom,m.minZoom,m.maxZoom):x,F="bearing"in n?this._normalizeBearing(n.bearing,A):A,N="pitch"in n?+n.pitch:S,Z=this._extendPadding(n.padding),$=m.zoomScale(D-x),W=a.P.convert(n.offset);let ne=m.centerPoint.add(W);const te=m.pointLocation(ne),ae=a.aT.convert(n.center||te);this._normalizeCenter(ae);const le=m.project(te),be=m.project(ae).sub(le);let xe=n.curve;const ye=Math.max(m.width,m.height),Re=ye/$,Ce=be.mag();if("minZoom"in n){const ot=a.aA(Math.min(n.minZoom,x,D),m.minZoom,m.maxZoom),bt=ye/m.zoomScale(ot-x);xe=Math.sqrt(bt/Ce*2)}const De=xe*xe;function Me(ot){const bt=(Re*Re-ye*ye+(ot?-1:1)*De*De*Ce*Ce)/(2*(ot?Re:ye)*De*Ce);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Te(ot){return(Math.exp(ot)-Math.exp(-ot))/2}function Ne(ot){return(Math.exp(ot)+Math.exp(-ot))/2}const Ve=Me(0);let He=function(ot){return Ne(Ve)/Ne(Ve+xe*ot)},Qe=function(ot){return ye*((Ne(Ve)*(Te(bt=Ve+xe*ot)/Ne(bt))-Te(Ve))/De)/Ce;var bt},We=(Me(1)-Ve)/xe;if(Math.abs(Ce)<1e-6||!isFinite(We)){if(Math.abs(ye-Re)<1e-6)return this.easeTo(n,u);const ot=Re<ye?-1:1;We=Math.abs(Math.log(Re/ye))/xe,Qe=function(){return 0},He=function(bt){return Math.exp(ot*xe*bt)}}n.duration="duration"in n?+n.duration:1e3*We/("screenSpeed"in n?+n.screenSpeed/xe:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const ut=A!==F,wt=N!==S,et=!m.isPaddingEqual(Z),je=n.retainPadding===!1?m.clone():m,mt=ot=>bt=>{const zt=bt*We,qt=1/He(zt);ot.zoom=bt===1?D:x+ot.scaleZoom(qt),ut&&(ot.bearing=a.ak(A,F,bt)),wt&&(ot.pitch=a.ak(S,N,bt)),et&&(je.interpolatePadding(O,Z,bt),ne=je.centerPoint.add(W));const kt=bt===1?ae:ot.unproject(le.add(be.mult(Qe(zt))).mult(qt));return ot.setLocationAtPoint(ot.renderWorldCopies?kt.wrap():kt,ne),ot._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(u),ot};if(n.preloadOnly){const ot=this._emulate(mt,n.duration,m);return this._preloadTiles(ot),this}return this._zooming=!0,this._rotating=ut,this._pitching=wt,this._padding=et,this._prepareEase(u,!1),this._ease(mt(m),()=>this._afterEase(u),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,u)}if(!n){const m=this.handlers;m&&m.stop(!1)}return this}_ease(n,u,m){m.animate===!1||m.duration===0?(n(1),u()):(this._easeStart=a.o.now(),this._easeOptions=m,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.o.now()-this._easeStart)/this._easeOptions.duration,1),u=this._onEaseFrame;u&&u(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,u){n=a.bT(n,-180,180);const m=Math.abs(n-u);return Math.abs(n-360-u)<m&&(n-=360),Math.abs(n+360-u)<m&&(n+=360),n}_normalizeCenter(n){const u=this.transform;if(u.maxBounds||u.projection.name!=="globe"&&!u.renderWorldCopies)return;const m=n.lng-u.center.lng;n.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&a.o.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,u,m){const x=Math.ceil(15*u/1e3),A=[],S=n(m.clone());for(let O=0;O<=x;O++){const D=S(O/x);A.push(D.clone())}return A}_preloadTiles(n,u){}}class xf{constructor(n={}){this.options=n,a.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const u=this.options&&this.options.compact,m=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=H("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=H("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",m);const x=H("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",m),this._innerContainer=H("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(n){const m=u.reduce((x,A,S)=>(A.value&&(x+=`${A.key}=${A.value}${S<u.length-1?"&":""}`),x),"?");n.href=`${a.e.FEEDBACK_URL}/${m}#${P_(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||(n.dataType!=="source"||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility")&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._mergedSourceCaches;for(const x in u){const A=u[x];if(A.used){const S=A.getSource();S.attribution&&n.indexOf(S.attribution)<0&&n.push(S.attribution)}}n.sort((x,A)=>x.length-A.length),n=n.filter((x,A)=>{for(let S=A+1;S<n.length;S++)if(n[S].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const m=n.map(x=>(function(A){const S=new DOMParser().parseFromString(A,"text/html");return Array.from(S.body.querySelectorAll("*")).reverse().forEach(O=>{const D=O.textContent||"";if(O.tagName!=="A")return void O.replaceWith(...O.childNodes);const F=O.getAttribute("href");if(!F||!/^(https?:|mailto:)/i.test(F))return void O.replaceWith(S.createTextNode(D));const N=S.createElement("a");N.href=F,N.textContent=D,N.rel="noopener nofollow";const Z=O.getAttribute("class");Z&&(N.className=Z),O.replaceWith(N)}),S.body.innerHTML})(x)).join(" | ");m!==this._attribHTML&&(this._attribHTML=m,n.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ql{constructor(){a.aY(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=H("div","mapboxgl-ctrl");const u=H("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const u in n){const m=n[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const u=n[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class B_{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const x of m)if(x.id===n)return void(x.cancelled=!0)}run(n=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class ui{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const u=a.dD((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,u,m){this._start=this.getValue(u),this._end=n,this._startTime=u,this._endTime=u+m}}const k_={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class ug extends a.z{constructor(n,u,m,x){const{point:A,lngLat:S,originalEvent:O,target:D}=n;super(n.type,{point:A,lngLat:S,originalEvent:O,target:D}),this.preventDefault=()=>{n.preventDefault()},this.id=u,this.interaction=m,this.feature=x}}class F_{constructor(n){this.map=n,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(n,u){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const m=u.filter;let x=u.type;m&&this.filters.set(n,a.b6(m)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const A=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(n,u)):A.size===0&&this.map.on(x,this.handleType),A.size===0&&this.interactionsByType.set(x,A),A.set(n,u),this.typeById.set(n,x)}get(n){const u=this.typeById.get(n);if(!u)return;const m=this.interactionsByType.get(u);return m?m.get(n):void 0}remove(n){const u=this.typeById.get(n);if(!u)return;this.typeById.delete(n),this.filters.delete(n);const m=this.interactionsByType.get(u);m&&(m.delete(n),u==="mouseenter"||u==="mouseleave"?(this.delegatedInteractions.delete(n),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):m.size===0&&this.map.off(u,this.handleType))}queryTargets(n,u){const m=[];for(const[x,A]of u)A.target&&m.push({targetId:x,target:A.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(n,m,this.map.transform)}handleMove(n){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const u=this.queryTargets(n.point,Array.from(this.delegatedInteractions).reverse());u.length&&(n.type="mouseenter",this.handleType(n,u));const m=new Map;for(const[x,{feature:A}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||m.set(A.id,A);m.size&&(n.type="mouseleave",this.handleType(n,Array.from(m.values())))}handleOut(n){const u=Array.from(this.hoveredFeatures.values()).map(({feature:m})=>m);u.length&&(n.type="mouseleave",this.handleType(n,u)),this.hoveredFeatures.clear()}handleType(n,u){const m=n.type==="mouseenter";if(m&&!this.interactionsByType.has(n.type))return void a.w("mouseenter interaction required for mouseleave to work.");const x=Array.from(this.interactionsByType.get(n.type)).reverse(),A=!!u;u=u||this.queryTargets(n.point,x);let S=!1;const O=new Set;for(const D of u){for(const[F,N]of x){if(!N.target)continue;const Z=D.variants?D.variants[F]:null;if(Z){for(const $ of Z){if(zd($,D,O,F))continue;const W=new a.dx(D,$),ne=Is($,D,F);A&&W.id!==void 0&&(W.state=this.map.getFeatureState(W));const te=m?this.prevHoveredFeatures.get(ne):null,ae=new ug(n,F,N,W),le=te?te.stop:N.handler(ae);if(m&&this.hoveredFeatures.set(ne,{feature:D,stop:le}),le!==!1){S=!0;break}}if(S)break}}if(S)break}if(!S)for(const[D,F]of x){const{handler:N,target:Z}=F;if(!Z&&N(new ug(n,D,F,null))!==!1)break}}}function hg(p,n){if(Array.isArray(p)&&Array.isArray(n)){const u=new Set(p),m=new Set(n);return u.size===m.size&&p.every(x=>m.has(x))}return a.by(p,n)}const bf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Lc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ma{constructor(n,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new Bp({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,m&&(this.mousePitch=new kp({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(n,u){this.mouseRotate.mousedown(n,u),this.mousePitch&&this.mousePitch.mousedown(n,u),ge()}move(n,u){const m=this.map,x=this.mouseRotate.mousemoveWindow(n,u),A=x&&x.bearingDelta;if(A&&m.setBearing(m.getBearing()+A),this.mousePitch){const S=this.mousePitch.mousemoveWindow(n,u),O=S&&S.pitchDelta;O&&m.setPitch(m.getPitch()+O)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){se(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(Object.assign({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),Le(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,Le(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ue(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=Ue(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function md(p,n,u){if(p=new a.aT(p.lng,p.lat),n){const m=new a.aT(p.lng-360,p.lat),x=new a.aT(p.lng+360,p.lat),A=360*Math.ceil(Math.abs(p.lng-u.center.lng)/360),S=u.locationPoint3D(p).distSqr(n),O=n.x<0||n.y<0||n.x>u.width||n.y>u.height;u.locationPoint3D(m).distSqr(n)<S&&(O||Math.abs(m.lng-u.center.lng)<A)?p=m:u.locationPoint3D(x).distSqr(n)<S&&(O||Math.abs(x.lng-u.center.lng)<A)&&(p=x)}for(;Math.abs(p.lng-u.center.lng)>180;){const m=u.locationPoint3D(p);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;p.lng>u.center.lng?p.lng-=360:p.lng+=360}return p}const wl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Ui={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class aa extends a.E{constructor(n,u){super(),(n instanceof HTMLElement||u)&&(n=Object.assign({element:n},u)),a.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:m="center",color:x="#3FB1CE",scale:A=1,draggable:S=!1,clickTolerance:O=0,rotation:D=Ui.rotation,rotationAlignment:F=Ui.rotationAlignment,pitchAlignment:N=Ui.pitchAlignment,occludedOpacity:Z=Ui.occludedOpacity,altitude:$=Ui.altitude}=n||{};this._anchor=m,this._color=x,this._scale=A,this._draggable=S,this._clickTolerance=O,this._rotation=D,this._rotationAlignment=F,this._pitchAlignment=N,this._occludedOpacity=Z,this._altitude=$,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),n&&n.element?(this._element=n.element,this._offset=a.P.convert(n&&n.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=a.P.convert(n&&n.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",te=>{te.preventDefault()}),this._element.addEventListener("mousedown",te=>{te.preventDefault()});const W=this._element.classList;for(const te in wl)W.remove(`mapboxgl-marker-anchor-${te}`);W.add(`mapboxgl-marker-anchor-${this._anchor}`);const ne=n&&n.className?n.className.trim().split(/\s+/):[];W.add(...ne),this._popup=null}_createDefaultMarker(){const n=H("div"),u=K("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},n);if(this._altitude===0){const m=K("radialGradient",{id:"shadowGradient"},K("defs",{},u));K("stop",{offset:"10%","stop-opacity":.4},m),K("stop",{offset:"100%","stop-opacity":.05},m),K("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u)}return K("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),K("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),K("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),n}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.aT.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(n){return n===this._altitude||(this._defaultMarker&&(this._altitude===0&&n!==0||this._altitude!==0&&n===0)&&(this._element=this._createDefaultMarker()),this._altitude=n||Ui.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,n._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const u=n.code,m=n.charCode||n.keyCode;u!=="Space"&&u!=="Enter"&&m!==32&&m!==13||this.togglePopup()}_onMapClick(n){const u=n.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,u=this._pos;if(!n||!u)return!1;const m=n.unproject(u,this._altitude),x=n.getFreeCameraOptions();if(!x.position)return!1;const A=x.position.toLngLat();return A.distanceTo(m)<.9*A.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const u=this._pos;if(!u||u.x<0||u.x>n.transform.width||u.y<0||u.y>n.transform.height)return void this._clearFadeTimer();const m=n.unproject(u,this._altitude);let x;n._showingGlobe()&&a.f5(n.transform,this._lngLat)?x=0:(x=1-n._queryFogOpacity(m),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const u=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${wl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${u.x}px,${u.y}px)
        `}_calculateXYTransform(){const n=this._pos,u=this._map,m=this.getPitchAlignment();if(!u||!n||m!=="map")return"";if(!u._showingGlobe()){const D=u.getPitch();return D?`rotateX(${D}deg)`:""}const x=a.cX(a.f6(u.transform,this._lngLat)),A=n.sub(a.f7(u.transform)),S=Math.abs(A.x)+Math.abs(A.y);if(S===0)return"";const O=x/S;return`rotateX(${-A.y*O}deg) rotateY(${A.x*O}deg)`}_calculateZTransform(){const n=this._pos,u=this._map;if(!u||!n)return"";let m=0;const x=this.getRotationAlignment();if(x==="map")if(u._showingGlobe()){const A=u.project(new a.aT(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),S=u.project(new a.aT(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(A);m=a.cX(Math.atan2(S.y,S.x))-90}else m=-u.getBearing();else if(x==="horizon"){const A=a.ah(4,6,u.getZoom()),S=a.f7(u.transform);S.y+=A*u.transform.height;const O=n.sub(S),D=a.cX(Math.atan2(O.y,O.x));m=(D>90?D-270:D+90)*(1-A)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const u=this._map;u&&(u.transform.renderWorldCopies&&(this._lngLat=md(this._lngLat,this._pos,u.transform)),this._pos=u.project(this._lngLat,this._altitude),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),u._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(u._showingGlobe()||u.getTerrain()||u.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=a.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const u=this._map;if(!u)return;const m=this._pointerdownPos,x=this._positionDelta;if(m&&x){if(!this._isDragging){const A=this._clickTolerance||u._clickTolerance;if(n.point.dist(m)<A)return;this._isDragging=!0}this._pos=n.point.sub(x),this._lngLat=u.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.z("dragstart"))),this.fire(new a.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.z("dragend")),this._state="inactive"}_addDragHandler(n){const u=this._map,m=this._pos;u&&m&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(m),this._pointerdownPos=n.point,this._state="pending",u.on("mousemove",this._onMove),u.on("touchmove",this._onMove),u.once("mouseup",this._onUp),u.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const u=this._map;return u&&(n?(u.on("mousedown",this._addDragHandler),u.on("touchstart",this._addDragHandler)):(u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||Ui.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||Ui.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||Ui.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||Ui.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const ks={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1,showButton:!0,followUserLocation:!0},wf={maxWidth:100,unit:"metric"},Qi={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ps={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},xu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gd(p=new a.P(0,0),n="bottom"){if(typeof p=="number"){const u=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(n){case"top":return new a.P(0,p);case"top-left":return new a.P(u,u);case"top-right":return new a.P(-u,u);case"bottom":return new a.P(0,-p);case"bottom-left":return new a.P(u,-u);case"bottom-right":return new a.P(-u,-u);case"left":return new a.P(p,0);case"right":return new a.P(-p,0)}return new a.P(0,0)}return p instanceof a.P||Array.isArray(p)?a.P.convert(p):a.P.convert(p[n]||[0,0])}return{version:C,supported:Q.supported,setRTLTextPlugin:a.fb,getRTLTextPluginStatus:a.fa,Map:class extends L_{constructor(p){L.mark(I.create);const n=p;if((p=Object.assign({},bf,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&a.f3(window)&&(p.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new rp(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies,null,null),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new B_,this._domRenderTaskQueue=new B_,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.b2(),this._locale=Object.assign({},k_,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ui(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new Rt(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const u=document.getElementById(p.container);if(!u)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=u}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,a.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new vu(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||a.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),p.hash&&(this._hash=new No(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const u=p.bounds;u&&(this.resize(),this.fitBounds(u,Object.assign({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new xf({customAttribution:p.customAttribution})),this._logoControl=new Ql,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent(),this._postStyleWithAppearanceEvent()}),this.on("data",u=>{this._update(u.dataType==="style"),this.fire(new a.z(`${u.dataType}data`,u))}),this.on("dataloading",u=>{this.fire(new a.z(`${u.dataType}dataloading`,u))}),this._interactions=new F_(this)}_getMapId(){return this._mapId}addControl(p,n){if(n===void 0&&(n=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new a.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[n];return n.indexOf("bottom")!==-1?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new a.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(p);return n>-1&&this._controls.splice(n,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new a.z("movestart",p)).fire(new a.z("move",p)),this.fire(new a.z("resize",p)),n&&this.fire(new a.z("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(a.aI.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new a.z("zoomstart")).fire(new a.z("zoom")).fire(new a.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new a.z("zoomstart")).fire(new a.z("zoom")).fire(new a.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new a.z("pitchstart")).fire(new a.z("pitch")).fire(new a.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new a.z("pitchstart")).fire(new a.z("pitch")).fire(new a.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this.style&&this.style._setLabelPlacementStale(),this.style._updateFilteredLayers(n=>n.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map(n=>n==="auto"?navigator.language:n):p}setLanguage(p){const n=this._parseLanguage(p);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const u of this._controls)u._setLanguage&&u._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,n=p.projection.name;let u;n==="globe"&&p.zoom>=a.cL?(p.setMercatorFromTransition(),u=!0):n==="mercator"&&p.zoom<a.cL&&(p.setProjection({name:"globe"}),u=!0),u&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(p,n){return this._updateProjection(p||n||{name:"mercator"})}_updateProjection(p){let n;const u=this.transform.mercatorFromTransition;n=p.name==="globe"&&this.transform.zoom>=a.cL?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate();const m=this.transform.getProjection().name==="mercator"&&u!==this.transform.mercatorFromTransition;return(n||m)&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p,n){return this.transform.locationPoint3D(a.aT.convert(p),n)}unproject(p,n){return this.transform.pointLocation3D(a.P.convert(p),n)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,n,u){const m=x=>{let A=[];if(Array.isArray(n)){const S=n.filter(O=>this.getLayer(O));A=S.length?this.queryRenderedFeatures(x,{layers:S}):[]}else A=this.queryRenderedFeatures(x,{target:n});return A};if(p==="mouseenter"||p==="mouseover"){let x=!1;return{listener:u,targets:n,delegates:{mousemove:S=>{const O=m(S.point);O.length?x||(x=!0,u.call(this,new ja(p,this,S.originalEvent,{features:O}))):x=!1},mouseout:()=>{x=!1}}}}if(p==="mouseleave"||p==="mouseout"){let x=!1;return{listener:u,targets:n,delegates:{mousemove:O=>{m(O.point).length?x=!0:x&&(x=!1,u.call(this,new ja(p,this,O.originalEvent)))},mouseout:O=>{x&&(x=!1,u.call(this,new ja(p,this,O.originalEvent)))}}}}{const x=A=>{const S=m(A.point);S.length&&(A.features=S,u.call(this,A),delete A.features)};return{listener:u,targets:n,delegates:{[p]:x}}}}on(p,n,u){if(typeof n=="function"||u===void 0)return super.on(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const m=this._createDelegatedListener(p,n,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const x in m.delegates)this.on(x,m.delegates[x]);return this}once(p,n,u){if(typeof n=="function"||u===void 0)return super.once(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const m=this._createDelegatedListener(p,n,u);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(p,n,u){if(typeof n=="function"||u===void 0)return super.off(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const m=this._delegatedListeners?this._delegatedListeners[p]:void 0;return m&&(x=>{for(let A=0;A<x.length;A++){const S=x[A];if(S.listener===u&&hg(S.targets,n)){for(const O in S.delegates)this.off(O,S.delegates[O]);return x.splice(A,1),this}}})(m),this}queryRenderedFeatures(p,n){if(!this.style)return[];if(p===void 0||p instanceof a.P||Array.isArray(p)||n!==void 0||(n=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!n){const A=this.style.queryRenderedFeatures(p,void 0,this.transform),S=this.style.queryRenderedFeatureset(p,void 0,this.transform);return A.concat(S)}let u=!0;if(n.target&&(u=this._isTargetValid(n.target),u&&!n.layers))return this.style.queryRenderedFeatureset(p,n,this.transform);let m=!0;if(n.layers&&Array.isArray(n.layers)){for(const A of n.layers)if(!this._isValidId(A)){m=!1;break}if(m&&!n.target)return this.style.queryRenderedFeatures(p,n,this.transform)}let x=[];return m&&(x=x.concat(this.style.queryRenderedFeatures(p,n,this.transform))),u&&(x=x.concat(this.style.queryRenderedFeatureset(p,n,this.transform))),x}querySourceFeatures(p,n){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,n)}queryRasterValue(p,n,u){return this._isValidId(p)?this.style.queryRasterValue(p,n,u):Promise.resolve(null)}isPointOnSurface(p){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&a.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(p))}addInteraction(p,n){return this._interactions.add(p,n),this}removeInteraction(p){return this._interactions.remove(p),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this}setStyle(p,n){return n=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&p&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(p,(u,m)=>{if(u){const x=typeof u=="string"?u:u instanceof Error?u.message:u.error;a.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(p,n)}else m&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(p,n))}_getUIString(p){const n=this._locale[p];if(n==null)throw new Error(`Missing UI string '${p}'`);return n}_updateStyle(p,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const u=Object.assign({},n);n&&n.config&&(u.initialConfig=n.config,delete u.config),this.style=new Yo(this,u).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Yo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new a.y(new Error("IDs can't be empty."))),!1):!a.dr(p)||(this.fire(new a.y(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const n of p)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(p)}addSource(p,n){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,n),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,n,u){this._lazyInitEmptyStyle(),this.style.addSourceType(p,n,u)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,n,{pixelRatio:u=1,sdf:m=!1,stretchX:x,stretchY:A,content:S}={}){this._lazyInitEmptyStyle();const O=a.I.from(p);if(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:D,height:F,data:N}=a.o.getImageData(n);this.style.addImage(O,{data:new a.q({width:D,height:F},N),pixelRatio:u,stretchX:x,stretchY:A,content:S,sdf:m,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new a.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:F}=n,N=n;this.style.addImage(O,{data:new a.q({width:D,height:F},new Uint8Array(N.data)),pixelRatio:u,stretchX:x,stretchY:A,content:S,sdf:m,usvg:!1,version:0,userImage:N}),N.onAdd&&N.onAdd(this,p)}}updateImage(p,n){this._lazyInitEmptyStyle();const u=a.I.from(p),m=this.style.getImage(u);if(!m)return void this.fire(new a.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?a.o.getImageData(n):n,{width:A,height:S,data:O}=x;if(A===void 0||S===void 0)return void this.fire(new a.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(A!==(m.usvg?m.icon.usvg_tree.width:m.data.width)||S!==(m.usvg?m.icon.usvg_tree.height:m.data.height))return void this.fire(new a.y(new Error(`The width and height of the updated image (${A}, ${S})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const D=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let F=!1;m.usvg?(m.data=new a.q({width:A,height:S},new Uint8Array(O)),m.usvg=!1,m.icon=void 0,F=!0):m.data.replace(O,D),this.style.updateImage(u,m,F)}hasImage(p){return p?!!this.style&&!!this.style.getImage(a.I.from(p)):(this.fire(new a.y(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(a.I.from(p))}loadImage(p,n){a.n(this._requestManager.transformRequest(p,a.R.Image),(u,m)=>{n(u,m instanceof HTMLImageElement?a.o.getImageData(m):m)})}listImages(){return this.style.listImages().map(p=>p.name)}addModel(p,n){this._lazyInitEmptyStyle(),this.style.addModel(p,n)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new a.y(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,n){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,n),this._update(!0)):this}getSlot(p){const n=this.getLayer(p);return n&&n.slot||null}setSlot(p,n){return this.style.setSlot(p,n),this.style.mergeLayers(),this._update(!0)}addImport(p,n){return this.style.addImport(p,n).catch(u=>this.fire(new a.y(new Error("Failed to add import",u)))),this}updateImport(p,n){return typeof n!="string"&&n.id!==p?(this.removeImport(p),this.addImport(n)):(this.style.updateImport(p,n),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,n){return this.style.moveImport(p,n),this._update(!0)}moveLayer(p,n){return this._isValidId(p)?(this.style.moveLayer(p,n),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const n=this.style.getOwnLayer(p);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,n,u){return this._isValidId(p)?(this.style.setLayerZoomRange(p,n,u),this._update(!0)):this}setFilter(p,n,u={}){return this._isValidId(p)?(this.style.setFilter(p,n,u),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,n,u,m={}){return this._isValidId(p)?(this.style.setPaintProperty(p,n,u,m),this._update(!0)):this}getPaintProperty(p,n){return this._isValidId(p)?this.style.getPaintProperty(p,n):null}setLayoutProperty(p,n,u,m={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,n,u,m),this._update(!0)):this}getLayoutProperty(p,n){return this._isValidId(p)?this.style.getLayoutProperty(p,n):null}setLayerProperty(p,n,u,m={}){return this._isValidId(p)?(n==="appearances"&&this._postAddingAppearancesToStyleEvent(),this.style.setLayerProperty(p,n,u,m),this._update(!0)):this}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(p){return this.style.setGlyphsUrl(p),this._update(!0)}getSchema(p){return this.style.getSchema(p)}setSchema(p,n){return this.style.setSchema(p,n),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,n){return this.style.setConfig(p,n),this._update(!0)}getConfigProperty(p,n){return this.style.getConfigProperty(p,n)}setConfigProperty(p,n,u){return this.style.setConfigProperty(p,n,u),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const n=p[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,n),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.aT.convert(p),this.transform):0}setFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,n),this._update())}removeFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,n),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_selectIndoorFloor(p){this.style.indoorManager.selectFloor(p)}_setIndoorActiveFloorsVisibility(p){this.style.indoorManager.setActiveFloorsVisibility(p)}getIndoorTileOptions(p,n){return this.style.isIndoorEnabled()?this.style.indoorManager.getIndoorTileOptions(p,n):null}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let u,m,x,A=this._container;for(;A&&(!m||!x);){const S=window.getComputedStyle(A).transform;S&&S!=="none"&&(u=S.match(/matrix.*\((.+)\)/)[1].split(", "),u[0]&&u[0]!=="0"&&u[0]!=="1"&&(m=u[0]),u[3]&&u[3]!=="0"&&u[3]!=="1"&&(x=u[3])),A=A.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=x?Math.abs(n/x):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=H("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=H("div","mapboxgl-canvas-container",p);this._canvas=H("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=H("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(x=>{m[x]=H("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,n){const u=a.o.devicePixelRatio||1;this._canvas.width=u*Math.ceil(p),this._canvas.height=u*Math.ceil(n),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${n}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const n=this._markers.indexOf(p);n!==-1&&this._markers.splice(n,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const n=this._popups.indexOf(p);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const p=Object.assign({},Q.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",p);n?(Ut(n,!0),this.painter=new ig(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._worldview),this.on("data",u=>{if(u.dataType==="source"){const m=this.transform.elevation?this.transform.elevation._source():null;m&&u.sourceCacheId===m.id&&this.style&&this.style._setLabelPlacementStale(),this.painter.setTileLoadedFlag(!0)}}),a.k.testSupport(n)):this.fire(new a.y(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.z("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new a.z("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let n;this.fire(new a.z("renderstart")),++this._frameId;const u=this.painter.context.extTimerQuery,m=a.o.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=x.createQuery(),x.beginQuery(u.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const A=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,F=this.transform.pitch,N=a.o.now(),Z=new a.ac(D,{now:N,fadeDuration:A,pitch:F,transition:this.style.transition,worldview:this._worldview});this.style.update(Z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(m),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(m),this.style&&(this._placementDirty=this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,A,this._crossSourceCollisions,this.painter.replacementSource)),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:A,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,L.mark(I.load),this.fire(new a.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const D=a.o.now()-m;x.endQuery(u.TIME_ELAPSED_EXT),setTimeout(()=>{const F=x.getQueryParameter(n,x.QUERY_RESULT)/1e6;x.deleteQuery(n),this.fire(new a.z("gpu-timing-frame",{cpuTime:D,gpuTime:F}))},50)}if(this.listens("gpu-timing-layer")){const D=this.painter.collectGpuTimers();setTimeout(()=>{const F=this.painter.queryGpuTimers(D);this.fire(new a.z("gpu-timing-layer",{layerTimes:F}))},50)}if(this.listens("gpu-timing-deferred-render")){const D=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const F=this.painter.queryGpuTimeDeferredRender(D);this.fire(new a.z("gpu-timing-deferred-render",{gpuTime:F}))},50)}const O=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(O||this._repaint)this.triggerRepaint();else{const D=this.idle();if(D&&(S=this._updateAverageElevation(m,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),D&&(this.fire(new a.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const F=this._calculateSpeedIndex();this.fire(new a.z("speedindexcompleted",{speedIndex:F})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||O||(this._fullyLoaded=!0,L.mark(I.fullLoad),this._performanceMetricsCollection&&Tr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const n of this._markers)p&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!p||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(p,n=!1){const u=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&u(0);const m=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(m||(n||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const x=this.transform.averageElevation;let A=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(A)?A=0:this._averageElevationLastSampledAt=p;const S=Math.abs(x-A);if(S>1){if(this._isInitialLoad||m)return this._averageElevation.jumpTo(A),u(A);this._averageElevation.easeTo(A,p,300)}else if(S>1e-4)return this._averageElevation.jumpTo(A),u(A)}return!!this._averageElevation.isEasing(p)&&u(this._averageElevation.getValue(p))}_authenticate(){zn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===st||p.status===401)){const n=this.painter.context.gl;Ut(n,!1),this._logoControl instanceof Ql&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Er(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Zr(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_postStyleWithAppearanceEvent(){this.style.globalId&&this.style.hasAppearances()&&Xt(this._requestManager._customAccessToken)}_postAddingAppearancesToStyleEvent(){kr(this._requestManager._customAccessToken)}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function x(A){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,A,0);const S=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,S),S}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(x(p),n.canvasCopies.map(x),n.timeStamps)}_canvasPixelComparison(p,n,u){let m=u[1]-u[0];const x=p.length/4;for(let A=0;A<n.length;A++){const S=n[A];let O=0;for(let D=0;D<S.length;D+=4)S[D]===p[D]&&S[D+1]===p[D+1]&&S[D+2]===p[D+2]&&S[D+3]===p[D+3]&&(O+=1);m+=(u[A+2]-u[A+1])*(1-O/x)}return m}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Fn.delete(this.painter.context.gl),Ur.remove(),ar.remove(),this._removed=!0,this.fire(new a.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=a.o.frame(n=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(n)}))}_preloadTiles(p){const n=this.style?this.style.getSourceCaches():[];return a.bw(n,(u,m)=>u._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this.style&&p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,p&&this._update())}_setCacheLimits(p,n){a.f4(p,n)}get version(){return C}},NavigationControl:class{constructor(p={}){this.options=Object.assign({},Lc,p),this._container=H("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),H("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),H("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const u=this._map;u&&(this.options.visualizePitch?u.resetNorthPitch({},{originalEvent:n}):u.resetNorth({},{originalEvent:n}))}),this._compassIcon=H("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const n=p.getZoom(),u=n===p.getMaxZoom(),m=n===p.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ma(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,n){const u=H("button",p,this._container);return u.type="button",u.addEventListener("click",n),u}_setButtonTitle(p,n){if(!this._map)return;const u=this._map._getUIString(`NavigationControl.${n}`);p.setAttribute("aria-label",u),p.firstElementChild&&p.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.E{constructor(p={}){super();const n=navigator.geolocation;this.options=Object.assign({geolocation:n},ks,p),a.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ag(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=H("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._clearRequestTimeout(),this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const n=(u=!!this.options.geolocation)=>{this._supportsGeolocation=u,p(u)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(u=>n(u.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(p){const n=this._map.getMaxBounds(),u=p.coords;return!!n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._clearRequestTimeout(),this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new a.z("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this.options.followUserLocation?(this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active")):(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"));break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.followUserLocation&&(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.z("geolocate",Object.assign({coords:p.coords,timestamp:p.timestamp},p.toJSON?{toJSON:p.toJSON.bind(p)}:{}))),this._finish()}}_updateCamera(p){const n=new a.aT(p.coords.longitude,p.coords.latitude),u=p.coords.accuracy,m=this._map.getBearing(),x=Object.assign({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(u),x,{geolocateSource:!0})}_updateMarker(p){if(p){const n=new a.aT(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,n=a.cf(1,p._center.lat)*p.worldSize,u=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this._clearRequestTimeout(),this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.z("error",{code:p.code,message:p.message,PERMISSION_DENIED:p.PERMISSION_DENIED,POSITION_UNAVAILABLE:p.POSITION_UNAVAILABLE,TIMEOUT:p.TIMEOUT})),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_startRequestTimeout(){this._clearRequestTimeout();const p=this.options.positionOptions.timeout;p&&(this._requestTimeoutId=window.setTimeout(()=>{this._onError({code:3,message:"Geolocation request timed out"})},p))}_clearRequestTimeout(){this._requestTimeoutId!==void 0&&(clearTimeout(this._requestTimeoutId),this._requestTimeoutId=void 0)}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=H("button","mapboxgl-ctrl-geolocate",this._container),H("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=H("div","mapboxgl-user-location"),this._dotElement.appendChild(H("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(H("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new aa({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=H("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new aa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.showButton||(this._container.style.display="none"),this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.z("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this._startRequestTimeout(),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._startRequestTimeout(),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}setFollowUserLocation(p){return this.options.followUserLocation=p??ks.followUserLocation,this.options.trackUserLocation&&this._watchState!=="OFF"&&(this.options.followUserLocation?this._watchState!=="BACKGROUND"&&this._watchState!=="BACKGROUND_ERROR"||(this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.z("trackuserlocationstart"))):this._watchState!=="ACTIVE_LOCK"&&this._watchState!=="ACTIVE_ERROR"||(this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this.fire(new a.z("trackuserlocationend")))),this}_addDeviceOrientationListener(){const p=()=>{const n="ondeviceorientationabsolute"in window?"deviceorientationabsolute":"deviceorientation";window.addEventListener(n,this._onDeviceOrientation)};typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&p()}).catch(console.error):p()}_clearWatch(){this._clearRequestTimeout(),this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:xf,ScaleControl:class{constructor(p={}){this.options=Object.assign({},wf,p),a.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,n=this._map,u=n._containerHeight/2,m=n._containerWidth/2-p/2,x=n.unproject([m,u]),A=n.unproject([m+p,u]),S=x.distanceTo(A);if(this.options.unit==="imperial"){const O=3.2808*S;O>5280?this._setScale(p,O/5280,"mile"):this._setScale(p,O,"foot")}else this.options.unit==="nautical"?this._setScale(p,S/1852,"nautical-mile"):S>=1e3?this._setScale(p,S/1e3,"kilometer"):this._setScale(p,S,"meter")}_setScale(p,n,u){this._map._requestDomTask(()=>{const m=(function(A){const S=Math.pow(10,`${Math.floor(A)}`.length-1);let O=A/S;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:(function(D){const F=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*F)/F})(O),S*O})(n),x=m/n;this._container.innerHTML=u!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:u}).format(m):`${m}&nbsp;${Qi[u]}`,this._container.style.width=p*x+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=H("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:a.w("Full screen control 'container' must be a DOM element.")),a.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=H("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=H("button","mapboxgl-ctrl-fullscreen",this._controlContainer);H("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:Rm,Popup:class extends a.E{constructor(p){super(),this.options=Object.assign(Object.create(ps),p),this._altitude=this.options.altitude,a.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new a.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new a.z("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=a.aT.convert(p),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(p){return this._altitude=p,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const n=document.createDocumentFragment(),u=document.createElement("body");let m;for(u.innerHTML=p;m=u.firstChild,m;)n.appendChild(m);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=H("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(p),this.options.closeButton){const u=this._closeButton=H("button","mapboxgl-popup-close-button",n);u.type="button",u.setAttribute("aria-label","Close popup"),u.innerHTML='<span aria-hidden="true">&#215;</span>',u.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let n;return this._classList.delete(p)?n=!1:(this._classList.add(p),n=!0),this._updateClassList(),n}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const n=this._map,u=this._container,m=this._pos;if(!n||!u||!m)return"bottom";const x=u.offsetWidth,A=u.offsetHeight,S=m.x<x/2,O=m.x>n.transform.width-x/2;if(m.y+p<A)return S?"top-left":O?"top-right":"top";if(m.y>n.transform.height-A){if(S)return"bottom-left";if(O)return"bottom-right"}return S?"left":O?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),p.className=n.join(" ")}_update(p){const n=this._map,u=this._content;if(!n||!this._lngLat&&!this._trackPointer||!u)return;let m=this._container;if(m||(m=this._container=H("div","mapboxgl-popup",n.getContainer()),this._tip=H("div","mapboxgl-popup-tip",m),m.appendChild(u)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=md(this._lngLat,this._pos,n.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p instanceof a.P?p:n.project(this._lngLat,this._altitude),A=gd(this.options.offset),S=this._anchor=this._getAnchor(A.y),O=gd(this.options.offset,S),D=x.add(O).round();n._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${wl[S]} translate(${D.x}px,${D.y}px)`)})}if(!this._marker&&n._showingGlobe()){const x=a.f5(n.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(xu);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:aa,Style:Yo,LngLat:a.aT,LngLatBounds:a.aI,Point:a.P,MercatorCoordinate:a.ae,FreeCameraOptions:uv,Evented:a.E,config:a.e,prewarm:a.f9,clearPrewarmedResources:a.f8,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(p){a.e.ACCESS_TOKEN=p},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(p){a.e.API_URL=p},get workerCount(){return a.fi.workerCount},set workerCount(p){a.fi.workerCount=p},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){a.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){a.fh(p)},get workerUrl(){return a.fg.workerUrl},set workerUrl(p){a.fg.workerUrl=p},get workerClass(){return a.fg.workerClass},set workerClass(p){a.fg.workerClass=p},get workerParams(){return a.fg.workerParams},set workerParams(p){a.fg.workerParams=p},get dracoUrl(){return a.ff()},set dracoUrl(p){a.fe(p)},get meshoptUrl(){return a.fd()},set meshoptUrl(p){a.fc(p)},setNow:a.o.setNow,restoreNow:a.o.restoreNow}});var w=h;return w}))})(pA)),pA.exports}var qW=$W();const _y=ca(qW),HW="pk.eyJ1IjoiZGVtb3VzZXIiLCJhIjoiY2w4Z3I1a3I3MDAzMzN1bnpkenZ4bmJ5eSJ9.1234567890";function XW({airport:r,flights:t}){const o=Jt.useRef(null),l=Jt.useRef(null),h=Jt.useRef([]),[v,w]=Jt.useState(1),[a,C]=Jt.useState(null),[I,L]=Jt.useState([{id:"gates",name:"Gates",visible:!0,icon:"gate"},{id:"security",name:"Security",visible:!0,icon:"security"},{id:"food",name:"Food & Dining",visible:!0,icon:"food"},{id:"retail",name:"Retail",visible:!0,icon:"retail"},{id:"lounge",name:"Lounges",visible:!0,icon:"lounge"},{id:"services",name:"Services",visible:!0,icon:"services"}]);Jt.useEffect(()=>{if(o.current){_y.accessToken=HW;try{l.current=new _y.Map({container:o.current,style:"mapbox://styles/mapbox/dark-v11",center:r.coordinates,zoom:15.5,pitch:45,bearing:0,antialias:!0}),l.current.on("load",()=>{k()}),l.current.addControl(new _y.NavigationControl,"bottom-right")}catch(ge){console.warn("Mapbox initialization failed, using fallback:",ge)}return()=>{l.current&&l.current.remove()}}},[r]);const k=Jt.useCallback(()=>{l.current&&(h.current.forEach(ge=>ge.remove()),h.current=[],r.terminals.forEach(ge=>{ge.gates.forEach(se=>{const ve=t.filter(Ke=>Ke.gate===se.number).find(Ke=>Ke.status==="boarding"||Ke.status==="active"),Le=document.createElement("div");Le.className="gate-marker",Le.style.cssText=`
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: ${G(se.status)};
          border: 2px solid #0B0F17;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 10px;
          font-weight: 600;
          color: #0B0F17;
          cursor: pointer;
          transition: all 0.2s ease;
          box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        `,Le.textContent=se.number,se.status==="boarding"&&(Le.style.animation="pulse-glow 2s ease-in-out infinite");const Ue=new _y.Marker(Le).setLngLat(se.coordinates).addTo(l.current),tt=new _y.Popup({offset:25}).setHTML(H(se,ve));Ue.setPopup(tt),Le.addEventListener("click",()=>{C(se.number),Ue.togglePopup()}),h.current.push(Ue)}),ge.floors.forEach(se=>{se.level===v&&se.features.forEach(fe=>{const ve=document.createElement("div");ve.className="feature-marker",ve.style.cssText=`
              width: 24px;
              height: 24px;
              border-radius: 50%;
              background: ${q(fe.type)};
              border: 2px solid #0B0F17;
              display: flex;
              align-items: center;
              justify-content: center;
              cursor: pointer;
              transition: all 0.2s ease;
              box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            `,ve.innerHTML=Q(fe.type);const Le=new _y.Marker(ve).setLngLat(fe.coordinates).addTo(l.current),Ue=new _y.Popup({offset:20}).setHTML(`
                <div style="padding: 8px;">
                  <div style="font-weight: 600; margin-bottom: 4px;">${fe.name}</div>
                  <div style="font-size: 12px; color: #9AA3B2;">${fe.type}</div>
                  ${fe.hours?`<div style="font-size: 11px; color: #39FF14; margin-top: 4px;">${fe.hours}</div>`:""}
                </div>
              `);Le.setPopup(Ue),h.current.push(Le)})})}))},[r,t,v]);Jt.useEffect(()=>{l.current&&l.current.loaded()&&k()},[k]);const G=ge=>({available:"#9AA3B2",occupied:"#22D3EE",boarding:"#39FF14",closed:"#F43F5E"})[ge]||"#9AA3B2",q=ge=>({security:"#F59E0B",food:"#F59E0B",retail:"#8B5CF6",lounge:"#22D3EE",baggage:"#F43F5E",checkpoint:"#39FF14",atm:"#39FF14",medical:"#F43F5E",prayer:"#8B5CF6",smoking:"#9AA3B2",wifi:"#22D3EE",charging:"#39FF14",restroom:"#9AA3B2"})[ge]||"#9AA3B2",Q=ge=>({security:"",food:"",retail:"",lounge:"",baggage:"",checkpoint:"",atm:"",medical:"",prayer:"",smoking:"",wifi:"",charging:"",restroom:""})[ge]||"",H=(ge,se)=>{const fe=G(ge.status);return`
      <div style="min-width: 200px;">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
          <span style="font-weight: 700; font-size: 16px;">Gate ${ge.number}</span>
          <span style="color: ${fe}; font-size: 12px; text-transform: uppercase;">${ge.status}</span>
        </div>
        ${se?`
          <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px;">
            <div style="font-size: 14px; font-weight: 600; margin-bottom: 4px;">${se.flightNumber}</div>
            <div style="font-size: 12px; color: #9AA3B2; margin-bottom: 4px;">${se.airline.name}</div>
            <div style="font-size: 12px; margin-bottom: 2px;">To: ${se.destination.city}</div>
            <div style="font-size: 12px; color: ${Pd.getStatusColor(se.status)};">${se.status}</div>
            ${se.scheduledDeparture?`
              <div style="font-size: 11px; color: #9AA3B2; margin-top: 4px;">
                ${Pd.formatTime(se.scheduledDeparture)}
              </div>
            `:""}
          </div>
        `:`
          <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 8px;">
            <div style="font-size: 12px; color: #9AA3B2;">No active flight</div>
          </div>
        `}
      </div>
    `},K=ge=>{L(se=>se.map(fe=>fe.id===ge?{...fe,visible:!fe.visible}:fe))},he=()=>{l.current?.zoomIn()},ue=()=>{l.current?.zoomOut()},me=()=>{l.current?.flyTo({center:r.coordinates,zoom:15.5,pitch:45,bearing:0})};return ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:289:5",className:"relative",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:291:7",ref:o,className:"w-full h-[500px] lg:h-[600px] rounded-xl overflow-hidden",style:{background:"#111827"}}),ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:298:7",className:"absolute top-4 left-4 glass rounded-lg p-2",children:ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:299:9",className:"flex flex-col gap-1",children:[2,1,0].map(ge=>ee.jsx("button",{"code-path":"src/components/AirportMap.tsx:301:13",onClick:()=>w(ge),className:`px-3 py-2 text-sm font-medium rounded-md transition-all ${v===ge?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5"}`,children:ge===0?"G":`L${ge}`},ge))})}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:317:7",className:"absolute top-4 right-4 glass rounded-lg p-3",children:[ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:318:9",className:"flex items-center gap-2 mb-2",children:[ee.jsx(KZ,{"code-path":"src/components/AirportMap.tsx:319:11",className:"w-4 h-4 text-[#9AA3B2]"}),ee.jsx("span",{"code-path":"src/components/AirportMap.tsx:320:11",className:"text-xs font-medium text-[#9AA3B2]",children:"Layers"})]}),ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:322:9",className:"space-y-1",children:I.map(ge=>ee.jsxs("button",{"code-path":"src/components/AirportMap.tsx:324:13",onClick:()=>K(ge.id),className:`flex items-center gap-2 w-full px-2 py-1.5 text-xs rounded transition-all ${ge.visible?"text-[#F3F4F6] bg-white/10":"text-[#9AA3B2] hover:bg-white/5"}`,children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:333:15",className:`w-2 h-2 rounded-full ${ge.visible?"bg-[#39FF14]":"bg-[#9AA3B2]"}`}),ge.name]},ge.id))})]}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:345:7",className:"absolute bottom-4 right-4 flex flex-col gap-2",children:[ee.jsx("button",{"code-path":"src/components/AirportMap.tsx:346:9",onClick:he,className:"w-10 h-10 glass rounded-lg flex items-center justify-center hover:bg-white/10 transition-colors",children:ee.jsx(IW,{"code-path":"src/components/AirportMap.tsx:350:11",className:"w-5 h-5"})}),ee.jsx("button",{"code-path":"src/components/AirportMap.tsx:352:9",onClick:ue,className:"w-10 h-10 glass rounded-lg flex items-center justify-center hover:bg-white/10 transition-colors",children:ee.jsx(DW,{"code-path":"src/components/AirportMap.tsx:356:11",className:"w-5 h-5"})}),ee.jsx("button",{"code-path":"src/components/AirportMap.tsx:358:9",onClick:me,className:"w-10 h-10 glass rounded-lg flex items-center justify-center hover:bg-white/10 transition-colors",children:ee.jsx(MD,{"code-path":"src/components/AirportMap.tsx:362:11",className:"w-5 h-5"})})]}),a&&ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:368:9",className:"absolute bottom-4 left-4 glass rounded-xl p-4 max-w-xs animate-slide-in",children:[ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:369:11",className:"flex items-center justify-between mb-3",children:[ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:370:13",className:"flex items-center gap-2",children:[ee.jsx(hb,{"code-path":"src/components/AirportMap.tsx:371:15",className:"w-5 h-5 text-[#39FF14]"}),ee.jsxs("span",{"code-path":"src/components/AirportMap.tsx:372:15",className:"font-semibold",children:["Gate ",a]})]}),ee.jsx("button",{"code-path":"src/components/AirportMap.tsx:374:13",onClick:()=>C(null),className:"text-[#9AA3B2] hover:text-[#F3F4F6]",children:""})]}),(()=>{const se=t.filter(fe=>fe.gate===a).find(fe=>fe.status==="boarding"||fe.status==="active");return se?ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:387:15",className:"space-y-2",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:388:17",className:"text-sm font-medium",children:se.flightNumber}),ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:389:17",className:"text-xs text-[#9AA3B2]",children:se.airline.name}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:390:17",className:"text-xs",children:["To: ",se.destination.city]}),ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:391:17",className:"text-xs font-medium",style:{color:Pd.getStatusColor(se.status)},children:se.status})]}):ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:399:15",className:"text-sm text-[#9AA3B2]",children:"No active flight at this gate"})})()]}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:406:7",className:"absolute bottom-4 left-1/2 -translate-x-1/2 glass rounded-lg px-4 py-2 hidden md:flex items-center gap-6",children:[ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:407:9",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:408:11",className:"w-3 h-3 rounded-full bg-[#39FF14]"}),ee.jsx("span",{"code-path":"src/components/AirportMap.tsx:409:11",className:"text-xs text-[#9AA3B2]",children:"Boarding"})]}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:411:9",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:412:11",className:"w-3 h-3 rounded-full bg-[#22D3EE]"}),ee.jsx("span",{"code-path":"src/components/AirportMap.tsx:413:11",className:"text-xs text-[#9AA3B2]",children:"Occupied"})]}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:415:9",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:416:11",className:"w-3 h-3 rounded-full bg-[#9AA3B2]"}),ee.jsx("span",{"code-path":"src/components/AirportMap.tsx:417:11",className:"text-xs text-[#9AA3B2]",children:"Available"})]}),ee.jsxs("div",{"code-path":"src/components/AirportMap.tsx:419:9",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/components/AirportMap.tsx:420:11",className:"w-3 h-3 rounded-full bg-[#F43F5E]"}),ee.jsx("span",{"code-path":"src/components/AirportMap.tsx:421:11",className:"text-xs text-[#9AA3B2]",children:"Closed"})]})]})]})}function ZW({airport:r,flights:t}){const[o,l]=Jt.useState("departures"),[h,v]=Jt.useState(""),[w,a]=Jt.useState("all"),[C,I]=Jt.useState(null),L=Jt.useMemo(()=>{let Q=o==="departures"?t.filter(H=>H.origin.code===r.code):t.filter(H=>H.destination.code===r.code);if(h){const H=h.toLowerCase();Q=Q.filter(K=>K.flightNumber.toLowerCase().includes(H)||K.airline.name.toLowerCase().includes(H)||(o==="departures"?K.destination.city.toLowerCase().includes(H):K.origin.city.toLowerCase().includes(H)))}return w!=="all"&&(Q=Q.filter(H=>H.status===w)),Q.slice(0,20)},[t,o,r.code,h,w]),k=Q=>{switch(Q){case"on-time":case"arrived":case"departed":return ee.jsx(ED,{"code-path":"src/components/FlightBoard.tsx:56:16",className:"w-4 h-4"});case"delayed":case"cancelled":return ee.jsx(nV,{"code-path":"src/components/FlightBoard.tsx:59:16",className:"w-4 h-4"});default:return ee.jsx(DT,{"code-path":"src/components/FlightBoard.tsx:61:16",className:"w-4 h-4"})}},G=Q=>{switch(Q){case"on-time":case"boarding":return"badge-success";case"delayed":return"badge-warning";case"cancelled":return"badge-danger";case"departed":case"arrived":return"badge-info";default:return"bg-white/10 text-[#9AA3B2]"}},q=Jt.useMemo(()=>{const Q=o==="departures"?t.filter(me=>me.origin.code===r.code):t.filter(me=>me.destination.code===r.code),H=Q.filter(me=>me.status==="on-time"||me.status==="departed"||me.status==="arrived").length,K=Q.filter(me=>me.status==="delayed").length,he=Q.filter(me=>me.status==="cancelled").length,ue=Q.length;return{onTime:H,delayed:K,cancelled:he,total:ue,onTimePercent:ue>0?Math.round(H/ue*100):0,avgDelay:Q.filter(me=>me.delay).reduce((me,ge)=>me+(ge.delay||0),0)/(Q.filter(me=>me.delay).length||1)}},[t,o,r.code]);return ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:107:5",className:"space-y-6",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:109:7",className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:110:9",className:"flex bg-[#111827] rounded-lg p-1",children:[ee.jsxs("button",{"code-path":"src/components/FlightBoard.tsx:111:11",onClick:()=>l("departures"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-all ${o==="departures"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:[ee.jsx(hW,{"code-path":"src/components/FlightBoard.tsx:119:13",className:"w-4 h-4"}),"Departures"]}),ee.jsxs("button",{"code-path":"src/components/FlightBoard.tsx:122:11",onClick:()=>l("arrivals"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-all ${o==="arrivals"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:[ee.jsx(cW,{"code-path":"src/components/FlightBoard.tsx:130:13",className:"w-4 h-4"}),"Arrivals"]})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:136:9",className:"flex gap-2",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:137:11",className:"relative",children:[ee.jsx(OD,{"code-path":"src/components/FlightBoard.tsx:138:13",className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#9AA3B2]"}),ee.jsx("input",{"code-path":"src/components/FlightBoard.tsx:139:13",type:"text",placeholder:"Search flights...",value:h,onChange:Q=>v(Q.target.value),className:"pl-10 pr-4 py-2 text-sm w-48"})]}),ee.jsxs("select",{"code-path":"src/components/FlightBoard.tsx:147:11",value:w,onChange:Q=>a(Q.target.value),className:"px-3 py-2 text-sm",children:[ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:152:13",value:"all",children:"All Status"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:153:13",value:"scheduled",children:"Scheduled"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:154:13",value:"boarding",children:"Boarding"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:155:13",value:"departed",children:"Departed"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:156:13",value:"arrived",children:"Arrived"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:157:13",value:"delayed",children:"Delayed"}),ee.jsx("option",{"code-path":"src/components/FlightBoard.tsx:158:13",value:"cancelled",children:"Cancelled"})]})]})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:164:7",className:"grid grid-cols-2 sm:grid-cols-4 gap-4",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:165:9",className:"glass rounded-lg p-4",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:166:11",className:"text-2xl font-bold text-[#39FF14]",children:[q.onTimePercent,"%"]}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:167:11",className:"text-xs text-[#9AA3B2]",children:"On-time"})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:169:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:170:11",className:"text-2xl font-bold text-[#F59E0B]",children:q.delayed}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:171:11",className:"text-xs text-[#9AA3B2]",children:"Delayed"})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:173:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:174:11",className:"text-2xl font-bold text-[#F43F5E]",children:q.cancelled}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:175:11",className:"text-xs text-[#9AA3B2]",children:"Cancelled"})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:177:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:178:11",className:"text-2xl font-bold text-[#22D3EE]",children:q.avgDelay>0?`${Math.round(q.avgDelay)}m`:"0m"}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:181:11",className:"text-xs text-[#9AA3B2]",children:"Avg Delay"})]})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:186:7",className:"glass rounded-xl overflow-hidden",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:187:9",className:"overflow-x-auto",children:ee.jsxs("table",{"code-path":"src/components/FlightBoard.tsx:188:11",className:"w-full",children:[ee.jsx("thead",{"code-path":"src/components/FlightBoard.tsx:189:13",children:ee.jsxs("tr",{"code-path":"src/components/FlightBoard.tsx:190:15",className:"border-b border-white/10",children:[ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:191:17",className:"text-left py-3 px-4",children:"Flight"}),ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:192:17",className:"text-left py-3 px-4",children:o==="departures"?"To":"From"}),ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:195:17",className:"text-left py-3 px-4",children:"Time"}),ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:196:17",className:"text-left py-3 px-4",children:"Gate"}),ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:197:17",className:"text-left py-3 px-4",children:"Status"}),ee.jsx("th",{"code-path":"src/components/FlightBoard.tsx:198:17",className:"text-left py-3 px-4"})]})}),ee.jsx("tbody",{"code-path":"src/components/FlightBoard.tsx:201:13",children:L.map(Q=>ee.jsxs(ee.Fragment,{children:[ee.jsxs("tr",{"code-path":"src/components/FlightBoard.tsx:204:19",className:"border-b border-white/5 hover:bg-white/5 transition-colors cursor-pointer",onClick:()=>I(C===Q.id?null:Q.id),children:[ee.jsx("td",{"code-path":"src/components/FlightBoard.tsx:211:21",className:"py-4 px-4",children:ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:212:23",className:"flex items-center gap-3",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:213:25",className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:ee.jsx("span",{"code-path":"src/components/FlightBoard.tsx:214:27",className:"text-xs font-bold",children:Q.airline.code})}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:216:25",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:217:27",className:"font-medium",children:Q.flightNumber}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:218:27",className:"text-xs text-[#9AA3B2]",children:Q.airline.name})]})]})}),ee.jsxs("td",{"code-path":"src/components/FlightBoard.tsx:222:21",className:"py-4 px-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:223:23",className:"font-medium",children:o==="departures"?Q.destination.city:Q.origin.city}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:228:23",className:"text-xs text-[#9AA3B2]",children:o==="departures"?Q.destination.code:Q.origin.code})]}),ee.jsxs("td",{"code-path":"src/components/FlightBoard.tsx:234:21",className:"py-4 px-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:235:23",className:"font-medium",children:Pd.formatTime(o==="departures"?Q.scheduledDeparture:Q.scheduledArrival)}),Q.delay&&Q.delay>0&&ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:243:25",className:"text-xs text-[#F59E0B]",children:["+",Q.delay,"m"]})]}),ee.jsxs("td",{"code-path":"src/components/FlightBoard.tsx:248:21",className:"py-4 px-4",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:249:23",className:"font-medium",children:Q.gate||"TBA"}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:250:23",className:"text-xs text-[#9AA3B2]",children:Q.terminal})]}),ee.jsx("td",{"code-path":"src/components/FlightBoard.tsx:252:21",className:"py-4 px-4",children:ee.jsxs("span",{"code-path":"src/components/FlightBoard.tsx:253:23",className:`badge flex items-center gap-1.5 w-fit ${G(Q.status)}`,children:[k(Q.status),Q.status]})}),ee.jsx("td",{"code-path":"src/components/FlightBoard.tsx:258:21",className:"py-4 px-4",children:ee.jsx(ZZ,{"code-path":"src/components/FlightBoard.tsx:259:23",className:"w-5 h-5 text-[#9AA3B2]"})})]},Q.id),C===Q.id&&ee.jsx("tr",{"code-path":"src/components/FlightBoard.tsx:263:21",className:"bg-white/5",children:ee.jsx("td",{"code-path":"src/components/FlightBoard.tsx:264:23",colSpan:6,className:"py-4 px-4",children:ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:265:25",className:"grid sm:grid-cols-3 gap-4",children:[ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:266:27",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:267:29",className:"text-xs text-[#9AA3B2] mb-1",children:"Aircraft"}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:268:29",className:"text-sm",children:Q.aircraft||"N/A"})]}),Q.baggageClaim&&ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:271:29",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:272:31",className:"text-xs text-[#9AA3B2] mb-1",children:"Baggage Claim"}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:273:31",className:"text-sm",children:Q.baggageClaim})]}),ee.jsxs("div",{"code-path":"src/components/FlightBoard.tsx:276:27",children:[ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:277:29",className:"text-xs text-[#9AA3B2] mb-1",children:"Last Updated"}),ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:278:29",className:"text-sm",children:"Just now"})]})]})})})]}))})]})}),L.length===0&&ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:291:11",className:"py-12 text-center",children:ee.jsx("div",{"code-path":"src/components/FlightBoard.tsx:292:13",className:"text-[#9AA3B2]",children:"No flights found"})})]})]})}function WW({airport:r,flights:t}){const[o,l]=Jt.useState("all"),[h,v]=Jt.useState(null),w=Jt.useMemo(()=>{const L=[];return r.terminals.forEach(k=>{(o==="all"||k.id===o)&&k.gates.forEach(G=>{const q=t.filter(K=>K.gate===G.number),Q=q.find(K=>K.status==="boarding"||K.status==="active"),H=q.filter(K=>K.status==="scheduled").sort((K,he)=>new Date(K.scheduledDeparture).getTime()-new Date(he.scheduledDeparture).getTime()).slice(0,2);L.push({gate:G,terminal:k.name,currentFlight:Q,nextFlights:H})})}),L},[r,t,o]),a=Jt.useMemo(()=>{const L=w.length,k=w.filter(H=>H.gate.status==="boarding").length,G=w.filter(H=>H.gate.status==="occupied").length,q=w.filter(H=>H.gate.status==="available").length,Q=w.filter(H=>H.gate.status==="closed").length;return{total:L,boarding:k,occupied:G,available:q,closed:Q}},[w]),C=L=>{switch(L){case"boarding":return"#39FF14";case"occupied":return"#22D3EE";case"available":return"#9AA3B2";case"closed":return"#F43F5E";default:return"#9AA3B2"}},I=L=>{switch(L){case"boarding":return ee.jsx(fA,{"code-path":"src/components/GateStatus.tsx:93:16",className:"w-4 h-4"});case"occupied":return ee.jsx(DT,{"code-path":"src/components/GateStatus.tsx:95:16",className:"w-4 h-4"});case"available":return ee.jsx(ED,{"code-path":"src/components/GateStatus.tsx:97:16",className:"w-4 h-4"});case"closed":return ee.jsx($Z,{"code-path":"src/components/GateStatus.tsx:99:16",className:"w-4 h-4"});default:return ee.jsx(nV,{"code-path":"src/components/GateStatus.tsx:101:16",className:"w-4 h-4"})}};return ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:106:5",className:"space-y-6",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:108:7",className:"grid grid-cols-2 sm:grid-cols-5 gap-4",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:109:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:110:11",className:"text-2xl font-bold",children:a.total}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:111:11",className:"text-xs text-[#9AA3B2]",children:"Total Gates"})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:113:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:114:11",className:"text-2xl font-bold text-[#39FF14]",children:a.boarding}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:115:11",className:"text-xs text-[#9AA3B2]",children:"Boarding"})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:117:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:118:11",className:"text-2xl font-bold text-[#22D3EE]",children:a.occupied}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:119:11",className:"text-xs text-[#9AA3B2]",children:"Occupied"})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:121:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:122:11",className:"text-2xl font-bold text-[#9AA3B2]",children:a.available}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:123:11",className:"text-xs text-[#9AA3B2]",children:"Available"})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:125:9",className:"glass rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:126:11",className:"text-2xl font-bold text-[#F43F5E]",children:a.closed}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:127:11",className:"text-xs text-[#9AA3B2]",children:"Closed"})]})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:132:7",className:"flex flex-wrap gap-2",children:[ee.jsx("button",{"code-path":"src/components/GateStatus.tsx:133:9",onClick:()=>l("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${o==="all"?"bg-[#39FF14] text-[#0B0F17]":"glass text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:"All Terminals"}),r.terminals.map(L=>ee.jsx("button",{"code-path":"src/components/GateStatus.tsx:144:11",onClick:()=>l(L.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${o===L.id?"bg-[#39FF14] text-[#0B0F17]":"glass text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:L.name},L.id))]}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:159:7",className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:w.map(({gate:L,terminal:k,currentFlight:G})=>ee.jsxs("button",{"code-path":"src/components/GateStatus.tsx:161:11",onClick:()=>v(h===L.number?null:L.number),className:`relative p-4 rounded-xl transition-all text-left ${h===L.number?"ring-2 ring-[#39FF14] bg-white/10":"glass hover:bg-white/5"}`,children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:171:13",className:"absolute top-2 right-2 w-2 h-2 rounded-full",style:{backgroundColor:C(L.status)}}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:177:13",className:"text-lg font-bold mb-1",children:L.number}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:180:13",className:"text-xs text-[#9AA3B2] mb-2",children:k}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:183:13",className:"flex items-center gap-1.5 text-xs",style:{color:C(L.status)},children:[I(L.status),ee.jsx("span",{"code-path":"src/components/GateStatus.tsx:188:15",className:"capitalize",children:L.status})]}),G&&ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:193:15",className:"mt-3 pt-3 border-t border-white/10",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:194:17",className:"text-xs font-medium truncate",children:G.flightNumber}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:195:17",className:"text-xs text-[#9AA3B2] truncate",children:G.destination.city})]})]},L.id))}),h&&ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:206:9",className:"glass rounded-xl p-6 animate-fade-in",children:(()=>{const L=w.find(k=>k.gate.number===h);return L?ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:212:15",className:"space-y-4",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:213:17",className:"flex items-start justify-between",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:214:19",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:215:21",className:"flex items-center gap-3",children:[ee.jsx(hb,{"code-path":"src/components/GateStatus.tsx:216:23",className:"w-6 h-6 text-[#39FF14]"}),ee.jsxs("h3",{"code-path":"src/components/GateStatus.tsx:217:23",className:"text-2xl font-bold",children:["Gate ",h]})]}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:219:21",className:"text-[#9AA3B2] mt-1",children:L.terminal})]}),ee.jsx("button",{"code-path":"src/components/GateStatus.tsx:221:19",onClick:()=>v(null),className:"text-[#9AA3B2] hover:text-[#F3F4F6]",children:""})]}),L.currentFlight?ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:231:19",className:"bg-white/5 rounded-lg p-4",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:232:21",className:"text-xs text-[#9AA3B2] uppercase tracking-wider mb-2",children:"Current Flight"}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:235:21",className:"flex items-center justify-between",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:236:23",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:237:25",className:"text-xl font-bold",children:L.currentFlight.flightNumber}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:238:25",className:"text-sm text-[#9AA3B2]",children:L.currentFlight.airline.name})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:240:23",className:"text-right",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:241:25",className:"text-lg font-medium",children:L.currentFlight.destination.city}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:242:25",className:"text-sm text-[#9AA3B2]",children:L.currentFlight.destination.code})]})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:245:21",className:"flex items-center gap-4 mt-4 pt-4 border-t border-white/10",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:246:23",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:247:25",className:"text-xs text-[#9AA3B2]",children:"Status"}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:248:25",className:"text-sm font-medium",style:{color:Pd.getStatusColor(L.currentFlight.status)},children:L.currentFlight.status})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:255:23",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:256:25",className:"text-xs text-[#9AA3B2]",children:"Departure"}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:257:25",className:"text-sm font-medium",children:Pd.formatTime(L.currentFlight.scheduledDeparture)})]}),L.currentFlight.delay&&L.currentFlight.delay>0&&ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:262:25",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:263:27",className:"text-xs text-[#9AA3B2]",children:"Delay"}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:264:27",className:"text-sm font-medium text-[#F59E0B]",children:["+",L.currentFlight.delay,"m"]})]})]})]}):ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:272:19",className:"bg-white/5 rounded-lg p-4 text-center",children:ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:273:21",className:"text-[#9AA3B2]",children:"No active flight at this gate"})}),L.nextFlights.length>0&&ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:279:19",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:280:21",className:"text-xs text-[#9AA3B2] uppercase tracking-wider mb-2",children:"Upcoming Flights"}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:283:21",className:"space-y-2",children:L.nextFlights.map(k=>ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:285:25",className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:289:27",className:"flex items-center gap-3",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:290:29",className:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center",children:ee.jsx("span",{"code-path":"src/components/GateStatus.tsx:291:31",className:"text-xs font-bold",children:k.airline.code})}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:293:29",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:294:31",className:"font-medium",children:k.flightNumber}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:295:31",className:"text-xs text-[#9AA3B2]",children:k.destination.city})]})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:298:27",className:"text-right",children:[ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:299:29",className:"font-medium",children:Pd.formatTime(k.scheduledDeparture)}),ee.jsx("div",{"code-path":"src/components/GateStatus.tsx:302:29",className:"text-xs",style:{color:Pd.getStatusColor(k.status)},children:k.status})]})]},k.id))})]}),ee.jsxs("div",{"code-path":"src/components/GateStatus.tsx:316:17",className:"flex items-center gap-2 pt-4 border-t border-white/10",children:[ee.jsx(MD,{"code-path":"src/components/GateStatus.tsx:317:19",className:"w-4 h-4 text-[#39FF14]"}),ee.jsx("span",{"code-path":"src/components/GateStatus.tsx:318:19",className:"text-sm text-[#9AA3B2]",children:"Get walking directions to this gate"})]})]}):null})()})]})}function aV(r){var t,o,l="";if(typeof r=="string"||typeof r=="number")l+=r;else if(typeof r=="object")if(Array.isArray(r)){var h=r.length;for(t=0;t<h;t++)r[t]&&(o=aV(r[t]))&&(l&&(l+=" "),l+=o)}else for(o in r)r[o]&&(l&&(l+=" "),l+=o);return l}function li(){for(var r,t,o=0,l="",h=arguments.length;o<h;o++)(r=arguments[o])&&(t=aV(r))&&(l&&(l+=" "),l+=t);return l}var rM,k5;function Zc(){if(k5)return rM;k5=1;var r=Array.isArray;return rM=r,rM}var nM,F5;function oV(){if(F5)return nM;F5=1;var r=typeof C2=="object"&&C2&&C2.Object===Object&&C2;return nM=r,nM}var iM,N5;function Wf(){if(N5)return iM;N5=1;var r=oV(),t=typeof self=="object"&&self&&self.Object===Object&&self,o=r||t||Function("return this")();return iM=o,iM}var aM,j5;function cw(){if(j5)return aM;j5=1;var r=Wf(),t=r.Symbol;return aM=t,aM}var oM,U5;function YW(){if(U5)return oM;U5=1;var r=cw(),t=Object.prototype,o=t.hasOwnProperty,l=t.toString,h=r?r.toStringTag:void 0;function v(w){var a=o.call(w,h),C=w[h];try{w[h]=void 0;var I=!0}catch{}var L=l.call(w);return I&&(a?w[h]=C:delete w[h]),L}return oM=v,oM}var sM,V5;function KW(){if(V5)return sM;V5=1;var r=Object.prototype,t=r.toString;function o(l){return t.call(l)}return sM=o,sM}var lM,G5;function vm(){if(G5)return lM;G5=1;var r=cw(),t=YW(),o=KW(),l="[object Null]",h="[object Undefined]",v=r?r.toStringTag:void 0;function w(a){return a==null?a===void 0?h:l:v&&v in Object(a)?t(a):o(a)}return lM=w,lM}var cM,$5;function xm(){if($5)return cM;$5=1;function r(t){return t!=null&&typeof t=="object"}return cM=r,cM}var uM,q5;function mx(){if(q5)return uM;q5=1;var r=vm(),t=xm(),o="[object Symbol]";function l(h){return typeof h=="symbol"||t(h)&&r(h)==o}return uM=l,uM}var hM,H5;function ID(){if(H5)return hM;H5=1;var r=Zc(),t=mx(),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/;function h(v,w){if(r(v))return!1;var a=typeof v;return a=="number"||a=="symbol"||a=="boolean"||v==null||t(v)?!0:l.test(v)||!o.test(v)||w!=null&&v in Object(w)}return hM=h,hM}var dM,X5;function Kg(){if(X5)return dM;X5=1;function r(t){var o=typeof t;return t!=null&&(o=="object"||o=="function")}return dM=r,dM}var fM,Z5;function PD(){if(Z5)return fM;Z5=1;var r=vm(),t=Kg(),o="[object AsyncFunction]",l="[object Function]",h="[object GeneratorFunction]",v="[object Proxy]";function w(a){if(!t(a))return!1;var C=r(a);return C==l||C==h||C==o||C==v}return fM=w,fM}var pM,W5;function QW(){if(W5)return pM;W5=1;var r=Wf(),t=r["__core-js_shared__"];return pM=t,pM}var mM,Y5;function JW(){if(Y5)return mM;Y5=1;var r=QW(),t=(function(){var l=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})();function o(l){return!!t&&t in l}return mM=o,mM}var gM,K5;function sV(){if(K5)return gM;K5=1;var r=Function.prototype,t=r.toString;function o(l){if(l!=null){try{return t.call(l)}catch{}try{return l+""}catch{}}return""}return gM=o,gM}var _M,Q5;function eY(){if(Q5)return _M;Q5=1;var r=PD(),t=JW(),o=Kg(),l=sV(),h=/[\\^$.*+?()[\]{}|]/g,v=/^\[object .+?Constructor\]$/,w=Function.prototype,a=Object.prototype,C=w.toString,I=a.hasOwnProperty,L=RegExp("^"+C.call(I).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function k(G){if(!o(G)||t(G))return!1;var q=r(G)?L:v;return q.test(l(G))}return _M=k,_M}var yM,J5;function tY(){if(J5)return yM;J5=1;function r(t,o){return t?.[o]}return yM=r,yM}var vM,e4;function tv(){if(e4)return vM;e4=1;var r=eY(),t=tY();function o(l,h){var v=t(l,h);return r(v)?v:void 0}return vM=o,vM}var xM,t4;function RT(){if(t4)return xM;t4=1;var r=tv(),t=r(Object,"create");return xM=t,xM}var bM,r4;function rY(){if(r4)return bM;r4=1;var r=RT();function t(){this.__data__=r?r(null):{},this.size=0}return bM=t,bM}var wM,n4;function nY(){if(n4)return wM;n4=1;function r(t){var o=this.has(t)&&delete this.__data__[t];return this.size-=o?1:0,o}return wM=r,wM}var AM,i4;function iY(){if(i4)return AM;i4=1;var r=RT(),t="__lodash_hash_undefined__",o=Object.prototype,l=o.hasOwnProperty;function h(v){var w=this.__data__;if(r){var a=w[v];return a===t?void 0:a}return l.call(w,v)?w[v]:void 0}return AM=h,AM}var TM,a4;function aY(){if(a4)return TM;a4=1;var r=RT(),t=Object.prototype,o=t.hasOwnProperty;function l(h){var v=this.__data__;return r?v[h]!==void 0:o.call(v,h)}return TM=l,TM}var SM,o4;function oY(){if(o4)return SM;o4=1;var r=RT(),t="__lodash_hash_undefined__";function o(l,h){var v=this.__data__;return this.size+=this.has(l)?0:1,v[l]=r&&h===void 0?t:h,this}return SM=o,SM}var EM,s4;function sY(){if(s4)return EM;s4=1;var r=rY(),t=nY(),o=iY(),l=aY(),h=oY();function v(w){var a=-1,C=w==null?0:w.length;for(this.clear();++a<C;){var I=w[a];this.set(I[0],I[1])}}return v.prototype.clear=r,v.prototype.delete=t,v.prototype.get=o,v.prototype.has=l,v.prototype.set=h,EM=v,EM}var MM,l4;function lY(){if(l4)return MM;l4=1;function r(){this.__data__=[],this.size=0}return MM=r,MM}var OM,c4;function DD(){if(c4)return OM;c4=1;function r(t,o){return t===o||t!==t&&o!==o}return OM=r,OM}var CM,u4;function zT(){if(u4)return CM;u4=1;var r=DD();function t(o,l){for(var h=o.length;h--;)if(r(o[h][0],l))return h;return-1}return CM=t,CM}var IM,h4;function cY(){if(h4)return IM;h4=1;var r=zT(),t=Array.prototype,o=t.splice;function l(h){var v=this.__data__,w=r(v,h);if(w<0)return!1;var a=v.length-1;return w==a?v.pop():o.call(v,w,1),--this.size,!0}return IM=l,IM}var PM,d4;function uY(){if(d4)return PM;d4=1;var r=zT();function t(o){var l=this.__data__,h=r(l,o);return h<0?void 0:l[h][1]}return PM=t,PM}var DM,f4;function hY(){if(f4)return DM;f4=1;var r=zT();function t(o){return r(this.__data__,o)>-1}return DM=t,DM}var RM,p4;function dY(){if(p4)return RM;p4=1;var r=zT();function t(o,l){var h=this.__data__,v=r(h,o);return v<0?(++this.size,h.push([o,l])):h[v][1]=l,this}return RM=t,RM}var zM,m4;function LT(){if(m4)return zM;m4=1;var r=lY(),t=cY(),o=uY(),l=hY(),h=dY();function v(w){var a=-1,C=w==null?0:w.length;for(this.clear();++a<C;){var I=w[a];this.set(I[0],I[1])}}return v.prototype.clear=r,v.prototype.delete=t,v.prototype.get=o,v.prototype.has=l,v.prototype.set=h,zM=v,zM}var LM,g4;function RD(){if(g4)return LM;g4=1;var r=tv(),t=Wf(),o=r(t,"Map");return LM=o,LM}var BM,_4;function fY(){if(_4)return BM;_4=1;var r=sY(),t=LT(),o=RD();function l(){this.size=0,this.__data__={hash:new r,map:new(o||t),string:new r}}return BM=l,BM}var kM,y4;function pY(){if(y4)return kM;y4=1;function r(t){var o=typeof t;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?t!=="__proto__":t===null}return kM=r,kM}var FM,v4;function BT(){if(v4)return FM;v4=1;var r=pY();function t(o,l){var h=o.__data__;return r(l)?h[typeof l=="string"?"string":"hash"]:h.map}return FM=t,FM}var NM,x4;function mY(){if(x4)return NM;x4=1;var r=BT();function t(o){var l=r(this,o).delete(o);return this.size-=l?1:0,l}return NM=t,NM}var jM,b4;function gY(){if(b4)return jM;b4=1;var r=BT();function t(o){return r(this,o).get(o)}return jM=t,jM}var UM,w4;function _Y(){if(w4)return UM;w4=1;var r=BT();function t(o){return r(this,o).has(o)}return UM=t,UM}var VM,A4;function yY(){if(A4)return VM;A4=1;var r=BT();function t(o,l){var h=r(this,o),v=h.size;return h.set(o,l),this.size+=h.size==v?0:1,this}return VM=t,VM}var GM,T4;function zD(){if(T4)return GM;T4=1;var r=fY(),t=mY(),o=gY(),l=_Y(),h=yY();function v(w){var a=-1,C=w==null?0:w.length;for(this.clear();++a<C;){var I=w[a];this.set(I[0],I[1])}}return v.prototype.clear=r,v.prototype.delete=t,v.prototype.get=o,v.prototype.has=l,v.prototype.set=h,GM=v,GM}var $M,S4;function lV(){if(S4)return $M;S4=1;var r=zD(),t="Expected a function";function o(l,h){if(typeof l!="function"||h!=null&&typeof h!="function")throw new TypeError(t);var v=function(){var w=arguments,a=h?h.apply(this,w):w[0],C=v.cache;if(C.has(a))return C.get(a);var I=l.apply(this,w);return v.cache=C.set(a,I)||C,I};return v.cache=new(o.Cache||r),v}return o.Cache=r,$M=o,$M}var qM,E4;function vY(){if(E4)return qM;E4=1;var r=lV(),t=500;function o(l){var h=r(l,function(w){return v.size===t&&v.clear(),w}),v=h.cache;return h}return qM=o,qM}var HM,M4;function xY(){if(M4)return HM;M4=1;var r=vY(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,l=r(function(h){var v=[];return h.charCodeAt(0)===46&&v.push(""),h.replace(t,function(w,a,C,I){v.push(C?I.replace(o,"$1"):a||w)}),v});return HM=l,HM}var XM,O4;function LD(){if(O4)return XM;O4=1;function r(t,o){for(var l=-1,h=t==null?0:t.length,v=Array(h);++l<h;)v[l]=o(t[l],l,t);return v}return XM=r,XM}var ZM,C4;function bY(){if(C4)return ZM;C4=1;var r=cw(),t=LD(),o=Zc(),l=mx(),h=r?r.prototype:void 0,v=h?h.toString:void 0;function w(a){if(typeof a=="string")return a;if(o(a))return t(a,w)+"";if(l(a))return v?v.call(a):"";var C=a+"";return C=="0"&&1/a==-1/0?"-0":C}return ZM=w,ZM}var WM,I4;function cV(){if(I4)return WM;I4=1;var r=bY();function t(o){return o==null?"":r(o)}return WM=t,WM}var YM,P4;function uV(){if(P4)return YM;P4=1;var r=Zc(),t=ID(),o=xY(),l=cV();function h(v,w){return r(v)?v:t(v,w)?[v]:o(l(v))}return YM=h,YM}var KM,D4;function kT(){if(D4)return KM;D4=1;var r=mx();function t(o){if(typeof o=="string"||r(o))return o;var l=o+"";return l=="0"&&1/o==-1/0?"-0":l}return KM=t,KM}var QM,R4;function BD(){if(R4)return QM;R4=1;var r=uV(),t=kT();function o(l,h){h=r(h,l);for(var v=0,w=h.length;l!=null&&v<w;)l=l[t(h[v++])];return v&&v==w?l:void 0}return QM=o,QM}var JM,z4;function hV(){if(z4)return JM;z4=1;var r=BD();function t(o,l,h){var v=o==null?void 0:r(o,l);return v===void 0?h:v}return JM=t,JM}var wY=hV();const ju=ca(wY);var e3,L4;function AY(){if(L4)return e3;L4=1;function r(t){return t==null}return e3=r,e3}var TY=AY();const ei=ca(TY);var t3,B4;function SY(){if(B4)return t3;B4=1;var r=vm(),t=Zc(),o=xm(),l="[object String]";function h(v){return typeof v=="string"||!t(v)&&o(v)&&r(v)==l}return t3=h,t3}var EY=SY();const Zy=ca(EY);var MY=PD();const Bn=ca(MY);var OY=Kg();const gx=ca(OY);var r3={exports:{}},oa={};var k4;function CY(){if(k4)return oa;k4=1;var r=Symbol.for("react.element"),t=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),w=Symbol.for("react.context"),a=Symbol.for("react.server_context"),C=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),Q;Q=Symbol.for("react.module.reference");function H(K){if(typeof K=="object"&&K!==null){var he=K.$$typeof;switch(he){case r:switch(K=K.type,K){case o:case h:case l:case I:case L:return K;default:switch(K=K&&K.$$typeof,K){case a:case w:case C:case G:case k:case v:return K;default:return he}}case t:return he}}}return oa.ContextConsumer=w,oa.ContextProvider=v,oa.Element=r,oa.ForwardRef=C,oa.Fragment=o,oa.Lazy=G,oa.Memo=k,oa.Portal=t,oa.Profiler=h,oa.StrictMode=l,oa.Suspense=I,oa.SuspenseList=L,oa.isAsyncMode=function(){return!1},oa.isConcurrentMode=function(){return!1},oa.isContextConsumer=function(K){return H(K)===w},oa.isContextProvider=function(K){return H(K)===v},oa.isElement=function(K){return typeof K=="object"&&K!==null&&K.$$typeof===r},oa.isForwardRef=function(K){return H(K)===C},oa.isFragment=function(K){return H(K)===o},oa.isLazy=function(K){return H(K)===G},oa.isMemo=function(K){return H(K)===k},oa.isPortal=function(K){return H(K)===t},oa.isProfiler=function(K){return H(K)===h},oa.isStrictMode=function(K){return H(K)===l},oa.isSuspense=function(K){return H(K)===I},oa.isSuspenseList=function(K){return H(K)===L},oa.isValidElementType=function(K){return typeof K=="string"||typeof K=="function"||K===o||K===h||K===l||K===I||K===L||K===q||typeof K=="object"&&K!==null&&(K.$$typeof===G||K.$$typeof===k||K.$$typeof===v||K.$$typeof===w||K.$$typeof===C||K.$$typeof===Q||K.getModuleId!==void 0)},oa.typeOf=H,oa}var F4;function IY(){return F4||(F4=1,r3.exports=CY()),r3.exports}var PY=IY(),n3,N4;function dV(){if(N4)return n3;N4=1;var r=vm(),t=xm(),o="[object Number]";function l(h){return typeof h=="number"||t(h)&&r(h)==o}return n3=l,n3}var i3,j4;function DY(){if(j4)return i3;j4=1;var r=dV();function t(o){return r(o)&&o!=+o}return i3=t,i3}var RY=DY();const _x=ca(RY);var zY=dV();const LY=ca(zY);var fc=function(t){return t===0?0:t>0?1:-1},Cy=function(t){return Zy(t)&&t.indexOf("%")===t.length-1},Ar=function(t){return LY(t)&&!_x(t)},BY=function(t){return ei(t)},Ms=function(t){return Ar(t)||Zy(t)},kY=0,yx=function(t){var o=++kY;return"".concat(t||"").concat(o)},pc=function(t,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Ar(t)&&!Zy(t))return l;var v;if(Cy(t)){var w=t.indexOf("%");v=o*parseFloat(t.slice(0,w))/100}else v=+t;return _x(v)&&(v=l),h&&v>o&&(v=o),v},zg=function(t){if(!t)return null;var o=Object.keys(t);return o&&o.length?t[o[0]]:null},FY=function(t){if(!Array.isArray(t))return!1;for(var o=t.length,l={},h=0;h<o;h++)if(!l[t[h]])l[t[h]]=!0;else return!0;return!1},Uc=function(t,o){return Ar(t)&&Ar(o)?function(l){return t+l*(o-t)}:function(){return o}};function IA(r,t,o){return!r||!r.length?null:r.find(function(l){return l&&(typeof t=="function"?t(l):ju(l,t))===o})}var NY=function(t,o){return Ar(t)&&Ar(o)?t-o:Zy(t)&&Zy(o)?t.localeCompare(o):t instanceof Date&&o instanceof Date?t.getTime()-o.getTime():String(t).localeCompare(String(o))};function P0(r,t){for(var o in r)if({}.hasOwnProperty.call(r,o)&&(!{}.hasOwnProperty.call(t,o)||r[o]!==t[o]))return!1;for(var l in t)if({}.hasOwnProperty.call(t,l)&&!{}.hasOwnProperty.call(r,l))return!1;return!0}function RI(r){"@babel/helpers - typeof";return RI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},RI(r)}var jY=["viewBox","children"],UY=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],U4=["points","pathLength"],a3={svg:jY,polygon:U4,polyline:U4},kD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],PA=function(t,o){if(!t||typeof t=="function"||typeof t=="boolean")return null;var l=t;if(Jt.isValidElement(t)&&(l=t.props),!gx(l))return null;var h={};return Object.keys(l).forEach(function(v){kD.includes(v)&&(h[v]=o||function(w){return l[v](l,w)})}),h},VY=function(t,o,l){return function(h){return t(o,l,h),null}},Wy=function(t,o,l){if(!gx(t)||RI(t)!=="object")return null;var h=null;return Object.keys(t).forEach(function(v){var w=t[v];kD.includes(v)&&typeof w=="function"&&(h||(h={}),h[v]=VY(w,o,l))}),h},GY=["children"],$Y=["children"];function V4(r,t){if(r==null)return{};var o=qY(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function qY(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function zI(r){"@babel/helpers - typeof";return zI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zI(r)}var G4={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},cm=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},$4=null,o3=null,FD=function r(t){if(t===$4&&Array.isArray(o3))return o3;var o=[];return Jt.Children.forEach(t,function(l){ei(l)||(PY.isFragment(l)?o=o.concat(r(l.props.children)):o.push(l))}),o3=o,$4=t,o};function Rh(r,t){var o=[],l=[];return Array.isArray(t)?l=t.map(function(h){return cm(h)}):l=[cm(t)],FD(r).forEach(function(h){var v=ju(h,"type.displayName")||ju(h,"type.name");l.indexOf(v)!==-1&&o.push(h)}),o}function Iu(r,t){var o=Rh(r,t);return o&&o[0]}var q4=function(t){if(!t||!t.props)return!1;var o=t.props,l=o.width,h=o.height;return!(!Ar(l)||l<=0||!Ar(h)||h<=0)},HY=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],XY=function(t){return t&&t.type&&Zy(t.type)&&HY.indexOf(t.type)>=0},ZY=function(t){return t&&zI(t)==="object"&&"clipDot"in t},WY=function(t,o,l,h){var v,w=(v=a3?.[h])!==null&&v!==void 0?v:[];return o.startsWith("data-")||!Bn(t)&&(h&&w.includes(o)||UY.includes(o))||l&&kD.includes(o)},xn=function(t,o,l){if(!t||typeof t=="function"||typeof t=="boolean")return null;var h=t;if(Jt.isValidElement(t)&&(h=t.props),!gx(h))return null;var v={};return Object.keys(h).forEach(function(w){var a;WY((a=h)===null||a===void 0?void 0:a[w],w,o,l)&&(v[w]=h[w])}),v},LI=function r(t,o){if(t===o)return!0;var l=Jt.Children.count(t);if(l!==Jt.Children.count(o))return!1;if(l===0)return!0;if(l===1)return H4(Array.isArray(t)?t[0]:t,Array.isArray(o)?o[0]:o);for(var h=0;h<l;h++){var v=t[h],w=o[h];if(Array.isArray(v)||Array.isArray(w)){if(!r(v,w))return!1}else if(!H4(v,w))return!1}return!0},H4=function(t,o){if(ei(t)&&ei(o))return!0;if(!ei(t)&&!ei(o)){var l=t.props||{},h=l.children,v=V4(l,GY),w=o.props||{},a=w.children,C=V4(w,$Y);return h&&a?P0(v,C)&&LI(h,a):!h&&!a?P0(v,C):!1}return!1},X4=function(t,o){var l=[],h={};return FD(t).forEach(function(v,w){if(XY(v))l.push(v);else if(v){var a=cm(v.type),C=o[a]||{},I=C.handler,L=C.once;if(I&&(!L||!h[a])){var k=I(v,a,w);l.push(k),h[a]=!0}}}),l},YY=function(t){var o=t&&t.type;return o&&G4[o]?G4[o]:null},KY=function(t,o){return FD(o).indexOf(t)},QY=["children","width","height","viewBox","className","style","title","desc"];function BI(){return BI=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},BI.apply(this,arguments)}function JY(r,t){if(r==null)return{};var o=eK(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function eK(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function kI(r){var t=r.children,o=r.width,l=r.height,h=r.viewBox,v=r.className,w=r.style,a=r.title,C=r.desc,I=JY(r,QY),L=h||{width:o,height:l,x:0,y:0},k=li("recharts-surface",v);return ft.createElement("svg",BI({},xn(I,!0,"svg"),{className:k,width:o,height:l,style:w,viewBox:"".concat(L.x," ").concat(L.y," ").concat(L.width," ").concat(L.height)}),ft.createElement("title",null,a),ft.createElement("desc",null,C),t)}var tK=["children","className"];function FI(){return FI=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},FI.apply(this,arguments)}function rK(r,t){if(r==null)return{};var o=nK(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function nK(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}var Gi=ft.forwardRef(function(r,t){var o=r.children,l=r.className,h=rK(r,tK),v=li("recharts-layer",l);return ft.createElement("g",FI({className:v},xn(h,!0),{ref:t}),o)}),Dd=function(t,o){for(var l=arguments.length,h=new Array(l>2?l-2:0),v=2;v<l;v++)h[v-2]=arguments[v]},s3,Z4;function iK(){if(Z4)return s3;Z4=1;function r(t,o,l){var h=-1,v=t.length;o<0&&(o=-o>v?0:v+o),l=l>v?v:l,l<0&&(l+=v),v=o>l?0:l-o>>>0,o>>>=0;for(var w=Array(v);++h<v;)w[h]=t[h+o];return w}return s3=r,s3}var l3,W4;function aK(){if(W4)return l3;W4=1;var r=iK();function t(o,l,h){var v=o.length;return h=h===void 0?v:h,!l&&h>=v?o:r(o,l,h)}return l3=t,l3}var c3,Y4;function fV(){if(Y4)return c3;Y4=1;var r="\\ud800-\\udfff",t="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",l="\\u20d0-\\u20ff",h=t+o+l,v="\\ufe0e\\ufe0f",w="\\u200d",a=RegExp("["+w+r+h+v+"]");function C(I){return a.test(I)}return c3=C,c3}var u3,K4;function oK(){if(K4)return u3;K4=1;function r(t){return t.split("")}return u3=r,u3}var h3,Q4;function sK(){if(Q4)return h3;Q4=1;var r="\\ud800-\\udfff",t="\\u0300-\\u036f",o="\\ufe20-\\ufe2f",l="\\u20d0-\\u20ff",h=t+o+l,v="\\ufe0e\\ufe0f",w="["+r+"]",a="["+h+"]",C="\\ud83c[\\udffb-\\udfff]",I="(?:"+a+"|"+C+")",L="[^"+r+"]",k="(?:\\ud83c[\\udde6-\\uddff]){2}",G="[\\ud800-\\udbff][\\udc00-\\udfff]",q="\\u200d",Q=I+"?",H="["+v+"]?",K="(?:"+q+"(?:"+[L,k,G].join("|")+")"+H+Q+")*",he=H+Q+K,ue="(?:"+[L+a+"?",a,k,G,w].join("|")+")",me=RegExp(C+"(?="+C+")|"+ue+he,"g");function ge(se){return se.match(me)||[]}return h3=ge,h3}var d3,J4;function lK(){if(J4)return d3;J4=1;var r=oK(),t=fV(),o=sK();function l(h){return t(h)?o(h):r(h)}return d3=l,d3}var f3,ek;function cK(){if(ek)return f3;ek=1;var r=aK(),t=fV(),o=lK(),l=cV();function h(v){return function(w){w=l(w);var a=t(w)?o(w):void 0,C=a?a[0]:w.charAt(0),I=a?r(a,1).join(""):w.slice(1);return C[v]()+I}}return f3=h,f3}var p3,tk;function uK(){if(tk)return p3;tk=1;var r=cK(),t=r("toUpperCase");return p3=t,p3}var hK=uK();const FT=ca(hK);function Ra(r){return function(){return r}}const pV=Math.cos,DA=Math.sin,Rd=Math.sqrt,RA=Math.PI,NT=2*RA,NI=Math.PI,jI=2*NI,Ty=1e-6,dK=jI-Ty;function mV(r){this._+=r[0];for(let t=1,o=r.length;t<o;++t)this._+=arguments[t]+r[t]}function fK(r){let t=Math.floor(r);if(!(t>=0))throw new Error(`invalid digits: ${r}`);if(t>15)return mV;const o=10**t;return function(l){this._+=l[0];for(let h=1,v=l.length;h<v;++h)this._+=Math.round(arguments[h]*o)/o+l[h]}}class pK{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mV:fK(t)}moveTo(t,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+o}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,o){this._append`L${this._x1=+t},${this._y1=+o}`}quadraticCurveTo(t,o,l,h){this._append`Q${+t},${+o},${this._x1=+l},${this._y1=+h}`}bezierCurveTo(t,o,l,h,v,w){this._append`C${+t},${+o},${+l},${+h},${this._x1=+v},${this._y1=+w}`}arcTo(t,o,l,h,v){if(t=+t,o=+o,l=+l,h=+h,v=+v,v<0)throw new Error(`negative radius: ${v}`);let w=this._x1,a=this._y1,C=l-t,I=h-o,L=w-t,k=a-o,G=L*L+k*k;if(this._x1===null)this._append`M${this._x1=t},${this._y1=o}`;else if(G>Ty)if(!(Math.abs(k*C-I*L)>Ty)||!v)this._append`L${this._x1=t},${this._y1=o}`;else{let q=l-w,Q=h-a,H=C*C+I*I,K=q*q+Q*Q,he=Math.sqrt(H),ue=Math.sqrt(G),me=v*Math.tan((NI-Math.acos((H+G-K)/(2*he*ue)))/2),ge=me/ue,se=me/he;Math.abs(ge-1)>Ty&&this._append`L${t+ge*L},${o+ge*k}`,this._append`A${v},${v},0,0,${+(k*q>L*Q)},${this._x1=t+se*C},${this._y1=o+se*I}`}}arc(t,o,l,h,v,w){if(t=+t,o=+o,l=+l,w=!!w,l<0)throw new Error(`negative radius: ${l}`);let a=l*Math.cos(h),C=l*Math.sin(h),I=t+a,L=o+C,k=1^w,G=w?h-v:v-h;this._x1===null?this._append`M${I},${L}`:(Math.abs(this._x1-I)>Ty||Math.abs(this._y1-L)>Ty)&&this._append`L${I},${L}`,l&&(G<0&&(G=G%jI+jI),G>dK?this._append`A${l},${l},0,1,${k},${t-a},${o-C}A${l},${l},0,1,${k},${this._x1=I},${this._y1=L}`:G>Ty&&this._append`A${l},${l},0,${+(G>=NI)},${k},${this._x1=t+l*Math.cos(v)},${this._y1=o+l*Math.sin(v)}`)}rect(t,o,l,h){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+o}h${l=+l}v${+h}h${-l}Z`}toString(){return this._}}function ND(r){let t=3;return r.digits=function(o){if(!arguments.length)return t;if(o==null)t=null;else{const l=Math.floor(o);if(!(l>=0))throw new RangeError(`invalid digits: ${o}`);t=l}return r},()=>new pK(t)}function jD(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function gV(r){this._context=r}gV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,t){switch(r=+r,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break;case 1:this._point=2;default:this._context.lineTo(r,t);break}}};function jT(r){return new gV(r)}function _V(r){return r[0]}function yV(r){return r[1]}function vV(r,t){var o=Ra(!0),l=null,h=jT,v=null,w=ND(a);r=typeof r=="function"?r:r===void 0?_V:Ra(r),t=typeof t=="function"?t:t===void 0?yV:Ra(t);function a(C){var I,L=(C=jD(C)).length,k,G=!1,q;for(l==null&&(v=h(q=w())),I=0;I<=L;++I)!(I<L&&o(k=C[I],I,C))===G&&((G=!G)?v.lineStart():v.lineEnd()),G&&v.point(+r(k,I,C),+t(k,I,C));if(q)return v=null,q+""||null}return a.x=function(C){return arguments.length?(r=typeof C=="function"?C:Ra(+C),a):r},a.y=function(C){return arguments.length?(t=typeof C=="function"?C:Ra(+C),a):t},a.defined=function(C){return arguments.length?(o=typeof C=="function"?C:Ra(!!C),a):o},a.curve=function(C){return arguments.length?(h=C,l!=null&&(v=h(l)),a):h},a.context=function(C){return arguments.length?(C==null?l=v=null:v=h(l=C),a):l},a}function $2(r,t,o){var l=null,h=Ra(!0),v=null,w=jT,a=null,C=ND(I);r=typeof r=="function"?r:r===void 0?_V:Ra(+r),t=typeof t=="function"?t:Ra(t===void 0?0:+t),o=typeof o=="function"?o:o===void 0?yV:Ra(+o);function I(k){var G,q,Q,H=(k=jD(k)).length,K,he=!1,ue,me=new Array(H),ge=new Array(H);for(v==null&&(a=w(ue=C())),G=0;G<=H;++G){if(!(G<H&&h(K=k[G],G,k))===he)if(he=!he)q=G,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),Q=G-1;Q>=q;--Q)a.point(me[Q],ge[Q]);a.lineEnd(),a.areaEnd()}he&&(me[G]=+r(K,G,k),ge[G]=+t(K,G,k),a.point(l?+l(K,G,k):me[G],o?+o(K,G,k):ge[G]))}if(ue)return a=null,ue+""||null}function L(){return vV().defined(h).curve(w).context(v)}return I.x=function(k){return arguments.length?(r=typeof k=="function"?k:Ra(+k),l=null,I):r},I.x0=function(k){return arguments.length?(r=typeof k=="function"?k:Ra(+k),I):r},I.x1=function(k){return arguments.length?(l=k==null?null:typeof k=="function"?k:Ra(+k),I):l},I.y=function(k){return arguments.length?(t=typeof k=="function"?k:Ra(+k),o=null,I):t},I.y0=function(k){return arguments.length?(t=typeof k=="function"?k:Ra(+k),I):t},I.y1=function(k){return arguments.length?(o=k==null?null:typeof k=="function"?k:Ra(+k),I):o},I.lineX0=I.lineY0=function(){return L().x(r).y(t)},I.lineY1=function(){return L().x(r).y(o)},I.lineX1=function(){return L().x(l).y(t)},I.defined=function(k){return arguments.length?(h=typeof k=="function"?k:Ra(!!k),I):h},I.curve=function(k){return arguments.length?(w=k,v!=null&&(a=w(v)),I):w},I.context=function(k){return arguments.length?(k==null?v=a=null:a=w(v=k),I):v},I}class xV{constructor(t,o){this._context=t,this._x=o}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,o){switch(t=+t,o=+o,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,o):this._context.moveTo(t,o);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,o,t,o):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+o)/2,t,this._y0,t,o);break}}this._x0=t,this._y0=o}}function mK(r){return new xV(r,!0)}function gK(r){return new xV(r,!1)}const UD={draw(r,t){const o=Rd(t/RA);r.moveTo(o,0),r.arc(0,0,o,0,NT)}},_K={draw(r,t){const o=Rd(t/5)/2;r.moveTo(-3*o,-o),r.lineTo(-o,-o),r.lineTo(-o,-3*o),r.lineTo(o,-3*o),r.lineTo(o,-o),r.lineTo(3*o,-o),r.lineTo(3*o,o),r.lineTo(o,o),r.lineTo(o,3*o),r.lineTo(-o,3*o),r.lineTo(-o,o),r.lineTo(-3*o,o),r.closePath()}},bV=Rd(1/3),yK=bV*2,vK={draw(r,t){const o=Rd(t/yK),l=o*bV;r.moveTo(0,-o),r.lineTo(l,0),r.lineTo(0,o),r.lineTo(-l,0),r.closePath()}},xK={draw(r,t){const o=Rd(t),l=-o/2;r.rect(l,l,o,o)}},bK=.8908130915292852,wV=DA(RA/10)/DA(7*RA/10),wK=DA(NT/10)*wV,AK=-pV(NT/10)*wV,TK={draw(r,t){const o=Rd(t*bK),l=wK*o,h=AK*o;r.moveTo(0,-o),r.lineTo(l,h);for(let v=1;v<5;++v){const w=NT*v/5,a=pV(w),C=DA(w);r.lineTo(C*o,-a*o),r.lineTo(a*l-C*h,C*l+a*h)}r.closePath()}},m3=Rd(3),SK={draw(r,t){const o=-Rd(t/(m3*3));r.moveTo(0,o*2),r.lineTo(-m3*o,-o),r.lineTo(m3*o,-o),r.closePath()}},wh=-.5,Ah=Rd(3)/2,UI=1/Rd(12),EK=(UI/2+1)*3,MK={draw(r,t){const o=Rd(t/EK),l=o/2,h=o*UI,v=l,w=o*UI+o,a=-v,C=w;r.moveTo(l,h),r.lineTo(v,w),r.lineTo(a,C),r.lineTo(wh*l-Ah*h,Ah*l+wh*h),r.lineTo(wh*v-Ah*w,Ah*v+wh*w),r.lineTo(wh*a-Ah*C,Ah*a+wh*C),r.lineTo(wh*l+Ah*h,wh*h-Ah*l),r.lineTo(wh*v+Ah*w,wh*w-Ah*v),r.lineTo(wh*a+Ah*C,wh*C-Ah*a),r.closePath()}};function OK(r,t){let o=null,l=ND(h);r=typeof r=="function"?r:Ra(r||UD),t=typeof t=="function"?t:Ra(t===void 0?64:+t);function h(){let v;if(o||(o=v=l()),r.apply(this,arguments).draw(o,+t.apply(this,arguments)),v)return o=null,v+""||null}return h.type=function(v){return arguments.length?(r=typeof v=="function"?v:Ra(v),h):r},h.size=function(v){return arguments.length?(t=typeof v=="function"?v:Ra(+v),h):t},h.context=function(v){return arguments.length?(o=v??null,h):o},h}function zA(){}function LA(r,t,o){r._context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+t)/6,(r._y0+4*r._y1+o)/6)}function AV(r){this._context=r}AV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:LA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,t){switch(r=+r,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:LA(this,r,t);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=t}};function CK(r){return new AV(r)}function TV(r){this._context=r}TV.prototype={areaStart:zA,areaEnd:zA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(r,t){switch(r=+r,t=+t,this._point){case 0:this._point=1,this._x2=r,this._y2=t;break;case 1:this._point=2,this._x3=r,this._y3=t;break;case 2:this._point=3,this._x4=r,this._y4=t,this._context.moveTo((this._x0+4*this._x1+r)/6,(this._y0+4*this._y1+t)/6);break;default:LA(this,r,t);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=t}};function IK(r){return new TV(r)}function SV(r){this._context=r}SV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(r,t){switch(r=+r,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var o=(this._x0+4*this._x1+r)/6,l=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(o,l):this._context.moveTo(o,l);break;case 3:this._point=4;default:LA(this,r,t);break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=t}};function PK(r){return new SV(r)}function EV(r){this._context=r}EV.prototype={areaStart:zA,areaEnd:zA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(r,t){r=+r,t=+t,this._point?this._context.lineTo(r,t):(this._point=1,this._context.moveTo(r,t))}};function DK(r){return new EV(r)}function rk(r){return r<0?-1:1}function nk(r,t,o){var l=r._x1-r._x0,h=t-r._x1,v=(r._y1-r._y0)/(l||h<0&&-0),w=(o-r._y1)/(h||l<0&&-0),a=(v*h+w*l)/(l+h);return(rk(v)+rk(w))*Math.min(Math.abs(v),Math.abs(w),.5*Math.abs(a))||0}function ik(r,t){var o=r._x1-r._x0;return o?(3*(r._y1-r._y0)/o-t)/2:t}function g3(r,t,o){var l=r._x0,h=r._y0,v=r._x1,w=r._y1,a=(v-l)/3;r._context.bezierCurveTo(l+a,h+a*t,v-a,w-a*o,v,w)}function BA(r){this._context=r}BA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:g3(this,this._t0,ik(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(r,t){var o=NaN;if(r=+r,t=+t,!(r===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break;case 1:this._point=2;break;case 2:this._point=3,g3(this,ik(this,o=nk(this,r,t)),o);break;default:g3(this,this._t0,o=nk(this,r,t));break}this._x0=this._x1,this._x1=r,this._y0=this._y1,this._y1=t,this._t0=o}}};function MV(r){this._context=new OV(r)}(MV.prototype=Object.create(BA.prototype)).point=function(r,t){BA.prototype.point.call(this,t,r)};function OV(r){this._context=r}OV.prototype={moveTo:function(r,t){this._context.moveTo(t,r)},closePath:function(){this._context.closePath()},lineTo:function(r,t){this._context.lineTo(t,r)},bezierCurveTo:function(r,t,o,l,h,v){this._context.bezierCurveTo(t,r,l,o,v,h)}};function RK(r){return new BA(r)}function zK(r){return new MV(r)}function CV(r){this._context=r}CV.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var r=this._x,t=this._y,o=r.length;if(o)if(this._line?this._context.lineTo(r[0],t[0]):this._context.moveTo(r[0],t[0]),o===2)this._context.lineTo(r[1],t[1]);else for(var l=ak(r),h=ak(t),v=0,w=1;w<o;++v,++w)this._context.bezierCurveTo(l[0][v],h[0][v],l[1][v],h[1][v],r[w],t[w]);(this._line||this._line!==0&&o===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(r,t){this._x.push(+r),this._y.push(+t)}};function ak(r){var t,o=r.length-1,l,h=new Array(o),v=new Array(o),w=new Array(o);for(h[0]=0,v[0]=2,w[0]=r[0]+2*r[1],t=1;t<o-1;++t)h[t]=1,v[t]=4,w[t]=4*r[t]+2*r[t+1];for(h[o-1]=2,v[o-1]=7,w[o-1]=8*r[o-1]+r[o],t=1;t<o;++t)l=h[t]/v[t-1],v[t]-=l,w[t]-=l*w[t-1];for(h[o-1]=w[o-1]/v[o-1],t=o-2;t>=0;--t)h[t]=(w[t]-h[t+1])/v[t];for(v[o-1]=(r[o]+h[o-1])/2,t=0;t<o-1;++t)v[t]=2*r[t+1]-h[t+1];return[h,v]}function LK(r){return new CV(r)}function UT(r,t){this._context=r,this._t=t}UT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(r,t){switch(r=+r,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(r,t):this._context.moveTo(r,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(r,t);else{var o=this._x*(1-this._t)+r*this._t;this._context.lineTo(o,this._y),this._context.lineTo(o,t)}break}}this._x=r,this._y=t}};function BK(r){return new UT(r,.5)}function kK(r){return new UT(r,0)}function FK(r){return new UT(r,1)}function G0(r,t){if((w=r.length)>1)for(var o=1,l,h,v=r[t[0]],w,a=v.length;o<w;++o)for(h=v,v=r[t[o]],l=0;l<a;++l)v[l][1]+=v[l][0]=isNaN(h[l][1])?h[l][0]:h[l][1]}function VI(r){for(var t=r.length,o=new Array(t);--t>=0;)o[t]=t;return o}function NK(r,t){return r[t]}function jK(r){const t=[];return t.key=r,t}function UK(){var r=Ra([]),t=VI,o=G0,l=NK;function h(v){var w=Array.from(r.apply(this,arguments),jK),a,C=w.length,I=-1,L;for(const k of v)for(a=0,++I;a<C;++a)(w[a][I]=[0,+l(k,w[a].key,I,v)]).data=k;for(a=0,L=jD(t(w));a<C;++a)w[L[a]].index=a;return o(w,L),w}return h.keys=function(v){return arguments.length?(r=typeof v=="function"?v:Ra(Array.from(v)),h):r},h.value=function(v){return arguments.length?(l=typeof v=="function"?v:Ra(+v),h):l},h.order=function(v){return arguments.length?(t=v==null?VI:typeof v=="function"?v:Ra(Array.from(v)),h):t},h.offset=function(v){return arguments.length?(o=v??G0,h):o},h}function VK(r,t){if((l=r.length)>0){for(var o,l,h=0,v=r[0].length,w;h<v;++h){for(w=o=0;o<l;++o)w+=r[o][h][1]||0;if(w)for(o=0;o<l;++o)r[o][h][1]/=w}G0(r,t)}}function GK(r,t){if((h=r.length)>0){for(var o=0,l=r[t[0]],h,v=l.length;o<v;++o){for(var w=0,a=0;w<h;++w)a+=r[w][o][1]||0;l[o][1]+=l[o][0]=-a/2}G0(r,t)}}function $K(r,t){if(!(!((w=r.length)>0)||!((v=(h=r[t[0]]).length)>0))){for(var o=0,l=1,h,v,w;l<v;++l){for(var a=0,C=0,I=0;a<w;++a){for(var L=r[t[a]],k=L[l][1]||0,G=L[l-1][1]||0,q=(k-G)/2,Q=0;Q<a;++Q){var H=r[t[Q]],K=H[l][1]||0,he=H[l-1][1]||0;q+=K-he}C+=k,I+=q*k}h[l-1][1]+=h[l-1][0]=o,C&&(o-=I/C)}h[l-1][1]+=h[l-1][0]=o,G0(r,t)}}function Mb(r){"@babel/helpers - typeof";return Mb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(r)}var qK=["type","size","sizeType"];function GI(){return GI=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},GI.apply(this,arguments)}function ok(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function sk(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?ok(Object(o),!0).forEach(function(l){HK(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):ok(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function HK(r,t,o){return t=XK(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function XK(r){var t=ZK(r,"string");return Mb(t)=="symbol"?t:t+""}function ZK(r,t){if(Mb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Mb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function WK(r,t){if(r==null)return{};var o=YK(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function YK(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}var IV={symbolCircle:UD,symbolCross:_K,symbolDiamond:vK,symbolSquare:xK,symbolStar:TK,symbolTriangle:SK,symbolWye:MK},KK=Math.PI/180,QK=function(t){var o="symbol".concat(FT(t));return IV[o]||UD},JK=function(t,o,l){if(o==="area")return t;switch(l){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var h=18*KK;return 1.25*t*t*(Math.tan(h)-Math.tan(h*2)*Math.pow(Math.tan(h),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},eQ=function(t,o){IV["symbol".concat(FT(t))]=o},VD=function(t){var o=t.type,l=o===void 0?"circle":o,h=t.size,v=h===void 0?64:h,w=t.sizeType,a=w===void 0?"area":w,C=WK(t,qK),I=sk(sk({},C),{},{type:l,size:v,sizeType:a}),L=function(){var K=QK(l),he=OK().type(K).size(JK(v,a,l));return he()},k=I.className,G=I.cx,q=I.cy,Q=xn(I,!0);return G===+G&&q===+q&&v===+v?ft.createElement("path",GI({},Q,{className:li("recharts-symbols",k),transform:"translate(".concat(G,", ").concat(q,")"),d:L()})):null};VD.registerSymbol=eQ;function $0(r){"@babel/helpers - typeof";return $0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$0(r)}function $I(){return $I=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},$I.apply(this,arguments)}function lk(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function tQ(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?lk(Object(o),!0).forEach(function(l){Ob(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):lk(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function rQ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function nQ(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,DV(l.key),l)}}function iQ(r,t,o){return t&&nQ(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function aQ(r,t,o){return t=kA(t),oQ(r,PV()?Reflect.construct(t,o||[],kA(r).constructor):t.apply(r,o))}function oQ(r,t){if(t&&($0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sQ(r)}function sQ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function PV(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PV=function(){return!!r})()}function kA(r){return kA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},kA(r)}function lQ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&qI(r,t)}function qI(r,t){return qI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},qI(r,t)}function Ob(r,t,o){return t=DV(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function DV(r){var t=cQ(r,"string");return $0(t)=="symbol"?t:t+""}function cQ(r,t){if($0(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if($0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Th=32,GD=(function(r){function t(){return rQ(this,t),aQ(this,t,arguments)}return lQ(t,r),iQ(t,[{key:"renderIcon",value:function(l){var h=this.props.inactiveColor,v=Th/2,w=Th/6,a=Th/3,C=l.inactive?h:l.color;if(l.type==="plainline")return ft.createElement("line",{strokeWidth:4,fill:"none",stroke:C,strokeDasharray:l.payload.strokeDasharray,x1:0,y1:v,x2:Th,y2:v,className:"recharts-legend-icon"});if(l.type==="line")return ft.createElement("path",{strokeWidth:4,fill:"none",stroke:C,d:"M0,".concat(v,"h").concat(a,`
            A`).concat(w,",").concat(w,",0,1,1,").concat(2*a,",").concat(v,`
            H`).concat(Th,"M").concat(2*a,",").concat(v,`
            A`).concat(w,",").concat(w,",0,1,1,").concat(a,",").concat(v),className:"recharts-legend-icon"});if(l.type==="rect")return ft.createElement("path",{stroke:"none",fill:C,d:"M0,".concat(Th/8,"h").concat(Th,"v").concat(Th*3/4,"h").concat(-Th,"z"),className:"recharts-legend-icon"});if(ft.isValidElement(l.legendIcon)){var I=tQ({},l);return delete I.legendIcon,ft.cloneElement(l.legendIcon,I)}return ft.createElement(VD,{fill:C,cx:v,cy:v,size:Th,sizeType:"diameter",type:l.type})}},{key:"renderItems",value:function(){var l=this,h=this.props,v=h.payload,w=h.iconSize,a=h.layout,C=h.formatter,I=h.inactiveColor,L={x:0,y:0,width:Th,height:Th},k={display:a==="horizontal"?"inline-block":"block",marginRight:10},G={display:"inline-block",verticalAlign:"middle",marginRight:4};return v.map(function(q,Q){var H=q.formatter||C,K=li(Ob(Ob({"recharts-legend-item":!0},"legend-item-".concat(Q),!0),"inactive",q.inactive));if(q.type==="none")return null;var he=Bn(q.value)?null:q.value;Dd(!Bn(q.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var ue=q.inactive?I:q.color;return ft.createElement("li",$I({className:K,style:k,key:"legend-item-".concat(Q)},Wy(l.props,q,Q)),ft.createElement(kI,{width:w,height:w,viewBox:L,style:G},l.renderIcon(q)),ft.createElement("span",{className:"recharts-legend-item-text",style:{color:ue}},H?H(he,q,Q):he))})}},{key:"render",value:function(){var l=this.props,h=l.payload,v=l.layout,w=l.align;if(!h||!h.length)return null;var a={padding:0,margin:0,textAlign:v==="horizontal"?w:"left"};return ft.createElement("ul",{className:"recharts-default-legend",style:a},this.renderItems())}}])})(Jt.PureComponent);Ob(GD,"displayName","Legend");Ob(GD,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var _3,ck;function uQ(){if(ck)return _3;ck=1;var r=LT();function t(){this.__data__=new r,this.size=0}return _3=t,_3}var y3,uk;function hQ(){if(uk)return y3;uk=1;function r(t){var o=this.__data__,l=o.delete(t);return this.size=o.size,l}return y3=r,y3}var v3,hk;function dQ(){if(hk)return v3;hk=1;function r(t){return this.__data__.get(t)}return v3=r,v3}var x3,dk;function fQ(){if(dk)return x3;dk=1;function r(t){return this.__data__.has(t)}return x3=r,x3}var b3,fk;function pQ(){if(fk)return b3;fk=1;var r=LT(),t=RD(),o=zD(),l=200;function h(v,w){var a=this.__data__;if(a instanceof r){var C=a.__data__;if(!t||C.length<l-1)return C.push([v,w]),this.size=++a.size,this;a=this.__data__=new o(C)}return a.set(v,w),this.size=a.size,this}return b3=h,b3}var w3,pk;function RV(){if(pk)return w3;pk=1;var r=LT(),t=uQ(),o=hQ(),l=dQ(),h=fQ(),v=pQ();function w(a){var C=this.__data__=new r(a);this.size=C.size}return w.prototype.clear=t,w.prototype.delete=o,w.prototype.get=l,w.prototype.has=h,w.prototype.set=v,w3=w,w3}var A3,mk;function mQ(){if(mk)return A3;mk=1;var r="__lodash_hash_undefined__";function t(o){return this.__data__.set(o,r),this}return A3=t,A3}var T3,gk;function gQ(){if(gk)return T3;gk=1;function r(t){return this.__data__.has(t)}return T3=r,T3}var S3,_k;function zV(){if(_k)return S3;_k=1;var r=zD(),t=mQ(),o=gQ();function l(h){var v=-1,w=h==null?0:h.length;for(this.__data__=new r;++v<w;)this.add(h[v])}return l.prototype.add=l.prototype.push=t,l.prototype.has=o,S3=l,S3}var E3,yk;function LV(){if(yk)return E3;yk=1;function r(t,o){for(var l=-1,h=t==null?0:t.length;++l<h;)if(o(t[l],l,t))return!0;return!1}return E3=r,E3}var M3,vk;function BV(){if(vk)return M3;vk=1;function r(t,o){return t.has(o)}return M3=r,M3}var O3,xk;function kV(){if(xk)return O3;xk=1;var r=zV(),t=LV(),o=BV(),l=1,h=2;function v(w,a,C,I,L,k){var G=C&l,q=w.length,Q=a.length;if(q!=Q&&!(G&&Q>q))return!1;var H=k.get(w),K=k.get(a);if(H&&K)return H==a&&K==w;var he=-1,ue=!0,me=C&h?new r:void 0;for(k.set(w,a),k.set(a,w);++he<q;){var ge=w[he],se=a[he];if(I)var fe=G?I(se,ge,he,a,w,k):I(ge,se,he,w,a,k);if(fe!==void 0){if(fe)continue;ue=!1;break}if(me){if(!t(a,function(ve,Le){if(!o(me,Le)&&(ge===ve||L(ge,ve,C,I,k)))return me.push(Le)})){ue=!1;break}}else if(!(ge===se||L(ge,se,C,I,k))){ue=!1;break}}return k.delete(w),k.delete(a),ue}return O3=v,O3}var C3,bk;function _Q(){if(bk)return C3;bk=1;var r=Wf(),t=r.Uint8Array;return C3=t,C3}var I3,wk;function yQ(){if(wk)return I3;wk=1;function r(t){var o=-1,l=Array(t.size);return t.forEach(function(h,v){l[++o]=[v,h]}),l}return I3=r,I3}var P3,Ak;function $D(){if(Ak)return P3;Ak=1;function r(t){var o=-1,l=Array(t.size);return t.forEach(function(h){l[++o]=h}),l}return P3=r,P3}var D3,Tk;function vQ(){if(Tk)return D3;Tk=1;var r=cw(),t=_Q(),o=DD(),l=kV(),h=yQ(),v=$D(),w=1,a=2,C="[object Boolean]",I="[object Date]",L="[object Error]",k="[object Map]",G="[object Number]",q="[object RegExp]",Q="[object Set]",H="[object String]",K="[object Symbol]",he="[object ArrayBuffer]",ue="[object DataView]",me=r?r.prototype:void 0,ge=me?me.valueOf:void 0;function se(fe,ve,Le,Ue,tt,Ke,nt){switch(Le){case ue:if(fe.byteLength!=ve.byteLength||fe.byteOffset!=ve.byteOffset)return!1;fe=fe.buffer,ve=ve.buffer;case he:return!(fe.byteLength!=ve.byteLength||!Ke(new t(fe),new t(ve)));case C:case I:case G:return o(+fe,+ve);case L:return fe.name==ve.name&&fe.message==ve.message;case q:case H:return fe==ve+"";case k:var st=h;case Q:var Rt=Ue&w;if(st||(st=v),fe.size!=ve.size&&!Rt)return!1;var Mt=nt.get(fe);if(Mt)return Mt==ve;Ue|=a,nt.set(fe,ve);var $e=l(st(fe),st(ve),Ue,tt,Ke,nt);return nt.delete(fe),$e;case K:if(ge)return ge.call(fe)==ge.call(ve)}return!1}return D3=se,D3}var R3,Sk;function FV(){if(Sk)return R3;Sk=1;function r(t,o){for(var l=-1,h=o.length,v=t.length;++l<h;)t[v+l]=o[l];return t}return R3=r,R3}var z3,Ek;function xQ(){if(Ek)return z3;Ek=1;var r=FV(),t=Zc();function o(l,h,v){var w=h(l);return t(l)?w:r(w,v(l))}return z3=o,z3}var L3,Mk;function bQ(){if(Mk)return L3;Mk=1;function r(t,o){for(var l=-1,h=t==null?0:t.length,v=0,w=[];++l<h;){var a=t[l];o(a,l,t)&&(w[v++]=a)}return w}return L3=r,L3}var B3,Ok;function wQ(){if(Ok)return B3;Ok=1;function r(){return[]}return B3=r,B3}var k3,Ck;function AQ(){if(Ck)return k3;Ck=1;var r=bQ(),t=wQ(),o=Object.prototype,l=o.propertyIsEnumerable,h=Object.getOwnPropertySymbols,v=h?function(w){return w==null?[]:(w=Object(w),r(h(w),function(a){return l.call(w,a)}))}:t;return k3=v,k3}var F3,Ik;function TQ(){if(Ik)return F3;Ik=1;function r(t,o){for(var l=-1,h=Array(t);++l<t;)h[l]=o(l);return h}return F3=r,F3}var N3,Pk;function SQ(){if(Pk)return N3;Pk=1;var r=vm(),t=xm(),o="[object Arguments]";function l(h){return t(h)&&r(h)==o}return N3=l,N3}var j3,Dk;function qD(){if(Dk)return j3;Dk=1;var r=SQ(),t=xm(),o=Object.prototype,l=o.hasOwnProperty,h=o.propertyIsEnumerable,v=r((function(){return arguments})())?r:function(w){return t(w)&&l.call(w,"callee")&&!h.call(w,"callee")};return j3=v,j3}var W1={exports:{}},U3,Rk;function EQ(){if(Rk)return U3;Rk=1;function r(){return!1}return U3=r,U3}W1.exports;var zk;function NV(){return zk||(zk=1,(function(r,t){var o=Wf(),l=EQ(),h=t&&!t.nodeType&&t,v=h&&!0&&r&&!r.nodeType&&r,w=v&&v.exports===h,a=w?o.Buffer:void 0,C=a?a.isBuffer:void 0,I=C||l;r.exports=I})(W1,W1.exports)),W1.exports}var V3,Lk;function HD(){if(Lk)return V3;Lk=1;var r=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function o(l,h){var v=typeof l;return h=h??r,!!h&&(v=="number"||v!="symbol"&&t.test(l))&&l>-1&&l%1==0&&l<h}return V3=o,V3}var G3,Bk;function XD(){if(Bk)return G3;Bk=1;var r=9007199254740991;function t(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=r}return G3=t,G3}var $3,kk;function MQ(){if(kk)return $3;kk=1;var r=vm(),t=XD(),o=xm(),l="[object Arguments]",h="[object Array]",v="[object Boolean]",w="[object Date]",a="[object Error]",C="[object Function]",I="[object Map]",L="[object Number]",k="[object Object]",G="[object RegExp]",q="[object Set]",Q="[object String]",H="[object WeakMap]",K="[object ArrayBuffer]",he="[object DataView]",ue="[object Float32Array]",me="[object Float64Array]",ge="[object Int8Array]",se="[object Int16Array]",fe="[object Int32Array]",ve="[object Uint8Array]",Le="[object Uint8ClampedArray]",Ue="[object Uint16Array]",tt="[object Uint32Array]",Ke={};Ke[ue]=Ke[me]=Ke[ge]=Ke[se]=Ke[fe]=Ke[ve]=Ke[Le]=Ke[Ue]=Ke[tt]=!0,Ke[l]=Ke[h]=Ke[K]=Ke[v]=Ke[he]=Ke[w]=Ke[a]=Ke[C]=Ke[I]=Ke[L]=Ke[k]=Ke[G]=Ke[q]=Ke[Q]=Ke[H]=!1;function nt(st){return o(st)&&t(st.length)&&!!Ke[r(st)]}return $3=nt,$3}var q3,Fk;function jV(){if(Fk)return q3;Fk=1;function r(t){return function(o){return t(o)}}return q3=r,q3}var Y1={exports:{}};Y1.exports;var Nk;function OQ(){return Nk||(Nk=1,(function(r,t){var o=oV(),l=t&&!t.nodeType&&t,h=l&&!0&&r&&!r.nodeType&&r,v=h&&h.exports===l,w=v&&o.process,a=(function(){try{var C=h&&h.require&&h.require("util").types;return C||w&&w.binding&&w.binding("util")}catch{}})();r.exports=a})(Y1,Y1.exports)),Y1.exports}var H3,jk;function UV(){if(jk)return H3;jk=1;var r=MQ(),t=jV(),o=OQ(),l=o&&o.isTypedArray,h=l?t(l):r;return H3=h,H3}var X3,Uk;function CQ(){if(Uk)return X3;Uk=1;var r=TQ(),t=qD(),o=Zc(),l=NV(),h=HD(),v=UV(),w=Object.prototype,a=w.hasOwnProperty;function C(I,L){var k=o(I),G=!k&&t(I),q=!k&&!G&&l(I),Q=!k&&!G&&!q&&v(I),H=k||G||q||Q,K=H?r(I.length,String):[],he=K.length;for(var ue in I)(L||a.call(I,ue))&&!(H&&(ue=="length"||q&&(ue=="offset"||ue=="parent")||Q&&(ue=="buffer"||ue=="byteLength"||ue=="byteOffset")||h(ue,he)))&&K.push(ue);return K}return X3=C,X3}var Z3,Vk;function IQ(){if(Vk)return Z3;Vk=1;var r=Object.prototype;function t(o){var l=o&&o.constructor,h=typeof l=="function"&&l.prototype||r;return o===h}return Z3=t,Z3}var W3,Gk;function VV(){if(Gk)return W3;Gk=1;function r(t,o){return function(l){return t(o(l))}}return W3=r,W3}var Y3,$k;function PQ(){if($k)return Y3;$k=1;var r=VV(),t=r(Object.keys,Object);return Y3=t,Y3}var K3,qk;function DQ(){if(qk)return K3;qk=1;var r=IQ(),t=PQ(),o=Object.prototype,l=o.hasOwnProperty;function h(v){if(!r(v))return t(v);var w=[];for(var a in Object(v))l.call(v,a)&&a!="constructor"&&w.push(a);return w}return K3=h,K3}var Q3,Hk;function uw(){if(Hk)return Q3;Hk=1;var r=PD(),t=XD();function o(l){return l!=null&&t(l.length)&&!r(l)}return Q3=o,Q3}var J3,Xk;function VT(){if(Xk)return J3;Xk=1;var r=CQ(),t=DQ(),o=uw();function l(h){return o(h)?r(h):t(h)}return J3=l,J3}var eO,Zk;function RQ(){if(Zk)return eO;Zk=1;var r=xQ(),t=AQ(),o=VT();function l(h){return r(h,o,t)}return eO=l,eO}var tO,Wk;function zQ(){if(Wk)return tO;Wk=1;var r=RQ(),t=1,o=Object.prototype,l=o.hasOwnProperty;function h(v,w,a,C,I,L){var k=a&t,G=r(v),q=G.length,Q=r(w),H=Q.length;if(q!=H&&!k)return!1;for(var K=q;K--;){var he=G[K];if(!(k?he in w:l.call(w,he)))return!1}var ue=L.get(v),me=L.get(w);if(ue&&me)return ue==w&&me==v;var ge=!0;L.set(v,w),L.set(w,v);for(var se=k;++K<q;){he=G[K];var fe=v[he],ve=w[he];if(C)var Le=k?C(ve,fe,he,w,v,L):C(fe,ve,he,v,w,L);if(!(Le===void 0?fe===ve||I(fe,ve,a,C,L):Le)){ge=!1;break}se||(se=he=="constructor")}if(ge&&!se){var Ue=v.constructor,tt=w.constructor;Ue!=tt&&"constructor"in v&&"constructor"in w&&!(typeof Ue=="function"&&Ue instanceof Ue&&typeof tt=="function"&&tt instanceof tt)&&(ge=!1)}return L.delete(v),L.delete(w),ge}return tO=h,tO}var rO,Yk;function LQ(){if(Yk)return rO;Yk=1;var r=tv(),t=Wf(),o=r(t,"DataView");return rO=o,rO}var nO,Kk;function BQ(){if(Kk)return nO;Kk=1;var r=tv(),t=Wf(),o=r(t,"Promise");return nO=o,nO}var iO,Qk;function GV(){if(Qk)return iO;Qk=1;var r=tv(),t=Wf(),o=r(t,"Set");return iO=o,iO}var aO,Jk;function kQ(){if(Jk)return aO;Jk=1;var r=tv(),t=Wf(),o=r(t,"WeakMap");return aO=o,aO}var oO,eF;function FQ(){if(eF)return oO;eF=1;var r=LQ(),t=RD(),o=BQ(),l=GV(),h=kQ(),v=vm(),w=sV(),a="[object Map]",C="[object Object]",I="[object Promise]",L="[object Set]",k="[object WeakMap]",G="[object DataView]",q=w(r),Q=w(t),H=w(o),K=w(l),he=w(h),ue=v;return(r&&ue(new r(new ArrayBuffer(1)))!=G||t&&ue(new t)!=a||o&&ue(o.resolve())!=I||l&&ue(new l)!=L||h&&ue(new h)!=k)&&(ue=function(me){var ge=v(me),se=ge==C?me.constructor:void 0,fe=se?w(se):"";if(fe)switch(fe){case q:return G;case Q:return a;case H:return I;case K:return L;case he:return k}return ge}),oO=ue,oO}var sO,tF;function NQ(){if(tF)return sO;tF=1;var r=RV(),t=kV(),o=vQ(),l=zQ(),h=FQ(),v=Zc(),w=NV(),a=UV(),C=1,I="[object Arguments]",L="[object Array]",k="[object Object]",G=Object.prototype,q=G.hasOwnProperty;function Q(H,K,he,ue,me,ge){var se=v(H),fe=v(K),ve=se?L:h(H),Le=fe?L:h(K);ve=ve==I?k:ve,Le=Le==I?k:Le;var Ue=ve==k,tt=Le==k,Ke=ve==Le;if(Ke&&w(H)){if(!w(K))return!1;se=!0,Ue=!1}if(Ke&&!Ue)return ge||(ge=new r),se||a(H)?t(H,K,he,ue,me,ge):o(H,K,ve,he,ue,me,ge);if(!(he&C)){var nt=Ue&&q.call(H,"__wrapped__"),st=tt&&q.call(K,"__wrapped__");if(nt||st){var Rt=nt?H.value():H,Mt=st?K.value():K;return ge||(ge=new r),me(Rt,Mt,he,ue,ge)}}return Ke?(ge||(ge=new r),l(H,K,he,ue,me,ge)):!1}return sO=Q,sO}var lO,rF;function ZD(){if(rF)return lO;rF=1;var r=NQ(),t=xm();function o(l,h,v,w,a){return l===h?!0:l==null||h==null||!t(l)&&!t(h)?l!==l&&h!==h:r(l,h,v,w,o,a)}return lO=o,lO}var cO,nF;function jQ(){if(nF)return cO;nF=1;var r=RV(),t=ZD(),o=1,l=2;function h(v,w,a,C){var I=a.length,L=I,k=!C;if(v==null)return!L;for(v=Object(v);I--;){var G=a[I];if(k&&G[2]?G[1]!==v[G[0]]:!(G[0]in v))return!1}for(;++I<L;){G=a[I];var q=G[0],Q=v[q],H=G[1];if(k&&G[2]){if(Q===void 0&&!(q in v))return!1}else{var K=new r;if(C)var he=C(Q,H,q,v,w,K);if(!(he===void 0?t(H,Q,o|l,C,K):he))return!1}}return!0}return cO=h,cO}var uO,iF;function $V(){if(iF)return uO;iF=1;var r=Kg();function t(o){return o===o&&!r(o)}return uO=t,uO}var hO,aF;function UQ(){if(aF)return hO;aF=1;var r=$V(),t=VT();function o(l){for(var h=t(l),v=h.length;v--;){var w=h[v],a=l[w];h[v]=[w,a,r(a)]}return h}return hO=o,hO}var dO,oF;function qV(){if(oF)return dO;oF=1;function r(t,o){return function(l){return l==null?!1:l[t]===o&&(o!==void 0||t in Object(l))}}return dO=r,dO}var fO,sF;function VQ(){if(sF)return fO;sF=1;var r=jQ(),t=UQ(),o=qV();function l(h){var v=t(h);return v.length==1&&v[0][2]?o(v[0][0],v[0][1]):function(w){return w===h||r(w,h,v)}}return fO=l,fO}var pO,lF;function GQ(){if(lF)return pO;lF=1;function r(t,o){return t!=null&&o in Object(t)}return pO=r,pO}var mO,cF;function $Q(){if(cF)return mO;cF=1;var r=uV(),t=qD(),o=Zc(),l=HD(),h=XD(),v=kT();function w(a,C,I){C=r(C,a);for(var L=-1,k=C.length,G=!1;++L<k;){var q=v(C[L]);if(!(G=a!=null&&I(a,q)))break;a=a[q]}return G||++L!=k?G:(k=a==null?0:a.length,!!k&&h(k)&&l(q,k)&&(o(a)||t(a)))}return mO=w,mO}var gO,uF;function qQ(){if(uF)return gO;uF=1;var r=GQ(),t=$Q();function o(l,h){return l!=null&&t(l,h,r)}return gO=o,gO}var _O,hF;function HQ(){if(hF)return _O;hF=1;var r=ZD(),t=hV(),o=qQ(),l=ID(),h=$V(),v=qV(),w=kT(),a=1,C=2;function I(L,k){return l(L)&&h(k)?v(w(L),k):function(G){var q=t(G,L);return q===void 0&&q===k?o(G,L):r(k,q,a|C)}}return _O=I,_O}var yO,dF;function vx(){if(dF)return yO;dF=1;function r(t){return t}return yO=r,yO}var vO,fF;function XQ(){if(fF)return vO;fF=1;function r(t){return function(o){return o?.[t]}}return vO=r,vO}var xO,pF;function ZQ(){if(pF)return xO;pF=1;var r=BD();function t(o){return function(l){return r(l,o)}}return xO=t,xO}var bO,mF;function WQ(){if(mF)return bO;mF=1;var r=XQ(),t=ZQ(),o=ID(),l=kT();function h(v){return o(v)?r(l(v)):t(v)}return bO=h,bO}var wO,gF;function Yf(){if(gF)return wO;gF=1;var r=VQ(),t=HQ(),o=vx(),l=Zc(),h=WQ();function v(w){return typeof w=="function"?w:w==null?o:typeof w=="object"?l(w)?t(w[0],w[1]):r(w):h(w)}return wO=v,wO}var AO,_F;function HV(){if(_F)return AO;_F=1;function r(t,o,l,h){for(var v=t.length,w=l+(h?1:-1);h?w--:++w<v;)if(o(t[w],w,t))return w;return-1}return AO=r,AO}var TO,yF;function YQ(){if(yF)return TO;yF=1;function r(t){return t!==t}return TO=r,TO}var SO,vF;function KQ(){if(vF)return SO;vF=1;function r(t,o,l){for(var h=l-1,v=t.length;++h<v;)if(t[h]===o)return h;return-1}return SO=r,SO}var EO,xF;function QQ(){if(xF)return EO;xF=1;var r=HV(),t=YQ(),o=KQ();function l(h,v,w){return v===v?o(h,v,w):r(h,t,w)}return EO=l,EO}var MO,bF;function JQ(){if(bF)return MO;bF=1;var r=QQ();function t(o,l){var h=o==null?0:o.length;return!!h&&r(o,l,0)>-1}return MO=t,MO}var OO,wF;function eJ(){if(wF)return OO;wF=1;function r(t,o,l){for(var h=-1,v=t==null?0:t.length;++h<v;)if(l(o,t[h]))return!0;return!1}return OO=r,OO}var CO,AF;function tJ(){if(AF)return CO;AF=1;function r(){}return CO=r,CO}var IO,TF;function rJ(){if(TF)return IO;TF=1;var r=GV(),t=tJ(),o=$D(),l=1/0,h=r&&1/o(new r([,-0]))[1]==l?function(v){return new r(v)}:t;return IO=h,IO}var PO,SF;function nJ(){if(SF)return PO;SF=1;var r=zV(),t=JQ(),o=eJ(),l=BV(),h=rJ(),v=$D(),w=200;function a(C,I,L){var k=-1,G=t,q=C.length,Q=!0,H=[],K=H;if(L)Q=!1,G=o;else if(q>=w){var he=I?null:h(C);if(he)return v(he);Q=!1,G=l,K=new r}else K=I?[]:H;e:for(;++k<q;){var ue=C[k],me=I?I(ue):ue;if(ue=L||ue!==0?ue:0,Q&&me===me){for(var ge=K.length;ge--;)if(K[ge]===me)continue e;I&&K.push(me),H.push(ue)}else G(K,me,L)||(K!==H&&K.push(me),H.push(ue))}return H}return PO=a,PO}var DO,EF;function iJ(){if(EF)return DO;EF=1;var r=Yf(),t=nJ();function o(l,h){return l&&l.length?t(l,r(h,2)):[]}return DO=o,DO}var aJ=iJ();const MF=ca(aJ);function XV(r,t,o){return t===!0?MF(r,o):Bn(t)?MF(r,t):r}function q0(r){"@babel/helpers - typeof";return q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q0(r)}var oJ=["ref"];function OF(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Jp(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?OF(Object(o),!0).forEach(function(l){GT(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):OF(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function sJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function CF(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,WV(l.key),l)}}function lJ(r,t,o){return t&&CF(r.prototype,t),o&&CF(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function cJ(r,t,o){return t=FA(t),uJ(r,ZV()?Reflect.construct(t,o||[],FA(r).constructor):t.apply(r,o))}function uJ(r,t){if(t&&(q0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hJ(r)}function hJ(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ZV(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZV=function(){return!!r})()}function FA(r){return FA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},FA(r)}function dJ(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&HI(r,t)}function HI(r,t){return HI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},HI(r,t)}function GT(r,t,o){return t=WV(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function WV(r){var t=fJ(r,"string");return q0(t)=="symbol"?t:t+""}function fJ(r,t){if(q0(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(q0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function pJ(r,t){if(r==null)return{};var o=mJ(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function mJ(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function gJ(r){return r.value}function _J(r,t){if(ft.isValidElement(r))return ft.cloneElement(r,t);if(typeof r=="function")return ft.createElement(r,t);t.ref;var o=pJ(t,oJ);return ft.createElement(GD,o)}var IF=1,D0=(function(r){function t(){var o;sJ(this,t);for(var l=arguments.length,h=new Array(l),v=0;v<l;v++)h[v]=arguments[v];return o=cJ(this,t,[].concat(h)),GT(o,"lastBoundingBox",{width:-1,height:-1}),o}return dJ(t,r),lJ(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var l=this.wrapperNode.getBoundingClientRect();return l.height=this.wrapperNode.offsetHeight,l.width=this.wrapperNode.offsetWidth,l}return null}},{key:"updateBBox",value:function(){var l=this.props.onBBoxUpdate,h=this.getBBox();h?(Math.abs(h.width-this.lastBoundingBox.width)>IF||Math.abs(h.height-this.lastBoundingBox.height)>IF)&&(this.lastBoundingBox.width=h.width,this.lastBoundingBox.height=h.height,l&&l(h)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,l&&l(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Jp({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(l){var h=this.props,v=h.layout,w=h.align,a=h.verticalAlign,C=h.margin,I=h.chartWidth,L=h.chartHeight,k,G;if(!l||(l.left===void 0||l.left===null)&&(l.right===void 0||l.right===null))if(w==="center"&&v==="vertical"){var q=this.getBBoxSnapshot();k={left:((I||0)-q.width)/2}}else k=w==="right"?{right:C&&C.right||0}:{left:C&&C.left||0};if(!l||(l.top===void 0||l.top===null)&&(l.bottom===void 0||l.bottom===null))if(a==="middle"){var Q=this.getBBoxSnapshot();G={top:((L||0)-Q.height)/2}}else G=a==="bottom"?{bottom:C&&C.bottom||0}:{top:C&&C.top||0};return Jp(Jp({},k),G)}},{key:"render",value:function(){var l=this,h=this.props,v=h.content,w=h.width,a=h.height,C=h.wrapperStyle,I=h.payloadUniqBy,L=h.payload,k=Jp(Jp({position:"absolute",width:w||"auto",height:a||"auto"},this.getDefaultPosition(C)),C);return ft.createElement("div",{className:"recharts-legend-wrapper",style:k,ref:function(q){l.wrapperNode=q}},_J(v,Jp(Jp({},this.props),{},{payload:XV(L,I,gJ)})))}}],[{key:"getWithHeight",value:function(l,h){var v=Jp(Jp({},this.defaultProps),l.props),w=v.layout;return w==="vertical"&&Ar(l.props.height)?{height:l.props.height}:w==="horizontal"?{width:l.props.width||h}:null}}])})(Jt.PureComponent);GT(D0,"displayName","Legend");GT(D0,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var RO,PF;function yJ(){if(PF)return RO;PF=1;var r=cw(),t=qD(),o=Zc(),l=r?r.isConcatSpreadable:void 0;function h(v){return o(v)||t(v)||!!(l&&v&&v[l])}return RO=h,RO}var zO,DF;function YV(){if(DF)return zO;DF=1;var r=FV(),t=yJ();function o(l,h,v,w,a){var C=-1,I=l.length;for(v||(v=t),a||(a=[]);++C<I;){var L=l[C];h>0&&v(L)?h>1?o(L,h-1,v,w,a):r(a,L):w||(a[a.length]=L)}return a}return zO=o,zO}var LO,RF;function vJ(){if(RF)return LO;RF=1;function r(t){return function(o,l,h){for(var v=-1,w=Object(o),a=h(o),C=a.length;C--;){var I=a[t?C:++v];if(l(w[I],I,w)===!1)break}return o}}return LO=r,LO}var BO,zF;function xJ(){if(zF)return BO;zF=1;var r=vJ(),t=r();return BO=t,BO}var kO,LF;function KV(){if(LF)return kO;LF=1;var r=xJ(),t=VT();function o(l,h){return l&&r(l,h,t)}return kO=o,kO}var FO,BF;function bJ(){if(BF)return FO;BF=1;var r=uw();function t(o,l){return function(h,v){if(h==null)return h;if(!r(h))return o(h,v);for(var w=h.length,a=l?w:-1,C=Object(h);(l?a--:++a<w)&&v(C[a],a,C)!==!1;);return h}}return FO=t,FO}var NO,kF;function WD(){if(kF)return NO;kF=1;var r=KV(),t=bJ(),o=t(r);return NO=o,NO}var jO,FF;function QV(){if(FF)return jO;FF=1;var r=WD(),t=uw();function o(l,h){var v=-1,w=t(l)?Array(l.length):[];return r(l,function(a,C,I){w[++v]=h(a,C,I)}),w}return jO=o,jO}var UO,NF;function wJ(){if(NF)return UO;NF=1;function r(t,o){var l=t.length;for(t.sort(o);l--;)t[l]=t[l].value;return t}return UO=r,UO}var VO,jF;function AJ(){if(jF)return VO;jF=1;var r=mx();function t(o,l){if(o!==l){var h=o!==void 0,v=o===null,w=o===o,a=r(o),C=l!==void 0,I=l===null,L=l===l,k=r(l);if(!I&&!k&&!a&&o>l||a&&C&&L&&!I&&!k||v&&C&&L||!h&&L||!w)return 1;if(!v&&!a&&!k&&o<l||k&&h&&w&&!v&&!a||I&&h&&w||!C&&w||!L)return-1}return 0}return VO=t,VO}var GO,UF;function TJ(){if(UF)return GO;UF=1;var r=AJ();function t(o,l,h){for(var v=-1,w=o.criteria,a=l.criteria,C=w.length,I=h.length;++v<C;){var L=r(w[v],a[v]);if(L){if(v>=I)return L;var k=h[v];return L*(k=="desc"?-1:1)}}return o.index-l.index}return GO=t,GO}var $O,VF;function SJ(){if(VF)return $O;VF=1;var r=LD(),t=BD(),o=Yf(),l=QV(),h=wJ(),v=jV(),w=TJ(),a=vx(),C=Zc();function I(L,k,G){k.length?k=r(k,function(H){return C(H)?function(K){return t(K,H.length===1?H[0]:H)}:H}):k=[a];var q=-1;k=r(k,v(o));var Q=l(L,function(H,K,he){var ue=r(k,function(me){return me(H)});return{criteria:ue,index:++q,value:H}});return h(Q,function(H,K){return w(H,K,G)})}return $O=I,$O}var qO,GF;function EJ(){if(GF)return qO;GF=1;function r(t,o,l){switch(l.length){case 0:return t.call(o);case 1:return t.call(o,l[0]);case 2:return t.call(o,l[0],l[1]);case 3:return t.call(o,l[0],l[1],l[2])}return t.apply(o,l)}return qO=r,qO}var HO,$F;function MJ(){if($F)return HO;$F=1;var r=EJ(),t=Math.max;function o(l,h,v){return h=t(h===void 0?l.length-1:h,0),function(){for(var w=arguments,a=-1,C=t(w.length-h,0),I=Array(C);++a<C;)I[a]=w[h+a];a=-1;for(var L=Array(h+1);++a<h;)L[a]=w[a];return L[h]=v(I),r(l,this,L)}}return HO=o,HO}var XO,qF;function OJ(){if(qF)return XO;qF=1;function r(t){return function(){return t}}return XO=r,XO}var ZO,HF;function JV(){if(HF)return ZO;HF=1;var r=tv(),t=(function(){try{var o=r(Object,"defineProperty");return o({},"",{}),o}catch{}})();return ZO=t,ZO}var WO,XF;function CJ(){if(XF)return WO;XF=1;var r=OJ(),t=JV(),o=vx(),l=t?function(h,v){return t(h,"toString",{configurable:!0,enumerable:!1,value:r(v),writable:!0})}:o;return WO=l,WO}var YO,ZF;function IJ(){if(ZF)return YO;ZF=1;var r=800,t=16,o=Date.now;function l(h){var v=0,w=0;return function(){var a=o(),C=t-(a-w);if(w=a,C>0){if(++v>=r)return arguments[0]}else v=0;return h.apply(void 0,arguments)}}return YO=l,YO}var KO,WF;function PJ(){if(WF)return KO;WF=1;var r=CJ(),t=IJ(),o=t(r);return KO=o,KO}var QO,YF;function DJ(){if(YF)return QO;YF=1;var r=vx(),t=MJ(),o=PJ();function l(h,v){return o(t(h,v,r),h+"")}return QO=l,QO}var JO,KF;function $T(){if(KF)return JO;KF=1;var r=DD(),t=uw(),o=HD(),l=Kg();function h(v,w,a){if(!l(a))return!1;var C=typeof w;return(C=="number"?t(a)&&o(w,a.length):C=="string"&&w in a)?r(a[w],v):!1}return JO=h,JO}var eC,QF;function RJ(){if(QF)return eC;QF=1;var r=YV(),t=SJ(),o=DJ(),l=$T(),h=o(function(v,w){if(v==null)return[];var a=w.length;return a>1&&l(v,w[0],w[1])?w=[]:a>2&&l(w[0],w[1],w[2])&&(w=[w[0]]),t(v,r(w,1),[])});return eC=h,eC}var zJ=RJ();const YD=ca(zJ);function Cb(r){"@babel/helpers - typeof";return Cb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cb(r)}function XI(){return XI=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},XI.apply(this,arguments)}function LJ(r,t){return NJ(r)||FJ(r,t)||kJ(r,t)||BJ()}function BJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kJ(r,t){if(r){if(typeof r=="string")return JF(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return JF(r,t)}}function JF(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function FJ(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function NJ(r){if(Array.isArray(r))return r}function eN(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function tC(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?eN(Object(o),!0).forEach(function(l){jJ(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):eN(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function jJ(r,t,o){return t=UJ(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function UJ(r){var t=VJ(r,"string");return Cb(t)=="symbol"?t:t+""}function VJ(r,t){if(Cb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Cb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function GJ(r){return Array.isArray(r)&&Ms(r[0])&&Ms(r[1])?r.join(" ~ "):r}var $J=function(t){var o=t.separator,l=o===void 0?" : ":o,h=t.contentStyle,v=h===void 0?{}:h,w=t.itemStyle,a=w===void 0?{}:w,C=t.labelStyle,I=C===void 0?{}:C,L=t.payload,k=t.formatter,G=t.itemSorter,q=t.wrapperClassName,Q=t.labelClassName,H=t.label,K=t.labelFormatter,he=t.accessibilityLayer,ue=he===void 0?!1:he,me=function(){if(L&&L.length){var nt={padding:0,margin:0},st=(G?YD(L,G):L).map(function(Rt,Mt){if(Rt.type==="none")return null;var $e=tC({display:"block",paddingTop:4,paddingBottom:4,color:Rt.color||"#000"},a),rt=Rt.formatter||k||GJ,Ct=Rt.value,Kt=Rt.name,Je=Ct,Ze=Kt;if(rt&&Je!=null&&Ze!=null){var gt=rt(Ct,Kt,Rt,Mt,L);if(Array.isArray(gt)){var Bt=LJ(gt,2);Je=Bt[0],Ze=Bt[1]}else Je=gt}return ft.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(Mt),style:$e},Ms(Ze)?ft.createElement("span",{className:"recharts-tooltip-item-name"},Ze):null,Ms(Ze)?ft.createElement("span",{className:"recharts-tooltip-item-separator"},l):null,ft.createElement("span",{className:"recharts-tooltip-item-value"},Je),ft.createElement("span",{className:"recharts-tooltip-item-unit"},Rt.unit||""))});return ft.createElement("ul",{className:"recharts-tooltip-item-list",style:nt},st)}return null},ge=tC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},v),se=tC({margin:0},I),fe=!ei(H),ve=fe?H:"",Le=li("recharts-default-tooltip",q),Ue=li("recharts-tooltip-label",Q);fe&&K&&L!==void 0&&L!==null&&(ve=K(H,L));var tt=ue?{role:"status","aria-live":"assertive"}:{};return ft.createElement("div",XI({className:Le,style:ge},tt),ft.createElement("p",{className:Ue,style:se},ft.isValidElement(ve)?ve:"".concat(ve)),me())};function Ib(r){"@babel/helpers - typeof";return Ib=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ib(r)}function q2(r,t,o){return t=qJ(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function qJ(r){var t=HJ(r,"string");return Ib(t)=="symbol"?t:t+""}function HJ(r,t){if(Ib(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Ib(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var R1="recharts-tooltip-wrapper",XJ={visibility:"hidden"};function ZJ(r){var t=r.coordinate,o=r.translateX,l=r.translateY;return li(R1,q2(q2(q2(q2({},"".concat(R1,"-right"),Ar(o)&&t&&Ar(t.x)&&o>=t.x),"".concat(R1,"-left"),Ar(o)&&t&&Ar(t.x)&&o<t.x),"".concat(R1,"-bottom"),Ar(l)&&t&&Ar(t.y)&&l>=t.y),"".concat(R1,"-top"),Ar(l)&&t&&Ar(t.y)&&l<t.y))}function tN(r){var t=r.allowEscapeViewBox,o=r.coordinate,l=r.key,h=r.offsetTopLeft,v=r.position,w=r.reverseDirection,a=r.tooltipDimension,C=r.viewBox,I=r.viewBoxDimension;if(v&&Ar(v[l]))return v[l];var L=o[l]-a-h,k=o[l]+h;if(t[l])return w[l]?L:k;if(w[l]){var G=L,q=C[l];return G<q?Math.max(k,C[l]):Math.max(L,C[l])}var Q=k+a,H=C[l]+I;return Q>H?Math.max(L,C[l]):Math.max(k,C[l])}function WJ(r){var t=r.translateX,o=r.translateY,l=r.useTranslate3d;return{transform:l?"translate3d(".concat(t,"px, ").concat(o,"px, 0)"):"translate(".concat(t,"px, ").concat(o,"px)")}}function YJ(r){var t=r.allowEscapeViewBox,o=r.coordinate,l=r.offsetTopLeft,h=r.position,v=r.reverseDirection,w=r.tooltipBox,a=r.useTranslate3d,C=r.viewBox,I,L,k;return w.height>0&&w.width>0&&o?(L=tN({allowEscapeViewBox:t,coordinate:o,key:"x",offsetTopLeft:l,position:h,reverseDirection:v,tooltipDimension:w.width,viewBox:C,viewBoxDimension:C.width}),k=tN({allowEscapeViewBox:t,coordinate:o,key:"y",offsetTopLeft:l,position:h,reverseDirection:v,tooltipDimension:w.height,viewBox:C,viewBoxDimension:C.height}),I=WJ({translateX:L,translateY:k,useTranslate3d:a})):I=XJ,{cssProperties:I,cssClasses:ZJ({translateX:L,translateY:k,coordinate:o})}}function H0(r){"@babel/helpers - typeof";return H0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H0(r)}function rN(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function nN(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?rN(Object(o),!0).forEach(function(l){WI(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):rN(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function KJ(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function QJ(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,t9(l.key),l)}}function JJ(r,t,o){return t&&QJ(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function eee(r,t,o){return t=NA(t),tee(r,e9()?Reflect.construct(t,o||[],NA(r).constructor):t.apply(r,o))}function tee(r,t){if(t&&(H0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ree(r)}function ree(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function e9(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(e9=function(){return!!r})()}function NA(r){return NA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},NA(r)}function nee(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&ZI(r,t)}function ZI(r,t){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},ZI(r,t)}function WI(r,t,o){return t=t9(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function t9(r){var t=iee(r,"string");return H0(t)=="symbol"?t:t+""}function iee(r,t){if(H0(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(H0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var iN=1,aee=(function(r){function t(){var o;KJ(this,t);for(var l=arguments.length,h=new Array(l),v=0;v<l;v++)h[v]=arguments[v];return o=eee(this,t,[].concat(h)),WI(o,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),WI(o,"handleKeyDown",function(w){if(w.key==="Escape"){var a,C,I,L;o.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(C=o.props.coordinate)===null||C===void 0?void 0:C.x)!==null&&a!==void 0?a:0,y:(I=(L=o.props.coordinate)===null||L===void 0?void 0:L.y)!==null&&I!==void 0?I:0}})}}),o}return nee(t,r),JJ(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var l=this.wrapperNode.getBoundingClientRect();(Math.abs(l.width-this.state.lastBoundingBox.width)>iN||Math.abs(l.height-this.state.lastBoundingBox.height)>iN)&&this.setState({lastBoundingBox:{width:l.width,height:l.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var l,h;this.props.active&&this.updateBBox(),this.state.dismissed&&(((l=this.props.coordinate)===null||l===void 0?void 0:l.x)!==this.state.dismissedAtCoordinate.x||((h=this.props.coordinate)===null||h===void 0?void 0:h.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var l=this,h=this.props,v=h.active,w=h.allowEscapeViewBox,a=h.animationDuration,C=h.animationEasing,I=h.children,L=h.coordinate,k=h.hasPayload,G=h.isAnimationActive,q=h.offset,Q=h.position,H=h.reverseDirection,K=h.useTranslate3d,he=h.viewBox,ue=h.wrapperStyle,me=YJ({allowEscapeViewBox:w,coordinate:L,offsetTopLeft:q,position:Q,reverseDirection:H,tooltipBox:this.state.lastBoundingBox,useTranslate3d:K,viewBox:he}),ge=me.cssClasses,se=me.cssProperties,fe=nN(nN({transition:G&&v?"transform ".concat(a,"ms ").concat(C):void 0},se),{},{pointerEvents:"none",visibility:!this.state.dismissed&&v&&k?"visible":"hidden",position:"absolute",top:0,left:0},ue);return ft.createElement("div",{tabIndex:-1,className:ge,style:fe,ref:function(Le){l.wrapperNode=Le}},I)}}])})(Jt.PureComponent),oee=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},rv={isSsr:oee()};function X0(r){"@babel/helpers - typeof";return X0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X0(r)}function aN(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function oN(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?aN(Object(o),!0).forEach(function(l){KD(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):aN(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function see(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function lee(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,n9(l.key),l)}}function cee(r,t,o){return t&&lee(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function uee(r,t,o){return t=jA(t),hee(r,r9()?Reflect.construct(t,o||[],jA(r).constructor):t.apply(r,o))}function hee(r,t){if(t&&(X0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dee(r)}function dee(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function r9(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r9=function(){return!!r})()}function jA(r){return jA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},jA(r)}function fee(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&YI(r,t)}function YI(r,t){return YI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},YI(r,t)}function KD(r,t,o){return t=n9(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function n9(r){var t=pee(r,"string");return X0(t)=="symbol"?t:t+""}function pee(r,t){if(X0(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(X0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function mee(r){return r.dataKey}function gee(r,t){return ft.isValidElement(r)?ft.cloneElement(r,t):typeof r=="function"?ft.createElement(r,t):ft.createElement($J,t)}var Du=(function(r){function t(){return see(this,t),uee(this,t,arguments)}return fee(t,r),cee(t,[{key:"render",value:function(){var l=this,h=this.props,v=h.active,w=h.allowEscapeViewBox,a=h.animationDuration,C=h.animationEasing,I=h.content,L=h.coordinate,k=h.filterNull,G=h.isAnimationActive,q=h.offset,Q=h.payload,H=h.payloadUniqBy,K=h.position,he=h.reverseDirection,ue=h.useTranslate3d,me=h.viewBox,ge=h.wrapperStyle,se=Q??[];k&&se.length&&(se=XV(Q.filter(function(ve){return ve.value!=null&&(ve.hide!==!0||l.props.includeHidden)}),H,mee));var fe=se.length>0;return ft.createElement(aee,{allowEscapeViewBox:w,animationDuration:a,animationEasing:C,isAnimationActive:G,active:v,coordinate:L,hasPayload:fe,offset:q,position:K,reverseDirection:he,useTranslate3d:ue,viewBox:me,wrapperStyle:ge},gee(I,oN(oN({},this.props),{},{payload:se})))}}])})(Jt.PureComponent);KD(Du,"displayName","Tooltip");KD(Du,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!rv.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var rC,sN;function _ee(){if(sN)return rC;sN=1;var r=Wf(),t=function(){return r.Date.now()};return rC=t,rC}var nC,lN;function yee(){if(lN)return nC;lN=1;var r=/\s/;function t(o){for(var l=o.length;l--&&r.test(o.charAt(l)););return l}return nC=t,nC}var iC,cN;function vee(){if(cN)return iC;cN=1;var r=yee(),t=/^\s+/;function o(l){return l&&l.slice(0,r(l)+1).replace(t,"")}return iC=o,iC}var aC,uN;function i9(){if(uN)return aC;uN=1;var r=vee(),t=Kg(),o=mx(),l=NaN,h=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,w=/^0o[0-7]+$/i,a=parseInt;function C(I){if(typeof I=="number")return I;if(o(I))return l;if(t(I)){var L=typeof I.valueOf=="function"?I.valueOf():I;I=t(L)?L+"":L}if(typeof I!="string")return I===0?I:+I;I=r(I);var k=v.test(I);return k||w.test(I)?a(I.slice(2),k?2:8):h.test(I)?l:+I}return aC=C,aC}var oC,hN;function xee(){if(hN)return oC;hN=1;var r=Kg(),t=_ee(),o=i9(),l="Expected a function",h=Math.max,v=Math.min;function w(a,C,I){var L,k,G,q,Q,H,K=0,he=!1,ue=!1,me=!0;if(typeof a!="function")throw new TypeError(l);C=o(C)||0,r(I)&&(he=!!I.leading,ue="maxWait"in I,G=ue?h(o(I.maxWait)||0,C):G,me="trailing"in I?!!I.trailing:me);function ge(st){var Rt=L,Mt=k;return L=k=void 0,K=st,q=a.apply(Mt,Rt),q}function se(st){return K=st,Q=setTimeout(Le,C),he?ge(st):q}function fe(st){var Rt=st-H,Mt=st-K,$e=C-Rt;return ue?v($e,G-Mt):$e}function ve(st){var Rt=st-H,Mt=st-K;return H===void 0||Rt>=C||Rt<0||ue&&Mt>=G}function Le(){var st=t();if(ve(st))return Ue(st);Q=setTimeout(Le,fe(st))}function Ue(st){return Q=void 0,me&&L?ge(st):(L=k=void 0,q)}function tt(){Q!==void 0&&clearTimeout(Q),K=0,L=H=k=Q=void 0}function Ke(){return Q===void 0?q:Ue(t())}function nt(){var st=t(),Rt=ve(st);if(L=arguments,k=this,H=st,Rt){if(Q===void 0)return se(H);if(ue)return clearTimeout(Q),Q=setTimeout(Le,C),ge(H)}return Q===void 0&&(Q=setTimeout(Le,C)),q}return nt.cancel=tt,nt.flush=Ke,nt}return oC=w,oC}var sC,dN;function bee(){if(dN)return sC;dN=1;var r=xee(),t=Kg(),o="Expected a function";function l(h,v,w){var a=!0,C=!0;if(typeof h!="function")throw new TypeError(o);return t(w)&&(a="leading"in w?!!w.leading:a,C="trailing"in w?!!w.trailing:C),r(h,v,{leading:a,maxWait:v,trailing:C})}return sC=l,sC}var wee=bee();const a9=ca(wee);function Pb(r){"@babel/helpers - typeof";return Pb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pb(r)}function fN(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function H2(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?fN(Object(o),!0).forEach(function(l){Aee(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):fN(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Aee(r,t,o){return t=Tee(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Tee(r){var t=See(r,"string");return Pb(t)=="symbol"?t:t+""}function See(r,t){if(Pb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Pb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Eee(r,t){return Iee(r)||Cee(r,t)||Oee(r,t)||Mee()}function Mee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oee(r,t){if(r){if(typeof r=="string")return pN(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return pN(r,t)}}function pN(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Cee(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function Iee(r){if(Array.isArray(r))return r}var X2=Jt.forwardRef(function(r,t){var o=r.aspect,l=r.initialDimension,h=l===void 0?{width:-1,height:-1}:l,v=r.width,w=v===void 0?"100%":v,a=r.height,C=a===void 0?"100%":a,I=r.minWidth,L=I===void 0?0:I,k=r.minHeight,G=r.maxHeight,q=r.children,Q=r.debounce,H=Q===void 0?0:Q,K=r.id,he=r.className,ue=r.onResize,me=r.style,ge=me===void 0?{}:me,se=Jt.useRef(null),fe=Jt.useRef();fe.current=ue,Jt.useImperativeHandle(t,function(){return Object.defineProperty(se.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),se.current},configurable:!0})});var ve=Jt.useState({containerWidth:h.width,containerHeight:h.height}),Le=Eee(ve,2),Ue=Le[0],tt=Le[1],Ke=Jt.useCallback(function(st,Rt){tt(function(Mt){var $e=Math.round(st),rt=Math.round(Rt);return Mt.containerWidth===$e&&Mt.containerHeight===rt?Mt:{containerWidth:$e,containerHeight:rt}})},[]);Jt.useEffect(function(){var st=function(Kt){var Je,Ze=Kt[0].contentRect,gt=Ze.width,Bt=Ze.height;Ke(gt,Bt),(Je=fe.current)===null||Je===void 0||Je.call(fe,gt,Bt)};H>0&&(st=a9(st,H,{trailing:!0,leading:!1}));var Rt=new ResizeObserver(st),Mt=se.current.getBoundingClientRect(),$e=Mt.width,rt=Mt.height;return Ke($e,rt),Rt.observe(se.current),function(){Rt.disconnect()}},[Ke,H]);var nt=Jt.useMemo(function(){var st=Ue.containerWidth,Rt=Ue.containerHeight;if(st<0||Rt<0)return null;Dd(Cy(w)||Cy(C),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,w,C),Dd(!o||o>0,"The aspect(%s) must be greater than zero.",o);var Mt=Cy(w)?st:w,$e=Cy(C)?Rt:C;o&&o>0&&(Mt?$e=Mt/o:$e&&(Mt=$e*o),G&&$e>G&&($e=G)),Dd(Mt>0||$e>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Mt,$e,w,C,L,k,o);var rt=!Array.isArray(q)&&cm(q.type).endsWith("Chart");return ft.Children.map(q,function(Ct){return ft.isValidElement(Ct)?Jt.cloneElement(Ct,H2({width:Mt,height:$e},rt?{style:H2({height:"100%",width:"100%",maxHeight:$e,maxWidth:Mt},Ct.props.style)}:{})):Ct})},[o,q,C,G,k,L,Ue,w]);return ft.createElement("div",{id:K?"".concat(K):void 0,className:li("recharts-responsive-container",he),style:H2(H2({},ge),{},{width:w,height:C,minWidth:L,minHeight:k,maxHeight:G}),ref:se},nt)}),qT=function(t){return null};qT.displayName="Cell";function Db(r){"@babel/helpers - typeof";return Db=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Db(r)}function mN(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function KI(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?mN(Object(o),!0).forEach(function(l){Pee(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):mN(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Pee(r,t,o){return t=Dee(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Dee(r){var t=Ree(r,"string");return Db(t)=="symbol"?t:t+""}function Ree(r,t){if(Db(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Db(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var h0={widthCache:{},cacheCount:0},zee=2e3,Lee={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},gN="recharts_measurement_span";function Bee(r){var t=KI({},r);return Object.keys(t).forEach(function(o){t[o]||delete t[o]}),t}var db=function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||rv.isSsr)return{width:0,height:0};var l=Bee(o),h=JSON.stringify({text:t,copyStyle:l});if(h0.widthCache[h])return h0.widthCache[h];try{var v=document.getElementById(gN);v||(v=document.createElement("span"),v.setAttribute("id",gN),v.setAttribute("aria-hidden","true"),document.body.appendChild(v));var w=KI(KI({},Lee),l);Object.assign(v.style,w),v.textContent="".concat(t);var a=v.getBoundingClientRect(),C={width:a.width,height:a.height};return h0.widthCache[h]=C,++h0.cacheCount>zee&&(h0.cacheCount=0,h0.widthCache={}),C}catch{return{width:0,height:0}}},kee=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Rb(r){"@babel/helpers - typeof";return Rb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rb(r)}function UA(r,t){return Uee(r)||jee(r,t)||Nee(r,t)||Fee()}function Fee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nee(r,t){if(r){if(typeof r=="string")return _N(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return _N(r,t)}}function _N(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function jee(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t===0){if(Object(o)!==o)return;C=!1}else for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function Uee(r){if(Array.isArray(r))return r}function Vee(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function yN(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,$ee(l.key),l)}}function Gee(r,t,o){return t&&yN(r.prototype,t),o&&yN(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function $ee(r){var t=qee(r,"string");return Rb(t)=="symbol"?t:t+""}function qee(r,t){if(Rb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Rb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var vN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,xN=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Hee=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Xee=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,o9={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Zee=Object.keys(o9),x0="NaN";function Wee(r,t){return r*o9[t]}var Z2=(function(){function r(t,o){Vee(this,r),this.num=t,this.unit=o,this.num=t,this.unit=o,Number.isNaN(t)&&(this.unit=""),o!==""&&!Hee.test(o)&&(this.num=NaN,this.unit=""),Zee.includes(o)&&(this.num=Wee(t,o),this.unit="px")}return Gee(r,[{key:"add",value:function(o){return this.unit!==o.unit?new r(NaN,""):new r(this.num+o.num,this.unit)}},{key:"subtract",value:function(o){return this.unit!==o.unit?new r(NaN,""):new r(this.num-o.num,this.unit)}},{key:"multiply",value:function(o){return this.unit!==""&&o.unit!==""&&this.unit!==o.unit?new r(NaN,""):new r(this.num*o.num,this.unit||o.unit)}},{key:"divide",value:function(o){return this.unit!==""&&o.unit!==""&&this.unit!==o.unit?new r(NaN,""):new r(this.num/o.num,this.unit||o.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(o){var l,h=(l=Xee.exec(o))!==null&&l!==void 0?l:[],v=UA(h,3),w=v[1],a=v[2];return new r(parseFloat(w),a??"")}}])})();function s9(r){if(r.includes(x0))return x0;for(var t=r;t.includes("*")||t.includes("/");){var o,l=(o=vN.exec(t))!==null&&o!==void 0?o:[],h=UA(l,4),v=h[1],w=h[2],a=h[3],C=Z2.parse(v??""),I=Z2.parse(a??""),L=w==="*"?C.multiply(I):C.divide(I);if(L.isNaN())return x0;t=t.replace(vN,L.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var k,G=(k=xN.exec(t))!==null&&k!==void 0?k:[],q=UA(G,4),Q=q[1],H=q[2],K=q[3],he=Z2.parse(Q??""),ue=Z2.parse(K??""),me=H==="+"?he.add(ue):he.subtract(ue);if(me.isNaN())return x0;t=t.replace(xN,me.toString())}return t}var bN=/\(([^()]*)\)/;function Yee(r){for(var t=r;t.includes("(");){var o=bN.exec(t),l=UA(o,2),h=l[1];t=t.replace(bN,s9(h))}return t}function Kee(r){var t=r.replace(/\s+/g,"");return t=Yee(t),t=s9(t),t}function Qee(r){try{return Kee(r)}catch{return x0}}function lC(r){var t=Qee(r.slice(5,-1));return t===x0?"":t}var Jee=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ete=["dx","dy","angle","className","breakAll"];function QI(){return QI=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},QI.apply(this,arguments)}function wN(r,t){if(r==null)return{};var o=tte(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function tte(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function AN(r,t){return ate(r)||ite(r,t)||nte(r,t)||rte()}function rte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nte(r,t){if(r){if(typeof r=="string")return TN(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return TN(r,t)}}function TN(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function ite(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t===0){if(Object(o)!==o)return;C=!1}else for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function ate(r){if(Array.isArray(r))return r}var l9=/[ \f\n\r\t\v\u2028\u2029]+/,c9=function(t){var o=t.children,l=t.breakAll,h=t.style;try{var v=[];ei(o)||(l?v=o.toString().split(""):v=o.toString().split(l9));var w=v.map(function(C){return{word:C,width:db(C,h).width}}),a=l?0:db("",h).width;return{wordsWithComputedWidth:w,spaceWidth:a}}catch{return null}},ote=function(t,o,l,h,v){var w=t.maxLines,a=t.children,C=t.style,I=t.breakAll,L=Ar(w),k=a,G=function(){var Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Mt.reduce(function($e,rt){var Ct=rt.word,Kt=rt.width,Je=$e[$e.length-1];if(Je&&(h==null||v||Je.width+Kt+l<Number(h)))Je.words.push(Ct),Je.width+=Kt+l;else{var Ze={words:[Ct],width:Kt};$e.push(Ze)}return $e},[])},q=G(o),Q=function(Mt){return Mt.reduce(function($e,rt){return $e.width>rt.width?$e:rt})};if(!L)return q;for(var H="",K=function(Mt){var $e=k.slice(0,Mt),rt=c9({breakAll:I,style:C,children:$e+H}).wordsWithComputedWidth,Ct=G(rt),Kt=Ct.length>w||Q(Ct).width>Number(h);return[Kt,Ct]},he=0,ue=k.length-1,me=0,ge;he<=ue&&me<=k.length-1;){var se=Math.floor((he+ue)/2),fe=se-1,ve=K(fe),Le=AN(ve,2),Ue=Le[0],tt=Le[1],Ke=K(se),nt=AN(Ke,1),st=nt[0];if(!Ue&&!st&&(he=se+1),Ue&&st&&(ue=se-1),!Ue&&st){ge=tt;break}me++}return ge||q},SN=function(t){var o=ei(t)?[]:t.toString().split(l9);return[{words:o}]},ste=function(t){var o=t.width,l=t.scaleToFit,h=t.children,v=t.style,w=t.breakAll,a=t.maxLines;if((o||l)&&!rv.isSsr){var C,I,L=c9({breakAll:w,children:h,style:v});if(L){var k=L.wordsWithComputedWidth,G=L.spaceWidth;C=k,I=G}else return SN(h);return ote({breakAll:w,children:h,maxLines:a,style:v},C,I,o,l)}return SN(h)},EN="#808080",Yy=function(t){var o=t.x,l=o===void 0?0:o,h=t.y,v=h===void 0?0:h,w=t.lineHeight,a=w===void 0?"1em":w,C=t.capHeight,I=C===void 0?"0.71em":C,L=t.scaleToFit,k=L===void 0?!1:L,G=t.textAnchor,q=G===void 0?"start":G,Q=t.verticalAnchor,H=Q===void 0?"end":Q,K=t.fill,he=K===void 0?EN:K,ue=wN(t,Jee),me=Jt.useMemo(function(){return ste({breakAll:ue.breakAll,children:ue.children,maxLines:ue.maxLines,scaleToFit:k,style:ue.style,width:ue.width})},[ue.breakAll,ue.children,ue.maxLines,k,ue.style,ue.width]),ge=ue.dx,se=ue.dy,fe=ue.angle,ve=ue.className,Le=ue.breakAll,Ue=wN(ue,ete);if(!Ms(l)||!Ms(v))return null;var tt=l+(Ar(ge)?ge:0),Ke=v+(Ar(se)?se:0),nt;switch(H){case"start":nt=lC("calc(".concat(I,")"));break;case"middle":nt=lC("calc(".concat((me.length-1)/2," * -").concat(a," + (").concat(I," / 2))"));break;default:nt=lC("calc(".concat(me.length-1," * -").concat(a,")"));break}var st=[];if(k){var Rt=me[0].width,Mt=ue.width;st.push("scale(".concat((Ar(Mt)?Mt/Rt:1)/Rt,")"))}return fe&&st.push("rotate(".concat(fe,", ").concat(tt,", ").concat(Ke,")")),st.length&&(Ue.transform=st.join(" ")),ft.createElement("text",QI({},xn(Ue,!0),{x:tt,y:Ke,className:li("recharts-text",ve),textAnchor:q,fill:he.includes("url")?EN:he}),me.map(function($e,rt){var Ct=$e.words.join(Le?"":" ");return ft.createElement("tspan",{x:tt,dy:rt===0?nt:a,key:"".concat(Ct,"-").concat(rt)},Ct)}))};function qg(r,t){return r==null||t==null?NaN:r<t?-1:r>t?1:r>=t?0:NaN}function lte(r,t){return r==null||t==null?NaN:t<r?-1:t>r?1:t>=r?0:NaN}function QD(r){let t,o,l;r.length!==2?(t=qg,o=(a,C)=>qg(r(a),C),l=(a,C)=>r(a)-C):(t=r===qg||r===lte?r:cte,o=r,l=r);function h(a,C,I=0,L=a.length){if(I<L){if(t(C,C)!==0)return L;do{const k=I+L>>>1;o(a[k],C)<0?I=k+1:L=k}while(I<L)}return I}function v(a,C,I=0,L=a.length){if(I<L){if(t(C,C)!==0)return L;do{const k=I+L>>>1;o(a[k],C)<=0?I=k+1:L=k}while(I<L)}return I}function w(a,C,I=0,L=a.length){const k=h(a,C,I,L-1);return k>I&&l(a[k-1],C)>-l(a[k],C)?k-1:k}return{left:h,center:w,right:v}}function cte(){return 0}function u9(r){return r===null?NaN:+r}function*ute(r,t){for(let o of r)o!=null&&(o=+o)>=o&&(yield o)}const hte=QD(qg),hw=hte.right;QD(u9).center;class MN extends Map{constructor(t,o=pte){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:o}}),t!=null)for(const[l,h]of t)this.set(l,h)}get(t){return super.get(ON(this,t))}has(t){return super.has(ON(this,t))}set(t,o){return super.set(dte(this,t),o)}delete(t){return super.delete(fte(this,t))}}function ON({_intern:r,_key:t},o){const l=t(o);return r.has(l)?r.get(l):o}function dte({_intern:r,_key:t},o){const l=t(o);return r.has(l)?r.get(l):(r.set(l,o),o)}function fte({_intern:r,_key:t},o){const l=t(o);return r.has(l)&&(o=r.get(l),r.delete(l)),o}function pte(r){return r!==null&&typeof r=="object"?r.valueOf():r}function mte(r=qg){if(r===qg)return h9;if(typeof r!="function")throw new TypeError("compare is not a function");return(t,o)=>{const l=r(t,o);return l||l===0?l:(r(o,o)===0)-(r(t,t)===0)}}function h9(r,t){return(r==null||!(r>=r))-(t==null||!(t>=t))||(r<t?-1:r>t?1:0)}const gte=Math.sqrt(50),_te=Math.sqrt(10),yte=Math.sqrt(2);function VA(r,t,o){const l=(t-r)/Math.max(0,o),h=Math.floor(Math.log10(l)),v=l/Math.pow(10,h),w=v>=gte?10:v>=_te?5:v>=yte?2:1;let a,C,I;return h<0?(I=Math.pow(10,-h)/w,a=Math.round(r*I),C=Math.round(t*I),a/I<r&&++a,C/I>t&&--C,I=-I):(I=Math.pow(10,h)*w,a=Math.round(r/I),C=Math.round(t/I),a*I<r&&++a,C*I>t&&--C),C<a&&.5<=o&&o<2?VA(r,t,o*2):[a,C,I]}function JI(r,t,o){if(t=+t,r=+r,o=+o,!(o>0))return[];if(r===t)return[r];const l=t<r,[h,v,w]=l?VA(t,r,o):VA(r,t,o);if(!(v>=h))return[];const a=v-h+1,C=new Array(a);if(l)if(w<0)for(let I=0;I<a;++I)C[I]=(v-I)/-w;else for(let I=0;I<a;++I)C[I]=(v-I)*w;else if(w<0)for(let I=0;I<a;++I)C[I]=(h+I)/-w;else for(let I=0;I<a;++I)C[I]=(h+I)*w;return C}function eP(r,t,o){return t=+t,r=+r,o=+o,VA(r,t,o)[2]}function tP(r,t,o){t=+t,r=+r,o=+o;const l=t<r,h=l?eP(t,r,o):eP(r,t,o);return(l?-1:1)*(h<0?1/-h:h)}function CN(r,t){let o;for(const l of r)l!=null&&(o<l||o===void 0&&l>=l)&&(o=l);return o}function IN(r,t){let o;for(const l of r)l!=null&&(o>l||o===void 0&&l>=l)&&(o=l);return o}function d9(r,t,o=0,l=1/0,h){if(t=Math.floor(t),o=Math.floor(Math.max(0,o)),l=Math.floor(Math.min(r.length-1,l)),!(o<=t&&t<=l))return r;for(h=h===void 0?h9:mte(h);l>o;){if(l-o>600){const C=l-o+1,I=t-o+1,L=Math.log(C),k=.5*Math.exp(2*L/3),G=.5*Math.sqrt(L*k*(C-k)/C)*(I-C/2<0?-1:1),q=Math.max(o,Math.floor(t-I*k/C+G)),Q=Math.min(l,Math.floor(t+(C-I)*k/C+G));d9(r,t,q,Q,h)}const v=r[t];let w=o,a=l;for(z1(r,o,t),h(r[l],v)>0&&z1(r,o,l);w<a;){for(z1(r,w,a),++w,--a;h(r[w],v)<0;)++w;for(;h(r[a],v)>0;)--a}h(r[o],v)===0?z1(r,o,a):(++a,z1(r,a,l)),a<=t&&(o=a+1),t<=a&&(l=a-1)}return r}function z1(r,t,o){const l=r[t];r[t]=r[o],r[o]=l}function vte(r,t,o){if(r=Float64Array.from(ute(r)),!(!(l=r.length)||isNaN(t=+t))){if(t<=0||l<2)return IN(r);if(t>=1)return CN(r);var l,h=(l-1)*t,v=Math.floor(h),w=CN(d9(r,v).subarray(0,v+1)),a=IN(r.subarray(v+1));return w+(a-w)*(h-v)}}function xte(r,t,o=u9){if(!(!(l=r.length)||isNaN(t=+t))){if(t<=0||l<2)return+o(r[0],0,r);if(t>=1)return+o(r[l-1],l-1,r);var l,h=(l-1)*t,v=Math.floor(h),w=+o(r[v],v,r),a=+o(r[v+1],v+1,r);return w+(a-w)*(h-v)}}function bte(r,t,o){r=+r,t=+t,o=(h=arguments.length)<2?(t=r,r=0,1):h<3?1:+o;for(var l=-1,h=Math.max(0,Math.ceil((t-r)/o))|0,v=new Array(h);++l<h;)v[l]=r+l*o;return v}function Lh(r,t){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(t).domain(r);break}return this}function bm(r,t){switch(arguments.length){case 0:break;case 1:{typeof r=="function"?this.interpolator(r):this.range(r);break}default:{this.domain(r),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rP=Symbol("implicit");function JD(){var r=new MN,t=[],o=[],l=rP;function h(v){let w=r.get(v);if(w===void 0){if(l!==rP)return l;r.set(v,w=t.push(v)-1)}return o[w%o.length]}return h.domain=function(v){if(!arguments.length)return t.slice();t=[],r=new MN;for(const w of v)r.has(w)||r.set(w,t.push(w)-1);return h},h.range=function(v){return arguments.length?(o=Array.from(v),h):o.slice()},h.unknown=function(v){return arguments.length?(l=v,h):l},h.copy=function(){return JD(t,o).unknown(l)},Lh.apply(h,arguments),h}function zb(){var r=JD().unknown(void 0),t=r.domain,o=r.range,l=0,h=1,v,w,a=!1,C=0,I=0,L=.5;delete r.unknown;function k(){var G=t().length,q=h<l,Q=q?h:l,H=q?l:h;v=(H-Q)/Math.max(1,G-C+I*2),a&&(v=Math.floor(v)),Q+=(H-Q-v*(G-C))*L,w=v*(1-C),a&&(Q=Math.round(Q),w=Math.round(w));var K=bte(G).map(function(he){return Q+v*he});return o(q?K.reverse():K)}return r.domain=function(G){return arguments.length?(t(G),k()):t()},r.range=function(G){return arguments.length?([l,h]=G,l=+l,h=+h,k()):[l,h]},r.rangeRound=function(G){return[l,h]=G,l=+l,h=+h,a=!0,k()},r.bandwidth=function(){return w},r.step=function(){return v},r.round=function(G){return arguments.length?(a=!!G,k()):a},r.padding=function(G){return arguments.length?(C=Math.min(1,I=+G),k()):C},r.paddingInner=function(G){return arguments.length?(C=Math.min(1,G),k()):C},r.paddingOuter=function(G){return arguments.length?(I=+G,k()):I},r.align=function(G){return arguments.length?(L=Math.max(0,Math.min(1,G)),k()):L},r.copy=function(){return zb(t(),[l,h]).round(a).paddingInner(C).paddingOuter(I).align(L)},Lh.apply(k(),arguments)}function f9(r){var t=r.copy;return r.padding=r.paddingOuter,delete r.paddingInner,delete r.paddingOuter,r.copy=function(){return f9(t())},r}function fb(){return f9(zb.apply(null,arguments).paddingInner(1))}function eR(r,t,o){r.prototype=t.prototype=o,o.constructor=r}function p9(r,t){var o=Object.create(r.prototype);for(var l in t)o[l]=t[l];return o}function dw(){}var Lb=.7,GA=1/Lb,R0="\\s*([+-]?\\d+)\\s*",Bb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",$f="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wte=/^#([0-9a-f]{3,8})$/,Ate=new RegExp(`^rgb\\(${R0},${R0},${R0}\\)$`),Tte=new RegExp(`^rgb\\(${$f},${$f},${$f}\\)$`),Ste=new RegExp(`^rgba\\(${R0},${R0},${R0},${Bb}\\)$`),Ete=new RegExp(`^rgba\\(${$f},${$f},${$f},${Bb}\\)$`),Mte=new RegExp(`^hsl\\(${Bb},${$f},${$f}\\)$`),Ote=new RegExp(`^hsla\\(${Bb},${$f},${$f},${Bb}\\)$`),PN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};eR(dw,kb,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:DN,formatHex:DN,formatHex8:Cte,formatHsl:Ite,formatRgb:RN,toString:RN});function DN(){return this.rgb().formatHex()}function Cte(){return this.rgb().formatHex8()}function Ite(){return m9(this).formatHsl()}function RN(){return this.rgb().formatRgb()}function kb(r){var t,o;return r=(r+"").trim().toLowerCase(),(t=wte.exec(r))?(o=t[1].length,t=parseInt(t[1],16),o===6?zN(t):o===3?new Vc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):o===8?W2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):o===4?W2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Ate.exec(r))?new Vc(t[1],t[2],t[3],1):(t=Tte.exec(r))?new Vc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ste.exec(r))?W2(t[1],t[2],t[3],t[4]):(t=Ete.exec(r))?W2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Mte.exec(r))?kN(t[1],t[2]/100,t[3]/100,1):(t=Ote.exec(r))?kN(t[1],t[2]/100,t[3]/100,t[4]):PN.hasOwnProperty(r)?zN(PN[r]):r==="transparent"?new Vc(NaN,NaN,NaN,0):null}function zN(r){return new Vc(r>>16&255,r>>8&255,r&255,1)}function W2(r,t,o,l){return l<=0&&(r=t=o=NaN),new Vc(r,t,o,l)}function Pte(r){return r instanceof dw||(r=kb(r)),r?(r=r.rgb(),new Vc(r.r,r.g,r.b,r.opacity)):new Vc}function nP(r,t,o,l){return arguments.length===1?Pte(r):new Vc(r,t,o,l??1)}function Vc(r,t,o,l){this.r=+r,this.g=+t,this.b=+o,this.opacity=+l}eR(Vc,nP,p9(dw,{brighter(r){return r=r==null?GA:Math.pow(GA,r),new Vc(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Lb:Math.pow(Lb,r),new Vc(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Vc(Uy(this.r),Uy(this.g),Uy(this.b),$A(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:LN,formatHex:LN,formatHex8:Dte,formatRgb:BN,toString:BN}));function LN(){return`#${Iy(this.r)}${Iy(this.g)}${Iy(this.b)}`}function Dte(){return`#${Iy(this.r)}${Iy(this.g)}${Iy(this.b)}${Iy((isNaN(this.opacity)?1:this.opacity)*255)}`}function BN(){const r=$A(this.opacity);return`${r===1?"rgb(":"rgba("}${Uy(this.r)}, ${Uy(this.g)}, ${Uy(this.b)}${r===1?")":`, ${r})`}`}function $A(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Uy(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Iy(r){return r=Uy(r),(r<16?"0":"")+r.toString(16)}function kN(r,t,o,l){return l<=0?r=t=o=NaN:o<=0||o>=1?r=t=NaN:t<=0&&(r=NaN),new Id(r,t,o,l)}function m9(r){if(r instanceof Id)return new Id(r.h,r.s,r.l,r.opacity);if(r instanceof dw||(r=kb(r)),!r)return new Id;if(r instanceof Id)return r;r=r.rgb();var t=r.r/255,o=r.g/255,l=r.b/255,h=Math.min(t,o,l),v=Math.max(t,o,l),w=NaN,a=v-h,C=(v+h)/2;return a?(t===v?w=(o-l)/a+(o<l)*6:o===v?w=(l-t)/a+2:w=(t-o)/a+4,a/=C<.5?v+h:2-v-h,w*=60):a=C>0&&C<1?0:w,new Id(w,a,C,r.opacity)}function Rte(r,t,o,l){return arguments.length===1?m9(r):new Id(r,t,o,l??1)}function Id(r,t,o,l){this.h=+r,this.s=+t,this.l=+o,this.opacity=+l}eR(Id,Rte,p9(dw,{brighter(r){return r=r==null?GA:Math.pow(GA,r),new Id(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Lb:Math.pow(Lb,r),new Id(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,t=isNaN(r)||isNaN(this.s)?0:this.s,o=this.l,l=o+(o<.5?o:1-o)*t,h=2*o-l;return new Vc(cC(r>=240?r-240:r+120,h,l),cC(r,h,l),cC(r<120?r+240:r-120,h,l),this.opacity)},clamp(){return new Id(FN(this.h),Y2(this.s),Y2(this.l),$A(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=$A(this.opacity);return`${r===1?"hsl(":"hsla("}${FN(this.h)}, ${Y2(this.s)*100}%, ${Y2(this.l)*100}%${r===1?")":`, ${r})`}`}}));function FN(r){return r=(r||0)%360,r<0?r+360:r}function Y2(r){return Math.max(0,Math.min(1,r||0))}function cC(r,t,o){return(r<60?t+(o-t)*r/60:r<180?o:r<240?t+(o-t)*(240-r)/60:t)*255}const tR=r=>()=>r;function zte(r,t){return function(o){return r+o*t}}function Lte(r,t,o){return r=Math.pow(r,o),t=Math.pow(t,o)-r,o=1/o,function(l){return Math.pow(r+l*t,o)}}function Bte(r){return(r=+r)==1?g9:function(t,o){return o-t?Lte(t,o,r):tR(isNaN(t)?o:t)}}function g9(r,t){var o=t-r;return o?zte(r,o):tR(isNaN(r)?t:r)}const NN=(function r(t){var o=Bte(t);function l(h,v){var w=o((h=nP(h)).r,(v=nP(v)).r),a=o(h.g,v.g),C=o(h.b,v.b),I=g9(h.opacity,v.opacity);return function(L){return h.r=w(L),h.g=a(L),h.b=C(L),h.opacity=I(L),h+""}}return l.gamma=r,l})(1);function kte(r,t){t||(t=[]);var o=r?Math.min(t.length,r.length):0,l=t.slice(),h;return function(v){for(h=0;h<o;++h)l[h]=r[h]*(1-v)+t[h]*v;return l}}function Fte(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function Nte(r,t){var o=t?t.length:0,l=r?Math.min(o,r.length):0,h=new Array(l),v=new Array(o),w;for(w=0;w<l;++w)h[w]=xx(r[w],t[w]);for(;w<o;++w)v[w]=t[w];return function(a){for(w=0;w<l;++w)v[w]=h[w](a);return v}}function jte(r,t){var o=new Date;return r=+r,t=+t,function(l){return o.setTime(r*(1-l)+t*l),o}}function qA(r,t){return r=+r,t=+t,function(o){return r*(1-o)+t*o}}function Ute(r,t){var o={},l={},h;(r===null||typeof r!="object")&&(r={}),(t===null||typeof t!="object")&&(t={});for(h in t)h in r?o[h]=xx(r[h],t[h]):l[h]=t[h];return function(v){for(h in o)l[h]=o[h](v);return l}}var iP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uC=new RegExp(iP.source,"g");function Vte(r){return function(){return r}}function Gte(r){return function(t){return r(t)+""}}function $te(r,t){var o=iP.lastIndex=uC.lastIndex=0,l,h,v,w=-1,a=[],C=[];for(r=r+"",t=t+"";(l=iP.exec(r))&&(h=uC.exec(t));)(v=h.index)>o&&(v=t.slice(o,v),a[w]?a[w]+=v:a[++w]=v),(l=l[0])===(h=h[0])?a[w]?a[w]+=h:a[++w]=h:(a[++w]=null,C.push({i:w,x:qA(l,h)})),o=uC.lastIndex;return o<t.length&&(v=t.slice(o),a[w]?a[w]+=v:a[++w]=v),a.length<2?C[0]?Gte(C[0].x):Vte(t):(t=C.length,function(I){for(var L=0,k;L<t;++L)a[(k=C[L]).i]=k.x(I);return a.join("")})}function xx(r,t){var o=typeof t,l;return t==null||o==="boolean"?tR(t):(o==="number"?qA:o==="string"?(l=kb(t))?(t=l,NN):$te:t instanceof kb?NN:t instanceof Date?jte:Fte(t)?kte:Array.isArray(t)?Nte:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ute:qA)(r,t)}function rR(r,t){return r=+r,t=+t,function(o){return Math.round(r*(1-o)+t*o)}}function qte(r,t){t===void 0&&(t=r,r=xx);for(var o=0,l=t.length-1,h=t[0],v=new Array(l<0?0:l);o<l;)v[o]=r(h,h=t[++o]);return function(w){var a=Math.max(0,Math.min(l-1,Math.floor(w*=l)));return v[a](w-a)}}function Hte(r){return function(){return r}}function HA(r){return+r}var jN=[0,1];function mc(r){return r}function aP(r,t){return(t-=r=+r)?function(o){return(o-r)/t}:Hte(isNaN(t)?NaN:.5)}function Xte(r,t){var o;return r>t&&(o=r,r=t,t=o),function(l){return Math.max(r,Math.min(t,l))}}function Zte(r,t,o){var l=r[0],h=r[1],v=t[0],w=t[1];return h<l?(l=aP(h,l),v=o(w,v)):(l=aP(l,h),v=o(v,w)),function(a){return v(l(a))}}function Wte(r,t,o){var l=Math.min(r.length,t.length)-1,h=new Array(l),v=new Array(l),w=-1;for(r[l]<r[0]&&(r=r.slice().reverse(),t=t.slice().reverse());++w<l;)h[w]=aP(r[w],r[w+1]),v[w]=o(t[w],t[w+1]);return function(a){var C=hw(r,a,1,l)-1;return v[C](h[C](a))}}function fw(r,t){return t.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function HT(){var r=jN,t=jN,o=xx,l,h,v,w=mc,a,C,I;function L(){var G=Math.min(r.length,t.length);return w!==mc&&(w=Xte(r[0],r[G-1])),a=G>2?Wte:Zte,C=I=null,k}function k(G){return G==null||isNaN(G=+G)?v:(C||(C=a(r.map(l),t,o)))(l(w(G)))}return k.invert=function(G){return w(h((I||(I=a(t,r.map(l),qA)))(G)))},k.domain=function(G){return arguments.length?(r=Array.from(G,HA),L()):r.slice()},k.range=function(G){return arguments.length?(t=Array.from(G),L()):t.slice()},k.rangeRound=function(G){return t=Array.from(G),o=rR,L()},k.clamp=function(G){return arguments.length?(w=G?!0:mc,L()):w!==mc},k.interpolate=function(G){return arguments.length?(o=G,L()):o},k.unknown=function(G){return arguments.length?(v=G,k):v},function(G,q){return l=G,h=q,L()}}function nR(){return HT()(mc,mc)}function Yte(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function XA(r,t){if((o=(r=t?r.toExponential(t-1):r.toExponential()).indexOf("e"))<0)return null;var o,l=r.slice(0,o);return[l.length>1?l[0]+l.slice(2):l,+r.slice(o+1)]}function Z0(r){return r=XA(Math.abs(r)),r?r[1]:NaN}function Kte(r,t){return function(o,l){for(var h=o.length,v=[],w=0,a=r[0],C=0;h>0&&a>0&&(C+a+1>l&&(a=Math.max(1,l-C)),v.push(o.substring(h-=a,h+a)),!((C+=a+1)>l));)a=r[w=(w+1)%r.length];return v.reverse().join(t)}}function Qte(r){return function(t){return t.replace(/[0-9]/g,function(o){return r[+o]})}}var Jte=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Fb(r){if(!(t=Jte.exec(r)))throw new Error("invalid format: "+r);var t;return new iR({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Fb.prototype=iR.prototype;function iR(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}iR.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function ere(r){e:for(var t=r.length,o=1,l=-1,h;o<t;++o)switch(r[o]){case".":l=h=o;break;case"0":l===0&&(l=o),h=o;break;default:if(!+r[o])break e;l>0&&(l=0);break}return l>0?r.slice(0,l)+r.slice(h+1):r}var _9;function tre(r,t){var o=XA(r,t);if(!o)return r+"";var l=o[0],h=o[1],v=h-(_9=Math.max(-8,Math.min(8,Math.floor(h/3)))*3)+1,w=l.length;return v===w?l:v>w?l+new Array(v-w+1).join("0"):v>0?l.slice(0,v)+"."+l.slice(v):"0."+new Array(1-v).join("0")+XA(r,Math.max(0,t+v-1))[0]}function UN(r,t){var o=XA(r,t);if(!o)return r+"";var l=o[0],h=o[1];return h<0?"0."+new Array(-h).join("0")+l:l.length>h+1?l.slice(0,h+1)+"."+l.slice(h+1):l+new Array(h-l.length+2).join("0")}const VN={"%":(r,t)=>(r*100).toFixed(t),b:r=>Math.round(r).toString(2),c:r=>r+"",d:Yte,e:(r,t)=>r.toExponential(t),f:(r,t)=>r.toFixed(t),g:(r,t)=>r.toPrecision(t),o:r=>Math.round(r).toString(8),p:(r,t)=>UN(r*100,t),r:UN,s:tre,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function GN(r){return r}var $N=Array.prototype.map,qN=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function rre(r){var t=r.grouping===void 0||r.thousands===void 0?GN:Kte($N.call(r.grouping,Number),r.thousands+""),o=r.currency===void 0?"":r.currency[0]+"",l=r.currency===void 0?"":r.currency[1]+"",h=r.decimal===void 0?".":r.decimal+"",v=r.numerals===void 0?GN:Qte($N.call(r.numerals,String)),w=r.percent===void 0?"%":r.percent+"",a=r.minus===void 0?"":r.minus+"",C=r.nan===void 0?"NaN":r.nan+"";function I(k){k=Fb(k);var G=k.fill,q=k.align,Q=k.sign,H=k.symbol,K=k.zero,he=k.width,ue=k.comma,me=k.precision,ge=k.trim,se=k.type;se==="n"?(ue=!0,se="g"):VN[se]||(me===void 0&&(me=12),ge=!0,se="g"),(K||G==="0"&&q==="=")&&(K=!0,G="0",q="=");var fe=H==="$"?o:H==="#"&&/[boxX]/.test(se)?"0"+se.toLowerCase():"",ve=H==="$"?l:/[%p]/.test(se)?w:"",Le=VN[se],Ue=/[defgprs%]/.test(se);me=me===void 0?6:/[gprs]/.test(se)?Math.max(1,Math.min(21,me)):Math.max(0,Math.min(20,me));function tt(Ke){var nt=fe,st=ve,Rt,Mt,$e;if(se==="c")st=Le(Ke)+st,Ke="";else{Ke=+Ke;var rt=Ke<0||1/Ke<0;if(Ke=isNaN(Ke)?C:Le(Math.abs(Ke),me),ge&&(Ke=ere(Ke)),rt&&+Ke==0&&Q!=="+"&&(rt=!1),nt=(rt?Q==="("?Q:a:Q==="-"||Q==="("?"":Q)+nt,st=(se==="s"?qN[8+_9/3]:"")+st+(rt&&Q==="("?")":""),Ue){for(Rt=-1,Mt=Ke.length;++Rt<Mt;)if($e=Ke.charCodeAt(Rt),48>$e||$e>57){st=($e===46?h+Ke.slice(Rt+1):Ke.slice(Rt))+st,Ke=Ke.slice(0,Rt);break}}}ue&&!K&&(Ke=t(Ke,1/0));var Ct=nt.length+Ke.length+st.length,Kt=Ct<he?new Array(he-Ct+1).join(G):"";switch(ue&&K&&(Ke=t(Kt+Ke,Kt.length?he-st.length:1/0),Kt=""),q){case"<":Ke=nt+Ke+st+Kt;break;case"=":Ke=nt+Kt+Ke+st;break;case"^":Ke=Kt.slice(0,Ct=Kt.length>>1)+nt+Ke+st+Kt.slice(Ct);break;default:Ke=Kt+nt+Ke+st;break}return v(Ke)}return tt.toString=function(){return k+""},tt}function L(k,G){var q=I((k=Fb(k),k.type="f",k)),Q=Math.max(-8,Math.min(8,Math.floor(Z0(G)/3)))*3,H=Math.pow(10,-Q),K=qN[8+Q/3];return function(he){return q(H*he)+K}}return{format:I,formatPrefix:L}}var K2,aR,y9;nre({thousands:",",grouping:[3],currency:["$",""]});function nre(r){return K2=rre(r),aR=K2.format,y9=K2.formatPrefix,K2}function ire(r){return Math.max(0,-Z0(Math.abs(r)))}function are(r,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Z0(t)/3)))*3-Z0(Math.abs(r)))}function ore(r,t){return r=Math.abs(r),t=Math.abs(t)-r,Math.max(0,Z0(t)-Z0(r))+1}function v9(r,t,o,l){var h=tP(r,t,o),v;switch(l=Fb(l??",f"),l.type){case"s":{var w=Math.max(Math.abs(r),Math.abs(t));return l.precision==null&&!isNaN(v=are(h,w))&&(l.precision=v),y9(l,w)}case"":case"e":case"g":case"p":case"r":{l.precision==null&&!isNaN(v=ore(h,Math.max(Math.abs(r),Math.abs(t))))&&(l.precision=v-(l.type==="e"));break}case"f":case"%":{l.precision==null&&!isNaN(v=ire(h))&&(l.precision=v-(l.type==="%")*2);break}}return aR(l)}function Qg(r){var t=r.domain;return r.ticks=function(o){var l=t();return JI(l[0],l[l.length-1],o??10)},r.tickFormat=function(o,l){var h=t();return v9(h[0],h[h.length-1],o??10,l)},r.nice=function(o){o==null&&(o=10);var l=t(),h=0,v=l.length-1,w=l[h],a=l[v],C,I,L=10;for(a<w&&(I=w,w=a,a=I,I=h,h=v,v=I);L-- >0;){if(I=eP(w,a,o),I===C)return l[h]=w,l[v]=a,t(l);if(I>0)w=Math.floor(w/I)*I,a=Math.ceil(a/I)*I;else if(I<0)w=Math.ceil(w*I)/I,a=Math.floor(a*I)/I;else break;C=I}return r},r}function ZA(){var r=nR();return r.copy=function(){return fw(r,ZA())},Lh.apply(r,arguments),Qg(r)}function x9(r){var t;function o(l){return l==null||isNaN(l=+l)?t:l}return o.invert=o,o.domain=o.range=function(l){return arguments.length?(r=Array.from(l,HA),o):r.slice()},o.unknown=function(l){return arguments.length?(t=l,o):t},o.copy=function(){return x9(r).unknown(t)},r=arguments.length?Array.from(r,HA):[0,1],Qg(o)}function b9(r,t){r=r.slice();var o=0,l=r.length-1,h=r[o],v=r[l],w;return v<h&&(w=o,o=l,l=w,w=h,h=v,v=w),r[o]=t.floor(h),r[l]=t.ceil(v),r}function HN(r){return Math.log(r)}function XN(r){return Math.exp(r)}function sre(r){return-Math.log(-r)}function lre(r){return-Math.exp(-r)}function cre(r){return isFinite(r)?+("1e"+r):r<0?0:r}function ure(r){return r===10?cre:r===Math.E?Math.exp:t=>Math.pow(r,t)}function hre(r){return r===Math.E?Math.log:r===10&&Math.log10||r===2&&Math.log2||(r=Math.log(r),t=>Math.log(t)/r)}function ZN(r){return(t,o)=>-r(-t,o)}function oR(r){const t=r(HN,XN),o=t.domain;let l=10,h,v;function w(){return h=hre(l),v=ure(l),o()[0]<0?(h=ZN(h),v=ZN(v),r(sre,lre)):r(HN,XN),t}return t.base=function(a){return arguments.length?(l=+a,w()):l},t.domain=function(a){return arguments.length?(o(a),w()):o()},t.ticks=a=>{const C=o();let I=C[0],L=C[C.length-1];const k=L<I;k&&([I,L]=[L,I]);let G=h(I),q=h(L),Q,H;const K=a==null?10:+a;let he=[];if(!(l%1)&&q-G<K){if(G=Math.floor(G),q=Math.ceil(q),I>0){for(;G<=q;++G)for(Q=1;Q<l;++Q)if(H=G<0?Q/v(-G):Q*v(G),!(H<I)){if(H>L)break;he.push(H)}}else for(;G<=q;++G)for(Q=l-1;Q>=1;--Q)if(H=G>0?Q/v(-G):Q*v(G),!(H<I)){if(H>L)break;he.push(H)}he.length*2<K&&(he=JI(I,L,K))}else he=JI(G,q,Math.min(q-G,K)).map(v);return k?he.reverse():he},t.tickFormat=(a,C)=>{if(a==null&&(a=10),C==null&&(C=l===10?"s":","),typeof C!="function"&&(!(l%1)&&(C=Fb(C)).precision==null&&(C.trim=!0),C=aR(C)),a===1/0)return C;const I=Math.max(1,l*a/t.ticks().length);return L=>{let k=L/v(Math.round(h(L)));return k*l<l-.5&&(k*=l),k<=I?C(L):""}},t.nice=()=>o(b9(o(),{floor:a=>v(Math.floor(h(a))),ceil:a=>v(Math.ceil(h(a)))})),t}function w9(){const r=oR(HT()).domain([1,10]);return r.copy=()=>fw(r,w9()).base(r.base()),Lh.apply(r,arguments),r}function WN(r){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/r))}}function YN(r){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*r}}function sR(r){var t=1,o=r(WN(t),YN(t));return o.constant=function(l){return arguments.length?r(WN(t=+l),YN(t)):t},Qg(o)}function A9(){var r=sR(HT());return r.copy=function(){return fw(r,A9()).constant(r.constant())},Lh.apply(r,arguments)}function KN(r){return function(t){return t<0?-Math.pow(-t,r):Math.pow(t,r)}}function dre(r){return r<0?-Math.sqrt(-r):Math.sqrt(r)}function fre(r){return r<0?-r*r:r*r}function lR(r){var t=r(mc,mc),o=1;function l(){return o===1?r(mc,mc):o===.5?r(dre,fre):r(KN(o),KN(1/o))}return t.exponent=function(h){return arguments.length?(o=+h,l()):o},Qg(t)}function cR(){var r=lR(HT());return r.copy=function(){return fw(r,cR()).exponent(r.exponent())},Lh.apply(r,arguments),r}function pre(){return cR.apply(null,arguments).exponent(.5)}function QN(r){return Math.sign(r)*r*r}function mre(r){return Math.sign(r)*Math.sqrt(Math.abs(r))}function T9(){var r=nR(),t=[0,1],o=!1,l;function h(v){var w=mre(r(v));return isNaN(w)?l:o?Math.round(w):w}return h.invert=function(v){return r.invert(QN(v))},h.domain=function(v){return arguments.length?(r.domain(v),h):r.domain()},h.range=function(v){return arguments.length?(r.range((t=Array.from(v,HA)).map(QN)),h):t.slice()},h.rangeRound=function(v){return h.range(v).round(!0)},h.round=function(v){return arguments.length?(o=!!v,h):o},h.clamp=function(v){return arguments.length?(r.clamp(v),h):r.clamp()},h.unknown=function(v){return arguments.length?(l=v,h):l},h.copy=function(){return T9(r.domain(),t).round(o).clamp(r.clamp()).unknown(l)},Lh.apply(h,arguments),Qg(h)}function S9(){var r=[],t=[],o=[],l;function h(){var w=0,a=Math.max(1,t.length);for(o=new Array(a-1);++w<a;)o[w-1]=xte(r,w/a);return v}function v(w){return w==null||isNaN(w=+w)?l:t[hw(o,w)]}return v.invertExtent=function(w){var a=t.indexOf(w);return a<0?[NaN,NaN]:[a>0?o[a-1]:r[0],a<o.length?o[a]:r[r.length-1]]},v.domain=function(w){if(!arguments.length)return r.slice();r=[];for(let a of w)a!=null&&!isNaN(a=+a)&&r.push(a);return r.sort(qg),h()},v.range=function(w){return arguments.length?(t=Array.from(w),h()):t.slice()},v.unknown=function(w){return arguments.length?(l=w,v):l},v.quantiles=function(){return o.slice()},v.copy=function(){return S9().domain(r).range(t).unknown(l)},Lh.apply(v,arguments)}function E9(){var r=0,t=1,o=1,l=[.5],h=[0,1],v;function w(C){return C!=null&&C<=C?h[hw(l,C,0,o)]:v}function a(){var C=-1;for(l=new Array(o);++C<o;)l[C]=((C+1)*t-(C-o)*r)/(o+1);return w}return w.domain=function(C){return arguments.length?([r,t]=C,r=+r,t=+t,a()):[r,t]},w.range=function(C){return arguments.length?(o=(h=Array.from(C)).length-1,a()):h.slice()},w.invertExtent=function(C){var I=h.indexOf(C);return I<0?[NaN,NaN]:I<1?[r,l[0]]:I>=o?[l[o-1],t]:[l[I-1],l[I]]},w.unknown=function(C){return arguments.length&&(v=C),w},w.thresholds=function(){return l.slice()},w.copy=function(){return E9().domain([r,t]).range(h).unknown(v)},Lh.apply(Qg(w),arguments)}function M9(){var r=[.5],t=[0,1],o,l=1;function h(v){return v!=null&&v<=v?t[hw(r,v,0,l)]:o}return h.domain=function(v){return arguments.length?(r=Array.from(v),l=Math.min(r.length,t.length-1),h):r.slice()},h.range=function(v){return arguments.length?(t=Array.from(v),l=Math.min(r.length,t.length-1),h):t.slice()},h.invertExtent=function(v){var w=t.indexOf(v);return[r[w-1],r[w]]},h.unknown=function(v){return arguments.length?(o=v,h):o},h.copy=function(){return M9().domain(r).range(t).unknown(o)},Lh.apply(h,arguments)}const hC=new Date,dC=new Date;function Os(r,t,o,l){function h(v){return r(v=arguments.length===0?new Date:new Date(+v)),v}return h.floor=v=>(r(v=new Date(+v)),v),h.ceil=v=>(r(v=new Date(v-1)),t(v,1),r(v),v),h.round=v=>{const w=h(v),a=h.ceil(v);return v-w<a-v?w:a},h.offset=(v,w)=>(t(v=new Date(+v),w==null?1:Math.floor(w)),v),h.range=(v,w,a)=>{const C=[];if(v=h.ceil(v),a=a==null?1:Math.floor(a),!(v<w)||!(a>0))return C;let I;do C.push(I=new Date(+v)),t(v,a),r(v);while(I<v&&v<w);return C},h.filter=v=>Os(w=>{if(w>=w)for(;r(w),!v(w);)w.setTime(w-1)},(w,a)=>{if(w>=w)if(a<0)for(;++a<=0;)for(;t(w,-1),!v(w););else for(;--a>=0;)for(;t(w,1),!v(w););}),o&&(h.count=(v,w)=>(hC.setTime(+v),dC.setTime(+w),r(hC),r(dC),Math.floor(o(hC,dC))),h.every=v=>(v=Math.floor(v),!isFinite(v)||!(v>0)?null:v>1?h.filter(l?w=>l(w)%v===0:w=>h.count(0,w)%v===0):h)),h}const WA=Os(()=>{},(r,t)=>{r.setTime(+r+t)},(r,t)=>t-r);WA.every=r=>(r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?Os(t=>{t.setTime(Math.floor(t/r)*r)},(t,o)=>{t.setTime(+t+o*r)},(t,o)=>(o-t)/r):WA);WA.range;const am=1e3,Ph=am*60,om=Ph*60,mm=om*24,uR=mm*7,JN=mm*30,fC=mm*365,Py=Os(r=>{r.setTime(r-r.getMilliseconds())},(r,t)=>{r.setTime(+r+t*am)},(r,t)=>(t-r)/am,r=>r.getUTCSeconds());Py.range;const hR=Os(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*am)},(r,t)=>{r.setTime(+r+t*Ph)},(r,t)=>(t-r)/Ph,r=>r.getMinutes());hR.range;const dR=Os(r=>{r.setUTCSeconds(0,0)},(r,t)=>{r.setTime(+r+t*Ph)},(r,t)=>(t-r)/Ph,r=>r.getUTCMinutes());dR.range;const fR=Os(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*am-r.getMinutes()*Ph)},(r,t)=>{r.setTime(+r+t*om)},(r,t)=>(t-r)/om,r=>r.getHours());fR.range;const pR=Os(r=>{r.setUTCMinutes(0,0,0)},(r,t)=>{r.setTime(+r+t*om)},(r,t)=>(t-r)/om,r=>r.getUTCHours());pR.range;const pw=Os(r=>r.setHours(0,0,0,0),(r,t)=>r.setDate(r.getDate()+t),(r,t)=>(t-r-(t.getTimezoneOffset()-r.getTimezoneOffset())*Ph)/mm,r=>r.getDate()-1);pw.range;const XT=Os(r=>{r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t)},(r,t)=>(t-r)/mm,r=>r.getUTCDate()-1);XT.range;const O9=Os(r=>{r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCDate(r.getUTCDate()+t)},(r,t)=>(t-r)/mm,r=>Math.floor(r/mm));O9.range;function nv(r){return Os(t=>{t.setDate(t.getDate()-(t.getDay()+7-r)%7),t.setHours(0,0,0,0)},(t,o)=>{t.setDate(t.getDate()+o*7)},(t,o)=>(o-t-(o.getTimezoneOffset()-t.getTimezoneOffset())*Ph)/uR)}const ZT=nv(0),YA=nv(1),gre=nv(2),_re=nv(3),W0=nv(4),yre=nv(5),vre=nv(6);ZT.range;YA.range;gre.range;_re.range;W0.range;yre.range;vre.range;function iv(r){return Os(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-r)%7),t.setUTCHours(0,0,0,0)},(t,o)=>{t.setUTCDate(t.getUTCDate()+o*7)},(t,o)=>(o-t)/uR)}const WT=iv(0),KA=iv(1),xre=iv(2),bre=iv(3),Y0=iv(4),wre=iv(5),Are=iv(6);WT.range;KA.range;xre.range;bre.range;Y0.range;wre.range;Are.range;const mR=Os(r=>{r.setDate(1),r.setHours(0,0,0,0)},(r,t)=>{r.setMonth(r.getMonth()+t)},(r,t)=>t.getMonth()-r.getMonth()+(t.getFullYear()-r.getFullYear())*12,r=>r.getMonth());mR.range;const gR=Os(r=>{r.setUTCDate(1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCMonth(r.getUTCMonth()+t)},(r,t)=>t.getUTCMonth()-r.getUTCMonth()+(t.getUTCFullYear()-r.getUTCFullYear())*12,r=>r.getUTCMonth());gR.range;const gm=Os(r=>{r.setMonth(0,1),r.setHours(0,0,0,0)},(r,t)=>{r.setFullYear(r.getFullYear()+t)},(r,t)=>t.getFullYear()-r.getFullYear(),r=>r.getFullYear());gm.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:Os(t=>{t.setFullYear(Math.floor(t.getFullYear()/r)*r),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,o)=>{t.setFullYear(t.getFullYear()+o*r)});gm.range;const _m=Os(r=>{r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,t)=>{r.setUTCFullYear(r.getUTCFullYear()+t)},(r,t)=>t.getUTCFullYear()-r.getUTCFullYear(),r=>r.getUTCFullYear());_m.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:Os(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/r)*r),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,o)=>{t.setUTCFullYear(t.getUTCFullYear()+o*r)});_m.range;function C9(r,t,o,l,h,v){const w=[[Py,1,am],[Py,5,5*am],[Py,15,15*am],[Py,30,30*am],[v,1,Ph],[v,5,5*Ph],[v,15,15*Ph],[v,30,30*Ph],[h,1,om],[h,3,3*om],[h,6,6*om],[h,12,12*om],[l,1,mm],[l,2,2*mm],[o,1,uR],[t,1,JN],[t,3,3*JN],[r,1,fC]];function a(I,L,k){const G=L<I;G&&([I,L]=[L,I]);const q=k&&typeof k.range=="function"?k:C(I,L,k),Q=q?q.range(I,+L+1):[];return G?Q.reverse():Q}function C(I,L,k){const G=Math.abs(L-I)/k,q=QD(([,,K])=>K).right(w,G);if(q===w.length)return r.every(tP(I/fC,L/fC,k));if(q===0)return WA.every(Math.max(tP(I,L,k),1));const[Q,H]=w[G/w[q-1][2]<w[q][2]/G?q-1:q];return Q.every(H)}return[a,C]}const[Tre,Sre]=C9(_m,gR,WT,O9,pR,dR),[Ere,Mre]=C9(gm,mR,ZT,pw,fR,hR);function pC(r){if(0<=r.y&&r.y<100){var t=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return t.setFullYear(r.y),t}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function mC(r){if(0<=r.y&&r.y<100){var t=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return t.setUTCFullYear(r.y),t}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function L1(r,t,o){return{y:r,m:t,d:o,H:0,M:0,S:0,L:0}}function Ore(r){var t=r.dateTime,o=r.date,l=r.time,h=r.periods,v=r.days,w=r.shortDays,a=r.months,C=r.shortMonths,I=B1(h),L=k1(h),k=B1(v),G=k1(v),q=B1(w),Q=k1(w),H=B1(a),K=k1(a),he=B1(C),ue=k1(C),me={a:rt,A:Ct,b:Kt,B:Je,c:null,d:aj,e:aj,f:Kre,g:sne,G:cne,H:Zre,I:Wre,j:Yre,L:I9,m:Qre,M:Jre,p:Ze,q:gt,Q:lj,s:cj,S:ene,u:tne,U:rne,V:nne,w:ine,W:ane,x:null,X:null,y:one,Y:lne,Z:une,"%":sj},ge={a:Bt,A:ar,b:Er,B:jr,c:null,d:oj,e:oj,f:pne,g:Tne,G:Ene,H:hne,I:dne,j:fne,L:D9,m:mne,M:gne,p:Zr,q:fn,Q:lj,s:cj,S:_ne,u:yne,U:vne,V:xne,w:bne,W:wne,x:null,X:null,y:Ane,Y:Sne,Z:Mne,"%":sj},se={a:tt,A:Ke,b:nt,B:st,c:Rt,d:nj,e:nj,f:$re,g:rj,G:tj,H:ij,I:ij,j:jre,L:Gre,m:Nre,M:Ure,p:Ue,q:Fre,Q:Hre,s:Xre,S:Vre,u:Rre,U:zre,V:Lre,w:Dre,W:Bre,x:Mt,X:$e,y:rj,Y:tj,Z:kre,"%":qre};me.x=fe(o,me),me.X=fe(l,me),me.c=fe(t,me),ge.x=fe(o,ge),ge.X=fe(l,ge),ge.c=fe(t,ge);function fe(Xt,Mr){return function(kr){var or=[],Tr=-1,Ur=0,zn=Xt.length,Fn,Ut,_n;for(kr instanceof Date||(kr=new Date(+kr));++Tr<zn;)Xt.charCodeAt(Tr)===37&&(or.push(Xt.slice(Ur,Tr)),(Ut=ej[Fn=Xt.charAt(++Tr)])!=null?Fn=Xt.charAt(++Tr):Ut=Fn==="e"?" ":"0",(_n=Mr[Fn])&&(Fn=_n(kr,Ut)),or.push(Fn),Ur=Tr+1);return or.push(Xt.slice(Ur,Tr)),or.join("")}}function ve(Xt,Mr){return function(kr){var or=L1(1900,void 0,1),Tr=Le(or,Xt,kr+="",0),Ur,zn;if(Tr!=kr.length)return null;if("Q"in or)return new Date(or.Q);if("s"in or)return new Date(or.s*1e3+("L"in or?or.L:0));if(Mr&&!("Z"in or)&&(or.Z=0),"p"in or&&(or.H=or.H%12+or.p*12),or.m===void 0&&(or.m="q"in or?or.q:0),"V"in or){if(or.V<1||or.V>53)return null;"w"in or||(or.w=1),"Z"in or?(Ur=mC(L1(or.y,0,1)),zn=Ur.getUTCDay(),Ur=zn>4||zn===0?KA.ceil(Ur):KA(Ur),Ur=XT.offset(Ur,(or.V-1)*7),or.y=Ur.getUTCFullYear(),or.m=Ur.getUTCMonth(),or.d=Ur.getUTCDate()+(or.w+6)%7):(Ur=pC(L1(or.y,0,1)),zn=Ur.getDay(),Ur=zn>4||zn===0?YA.ceil(Ur):YA(Ur),Ur=pw.offset(Ur,(or.V-1)*7),or.y=Ur.getFullYear(),or.m=Ur.getMonth(),or.d=Ur.getDate()+(or.w+6)%7)}else("W"in or||"U"in or)&&("w"in or||(or.w="u"in or?or.u%7:"W"in or?1:0),zn="Z"in or?mC(L1(or.y,0,1)).getUTCDay():pC(L1(or.y,0,1)).getDay(),or.m=0,or.d="W"in or?(or.w+6)%7+or.W*7-(zn+5)%7:or.w+or.U*7-(zn+6)%7);return"Z"in or?(or.H+=or.Z/100|0,or.M+=or.Z%100,mC(or)):pC(or)}}function Le(Xt,Mr,kr,or){for(var Tr=0,Ur=Mr.length,zn=kr.length,Fn,Ut;Tr<Ur;){if(or>=zn)return-1;if(Fn=Mr.charCodeAt(Tr++),Fn===37){if(Fn=Mr.charAt(Tr++),Ut=se[Fn in ej?Mr.charAt(Tr++):Fn],!Ut||(or=Ut(Xt,kr,or))<0)return-1}else if(Fn!=kr.charCodeAt(or++))return-1}return or}function Ue(Xt,Mr,kr){var or=I.exec(Mr.slice(kr));return or?(Xt.p=L.get(or[0].toLowerCase()),kr+or[0].length):-1}function tt(Xt,Mr,kr){var or=q.exec(Mr.slice(kr));return or?(Xt.w=Q.get(or[0].toLowerCase()),kr+or[0].length):-1}function Ke(Xt,Mr,kr){var or=k.exec(Mr.slice(kr));return or?(Xt.w=G.get(or[0].toLowerCase()),kr+or[0].length):-1}function nt(Xt,Mr,kr){var or=he.exec(Mr.slice(kr));return or?(Xt.m=ue.get(or[0].toLowerCase()),kr+or[0].length):-1}function st(Xt,Mr,kr){var or=H.exec(Mr.slice(kr));return or?(Xt.m=K.get(or[0].toLowerCase()),kr+or[0].length):-1}function Rt(Xt,Mr,kr){return Le(Xt,t,Mr,kr)}function Mt(Xt,Mr,kr){return Le(Xt,o,Mr,kr)}function $e(Xt,Mr,kr){return Le(Xt,l,Mr,kr)}function rt(Xt){return w[Xt.getDay()]}function Ct(Xt){return v[Xt.getDay()]}function Kt(Xt){return C[Xt.getMonth()]}function Je(Xt){return a[Xt.getMonth()]}function Ze(Xt){return h[+(Xt.getHours()>=12)]}function gt(Xt){return 1+~~(Xt.getMonth()/3)}function Bt(Xt){return w[Xt.getUTCDay()]}function ar(Xt){return v[Xt.getUTCDay()]}function Er(Xt){return C[Xt.getUTCMonth()]}function jr(Xt){return a[Xt.getUTCMonth()]}function Zr(Xt){return h[+(Xt.getUTCHours()>=12)]}function fn(Xt){return 1+~~(Xt.getUTCMonth()/3)}return{format:function(Xt){var Mr=fe(Xt+="",me);return Mr.toString=function(){return Xt},Mr},parse:function(Xt){var Mr=ve(Xt+="",!1);return Mr.toString=function(){return Xt},Mr},utcFormat:function(Xt){var Mr=fe(Xt+="",ge);return Mr.toString=function(){return Xt},Mr},utcParse:function(Xt){var Mr=ve(Xt+="",!0);return Mr.toString=function(){return Xt},Mr}}}var ej={"-":"",_:" ",0:"0"},Xs=/^\s*\d+/,Cre=/^%/,Ire=/[\\^$*+?|[\]().{}]/g;function Xi(r,t,o){var l=r<0?"-":"",h=(l?-r:r)+"",v=h.length;return l+(v<o?new Array(o-v+1).join(t)+h:h)}function Pre(r){return r.replace(Ire,"\\$&")}function B1(r){return new RegExp("^(?:"+r.map(Pre).join("|")+")","i")}function k1(r){return new Map(r.map((t,o)=>[t.toLowerCase(),o]))}function Dre(r,t,o){var l=Xs.exec(t.slice(o,o+1));return l?(r.w=+l[0],o+l[0].length):-1}function Rre(r,t,o){var l=Xs.exec(t.slice(o,o+1));return l?(r.u=+l[0],o+l[0].length):-1}function zre(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.U=+l[0],o+l[0].length):-1}function Lre(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.V=+l[0],o+l[0].length):-1}function Bre(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.W=+l[0],o+l[0].length):-1}function tj(r,t,o){var l=Xs.exec(t.slice(o,o+4));return l?(r.y=+l[0],o+l[0].length):-1}function rj(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.y=+l[0]+(+l[0]>68?1900:2e3),o+l[0].length):-1}function kre(r,t,o){var l=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(o,o+6));return l?(r.Z=l[1]?0:-(l[2]+(l[3]||"00")),o+l[0].length):-1}function Fre(r,t,o){var l=Xs.exec(t.slice(o,o+1));return l?(r.q=l[0]*3-3,o+l[0].length):-1}function Nre(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.m=l[0]-1,o+l[0].length):-1}function nj(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.d=+l[0],o+l[0].length):-1}function jre(r,t,o){var l=Xs.exec(t.slice(o,o+3));return l?(r.m=0,r.d=+l[0],o+l[0].length):-1}function ij(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.H=+l[0],o+l[0].length):-1}function Ure(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.M=+l[0],o+l[0].length):-1}function Vre(r,t,o){var l=Xs.exec(t.slice(o,o+2));return l?(r.S=+l[0],o+l[0].length):-1}function Gre(r,t,o){var l=Xs.exec(t.slice(o,o+3));return l?(r.L=+l[0],o+l[0].length):-1}function $re(r,t,o){var l=Xs.exec(t.slice(o,o+6));return l?(r.L=Math.floor(l[0]/1e3),o+l[0].length):-1}function qre(r,t,o){var l=Cre.exec(t.slice(o,o+1));return l?o+l[0].length:-1}function Hre(r,t,o){var l=Xs.exec(t.slice(o));return l?(r.Q=+l[0],o+l[0].length):-1}function Xre(r,t,o){var l=Xs.exec(t.slice(o));return l?(r.s=+l[0],o+l[0].length):-1}function aj(r,t){return Xi(r.getDate(),t,2)}function Zre(r,t){return Xi(r.getHours(),t,2)}function Wre(r,t){return Xi(r.getHours()%12||12,t,2)}function Yre(r,t){return Xi(1+pw.count(gm(r),r),t,3)}function I9(r,t){return Xi(r.getMilliseconds(),t,3)}function Kre(r,t){return I9(r,t)+"000"}function Qre(r,t){return Xi(r.getMonth()+1,t,2)}function Jre(r,t){return Xi(r.getMinutes(),t,2)}function ene(r,t){return Xi(r.getSeconds(),t,2)}function tne(r){var t=r.getDay();return t===0?7:t}function rne(r,t){return Xi(ZT.count(gm(r)-1,r),t,2)}function P9(r){var t=r.getDay();return t>=4||t===0?W0(r):W0.ceil(r)}function nne(r,t){return r=P9(r),Xi(W0.count(gm(r),r)+(gm(r).getDay()===4),t,2)}function ine(r){return r.getDay()}function ane(r,t){return Xi(YA.count(gm(r)-1,r),t,2)}function one(r,t){return Xi(r.getFullYear()%100,t,2)}function sne(r,t){return r=P9(r),Xi(r.getFullYear()%100,t,2)}function lne(r,t){return Xi(r.getFullYear()%1e4,t,4)}function cne(r,t){var o=r.getDay();return r=o>=4||o===0?W0(r):W0.ceil(r),Xi(r.getFullYear()%1e4,t,4)}function une(r){var t=r.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Xi(t/60|0,"0",2)+Xi(t%60,"0",2)}function oj(r,t){return Xi(r.getUTCDate(),t,2)}function hne(r,t){return Xi(r.getUTCHours(),t,2)}function dne(r,t){return Xi(r.getUTCHours()%12||12,t,2)}function fne(r,t){return Xi(1+XT.count(_m(r),r),t,3)}function D9(r,t){return Xi(r.getUTCMilliseconds(),t,3)}function pne(r,t){return D9(r,t)+"000"}function mne(r,t){return Xi(r.getUTCMonth()+1,t,2)}function gne(r,t){return Xi(r.getUTCMinutes(),t,2)}function _ne(r,t){return Xi(r.getUTCSeconds(),t,2)}function yne(r){var t=r.getUTCDay();return t===0?7:t}function vne(r,t){return Xi(WT.count(_m(r)-1,r),t,2)}function R9(r){var t=r.getUTCDay();return t>=4||t===0?Y0(r):Y0.ceil(r)}function xne(r,t){return r=R9(r),Xi(Y0.count(_m(r),r)+(_m(r).getUTCDay()===4),t,2)}function bne(r){return r.getUTCDay()}function wne(r,t){return Xi(KA.count(_m(r)-1,r),t,2)}function Ane(r,t){return Xi(r.getUTCFullYear()%100,t,2)}function Tne(r,t){return r=R9(r),Xi(r.getUTCFullYear()%100,t,2)}function Sne(r,t){return Xi(r.getUTCFullYear()%1e4,t,4)}function Ene(r,t){var o=r.getUTCDay();return r=o>=4||o===0?Y0(r):Y0.ceil(r),Xi(r.getUTCFullYear()%1e4,t,4)}function Mne(){return"+0000"}function sj(){return"%"}function lj(r){return+r}function cj(r){return Math.floor(+r/1e3)}var d0,z9,L9;One({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function One(r){return d0=Ore(r),z9=d0.format,d0.parse,L9=d0.utcFormat,d0.utcParse,d0}function Cne(r){return new Date(r)}function Ine(r){return r instanceof Date?+r:+new Date(+r)}function _R(r,t,o,l,h,v,w,a,C,I){var L=nR(),k=L.invert,G=L.domain,q=I(".%L"),Q=I(":%S"),H=I("%I:%M"),K=I("%I %p"),he=I("%a %d"),ue=I("%b %d"),me=I("%B"),ge=I("%Y");function se(fe){return(C(fe)<fe?q:a(fe)<fe?Q:w(fe)<fe?H:v(fe)<fe?K:l(fe)<fe?h(fe)<fe?he:ue:o(fe)<fe?me:ge)(fe)}return L.invert=function(fe){return new Date(k(fe))},L.domain=function(fe){return arguments.length?G(Array.from(fe,Ine)):G().map(Cne)},L.ticks=function(fe){var ve=G();return r(ve[0],ve[ve.length-1],fe??10)},L.tickFormat=function(fe,ve){return ve==null?se:I(ve)},L.nice=function(fe){var ve=G();return(!fe||typeof fe.range!="function")&&(fe=t(ve[0],ve[ve.length-1],fe??10)),fe?G(b9(ve,fe)):L},L.copy=function(){return fw(L,_R(r,t,o,l,h,v,w,a,C,I))},L}function Pne(){return Lh.apply(_R(Ere,Mre,gm,mR,ZT,pw,fR,hR,Py,z9).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Dne(){return Lh.apply(_R(Tre,Sre,_m,gR,WT,XT,pR,dR,Py,L9).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function YT(){var r=0,t=1,o,l,h,v,w=mc,a=!1,C;function I(k){return k==null||isNaN(k=+k)?C:w(h===0?.5:(k=(v(k)-o)*h,a?Math.max(0,Math.min(1,k)):k))}I.domain=function(k){return arguments.length?([r,t]=k,o=v(r=+r),l=v(t=+t),h=o===l?0:1/(l-o),I):[r,t]},I.clamp=function(k){return arguments.length?(a=!!k,I):a},I.interpolator=function(k){return arguments.length?(w=k,I):w};function L(k){return function(G){var q,Q;return arguments.length?([q,Q]=G,w=k(q,Q),I):[w(0),w(1)]}}return I.range=L(xx),I.rangeRound=L(rR),I.unknown=function(k){return arguments.length?(C=k,I):C},function(k){return v=k,o=k(r),l=k(t),h=o===l?0:1/(l-o),I}}function Jg(r,t){return t.domain(r.domain()).interpolator(r.interpolator()).clamp(r.clamp()).unknown(r.unknown())}function B9(){var r=Qg(YT()(mc));return r.copy=function(){return Jg(r,B9())},bm.apply(r,arguments)}function k9(){var r=oR(YT()).domain([1,10]);return r.copy=function(){return Jg(r,k9()).base(r.base())},bm.apply(r,arguments)}function F9(){var r=sR(YT());return r.copy=function(){return Jg(r,F9()).constant(r.constant())},bm.apply(r,arguments)}function yR(){var r=lR(YT());return r.copy=function(){return Jg(r,yR()).exponent(r.exponent())},bm.apply(r,arguments)}function Rne(){return yR.apply(null,arguments).exponent(.5)}function N9(){var r=[],t=mc;function o(l){if(l!=null&&!isNaN(l=+l))return t((hw(r,l,1)-1)/(r.length-1))}return o.domain=function(l){if(!arguments.length)return r.slice();r=[];for(let h of l)h!=null&&!isNaN(h=+h)&&r.push(h);return r.sort(qg),o},o.interpolator=function(l){return arguments.length?(t=l,o):t},o.range=function(){return r.map((l,h)=>t(h/(r.length-1)))},o.quantiles=function(l){return Array.from({length:l+1},(h,v)=>vte(r,v/l))},o.copy=function(){return N9(t).domain(r)},bm.apply(o,arguments)}function KT(){var r=0,t=.5,o=1,l=1,h,v,w,a,C,I=mc,L,k=!1,G;function q(H){return isNaN(H=+H)?G:(H=.5+((H=+L(H))-v)*(l*H<l*v?a:C),I(k?Math.max(0,Math.min(1,H)):H))}q.domain=function(H){return arguments.length?([r,t,o]=H,h=L(r=+r),v=L(t=+t),w=L(o=+o),a=h===v?0:.5/(v-h),C=v===w?0:.5/(w-v),l=v<h?-1:1,q):[r,t,o]},q.clamp=function(H){return arguments.length?(k=!!H,q):k},q.interpolator=function(H){return arguments.length?(I=H,q):I};function Q(H){return function(K){var he,ue,me;return arguments.length?([he,ue,me]=K,I=qte(H,[he,ue,me]),q):[I(0),I(.5),I(1)]}}return q.range=Q(xx),q.rangeRound=Q(rR),q.unknown=function(H){return arguments.length?(G=H,q):G},function(H){return L=H,h=H(r),v=H(t),w=H(o),a=h===v?0:.5/(v-h),C=v===w?0:.5/(w-v),l=v<h?-1:1,q}}function j9(){var r=Qg(KT()(mc));return r.copy=function(){return Jg(r,j9())},bm.apply(r,arguments)}function U9(){var r=oR(KT()).domain([.1,1,10]);return r.copy=function(){return Jg(r,U9()).base(r.base())},bm.apply(r,arguments)}function V9(){var r=sR(KT());return r.copy=function(){return Jg(r,V9()).constant(r.constant())},bm.apply(r,arguments)}function vR(){var r=lR(KT());return r.copy=function(){return Jg(r,vR()).exponent(r.exponent())},bm.apply(r,arguments)}function zne(){return vR.apply(null,arguments).exponent(.5)}const uj=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:zb,scaleDiverging:j9,scaleDivergingLog:U9,scaleDivergingPow:vR,scaleDivergingSqrt:zne,scaleDivergingSymlog:V9,scaleIdentity:x9,scaleImplicit:rP,scaleLinear:ZA,scaleLog:w9,scaleOrdinal:JD,scalePoint:fb,scalePow:cR,scaleQuantile:S9,scaleQuantize:E9,scaleRadial:T9,scaleSequential:B9,scaleSequentialLog:k9,scaleSequentialPow:yR,scaleSequentialQuantile:N9,scaleSequentialSqrt:Rne,scaleSequentialSymlog:F9,scaleSqrt:pre,scaleSymlog:A9,scaleThreshold:M9,scaleTime:Pne,scaleUtc:Dne,tickFormat:v9},Symbol.toStringTag,{value:"Module"}));var gC,hj;function QT(){if(hj)return gC;hj=1;var r=mx();function t(o,l,h){for(var v=-1,w=o.length;++v<w;){var a=o[v],C=l(a);if(C!=null&&(I===void 0?C===C&&!r(C):h(C,I)))var I=C,L=a}return L}return gC=t,gC}var _C,dj;function G9(){if(dj)return _C;dj=1;function r(t,o){return t>o}return _C=r,_C}var yC,fj;function Lne(){if(fj)return yC;fj=1;var r=QT(),t=G9(),o=vx();function l(h){return h&&h.length?r(h,o,t):void 0}return yC=l,yC}var Bne=Lne();const jg=ca(Bne);var vC,pj;function $9(){if(pj)return vC;pj=1;function r(t,o){return t<o}return vC=r,vC}var xC,mj;function kne(){if(mj)return xC;mj=1;var r=QT(),t=$9(),o=vx();function l(h){return h&&h.length?r(h,o,t):void 0}return xC=l,xC}var Fne=kne();const JT=ca(Fne);var bC,gj;function Nne(){if(gj)return bC;gj=1;var r=LD(),t=Yf(),o=QV(),l=Zc();function h(v,w){var a=l(v)?r:o;return a(v,t(w,3))}return bC=h,bC}var wC,_j;function jne(){if(_j)return wC;_j=1;var r=YV(),t=Nne();function o(l,h){return r(t(l,h),1)}return wC=o,wC}var Une=jne();const Vne=ca(Une);var AC,yj;function Gne(){if(yj)return AC;yj=1;var r=ZD();function t(o,l){return r(o,l)}return AC=t,AC}var $ne=Gne();const K0=ca($ne);var bx=1e9,qne={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},bR,ro=!0,zh="[DecimalError] ",Vy=zh+"Invalid argument: ",xR=zh+"Exponent out of range: ",wx=Math.floor,Sy=Math.pow,Hne=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Bu,$s=1e7,qa=7,q9=9007199254740991,QA=wx(q9/qa),Wr={};Wr.absoluteValue=Wr.abs=function(){var r=new this.constructor(this);return r.s&&(r.s=1),r};Wr.comparedTo=Wr.cmp=function(r){var t,o,l,h,v=this;if(r=new v.constructor(r),v.s!==r.s)return v.s||-r.s;if(v.e!==r.e)return v.e>r.e^v.s<0?1:-1;for(l=v.d.length,h=r.d.length,t=0,o=l<h?l:h;t<o;++t)if(v.d[t]!==r.d[t])return v.d[t]>r.d[t]^v.s<0?1:-1;return l===h?0:l>h^v.s<0?1:-1};Wr.decimalPlaces=Wr.dp=function(){var r=this,t=r.d.length-1,o=(t-r.e)*qa;if(t=r.d[t],t)for(;t%10==0;t/=10)o--;return o<0?0:o};Wr.dividedBy=Wr.div=function(r){return um(this,new this.constructor(r))};Wr.dividedToIntegerBy=Wr.idiv=function(r){var t=this,o=t.constructor;return Ta(um(t,new o(r),0,1),o.precision)};Wr.equals=Wr.eq=function(r){return!this.cmp(r)};Wr.exponent=function(){return is(this)};Wr.greaterThan=Wr.gt=function(r){return this.cmp(r)>0};Wr.greaterThanOrEqualTo=Wr.gte=function(r){return this.cmp(r)>=0};Wr.isInteger=Wr.isint=function(){return this.e>this.d.length-2};Wr.isNegative=Wr.isneg=function(){return this.s<0};Wr.isPositive=Wr.ispos=function(){return this.s>0};Wr.isZero=function(){return this.s===0};Wr.lessThan=Wr.lt=function(r){return this.cmp(r)<0};Wr.lessThanOrEqualTo=Wr.lte=function(r){return this.cmp(r)<1};Wr.logarithm=Wr.log=function(r){var t,o=this,l=o.constructor,h=l.precision,v=h+5;if(r===void 0)r=new l(10);else if(r=new l(r),r.s<1||r.eq(Bu))throw Error(zh+"NaN");if(o.s<1)throw Error(zh+(o.s?"NaN":"-Infinity"));return o.eq(Bu)?new l(0):(ro=!1,t=um(Nb(o,v),Nb(r,v),v),ro=!0,Ta(t,h))};Wr.minus=Wr.sub=function(r){var t=this;return r=new t.constructor(r),t.s==r.s?Z9(t,r):H9(t,(r.s=-r.s,r))};Wr.modulo=Wr.mod=function(r){var t,o=this,l=o.constructor,h=l.precision;if(r=new l(r),!r.s)throw Error(zh+"NaN");return o.s?(ro=!1,t=um(o,r,0,1).times(r),ro=!0,o.minus(t)):Ta(new l(o),h)};Wr.naturalExponential=Wr.exp=function(){return X9(this)};Wr.naturalLogarithm=Wr.ln=function(){return Nb(this)};Wr.negated=Wr.neg=function(){var r=new this.constructor(this);return r.s=-r.s||0,r};Wr.plus=Wr.add=function(r){var t=this;return r=new t.constructor(r),t.s==r.s?H9(t,r):Z9(t,(r.s=-r.s,r))};Wr.precision=Wr.sd=function(r){var t,o,l,h=this;if(r!==void 0&&r!==!!r&&r!==1&&r!==0)throw Error(Vy+r);if(t=is(h)+1,l=h.d.length-1,o=l*qa+1,l=h.d[l],l){for(;l%10==0;l/=10)o--;for(l=h.d[0];l>=10;l/=10)o++}return r&&t>o?t:o};Wr.squareRoot=Wr.sqrt=function(){var r,t,o,l,h,v,w,a=this,C=a.constructor;if(a.s<1){if(!a.s)return new C(0);throw Error(zh+"NaN")}for(r=is(a),ro=!1,h=Math.sqrt(+a),h==0||h==1/0?(t=Uf(a.d),(t.length+r)%2==0&&(t+="0"),h=Math.sqrt(t),r=wx((r+1)/2)-(r<0||r%2),h==1/0?t="5e"+r:(t=h.toExponential(),t=t.slice(0,t.indexOf("e")+1)+r),l=new C(t)):l=new C(h.toString()),o=C.precision,h=w=o+3;;)if(v=l,l=v.plus(um(a,v,w+2)).times(.5),Uf(v.d).slice(0,w)===(t=Uf(l.d)).slice(0,w)){if(t=t.slice(w-3,w+1),h==w&&t=="4999"){if(Ta(v,o+1,0),v.times(v).eq(a)){l=v;break}}else if(t!="9999")break;w+=4}return ro=!0,Ta(l,o)};Wr.times=Wr.mul=function(r){var t,o,l,h,v,w,a,C,I,L=this,k=L.constructor,G=L.d,q=(r=new k(r)).d;if(!L.s||!r.s)return new k(0);for(r.s*=L.s,o=L.e+r.e,C=G.length,I=q.length,C<I&&(v=G,G=q,q=v,w=C,C=I,I=w),v=[],w=C+I,l=w;l--;)v.push(0);for(l=I;--l>=0;){for(t=0,h=C+l;h>l;)a=v[h]+q[l]*G[h-l-1]+t,v[h--]=a%$s|0,t=a/$s|0;v[h]=(v[h]+t)%$s|0}for(;!v[--w];)v.pop();return t?++o:v.shift(),r.d=v,r.e=o,ro?Ta(r,k.precision):r};Wr.toDecimalPlaces=Wr.todp=function(r,t){var o=this,l=o.constructor;return o=new l(o),r===void 0?o:(Xf(r,0,bx),t===void 0?t=l.rounding:Xf(t,0,8),Ta(o,r+is(o)+1,t))};Wr.toExponential=function(r,t){var o,l=this,h=l.constructor;return r===void 0?o=Ky(l,!0):(Xf(r,0,bx),t===void 0?t=h.rounding:Xf(t,0,8),l=Ta(new h(l),r+1,t),o=Ky(l,!0,r+1)),o};Wr.toFixed=function(r,t){var o,l,h=this,v=h.constructor;return r===void 0?Ky(h):(Xf(r,0,bx),t===void 0?t=v.rounding:Xf(t,0,8),l=Ta(new v(h),r+is(h)+1,t),o=Ky(l.abs(),!1,r+is(l)+1),h.isneg()&&!h.isZero()?"-"+o:o)};Wr.toInteger=Wr.toint=function(){var r=this,t=r.constructor;return Ta(new t(r),is(r)+1,t.rounding)};Wr.toNumber=function(){return+this};Wr.toPower=Wr.pow=function(r){var t,o,l,h,v,w,a=this,C=a.constructor,I=12,L=+(r=new C(r));if(!r.s)return new C(Bu);if(a=new C(a),!a.s){if(r.s<1)throw Error(zh+"Infinity");return a}if(a.eq(Bu))return a;if(l=C.precision,r.eq(Bu))return Ta(a,l);if(t=r.e,o=r.d.length-1,w=t>=o,v=a.s,w){if((o=L<0?-L:L)<=q9){for(h=new C(Bu),t=Math.ceil(l/qa+4),ro=!1;o%2&&(h=h.times(a),xj(h.d,t)),o=wx(o/2),o!==0;)a=a.times(a),xj(a.d,t);return ro=!0,r.s<0?new C(Bu).div(h):Ta(h,l)}}else if(v<0)throw Error(zh+"NaN");return v=v<0&&r.d[Math.max(t,o)]&1?-1:1,a.s=1,ro=!1,h=r.times(Nb(a,l+I)),ro=!0,h=X9(h),h.s=v,h};Wr.toPrecision=function(r,t){var o,l,h=this,v=h.constructor;return r===void 0?(o=is(h),l=Ky(h,o<=v.toExpNeg||o>=v.toExpPos)):(Xf(r,1,bx),t===void 0?t=v.rounding:Xf(t,0,8),h=Ta(new v(h),r,t),o=is(h),l=Ky(h,r<=o||o<=v.toExpNeg,r)),l};Wr.toSignificantDigits=Wr.tosd=function(r,t){var o=this,l=o.constructor;return r===void 0?(r=l.precision,t=l.rounding):(Xf(r,1,bx),t===void 0?t=l.rounding:Xf(t,0,8)),Ta(new l(o),r,t)};Wr.toString=Wr.valueOf=Wr.val=Wr.toJSON=Wr[Symbol.for("nodejs.util.inspect.custom")]=function(){var r=this,t=is(r),o=r.constructor;return Ky(r,t<=o.toExpNeg||t>=o.toExpPos)};function H9(r,t){var o,l,h,v,w,a,C,I,L=r.constructor,k=L.precision;if(!r.s||!t.s)return t.s||(t=new L(r)),ro?Ta(t,k):t;if(C=r.d,I=t.d,w=r.e,h=t.e,C=C.slice(),v=w-h,v){for(v<0?(l=C,v=-v,a=I.length):(l=I,h=w,a=C.length),w=Math.ceil(k/qa),a=w>a?w+1:a+1,v>a&&(v=a,l.length=1),l.reverse();v--;)l.push(0);l.reverse()}for(a=C.length,v=I.length,a-v<0&&(v=a,l=I,I=C,C=l),o=0;v;)o=(C[--v]=C[v]+I[v]+o)/$s|0,C[v]%=$s;for(o&&(C.unshift(o),++h),a=C.length;C[--a]==0;)C.pop();return t.d=C,t.e=h,ro?Ta(t,k):t}function Xf(r,t,o){if(r!==~~r||r<t||r>o)throw Error(Vy+r)}function Uf(r){var t,o,l,h=r.length-1,v="",w=r[0];if(h>0){for(v+=w,t=1;t<h;t++)l=r[t]+"",o=qa-l.length,o&&(v+=Rg(o)),v+=l;w=r[t],l=w+"",o=qa-l.length,o&&(v+=Rg(o))}else if(w===0)return"0";for(;w%10===0;)w/=10;return v+w}var um=(function(){function r(l,h){var v,w=0,a=l.length;for(l=l.slice();a--;)v=l[a]*h+w,l[a]=v%$s|0,w=v/$s|0;return w&&l.unshift(w),l}function t(l,h,v,w){var a,C;if(v!=w)C=v>w?1:-1;else for(a=C=0;a<v;a++)if(l[a]!=h[a]){C=l[a]>h[a]?1:-1;break}return C}function o(l,h,v){for(var w=0;v--;)l[v]-=w,w=l[v]<h[v]?1:0,l[v]=w*$s+l[v]-h[v];for(;!l[0]&&l.length>1;)l.shift()}return function(l,h,v,w){var a,C,I,L,k,G,q,Q,H,K,he,ue,me,ge,se,fe,ve,Le,Ue=l.constructor,tt=l.s==h.s?1:-1,Ke=l.d,nt=h.d;if(!l.s)return new Ue(l);if(!h.s)throw Error(zh+"Division by zero");for(C=l.e-h.e,ve=nt.length,se=Ke.length,q=new Ue(tt),Q=q.d=[],I=0;nt[I]==(Ke[I]||0);)++I;if(nt[I]>(Ke[I]||0)&&--C,v==null?ue=v=Ue.precision:w?ue=v+(is(l)-is(h))+1:ue=v,ue<0)return new Ue(0);if(ue=ue/qa+2|0,I=0,ve==1)for(L=0,nt=nt[0],ue++;(I<se||L)&&ue--;I++)me=L*$s+(Ke[I]||0),Q[I]=me/nt|0,L=me%nt|0;else{for(L=$s/(nt[0]+1)|0,L>1&&(nt=r(nt,L),Ke=r(Ke,L),ve=nt.length,se=Ke.length),ge=ve,H=Ke.slice(0,ve),K=H.length;K<ve;)H[K++]=0;Le=nt.slice(),Le.unshift(0),fe=nt[0],nt[1]>=$s/2&&++fe;do L=0,a=t(nt,H,ve,K),a<0?(he=H[0],ve!=K&&(he=he*$s+(H[1]||0)),L=he/fe|0,L>1?(L>=$s&&(L=$s-1),k=r(nt,L),G=k.length,K=H.length,a=t(k,H,G,K),a==1&&(L--,o(k,ve<G?Le:nt,G))):(L==0&&(a=L=1),k=nt.slice()),G=k.length,G<K&&k.unshift(0),o(H,k,K),a==-1&&(K=H.length,a=t(nt,H,ve,K),a<1&&(L++,o(H,ve<K?Le:nt,K))),K=H.length):a===0&&(L++,H=[0]),Q[I++]=L,a&&H[0]?H[K++]=Ke[ge]||0:(H=[Ke[ge]],K=1);while((ge++<se||H[0]!==void 0)&&ue--)}return Q[0]||Q.shift(),q.e=C,Ta(q,w?v+is(q)+1:v)}})();function X9(r,t){var o,l,h,v,w,a,C=0,I=0,L=r.constructor,k=L.precision;if(is(r)>16)throw Error(xR+is(r));if(!r.s)return new L(Bu);for(ro=!1,a=k,w=new L(.03125);r.abs().gte(.1);)r=r.times(w),I+=5;for(l=Math.log(Sy(2,I))/Math.LN10*2+5|0,a+=l,o=h=v=new L(Bu),L.precision=a;;){if(h=Ta(h.times(r),a),o=o.times(++C),w=v.plus(um(h,o,a)),Uf(w.d).slice(0,a)===Uf(v.d).slice(0,a)){for(;I--;)v=Ta(v.times(v),a);return L.precision=k,t==null?(ro=!0,Ta(v,k)):v}v=w}}function is(r){for(var t=r.e*qa,o=r.d[0];o>=10;o/=10)t++;return t}function TC(r,t,o){if(t>r.LN10.sd())throw ro=!0,o&&(r.precision=o),Error(zh+"LN10 precision limit exceeded");return Ta(new r(r.LN10),t)}function Rg(r){for(var t="";r--;)t+="0";return t}function Nb(r,t){var o,l,h,v,w,a,C,I,L,k=1,G=10,q=r,Q=q.d,H=q.constructor,K=H.precision;if(q.s<1)throw Error(zh+(q.s?"NaN":"-Infinity"));if(q.eq(Bu))return new H(0);if(t==null?(ro=!1,I=K):I=t,q.eq(10))return t==null&&(ro=!0),TC(H,I);if(I+=G,H.precision=I,o=Uf(Q),l=o.charAt(0),v=is(q),Math.abs(v)<15e14){for(;l<7&&l!=1||l==1&&o.charAt(1)>3;)q=q.times(r),o=Uf(q.d),l=o.charAt(0),k++;v=is(q),l>1?(q=new H("0."+o),v++):q=new H(l+"."+o.slice(1))}else return C=TC(H,I+2,K).times(v+""),q=Nb(new H(l+"."+o.slice(1)),I-G).plus(C),H.precision=K,t==null?(ro=!0,Ta(q,K)):q;for(a=w=q=um(q.minus(Bu),q.plus(Bu),I),L=Ta(q.times(q),I),h=3;;){if(w=Ta(w.times(L),I),C=a.plus(um(w,new H(h),I)),Uf(C.d).slice(0,I)===Uf(a.d).slice(0,I))return a=a.times(2),v!==0&&(a=a.plus(TC(H,I+2,K).times(v+""))),a=um(a,new H(k),I),H.precision=K,t==null?(ro=!0,Ta(a,K)):a;a=C,h+=2}}function vj(r,t){var o,l,h;for((o=t.indexOf("."))>-1&&(t=t.replace(".","")),(l=t.search(/e/i))>0?(o<0&&(o=l),o+=+t.slice(l+1),t=t.substring(0,l)):o<0&&(o=t.length),l=0;t.charCodeAt(l)===48;)++l;for(h=t.length;t.charCodeAt(h-1)===48;)--h;if(t=t.slice(l,h),t){if(h-=l,o=o-l-1,r.e=wx(o/qa),r.d=[],l=(o+1)%qa,o<0&&(l+=qa),l<h){for(l&&r.d.push(+t.slice(0,l)),h-=qa;l<h;)r.d.push(+t.slice(l,l+=qa));t=t.slice(l),l=qa-t.length}else l-=h;for(;l--;)t+="0";if(r.d.push(+t),ro&&(r.e>QA||r.e<-QA))throw Error(xR+o)}else r.s=0,r.e=0,r.d=[0];return r}function Ta(r,t,o){var l,h,v,w,a,C,I,L,k=r.d;for(w=1,v=k[0];v>=10;v/=10)w++;if(l=t-w,l<0)l+=qa,h=t,I=k[L=0];else{if(L=Math.ceil((l+1)/qa),v=k.length,L>=v)return r;for(I=v=k[L],w=1;v>=10;v/=10)w++;l%=qa,h=l-qa+w}if(o!==void 0&&(v=Sy(10,w-h-1),a=I/v%10|0,C=t<0||k[L+1]!==void 0||I%v,C=o<4?(a||C)&&(o==0||o==(r.s<0?3:2)):a>5||a==5&&(o==4||C||o==6&&(l>0?h>0?I/Sy(10,w-h):0:k[L-1])%10&1||o==(r.s<0?8:7))),t<1||!k[0])return C?(v=is(r),k.length=1,t=t-v-1,k[0]=Sy(10,(qa-t%qa)%qa),r.e=wx(-t/qa)||0):(k.length=1,k[0]=r.e=r.s=0),r;if(l==0?(k.length=L,v=1,L--):(k.length=L+1,v=Sy(10,qa-l),k[L]=h>0?(I/Sy(10,w-h)%Sy(10,h)|0)*v:0),C)for(;;)if(L==0){(k[0]+=v)==$s&&(k[0]=1,++r.e);break}else{if(k[L]+=v,k[L]!=$s)break;k[L--]=0,v=1}for(l=k.length;k[--l]===0;)k.pop();if(ro&&(r.e>QA||r.e<-QA))throw Error(xR+is(r));return r}function Z9(r,t){var o,l,h,v,w,a,C,I,L,k,G=r.constructor,q=G.precision;if(!r.s||!t.s)return t.s?t.s=-t.s:t=new G(r),ro?Ta(t,q):t;if(C=r.d,k=t.d,l=t.e,I=r.e,C=C.slice(),w=I-l,w){for(L=w<0,L?(o=C,w=-w,a=k.length):(o=k,l=I,a=C.length),h=Math.max(Math.ceil(q/qa),a)+2,w>h&&(w=h,o.length=1),o.reverse(),h=w;h--;)o.push(0);o.reverse()}else{for(h=C.length,a=k.length,L=h<a,L&&(a=h),h=0;h<a;h++)if(C[h]!=k[h]){L=C[h]<k[h];break}w=0}for(L&&(o=C,C=k,k=o,t.s=-t.s),a=C.length,h=k.length-a;h>0;--h)C[a++]=0;for(h=k.length;h>w;){if(C[--h]<k[h]){for(v=h;v&&C[--v]===0;)C[v]=$s-1;--C[v],C[h]+=$s}C[h]-=k[h]}for(;C[--a]===0;)C.pop();for(;C[0]===0;C.shift())--l;return C[0]?(t.d=C,t.e=l,ro?Ta(t,q):t):new G(0)}function Ky(r,t,o){var l,h=is(r),v=Uf(r.d),w=v.length;return t?(o&&(l=o-w)>0?v=v.charAt(0)+"."+v.slice(1)+Rg(l):w>1&&(v=v.charAt(0)+"."+v.slice(1)),v=v+(h<0?"e":"e+")+h):h<0?(v="0."+Rg(-h-1)+v,o&&(l=o-w)>0&&(v+=Rg(l))):h>=w?(v+=Rg(h+1-w),o&&(l=o-h-1)>0&&(v=v+"."+Rg(l))):((l=h+1)<w&&(v=v.slice(0,l)+"."+v.slice(l)),o&&(l=o-w)>0&&(h+1===w&&(v+="."),v+=Rg(l))),r.s<0?"-"+v:v}function xj(r,t){if(r.length>t)return r.length=t,!0}function W9(r){var t,o,l;function h(v){var w=this;if(!(w instanceof h))return new h(v);if(w.constructor=h,v instanceof h){w.s=v.s,w.e=v.e,w.d=(v=v.d)?v.slice():v;return}if(typeof v=="number"){if(v*0!==0)throw Error(Vy+v);if(v>0)w.s=1;else if(v<0)v=-v,w.s=-1;else{w.s=0,w.e=0,w.d=[0];return}if(v===~~v&&v<1e7){w.e=0,w.d=[v];return}return vj(w,v.toString())}else if(typeof v!="string")throw Error(Vy+v);if(v.charCodeAt(0)===45?(v=v.slice(1),w.s=-1):w.s=1,Hne.test(v))vj(w,v);else throw Error(Vy+v)}if(h.prototype=Wr,h.ROUND_UP=0,h.ROUND_DOWN=1,h.ROUND_CEIL=2,h.ROUND_FLOOR=3,h.ROUND_HALF_UP=4,h.ROUND_HALF_DOWN=5,h.ROUND_HALF_EVEN=6,h.ROUND_HALF_CEIL=7,h.ROUND_HALF_FLOOR=8,h.clone=W9,h.config=h.set=Xne,r===void 0&&(r={}),r)for(l=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<l.length;)r.hasOwnProperty(o=l[t++])||(r[o]=this[o]);return h.config(r),h}function Xne(r){if(!r||typeof r!="object")throw Error(zh+"Object expected");var t,o,l,h=["precision",1,bx,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<h.length;t+=3)if((l=r[o=h[t]])!==void 0)if(wx(l)===l&&l>=h[t+1]&&l<=h[t+2])this[o]=l;else throw Error(Vy+o+": "+l);if((l=r[o="LN10"])!==void 0)if(l==Math.LN10)this[o]=new this(l);else throw Error(Vy+o+": "+l);return this}var bR=W9(qne);Bu=new bR(1);const ma=bR;function Zne(r){return Qne(r)||Kne(r)||Yne(r)||Wne()}function Wne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yne(r,t){if(r){if(typeof r=="string")return oP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return oP(r,t)}}function Kne(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function Qne(r){if(Array.isArray(r))return oP(r)}function oP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}var Jne=function(t){return t},Y9={},K9=function(t){return t===Y9},bj=function(t){return function o(){return arguments.length===0||arguments.length===1&&K9(arguments.length<=0?void 0:arguments[0])?o:t.apply(void 0,arguments)}},eie=function r(t,o){return t===1?o:bj(function(){for(var l=arguments.length,h=new Array(l),v=0;v<l;v++)h[v]=arguments[v];var w=h.filter(function(a){return a!==Y9}).length;return w>=t?o.apply(void 0,h):r(t-w,bj(function(){for(var a=arguments.length,C=new Array(a),I=0;I<a;I++)C[I]=arguments[I];var L=h.map(function(k){return K9(k)?C.shift():k});return o.apply(void 0,Zne(L).concat(C))}))})},eS=function(t){return eie(t.length,t)},sP=function(t,o){for(var l=[],h=t;h<o;++h)l[h-t]=h;return l},tie=eS(function(r,t){return Array.isArray(t)?t.map(r):Object.keys(t).map(function(o){return t[o]}).map(r)}),rie=function(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];if(!o.length)return Jne;var h=o.reverse(),v=h[0],w=h.slice(1);return function(){return w.reduce(function(a,C){return C(a)},v.apply(void 0,arguments))}},lP=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Q9=function(t){var o=null,l=null;return function(){for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return o&&v.every(function(a,C){return a===o[C]})||(o=v,l=t.apply(void 0,v)),l}};function nie(r){var t;return r===0?t=1:t=Math.floor(new ma(r).abs().log(10).toNumber())+1,t}function iie(r,t,o){for(var l=new ma(r),h=0,v=[];l.lt(t)&&h<1e5;)v.push(l.toNumber()),l=l.add(o),h++;return v}var aie=eS(function(r,t,o){var l=+r,h=+t;return l+o*(h-l)}),oie=eS(function(r,t,o){var l=t-+r;return l=l||1/0,(o-r)/l}),sie=eS(function(r,t,o){var l=t-+r;return l=l||1/0,Math.max(0,Math.min(1,(o-r)/l))});const tS={rangeStep:iie,getDigitCount:nie,interpolateNumber:aie,uninterpolateNumber:oie,uninterpolateTruncation:sie};function cP(r){return uie(r)||cie(r)||J9(r)||lie()}function lie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cie(r){if(typeof Symbol<"u"&&Symbol.iterator in Object(r))return Array.from(r)}function uie(r){if(Array.isArray(r))return uP(r)}function jb(r,t){return fie(r)||die(r,t)||J9(r,t)||hie()}function hie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function J9(r,t){if(r){if(typeof r=="string")return uP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return uP(r,t)}}function uP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function die(r,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(r)))){var o=[],l=!0,h=!1,v=void 0;try{for(var w=r[Symbol.iterator](),a;!(l=(a=w.next()).done)&&(o.push(a.value),!(t&&o.length===t));l=!0);}catch(C){h=!0,v=C}finally{try{!l&&w.return!=null&&w.return()}finally{if(h)throw v}}return o}}function fie(r){if(Array.isArray(r))return r}function e7(r){var t=jb(r,2),o=t[0],l=t[1],h=o,v=l;return o>l&&(h=l,v=o),[h,v]}function t7(r,t,o){if(r.lte(0))return new ma(0);var l=tS.getDigitCount(r.toNumber()),h=new ma(10).pow(l),v=r.div(h),w=l!==1?.05:.1,a=new ma(Math.ceil(v.div(w).toNumber())).add(o).mul(w),C=a.mul(h);return t?C:new ma(Math.ceil(C))}function pie(r,t,o){var l=1,h=new ma(r);if(!h.isint()&&o){var v=Math.abs(r);v<1?(l=new ma(10).pow(tS.getDigitCount(r)-1),h=new ma(Math.floor(h.div(l).toNumber())).mul(l)):v>1&&(h=new ma(Math.floor(r)))}else r===0?h=new ma(Math.floor((t-1)/2)):o||(h=new ma(Math.floor(r)));var w=Math.floor((t-1)/2),a=rie(tie(function(C){return h.add(new ma(C-w).mul(l)).toNumber()}),sP);return a(0,t)}function r7(r,t,o,l){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-r)/(o-1)))return{step:new ma(0),tickMin:new ma(0),tickMax:new ma(0)};var v=t7(new ma(t).sub(r).div(o-1),l,h),w;r<=0&&t>=0?w=new ma(0):(w=new ma(r).add(t).div(2),w=w.sub(new ma(w).mod(v)));var a=Math.ceil(w.sub(r).div(v).toNumber()),C=Math.ceil(new ma(t).sub(w).div(v).toNumber()),I=a+C+1;return I>o?r7(r,t,o,l,h+1):(I<o&&(C=t>0?C+(o-I):C,a=t>0?a:a+(o-I)),{step:v,tickMin:w.sub(new ma(a).mul(v)),tickMax:w.add(new ma(C).mul(v))})}function mie(r){var t=jb(r,2),o=t[0],l=t[1],h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,w=Math.max(h,2),a=e7([o,l]),C=jb(a,2),I=C[0],L=C[1];if(I===-1/0||L===1/0){var k=L===1/0?[I].concat(cP(sP(0,h-1).map(function(){return 1/0}))):[].concat(cP(sP(0,h-1).map(function(){return-1/0})),[L]);return o>l?lP(k):k}if(I===L)return pie(I,h,v);var G=r7(I,L,w,v),q=G.step,Q=G.tickMin,H=G.tickMax,K=tS.rangeStep(Q,H.add(new ma(.1).mul(q)),q);return o>l?lP(K):K}function gie(r,t){var o=jb(r,2),l=o[0],h=o[1],v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,w=e7([l,h]),a=jb(w,2),C=a[0],I=a[1];if(C===-1/0||I===1/0)return[l,h];if(C===I)return[C];var L=Math.max(t,2),k=t7(new ma(I).sub(C).div(L-1),v,0),G=[].concat(cP(tS.rangeStep(new ma(C),new ma(I).sub(new ma(.99).mul(k)),k)),[I]);return l>h?lP(G):G}var _ie=Q9(mie),yie=Q9(gie),vie="Invariant failed";function Qy(r,t){throw new Error(vie)}var xie=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Q0(r){"@babel/helpers - typeof";return Q0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q0(r)}function JA(){return JA=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},JA.apply(this,arguments)}function bie(r,t){return Sie(r)||Tie(r,t)||Aie(r,t)||wie()}function wie(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aie(r,t){if(r){if(typeof r=="string")return wj(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return wj(r,t)}}function wj(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Tie(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function Sie(r){if(Array.isArray(r))return r}function Eie(r,t){if(r==null)return{};var o=Mie(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Mie(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function Oie(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Cie(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,a7(l.key),l)}}function Iie(r,t,o){return t&&Cie(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Pie(r,t,o){return t=eT(t),Die(r,n7()?Reflect.construct(t,o||[],eT(r).constructor):t.apply(r,o))}function Die(r,t){if(t&&(Q0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rie(r)}function Rie(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function n7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(n7=function(){return!!r})()}function eT(r){return eT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},eT(r)}function zie(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&hP(r,t)}function hP(r,t){return hP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},hP(r,t)}function i7(r,t,o){return t=a7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function a7(r){var t=Lie(r,"string");return Q0(t)=="symbol"?t:t+""}function Lie(r,t){if(Q0(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Q0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var rS=(function(r){function t(){return Oie(this,t),Pie(this,t,arguments)}return zie(t,r),Iie(t,[{key:"render",value:function(){var l=this.props,h=l.offset,v=l.layout,w=l.width,a=l.dataKey,C=l.data,I=l.dataPointFormatter,L=l.xAxis,k=l.yAxis,G=Eie(l,xie),q=xn(G,!1);this.props.direction==="x"&&L.type!=="number"&&Qy();var Q=C.map(function(H){var K=I(H,a),he=K.x,ue=K.y,me=K.value,ge=K.errorVal;if(!ge)return null;var se=[],fe,ve;if(Array.isArray(ge)){var Le=bie(ge,2);fe=Le[0],ve=Le[1]}else fe=ve=ge;if(v==="vertical"){var Ue=L.scale,tt=ue+h,Ke=tt+w,nt=tt-w,st=Ue(me-fe),Rt=Ue(me+ve);se.push({x1:Rt,y1:Ke,x2:Rt,y2:nt}),se.push({x1:st,y1:tt,x2:Rt,y2:tt}),se.push({x1:st,y1:Ke,x2:st,y2:nt})}else if(v==="horizontal"){var Mt=k.scale,$e=he+h,rt=$e-w,Ct=$e+w,Kt=Mt(me-fe),Je=Mt(me+ve);se.push({x1:rt,y1:Je,x2:Ct,y2:Je}),se.push({x1:$e,y1:Kt,x2:$e,y2:Je}),se.push({x1:rt,y1:Kt,x2:Ct,y2:Kt})}return ft.createElement(Gi,JA({className:"recharts-errorBar",key:"bar-".concat(se.map(function(Ze){return"".concat(Ze.x1,"-").concat(Ze.x2,"-").concat(Ze.y1,"-").concat(Ze.y2)}))},q),se.map(function(Ze){return ft.createElement("line",JA({},Ze,{key:"line-".concat(Ze.x1,"-").concat(Ze.x2,"-").concat(Ze.y1,"-").concat(Ze.y2)}))}))});return ft.createElement(Gi,{className:"recharts-errorBars"},Q)}}])})(ft.Component);i7(rS,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});i7(rS,"displayName","ErrorBar");function Ub(r){"@babel/helpers - typeof";return Ub=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ub(r)}function Aj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function yy(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Aj(Object(o),!0).forEach(function(l){Bie(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Aj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Bie(r,t,o){return t=kie(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function kie(r){var t=Fie(r,"string");return Ub(t)=="symbol"?t:t+""}function Fie(r,t){if(Ub(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Ub(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var o7=function(t){var o=t.children,l=t.formattedGraphicalItems,h=t.legendWidth,v=t.legendContent,w=Iu(o,D0);if(!w)return null;var a=D0.defaultProps,C=a!==void 0?yy(yy({},a),w.props):{},I;return w.props&&w.props.payload?I=w.props&&w.props.payload:v==="children"?I=(l||[]).reduce(function(L,k){var G=k.item,q=k.props,Q=q.sectors||q.data||[];return L.concat(Q.map(function(H){return{type:w.props.iconType||G.props.legendType,value:H.name,color:H.fill,payload:H}}))},[]):I=(l||[]).map(function(L){var k=L.item,G=k.type.defaultProps,q=G!==void 0?yy(yy({},G),k.props):{},Q=q.dataKey,H=q.name,K=q.legendType,he=q.hide;return{inactive:he,dataKey:Q,type:C.iconType||K||"square",color:wR(k),value:H||Q,payload:q}}),yy(yy(yy({},C),D0.getWithHeight(w,h)),{},{payload:I,item:w})};function Vb(r){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(r)}function Tj(r){return Vie(r)||Uie(r)||jie(r)||Nie()}function Nie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jie(r,t){if(r){if(typeof r=="string")return dP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return dP(r,t)}}function Uie(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Vie(r){if(Array.isArray(r))return dP(r)}function dP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Sj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Oo(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Sj(Object(o),!0).forEach(function(l){z0(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Sj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function z0(r,t,o){return t=Gie(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Gie(r){var t=$ie(r,"string");return Vb(t)=="symbol"?t:t+""}function $ie(r,t){if(Vb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Vb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Es(r,t,o){return ei(r)||ei(t)?o:Ms(t)?ju(r,t,o):Bn(t)?t(r):o}function pb(r,t,o,l){var h=Vne(r,function(a){return Es(a,t)});if(o==="number"){var v=h.filter(function(a){return Ar(a)||parseFloat(a)});return v.length?[JT(v),jg(v)]:[1/0,-1/0]}var w=l?h.filter(function(a){return!ei(a)}):h;return w.map(function(a){return Ms(a)||a instanceof Date?a:""})}var qie=function(t){var o,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],h=arguments.length>2?arguments[2]:void 0,v=arguments.length>3?arguments[3]:void 0,w=-1,a=(o=l?.length)!==null&&o!==void 0?o:0;if(a<=1)return 0;if(v&&v.axisType==="angleAxis"&&Math.abs(Math.abs(v.range[1]-v.range[0])-360)<=1e-6)for(var C=v.range,I=0;I<a;I++){var L=I>0?h[I-1].coordinate:h[a-1].coordinate,k=h[I].coordinate,G=I>=a-1?h[0].coordinate:h[I+1].coordinate,q=void 0;if(fc(k-L)!==fc(G-k)){var Q=[];if(fc(G-k)===fc(C[1]-C[0])){q=G;var H=k+C[1]-C[0];Q[0]=Math.min(H,(H+L)/2),Q[1]=Math.max(H,(H+L)/2)}else{q=L;var K=G+C[1]-C[0];Q[0]=Math.min(k,(K+k)/2),Q[1]=Math.max(k,(K+k)/2)}var he=[Math.min(k,(q+k)/2),Math.max(k,(q+k)/2)];if(t>he[0]&&t<=he[1]||t>=Q[0]&&t<=Q[1]){w=h[I].index;break}}else{var ue=Math.min(L,G),me=Math.max(L,G);if(t>(ue+k)/2&&t<=(me+k)/2){w=h[I].index;break}}}else for(var ge=0;ge<a;ge++)if(ge===0&&t<=(l[ge].coordinate+l[ge+1].coordinate)/2||ge>0&&ge<a-1&&t>(l[ge].coordinate+l[ge-1].coordinate)/2&&t<=(l[ge].coordinate+l[ge+1].coordinate)/2||ge===a-1&&t>(l[ge].coordinate+l[ge-1].coordinate)/2){w=l[ge].index;break}return w},wR=function(t){var o,l=t,h=l.type.displayName,v=(o=t.type)!==null&&o!==void 0&&o.defaultProps?Oo(Oo({},t.type.defaultProps),t.props):t.props,w=v.stroke,a=v.fill,C;switch(h){case"Line":C=w;break;case"Area":case"Radar":C=w&&w!=="none"?w:a;break;default:C=a;break}return C},Hie=function(t){var o=t.barSize,l=t.totalSize,h=t.stackGroups,v=h===void 0?{}:h;if(!v)return{};for(var w={},a=Object.keys(v),C=0,I=a.length;C<I;C++)for(var L=v[a[C]].stackGroups,k=Object.keys(L),G=0,q=k.length;G<q;G++){var Q=L[k[G]],H=Q.items,K=Q.cateAxisId,he=H.filter(function(ve){return cm(ve.type).indexOf("Bar")>=0});if(he&&he.length){var ue=he[0].type.defaultProps,me=ue!==void 0?Oo(Oo({},ue),he[0].props):he[0].props,ge=me.barSize,se=me[K];w[se]||(w[se]=[]);var fe=ei(ge)?o:ge;w[se].push({item:he[0],stackList:he.slice(1),barSize:ei(fe)?void 0:pc(fe,l,0)})}}return w},Xie=function(t){var o=t.barGap,l=t.barCategoryGap,h=t.bandSize,v=t.sizeList,w=v===void 0?[]:v,a=t.maxBarSize,C=w.length;if(C<1)return null;var I=pc(o,h,0,!0),L,k=[];if(w[0].barSize===+w[0].barSize){var G=!1,q=h/C,Q=w.reduce(function(ge,se){return ge+se.barSize||0},0);Q+=(C-1)*I,Q>=h&&(Q-=(C-1)*I,I=0),Q>=h&&q>0&&(G=!0,q*=.9,Q=C*q);var H=(h-Q)/2>>0,K={offset:H-I,size:0};L=w.reduce(function(ge,se){var fe={item:se.item,position:{offset:K.offset+K.size+I,size:G?q:se.barSize}},ve=[].concat(Tj(ge),[fe]);return K=ve[ve.length-1].position,se.stackList&&se.stackList.length&&se.stackList.forEach(function(Le){ve.push({item:Le,position:K})}),ve},k)}else{var he=pc(l,h,0,!0);h-2*he-(C-1)*I<=0&&(I=0);var ue=(h-2*he-(C-1)*I)/C;ue>1&&(ue>>=0);var me=a===+a?Math.min(ue,a):ue;L=w.reduce(function(ge,se,fe){var ve=[].concat(Tj(ge),[{item:se.item,position:{offset:he+(ue+I)*fe+(ue-me)/2,size:me}}]);return se.stackList&&se.stackList.length&&se.stackList.forEach(function(Le){ve.push({item:Le,position:ve[ve.length-1].position})}),ve},k)}return L},Zie=function(t,o,l,h){var v=l.children,w=l.width,a=l.margin,C=w-(a.left||0)-(a.right||0),I=o7({children:v,legendWidth:C});if(I){var L=h||{},k=L.width,G=L.height,q=I.align,Q=I.verticalAlign,H=I.layout;if((H==="vertical"||H==="horizontal"&&Q==="middle")&&q!=="center"&&Ar(t[q]))return Oo(Oo({},t),{},z0({},q,t[q]+(k||0)));if((H==="horizontal"||H==="vertical"&&q==="center")&&Q!=="middle"&&Ar(t[Q]))return Oo(Oo({},t),{},z0({},Q,t[Q]+(G||0)))}return t},Wie=function(t,o,l){return ei(o)?!0:t==="horizontal"?o==="yAxis":t==="vertical"||l==="x"?o==="xAxis":l==="y"?o==="yAxis":!0},s7=function(t,o,l,h,v){var w=o.props.children,a=Rh(w,rS).filter(function(I){return Wie(h,v,I.props.direction)});if(a&&a.length){var C=a.map(function(I){return I.props.dataKey});return t.reduce(function(I,L){var k=Es(L,l);if(ei(k))return I;var G=Array.isArray(k)?[JT(k),jg(k)]:[k,k],q=C.reduce(function(Q,H){var K=Es(L,H,0),he=G[0]-Math.abs(Array.isArray(K)?K[0]:K),ue=G[1]+Math.abs(Array.isArray(K)?K[1]:K);return[Math.min(he,Q[0]),Math.max(ue,Q[1])]},[1/0,-1/0]);return[Math.min(q[0],I[0]),Math.max(q[1],I[1])]},[1/0,-1/0])}return null},Yie=function(t,o,l,h,v){var w=o.map(function(a){return s7(t,a,l,v,h)}).filter(function(a){return!ei(a)});return w&&w.length?w.reduce(function(a,C){return[Math.min(a[0],C[0]),Math.max(a[1],C[1])]},[1/0,-1/0]):null},l7=function(t,o,l,h,v){var w=o.map(function(C){var I=C.props.dataKey;return l==="number"&&I&&s7(t,C,I,h)||pb(t,I,l,v)});if(l==="number")return w.reduce(function(C,I){return[Math.min(C[0],I[0]),Math.max(C[1],I[1])]},[1/0,-1/0]);var a={};return w.reduce(function(C,I){for(var L=0,k=I.length;L<k;L++)a[I[L]]||(a[I[L]]=!0,C.push(I[L]));return C},[])},c7=function(t,o){return t==="horizontal"&&o==="xAxis"||t==="vertical"&&o==="yAxis"||t==="centric"&&o==="angleAxis"||t==="radial"&&o==="radiusAxis"},u7=function(t,o,l,h){if(h)return t.map(function(C){return C.coordinate});var v,w,a=t.map(function(C){return C.coordinate===o&&(v=!0),C.coordinate===l&&(w=!0),C.coordinate});return v||a.push(o),w||a.push(l),a},sm=function(t,o,l){if(!t)return null;var h=t.scale,v=t.duplicateDomain,w=t.type,a=t.range,C=t.realScaleType==="scaleBand"?h.bandwidth()/2:2,I=(o||l)&&w==="category"&&h.bandwidth?h.bandwidth()/C:0;if(I=t.axisType==="angleAxis"&&a?.length>=2?fc(a[0]-a[1])*2*I:I,o&&(t.ticks||t.niceTicks)){var L=(t.ticks||t.niceTicks).map(function(k){var G=v?v.indexOf(k):k;return{coordinate:h(G)+I,value:k,offset:I}});return L.filter(function(k){return!_x(k.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(k,G){return{coordinate:h(k)+I,value:k,index:G,offset:I}}):h.ticks&&!l?h.ticks(t.tickCount).map(function(k){return{coordinate:h(k)+I,value:k,offset:I}}):h.domain().map(function(k,G){return{coordinate:h(k)+I,value:v?v[k]:k,index:G,offset:I}})},SC=new WeakMap,Q2=function(t,o){if(typeof o!="function")return t;SC.has(t)||SC.set(t,new WeakMap);var l=SC.get(t);if(l.has(o))return l.get(o);var h=function(){t.apply(void 0,arguments),o.apply(void 0,arguments)};return l.set(o,h),h},h7=function(t,o,l){var h=t.scale,v=t.type,w=t.layout,a=t.axisType;if(h==="auto")return w==="radial"&&a==="radiusAxis"?{scale:zb(),realScaleType:"band"}:w==="radial"&&a==="angleAxis"?{scale:ZA(),realScaleType:"linear"}:v==="category"&&o&&(o.indexOf("LineChart")>=0||o.indexOf("AreaChart")>=0||o.indexOf("ComposedChart")>=0&&!l)?{scale:fb(),realScaleType:"point"}:v==="category"?{scale:zb(),realScaleType:"band"}:{scale:ZA(),realScaleType:"linear"};if(Zy(h)){var C="scale".concat(FT(h));return{scale:(uj[C]||fb)(),realScaleType:uj[C]?C:"point"}}return Bn(h)?{scale:h}:{scale:fb(),realScaleType:"point"}},Ej=1e-4,d7=function(t){var o=t.domain();if(!(!o||o.length<=2)){var l=o.length,h=t.range(),v=Math.min(h[0],h[1])-Ej,w=Math.max(h[0],h[1])+Ej,a=t(o[0]),C=t(o[l-1]);(a<v||a>w||C<v||C>w)&&t.domain([o[0],o[l-1]])}},Kie=function(t,o){if(!t)return null;for(var l=0,h=t.length;l<h;l++)if(t[l].item===o)return t[l].position;return null},Qie=function(t,o){if(!o||o.length!==2||!Ar(o[0])||!Ar(o[1]))return t;var l=Math.min(o[0],o[1]),h=Math.max(o[0],o[1]),v=[t[0],t[1]];return(!Ar(t[0])||t[0]<l)&&(v[0]=l),(!Ar(t[1])||t[1]>h)&&(v[1]=h),v[0]>h&&(v[0]=h),v[1]<l&&(v[1]=l),v},Jie=function(t){var o=t.length;if(!(o<=0))for(var l=0,h=t[0].length;l<h;++l)for(var v=0,w=0,a=0;a<o;++a){var C=_x(t[a][l][1])?t[a][l][0]:t[a][l][1];C>=0?(t[a][l][0]=v,t[a][l][1]=v+C,v=t[a][l][1]):(t[a][l][0]=w,t[a][l][1]=w+C,w=t[a][l][1])}},eae=function(t){var o=t.length;if(!(o<=0))for(var l=0,h=t[0].length;l<h;++l)for(var v=0,w=0;w<o;++w){var a=_x(t[w][l][1])?t[w][l][0]:t[w][l][1];a>=0?(t[w][l][0]=v,t[w][l][1]=v+a,v=t[w][l][1]):(t[w][l][0]=0,t[w][l][1]=0)}},tae={sign:Jie,expand:VK,none:G0,silhouette:GK,wiggle:$K,positive:eae},rae=function(t,o,l){var h=o.map(function(a){return a.props.dataKey}),v=tae[l],w=UK().keys(h).value(function(a,C){return+Es(a,C,0)}).order(VI).offset(v);return w(t)},nae=function(t,o,l,h,v,w){if(!t)return null;var a=w?o.reverse():o,C={},I=a.reduce(function(k,G){var q,Q=(q=G.type)!==null&&q!==void 0&&q.defaultProps?Oo(Oo({},G.type.defaultProps),G.props):G.props,H=Q.stackId,K=Q.hide;if(K)return k;var he=Q[l],ue=k[he]||{hasStack:!1,stackGroups:{}};if(Ms(H)){var me=ue.stackGroups[H]||{numericAxisId:l,cateAxisId:h,items:[]};me.items.push(G),ue.hasStack=!0,ue.stackGroups[H]=me}else ue.stackGroups[yx("_stackId_")]={numericAxisId:l,cateAxisId:h,items:[G]};return Oo(Oo({},k),{},z0({},he,ue))},C),L={};return Object.keys(I).reduce(function(k,G){var q=I[G];if(q.hasStack){var Q={};q.stackGroups=Object.keys(q.stackGroups).reduce(function(H,K){var he=q.stackGroups[K];return Oo(Oo({},H),{},z0({},K,{numericAxisId:l,cateAxisId:h,items:he.items,stackedData:rae(t,he.items,v)}))},Q)}return Oo(Oo({},k),{},z0({},G,q))},L)},f7=function(t,o){var l=o.realScaleType,h=o.type,v=o.tickCount,w=o.originalDomain,a=o.allowDecimals,C=l||o.scale;if(C!=="auto"&&C!=="linear")return null;if(v&&h==="number"&&w&&(w[0]==="auto"||w[1]==="auto")){var I=t.domain();if(!I.length)return null;var L=_ie(I,v,a);return t.domain([JT(L),jg(L)]),{niceTicks:L}}if(v&&h==="number"){var k=t.domain(),G=yie(k,v,a);return{niceTicks:G}}return null};function Mj(r){var t=r.axis,o=r.ticks,l=r.bandSize,h=r.entry,v=r.index,w=r.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!ei(h[t.dataKey])){var a=IA(o,"value",h[t.dataKey]);if(a)return a.coordinate+l/2}return o[v]?o[v].coordinate+l/2:null}var C=Es(h,ei(w)?t.dataKey:w);return ei(C)?null:t.scale(C)}var Oj=function(t){var o=t.axis,l=t.ticks,h=t.offset,v=t.bandSize,w=t.entry,a=t.index;if(o.type==="category")return l[a]?l[a].coordinate+h:null;var C=Es(w,o.dataKey,o.domain[a]);return ei(C)?null:o.scale(C)-v/2+h},iae=function(t){var o=t.numericAxis,l=o.scale.domain();if(o.type==="number"){var h=Math.min(l[0],l[1]),v=Math.max(l[0],l[1]);return h<=0&&v>=0?0:v<0?v:h}return l[0]},aae=function(t,o){var l,h=(l=t.type)!==null&&l!==void 0&&l.defaultProps?Oo(Oo({},t.type.defaultProps),t.props):t.props,v=h.stackId;if(Ms(v)){var w=o[v];if(w){var a=w.items.indexOf(t);return a>=0?w.stackedData[a]:null}}return null},oae=function(t){return t.reduce(function(o,l){return[JT(l.concat([o[0]]).filter(Ar)),jg(l.concat([o[1]]).filter(Ar))]},[1/0,-1/0])},p7=function(t,o,l){return Object.keys(t).reduce(function(h,v){var w=t[v],a=w.stackedData,C=a.reduce(function(I,L){var k=oae(L.slice(o,l+1));return[Math.min(I[0],k[0]),Math.max(I[1],k[1])]},[1/0,-1/0]);return[Math.min(C[0],h[0]),Math.max(C[1],h[1])]},[1/0,-1/0]).map(function(h){return h===1/0||h===-1/0?0:h})},Cj=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ij=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,fP=function(t,o,l){if(Bn(t))return t(o,l);if(!Array.isArray(t))return o;var h=[];if(Ar(t[0]))h[0]=l?t[0]:Math.min(t[0],o[0]);else if(Cj.test(t[0])){var v=+Cj.exec(t[0])[1];h[0]=o[0]-v}else Bn(t[0])?h[0]=t[0](o[0]):h[0]=o[0];if(Ar(t[1]))h[1]=l?t[1]:Math.max(t[1],o[1]);else if(Ij.test(t[1])){var w=+Ij.exec(t[1])[1];h[1]=o[1]+w}else Bn(t[1])?h[1]=t[1](o[1]):h[1]=o[1];return h},tT=function(t,o,l){if(t&&t.scale&&t.scale.bandwidth){var h=t.scale.bandwidth();if(!l||h>0)return h}if(t&&o&&o.length>=2){for(var v=YD(o,function(k){return k.coordinate}),w=1/0,a=1,C=v.length;a<C;a++){var I=v[a],L=v[a-1];w=Math.min((I.coordinate||0)-(L.coordinate||0),w)}return w===1/0?0:w}return l?void 0:0},Pj=function(t,o,l){return!t||!t.length||K0(t,ju(l,"type.defaultProps.domain"))?o:t},m7=function(t,o){var l=t.type.defaultProps?Oo(Oo({},t.type.defaultProps),t.props):t.props,h=l.dataKey,v=l.name,w=l.unit,a=l.formatter,C=l.tooltipType,I=l.chartType,L=l.hide;return Oo(Oo({},xn(t,!1)),{},{dataKey:h,unit:w,formatter:a,name:v||h,color:wR(t),value:Es(o,h),type:C,payload:o,chartType:I,hide:L})};function Gb(r){"@babel/helpers - typeof";return Gb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gb(r)}function Dj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function tm(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Dj(Object(o),!0).forEach(function(l){g7(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Dj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function g7(r,t,o){return t=sae(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function sae(r){var t=lae(r,"string");return Gb(t)=="symbol"?t:t+""}function lae(r,t){if(Gb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Gb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function cae(r,t){return fae(r)||dae(r,t)||hae(r,t)||uae()}function uae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hae(r,t){if(r){if(typeof r=="string")return Rj(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return Rj(r,t)}}function Rj(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function dae(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function fae(r){if(Array.isArray(r))return r}var rT=Math.PI/180,pae=function(t){return t*180/Math.PI},za=function(t,o,l,h){return{x:t+Math.cos(-rT*h)*l,y:o+Math.sin(-rT*h)*l}},_7=function(t,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(l.left||0)-(l.right||0)),Math.abs(o-(l.top||0)-(l.bottom||0)))/2},mae=function(t,o,l,h,v){var w=t.width,a=t.height,C=t.startAngle,I=t.endAngle,L=pc(t.cx,w,w/2),k=pc(t.cy,a,a/2),G=_7(w,a,l),q=pc(t.innerRadius,G,0),Q=pc(t.outerRadius,G,G*.8),H=Object.keys(o);return H.reduce(function(K,he){var ue=o[he],me=ue.domain,ge=ue.reversed,se;if(ei(ue.range))h==="angleAxis"?se=[C,I]:h==="radiusAxis"&&(se=[q,Q]),ge&&(se=[se[1],se[0]]);else{se=ue.range;var fe=se,ve=cae(fe,2);C=ve[0],I=ve[1]}var Le=h7(ue,v),Ue=Le.realScaleType,tt=Le.scale;tt.domain(me).range(se),d7(tt);var Ke=f7(tt,tm(tm({},ue),{},{realScaleType:Ue})),nt=tm(tm(tm({},ue),Ke),{},{range:se,radius:Q,realScaleType:Ue,scale:tt,cx:L,cy:k,innerRadius:q,outerRadius:Q,startAngle:C,endAngle:I});return tm(tm({},K),{},g7({},he,nt))},{})},gae=function(t,o){var l=t.x,h=t.y,v=o.x,w=o.y;return Math.sqrt(Math.pow(l-v,2)+Math.pow(h-w,2))},_ae=function(t,o){var l=t.x,h=t.y,v=o.cx,w=o.cy,a=gae({x:l,y:h},{x:v,y:w});if(a<=0)return{radius:a};var C=(l-v)/a,I=Math.acos(C);return h>w&&(I=2*Math.PI-I),{radius:a,angle:pae(I),angleInRadian:I}},yae=function(t){var o=t.startAngle,l=t.endAngle,h=Math.floor(o/360),v=Math.floor(l/360),w=Math.min(h,v);return{startAngle:o-w*360,endAngle:l-w*360}},vae=function(t,o){var l=o.startAngle,h=o.endAngle,v=Math.floor(l/360),w=Math.floor(h/360),a=Math.min(v,w);return t+a*360},zj=function(t,o){var l=t.x,h=t.y,v=_ae({x:l,y:h},o),w=v.radius,a=v.angle,C=o.innerRadius,I=o.outerRadius;if(w<C||w>I)return!1;if(w===0)return!0;var L=yae(o),k=L.startAngle,G=L.endAngle,q=a,Q;if(k<=G){for(;q>G;)q-=360;for(;q<k;)q+=360;Q=q>=k&&q<=G}else{for(;q>k;)q-=360;for(;q<G;)q+=360;Q=q>=G&&q<=k}return Q?tm(tm({},o),{},{radius:w,angle:vae(q,o)}):null},y7=function(t){return!Jt.isValidElement(t)&&!Bn(t)&&typeof t!="boolean"?t.className:""};function $b(r){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(r)}var xae=["offset"];function bae(r){return Sae(r)||Tae(r)||Aae(r)||wae()}function wae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aae(r,t){if(r){if(typeof r=="string")return pP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return pP(r,t)}}function Tae(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Sae(r){if(Array.isArray(r))return pP(r)}function pP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Eae(r,t){if(r==null)return{};var o=Mae(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Mae(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function Lj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function As(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Lj(Object(o),!0).forEach(function(l){Oae(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Lj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Oae(r,t,o){return t=Cae(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Cae(r){var t=Iae(r,"string");return $b(t)=="symbol"?t:t+""}function Iae(r,t){if($b(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if($b(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function qb(){return qb=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},qb.apply(this,arguments)}var Pae=function(t){var o=t.value,l=t.formatter,h=ei(t.children)?o:t.children;return Bn(l)?l(h):h},Dae=function(t,o){var l=fc(o-t),h=Math.min(Math.abs(o-t),360);return l*h},Rae=function(t,o,l){var h=t.position,v=t.viewBox,w=t.offset,a=t.className,C=v,I=C.cx,L=C.cy,k=C.innerRadius,G=C.outerRadius,q=C.startAngle,Q=C.endAngle,H=C.clockWise,K=(k+G)/2,he=Dae(q,Q),ue=he>=0?1:-1,me,ge;h==="insideStart"?(me=q+ue*w,ge=H):h==="insideEnd"?(me=Q-ue*w,ge=!H):h==="end"&&(me=Q+ue*w,ge=H),ge=he<=0?ge:!ge;var se=za(I,L,K,me),fe=za(I,L,K,me+(ge?1:-1)*359),ve="M".concat(se.x,",").concat(se.y,`
    A`).concat(K,",").concat(K,",0,1,").concat(ge?0:1,`,
    `).concat(fe.x,",").concat(fe.y),Le=ei(t.id)?yx("recharts-radial-line-"):t.id;return ft.createElement("text",qb({},l,{dominantBaseline:"central",className:li("recharts-radial-bar-label",a)}),ft.createElement("defs",null,ft.createElement("path",{id:Le,d:ve})),ft.createElement("textPath",{xlinkHref:"#".concat(Le)},o))},zae=function(t){var o=t.viewBox,l=t.offset,h=t.position,v=o,w=v.cx,a=v.cy,C=v.innerRadius,I=v.outerRadius,L=v.startAngle,k=v.endAngle,G=(L+k)/2;if(h==="outside"){var q=za(w,a,I+l,G),Q=q.x,H=q.y;return{x:Q,y:H,textAnchor:Q>=w?"start":"end",verticalAnchor:"middle"}}if(h==="center")return{x:w,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(h==="centerTop")return{x:w,y:a,textAnchor:"middle",verticalAnchor:"start"};if(h==="centerBottom")return{x:w,y:a,textAnchor:"middle",verticalAnchor:"end"};var K=(C+I)/2,he=za(w,a,K,G),ue=he.x,me=he.y;return{x:ue,y:me,textAnchor:"middle",verticalAnchor:"middle"}},Lae=function(t){var o=t.viewBox,l=t.parentViewBox,h=t.offset,v=t.position,w=o,a=w.x,C=w.y,I=w.width,L=w.height,k=L>=0?1:-1,G=k*h,q=k>0?"end":"start",Q=k>0?"start":"end",H=I>=0?1:-1,K=H*h,he=H>0?"end":"start",ue=H>0?"start":"end";if(v==="top"){var me={x:a+I/2,y:C-k*h,textAnchor:"middle",verticalAnchor:q};return As(As({},me),l?{height:Math.max(C-l.y,0),width:I}:{})}if(v==="bottom"){var ge={x:a+I/2,y:C+L+G,textAnchor:"middle",verticalAnchor:Q};return As(As({},ge),l?{height:Math.max(l.y+l.height-(C+L),0),width:I}:{})}if(v==="left"){var se={x:a-K,y:C+L/2,textAnchor:he,verticalAnchor:"middle"};return As(As({},se),l?{width:Math.max(se.x-l.x,0),height:L}:{})}if(v==="right"){var fe={x:a+I+K,y:C+L/2,textAnchor:ue,verticalAnchor:"middle"};return As(As({},fe),l?{width:Math.max(l.x+l.width-fe.x,0),height:L}:{})}var ve=l?{width:I,height:L}:{};return v==="insideLeft"?As({x:a+K,y:C+L/2,textAnchor:ue,verticalAnchor:"middle"},ve):v==="insideRight"?As({x:a+I-K,y:C+L/2,textAnchor:he,verticalAnchor:"middle"},ve):v==="insideTop"?As({x:a+I/2,y:C+G,textAnchor:"middle",verticalAnchor:Q},ve):v==="insideBottom"?As({x:a+I/2,y:C+L-G,textAnchor:"middle",verticalAnchor:q},ve):v==="insideTopLeft"?As({x:a+K,y:C+G,textAnchor:ue,verticalAnchor:Q},ve):v==="insideTopRight"?As({x:a+I-K,y:C+G,textAnchor:he,verticalAnchor:Q},ve):v==="insideBottomLeft"?As({x:a+K,y:C+L-G,textAnchor:ue,verticalAnchor:q},ve):v==="insideBottomRight"?As({x:a+I-K,y:C+L-G,textAnchor:he,verticalAnchor:q},ve):gx(v)&&(Ar(v.x)||Cy(v.x))&&(Ar(v.y)||Cy(v.y))?As({x:a+pc(v.x,I),y:C+pc(v.y,L),textAnchor:"end",verticalAnchor:"end"},ve):As({x:a+I/2,y:C+L/2,textAnchor:"middle",verticalAnchor:"middle"},ve)},Bae=function(t){return"cx"in t&&Ar(t.cx)};function qs(r){var t=r.offset,o=t===void 0?5:t,l=Eae(r,xae),h=As({offset:o},l),v=h.viewBox,w=h.position,a=h.value,C=h.children,I=h.content,L=h.className,k=L===void 0?"":L,G=h.textBreakAll;if(!v||ei(a)&&ei(C)&&!Jt.isValidElement(I)&&!Bn(I))return null;if(Jt.isValidElement(I))return Jt.cloneElement(I,h);var q;if(Bn(I)){if(q=Jt.createElement(I,h),Jt.isValidElement(q))return q}else q=Pae(h);var Q=Bae(v),H=xn(h,!0);if(Q&&(w==="insideStart"||w==="insideEnd"||w==="end"))return Rae(h,q,H);var K=Q?zae(h):Lae(h);return ft.createElement(Yy,qb({className:li("recharts-label",k)},H,K,{breakAll:G}),q)}qs.displayName="Label";var v7=function(t){var o=t.cx,l=t.cy,h=t.angle,v=t.startAngle,w=t.endAngle,a=t.r,C=t.radius,I=t.innerRadius,L=t.outerRadius,k=t.x,G=t.y,q=t.top,Q=t.left,H=t.width,K=t.height,he=t.clockWise,ue=t.labelViewBox;if(ue)return ue;if(Ar(H)&&Ar(K)){if(Ar(k)&&Ar(G))return{x:k,y:G,width:H,height:K};if(Ar(q)&&Ar(Q))return{x:q,y:Q,width:H,height:K}}return Ar(k)&&Ar(G)?{x:k,y:G,width:0,height:0}:Ar(o)&&Ar(l)?{cx:o,cy:l,startAngle:v||h||0,endAngle:w||h||0,innerRadius:I||0,outerRadius:L||C||a||0,clockWise:he}:t.viewBox?t.viewBox:{}},kae=function(t,o){return t?t===!0?ft.createElement(qs,{key:"label-implicit",viewBox:o}):Ms(t)?ft.createElement(qs,{key:"label-implicit",viewBox:o,value:t}):Jt.isValidElement(t)?t.type===qs?Jt.cloneElement(t,{key:"label-implicit",viewBox:o}):ft.createElement(qs,{key:"label-implicit",content:t,viewBox:o}):Bn(t)?ft.createElement(qs,{key:"label-implicit",content:t,viewBox:o}):gx(t)?ft.createElement(qs,qb({viewBox:o},t,{key:"label-implicit"})):null:null},Fae=function(t,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&l&&!t.label)return null;var h=t.children,v=v7(t),w=Rh(h,qs).map(function(C,I){return Jt.cloneElement(C,{viewBox:o||v,key:"label-".concat(I)})});if(!l)return w;var a=kae(t.label,o||v);return[a].concat(bae(w))};qs.parseViewBox=v7;qs.renderCallByParent=Fae;var EC,Bj;function Nae(){if(Bj)return EC;Bj=1;function r(t){var o=t==null?0:t.length;return o?t[o-1]:void 0}return EC=r,EC}var jae=Nae();const Uae=ca(jae);function Hb(r){"@babel/helpers - typeof";return Hb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hb(r)}var Vae=["valueAccessor"],Gae=["data","dataKey","clockWise","id","textBreakAll"];function $ae(r){return Zae(r)||Xae(r)||Hae(r)||qae()}function qae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hae(r,t){if(r){if(typeof r=="string")return mP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return mP(r,t)}}function Xae(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Zae(r){if(Array.isArray(r))return mP(r)}function mP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function nT(){return nT=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},nT.apply(this,arguments)}function kj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Fj(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?kj(Object(o),!0).forEach(function(l){Wae(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):kj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Wae(r,t,o){return t=Yae(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Yae(r){var t=Kae(r,"string");return Hb(t)=="symbol"?t:t+""}function Kae(r,t){if(Hb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Hb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Nj(r,t){if(r==null)return{};var o=Qae(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Qae(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}var Jae=function(t){return Array.isArray(t.value)?Uae(t.value):t.value};function hm(r){var t=r.valueAccessor,o=t===void 0?Jae:t,l=Nj(r,Vae),h=l.data,v=l.dataKey,w=l.clockWise,a=l.id,C=l.textBreakAll,I=Nj(l,Gae);return!h||!h.length?null:ft.createElement(Gi,{className:"recharts-label-list"},h.map(function(L,k){var G=ei(v)?o(L,k):Es(L&&L.payload,v),q=ei(a)?{}:{id:"".concat(a,"-").concat(k)};return ft.createElement(qs,nT({},xn(L,!0),I,q,{parentViewBox:L.parentViewBox,value:G,textBreakAll:C,viewBox:qs.parseViewBox(ei(w)?L:Fj(Fj({},L),{},{clockWise:w})),key:"label-".concat(k),index:k}))}))}hm.displayName="LabelList";function eoe(r,t){return r?r===!0?ft.createElement(hm,{key:"labelList-implicit",data:t}):ft.isValidElement(r)||Bn(r)?ft.createElement(hm,{key:"labelList-implicit",data:t,content:r}):gx(r)?ft.createElement(hm,nT({data:t},r,{key:"labelList-implicit"})):null:null}function toe(r,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!r||!r.children&&o&&!r.label)return null;var l=r.children,h=Rh(l,hm).map(function(w,a){return Jt.cloneElement(w,{data:t,key:"labelList-".concat(a)})});if(!o)return h;var v=eoe(r.label,t);return[v].concat($ae(h))}hm.renderCallByParent=toe;function Xb(r){"@babel/helpers - typeof";return Xb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xb(r)}function gP(){return gP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},gP.apply(this,arguments)}function jj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Uj(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?jj(Object(o),!0).forEach(function(l){roe(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):jj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function roe(r,t,o){return t=noe(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function noe(r){var t=ioe(r,"string");return Xb(t)=="symbol"?t:t+""}function ioe(r,t){if(Xb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Xb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var aoe=function(t,o){var l=fc(o-t),h=Math.min(Math.abs(o-t),359.999);return l*h},J2=function(t){var o=t.cx,l=t.cy,h=t.radius,v=t.angle,w=t.sign,a=t.isExternal,C=t.cornerRadius,I=t.cornerIsExternal,L=C*(a?1:-1)+h,k=Math.asin(C/L)/rT,G=I?v:v+w*k,q=za(o,l,L,G),Q=za(o,l,h,G),H=I?v-w*k:v,K=za(o,l,L*Math.cos(k*rT),H);return{center:q,circleTangency:Q,lineTangency:K,theta:k}},x7=function(t){var o=t.cx,l=t.cy,h=t.innerRadius,v=t.outerRadius,w=t.startAngle,a=t.endAngle,C=aoe(w,a),I=w+C,L=za(o,l,v,w),k=za(o,l,v,I),G="M ".concat(L.x,",").concat(L.y,`
    A `).concat(v,",").concat(v,`,0,
    `).concat(+(Math.abs(C)>180),",").concat(+(w>I),`,
    `).concat(k.x,",").concat(k.y,`
  `);if(h>0){var q=za(o,l,h,w),Q=za(o,l,h,I);G+="L ".concat(Q.x,",").concat(Q.y,`
            A `).concat(h,",").concat(h,`,0,
            `).concat(+(Math.abs(C)>180),",").concat(+(w<=I),`,
            `).concat(q.x,",").concat(q.y," Z")}else G+="L ".concat(o,",").concat(l," Z");return G},ooe=function(t){var o=t.cx,l=t.cy,h=t.innerRadius,v=t.outerRadius,w=t.cornerRadius,a=t.forceCornerRadius,C=t.cornerIsExternal,I=t.startAngle,L=t.endAngle,k=fc(L-I),G=J2({cx:o,cy:l,radius:v,angle:I,sign:k,cornerRadius:w,cornerIsExternal:C}),q=G.circleTangency,Q=G.lineTangency,H=G.theta,K=J2({cx:o,cy:l,radius:v,angle:L,sign:-k,cornerRadius:w,cornerIsExternal:C}),he=K.circleTangency,ue=K.lineTangency,me=K.theta,ge=C?Math.abs(I-L):Math.abs(I-L)-H-me;if(ge<0)return a?"M ".concat(Q.x,",").concat(Q.y,`
        a`).concat(w,",").concat(w,",0,0,1,").concat(w*2,`,0
        a`).concat(w,",").concat(w,",0,0,1,").concat(-w*2,`,0
      `):x7({cx:o,cy:l,innerRadius:h,outerRadius:v,startAngle:I,endAngle:L});var se="M ".concat(Q.x,",").concat(Q.y,`
    A`).concat(w,",").concat(w,",0,0,").concat(+(k<0),",").concat(q.x,",").concat(q.y,`
    A`).concat(v,",").concat(v,",0,").concat(+(ge>180),",").concat(+(k<0),",").concat(he.x,",").concat(he.y,`
    A`).concat(w,",").concat(w,",0,0,").concat(+(k<0),",").concat(ue.x,",").concat(ue.y,`
  `);if(h>0){var fe=J2({cx:o,cy:l,radius:h,angle:I,sign:k,isExternal:!0,cornerRadius:w,cornerIsExternal:C}),ve=fe.circleTangency,Le=fe.lineTangency,Ue=fe.theta,tt=J2({cx:o,cy:l,radius:h,angle:L,sign:-k,isExternal:!0,cornerRadius:w,cornerIsExternal:C}),Ke=tt.circleTangency,nt=tt.lineTangency,st=tt.theta,Rt=C?Math.abs(I-L):Math.abs(I-L)-Ue-st;if(Rt<0&&w===0)return"".concat(se,"L").concat(o,",").concat(l,"Z");se+="L".concat(nt.x,",").concat(nt.y,`
      A`).concat(w,",").concat(w,",0,0,").concat(+(k<0),",").concat(Ke.x,",").concat(Ke.y,`
      A`).concat(h,",").concat(h,",0,").concat(+(Rt>180),",").concat(+(k>0),",").concat(ve.x,",").concat(ve.y,`
      A`).concat(w,",").concat(w,",0,0,").concat(+(k<0),",").concat(Le.x,",").concat(Le.y,"Z")}else se+="L".concat(o,",").concat(l,"Z");return se},soe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},b7=function(t){var o=Uj(Uj({},soe),t),l=o.cx,h=o.cy,v=o.innerRadius,w=o.outerRadius,a=o.cornerRadius,C=o.forceCornerRadius,I=o.cornerIsExternal,L=o.startAngle,k=o.endAngle,G=o.className;if(w<v||L===k)return null;var q=li("recharts-sector",G),Q=w-v,H=pc(a,Q,0,!0),K;return H>0&&Math.abs(L-k)<360?K=ooe({cx:l,cy:h,innerRadius:v,outerRadius:w,cornerRadius:Math.min(H,Q/2),forceCornerRadius:C,cornerIsExternal:I,startAngle:L,endAngle:k}):K=x7({cx:l,cy:h,innerRadius:v,outerRadius:w,startAngle:L,endAngle:k}),ft.createElement("path",gP({},xn(o,!0),{className:q,d:K,role:"img"}))};function Zb(r){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(r)}function _P(){return _P=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},_P.apply(this,arguments)}function Vj(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Gj(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?Vj(Object(o),!0).forEach(function(l){loe(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):Vj(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function loe(r,t,o){return t=coe(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function coe(r){var t=uoe(r,"string");return Zb(t)=="symbol"?t:t+""}function uoe(r,t){if(Zb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Zb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var $j={curveBasisClosed:IK,curveBasisOpen:PK,curveBasis:CK,curveBumpX:mK,curveBumpY:gK,curveLinearClosed:DK,curveLinear:jT,curveMonotoneX:RK,curveMonotoneY:zK,curveNatural:LK,curveStep:BK,curveStepAfter:FK,curveStepBefore:kK},eA=function(t){return t.x===+t.x&&t.y===+t.y},F1=function(t){return t.x},N1=function(t){return t.y},hoe=function(t,o){if(Bn(t))return t;var l="curve".concat(FT(t));return(l==="curveMonotone"||l==="curveBump")&&o?$j["".concat(l).concat(o==="vertical"?"Y":"X")]:$j[l]||jT},doe=function(t){var o=t.type,l=o===void 0?"linear":o,h=t.points,v=h===void 0?[]:h,w=t.baseLine,a=t.layout,C=t.connectNulls,I=C===void 0?!1:C,L=hoe(l,a),k=I?v.filter(function(H){return eA(H)}):v,G;if(Array.isArray(w)){var q=I?w.filter(function(H){return eA(H)}):w,Q=k.map(function(H,K){return Gj(Gj({},H),{},{base:q[K]})});return a==="vertical"?G=$2().y(N1).x1(F1).x0(function(H){return H.base.x}):G=$2().x(F1).y1(N1).y0(function(H){return H.base.y}),G.defined(eA).curve(L),G(Q)}return a==="vertical"&&Ar(w)?G=$2().y(N1).x1(F1).x0(w):Ar(w)?G=$2().x(F1).y1(N1).y0(w):G=vV().x(F1).y(N1),G.defined(eA).curve(L),G(k)},L0=function(t){var o=t.className,l=t.points,h=t.path,v=t.pathRef;if((!l||!l.length)&&!h)return null;var w=l&&l.length?doe(t):h;return Jt.createElement("path",_P({},xn(t,!1),PA(t),{className:li("recharts-curve",o),d:w,ref:v}))},MC={exports:{}},OC,qj;function foe(){if(qj)return OC;qj=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return OC=r,OC}var CC,Hj;function poe(){if(Hj)return CC;Hj=1;var r=foe();function t(){}function o(){}return o.resetWarningCache=t,CC=function(){function l(w,a,C,I,L,k){if(k!==r){var G=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw G.name="Invariant Violation",G}}l.isRequired=l;function h(){return l}var v={array:l,bigint:l,bool:l,func:l,number:l,object:l,string:l,symbol:l,any:l,arrayOf:h,element:l,elementType:l,instanceOf:h,node:l,objectOf:h,oneOf:h,oneOfType:h,shape:h,exact:h,checkPropTypes:o,resetWarningCache:t};return v.PropTypes=v,v},CC}var Xj;function moe(){return Xj||(Xj=1,MC.exports=poe()()),MC.exports}var goe=moe();const sa=ca(goe),{getOwnPropertyNames:_oe,getOwnPropertySymbols:yoe}=Object,{hasOwnProperty:voe}=Object.prototype;function IC(r,t){return function(l,h,v){return r(l,h,v)&&t(l,h,v)}}function tA(r){return function(o,l,h){if(!o||!l||typeof o!="object"||typeof l!="object")return r(o,l,h);const{cache:v}=h,w=v.get(o),a=v.get(l);if(w&&a)return w===l&&a===o;v.set(o,l),v.set(l,o);const C=r(o,l,h);return v.delete(o),v.delete(l),C}}function xoe(r){return r?.[Symbol.toStringTag]}function Zj(r){return _oe(r).concat(yoe(r))}const boe=Object.hasOwn||((r,t)=>voe.call(r,t));function av(r,t){return r===t||!r&&!t&&r!==r&&t!==t}const woe="__v",Aoe="__o",Toe="_owner",{getOwnPropertyDescriptor:Wj,keys:Yj}=Object;function Soe(r,t){return r.byteLength===t.byteLength&&iT(new Uint8Array(r),new Uint8Array(t))}function Eoe(r,t,o){let l=r.length;if(t.length!==l)return!1;for(;l-- >0;)if(!o.equals(r[l],t[l],l,l,r,t,o))return!1;return!0}function Moe(r,t){return r.byteLength===t.byteLength&&iT(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function Ooe(r,t){return av(r.getTime(),t.getTime())}function Coe(r,t){return r.name===t.name&&r.message===t.message&&r.cause===t.cause&&r.stack===t.stack}function Ioe(r,t){return r===t}function Kj(r,t,o){const l=r.size;if(l!==t.size)return!1;if(!l)return!0;const h=new Array(l),v=r.entries();let w,a,C=0;for(;(w=v.next())&&!w.done;){const I=t.entries();let L=!1,k=0;for(;(a=I.next())&&!a.done;){if(h[k]){k++;continue}const G=w.value,q=a.value;if(o.equals(G[0],q[0],C,k,r,t,o)&&o.equals(G[1],q[1],G[0],q[0],r,t,o)){L=h[k]=!0;break}k++}if(!L)return!1;C++}return!0}const Poe=av;function Doe(r,t,o){const l=Yj(r);let h=l.length;if(Yj(t).length!==h)return!1;for(;h-- >0;)if(!w7(r,t,o,l[h]))return!1;return!0}function j1(r,t,o){const l=Zj(r);let h=l.length;if(Zj(t).length!==h)return!1;let v,w,a;for(;h-- >0;)if(v=l[h],!w7(r,t,o,v)||(w=Wj(r,v),a=Wj(t,v),(w||a)&&(!w||!a||w.configurable!==a.configurable||w.enumerable!==a.enumerable||w.writable!==a.writable)))return!1;return!0}function Roe(r,t){return av(r.valueOf(),t.valueOf())}function zoe(r,t){return r.source===t.source&&r.flags===t.flags}function Qj(r,t,o){const l=r.size;if(l!==t.size)return!1;if(!l)return!0;const h=new Array(l),v=r.values();let w,a;for(;(w=v.next())&&!w.done;){const C=t.values();let I=!1,L=0;for(;(a=C.next())&&!a.done;){if(!h[L]&&o.equals(w.value,a.value,w.value,a.value,r,t,o)){I=h[L]=!0;break}L++}if(!I)return!1}return!0}function iT(r,t){let o=r.byteLength;if(t.byteLength!==o||r.byteOffset!==t.byteOffset)return!1;for(;o-- >0;)if(r[o]!==t[o])return!1;return!0}function Loe(r,t){return r.hostname===t.hostname&&r.pathname===t.pathname&&r.protocol===t.protocol&&r.port===t.port&&r.hash===t.hash&&r.username===t.username&&r.password===t.password}function w7(r,t,o,l){return(l===Toe||l===Aoe||l===woe)&&(r.$$typeof||t.$$typeof)?!0:boe(t,l)&&o.equals(r[l],t[l],l,l,r,t,o)}const Boe="[object ArrayBuffer]",koe="[object Arguments]",Foe="[object Boolean]",Noe="[object DataView]",joe="[object Date]",Uoe="[object Error]",Voe="[object Map]",Goe="[object Number]",$oe="[object Object]",qoe="[object RegExp]",Hoe="[object Set]",Xoe="[object String]",Zoe={"[object Int8Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Int16Array]":!0,"[object Uint16Array]":!0,"[object Int32Array]":!0,"[object Uint32Array]":!0,"[object Float16Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0,"[object BigInt64Array]":!0,"[object BigUint64Array]":!0},Woe="[object URL]",Yoe=Object.prototype.toString;function Koe({areArrayBuffersEqual:r,areArraysEqual:t,areDataViewsEqual:o,areDatesEqual:l,areErrorsEqual:h,areFunctionsEqual:v,areMapsEqual:w,areNumbersEqual:a,areObjectsEqual:C,arePrimitiveWrappersEqual:I,areRegExpsEqual:L,areSetsEqual:k,areTypedArraysEqual:G,areUrlsEqual:q,unknownTagComparators:Q}){return function(K,he,ue){if(K===he)return!0;if(K==null||he==null)return!1;const me=typeof K;if(me!==typeof he)return!1;if(me!=="object")return me==="number"?a(K,he,ue):me==="function"?v(K,he,ue):!1;const ge=K.constructor;if(ge!==he.constructor)return!1;if(ge===Object)return C(K,he,ue);if(Array.isArray(K))return t(K,he,ue);if(ge===Date)return l(K,he,ue);if(ge===RegExp)return L(K,he,ue);if(ge===Map)return w(K,he,ue);if(ge===Set)return k(K,he,ue);const se=Yoe.call(K);if(se===joe)return l(K,he,ue);if(se===qoe)return L(K,he,ue);if(se===Voe)return w(K,he,ue);if(se===Hoe)return k(K,he,ue);if(se===$oe)return typeof K.then!="function"&&typeof he.then!="function"&&C(K,he,ue);if(se===Woe)return q(K,he,ue);if(se===Uoe)return h(K,he,ue);if(se===koe)return C(K,he,ue);if(Zoe[se])return G(K,he,ue);if(se===Boe)return r(K,he,ue);if(se===Noe)return o(K,he,ue);if(se===Foe||se===Goe||se===Xoe)return I(K,he,ue);if(Q){let fe=Q[se];if(!fe){const ve=xoe(K);ve&&(fe=Q[ve])}if(fe)return fe(K,he,ue)}return!1}}function Qoe({circular:r,createCustomConfig:t,strict:o}){let l={areArrayBuffersEqual:Soe,areArraysEqual:o?j1:Eoe,areDataViewsEqual:Moe,areDatesEqual:Ooe,areErrorsEqual:Coe,areFunctionsEqual:Ioe,areMapsEqual:o?IC(Kj,j1):Kj,areNumbersEqual:Poe,areObjectsEqual:o?j1:Doe,arePrimitiveWrappersEqual:Roe,areRegExpsEqual:zoe,areSetsEqual:o?IC(Qj,j1):Qj,areTypedArraysEqual:o?IC(iT,j1):iT,areUrlsEqual:Loe,unknownTagComparators:void 0};if(t&&(l=Object.assign({},l,t(l))),r){const h=tA(l.areArraysEqual),v=tA(l.areMapsEqual),w=tA(l.areObjectsEqual),a=tA(l.areSetsEqual);l=Object.assign({},l,{areArraysEqual:h,areMapsEqual:v,areObjectsEqual:w,areSetsEqual:a})}return l}function Joe(r){return function(t,o,l,h,v,w,a){return r(t,o,a)}}function ese({circular:r,comparator:t,createState:o,equals:l,strict:h}){if(o)return function(a,C){const{cache:I=r?new WeakMap:void 0,meta:L}=o();return t(a,C,{cache:I,equals:l,meta:L,strict:h})};if(r)return function(a,C){return t(a,C,{cache:new WeakMap,equals:l,meta:void 0,strict:h})};const v={cache:void 0,equals:l,meta:void 0,strict:h};return function(a,C){return t(a,C,v)}}const tse=e_();e_({strict:!0});e_({circular:!0});e_({circular:!0,strict:!0});e_({createInternalComparator:()=>av});e_({strict:!0,createInternalComparator:()=>av});e_({circular:!0,createInternalComparator:()=>av});e_({circular:!0,createInternalComparator:()=>av,strict:!0});function e_(r={}){const{circular:t=!1,createInternalComparator:o,createState:l,strict:h=!1}=r,v=Qoe(r),w=Koe(v),a=o?o(w):Joe(w);return ese({circular:t,comparator:w,createState:l,equals:a,strict:h})}function rse(r){typeof requestAnimationFrame<"u"&&requestAnimationFrame(r)}function Jj(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=-1,l=function h(v){o<0&&(o=v),v-o>t?(r(v),o=-1):rse(h)};requestAnimationFrame(l)}function yP(r){"@babel/helpers - typeof";return yP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yP(r)}function nse(r){return sse(r)||ose(r)||ase(r)||ise()}function ise(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ase(r,t){if(r){if(typeof r=="string")return e6(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e6(r,t)}}function e6(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function ose(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function sse(r){if(Array.isArray(r))return r}function lse(){var r={},t=function(){return null},o=!1,l=function h(v){if(!o){if(Array.isArray(v)){if(!v.length)return;var w=v,a=nse(w),C=a[0],I=a.slice(1);if(typeof C=="number"){Jj(h.bind(null,I),C);return}h(C),Jj(h.bind(null,I));return}yP(v)==="object"&&(r=v,t(r)),typeof v=="function"&&v()}};return{stop:function(){o=!0},start:function(v){o=!1,l(v)},subscribe:function(v){return t=v,function(){t=function(){return null}}}}}function Wb(r){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(r)}function t6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function r6(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?t6(Object(o),!0).forEach(function(l){A7(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):t6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function A7(r,t,o){return t=cse(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function cse(r){var t=use(r,"string");return Wb(t)==="symbol"?t:String(t)}function use(r,t){if(Wb(r)!=="object"||r===null)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Wb(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var hse=function(t,o){return[Object.keys(t),Object.keys(o)].reduce(function(l,h){return l.filter(function(v){return h.includes(v)})})},dse=function(t){return t},fse=function(t){return t.replace(/([A-Z])/g,function(o){return"-".concat(o.toLowerCase())})},mb=function(t,o){return Object.keys(o).reduce(function(l,h){return r6(r6({},l),{},A7({},h,t(h,o[h])))},{})},n6=function(t,o,l){return t.map(function(h){return"".concat(fse(h)," ").concat(o,"ms ").concat(l)}).join(",")};function pse(r,t){return _se(r)||gse(r,t)||T7(r,t)||mse()}function mse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gse(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function _se(r){if(Array.isArray(r))return r}function yse(r){return bse(r)||xse(r)||T7(r)||vse()}function vse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T7(r,t){if(r){if(typeof r=="string")return vP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return vP(r,t)}}function xse(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function bse(r){if(Array.isArray(r))return vP(r)}function vP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}var aT=1e-4,S7=function(t,o){return[0,3*t,3*o-6*t,3*t-3*o+1]},E7=function(t,o){return t.map(function(l,h){return l*Math.pow(o,h)}).reduce(function(l,h){return l+h})},i6=function(t,o){return function(l){var h=S7(t,o);return E7(h,l)}},wse=function(t,o){return function(l){var h=S7(t,o),v=[].concat(yse(h.map(function(w,a){return w*a}).slice(1)),[0]);return E7(v,l)}},a6=function(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];var h=o[0],v=o[1],w=o[2],a=o[3];if(o.length===1)switch(o[0]){case"linear":h=0,v=0,w=1,a=1;break;case"ease":h=.25,v=.1,w=.25,a=1;break;case"ease-in":h=.42,v=0,w=1,a=1;break;case"ease-out":h=.42,v=0,w=.58,a=1;break;case"ease-in-out":h=0,v=0,w=.58,a=1;break;default:{var C=o[0].split("(");if(C[0]==="cubic-bezier"&&C[1].split(")")[0].split(",").length===4){var I=C[1].split(")")[0].split(",").map(function(K){return parseFloat(K)}),L=pse(I,4);h=L[0],v=L[1],w=L[2],a=L[3]}}}var k=i6(h,w),G=i6(v,a),q=wse(h,w),Q=function(he){return he>1?1:he<0?0:he},H=function(he){for(var ue=he>1?1:he,me=ue,ge=0;ge<8;++ge){var se=k(me)-ue,fe=q(me);if(Math.abs(se-ue)<aT||fe<aT)return G(me);me=Q(me-se/fe)}return G(me)};return H.isStepper=!1,H},Ase=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=t.stiff,l=o===void 0?100:o,h=t.damping,v=h===void 0?8:h,w=t.dt,a=w===void 0?17:w,C=function(L,k,G){var q=-(L-k)*l,Q=G*v,H=G+(q-Q)*a/1e3,K=G*a/1e3+L;return Math.abs(K-k)<aT&&Math.abs(H)<aT?[k,0]:[K,H]};return C.isStepper=!0,C.dt=a,C},Tse=function(){for(var t=arguments.length,o=new Array(t),l=0;l<t;l++)o[l]=arguments[l];var h=o[0];if(typeof h=="string")switch(h){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return a6(h);case"spring":return Ase();default:if(h.split("(")[0]==="cubic-bezier")return a6(h)}return typeof h=="function"?h:null};function Yb(r){"@babel/helpers - typeof";return Yb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(r)}function o6(r){return Mse(r)||Ese(r)||M7(r)||Sse()}function Sse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ese(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Mse(r){if(Array.isArray(r))return bP(r)}function s6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function ol(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?s6(Object(o),!0).forEach(function(l){xP(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):s6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function xP(r,t,o){return t=Ose(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Ose(r){var t=Cse(r,"string");return Yb(t)==="symbol"?t:String(t)}function Cse(r,t){if(Yb(r)!=="object"||r===null)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Yb(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Ise(r,t){return Rse(r)||Dse(r,t)||M7(r,t)||Pse()}function Pse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M7(r,t){if(r){if(typeof r=="string")return bP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return bP(r,t)}}function bP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Dse(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function Rse(r){if(Array.isArray(r))return r}var oT=function(t,o,l){return t+(o-t)*l},wP=function(t){var o=t.from,l=t.to;return o!==l},zse=function r(t,o,l){var h=mb(function(v,w){if(wP(w)){var a=t(w.from,w.to,w.velocity),C=Ise(a,2),I=C[0],L=C[1];return ol(ol({},w),{},{from:I,velocity:L})}return w},o);return l<1?mb(function(v,w){return wP(w)?ol(ol({},w),{},{velocity:oT(w.velocity,h[v].velocity,l),from:oT(w.from,h[v].from,l)}):w},o):r(t,h,l-1)};const Lse=(function(r,t,o,l,h){var v=hse(r,t),w=v.reduce(function(K,he){return ol(ol({},K),{},xP({},he,[r[he],t[he]]))},{}),a=v.reduce(function(K,he){return ol(ol({},K),{},xP({},he,{from:r[he],velocity:0,to:t[he]}))},{}),C=-1,I,L,k=function(){return null},G=function(){return mb(function(he,ue){return ue.from},a)},q=function(){return!Object.values(a).filter(wP).length},Q=function(he){I||(I=he);var ue=he-I,me=ue/o.dt;a=zse(o,a,me),h(ol(ol(ol({},r),t),G())),I=he,q()||(C=requestAnimationFrame(k))},H=function(he){L||(L=he);var ue=(he-L)/l,me=mb(function(se,fe){return oT.apply(void 0,o6(fe).concat([o(ue)]))},w);if(h(ol(ol(ol({},r),t),me)),ue<1)C=requestAnimationFrame(k);else{var ge=mb(function(se,fe){return oT.apply(void 0,o6(fe).concat([o(1)]))},w);h(ol(ol(ol({},r),t),ge))}};return k=o.isStepper?Q:H,function(){return requestAnimationFrame(k),function(){cancelAnimationFrame(C)}}});function J0(r){"@babel/helpers - typeof";return J0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J0(r)}var Bse=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function kse(r,t){if(r==null)return{};var o=Fse(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Fse(r,t){if(r==null)return{};var o={},l=Object.keys(r),h,v;for(v=0;v<l.length;v++)h=l[v],!(t.indexOf(h)>=0)&&(o[h]=r[h]);return o}function PC(r){return Vse(r)||Use(r)||jse(r)||Nse()}function Nse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jse(r,t){if(r){if(typeof r=="string")return AP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return AP(r,t)}}function Use(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Vse(r){if(Array.isArray(r))return AP(r)}function AP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function l6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Md(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?l6(Object(o),!0).forEach(function(l){K1(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):l6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function K1(r,t,o){return t=O7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Gse(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function $se(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,O7(l.key),l)}}function qse(r,t,o){return t&&$se(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function O7(r){var t=Hse(r,"string");return J0(t)==="symbol"?t:String(t)}function Hse(r,t){if(J0(r)!=="object"||r===null)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(J0(l)!=="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Xse(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&TP(r,t)}function TP(r,t){return TP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},TP(r,t)}function Zse(r){var t=Wse();return function(){var l=sT(r),h;if(t){var v=sT(this).constructor;h=Reflect.construct(l,arguments,v)}else h=l.apply(this,arguments);return SP(this,h)}}function SP(r,t){if(t&&(J0(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EP(r)}function EP(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Wse(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sT(r){return sT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},sT(r)}var Zf=(function(r){Xse(o,r);var t=Zse(o);function o(l,h){var v;Gse(this,o),v=t.call(this,l,h);var w=v.props,a=w.isActive,C=w.attributeName,I=w.from,L=w.to,k=w.steps,G=w.children,q=w.duration;if(v.handleStyleChange=v.handleStyleChange.bind(EP(v)),v.changeStyle=v.changeStyle.bind(EP(v)),!a||q<=0)return v.state={style:{}},typeof G=="function"&&(v.state={style:L}),SP(v);if(k&&k.length)v.state={style:k[0].style};else if(I){if(typeof G=="function")return v.state={style:I},SP(v);v.state={style:C?K1({},C,I):I}}else v.state={style:{}};return v}return qse(o,[{key:"componentDidMount",value:function(){var h=this.props,v=h.isActive,w=h.canBegin;this.mounted=!0,!(!v||!w)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(h){var v=this.props,w=v.isActive,a=v.canBegin,C=v.attributeName,I=v.shouldReAnimate,L=v.to,k=v.from,G=this.state.style;if(a){if(!w){var q={style:C?K1({},C,L):L};this.state&&G&&(C&&G[C]!==L||!C&&G!==L)&&this.setState(q);return}if(!(tse(h.to,L)&&h.canBegin&&h.isActive)){var Q=!h.canBegin||!h.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var H=Q||I?k:h.to;if(this.state&&G){var K={style:C?K1({},C,H):H};(C&&G[C]!==H||!C&&G!==H)&&this.setState(K)}this.runAnimation(Md(Md({},this.props),{},{from:H,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var h=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),h&&h()}},{key:"handleStyleChange",value:function(h){this.changeStyle(h)}},{key:"changeStyle",value:function(h){this.mounted&&this.setState({style:h})}},{key:"runJSAnimation",value:function(h){var v=this,w=h.from,a=h.to,C=h.duration,I=h.easing,L=h.begin,k=h.onAnimationEnd,G=h.onAnimationStart,q=Lse(w,a,Tse(I),C,this.changeStyle),Q=function(){v.stopJSAnimation=q()};this.manager.start([G,L,Q,C,k])}},{key:"runStepAnimation",value:function(h){var v=this,w=h.steps,a=h.begin,C=h.onAnimationStart,I=w[0],L=I.style,k=I.duration,G=k===void 0?0:k,q=function(H,K,he){if(he===0)return H;var ue=K.duration,me=K.easing,ge=me===void 0?"ease":me,se=K.style,fe=K.properties,ve=K.onAnimationEnd,Le=he>0?w[he-1]:K,Ue=fe||Object.keys(se);if(typeof ge=="function"||ge==="spring")return[].concat(PC(H),[v.runJSAnimation.bind(v,{from:Le.style,to:se,duration:ue,easing:ge}),ue]);var tt=n6(Ue,ue,ge),Ke=Md(Md(Md({},Le.style),se),{},{transition:tt});return[].concat(PC(H),[Ke,ue,ve]).filter(dse)};return this.manager.start([C].concat(PC(w.reduce(q,[L,Math.max(G,a)])),[h.onAnimationEnd]))}},{key:"runAnimation",value:function(h){this.manager||(this.manager=lse());var v=h.begin,w=h.duration,a=h.attributeName,C=h.to,I=h.easing,L=h.onAnimationStart,k=h.onAnimationEnd,G=h.steps,q=h.children,Q=this.manager;if(this.unSubscribe=Q.subscribe(this.handleStyleChange),typeof I=="function"||typeof q=="function"||I==="spring"){this.runJSAnimation(h);return}if(G.length>1){this.runStepAnimation(h);return}var H=a?K1({},a,C):C,K=n6(Object.keys(H),w,I);Q.start([L,v,Md(Md({},H),{},{transition:K}),w,k])}},{key:"render",value:function(){var h=this.props,v=h.children;h.begin;var w=h.duration;h.attributeName,h.easing;var a=h.isActive;h.steps,h.from,h.to,h.canBegin,h.onAnimationEnd,h.shouldReAnimate,h.onAnimationReStart;var C=kse(h,Bse),I=Jt.Children.count(v),L=this.state.style;if(typeof v=="function")return v(L);if(!a||I===0||w<=0)return v;var k=function(q){var Q=q.props,H=Q.style,K=H===void 0?{}:H,he=Q.className,ue=Jt.cloneElement(q,Md(Md({},C),{},{style:Md(Md({},K),L),className:he}));return ue};return I===1?k(Jt.Children.only(v)):ft.createElement("div",null,Jt.Children.map(v,function(G){return k(G)}))}}]),o})(Jt.PureComponent);Zf.displayName="Animate";Zf.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Zf.propTypes={from:sa.oneOfType([sa.object,sa.string]),to:sa.oneOfType([sa.object,sa.string]),attributeName:sa.string,duration:sa.number,begin:sa.number,easing:sa.oneOfType([sa.string,sa.func]),steps:sa.arrayOf(sa.shape({duration:sa.number.isRequired,style:sa.object.isRequired,easing:sa.oneOfType([sa.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),sa.func]),properties:sa.arrayOf("string"),onAnimationEnd:sa.func})),children:sa.oneOfType([sa.node,sa.func]),isActive:sa.bool,canBegin:sa.bool,onAnimationEnd:sa.func,shouldReAnimate:sa.bool,onAnimationStart:sa.func,onAnimationReStart:sa.func};function Kb(r){"@babel/helpers - typeof";return Kb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kb(r)}function lT(){return lT=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},lT.apply(this,arguments)}function Yse(r,t){return ele(r)||Jse(r,t)||Qse(r,t)||Kse()}function Kse(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qse(r,t){if(r){if(typeof r=="string")return c6(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return c6(r,t)}}function c6(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function Jse(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function ele(r){if(Array.isArray(r))return r}function u6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function h6(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?u6(Object(o),!0).forEach(function(l){tle(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):u6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function tle(r,t,o){return t=rle(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function rle(r){var t=nle(r,"string");return Kb(t)=="symbol"?t:t+""}function nle(r,t){if(Kb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Kb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var d6=function(t,o,l,h,v){var w=Math.min(Math.abs(l)/2,Math.abs(h)/2),a=h>=0?1:-1,C=l>=0?1:-1,I=h>=0&&l>=0||h<0&&l<0?1:0,L;if(w>0&&v instanceof Array){for(var k=[0,0,0,0],G=0,q=4;G<q;G++)k[G]=v[G]>w?w:v[G];L="M".concat(t,",").concat(o+a*k[0]),k[0]>0&&(L+="A ".concat(k[0],",").concat(k[0],",0,0,").concat(I,",").concat(t+C*k[0],",").concat(o)),L+="L ".concat(t+l-C*k[1],",").concat(o),k[1]>0&&(L+="A ".concat(k[1],",").concat(k[1],",0,0,").concat(I,`,
        `).concat(t+l,",").concat(o+a*k[1])),L+="L ".concat(t+l,",").concat(o+h-a*k[2]),k[2]>0&&(L+="A ".concat(k[2],",").concat(k[2],",0,0,").concat(I,`,
        `).concat(t+l-C*k[2],",").concat(o+h)),L+="L ".concat(t+C*k[3],",").concat(o+h),k[3]>0&&(L+="A ".concat(k[3],",").concat(k[3],",0,0,").concat(I,`,
        `).concat(t,",").concat(o+h-a*k[3])),L+="Z"}else if(w>0&&v===+v&&v>0){var Q=Math.min(w,v);L="M ".concat(t,",").concat(o+a*Q,`
            A `).concat(Q,",").concat(Q,",0,0,").concat(I,",").concat(t+C*Q,",").concat(o,`
            L `).concat(t+l-C*Q,",").concat(o,`
            A `).concat(Q,",").concat(Q,",0,0,").concat(I,",").concat(t+l,",").concat(o+a*Q,`
            L `).concat(t+l,",").concat(o+h-a*Q,`
            A `).concat(Q,",").concat(Q,",0,0,").concat(I,",").concat(t+l-C*Q,",").concat(o+h,`
            L `).concat(t+C*Q,",").concat(o+h,`
            A `).concat(Q,",").concat(Q,",0,0,").concat(I,",").concat(t,",").concat(o+h-a*Q," Z")}else L="M ".concat(t,",").concat(o," h ").concat(l," v ").concat(h," h ").concat(-l," Z");return L},ile=function(t,o){if(!t||!o)return!1;var l=t.x,h=t.y,v=o.x,w=o.y,a=o.width,C=o.height;if(Math.abs(a)>0&&Math.abs(C)>0){var I=Math.min(v,v+a),L=Math.max(v,v+a),k=Math.min(w,w+C),G=Math.max(w,w+C);return l>=I&&l<=L&&h>=k&&h<=G}return!1},ale={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AR=function(t){var o=h6(h6({},ale),t),l=Jt.useRef(),h=Jt.useState(-1),v=Yse(h,2),w=v[0],a=v[1];Jt.useEffect(function(){if(l.current&&l.current.getTotalLength)try{var ge=l.current.getTotalLength();ge&&a(ge)}catch{}},[]);var C=o.x,I=o.y,L=o.width,k=o.height,G=o.radius,q=o.className,Q=o.animationEasing,H=o.animationDuration,K=o.animationBegin,he=o.isAnimationActive,ue=o.isUpdateAnimationActive;if(C!==+C||I!==+I||L!==+L||k!==+k||L===0||k===0)return null;var me=li("recharts-rectangle",q);return ue?ft.createElement(Zf,{canBegin:w>0,from:{width:L,height:k,x:C,y:I},to:{width:L,height:k,x:C,y:I},duration:H,animationEasing:Q,isActive:ue},function(ge){var se=ge.width,fe=ge.height,ve=ge.x,Le=ge.y;return ft.createElement(Zf,{canBegin:w>0,from:"0px ".concat(w===-1?1:w,"px"),to:"".concat(w,"px 0px"),attributeName:"strokeDasharray",begin:K,duration:H,isActive:he,easing:Q},ft.createElement("path",lT({},xn(o,!0),{className:me,d:d6(ve,Le,se,fe,G),ref:l})))}):ft.createElement("path",lT({},xn(o,!0),{className:me,d:d6(C,I,L,k,G)}))},ole=["points","className","baseLinePoints","connectNulls"];function b0(){return b0=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},b0.apply(this,arguments)}function sle(r,t){if(r==null)return{};var o=lle(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function lle(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function f6(r){return dle(r)||hle(r)||ule(r)||cle()}function cle(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ule(r,t){if(r){if(typeof r=="string")return MP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return MP(r,t)}}function hle(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function dle(r){if(Array.isArray(r))return MP(r)}function MP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}var p6=function(t){return t&&t.x===+t.x&&t.y===+t.y},fle=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=[[]];return t.forEach(function(l){p6(l)?o[o.length-1].push(l):o[o.length-1].length>0&&o.push([])}),p6(t[0])&&o[o.length-1].push(t[0]),o[o.length-1].length<=0&&(o=o.slice(0,-1)),o},gb=function(t,o){var l=fle(t);o&&(l=[l.reduce(function(v,w){return[].concat(f6(v),f6(w))},[])]);var h=l.map(function(v){return v.reduce(function(w,a,C){return"".concat(w).concat(C===0?"M":"L").concat(a.x,",").concat(a.y)},"")}).join("");return l.length===1?"".concat(h,"Z"):h},ple=function(t,o,l){var h=gb(t,l);return"".concat(h.slice(-1)==="Z"?h.slice(0,-1):h,"L").concat(gb(o.reverse(),l).slice(1))},mle=function(t){var o=t.points,l=t.className,h=t.baseLinePoints,v=t.connectNulls,w=sle(t,ole);if(!o||!o.length)return null;var a=li("recharts-polygon",l);if(h&&h.length){var C=w.stroke&&w.stroke!=="none",I=ple(o,h,v);return ft.createElement("g",{className:a},ft.createElement("path",b0({},xn(w,!0),{fill:I.slice(-1)==="Z"?w.fill:"none",stroke:"none",d:I})),C?ft.createElement("path",b0({},xn(w,!0),{fill:"none",d:gb(o,v)})):null,C?ft.createElement("path",b0({},xn(w,!0),{fill:"none",d:gb(h,v)})):null)}var L=gb(o,v);return ft.createElement("path",b0({},xn(w,!0),{fill:L.slice(-1)==="Z"?w.fill:"none",className:a,d:L}))};function OP(){return OP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},OP.apply(this,arguments)}var nS=function(t){var o=t.cx,l=t.cy,h=t.r,v=t.className,w=li("recharts-dot",v);return o===+o&&l===+l&&h===+h?Jt.createElement("circle",OP({},xn(t,!1),PA(t),{className:w,cx:o,cy:l,r:h})):null};function Qb(r){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(r)}var gle=["x","y","top","left","width","height","className"];function CP(){return CP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},CP.apply(this,arguments)}function m6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function _le(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?m6(Object(o),!0).forEach(function(l){yle(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):m6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function yle(r,t,o){return t=vle(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function vle(r){var t=xle(r,"string");return Qb(t)=="symbol"?t:t+""}function xle(r,t){if(Qb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Qb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function ble(r,t){if(r==null)return{};var o=wle(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function wle(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}var Ale=function(t,o,l,h,v,w){return"M".concat(t,",").concat(v,"v").concat(h,"M").concat(w,",").concat(o,"h").concat(l)},Tle=function(t){var o=t.x,l=o===void 0?0:o,h=t.y,v=h===void 0?0:h,w=t.top,a=w===void 0?0:w,C=t.left,I=C===void 0?0:C,L=t.width,k=L===void 0?0:L,G=t.height,q=G===void 0?0:G,Q=t.className,H=ble(t,gle),K=_le({x:l,y:v,top:a,left:I,width:k,height:q},H);return!Ar(l)||!Ar(v)||!Ar(k)||!Ar(q)||!Ar(a)||!Ar(I)?null:ft.createElement("path",CP({},xn(K,!0),{className:li("recharts-cross",Q),d:Ale(l,v,k,q,a,I)}))},DC,g6;function Sle(){if(g6)return DC;g6=1;var r=QT(),t=G9(),o=Yf();function l(h,v){return h&&h.length?r(h,o(v,2),t):void 0}return DC=l,DC}var Ele=Sle();const Mle=ca(Ele);var RC,_6;function Ole(){if(_6)return RC;_6=1;var r=QT(),t=Yf(),o=$9();function l(h,v){return h&&h.length?r(h,t(v,2),o):void 0}return RC=l,RC}var Cle=Ole();const Ile=ca(Cle);var Ple=["cx","cy","angle","ticks","axisLine"],Dle=["ticks","tick","angle","tickFormatter","stroke"];function ex(r){"@babel/helpers - typeof";return ex=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ex(r)}function _b(){return _b=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},_b.apply(this,arguments)}function y6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function vy(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?y6(Object(o),!0).forEach(function(l){iS(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):y6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function v6(r,t){if(r==null)return{};var o=Rle(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Rle(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function zle(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function x6(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,I7(l.key),l)}}function Lle(r,t,o){return t&&x6(r.prototype,t),o&&x6(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ble(r,t,o){return t=cT(t),kle(r,C7()?Reflect.construct(t,o||[],cT(r).constructor):t.apply(r,o))}function kle(r,t){if(t&&(ex(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fle(r)}function Fle(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function C7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(C7=function(){return!!r})()}function cT(r){return cT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},cT(r)}function Nle(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&IP(r,t)}function IP(r,t){return IP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},IP(r,t)}function iS(r,t,o){return t=I7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function I7(r){var t=jle(r,"string");return ex(t)=="symbol"?t:t+""}function jle(r,t){if(ex(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ex(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var aS=(function(r){function t(){return zle(this,t),Ble(this,t,arguments)}return Nle(t,r),Lle(t,[{key:"getTickValueCoord",value:function(l){var h=l.coordinate,v=this.props,w=v.angle,a=v.cx,C=v.cy;return za(a,C,h,w)}},{key:"getTickTextAnchor",value:function(){var l=this.props.orientation,h;switch(l){case"left":h="end";break;case"right":h="start";break;default:h="middle";break}return h}},{key:"getViewBox",value:function(){var l=this.props,h=l.cx,v=l.cy,w=l.angle,a=l.ticks,C=Mle(a,function(L){return L.coordinate||0}),I=Ile(a,function(L){return L.coordinate||0});return{cx:h,cy:v,startAngle:w,endAngle:w,innerRadius:I.coordinate||0,outerRadius:C.coordinate||0}}},{key:"renderAxisLine",value:function(){var l=this.props,h=l.cx,v=l.cy,w=l.angle,a=l.ticks,C=l.axisLine,I=v6(l,Ple),L=a.reduce(function(Q,H){return[Math.min(Q[0],H.coordinate),Math.max(Q[1],H.coordinate)]},[1/0,-1/0]),k=za(h,v,L[0],w),G=za(h,v,L[1],w),q=vy(vy(vy({},xn(I,!1)),{},{fill:"none"},xn(C,!1)),{},{x1:k.x,y1:k.y,x2:G.x,y2:G.y});return ft.createElement("line",_b({className:"recharts-polar-radius-axis-line"},q))}},{key:"renderTicks",value:function(){var l=this,h=this.props,v=h.ticks,w=h.tick,a=h.angle,C=h.tickFormatter,I=h.stroke,L=v6(h,Dle),k=this.getTickTextAnchor(),G=xn(L,!1),q=xn(w,!1),Q=v.map(function(H,K){var he=l.getTickValueCoord(H),ue=vy(vy(vy(vy({textAnchor:k,transform:"rotate(".concat(90-a,", ").concat(he.x,", ").concat(he.y,")")},G),{},{stroke:"none",fill:I},q),{},{index:K},he),{},{payload:H});return ft.createElement(Gi,_b({className:li("recharts-polar-radius-axis-tick",y7(w)),key:"tick-".concat(H.coordinate)},Wy(l.props,H,K)),t.renderTickItem(w,ue,C?C(H.value,K):H.value))});return ft.createElement(Gi,{className:"recharts-polar-radius-axis-ticks"},Q)}},{key:"render",value:function(){var l=this.props,h=l.ticks,v=l.axisLine,w=l.tick;return!h||!h.length?null:ft.createElement(Gi,{className:li("recharts-polar-radius-axis",this.props.className)},v&&this.renderAxisLine(),w&&this.renderTicks(),qs.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(l,h,v){var w;return ft.isValidElement(l)?w=ft.cloneElement(l,h):Bn(l)?w=l(h):w=ft.createElement(Yy,_b({},h,{className:"recharts-polar-radius-axis-tick-value"}),v),w}}])})(Jt.PureComponent);iS(aS,"displayName","PolarRadiusAxis");iS(aS,"axisType","radiusAxis");iS(aS,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function tx(r){"@babel/helpers - typeof";return tx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tx(r)}function Ey(){return Ey=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},Ey.apply(this,arguments)}function b6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function xy(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?b6(Object(o),!0).forEach(function(l){oS(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):b6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Ule(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function w6(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,D7(l.key),l)}}function Vle(r,t,o){return t&&w6(r.prototype,t),o&&w6(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function Gle(r,t,o){return t=uT(t),$le(r,P7()?Reflect.construct(t,o||[],uT(r).constructor):t.apply(r,o))}function $le(r,t){if(t&&(tx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qle(r)}function qle(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function P7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(P7=function(){return!!r})()}function uT(r){return uT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},uT(r)}function Hle(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&PP(r,t)}function PP(r,t){return PP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},PP(r,t)}function oS(r,t,o){return t=D7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function D7(r){var t=Xle(r,"string");return tx(t)=="symbol"?t:t+""}function Xle(r,t){if(tx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(tx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Zle=Math.PI/180,A6=1e-5,sS=(function(r){function t(){return Ule(this,t),Gle(this,t,arguments)}return Hle(t,r),Vle(t,[{key:"getTickLineCoord",value:function(l){var h=this.props,v=h.cx,w=h.cy,a=h.radius,C=h.orientation,I=h.tickSize,L=I||8,k=za(v,w,a,l.coordinate),G=za(v,w,a+(C==="inner"?-1:1)*L,l.coordinate);return{x1:k.x,y1:k.y,x2:G.x,y2:G.y}}},{key:"getTickTextAnchor",value:function(l){var h=this.props.orientation,v=Math.cos(-l.coordinate*Zle),w;return v>A6?w=h==="outer"?"start":"end":v<-A6?w=h==="outer"?"end":"start":w="middle",w}},{key:"renderAxisLine",value:function(){var l=this.props,h=l.cx,v=l.cy,w=l.radius,a=l.axisLine,C=l.axisLineType,I=xy(xy({},xn(this.props,!1)),{},{fill:"none"},xn(a,!1));if(C==="circle")return ft.createElement(nS,Ey({className:"recharts-polar-angle-axis-line"},I,{cx:h,cy:v,r:w}));var L=this.props.ticks,k=L.map(function(G){return za(h,v,w,G.coordinate)});return ft.createElement(mle,Ey({className:"recharts-polar-angle-axis-line"},I,{points:k}))}},{key:"renderTicks",value:function(){var l=this,h=this.props,v=h.ticks,w=h.tick,a=h.tickLine,C=h.tickFormatter,I=h.stroke,L=xn(this.props,!1),k=xn(w,!1),G=xy(xy({},L),{},{fill:"none"},xn(a,!1)),q=v.map(function(Q,H){var K=l.getTickLineCoord(Q),he=l.getTickTextAnchor(Q),ue=xy(xy(xy({textAnchor:he},L),{},{stroke:"none",fill:I},k),{},{index:H,payload:Q,x:K.x2,y:K.y2});return ft.createElement(Gi,Ey({className:li("recharts-polar-angle-axis-tick",y7(w)),key:"tick-".concat(Q.coordinate)},Wy(l.props,Q,H)),a&&ft.createElement("line",Ey({className:"recharts-polar-angle-axis-tick-line"},G,K)),w&&t.renderTickItem(w,ue,C?C(Q.value,H):Q.value))});return ft.createElement(Gi,{className:"recharts-polar-angle-axis-ticks"},q)}},{key:"render",value:function(){var l=this.props,h=l.ticks,v=l.radius,w=l.axisLine;return v<=0||!h||!h.length?null:ft.createElement(Gi,{className:li("recharts-polar-angle-axis",this.props.className)},w&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(l,h,v){var w;return ft.isValidElement(l)?w=ft.cloneElement(l,h):Bn(l)?w=l(h):w=ft.createElement(Yy,Ey({},h,{className:"recharts-polar-angle-axis-tick-value"}),v),w}}])})(Jt.PureComponent);oS(sS,"displayName","PolarAngleAxis");oS(sS,"axisType","angleAxis");oS(sS,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var zC,T6;function Wle(){if(T6)return zC;T6=1;var r=VV(),t=r(Object.getPrototypeOf,Object);return zC=t,zC}var LC,S6;function Yle(){if(S6)return LC;S6=1;var r=vm(),t=Wle(),o=xm(),l="[object Object]",h=Function.prototype,v=Object.prototype,w=h.toString,a=v.hasOwnProperty,C=w.call(Object);function I(L){if(!o(L)||r(L)!=l)return!1;var k=t(L);if(k===null)return!0;var G=a.call(k,"constructor")&&k.constructor;return typeof G=="function"&&G instanceof G&&w.call(G)==C}return LC=I,LC}var Kle=Yle();const Qle=ca(Kle);var BC,E6;function Jle(){if(E6)return BC;E6=1;var r=vm(),t=xm(),o="[object Boolean]";function l(h){return h===!0||h===!1||t(h)&&r(h)==o}return BC=l,BC}var ece=Jle();const tce=ca(ece);function Jb(r){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(r)}function hT(){return hT=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},hT.apply(this,arguments)}function rce(r,t){return oce(r)||ace(r,t)||ice(r,t)||nce()}function nce(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ice(r,t){if(r){if(typeof r=="string")return M6(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return M6(r,t)}}function M6(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function ace(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function oce(r){if(Array.isArray(r))return r}function O6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function C6(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?O6(Object(o),!0).forEach(function(l){sce(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):O6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function sce(r,t,o){return t=lce(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function lce(r){var t=cce(r,"string");return Jb(t)=="symbol"?t:t+""}function cce(r,t){if(Jb(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Jb(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var I6=function(t,o,l,h,v){var w=l-h,a;return a="M ".concat(t,",").concat(o),a+="L ".concat(t+l,",").concat(o),a+="L ".concat(t+l-w/2,",").concat(o+v),a+="L ".concat(t+l-w/2-h,",").concat(o+v),a+="L ".concat(t,",").concat(o," Z"),a},uce={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hce=function(t){var o=C6(C6({},uce),t),l=Jt.useRef(),h=Jt.useState(-1),v=rce(h,2),w=v[0],a=v[1];Jt.useEffect(function(){if(l.current&&l.current.getTotalLength)try{var me=l.current.getTotalLength();me&&a(me)}catch{}},[]);var C=o.x,I=o.y,L=o.upperWidth,k=o.lowerWidth,G=o.height,q=o.className,Q=o.animationEasing,H=o.animationDuration,K=o.animationBegin,he=o.isUpdateAnimationActive;if(C!==+C||I!==+I||L!==+L||k!==+k||G!==+G||L===0&&k===0||G===0)return null;var ue=li("recharts-trapezoid",q);return he?ft.createElement(Zf,{canBegin:w>0,from:{upperWidth:0,lowerWidth:0,height:G,x:C,y:I},to:{upperWidth:L,lowerWidth:k,height:G,x:C,y:I},duration:H,animationEasing:Q,isActive:he},function(me){var ge=me.upperWidth,se=me.lowerWidth,fe=me.height,ve=me.x,Le=me.y;return ft.createElement(Zf,{canBegin:w>0,from:"0px ".concat(w===-1?1:w,"px"),to:"".concat(w,"px 0px"),attributeName:"strokeDasharray",begin:K,duration:H,easing:Q},ft.createElement("path",hT({},xn(o,!0),{className:ue,d:I6(ve,Le,ge,se,fe),ref:l})))}):ft.createElement("g",null,ft.createElement("path",hT({},xn(o,!0),{className:ue,d:I6(C,I,L,k,G)})))},dce=["option","shapeType","propTransformer","activeClassName","isActive"];function ew(r){"@babel/helpers - typeof";return ew=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ew(r)}function fce(r,t){if(r==null)return{};var o=pce(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function pce(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function P6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function dT(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?P6(Object(o),!0).forEach(function(l){mce(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):P6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function mce(r,t,o){return t=gce(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function gce(r){var t=_ce(r,"string");return ew(t)=="symbol"?t:t+""}function _ce(r,t){if(ew(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ew(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function yce(r,t){return dT(dT({},t),r)}function vce(r,t){return r==="symbols"}function D6(r){var t=r.shapeType,o=r.elementProps;switch(t){case"rectangle":return ft.createElement(AR,o);case"trapezoid":return ft.createElement(hce,o);case"sector":return ft.createElement(b7,o);case"symbols":if(vce(t))return ft.createElement(VD,o);break;default:return null}}function xce(r){return Jt.isValidElement(r)?r.props:r}function R7(r){var t=r.option,o=r.shapeType,l=r.propTransformer,h=l===void 0?yce:l,v=r.activeClassName,w=v===void 0?"recharts-active-shape":v,a=r.isActive,C=fce(r,dce),I;if(Jt.isValidElement(t))I=Jt.cloneElement(t,dT(dT({},C),xce(t)));else if(Bn(t))I=t(C);else if(Qle(t)&&!tce(t)){var L=h(t,C);I=ft.createElement(D6,{shapeType:o,elementProps:L})}else{var k=C;I=ft.createElement(D6,{shapeType:o,elementProps:k})}return a?ft.createElement(Gi,{className:w},I):I}function lS(r,t){return t!=null&&"trapezoids"in r.props}function cS(r,t){return t!=null&&"sectors"in r.props}function tw(r,t){return t!=null&&"points"in r.props}function bce(r,t){var o,l,h=r.x===(t==null||(o=t.labelViewBox)===null||o===void 0?void 0:o.x)||r.x===t.x,v=r.y===(t==null||(l=t.labelViewBox)===null||l===void 0?void 0:l.y)||r.y===t.y;return h&&v}function wce(r,t){var o=r.endAngle===t.endAngle,l=r.startAngle===t.startAngle;return o&&l}function Ace(r,t){var o=r.x===t.x,l=r.y===t.y,h=r.z===t.z;return o&&l&&h}function Tce(r,t){var o;return lS(r,t)?o=bce:cS(r,t)?o=wce:tw(r,t)&&(o=Ace),o}function Sce(r,t){var o;return lS(r,t)?o="trapezoids":cS(r,t)?o="sectors":tw(r,t)&&(o="points"),o}function Ece(r,t){if(lS(r,t)){var o;return(o=t.tooltipPayload)===null||o===void 0||(o=o[0])===null||o===void 0||(o=o.payload)===null||o===void 0?void 0:o.payload}if(cS(r,t)){var l;return(l=t.tooltipPayload)===null||l===void 0||(l=l[0])===null||l===void 0||(l=l.payload)===null||l===void 0?void 0:l.payload}return tw(r,t)?t.payload:{}}function Mce(r){var t=r.activeTooltipItem,o=r.graphicalItem,l=r.itemData,h=Sce(o,t),v=Ece(o,t),w=l.filter(function(C,I){var L=K0(v,C),k=o.props[h].filter(function(Q){var H=Tce(o,t);return H(Q,t)}),G=o.props[h].indexOf(k[k.length-1]),q=I===G;return L&&q}),a=l.indexOf(w[w.length-1]);return a}var mA;function rx(r){"@babel/helpers - typeof";return rx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rx(r)}function w0(){return w0=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},w0.apply(this,arguments)}function R6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Da(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?R6(Object(o),!0).forEach(function(l){Oh(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):R6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Oce(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function z6(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,L7(l.key),l)}}function Cce(r,t,o){return t&&z6(r.prototype,t),o&&z6(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ice(r,t,o){return t=fT(t),Pce(r,z7()?Reflect.construct(t,o||[],fT(r).constructor):t.apply(r,o))}function Pce(r,t){if(t&&(rx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dce(r)}function Dce(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function z7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(z7=function(){return!!r})()}function fT(r){return fT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},fT(r)}function Rce(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&DP(r,t)}function DP(r,t){return DP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},DP(r,t)}function Oh(r,t,o){return t=L7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function L7(r){var t=zce(r,"string");return rx(t)=="symbol"?t:t+""}function zce(r,t){if(rx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(rx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var wm=(function(r){function t(o){var l;return Oce(this,t),l=Ice(this,t,[o]),Oh(l,"pieRef",null),Oh(l,"sectorRefs",[]),Oh(l,"id",yx("recharts-pie-")),Oh(l,"handleAnimationEnd",function(){var h=l.props.onAnimationEnd;l.setState({isAnimationFinished:!0}),Bn(h)&&h()}),Oh(l,"handleAnimationStart",function(){var h=l.props.onAnimationStart;l.setState({isAnimationFinished:!1}),Bn(h)&&h()}),l.state={isAnimationFinished:!o.isAnimationActive,prevIsAnimationActive:o.isAnimationActive,prevAnimationId:o.animationId,sectorToFocus:0},l}return Rce(t,r),Cce(t,[{key:"isActiveIndex",value:function(l){var h=this.props.activeIndex;return Array.isArray(h)?h.indexOf(l)!==-1:l===h}},{key:"hasActiveIndex",value:function(){var l=this.props.activeIndex;return Array.isArray(l)?l.length!==0:l||l===0}},{key:"renderLabels",value:function(l){var h=this.props.isAnimationActive;if(h&&!this.state.isAnimationFinished)return null;var v=this.props,w=v.label,a=v.labelLine,C=v.dataKey,I=v.valueKey,L=xn(this.props,!1),k=xn(w,!1),G=xn(a,!1),q=w&&w.offsetRadius||20,Q=l.map(function(H,K){var he=(H.startAngle+H.endAngle)/2,ue=za(H.cx,H.cy,H.outerRadius+q,he),me=Da(Da(Da(Da({},L),H),{},{stroke:"none"},k),{},{index:K,textAnchor:t.getTextAnchor(ue.x,H.cx)},ue),ge=Da(Da(Da(Da({},L),H),{},{fill:"none",stroke:H.fill},G),{},{index:K,points:[za(H.cx,H.cy,H.outerRadius,he),ue]}),se=C;return ei(C)&&ei(I)?se="value":ei(C)&&(se=I),ft.createElement(Gi,{key:"label-".concat(H.startAngle,"-").concat(H.endAngle,"-").concat(H.midAngle,"-").concat(K)},a&&t.renderLabelLineItem(a,ge,"line"),t.renderLabelItem(w,me,Es(H,se)))});return ft.createElement(Gi,{className:"recharts-pie-labels"},Q)}},{key:"renderSectorsStatically",value:function(l){var h=this,v=this.props,w=v.activeShape,a=v.blendStroke,C=v.inactiveShape;return l.map(function(I,L){if(I?.startAngle===0&&I?.endAngle===0&&l.length!==1)return null;var k=h.isActiveIndex(L),G=C&&h.hasActiveIndex()?C:null,q=k?w:G,Q=Da(Da({},I),{},{stroke:a?I.fill:I.stroke,tabIndex:-1});return ft.createElement(Gi,w0({ref:function(K){K&&!h.sectorRefs.includes(K)&&h.sectorRefs.push(K)},tabIndex:-1,className:"recharts-pie-sector"},Wy(h.props,I,L),{key:"sector-".concat(I?.startAngle,"-").concat(I?.endAngle,"-").concat(I.midAngle,"-").concat(L)}),ft.createElement(R7,w0({option:q,isActive:k,shapeType:"sector"},Q)))})}},{key:"renderSectorsWithAnimation",value:function(){var l=this,h=this.props,v=h.sectors,w=h.isAnimationActive,a=h.animationBegin,C=h.animationDuration,I=h.animationEasing,L=h.animationId,k=this.state,G=k.prevSectors,q=k.prevIsAnimationActive;return ft.createElement(Zf,{begin:a,duration:C,isActive:w,easing:I,from:{t:0},to:{t:1},key:"pie-".concat(L,"-").concat(q),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(Q){var H=Q.t,K=[],he=v&&v[0],ue=he.startAngle;return v.forEach(function(me,ge){var se=G&&G[ge],fe=ge>0?ju(me,"paddingAngle",0):0;if(se){var ve=Uc(se.endAngle-se.startAngle,me.endAngle-me.startAngle),Le=Da(Da({},me),{},{startAngle:ue+fe,endAngle:ue+ve(H)+fe});K.push(Le),ue=Le.endAngle}else{var Ue=me.endAngle,tt=me.startAngle,Ke=Uc(0,Ue-tt),nt=Ke(H),st=Da(Da({},me),{},{startAngle:ue+fe,endAngle:ue+nt+fe});K.push(st),ue=st.endAngle}}),ft.createElement(Gi,null,l.renderSectorsStatically(K))})}},{key:"attachKeyboardHandlers",value:function(l){var h=this;l.onkeydown=function(v){if(!v.altKey)switch(v.key){case"ArrowLeft":{var w=++h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[w].focus(),h.setState({sectorToFocus:w});break}case"ArrowRight":{var a=--h.state.sectorToFocus<0?h.sectorRefs.length-1:h.state.sectorToFocus%h.sectorRefs.length;h.sectorRefs[a].focus(),h.setState({sectorToFocus:a});break}case"Escape":{h.sectorRefs[h.state.sectorToFocus].blur(),h.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var l=this.props,h=l.sectors,v=l.isAnimationActive,w=this.state.prevSectors;return v&&h&&h.length&&(!w||!K0(w,h))?this.renderSectorsWithAnimation():this.renderSectorsStatically(h)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var l=this,h=this.props,v=h.hide,w=h.sectors,a=h.className,C=h.label,I=h.cx,L=h.cy,k=h.innerRadius,G=h.outerRadius,q=h.isAnimationActive,Q=this.state.isAnimationFinished;if(v||!w||!w.length||!Ar(I)||!Ar(L)||!Ar(k)||!Ar(G))return null;var H=li("recharts-pie",a);return ft.createElement(Gi,{tabIndex:this.props.rootTabIndex,className:H,ref:function(he){l.pieRef=he}},this.renderSectors(),C&&this.renderLabels(w),qs.renderCallByParent(this.props,null,!1),(!q||Q)&&hm.renderCallByParent(this.props,w,!1))}}],[{key:"getDerivedStateFromProps",value:function(l,h){return h.prevIsAnimationActive!==l.isAnimationActive?{prevIsAnimationActive:l.isAnimationActive,prevAnimationId:l.animationId,curSectors:l.sectors,prevSectors:[],isAnimationFinished:!0}:l.isAnimationActive&&l.animationId!==h.prevAnimationId?{prevAnimationId:l.animationId,curSectors:l.sectors,prevSectors:h.curSectors,isAnimationFinished:!0}:l.sectors!==h.curSectors?{curSectors:l.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(l,h){return l>h?"start":l<h?"end":"middle"}},{key:"renderLabelLineItem",value:function(l,h,v){if(ft.isValidElement(l))return ft.cloneElement(l,h);if(Bn(l))return l(h);var w=li("recharts-pie-label-line",typeof l!="boolean"?l.className:"");return ft.createElement(L0,w0({},h,{key:v,type:"linear",className:w}))}},{key:"renderLabelItem",value:function(l,h,v){if(ft.isValidElement(l))return ft.cloneElement(l,h);var w=v;if(Bn(l)&&(w=l(h),ft.isValidElement(w)))return w;var a=li("recharts-pie-label-text",typeof l!="boolean"&&!Bn(l)?l.className:"");return ft.createElement(Yy,w0({},h,{alignmentBaseline:"middle",className:a}),w)}}])})(Jt.PureComponent);mA=wm;Oh(wm,"displayName","Pie");Oh(wm,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!rv.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Oh(wm,"parseDeltaAngle",function(r,t){var o=fc(t-r),l=Math.min(Math.abs(t-r),360);return o*l});Oh(wm,"getRealPieData",function(r){var t=r.data,o=r.children,l=xn(r,!1),h=Rh(o,qT);return t&&t.length?t.map(function(v,w){return Da(Da(Da({payload:v},l),v),h&&h[w]&&h[w].props)}):h&&h.length?h.map(function(v){return Da(Da({},l),v.props)}):[]});Oh(wm,"parseCoordinateOfPie",function(r,t){var o=t.top,l=t.left,h=t.width,v=t.height,w=_7(h,v),a=l+pc(r.cx,h,h/2),C=o+pc(r.cy,v,v/2),I=pc(r.innerRadius,w,0),L=pc(r.outerRadius,w,w*.8),k=r.maxRadius||Math.sqrt(h*h+v*v)/2;return{cx:a,cy:C,innerRadius:I,outerRadius:L,maxRadius:k}});Oh(wm,"getComposedData",function(r){var t=r.item,o=r.offset,l=t.type.defaultProps!==void 0?Da(Da({},t.type.defaultProps),t.props):t.props,h=mA.getRealPieData(l);if(!h||!h.length)return null;var v=l.cornerRadius,w=l.startAngle,a=l.endAngle,C=l.paddingAngle,I=l.dataKey,L=l.nameKey,k=l.valueKey,G=l.tooltipType,q=Math.abs(l.minAngle),Q=mA.parseCoordinateOfPie(l,o),H=mA.parseDeltaAngle(w,a),K=Math.abs(H),he=I;ei(I)&&ei(k)?(Dd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),he="value"):ei(I)&&(Dd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),he=k);var ue=h.filter(function(Le){return Es(Le,he,0)!==0}).length,me=(K>=360?ue:ue-1)*C,ge=K-ue*q-me,se=h.reduce(function(Le,Ue){var tt=Es(Ue,he,0);return Le+(Ar(tt)?tt:0)},0),fe;if(se>0){var ve;fe=h.map(function(Le,Ue){var tt=Es(Le,he,0),Ke=Es(Le,L,Ue),nt=(Ar(tt)?tt:0)/se,st;Ue?st=ve.endAngle+fc(H)*C*(tt!==0?1:0):st=w;var Rt=st+fc(H)*((tt!==0?q:0)+nt*ge),Mt=(st+Rt)/2,$e=(Q.innerRadius+Q.outerRadius)/2,rt=[{name:Ke,value:tt,payload:Le,dataKey:he,type:G}],Ct=za(Q.cx,Q.cy,$e,Mt);return ve=Da(Da(Da({percent:nt,cornerRadius:v,name:Ke,tooltipPayload:rt,midAngle:Mt,middleRadius:$e,tooltipPosition:Ct},Le),Q),{},{value:Es(Le,he),startAngle:st,endAngle:Rt,payload:Le,paddingAngle:fc(H)*C}),ve})}return Da(Da({},Q),{},{sectors:fe,data:h})});var kC,L6;function Lce(){if(L6)return kC;L6=1;var r=Math.ceil,t=Math.max;function o(l,h,v,w){for(var a=-1,C=t(r((h-l)/(v||1)),0),I=Array(C);C--;)I[w?C:++a]=l,l+=v;return I}return kC=o,kC}var FC,B6;function B7(){if(B6)return FC;B6=1;var r=i9(),t=1/0,o=17976931348623157e292;function l(h){if(!h)return h===0?h:0;if(h=r(h),h===t||h===-t){var v=h<0?-1:1;return v*o}return h===h?h:0}return FC=l,FC}var NC,k6;function Bce(){if(k6)return NC;k6=1;var r=Lce(),t=$T(),o=B7();function l(h){return function(v,w,a){return a&&typeof a!="number"&&t(v,w,a)&&(w=a=void 0),v=o(v),w===void 0?(w=v,v=0):w=o(w),a=a===void 0?v<w?1:-1:o(a),r(v,w,a,h)}}return NC=l,NC}var jC,F6;function kce(){if(F6)return jC;F6=1;var r=Bce(),t=r();return jC=t,jC}var Fce=kce();const pT=ca(Fce);function rw(r){"@babel/helpers - typeof";return rw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rw(r)}function N6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function j6(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?N6(Object(o),!0).forEach(function(l){k7(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):N6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function k7(r,t,o){return t=Nce(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Nce(r){var t=jce(r,"string");return rw(t)=="symbol"?t:t+""}function jce(r,t){if(rw(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(rw(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var Uce=["Webkit","Moz","O","ms"],Vce=function(t,o){var l=t.replace(/(\w)/,function(v){return v.toUpperCase()}),h=Uce.reduce(function(v,w){return j6(j6({},v),{},k7({},w+l,o))},{});return h[t]=o,h};function nx(r){"@babel/helpers - typeof";return nx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nx(r)}function mT(){return mT=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},mT.apply(this,arguments)}function U6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function UC(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?U6(Object(o),!0).forEach(function(l){Mu(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):U6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Gce(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function V6(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,N7(l.key),l)}}function $ce(r,t,o){return t&&V6(r.prototype,t),o&&V6(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function qce(r,t,o){return t=gT(t),Hce(r,F7()?Reflect.construct(t,o||[],gT(r).constructor):t.apply(r,o))}function Hce(r,t){if(t&&(nx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xce(r)}function Xce(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function F7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(F7=function(){return!!r})()}function gT(r){return gT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},gT(r)}function Zce(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&RP(r,t)}function RP(r,t){return RP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},RP(r,t)}function Mu(r,t,o){return t=N7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function N7(r){var t=Wce(r,"string");return nx(t)=="symbol"?t:t+""}function Wce(r,t){if(nx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(nx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Yce=function(t){var o=t.data,l=t.startIndex,h=t.endIndex,v=t.x,w=t.width,a=t.travellerWidth;if(!o||!o.length)return{};var C=o.length,I=fb().domain(pT(0,C)).range([v,v+w-a]),L=I.domain().map(function(k){return I(k)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:I(l),endX:I(h),scale:I,scaleValues:L}},G6=function(t){return t.changedTouches&&!!t.changedTouches.length},ix=(function(r){function t(o){var l;return Gce(this,t),l=qce(this,t,[o]),Mu(l,"handleDrag",function(h){l.leaveTimer&&(clearTimeout(l.leaveTimer),l.leaveTimer=null),l.state.isTravellerMoving?l.handleTravellerMove(h):l.state.isSlideMoving&&l.handleSlideDrag(h)}),Mu(l,"handleTouchMove",function(h){h.changedTouches!=null&&h.changedTouches.length>0&&l.handleDrag(h.changedTouches[0])}),Mu(l,"handleDragEnd",function(){l.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var h=l.props,v=h.endIndex,w=h.onDragEnd,a=h.startIndex;w?.({endIndex:v,startIndex:a})}),l.detachDragEndListener()}),Mu(l,"handleLeaveWrapper",function(){(l.state.isTravellerMoving||l.state.isSlideMoving)&&(l.leaveTimer=window.setTimeout(l.handleDragEnd,l.props.leaveTimeOut))}),Mu(l,"handleEnterSlideOrTraveller",function(){l.setState({isTextActive:!0})}),Mu(l,"handleLeaveSlideOrTraveller",function(){l.setState({isTextActive:!1})}),Mu(l,"handleSlideDragStart",function(h){var v=G6(h)?h.changedTouches[0]:h;l.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:v.pageX}),l.attachDragEndListener()}),l.travellerDragStartHandlers={startX:l.handleTravellerDragStart.bind(l,"startX"),endX:l.handleTravellerDragStart.bind(l,"endX")},l.state={},l}return Zce(t,r),$ce(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(l){var h=l.startX,v=l.endX,w=this.state.scaleValues,a=this.props,C=a.gap,I=a.data,L=I.length-1,k=Math.min(h,v),G=Math.max(h,v),q=t.getIndexInRange(w,k),Q=t.getIndexInRange(w,G);return{startIndex:q-q%C,endIndex:Q===L?L:Q-Q%C}}},{key:"getTextOfTick",value:function(l){var h=this.props,v=h.data,w=h.tickFormatter,a=h.dataKey,C=Es(v[l],a,l);return Bn(w)?w(C,l):C}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(l){var h=this.state,v=h.slideMoveStartX,w=h.startX,a=h.endX,C=this.props,I=C.x,L=C.width,k=C.travellerWidth,G=C.startIndex,q=C.endIndex,Q=C.onChange,H=l.pageX-v;H>0?H=Math.min(H,I+L-k-a,I+L-k-w):H<0&&(H=Math.max(H,I-w,I-a));var K=this.getIndex({startX:w+H,endX:a+H});(K.startIndex!==G||K.endIndex!==q)&&Q&&Q(K),this.setState({startX:w+H,endX:a+H,slideMoveStartX:l.pageX})}},{key:"handleTravellerDragStart",value:function(l,h){var v=G6(h)?h.changedTouches[0]:h;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:l,brushMoveStartX:v.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(l){var h=this.state,v=h.brushMoveStartX,w=h.movingTravellerId,a=h.endX,C=h.startX,I=this.state[w],L=this.props,k=L.x,G=L.width,q=L.travellerWidth,Q=L.onChange,H=L.gap,K=L.data,he={startX:this.state.startX,endX:this.state.endX},ue=l.pageX-v;ue>0?ue=Math.min(ue,k+G-q-I):ue<0&&(ue=Math.max(ue,k-I)),he[w]=I+ue;var me=this.getIndex(he),ge=me.startIndex,se=me.endIndex,fe=function(){var Le=K.length-1;return w==="startX"&&(a>C?ge%H===0:se%H===0)||a<C&&se===Le||w==="endX"&&(a>C?se%H===0:ge%H===0)||a>C&&se===Le};this.setState(Mu(Mu({},w,I+ue),"brushMoveStartX",l.pageX),function(){Q&&fe()&&Q(me)})}},{key:"handleTravellerMoveKeyboard",value:function(l,h){var v=this,w=this.state,a=w.scaleValues,C=w.startX,I=w.endX,L=this.state[h],k=a.indexOf(L);if(k!==-1){var G=k+l;if(!(G===-1||G>=a.length)){var q=a[G];h==="startX"&&q>=I||h==="endX"&&q<=C||this.setState(Mu({},h,q),function(){v.props.onChange(v.getIndex({startX:v.state.startX,endX:v.state.endX}))})}}}},{key:"renderBackground",value:function(){var l=this.props,h=l.x,v=l.y,w=l.width,a=l.height,C=l.fill,I=l.stroke;return ft.createElement("rect",{stroke:I,fill:C,x:h,y:v,width:w,height:a})}},{key:"renderPanorama",value:function(){var l=this.props,h=l.x,v=l.y,w=l.width,a=l.height,C=l.data,I=l.children,L=l.padding,k=Jt.Children.only(I);return k?ft.cloneElement(k,{x:h,y:v,width:w,height:a,margin:L,compact:!0,data:C}):null}},{key:"renderTravellerLayer",value:function(l,h){var v,w,a=this,C=this.props,I=C.y,L=C.travellerWidth,k=C.height,G=C.traveller,q=C.ariaLabel,Q=C.data,H=C.startIndex,K=C.endIndex,he=Math.max(l,this.props.x),ue=UC(UC({},xn(this.props,!1)),{},{x:he,y:I,width:L,height:k}),me=q||"Min value: ".concat((v=Q[H])===null||v===void 0?void 0:v.name,", Max value: ").concat((w=Q[K])===null||w===void 0?void 0:w.name);return ft.createElement(Gi,{tabIndex:0,role:"slider","aria-label":me,"aria-valuenow":l,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[h],onTouchStart:this.travellerDragStartHandlers[h],onKeyDown:function(se){["ArrowLeft","ArrowRight"].includes(se.key)&&(se.preventDefault(),se.stopPropagation(),a.handleTravellerMoveKeyboard(se.key==="ArrowRight"?1:-1,h))},onFocus:function(){a.setState({isTravellerFocused:!0})},onBlur:function(){a.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(G,ue))}},{key:"renderSlide",value:function(l,h){var v=this.props,w=v.y,a=v.height,C=v.stroke,I=v.travellerWidth,L=Math.min(l,h)+I,k=Math.max(Math.abs(h-l)-I,0);return ft.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:C,fillOpacity:.2,x:L,y:w,width:k,height:a})}},{key:"renderText",value:function(){var l=this.props,h=l.startIndex,v=l.endIndex,w=l.y,a=l.height,C=l.travellerWidth,I=l.stroke,L=this.state,k=L.startX,G=L.endX,q=5,Q={pointerEvents:"none",fill:I};return ft.createElement(Gi,{className:"recharts-brush-texts"},ft.createElement(Yy,mT({textAnchor:"end",verticalAnchor:"middle",x:Math.min(k,G)-q,y:w+a/2},Q),this.getTextOfTick(h)),ft.createElement(Yy,mT({textAnchor:"start",verticalAnchor:"middle",x:Math.max(k,G)+C+q,y:w+a/2},Q),this.getTextOfTick(v)))}},{key:"render",value:function(){var l=this.props,h=l.data,v=l.className,w=l.children,a=l.x,C=l.y,I=l.width,L=l.height,k=l.alwaysShowText,G=this.state,q=G.startX,Q=G.endX,H=G.isTextActive,K=G.isSlideMoving,he=G.isTravellerMoving,ue=G.isTravellerFocused;if(!h||!h.length||!Ar(a)||!Ar(C)||!Ar(I)||!Ar(L)||I<=0||L<=0)return null;var me=li("recharts-brush",v),ge=ft.Children.count(w)===1,se=Vce("userSelect","none");return ft.createElement(Gi,{className:me,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:se},this.renderBackground(),ge&&this.renderPanorama(),this.renderSlide(q,Q),this.renderTravellerLayer(q,"startX"),this.renderTravellerLayer(Q,"endX"),(H||K||he||ue||k)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(l){var h=l.x,v=l.y,w=l.width,a=l.height,C=l.stroke,I=Math.floor(v+a/2)-1;return ft.createElement(ft.Fragment,null,ft.createElement("rect",{x:h,y:v,width:w,height:a,fill:C,stroke:"none"}),ft.createElement("line",{x1:h+1,y1:I,x2:h+w-1,y2:I,fill:"none",stroke:"#fff"}),ft.createElement("line",{x1:h+1,y1:I+2,x2:h+w-1,y2:I+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(l,h){var v;return ft.isValidElement(l)?v=ft.cloneElement(l,h):Bn(l)?v=l(h):v=t.renderDefaultTraveller(h),v}},{key:"getDerivedStateFromProps",value:function(l,h){var v=l.data,w=l.width,a=l.x,C=l.travellerWidth,I=l.updateId,L=l.startIndex,k=l.endIndex;if(v!==h.prevData||I!==h.prevUpdateId)return UC({prevData:v,prevTravellerWidth:C,prevUpdateId:I,prevX:a,prevWidth:w},v&&v.length?Yce({data:v,width:w,x:a,travellerWidth:C,startIndex:L,endIndex:k}):{scale:null,scaleValues:null});if(h.scale&&(w!==h.prevWidth||a!==h.prevX||C!==h.prevTravellerWidth)){h.scale.range([a,a+w-C]);var G=h.scale.domain().map(function(q){return h.scale(q)});return{prevData:v,prevTravellerWidth:C,prevUpdateId:I,prevX:a,prevWidth:w,startX:h.scale(l.startIndex),endX:h.scale(l.endIndex),scaleValues:G}}return null}},{key:"getIndexInRange",value:function(l,h){for(var v=l.length,w=0,a=v-1;a-w>1;){var C=Math.floor((w+a)/2);l[C]>h?a=C:w=C}return h>=l[a]?a:w}}])})(Jt.PureComponent);Mu(ix,"displayName","Brush");Mu(ix,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var VC,$6;function Kce(){if($6)return VC;$6=1;var r=WD();function t(o,l){var h;return r(o,function(v,w,a){return h=l(v,w,a),!h}),!!h}return VC=t,VC}var GC,q6;function Qce(){if(q6)return GC;q6=1;var r=LV(),t=Yf(),o=Kce(),l=Zc(),h=$T();function v(w,a,C){var I=l(w)?r:o;return C&&h(w,a,C)&&(a=void 0),I(w,t(a,3))}return GC=v,GC}var Jce=Qce();const eue=ca(Jce);var qf=function(t,o){var l=t.alwaysShow,h=t.ifOverflow;return l&&(h="extendDomain"),h===o},$C,H6;function tue(){if(H6)return $C;H6=1;var r=JV();function t(o,l,h){l=="__proto__"&&r?r(o,l,{configurable:!0,enumerable:!0,value:h,writable:!0}):o[l]=h}return $C=t,$C}var qC,X6;function rue(){if(X6)return qC;X6=1;var r=tue(),t=KV(),o=Yf();function l(h,v){var w={};return v=o(v,3),t(h,function(a,C,I){r(w,C,v(a,C,I))}),w}return qC=l,qC}var nue=rue();const iue=ca(nue);var HC,Z6;function aue(){if(Z6)return HC;Z6=1;function r(t,o){for(var l=-1,h=t==null?0:t.length;++l<h;)if(!o(t[l],l,t))return!1;return!0}return HC=r,HC}var XC,W6;function oue(){if(W6)return XC;W6=1;var r=WD();function t(o,l){var h=!0;return r(o,function(v,w,a){return h=!!l(v,w,a),h}),h}return XC=t,XC}var ZC,Y6;function sue(){if(Y6)return ZC;Y6=1;var r=aue(),t=oue(),o=Yf(),l=Zc(),h=$T();function v(w,a,C){var I=l(w)?r:t;return C&&h(w,a,C)&&(a=void 0),I(w,o(a,3))}return ZC=v,ZC}var lue=sue();const j7=ca(lue);var cue=["x","y"];function nw(r){"@babel/helpers - typeof";return nw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nw(r)}function zP(){return zP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},zP.apply(this,arguments)}function K6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function U1(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?K6(Object(o),!0).forEach(function(l){uue(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):K6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function uue(r,t,o){return t=hue(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function hue(r){var t=due(r,"string");return nw(t)=="symbol"?t:t+""}function due(r,t){if(nw(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(nw(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function fue(r,t){if(r==null)return{};var o=pue(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function pue(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function mue(r,t){var o=r.x,l=r.y,h=fue(r,cue),v="".concat(o),w=parseInt(v,10),a="".concat(l),C=parseInt(a,10),I="".concat(t.height||h.height),L=parseInt(I,10),k="".concat(t.width||h.width),G=parseInt(k,10);return U1(U1(U1(U1(U1({},t),h),w?{x:w}:{}),C?{y:C}:{}),{},{height:L,width:G,name:t.name,radius:t.radius})}function Q6(r){return ft.createElement(R7,zP({shapeType:"rectangle",propTransformer:mue,activeClassName:"recharts-active-bar"},r))}var gue=function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(l,h){if(typeof t=="number")return t;var v=Ar(l)||BY(l);return v?t(l,h):(v||Qy(),o)}},_ue=["value","background"],U7;function ax(r){"@babel/helpers - typeof";return ax=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ax(r)}function yue(r,t){if(r==null)return{};var o=vue(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function vue(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function _T(){return _T=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},_T.apply(this,arguments)}function J6(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function ts(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?J6(Object(o),!0).forEach(function(l){Ug(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):J6(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function xue(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function eU(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,G7(l.key),l)}}function bue(r,t,o){return t&&eU(r.prototype,t),o&&eU(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function wue(r,t,o){return t=yT(t),Aue(r,V7()?Reflect.construct(t,o||[],yT(r).constructor):t.apply(r,o))}function Aue(r,t){if(t&&(ax(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tue(r)}function Tue(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function V7(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(V7=function(){return!!r})()}function yT(r){return yT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},yT(r)}function Sue(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&LP(r,t)}function LP(r,t){return LP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},LP(r,t)}function Ug(r,t,o){return t=G7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function G7(r){var t=Eue(r,"string");return ax(t)=="symbol"?t:t+""}function Eue(r,t){if(ax(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ax(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var dm=(function(r){function t(){var o;xue(this,t);for(var l=arguments.length,h=new Array(l),v=0;v<l;v++)h[v]=arguments[v];return o=wue(this,t,[].concat(h)),Ug(o,"state",{isAnimationFinished:!1}),Ug(o,"id",yx("recharts-bar-")),Ug(o,"handleAnimationEnd",function(){var w=o.props.onAnimationEnd;o.setState({isAnimationFinished:!0}),w&&w()}),Ug(o,"handleAnimationStart",function(){var w=o.props.onAnimationStart;o.setState({isAnimationFinished:!1}),w&&w()}),o}return Sue(t,r),bue(t,[{key:"renderRectanglesStatically",value:function(l){var h=this,v=this.props,w=v.shape,a=v.dataKey,C=v.activeIndex,I=v.activeBar,L=xn(this.props,!1);return l&&l.map(function(k,G){var q=G===C,Q=q?I:w,H=ts(ts(ts({},L),k),{},{isActive:q,option:Q,index:G,dataKey:a,onAnimationStart:h.handleAnimationStart,onAnimationEnd:h.handleAnimationEnd});return ft.createElement(Gi,_T({className:"recharts-bar-rectangle"},Wy(h.props,k,G),{key:"rectangle-".concat(k?.x,"-").concat(k?.y,"-").concat(k?.value,"-").concat(G)}),ft.createElement(Q6,H))})}},{key:"renderRectanglesWithAnimation",value:function(){var l=this,h=this.props,v=h.data,w=h.layout,a=h.isAnimationActive,C=h.animationBegin,I=h.animationDuration,L=h.animationEasing,k=h.animationId,G=this.state.prevData;return ft.createElement(Zf,{begin:C,duration:I,isActive:a,easing:L,from:{t:0},to:{t:1},key:"bar-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(q){var Q=q.t,H=v.map(function(K,he){var ue=G&&G[he];if(ue){var me=Uc(ue.x,K.x),ge=Uc(ue.y,K.y),se=Uc(ue.width,K.width),fe=Uc(ue.height,K.height);return ts(ts({},K),{},{x:me(Q),y:ge(Q),width:se(Q),height:fe(Q)})}if(w==="horizontal"){var ve=Uc(0,K.height),Le=ve(Q);return ts(ts({},K),{},{y:K.y+K.height-Le,height:Le})}var Ue=Uc(0,K.width),tt=Ue(Q);return ts(ts({},K),{},{width:tt})});return ft.createElement(Gi,null,l.renderRectanglesStatically(H))})}},{key:"renderRectangles",value:function(){var l=this.props,h=l.data,v=l.isAnimationActive,w=this.state.prevData;return v&&h&&h.length&&(!w||!K0(w,h))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(h)}},{key:"renderBackground",value:function(){var l=this,h=this.props,v=h.data,w=h.dataKey,a=h.activeIndex,C=xn(this.props.background,!1);return v.map(function(I,L){I.value;var k=I.background,G=yue(I,_ue);if(!k)return null;var q=ts(ts(ts(ts(ts({},G),{},{fill:"#eee"},k),C),Wy(l.props,I,L)),{},{onAnimationStart:l.handleAnimationStart,onAnimationEnd:l.handleAnimationEnd,dataKey:w,index:L,className:"recharts-bar-background-rectangle"});return ft.createElement(Q6,_T({key:"background-bar-".concat(L),option:l.props.background,isActive:L===a},q))})}},{key:"renderErrorBar",value:function(l,h){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var v=this.props,w=v.data,a=v.xAxis,C=v.yAxis,I=v.layout,L=v.children,k=Rh(L,rS);if(!k)return null;var G=I==="vertical"?w[0].height/2:w[0].width/2,q=function(K,he){var ue=Array.isArray(K.value)?K.value[1]:K.value;return{x:K.x,y:K.y,value:ue,errorVal:Es(K,he)}},Q={clipPath:l?"url(#clipPath-".concat(h,")"):null};return ft.createElement(Gi,Q,k.map(function(H){return ft.cloneElement(H,{key:"error-bar-".concat(h,"-").concat(H.props.dataKey),data:w,xAxis:a,yAxis:C,layout:I,offset:G,dataPointFormatter:q})}))}},{key:"render",value:function(){var l=this.props,h=l.hide,v=l.data,w=l.className,a=l.xAxis,C=l.yAxis,I=l.left,L=l.top,k=l.width,G=l.height,q=l.isAnimationActive,Q=l.background,H=l.id;if(h||!v||!v.length)return null;var K=this.state.isAnimationFinished,he=li("recharts-bar",w),ue=a&&a.allowDataOverflow,me=C&&C.allowDataOverflow,ge=ue||me,se=ei(H)?this.id:H;return ft.createElement(Gi,{className:he},ue||me?ft.createElement("defs",null,ft.createElement("clipPath",{id:"clipPath-".concat(se)},ft.createElement("rect",{x:ue?I:I-k/2,y:me?L:L-G/2,width:ue?k:k*2,height:me?G:G*2}))):null,ft.createElement(Gi,{className:"recharts-bar-rectangles",clipPath:ge?"url(#clipPath-".concat(se,")"):null},Q?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(ge,se),(!q||K)&&hm.renderCallByParent(this.props,v))}}],[{key:"getDerivedStateFromProps",value:function(l,h){return l.animationId!==h.prevAnimationId?{prevAnimationId:l.animationId,curData:l.data,prevData:h.curData}:l.data!==h.curData?{curData:l.data}:null}}])})(Jt.PureComponent);U7=dm;Ug(dm,"displayName","Bar");Ug(dm,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!rv.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});Ug(dm,"getComposedData",function(r){var t=r.props,o=r.item,l=r.barPosition,h=r.bandSize,v=r.xAxis,w=r.yAxis,a=r.xAxisTicks,C=r.yAxisTicks,I=r.stackedData,L=r.dataStartIndex,k=r.displayedData,G=r.offset,q=Kie(l,o);if(!q)return null;var Q=t.layout,H=o.type.defaultProps,K=H!==void 0?ts(ts({},H),o.props):o.props,he=K.dataKey,ue=K.children,me=K.minPointSize,ge=Q==="horizontal"?w:v,se=I?ge.scale.domain():null,fe=iae({numericAxis:ge}),ve=Rh(ue,qT),Le=k.map(function(Ue,tt){var Ke,nt,st,Rt,Mt,$e;I?Ke=Qie(I[L+tt],se):(Ke=Es(Ue,he),Array.isArray(Ke)||(Ke=[fe,Ke]));var rt=gue(me,U7.defaultProps.minPointSize)(Ke[1],tt);if(Q==="horizontal"){var Ct,Kt=[w.scale(Ke[0]),w.scale(Ke[1])],Je=Kt[0],Ze=Kt[1];nt=Oj({axis:v,ticks:a,bandSize:h,offset:q.offset,entry:Ue,index:tt}),st=(Ct=Ze??Je)!==null&&Ct!==void 0?Ct:void 0,Rt=q.size;var gt=Je-Ze;if(Mt=Number.isNaN(gt)?0:gt,$e={x:nt,y:w.y,width:Rt,height:w.height},Math.abs(rt)>0&&Math.abs(Mt)<Math.abs(rt)){var Bt=fc(Mt||rt)*(Math.abs(rt)-Math.abs(Mt));st-=Bt,Mt+=Bt}}else{var ar=[v.scale(Ke[0]),v.scale(Ke[1])],Er=ar[0],jr=ar[1];if(nt=Er,st=Oj({axis:w,ticks:C,bandSize:h,offset:q.offset,entry:Ue,index:tt}),Rt=jr-Er,Mt=q.size,$e={x:v.x,y:st,width:v.width,height:Mt},Math.abs(rt)>0&&Math.abs(Rt)<Math.abs(rt)){var Zr=fc(Rt||rt)*(Math.abs(rt)-Math.abs(Rt));Rt+=Zr}}return ts(ts(ts({},Ue),{},{x:nt,y:st,width:Rt,height:Mt,value:I?Ke:Ke[1],payload:Ue,background:$e},ve&&ve[tt]&&ve[tt].props),{},{tooltipPayload:[m7(o,Ue)],tooltipPosition:{x:nt+Rt/2,y:st+Mt/2}})});return ts({data:Le,layout:Q},G)});function iw(r){"@babel/helpers - typeof";return iw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(r)}function Mue(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function tU(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,$7(l.key),l)}}function Oue(r,t,o){return t&&tU(r.prototype,t),o&&tU(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function rU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Cd(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?rU(Object(o),!0).forEach(function(l){uS(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):rU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function uS(r,t,o){return t=$7(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function $7(r){var t=Cue(r,"string");return iw(t)=="symbol"?t:t+""}function Cue(r,t){if(iw(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(iw(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var q7=function(t,o,l,h,v){var w=t.width,a=t.height,C=t.layout,I=t.children,L=Object.keys(o),k={left:l.left,leftMirror:l.left,right:w-l.right,rightMirror:w-l.right,top:l.top,topMirror:l.top,bottom:a-l.bottom,bottomMirror:a-l.bottom},G=!!Iu(I,dm);return L.reduce(function(q,Q){var H=o[Q],K=H.orientation,he=H.domain,ue=H.padding,me=ue===void 0?{}:ue,ge=H.mirror,se=H.reversed,fe="".concat(K).concat(ge?"Mirror":""),ve,Le,Ue,tt,Ke;if(H.type==="number"&&(H.padding==="gap"||H.padding==="no-gap")){var nt=he[1]-he[0],st=1/0,Rt=H.categoricalDomain.sort(NY);if(Rt.forEach(function(ar,Er){Er>0&&(st=Math.min((ar||0)-(Rt[Er-1]||0),st))}),Number.isFinite(st)){var Mt=st/nt,$e=H.layout==="vertical"?l.height:l.width;if(H.padding==="gap"&&(ve=Mt*$e/2),H.padding==="no-gap"){var rt=pc(t.barCategoryGap,Mt*$e),Ct=Mt*$e/2;ve=Ct-rt-(Ct-rt)/$e*rt}}}h==="xAxis"?Le=[l.left+(me.left||0)+(ve||0),l.left+l.width-(me.right||0)-(ve||0)]:h==="yAxis"?Le=C==="horizontal"?[l.top+l.height-(me.bottom||0),l.top+(me.top||0)]:[l.top+(me.top||0)+(ve||0),l.top+l.height-(me.bottom||0)-(ve||0)]:Le=H.range,se&&(Le=[Le[1],Le[0]]);var Kt=h7(H,v,G),Je=Kt.scale,Ze=Kt.realScaleType;Je.domain(he).range(Le),d7(Je);var gt=f7(Je,Cd(Cd({},H),{},{realScaleType:Ze}));h==="xAxis"?(Ke=K==="top"&&!ge||K==="bottom"&&ge,Ue=l.left,tt=k[fe]-Ke*H.height):h==="yAxis"&&(Ke=K==="left"&&!ge||K==="right"&&ge,Ue=k[fe]-Ke*H.width,tt=l.top);var Bt=Cd(Cd(Cd({},H),gt),{},{realScaleType:Ze,x:Ue,y:tt,scale:Je,width:h==="xAxis"?l.width:H.width,height:h==="yAxis"?l.height:H.height});return Bt.bandSize=tT(Bt,gt),!H.hide&&h==="xAxis"?k[fe]+=(Ke?-1:1)*Bt.height:H.hide||(k[fe]+=(Ke?-1:1)*Bt.width),Cd(Cd({},q),{},uS({},Q,Bt))},{})},H7=function(t,o){var l=t.x,h=t.y,v=o.x,w=o.y;return{x:Math.min(l,v),y:Math.min(h,w),width:Math.abs(v-l),height:Math.abs(w-h)}},Iue=function(t){var o=t.x1,l=t.y1,h=t.x2,v=t.y2;return H7({x:o,y:l},{x:h,y:v})},X7=(function(){function r(t){Mue(this,r),this.scale=t}return Oue(r,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=l.bandAware,v=l.position;if(o!==void 0){if(v)switch(v){case"start":return this.scale(o);case"middle":{var w=this.bandwidth?this.bandwidth()/2:0;return this.scale(o)+w}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(o)+a}default:return this.scale(o)}if(h){var C=this.bandwidth?this.bandwidth()/2:0;return this.scale(o)+C}return this.scale(o)}}},{key:"isInRange",value:function(o){var l=this.range(),h=l[0],v=l[l.length-1];return h<=v?o>=h&&o<=v:o>=v&&o<=h}}],[{key:"create",value:function(o){return new r(o)}}])})();uS(X7,"EPS",1e-4);var TR=function(t){var o=Object.keys(t).reduce(function(l,h){return Cd(Cd({},l),{},uS({},h,X7.create(t[h])))},{});return Cd(Cd({},o),{},{apply:function(h){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},w=v.bandAware,a=v.position;return iue(h,function(C,I){return o[I].apply(C,{bandAware:w,position:a})})},isInRange:function(h){return j7(h,function(v,w){return o[w].isInRange(v)})}})};function Pue(r){return(r%180+180)%180}var Due=function(t){var o=t.width,l=t.height,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,v=Pue(h),w=v*Math.PI/180,a=Math.atan(l/o),C=w>a&&w<Math.PI-a?l/Math.sin(w):o/Math.cos(w);return Math.abs(C)},WC,nU;function Rue(){if(nU)return WC;nU=1;var r=Yf(),t=uw(),o=VT();function l(h){return function(v,w,a){var C=Object(v);if(!t(v)){var I=r(w,3);v=o(v),w=function(k){return I(C[k],k,C)}}var L=h(v,w,a);return L>-1?C[I?v[L]:L]:void 0}}return WC=l,WC}var YC,iU;function zue(){if(iU)return YC;iU=1;var r=B7();function t(o){var l=r(o),h=l%1;return l===l?h?l-h:l:0}return YC=t,YC}var KC,aU;function Lue(){if(aU)return KC;aU=1;var r=HV(),t=Yf(),o=zue(),l=Math.max;function h(v,w,a){var C=v==null?0:v.length;if(!C)return-1;var I=a==null?0:o(a);return I<0&&(I=l(C+I,0)),r(v,t(w,3),I)}return KC=h,KC}var QC,oU;function Bue(){if(oU)return QC;oU=1;var r=Rue(),t=Lue(),o=r(t);return QC=o,QC}var kue=Bue();const Fue=ca(kue);var Nue=lV();const jue=ca(Nue);var Uue=jue(function(r){return{x:r.left,y:r.top,width:r.width,height:r.height}},function(r){return["l",r.left,"t",r.top,"w",r.width,"h",r.height].join("")}),SR=Jt.createContext(void 0),ER=Jt.createContext(void 0),Z7=Jt.createContext(void 0),W7=Jt.createContext({}),Y7=Jt.createContext(void 0),K7=Jt.createContext(0),Q7=Jt.createContext(0),sU=function(t){var o=t.state,l=o.xAxisMap,h=o.yAxisMap,v=o.offset,w=t.clipPathId,a=t.children,C=t.width,I=t.height,L=Uue(v);return ft.createElement(SR.Provider,{value:l},ft.createElement(ER.Provider,{value:h},ft.createElement(W7.Provider,{value:v},ft.createElement(Z7.Provider,{value:L},ft.createElement(Y7.Provider,{value:w},ft.createElement(K7.Provider,{value:I},ft.createElement(Q7.Provider,{value:C},a)))))))},Vue=function(){return Jt.useContext(Y7)},J7=function(t){var o=Jt.useContext(SR);o==null&&Qy();var l=o[t];return l==null&&Qy(),l},Gue=function(){var t=Jt.useContext(SR);return zg(t)},$ue=function(){var t=Jt.useContext(ER),o=Fue(t,function(l){return j7(l.domain,Number.isFinite)});return o||zg(t)},eG=function(t){var o=Jt.useContext(ER);o==null&&Qy();var l=o[t];return l==null&&Qy(),l},que=function(){var t=Jt.useContext(Z7);return t},Hue=function(){return Jt.useContext(W7)},MR=function(){return Jt.useContext(Q7)},OR=function(){return Jt.useContext(K7)};function ox(r){"@babel/helpers - typeof";return ox=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ox(r)}function Xue(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Zue(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,rG(l.key),l)}}function Wue(r,t,o){return t&&Zue(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Yue(r,t,o){return t=vT(t),Kue(r,tG()?Reflect.construct(t,o||[],vT(r).constructor):t.apply(r,o))}function Kue(r,t){if(t&&(ox(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Que(r)}function Que(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function tG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tG=function(){return!!r})()}function vT(r){return vT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},vT(r)}function Jue(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&BP(r,t)}function BP(r,t){return BP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},BP(r,t)}function lU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function cU(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?lU(Object(o),!0).forEach(function(l){CR(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):lU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function CR(r,t,o){return t=rG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function rG(r){var t=ehe(r,"string");return ox(t)=="symbol"?t:t+""}function ehe(r,t){if(ox(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ox(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function the(r,t){return ahe(r)||ihe(r,t)||nhe(r,t)||rhe()}function rhe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nhe(r,t){if(r){if(typeof r=="string")return uU(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return uU(r,t)}}function uU(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function ihe(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function ahe(r){if(Array.isArray(r))return r}function kP(){return kP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},kP.apply(this,arguments)}var ohe=function(t,o){var l;return ft.isValidElement(t)?l=ft.cloneElement(t,o):Bn(t)?l=t(o):l=ft.createElement("line",kP({},o,{className:"recharts-reference-line-line"})),l},she=function(t,o,l,h,v,w,a,C,I){var L=v.x,k=v.y,G=v.width,q=v.height;if(l){var Q=I.y,H=t.y.apply(Q,{position:w});if(qf(I,"discard")&&!t.y.isInRange(H))return null;var K=[{x:L+G,y:H},{x:L,y:H}];return C==="left"?K.reverse():K}if(o){var he=I.x,ue=t.x.apply(he,{position:w});if(qf(I,"discard")&&!t.x.isInRange(ue))return null;var me=[{x:ue,y:k+q},{x:ue,y:k}];return a==="top"?me.reverse():me}if(h){var ge=I.segment,se=ge.map(function(fe){return t.apply(fe,{position:w})});return qf(I,"discard")&&eue(se,function(fe){return!t.isInRange(fe)})?null:se}return null};function lhe(r){var t=r.x,o=r.y,l=r.segment,h=r.xAxisId,v=r.yAxisId,w=r.shape,a=r.className,C=r.alwaysShow,I=Vue(),L=J7(h),k=eG(v),G=que();if(!I||!G)return null;Dd(C===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var q=TR({x:L.scale,y:k.scale}),Q=Ms(t),H=Ms(o),K=l&&l.length===2,he=she(q,Q,H,K,G,r.position,L.orientation,k.orientation,r);if(!he)return null;var ue=the(he,2),me=ue[0],ge=me.x,se=me.y,fe=ue[1],ve=fe.x,Le=fe.y,Ue=qf(r,"hidden")?"url(#".concat(I,")"):void 0,tt=cU(cU({clipPath:Ue},xn(r,!0)),{},{x1:ge,y1:se,x2:ve,y2:Le});return ft.createElement(Gi,{className:li("recharts-reference-line",a)},ohe(w,tt),qs.renderCallByParent(r,Iue({x1:ge,y1:se,x2:ve,y2:Le})))}var IR=(function(r){function t(){return Xue(this,t),Yue(this,t,arguments)}return Jue(t,r),Wue(t,[{key:"render",value:function(){return ft.createElement(lhe,this.props)}}])})(ft.Component);CR(IR,"displayName","ReferenceLine");CR(IR,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function FP(){return FP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},FP.apply(this,arguments)}function sx(r){"@babel/helpers - typeof";return sx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sx(r)}function hU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function dU(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?hU(Object(o),!0).forEach(function(l){hS(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):hU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function che(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function uhe(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,iG(l.key),l)}}function hhe(r,t,o){return t&&uhe(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function dhe(r,t,o){return t=xT(t),fhe(r,nG()?Reflect.construct(t,o||[],xT(r).constructor):t.apply(r,o))}function fhe(r,t){if(t&&(sx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return phe(r)}function phe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function nG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nG=function(){return!!r})()}function xT(r){return xT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},xT(r)}function mhe(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&NP(r,t)}function NP(r,t){return NP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},NP(r,t)}function hS(r,t,o){return t=iG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function iG(r){var t=ghe(r,"string");return sx(t)=="symbol"?t:t+""}function ghe(r,t){if(sx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(sx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var _he=function(t){var o=t.x,l=t.y,h=t.xAxis,v=t.yAxis,w=TR({x:h.scale,y:v.scale}),a=w.apply({x:o,y:l},{bandAware:!0});return qf(t,"discard")&&!w.isInRange(a)?null:a},dS=(function(r){function t(){return che(this,t),dhe(this,t,arguments)}return mhe(t,r),hhe(t,[{key:"render",value:function(){var l=this.props,h=l.x,v=l.y,w=l.r,a=l.alwaysShow,C=l.clipPathId,I=Ms(h),L=Ms(v);if(Dd(a===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!I||!L)return null;var k=_he(this.props);if(!k)return null;var G=k.x,q=k.y,Q=this.props,H=Q.shape,K=Q.className,he=qf(this.props,"hidden")?"url(#".concat(C,")"):void 0,ue=dU(dU({clipPath:he},xn(this.props,!0)),{},{cx:G,cy:q});return ft.createElement(Gi,{className:li("recharts-reference-dot",K)},t.renderDot(H,ue),qs.renderCallByParent(this.props,{x:G-w,y:q-w,width:2*w,height:2*w}))}}])})(ft.Component);hS(dS,"displayName","ReferenceDot");hS(dS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});hS(dS,"renderDot",function(r,t){var o;return ft.isValidElement(r)?o=ft.cloneElement(r,t):Bn(r)?o=r(t):o=ft.createElement(nS,FP({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),o});function jP(){return jP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},jP.apply(this,arguments)}function lx(r){"@babel/helpers - typeof";return lx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lx(r)}function fU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function pU(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?fU(Object(o),!0).forEach(function(l){fS(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):fU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function yhe(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function vhe(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,oG(l.key),l)}}function xhe(r,t,o){return t&&vhe(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function bhe(r,t,o){return t=bT(t),whe(r,aG()?Reflect.construct(t,o||[],bT(r).constructor):t.apply(r,o))}function whe(r,t){if(t&&(lx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ahe(r)}function Ahe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function aG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aG=function(){return!!r})()}function bT(r){return bT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},bT(r)}function The(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&UP(r,t)}function UP(r,t){return UP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},UP(r,t)}function fS(r,t,o){return t=oG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function oG(r){var t=She(r,"string");return lx(t)=="symbol"?t:t+""}function She(r,t){if(lx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(lx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Ehe=function(t,o,l,h,v){var w=v.x1,a=v.x2,C=v.y1,I=v.y2,L=v.xAxis,k=v.yAxis;if(!L||!k)return null;var G=TR({x:L.scale,y:k.scale}),q={x:t?G.x.apply(w,{position:"start"}):G.x.rangeMin,y:l?G.y.apply(C,{position:"start"}):G.y.rangeMin},Q={x:o?G.x.apply(a,{position:"end"}):G.x.rangeMax,y:h?G.y.apply(I,{position:"end"}):G.y.rangeMax};return qf(v,"discard")&&(!G.isInRange(q)||!G.isInRange(Q))?null:H7(q,Q)},pS=(function(r){function t(){return yhe(this,t),bhe(this,t,arguments)}return The(t,r),xhe(t,[{key:"render",value:function(){var l=this.props,h=l.x1,v=l.x2,w=l.y1,a=l.y2,C=l.className,I=l.alwaysShow,L=l.clipPathId;Dd(I===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var k=Ms(h),G=Ms(v),q=Ms(w),Q=Ms(a),H=this.props.shape;if(!k&&!G&&!q&&!Q&&!H)return null;var K=Ehe(k,G,q,Q,this.props);if(!K&&!H)return null;var he=qf(this.props,"hidden")?"url(#".concat(L,")"):void 0;return ft.createElement(Gi,{className:li("recharts-reference-area",C)},t.renderRect(H,pU(pU({clipPath:he},xn(this.props,!0)),K)),qs.renderCallByParent(this.props,K))}}])})(ft.Component);fS(pS,"displayName","ReferenceArea");fS(pS,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});fS(pS,"renderRect",function(r,t){var o;return ft.isValidElement(r)?o=ft.cloneElement(r,t):Bn(r)?o=r(t):o=ft.createElement(AR,jP({},t,{className:"recharts-reference-area-rect"})),o});function sG(r,t,o){if(t<1)return[];if(t===1&&o===void 0)return r;for(var l=[],h=0;h<r.length;h+=t)l.push(r[h]);return l}function Mhe(r,t,o){var l={width:r.width+t.width,height:r.height+t.height};return Due(l,o)}function Ohe(r,t,o){var l=o==="width",h=r.x,v=r.y,w=r.width,a=r.height;return t===1?{start:l?h:v,end:l?h+w:v+a}:{start:l?h+w:v+a,end:l?h:v}}function wT(r,t,o,l,h){if(r*t<r*l||r*t>r*h)return!1;var v=o();return r*(t-r*v/2-l)>=0&&r*(t+r*v/2-h)<=0}function Che(r,t){return sG(r,t+1)}function Ihe(r,t,o,l,h){for(var v=(l||[]).slice(),w=t.start,a=t.end,C=0,I=1,L=w,k=function(){var Q=l?.[C];if(Q===void 0)return{v:sG(l,I)};var H=C,K,he=function(){return K===void 0&&(K=o(Q,H)),K},ue=Q.coordinate,me=C===0||wT(r,ue,he,L,a);me||(C=0,L=w,I+=1),me&&(L=ue+r*(he()/2+h),C+=I)},G;I<=v.length;)if(G=k(),G)return G.v;return[]}function aw(r){"@babel/helpers - typeof";return aw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aw(r)}function mU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Ol(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?mU(Object(o),!0).forEach(function(l){Phe(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):mU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Phe(r,t,o){return t=Dhe(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Dhe(r){var t=Rhe(r,"string");return aw(t)=="symbol"?t:t+""}function Rhe(r,t){if(aw(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(aw(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function zhe(r,t,o,l,h){for(var v=(l||[]).slice(),w=v.length,a=t.start,C=t.end,I=function(G){var q=v[G],Q,H=function(){return Q===void 0&&(Q=o(q,G)),Q};if(G===w-1){var K=r*(q.coordinate+r*H()/2-C);v[G]=q=Ol(Ol({},q),{},{tickCoord:K>0?q.coordinate-K*r:q.coordinate})}else v[G]=q=Ol(Ol({},q),{},{tickCoord:q.coordinate});var he=wT(r,q.tickCoord,H,a,C);he&&(C=q.tickCoord-r*(H()/2+h),v[G]=Ol(Ol({},q),{},{isShow:!0}))},L=w-1;L>=0;L--)I(L);return v}function Lhe(r,t,o,l,h,v){var w=(l||[]).slice(),a=w.length,C=t.start,I=t.end;if(v){var L=l[a-1],k=o(L,a-1),G=r*(L.coordinate+r*k/2-I);w[a-1]=L=Ol(Ol({},L),{},{tickCoord:G>0?L.coordinate-G*r:L.coordinate});var q=wT(r,L.tickCoord,function(){return k},C,I);q&&(I=L.tickCoord-r*(k/2+h),w[a-1]=Ol(Ol({},L),{},{isShow:!0}))}for(var Q=v?a-1:a,H=function(ue){var me=w[ue],ge,se=function(){return ge===void 0&&(ge=o(me,ue)),ge};if(ue===0){var fe=r*(me.coordinate-r*se()/2-C);w[ue]=me=Ol(Ol({},me),{},{tickCoord:fe<0?me.coordinate-fe*r:me.coordinate})}else w[ue]=me=Ol(Ol({},me),{},{tickCoord:me.coordinate});var ve=wT(r,me.tickCoord,se,C,I);ve&&(C=me.tickCoord+r*(se()/2+h),w[ue]=Ol(Ol({},me),{},{isShow:!0}))},K=0;K<Q;K++)H(K);return w}function PR(r,t,o){var l=r.tick,h=r.ticks,v=r.viewBox,w=r.minTickGap,a=r.orientation,C=r.interval,I=r.tickFormatter,L=r.unit,k=r.angle;if(!h||!h.length||!l)return[];if(Ar(C)||rv.isSsr)return Che(h,typeof C=="number"&&Ar(C)?C:0);var G=[],q=a==="top"||a==="bottom"?"width":"height",Q=L&&q==="width"?db(L,{fontSize:t,letterSpacing:o}):{width:0,height:0},H=function(me,ge){var se=Bn(I)?I(me.value,ge):me.value;return q==="width"?Mhe(db(se,{fontSize:t,letterSpacing:o}),Q,k):db(se,{fontSize:t,letterSpacing:o})[q]},K=h.length>=2?fc(h[1].coordinate-h[0].coordinate):1,he=Ohe(v,K,q);return C==="equidistantPreserveStart"?Ihe(K,he,H,h,w):(C==="preserveStart"||C==="preserveStartEnd"?G=Lhe(K,he,H,h,w,C==="preserveStartEnd"):G=zhe(K,he,H,h,w),G.filter(function(ue){return ue.isShow}))}var Bhe=["viewBox"],khe=["viewBox"],Fhe=["ticks"];function cx(r){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(r)}function A0(){return A0=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},A0.apply(this,arguments)}function gU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function ws(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?gU(Object(o),!0).forEach(function(l){DR(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):gU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function JC(r,t){if(r==null)return{};var o=Nhe(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Nhe(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function jhe(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _U(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,cG(l.key),l)}}function Uhe(r,t,o){return t&&_U(r.prototype,t),o&&_U(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function Vhe(r,t,o){return t=AT(t),Ghe(r,lG()?Reflect.construct(t,o||[],AT(r).constructor):t.apply(r,o))}function Ghe(r,t){if(t&&(cx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $he(r)}function $he(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function lG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lG=function(){return!!r})()}function AT(r){return AT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},AT(r)}function qhe(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&VP(r,t)}function VP(r,t){return VP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},VP(r,t)}function DR(r,t,o){return t=cG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function cG(r){var t=Hhe(r,"string");return cx(t)=="symbol"?t:t+""}function Hhe(r,t){if(cx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(cx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var Ax=(function(r){function t(o){var l;return jhe(this,t),l=Vhe(this,t,[o]),l.state={fontSize:"",letterSpacing:""},l}return qhe(t,r),Uhe(t,[{key:"shouldComponentUpdate",value:function(l,h){var v=l.viewBox,w=JC(l,Bhe),a=this.props,C=a.viewBox,I=JC(a,khe);return!P0(v,C)||!P0(w,I)||!P0(h,this.state)}},{key:"componentDidMount",value:function(){var l=this.layerReference;if(l){var h=l.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];h&&this.setState({fontSize:window.getComputedStyle(h).fontSize,letterSpacing:window.getComputedStyle(h).letterSpacing})}}},{key:"getTickLineCoord",value:function(l){var h=this.props,v=h.x,w=h.y,a=h.width,C=h.height,I=h.orientation,L=h.tickSize,k=h.mirror,G=h.tickMargin,q,Q,H,K,he,ue,me=k?-1:1,ge=l.tickSize||L,se=Ar(l.tickCoord)?l.tickCoord:l.coordinate;switch(I){case"top":q=Q=l.coordinate,K=w+ +!k*C,H=K-me*ge,ue=H-me*G,he=se;break;case"left":H=K=l.coordinate,Q=v+ +!k*a,q=Q-me*ge,he=q-me*G,ue=se;break;case"right":H=K=l.coordinate,Q=v+ +k*a,q=Q+me*ge,he=q+me*G,ue=se;break;default:q=Q=l.coordinate,K=w+ +k*C,H=K+me*ge,ue=H+me*G,he=se;break}return{line:{x1:q,y1:H,x2:Q,y2:K},tick:{x:he,y:ue}}}},{key:"getTickTextAnchor",value:function(){var l=this.props,h=l.orientation,v=l.mirror,w;switch(h){case"left":w=v?"start":"end";break;case"right":w=v?"end":"start";break;default:w="middle";break}return w}},{key:"getTickVerticalAnchor",value:function(){var l=this.props,h=l.orientation,v=l.mirror,w="end";switch(h){case"left":case"right":w="middle";break;case"top":w=v?"start":"end";break;default:w=v?"end":"start";break}return w}},{key:"renderAxisLine",value:function(){var l=this.props,h=l.x,v=l.y,w=l.width,a=l.height,C=l.orientation,I=l.mirror,L=l.axisLine,k=ws(ws(ws({},xn(this.props,!1)),xn(L,!1)),{},{fill:"none"});if(C==="top"||C==="bottom"){var G=+(C==="top"&&!I||C==="bottom"&&I);k=ws(ws({},k),{},{x1:h,y1:v+G*a,x2:h+w,y2:v+G*a})}else{var q=+(C==="left"&&!I||C==="right"&&I);k=ws(ws({},k),{},{x1:h+q*w,y1:v,x2:h+q*w,y2:v+a})}return ft.createElement("line",A0({},k,{className:li("recharts-cartesian-axis-line",ju(L,"className"))}))}},{key:"renderTicks",value:function(l,h,v){var w=this,a=this.props,C=a.tickLine,I=a.stroke,L=a.tick,k=a.tickFormatter,G=a.unit,q=PR(ws(ws({},this.props),{},{ticks:l}),h,v),Q=this.getTickTextAnchor(),H=this.getTickVerticalAnchor(),K=xn(this.props,!1),he=xn(L,!1),ue=ws(ws({},K),{},{fill:"none"},xn(C,!1)),me=q.map(function(ge,se){var fe=w.getTickLineCoord(ge),ve=fe.line,Le=fe.tick,Ue=ws(ws(ws(ws({textAnchor:Q,verticalAnchor:H},K),{},{stroke:"none",fill:I},he),Le),{},{index:se,payload:ge,visibleTicksCount:q.length,tickFormatter:k});return ft.createElement(Gi,A0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(ge.value,"-").concat(ge.coordinate,"-").concat(ge.tickCoord)},Wy(w.props,ge,se)),C&&ft.createElement("line",A0({},ue,ve,{className:li("recharts-cartesian-axis-tick-line",ju(C,"className"))})),L&&t.renderTickItem(L,Ue,"".concat(Bn(k)?k(ge.value,se):ge.value).concat(G||"")))});return ft.createElement("g",{className:"recharts-cartesian-axis-ticks"},me)}},{key:"render",value:function(){var l=this,h=this.props,v=h.axisLine,w=h.width,a=h.height,C=h.ticksGenerator,I=h.className,L=h.hide;if(L)return null;var k=this.props,G=k.ticks,q=JC(k,Fhe),Q=G;return Bn(C)&&(Q=G&&G.length>0?C(this.props):C(q)),w<=0||a<=0||!Q||!Q.length?null:ft.createElement(Gi,{className:li("recharts-cartesian-axis",I),ref:function(K){l.layerReference=K}},v&&this.renderAxisLine(),this.renderTicks(Q,this.state.fontSize,this.state.letterSpacing),qs.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(l,h,v){var w,a=li(h.className,"recharts-cartesian-axis-tick-value");return ft.isValidElement(l)?w=ft.cloneElement(l,ws(ws({},h),{},{className:a})):Bn(l)?w=l(ws(ws({},h),{},{className:a})):w=ft.createElement(Yy,A0({},h,{className:"recharts-cartesian-axis-tick-value"}),v),w}}])})(Jt.Component);DR(Ax,"displayName","CartesianAxis");DR(Ax,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Xhe=["x1","y1","x2","y2","key"],Zhe=["offset"];function Jy(r){"@babel/helpers - typeof";return Jy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jy(r)}function yU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Il(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(o),!0).forEach(function(l){Whe(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):yU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Whe(r,t,o){return t=Yhe(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Yhe(r){var t=Khe(r,"string");return Jy(t)=="symbol"?t:t+""}function Khe(r,t){if(Jy(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(Jy(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Dy(){return Dy=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},Dy.apply(this,arguments)}function vU(r,t){if(r==null)return{};var o=Qhe(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function Qhe(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}var Jhe=function(t){var o=t.fill;if(!o||o==="none")return null;var l=t.fillOpacity,h=t.x,v=t.y,w=t.width,a=t.height,C=t.ry;return ft.createElement("rect",{x:h,y:v,ry:C,width:w,height:a,stroke:"none",fill:o,fillOpacity:l,className:"recharts-cartesian-grid-bg"})};function uG(r,t){var o;if(ft.isValidElement(r))o=ft.cloneElement(r,t);else if(Bn(r))o=r(t);else{var l=t.x1,h=t.y1,v=t.x2,w=t.y2,a=t.key,C=vU(t,Xhe),I=xn(C,!1);I.offset;var L=vU(I,Zhe);o=ft.createElement("line",Dy({},L,{x1:l,y1:h,x2:v,y2:w,fill:"none",key:a}))}return o}function ede(r){var t=r.x,o=r.width,l=r.horizontal,h=l===void 0?!0:l,v=r.horizontalPoints;if(!h||!v||!v.length)return null;var w=v.map(function(a,C){var I=Il(Il({},r),{},{x1:t,y1:a,x2:t+o,y2:a,key:"line-".concat(C),index:C});return uG(h,I)});return ft.createElement("g",{className:"recharts-cartesian-grid-horizontal"},w)}function tde(r){var t=r.y,o=r.height,l=r.vertical,h=l===void 0?!0:l,v=r.verticalPoints;if(!h||!v||!v.length)return null;var w=v.map(function(a,C){var I=Il(Il({},r),{},{x1:a,y1:t,x2:a,y2:t+o,key:"line-".concat(C),index:C});return uG(h,I)});return ft.createElement("g",{className:"recharts-cartesian-grid-vertical"},w)}function rde(r){var t=r.horizontalFill,o=r.fillOpacity,l=r.x,h=r.y,v=r.width,w=r.height,a=r.horizontalPoints,C=r.horizontal,I=C===void 0?!0:C;if(!I||!t||!t.length)return null;var L=a.map(function(G){return Math.round(G+h-h)}).sort(function(G,q){return G-q});h!==L[0]&&L.unshift(0);var k=L.map(function(G,q){var Q=!L[q+1],H=Q?h+w-G:L[q+1]-G;if(H<=0)return null;var K=q%t.length;return ft.createElement("rect",{key:"react-".concat(q),y:G,x:l,height:H,width:v,stroke:"none",fill:t[K],fillOpacity:o,className:"recharts-cartesian-grid-bg"})});return ft.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},k)}function nde(r){var t=r.vertical,o=t===void 0?!0:t,l=r.verticalFill,h=r.fillOpacity,v=r.x,w=r.y,a=r.width,C=r.height,I=r.verticalPoints;if(!o||!l||!l.length)return null;var L=I.map(function(G){return Math.round(G+v-v)}).sort(function(G,q){return G-q});v!==L[0]&&L.unshift(0);var k=L.map(function(G,q){var Q=!L[q+1],H=Q?v+a-G:L[q+1]-G;if(H<=0)return null;var K=q%l.length;return ft.createElement("rect",{key:"react-".concat(q),x:G,y:w,width:H,height:C,stroke:"none",fill:l[K],fillOpacity:h,className:"recharts-cartesian-grid-bg"})});return ft.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},k)}var ide=function(t,o){var l=t.xAxis,h=t.width,v=t.height,w=t.offset;return u7(PR(Il(Il(Il({},Ax.defaultProps),l),{},{ticks:sm(l,!0),viewBox:{x:0,y:0,width:h,height:v}})),w.left,w.left+w.width,o)},ade=function(t,o){var l=t.yAxis,h=t.width,v=t.height,w=t.offset;return u7(PR(Il(Il(Il({},Ax.defaultProps),l),{},{ticks:sm(l,!0),viewBox:{x:0,y:0,width:h,height:v}})),w.top,w.top+w.height,o)},f0={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function gA(r){var t,o,l,h,v,w,a=MR(),C=OR(),I=Hue(),L=Il(Il({},r),{},{stroke:(t=r.stroke)!==null&&t!==void 0?t:f0.stroke,fill:(o=r.fill)!==null&&o!==void 0?o:f0.fill,horizontal:(l=r.horizontal)!==null&&l!==void 0?l:f0.horizontal,horizontalFill:(h=r.horizontalFill)!==null&&h!==void 0?h:f0.horizontalFill,vertical:(v=r.vertical)!==null&&v!==void 0?v:f0.vertical,verticalFill:(w=r.verticalFill)!==null&&w!==void 0?w:f0.verticalFill,x:Ar(r.x)?r.x:I.left,y:Ar(r.y)?r.y:I.top,width:Ar(r.width)?r.width:I.width,height:Ar(r.height)?r.height:I.height}),k=L.x,G=L.y,q=L.width,Q=L.height,H=L.syncWithTicks,K=L.horizontalValues,he=L.verticalValues,ue=Gue(),me=$ue();if(!Ar(q)||q<=0||!Ar(Q)||Q<=0||!Ar(k)||k!==+k||!Ar(G)||G!==+G)return null;var ge=L.verticalCoordinatesGenerator||ide,se=L.horizontalCoordinatesGenerator||ade,fe=L.horizontalPoints,ve=L.verticalPoints;if((!fe||!fe.length)&&Bn(se)){var Le=K&&K.length,Ue=se({yAxis:me?Il(Il({},me),{},{ticks:Le?K:me.ticks}):void 0,width:a,height:C,offset:I},Le?!0:H);Dd(Array.isArray(Ue),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Jy(Ue),"]")),Array.isArray(Ue)&&(fe=Ue)}if((!ve||!ve.length)&&Bn(ge)){var tt=he&&he.length,Ke=ge({xAxis:ue?Il(Il({},ue),{},{ticks:tt?he:ue.ticks}):void 0,width:a,height:C,offset:I},tt?!0:H);Dd(Array.isArray(Ke),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Jy(Ke),"]")),Array.isArray(Ke)&&(ve=Ke)}return ft.createElement("g",{className:"recharts-cartesian-grid"},ft.createElement(Jhe,{fill:L.fill,fillOpacity:L.fillOpacity,x:L.x,y:L.y,width:L.width,height:L.height,ry:L.ry}),ft.createElement(ede,Dy({},L,{offset:I,horizontalPoints:fe,xAxis:ue,yAxis:me})),ft.createElement(tde,Dy({},L,{offset:I,verticalPoints:ve,xAxis:ue,yAxis:me})),ft.createElement(rde,Dy({},L,{horizontalPoints:fe})),ft.createElement(nde,Dy({},L,{verticalPoints:ve})))}gA.displayName="CartesianGrid";var ode=["layout","type","stroke","connectNulls","isRange","ref"],sde=["key"],hG;function ux(r){"@babel/helpers - typeof";return ux=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ux(r)}function dG(r,t){if(r==null)return{};var o=lde(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function lde(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function Ry(){return Ry=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},Ry.apply(this,arguments)}function xU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function Pg(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?xU(Object(o),!0).forEach(function(l){Vf(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):xU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function cde(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function bU(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,pG(l.key),l)}}function ude(r,t,o){return t&&bU(r.prototype,t),o&&bU(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function hde(r,t,o){return t=TT(t),dde(r,fG()?Reflect.construct(t,o||[],TT(r).constructor):t.apply(r,o))}function dde(r,t){if(t&&(ux(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return fde(r)}function fde(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function fG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fG=function(){return!!r})()}function TT(r){return TT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},TT(r)}function pde(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&GP(r,t)}function GP(r,t){return GP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},GP(r,t)}function Vf(r,t,o){return t=pG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function pG(r){var t=mde(r,"string");return ux(t)=="symbol"?t:t+""}function mde(r,t){if(ux(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ux(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var ym=(function(r){function t(){var o;cde(this,t);for(var l=arguments.length,h=new Array(l),v=0;v<l;v++)h[v]=arguments[v];return o=hde(this,t,[].concat(h)),Vf(o,"state",{isAnimationFinished:!0}),Vf(o,"id",yx("recharts-area-")),Vf(o,"handleAnimationEnd",function(){var w=o.props.onAnimationEnd;o.setState({isAnimationFinished:!0}),Bn(w)&&w()}),Vf(o,"handleAnimationStart",function(){var w=o.props.onAnimationStart;o.setState({isAnimationFinished:!1}),Bn(w)&&w()}),o}return pde(t,r),ude(t,[{key:"renderDots",value:function(l,h,v){var w=this.props.isAnimationActive,a=this.state.isAnimationFinished;if(w&&!a)return null;var C=this.props,I=C.dot,L=C.points,k=C.dataKey,G=xn(this.props,!1),q=xn(I,!0),Q=L.map(function(K,he){var ue=Pg(Pg(Pg({key:"dot-".concat(he),r:3},G),q),{},{index:he,cx:K.x,cy:K.y,dataKey:k,value:K.value,payload:K.payload,points:L});return t.renderDotItem(I,ue)}),H={clipPath:l?"url(#clipPath-".concat(h?"":"dots-").concat(v,")"):null};return ft.createElement(Gi,Ry({className:"recharts-area-dots"},H),Q)}},{key:"renderHorizontalRect",value:function(l){var h=this.props,v=h.baseLine,w=h.points,a=h.strokeWidth,C=w[0].x,I=w[w.length-1].x,L=l*Math.abs(C-I),k=jg(w.map(function(G){return G.y||0}));return Ar(v)&&typeof v=="number"?k=Math.max(v,k):v&&Array.isArray(v)&&v.length&&(k=Math.max(jg(v.map(function(G){return G.y||0})),k)),Ar(k)?ft.createElement("rect",{x:C<I?C:C-L,y:0,width:L,height:Math.floor(k+(a?parseInt("".concat(a),10):1))}):null}},{key:"renderVerticalRect",value:function(l){var h=this.props,v=h.baseLine,w=h.points,a=h.strokeWidth,C=w[0].y,I=w[w.length-1].y,L=l*Math.abs(C-I),k=jg(w.map(function(G){return G.x||0}));return Ar(v)&&typeof v=="number"?k=Math.max(v,k):v&&Array.isArray(v)&&v.length&&(k=Math.max(jg(v.map(function(G){return G.x||0})),k)),Ar(k)?ft.createElement("rect",{x:0,y:C<I?C:C-L,width:k+(a?parseInt("".concat(a),10):1),height:Math.floor(L)}):null}},{key:"renderClipRect",value:function(l){var h=this.props.layout;return h==="vertical"?this.renderVerticalRect(l):this.renderHorizontalRect(l)}},{key:"renderAreaStatically",value:function(l,h,v,w){var a=this.props,C=a.layout,I=a.type,L=a.stroke,k=a.connectNulls,G=a.isRange;a.ref;var q=dG(a,ode);return ft.createElement(Gi,{clipPath:v?"url(#clipPath-".concat(w,")"):null},ft.createElement(L0,Ry({},xn(q,!0),{points:l,connectNulls:k,type:I,baseLine:h,layout:C,stroke:"none",className:"recharts-area-area"})),L!=="none"&&ft.createElement(L0,Ry({},xn(this.props,!1),{className:"recharts-area-curve",layout:C,type:I,connectNulls:k,fill:"none",points:l})),L!=="none"&&G&&ft.createElement(L0,Ry({},xn(this.props,!1),{className:"recharts-area-curve",layout:C,type:I,connectNulls:k,fill:"none",points:h})))}},{key:"renderAreaWithAnimation",value:function(l,h){var v=this,w=this.props,a=w.points,C=w.baseLine,I=w.isAnimationActive,L=w.animationBegin,k=w.animationDuration,G=w.animationEasing,q=w.animationId,Q=this.state,H=Q.prevPoints,K=Q.prevBaseLine;return ft.createElement(Zf,{begin:L,duration:k,isActive:I,easing:G,from:{t:0},to:{t:1},key:"area-".concat(q),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(he){var ue=he.t;if(H){var me=H.length/a.length,ge=a.map(function(Le,Ue){var tt=Math.floor(Ue*me);if(H[tt]){var Ke=H[tt],nt=Uc(Ke.x,Le.x),st=Uc(Ke.y,Le.y);return Pg(Pg({},Le),{},{x:nt(ue),y:st(ue)})}return Le}),se;if(Ar(C)&&typeof C=="number"){var fe=Uc(K,C);se=fe(ue)}else if(ei(C)||_x(C)){var ve=Uc(K,0);se=ve(ue)}else se=C.map(function(Le,Ue){var tt=Math.floor(Ue*me);if(K[tt]){var Ke=K[tt],nt=Uc(Ke.x,Le.x),st=Uc(Ke.y,Le.y);return Pg(Pg({},Le),{},{x:nt(ue),y:st(ue)})}return Le});return v.renderAreaStatically(ge,se,l,h)}return ft.createElement(Gi,null,ft.createElement("defs",null,ft.createElement("clipPath",{id:"animationClipPath-".concat(h)},v.renderClipRect(ue))),ft.createElement(Gi,{clipPath:"url(#animationClipPath-".concat(h,")")},v.renderAreaStatically(a,C,l,h)))})}},{key:"renderArea",value:function(l,h){var v=this.props,w=v.points,a=v.baseLine,C=v.isAnimationActive,I=this.state,L=I.prevPoints,k=I.prevBaseLine,G=I.totalLength;return C&&w&&w.length&&(!L&&G>0||!K0(L,w)||!K0(k,a))?this.renderAreaWithAnimation(l,h):this.renderAreaStatically(w,a,l,h)}},{key:"render",value:function(){var l,h=this.props,v=h.hide,w=h.dot,a=h.points,C=h.className,I=h.top,L=h.left,k=h.xAxis,G=h.yAxis,q=h.width,Q=h.height,H=h.isAnimationActive,K=h.id;if(v||!a||!a.length)return null;var he=this.state.isAnimationFinished,ue=a.length===1,me=li("recharts-area",C),ge=k&&k.allowDataOverflow,se=G&&G.allowDataOverflow,fe=ge||se,ve=ei(K)?this.id:K,Le=(l=xn(w,!1))!==null&&l!==void 0?l:{r:3,strokeWidth:2},Ue=Le.r,tt=Ue===void 0?3:Ue,Ke=Le.strokeWidth,nt=Ke===void 0?2:Ke,st=ZY(w)?w:{},Rt=st.clipDot,Mt=Rt===void 0?!0:Rt,$e=tt*2+nt;return ft.createElement(Gi,{className:me},ge||se?ft.createElement("defs",null,ft.createElement("clipPath",{id:"clipPath-".concat(ve)},ft.createElement("rect",{x:ge?L:L-q/2,y:se?I:I-Q/2,width:ge?q:q*2,height:se?Q:Q*2})),!Mt&&ft.createElement("clipPath",{id:"clipPath-dots-".concat(ve)},ft.createElement("rect",{x:L-$e/2,y:I-$e/2,width:q+$e,height:Q+$e}))):null,ue?null:this.renderArea(fe,ve),(w||ue)&&this.renderDots(fe,Mt,ve),(!H||he)&&hm.renderCallByParent(this.props,a))}}],[{key:"getDerivedStateFromProps",value:function(l,h){return l.animationId!==h.prevAnimationId?{prevAnimationId:l.animationId,curPoints:l.points,curBaseLine:l.baseLine,prevPoints:h.curPoints,prevBaseLine:h.curBaseLine}:l.points!==h.curPoints||l.baseLine!==h.curBaseLine?{curPoints:l.points,curBaseLine:l.baseLine}:null}}])})(Jt.PureComponent);hG=ym;Vf(ym,"displayName","Area");Vf(ym,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!rv.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Vf(ym,"getBaseValue",function(r,t,o,l){var h=r.layout,v=r.baseValue,w=t.props.baseValue,a=w??v;if(Ar(a)&&typeof a=="number")return a;var C=h==="horizontal"?l:o,I=C.scale.domain();if(C.type==="number"){var L=Math.max(I[0],I[1]),k=Math.min(I[0],I[1]);return a==="dataMin"?k:a==="dataMax"||L<0?L:Math.max(Math.min(I[0],I[1]),0)}return a==="dataMin"?I[0]:a==="dataMax"?I[1]:I[0]});Vf(ym,"getComposedData",function(r){var t=r.props,o=r.item,l=r.xAxis,h=r.yAxis,v=r.xAxisTicks,w=r.yAxisTicks,a=r.bandSize,C=r.dataKey,I=r.stackedData,L=r.dataStartIndex,k=r.displayedData,G=r.offset,q=t.layout,Q=I&&I.length,H=hG.getBaseValue(t,o,l,h),K=q==="horizontal",he=!1,ue=k.map(function(ge,se){var fe;Q?fe=I[L+se]:(fe=Es(ge,C),Array.isArray(fe)?he=!0:fe=[H,fe]);var ve=fe[1]==null||Q&&Es(ge,C)==null;return K?{x:Mj({axis:l,ticks:v,bandSize:a,entry:ge,index:se}),y:ve?null:h.scale(fe[1]),value:fe,payload:ge}:{x:ve?null:l.scale(fe[1]),y:Mj({axis:h,ticks:w,bandSize:a,entry:ge,index:se}),value:fe,payload:ge}}),me;return Q||he?me=ue.map(function(ge){var se=Array.isArray(ge.value)?ge.value[0]:null;return K?{x:ge.x,y:se!=null&&ge.y!=null?h.scale(se):null}:{x:se!=null?l.scale(se):null,y:ge.y}}):me=K?h.scale(H):l.scale(H),Pg({points:ue,baseLine:me,layout:q,isRange:he},G)});Vf(ym,"renderDotItem",function(r,t){var o;if(ft.isValidElement(r))o=ft.cloneElement(r,t);else if(Bn(r))o=r(t);else{var l=li("recharts-area-dot",typeof r!="boolean"?r.className:""),h=t.key,v=dG(t,sde);o=ft.createElement(nS,Ry({},v,{key:h,className:l}))}return o});function hx(r){"@babel/helpers - typeof";return hx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hx(r)}function gde(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function _de(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,_G(l.key),l)}}function yde(r,t,o){return t&&_de(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function vde(r,t,o){return t=ST(t),xde(r,mG()?Reflect.construct(t,o||[],ST(r).constructor):t.apply(r,o))}function xde(r,t){if(t&&(hx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return bde(r)}function bde(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function mG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mG=function(){return!!r})()}function ST(r){return ST=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},ST(r)}function wde(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&$P(r,t)}function $P(r,t){return $P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},$P(r,t)}function gG(r,t,o){return t=_G(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function _G(r){var t=Ade(r,"string");return hx(t)=="symbol"?t:t+""}function Ade(r,t){if(hx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(hx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function qP(){return qP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},qP.apply(this,arguments)}function Tde(r){var t=r.xAxisId,o=MR(),l=OR(),h=J7(t);return h==null?null:Jt.createElement(Ax,qP({},h,{className:li("recharts-".concat(h.axisType," ").concat(h.axisType),h.className),viewBox:{x:0,y:0,width:o,height:l},ticksGenerator:function(w){return sm(w,!0)}}))}var Gy=(function(r){function t(){return gde(this,t),vde(this,t,arguments)}return wde(t,r),yde(t,[{key:"render",value:function(){return Jt.createElement(Tde,this.props)}}])})(Jt.Component);gG(Gy,"displayName","XAxis");gG(Gy,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function dx(r){"@babel/helpers - typeof";return dx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(r)}function Sde(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Ede(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,xG(l.key),l)}}function Mde(r,t,o){return t&&Ede(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function Ode(r,t,o){return t=ET(t),Cde(r,yG()?Reflect.construct(t,o||[],ET(r).constructor):t.apply(r,o))}function Cde(r,t){if(t&&(dx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ide(r)}function Ide(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function yG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yG=function(){return!!r})()}function ET(r){return ET=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},ET(r)}function Pde(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&HP(r,t)}function HP(r,t){return HP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},HP(r,t)}function vG(r,t,o){return t=xG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function xG(r){var t=Dde(r,"string");return dx(t)=="symbol"?t:t+""}function Dde(r,t){if(dx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(dx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function XP(){return XP=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},XP.apply(this,arguments)}var Rde=function(t){var o=t.yAxisId,l=MR(),h=OR(),v=eG(o);return v==null?null:Jt.createElement(Ax,XP({},v,{className:li("recharts-".concat(v.axisType," ").concat(v.axisType),v.className),viewBox:{x:0,y:0,width:l,height:h},ticksGenerator:function(a){return sm(a,!0)}}))},$y=(function(r){function t(){return Sde(this,t),Ode(this,t,arguments)}return Pde(t,r),Mde(t,[{key:"render",value:function(){return Jt.createElement(Rde,this.props)}}])})(Jt.Component);vG($y,"displayName","YAxis");vG($y,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function wU(r){return kde(r)||Bde(r)||Lde(r)||zde()}function zde(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lde(r,t){if(r){if(typeof r=="string")return ZP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return ZP(r,t)}}function Bde(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function kde(r){if(Array.isArray(r))return ZP(r)}function ZP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}var WP=function(t,o,l,h,v){var w=Rh(t,IR),a=Rh(t,dS),C=[].concat(wU(w),wU(a)),I=Rh(t,pS),L="".concat(h,"Id"),k=h[0],G=o;if(C.length&&(G=C.reduce(function(H,K){if(K.props[L]===l&&qf(K.props,"extendDomain")&&Ar(K.props[k])){var he=K.props[k];return[Math.min(H[0],he),Math.max(H[1],he)]}return H},G)),I.length){var q="".concat(k,"1"),Q="".concat(k,"2");G=I.reduce(function(H,K){if(K.props[L]===l&&qf(K.props,"extendDomain")&&Ar(K.props[q])&&Ar(K.props[Q])){var he=K.props[q],ue=K.props[Q];return[Math.min(H[0],he,ue),Math.max(H[1],he,ue)]}return H},G)}return v&&v.length&&(G=v.reduce(function(H,K){return Ar(K)?[Math.min(H[0],K),Math.max(H[1],K)]:H},G)),G},eI={exports:{}},AU;function Fde(){return AU||(AU=1,(function(r){var t=Object.prototype.hasOwnProperty,o="~";function l(){}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(o=!1));function h(C,I,L){this.fn=C,this.context=I,this.once=L||!1}function v(C,I,L,k,G){if(typeof L!="function")throw new TypeError("The listener must be a function");var q=new h(L,k||C,G),Q=o?o+I:I;return C._events[Q]?C._events[Q].fn?C._events[Q]=[C._events[Q],q]:C._events[Q].push(q):(C._events[Q]=q,C._eventsCount++),C}function w(C,I){--C._eventsCount===0?C._events=new l:delete C._events[I]}function a(){this._events=new l,this._eventsCount=0}a.prototype.eventNames=function(){var I=[],L,k;if(this._eventsCount===0)return I;for(k in L=this._events)t.call(L,k)&&I.push(o?k.slice(1):k);return Object.getOwnPropertySymbols?I.concat(Object.getOwnPropertySymbols(L)):I},a.prototype.listeners=function(I){var L=o?o+I:I,k=this._events[L];if(!k)return[];if(k.fn)return[k.fn];for(var G=0,q=k.length,Q=new Array(q);G<q;G++)Q[G]=k[G].fn;return Q},a.prototype.listenerCount=function(I){var L=o?o+I:I,k=this._events[L];return k?k.fn?1:k.length:0},a.prototype.emit=function(I,L,k,G,q,Q){var H=o?o+I:I;if(!this._events[H])return!1;var K=this._events[H],he=arguments.length,ue,me;if(K.fn){switch(K.once&&this.removeListener(I,K.fn,void 0,!0),he){case 1:return K.fn.call(K.context),!0;case 2:return K.fn.call(K.context,L),!0;case 3:return K.fn.call(K.context,L,k),!0;case 4:return K.fn.call(K.context,L,k,G),!0;case 5:return K.fn.call(K.context,L,k,G,q),!0;case 6:return K.fn.call(K.context,L,k,G,q,Q),!0}for(me=1,ue=new Array(he-1);me<he;me++)ue[me-1]=arguments[me];K.fn.apply(K.context,ue)}else{var ge=K.length,se;for(me=0;me<ge;me++)switch(K[me].once&&this.removeListener(I,K[me].fn,void 0,!0),he){case 1:K[me].fn.call(K[me].context);break;case 2:K[me].fn.call(K[me].context,L);break;case 3:K[me].fn.call(K[me].context,L,k);break;case 4:K[me].fn.call(K[me].context,L,k,G);break;default:if(!ue)for(se=1,ue=new Array(he-1);se<he;se++)ue[se-1]=arguments[se];K[me].fn.apply(K[me].context,ue)}}return!0},a.prototype.on=function(I,L,k){return v(this,I,L,k,!1)},a.prototype.once=function(I,L,k){return v(this,I,L,k,!0)},a.prototype.removeListener=function(I,L,k,G){var q=o?o+I:I;if(!this._events[q])return this;if(!L)return w(this,q),this;var Q=this._events[q];if(Q.fn)Q.fn===L&&(!G||Q.once)&&(!k||Q.context===k)&&w(this,q);else{for(var H=0,K=[],he=Q.length;H<he;H++)(Q[H].fn!==L||G&&!Q[H].once||k&&Q[H].context!==k)&&K.push(Q[H]);K.length?this._events[q]=K.length===1?K[0]:K:w(this,q)}return this},a.prototype.removeAllListeners=function(I){var L;return I?(L=o?o+I:I,this._events[L]&&w(this,L)):(this._events=new l,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=o,a.EventEmitter=a,r.exports=a})(eI)),eI.exports}var Nde=Fde();const jde=ca(Nde);var tI=new jde,rI="recharts.syncMouseEvents";function ow(r){"@babel/helpers - typeof";return ow=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ow(r)}function Ude(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Vde(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,bG(l.key),l)}}function Gde(r,t,o){return t&&Vde(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function nI(r,t,o){return t=bG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function bG(r){var t=$de(r,"string");return ow(t)=="symbol"?t:t+""}function $de(r,t){if(ow(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(ow(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var qde=(function(){function r(){Ude(this,r),nI(this,"activeIndex",0),nI(this,"coordinateList",[]),nI(this,"layout","horizontal")}return Gde(r,[{key:"setDetails",value:function(o){var l,h=o.coordinateList,v=h===void 0?null:h,w=o.container,a=w===void 0?null:w,C=o.layout,I=C===void 0?null:C,L=o.offset,k=L===void 0?null:L,G=o.mouseHandlerCallback,q=G===void 0?null:G;this.coordinateList=(l=v??this.coordinateList)!==null&&l!==void 0?l:[],this.container=a??this.container,this.layout=I??this.layout,this.offset=k??this.offset,this.mouseHandlerCallback=q??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(o){if(this.coordinateList.length!==0)switch(o.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(o){this.activeIndex=o}},{key:"spoofMouse",value:function(){var o,l;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var h=this.container.getBoundingClientRect(),v=h.x,w=h.y,a=h.height,C=this.coordinateList[this.activeIndex].coordinate,I=((o=window)===null||o===void 0?void 0:o.scrollX)||0,L=((l=window)===null||l===void 0?void 0:l.scrollY)||0,k=v+C+I,G=w+this.offset.top+a/2+L;this.mouseHandlerCallback({pageX:k,pageY:G})}}}])})();function Hde(r,t,o){if(o==="number"&&t===!0&&Array.isArray(r)){var l=r?.[0],h=r?.[1];if(l&&h&&Ar(l)&&Ar(h))return!0}return!1}function Xde(r,t,o,l){var h=l/2;return{stroke:"none",fill:"#ccc",x:r==="horizontal"?t.x-h:o.left+.5,y:r==="horizontal"?o.top+.5:t.y-h,width:r==="horizontal"?l:o.width-1,height:r==="horizontal"?o.height-1:l}}function wG(r){var t=r.cx,o=r.cy,l=r.radius,h=r.startAngle,v=r.endAngle,w=za(t,o,l,h),a=za(t,o,l,v);return{points:[w,a],cx:t,cy:o,radius:l,startAngle:h,endAngle:v}}function Zde(r,t,o){var l,h,v,w;if(r==="horizontal")l=t.x,v=l,h=o.top,w=o.top+o.height;else if(r==="vertical")h=t.y,w=h,l=o.left,v=o.left+o.width;else if(t.cx!=null&&t.cy!=null)if(r==="centric"){var a=t.cx,C=t.cy,I=t.innerRadius,L=t.outerRadius,k=t.angle,G=za(a,C,I,k),q=za(a,C,L,k);l=G.x,h=G.y,v=q.x,w=q.y}else return wG(t);return[{x:l,y:h},{x:v,y:w}]}function sw(r){"@babel/helpers - typeof";return sw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sw(r)}function TU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function rA(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?TU(Object(o),!0).forEach(function(l){Wde(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):TU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Wde(r,t,o){return t=Yde(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function Yde(r){var t=Kde(r,"string");return sw(t)=="symbol"?t:t+""}function Kde(r,t){if(sw(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(sw(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}function Qde(r){var t,o,l=r.element,h=r.tooltipEventType,v=r.isActive,w=r.activeCoordinate,a=r.activePayload,C=r.offset,I=r.activeTooltipIndex,L=r.tooltipAxisBandSize,k=r.layout,G=r.chartName,q=(t=l.props.cursor)!==null&&t!==void 0?t:(o=l.type.defaultProps)===null||o===void 0?void 0:o.cursor;if(!l||!q||!v||!w||G!=="ScatterChart"&&h!=="axis")return null;var Q,H=L0;if(G==="ScatterChart")Q=w,H=Tle;else if(G==="BarChart")Q=Xde(k,w,C,L),H=AR;else if(k==="radial"){var K=wG(w),he=K.cx,ue=K.cy,me=K.radius,ge=K.startAngle,se=K.endAngle;Q={cx:he,cy:ue,startAngle:ge,endAngle:se,innerRadius:me,outerRadius:me},H=b7}else Q={points:Zde(k,w,C)},H=L0;var fe=rA(rA(rA(rA({stroke:"#ccc",pointerEvents:"none"},C),Q),xn(q,!1)),{},{payload:a,payloadIndex:I,className:li("recharts-tooltip-cursor",q.className)});return Jt.isValidElement(q)?Jt.cloneElement(q,fe):Jt.createElement(H,fe)}var Jde=["item"],efe=["children","className","width","height","style","compact","title","desc"];function fx(r){"@babel/helpers - typeof";return fx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fx(r)}function T0(){return T0=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])}return r},T0.apply(this,arguments)}function SU(r,t){return nfe(r)||rfe(r,t)||TG(r,t)||tfe()}function tfe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rfe(r,t){var o=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(o!=null){var l,h,v,w,a=[],C=!0,I=!1;try{if(v=(o=o.call(r)).next,t!==0)for(;!(C=(l=v.call(o)).done)&&(a.push(l.value),a.length!==t);C=!0);}catch(L){I=!0,h=L}finally{try{if(!C&&o.return!=null&&(w=o.return(),Object(w)!==w))return}finally{if(I)throw h}}return a}}function nfe(r){if(Array.isArray(r))return r}function EU(r,t){if(r==null)return{};var o=ife(r,t),l,h;if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(r);for(h=0;h<v.length;h++)l=v[h],!(t.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(r,l)&&(o[l]=r[l])}return o}function ife(r,t){if(r==null)return{};var o={};for(var l in r)if(Object.prototype.hasOwnProperty.call(r,l)){if(t.indexOf(l)>=0)continue;o[l]=r[l]}return o}function afe(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function ofe(r,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(r,SG(l.key),l)}}function sfe(r,t,o){return t&&ofe(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function lfe(r,t,o){return t=MT(t),cfe(r,AG()?Reflect.construct(t,o||[],MT(r).constructor):t.apply(r,o))}function cfe(r,t){if(t&&(fx(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ufe(r)}function ufe(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function AG(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(AG=function(){return!!r})()}function MT(r){return MT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},MT(r)}function hfe(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&YP(r,t)}function YP(r,t){return YP=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(l,h){return l.__proto__=h,l},YP(r,t)}function px(r){return pfe(r)||ffe(r)||TG(r)||dfe()}function dfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TG(r,t){if(r){if(typeof r=="string")return KP(r,t);var o=Object.prototype.toString.call(r).slice(8,-1);if(o==="Object"&&r.constructor&&(o=r.constructor.name),o==="Map"||o==="Set")return Array.from(r);if(o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return KP(r,t)}}function ffe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function pfe(r){if(Array.isArray(r))return KP(r)}function KP(r,t){(t==null||t>r.length)&&(t=r.length);for(var o=0,l=new Array(t);o<t;o++)l[o]=r[o];return l}function MU(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(r);t&&(l=l.filter(function(h){return Object.getOwnPropertyDescriptor(r,h).enumerable})),o.push.apply(o,l)}return o}function cr(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?MU(Object(o),!0).forEach(function(l){Rn(r,l,o[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):MU(Object(o)).forEach(function(l){Object.defineProperty(r,l,Object.getOwnPropertyDescriptor(o,l))})}return r}function Rn(r,t,o){return t=SG(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function SG(r){var t=mfe(r,"string");return fx(t)=="symbol"?t:t+""}function mfe(r,t){if(fx(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var l=o.call(r,t);if(fx(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(r)}var gfe={xAxis:["bottom","top"],yAxis:["left","right"]},_fe={width:"100%",height:"100%"},EG={x:0,y:0};function nA(r){return r}var yfe=function(t,o){return o==="horizontal"?t.x:o==="vertical"?t.y:o==="centric"?t.angle:t.radius},vfe=function(t,o,l,h){var v=o.find(function(L){return L&&L.index===l});if(v){if(t==="horizontal")return{x:v.coordinate,y:h.y};if(t==="vertical")return{x:h.x,y:v.coordinate};if(t==="centric"){var w=v.coordinate,a=h.radius;return cr(cr(cr({},h),za(h.cx,h.cy,a,w)),{},{angle:w,radius:a})}var C=v.coordinate,I=h.angle;return cr(cr(cr({},h),za(h.cx,h.cy,C,I)),{},{angle:I,radius:C})}return EG},mS=function(t,o){var l=o.graphicalItems,h=o.dataStartIndex,v=o.dataEndIndex,w=(l??[]).reduce(function(a,C){var I=C.props.data;return I&&I.length?[].concat(px(a),px(I)):a},[]);return w.length>0?w:t&&t.length&&Ar(h)&&Ar(v)?t.slice(h,v+1):[]};function MG(r){return r==="number"?[0,"auto"]:void 0}var QP=function(t,o,l,h){var v=t.graphicalItems,w=t.tooltipAxis,a=mS(o,t);return l<0||!v||!v.length||l>=a.length?null:v.reduce(function(C,I){var L,k=(L=I.props.data)!==null&&L!==void 0?L:o;k&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=l&&(k=k.slice(t.dataStartIndex,t.dataEndIndex+1));var G;if(w.dataKey&&!w.allowDuplicatedCategory){var q=k===void 0?a:k;G=IA(q,w.dataKey,h)}else G=k&&k[l]||a[l];return G?[].concat(px(C),[m7(I,G)]):C},[])},OU=function(t,o,l,h){var v=h||{x:t.chartX,y:t.chartY},w=yfe(v,l),a=t.orderedTooltipTicks,C=t.tooltipAxis,I=t.tooltipTicks,L=qie(w,a,I,C);if(L>=0&&I){var k=I[L]&&I[L].value,G=QP(t,o,L,k),q=vfe(l,a,L,v);return{activeTooltipIndex:L,activeLabel:k,activePayload:G,activeCoordinate:q}}return null},xfe=function(t,o){var l=o.axes,h=o.graphicalItems,v=o.axisType,w=o.axisIdKey,a=o.stackGroups,C=o.dataStartIndex,I=o.dataEndIndex,L=t.layout,k=t.children,G=t.stackOffset,q=c7(L,v);return l.reduce(function(Q,H){var K,he=H.type.defaultProps!==void 0?cr(cr({},H.type.defaultProps),H.props):H.props,ue=he.type,me=he.dataKey,ge=he.allowDataOverflow,se=he.allowDuplicatedCategory,fe=he.scale,ve=he.ticks,Le=he.includeHidden,Ue=he[w];if(Q[Ue])return Q;var tt=mS(t.data,{graphicalItems:h.filter(function(gt){var Bt,ar=w in gt.props?gt.props[w]:(Bt=gt.type.defaultProps)===null||Bt===void 0?void 0:Bt[w];return ar===Ue}),dataStartIndex:C,dataEndIndex:I}),Ke=tt.length,nt,st,Rt;Hde(he.domain,ge,ue)&&(nt=fP(he.domain,null,ge),q&&(ue==="number"||fe!=="auto")&&(Rt=pb(tt,me,"category")));var Mt=MG(ue);if(!nt||nt.length===0){var $e,rt=($e=he.domain)!==null&&$e!==void 0?$e:Mt;if(me){if(nt=pb(tt,me,ue),ue==="category"&&q){var Ct=FY(nt);se&&Ct?(st=nt,nt=pT(0,Ke)):se||(nt=Pj(rt,nt,H).reduce(function(gt,Bt){return gt.indexOf(Bt)>=0?gt:[].concat(px(gt),[Bt])},[]))}else if(ue==="category")se?nt=nt.filter(function(gt){return gt!==""&&!ei(gt)}):nt=Pj(rt,nt,H).reduce(function(gt,Bt){return gt.indexOf(Bt)>=0||Bt===""||ei(Bt)?gt:[].concat(px(gt),[Bt])},[]);else if(ue==="number"){var Kt=Yie(tt,h.filter(function(gt){var Bt,ar,Er=w in gt.props?gt.props[w]:(Bt=gt.type.defaultProps)===null||Bt===void 0?void 0:Bt[w],jr="hide"in gt.props?gt.props.hide:(ar=gt.type.defaultProps)===null||ar===void 0?void 0:ar.hide;return Er===Ue&&(Le||!jr)}),me,v,L);Kt&&(nt=Kt)}q&&(ue==="number"||fe!=="auto")&&(Rt=pb(tt,me,"category"))}else q?nt=pT(0,Ke):a&&a[Ue]&&a[Ue].hasStack&&ue==="number"?nt=G==="expand"?[0,1]:p7(a[Ue].stackGroups,C,I):nt=l7(tt,h.filter(function(gt){var Bt=w in gt.props?gt.props[w]:gt.type.defaultProps[w],ar="hide"in gt.props?gt.props.hide:gt.type.defaultProps.hide;return Bt===Ue&&(Le||!ar)}),ue,L,!0);if(ue==="number")nt=WP(k,nt,Ue,v,ve),rt&&(nt=fP(rt,nt,ge));else if(ue==="category"&&rt){var Je=rt,Ze=nt.every(function(gt){return Je.indexOf(gt)>=0});Ze&&(nt=Je)}}return cr(cr({},Q),{},Rn({},Ue,cr(cr({},he),{},{axisType:v,domain:nt,categoricalDomain:Rt,duplicateDomain:st,originalDomain:(K=he.domain)!==null&&K!==void 0?K:Mt,isCategorical:q,layout:L})))},{})},bfe=function(t,o){var l=o.graphicalItems,h=o.Axis,v=o.axisType,w=o.axisIdKey,a=o.stackGroups,C=o.dataStartIndex,I=o.dataEndIndex,L=t.layout,k=t.children,G=mS(t.data,{graphicalItems:l,dataStartIndex:C,dataEndIndex:I}),q=G.length,Q=c7(L,v),H=-1;return l.reduce(function(K,he){var ue=he.type.defaultProps!==void 0?cr(cr({},he.type.defaultProps),he.props):he.props,me=ue[w],ge=MG("number");if(!K[me]){H++;var se;return Q?se=pT(0,q):a&&a[me]&&a[me].hasStack?(se=p7(a[me].stackGroups,C,I),se=WP(k,se,me,v)):(se=fP(ge,l7(G,l.filter(function(fe){var ve,Le,Ue=w in fe.props?fe.props[w]:(ve=fe.type.defaultProps)===null||ve===void 0?void 0:ve[w],tt="hide"in fe.props?fe.props.hide:(Le=fe.type.defaultProps)===null||Le===void 0?void 0:Le.hide;return Ue===me&&!tt}),"number",L),h.defaultProps.allowDataOverflow),se=WP(k,se,me,v)),cr(cr({},K),{},Rn({},me,cr(cr({axisType:v},h.defaultProps),{},{hide:!0,orientation:ju(gfe,"".concat(v,".").concat(H%2),null),domain:se,originalDomain:ge,isCategorical:Q,layout:L})))}return K},{})},wfe=function(t,o){var l=o.axisType,h=l===void 0?"xAxis":l,v=o.AxisComp,w=o.graphicalItems,a=o.stackGroups,C=o.dataStartIndex,I=o.dataEndIndex,L=t.children,k="".concat(h,"Id"),G=Rh(L,v),q={};return G&&G.length?q=xfe(t,{axes:G,graphicalItems:w,axisType:h,axisIdKey:k,stackGroups:a,dataStartIndex:C,dataEndIndex:I}):w&&w.length&&(q=bfe(t,{Axis:v,graphicalItems:w,axisType:h,axisIdKey:k,stackGroups:a,dataStartIndex:C,dataEndIndex:I})),q},Afe=function(t){var o=zg(t),l=sm(o,!1,!0);return{tooltipTicks:l,orderedTooltipTicks:YD(l,function(h){return h.coordinate}),tooltipAxis:o,tooltipAxisBandSize:tT(o,l)}},CU=function(t){var o=t.children,l=t.defaultShowTooltip,h=Iu(o,ix),v=0,w=0;return t.data&&t.data.length!==0&&(w=t.data.length-1),h&&h.props&&(h.props.startIndex>=0&&(v=h.props.startIndex),h.props.endIndex>=0&&(w=h.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:v,dataEndIndex:w,activeTooltipIndex:-1,isTooltipActive:!!l}},Tfe=function(t){return!t||!t.length?!1:t.some(function(o){var l=cm(o&&o.type);return l&&l.indexOf("Bar")>=0})},IU=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Sfe=function(t,o){var l=t.props,h=t.graphicalItems,v=t.xAxisMap,w=v===void 0?{}:v,a=t.yAxisMap,C=a===void 0?{}:a,I=l.width,L=l.height,k=l.children,G=l.margin||{},q=Iu(k,ix),Q=Iu(k,D0),H=Object.keys(C).reduce(function(se,fe){var ve=C[fe],Le=ve.orientation;return!ve.mirror&&!ve.hide?cr(cr({},se),{},Rn({},Le,se[Le]+ve.width)):se},{left:G.left||0,right:G.right||0}),K=Object.keys(w).reduce(function(se,fe){var ve=w[fe],Le=ve.orientation;return!ve.mirror&&!ve.hide?cr(cr({},se),{},Rn({},Le,ju(se,"".concat(Le))+ve.height)):se},{top:G.top||0,bottom:G.bottom||0}),he=cr(cr({},K),H),ue=he.bottom;q&&(he.bottom+=q.props.height||ix.defaultProps.height),Q&&o&&(he=Zie(he,h,l,o));var me=I-he.left-he.right,ge=L-he.top-he.bottom;return cr(cr({brushBottom:ue},he),{},{width:Math.max(me,0),height:Math.max(ge,0)})},Efe=function(t,o){if(o==="xAxis")return t[o].width;if(o==="yAxis")return t[o].height},RR=function(t){var o=t.chartName,l=t.GraphicalChild,h=t.defaultTooltipEventType,v=h===void 0?"axis":h,w=t.validateTooltipEventTypes,a=w===void 0?["axis"]:w,C=t.axisComponents,I=t.legendContent,L=t.formatAxisMap,k=t.defaultProps,G=function(he,ue){var me=ue.graphicalItems,ge=ue.stackGroups,se=ue.offset,fe=ue.updateId,ve=ue.dataStartIndex,Le=ue.dataEndIndex,Ue=he.barSize,tt=he.layout,Ke=he.barGap,nt=he.barCategoryGap,st=he.maxBarSize,Rt=IU(tt),Mt=Rt.numericAxisName,$e=Rt.cateAxisName,rt=Tfe(me),Ct=[];return me.forEach(function(Kt,Je){var Ze=mS(he.data,{graphicalItems:[Kt],dataStartIndex:ve,dataEndIndex:Le}),gt=Kt.type.defaultProps!==void 0?cr(cr({},Kt.type.defaultProps),Kt.props):Kt.props,Bt=gt.dataKey,ar=gt.maxBarSize,Er=gt["".concat(Mt,"Id")],jr=gt["".concat($e,"Id")],Zr={},fn=C.reduce(function(Yn,ha){var go=ue["".concat(ha.axisType,"Map")],ni=gt["".concat(ha.axisType,"Id")];go&&go[ni]||ha.axisType==="zAxis"||Qy();var ii=go[ni];return cr(cr({},Yn),{},Rn(Rn({},ha.axisType,ii),"".concat(ha.axisType,"Ticks"),sm(ii)))},Zr),Xt=fn[$e],Mr=fn["".concat($e,"Ticks")],kr=ge&&ge[Er]&&ge[Er].hasStack&&aae(Kt,ge[Er].stackGroups),or=cm(Kt.type).indexOf("Bar")>=0,Tr=tT(Xt,Mr),Ur=[],zn=rt&&Hie({barSize:Ue,stackGroups:ge,totalSize:Efe(fn,$e)});if(or){var Fn,Ut,_n=ei(ar)?st:ar,ua=(Fn=(Ut=tT(Xt,Mr,!0))!==null&&Ut!==void 0?Ut:_n)!==null&&Fn!==void 0?Fn:0;Ur=Xie({barGap:Ke,barCategoryGap:nt,bandSize:ua!==Tr?ua:Tr,sizeList:zn[jr],maxBarSize:_n}),ua!==Tr&&(Ur=Ur.map(function(Yn){return cr(cr({},Yn),{},{position:cr(cr({},Yn.position),{},{offset:Yn.position.offset-ua/2})})}))}var da=Kt&&Kt.type&&Kt.type.getComposedData;da&&Ct.push({props:cr(cr({},da(cr(cr({},fn),{},{displayedData:Ze,props:he,dataKey:Bt,item:Kt,bandSize:Tr,barPosition:Ur,offset:se,stackedData:kr,layout:tt,dataStartIndex:ve,dataEndIndex:Le}))),{},Rn(Rn(Rn({key:Kt.key||"item-".concat(Je)},Mt,fn[Mt]),$e,fn[$e]),"animationId",fe)),childIndex:KY(Kt,he.children),item:Kt})}),Ct},q=function(he,ue){var me=he.props,ge=he.dataStartIndex,se=he.dataEndIndex,fe=he.updateId;if(!q4({props:me}))return null;var ve=me.children,Le=me.layout,Ue=me.stackOffset,tt=me.data,Ke=me.reverseStackOrder,nt=IU(Le),st=nt.numericAxisName,Rt=nt.cateAxisName,Mt=Rh(ve,l),$e=nae(tt,Mt,"".concat(st,"Id"),"".concat(Rt,"Id"),Ue,Ke),rt=C.reduce(function(gt,Bt){var ar="".concat(Bt.axisType,"Map");return cr(cr({},gt),{},Rn({},ar,wfe(me,cr(cr({},Bt),{},{graphicalItems:Mt,stackGroups:Bt.axisType===st&&$e,dataStartIndex:ge,dataEndIndex:se}))))},{}),Ct=Sfe(cr(cr({},rt),{},{props:me,graphicalItems:Mt}),ue?.legendBBox);Object.keys(rt).forEach(function(gt){rt[gt]=L(me,rt[gt],Ct,gt.replace("Map",""),o)});var Kt=rt["".concat(Rt,"Map")],Je=Afe(Kt),Ze=G(me,cr(cr({},rt),{},{dataStartIndex:ge,dataEndIndex:se,updateId:fe,graphicalItems:Mt,stackGroups:$e,offset:Ct}));return cr(cr({formattedGraphicalItems:Ze,graphicalItems:Mt,offset:Ct,stackGroups:$e},Je),rt)},Q=(function(K){function he(ue){var me,ge,se;return afe(this,he),se=lfe(this,he,[ue]),Rn(se,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Rn(se,"accessibilityManager",new qde),Rn(se,"handleLegendBBoxUpdate",function(fe){if(fe){var ve=se.state,Le=ve.dataStartIndex,Ue=ve.dataEndIndex,tt=ve.updateId;se.setState(cr({legendBBox:fe},q({props:se.props,dataStartIndex:Le,dataEndIndex:Ue,updateId:tt},cr(cr({},se.state),{},{legendBBox:fe}))))}}),Rn(se,"handleReceiveSyncEvent",function(fe,ve,Le){if(se.props.syncId===fe){if(Le===se.eventEmitterSymbol&&typeof se.props.syncMethod!="function")return;se.applySyncEvent(ve)}}),Rn(se,"handleBrushChange",function(fe){var ve=fe.startIndex,Le=fe.endIndex;if(ve!==se.state.dataStartIndex||Le!==se.state.dataEndIndex){var Ue=se.state.updateId;se.setState(function(){return cr({dataStartIndex:ve,dataEndIndex:Le},q({props:se.props,dataStartIndex:ve,dataEndIndex:Le,updateId:Ue},se.state))}),se.triggerSyncEvent({dataStartIndex:ve,dataEndIndex:Le})}}),Rn(se,"handleMouseEnter",function(fe){var ve=se.getMouseInfo(fe);if(ve){var Le=cr(cr({},ve),{},{isTooltipActive:!0});se.setState(Le),se.triggerSyncEvent(Le);var Ue=se.props.onMouseEnter;Bn(Ue)&&Ue(Le,fe)}}),Rn(se,"triggeredAfterMouseMove",function(fe){var ve=se.getMouseInfo(fe),Le=ve?cr(cr({},ve),{},{isTooltipActive:!0}):{isTooltipActive:!1};se.setState(Le),se.triggerSyncEvent(Le);var Ue=se.props.onMouseMove;Bn(Ue)&&Ue(Le,fe)}),Rn(se,"handleItemMouseEnter",function(fe){se.setState(function(){return{isTooltipActive:!0,activeItem:fe,activePayload:fe.tooltipPayload,activeCoordinate:fe.tooltipPosition||{x:fe.cx,y:fe.cy}}})}),Rn(se,"handleItemMouseLeave",function(){se.setState(function(){return{isTooltipActive:!1}})}),Rn(se,"handleMouseMove",function(fe){fe.persist(),se.throttleTriggeredAfterMouseMove(fe)}),Rn(se,"handleMouseLeave",function(fe){se.throttleTriggeredAfterMouseMove.cancel();var ve={isTooltipActive:!1};se.setState(ve),se.triggerSyncEvent(ve);var Le=se.props.onMouseLeave;Bn(Le)&&Le(ve,fe)}),Rn(se,"handleOuterEvent",function(fe){var ve=YY(fe),Le=ju(se.props,"".concat(ve));if(ve&&Bn(Le)){var Ue,tt;/.*touch.*/i.test(ve)?tt=se.getMouseInfo(fe.changedTouches[0]):tt=se.getMouseInfo(fe),Le((Ue=tt)!==null&&Ue!==void 0?Ue:{},fe)}}),Rn(se,"handleClick",function(fe){var ve=se.getMouseInfo(fe);if(ve){var Le=cr(cr({},ve),{},{isTooltipActive:!0});se.setState(Le),se.triggerSyncEvent(Le);var Ue=se.props.onClick;Bn(Ue)&&Ue(Le,fe)}}),Rn(se,"handleMouseDown",function(fe){var ve=se.props.onMouseDown;if(Bn(ve)){var Le=se.getMouseInfo(fe);ve(Le,fe)}}),Rn(se,"handleMouseUp",function(fe){var ve=se.props.onMouseUp;if(Bn(ve)){var Le=se.getMouseInfo(fe);ve(Le,fe)}}),Rn(se,"handleTouchMove",function(fe){fe.changedTouches!=null&&fe.changedTouches.length>0&&se.throttleTriggeredAfterMouseMove(fe.changedTouches[0])}),Rn(se,"handleTouchStart",function(fe){fe.changedTouches!=null&&fe.changedTouches.length>0&&se.handleMouseDown(fe.changedTouches[0])}),Rn(se,"handleTouchEnd",function(fe){fe.changedTouches!=null&&fe.changedTouches.length>0&&se.handleMouseUp(fe.changedTouches[0])}),Rn(se,"handleDoubleClick",function(fe){var ve=se.props.onDoubleClick;if(Bn(ve)){var Le=se.getMouseInfo(fe);ve(Le,fe)}}),Rn(se,"handleContextMenu",function(fe){var ve=se.props.onContextMenu;if(Bn(ve)){var Le=se.getMouseInfo(fe);ve(Le,fe)}}),Rn(se,"triggerSyncEvent",function(fe){se.props.syncId!==void 0&&tI.emit(rI,se.props.syncId,fe,se.eventEmitterSymbol)}),Rn(se,"applySyncEvent",function(fe){var ve=se.props,Le=ve.layout,Ue=ve.syncMethod,tt=se.state.updateId,Ke=fe.dataStartIndex,nt=fe.dataEndIndex;if(fe.dataStartIndex!==void 0||fe.dataEndIndex!==void 0)se.setState(cr({dataStartIndex:Ke,dataEndIndex:nt},q({props:se.props,dataStartIndex:Ke,dataEndIndex:nt,updateId:tt},se.state)));else if(fe.activeTooltipIndex!==void 0){var st=fe.chartX,Rt=fe.chartY,Mt=fe.activeTooltipIndex,$e=se.state,rt=$e.offset,Ct=$e.tooltipTicks;if(!rt)return;if(typeof Ue=="function")Mt=Ue(Ct,fe);else if(Ue==="value"){Mt=-1;for(var Kt=0;Kt<Ct.length;Kt++)if(Ct[Kt].value===fe.activeLabel){Mt=Kt;break}}var Je=cr(cr({},rt),{},{x:rt.left,y:rt.top}),Ze=Math.min(st,Je.x+Je.width),gt=Math.min(Rt,Je.y+Je.height),Bt=Ct[Mt]&&Ct[Mt].value,ar=QP(se.state,se.props.data,Mt),Er=Ct[Mt]?{x:Le==="horizontal"?Ct[Mt].coordinate:Ze,y:Le==="horizontal"?gt:Ct[Mt].coordinate}:EG;se.setState(cr(cr({},fe),{},{activeLabel:Bt,activeCoordinate:Er,activePayload:ar,activeTooltipIndex:Mt}))}else se.setState(fe)}),Rn(se,"renderCursor",function(fe){var ve,Le=se.state,Ue=Le.isTooltipActive,tt=Le.activeCoordinate,Ke=Le.activePayload,nt=Le.offset,st=Le.activeTooltipIndex,Rt=Le.tooltipAxisBandSize,Mt=se.getTooltipEventType(),$e=(ve=fe.props.active)!==null&&ve!==void 0?ve:Ue,rt=se.props.layout,Ct=fe.key||"_recharts-cursor";return ft.createElement(Qde,{key:Ct,activeCoordinate:tt,activePayload:Ke,activeTooltipIndex:st,chartName:o,element:fe,isActive:$e,layout:rt,offset:nt,tooltipAxisBandSize:Rt,tooltipEventType:Mt})}),Rn(se,"renderPolarAxis",function(fe,ve,Le){var Ue=ju(fe,"type.axisType"),tt=ju(se.state,"".concat(Ue,"Map")),Ke=fe.type.defaultProps,nt=Ke!==void 0?cr(cr({},Ke),fe.props):fe.props,st=tt&&tt[nt["".concat(Ue,"Id")]];return Jt.cloneElement(fe,cr(cr({},st),{},{className:li(Ue,st.className),key:fe.key||"".concat(ve,"-").concat(Le),ticks:sm(st,!0)}))}),Rn(se,"renderPolarGrid",function(fe){var ve=fe.props,Le=ve.radialLines,Ue=ve.polarAngles,tt=ve.polarRadius,Ke=se.state,nt=Ke.radiusAxisMap,st=Ke.angleAxisMap,Rt=zg(nt),Mt=zg(st),$e=Mt.cx,rt=Mt.cy,Ct=Mt.innerRadius,Kt=Mt.outerRadius;return Jt.cloneElement(fe,{polarAngles:Array.isArray(Ue)?Ue:sm(Mt,!0).map(function(Je){return Je.coordinate}),polarRadius:Array.isArray(tt)?tt:sm(Rt,!0).map(function(Je){return Je.coordinate}),cx:$e,cy:rt,innerRadius:Ct,outerRadius:Kt,key:fe.key||"polar-grid",radialLines:Le})}),Rn(se,"renderLegend",function(){var fe=se.state.formattedGraphicalItems,ve=se.props,Le=ve.children,Ue=ve.width,tt=ve.height,Ke=se.props.margin||{},nt=Ue-(Ke.left||0)-(Ke.right||0),st=o7({children:Le,formattedGraphicalItems:fe,legendWidth:nt,legendContent:I});if(!st)return null;var Rt=st.item,Mt=EU(st,Jde);return Jt.cloneElement(Rt,cr(cr({},Mt),{},{chartWidth:Ue,chartHeight:tt,margin:Ke,onBBoxUpdate:se.handleLegendBBoxUpdate}))}),Rn(se,"renderTooltip",function(){var fe,ve=se.props,Le=ve.children,Ue=ve.accessibilityLayer,tt=Iu(Le,Du);if(!tt)return null;var Ke=se.state,nt=Ke.isTooltipActive,st=Ke.activeCoordinate,Rt=Ke.activePayload,Mt=Ke.activeLabel,$e=Ke.offset,rt=(fe=tt.props.active)!==null&&fe!==void 0?fe:nt;return Jt.cloneElement(tt,{viewBox:cr(cr({},$e),{},{x:$e.left,y:$e.top}),active:rt,label:Mt,payload:rt?Rt:[],coordinate:st,accessibilityLayer:Ue})}),Rn(se,"renderBrush",function(fe){var ve=se.props,Le=ve.margin,Ue=ve.data,tt=se.state,Ke=tt.offset,nt=tt.dataStartIndex,st=tt.dataEndIndex,Rt=tt.updateId;return Jt.cloneElement(fe,{key:fe.key||"_recharts-brush",onChange:Q2(se.handleBrushChange,fe.props.onChange),data:Ue,x:Ar(fe.props.x)?fe.props.x:Ke.left,y:Ar(fe.props.y)?fe.props.y:Ke.top+Ke.height+Ke.brushBottom-(Le.bottom||0),width:Ar(fe.props.width)?fe.props.width:Ke.width,startIndex:nt,endIndex:st,updateId:"brush-".concat(Rt)})}),Rn(se,"renderReferenceElement",function(fe,ve,Le){if(!fe)return null;var Ue=se,tt=Ue.clipPathId,Ke=se.state,nt=Ke.xAxisMap,st=Ke.yAxisMap,Rt=Ke.offset,Mt=fe.type.defaultProps||{},$e=fe.props,rt=$e.xAxisId,Ct=rt===void 0?Mt.xAxisId:rt,Kt=$e.yAxisId,Je=Kt===void 0?Mt.yAxisId:Kt;return Jt.cloneElement(fe,{key:fe.key||"".concat(ve,"-").concat(Le),xAxis:nt[Ct],yAxis:st[Je],viewBox:{x:Rt.left,y:Rt.top,width:Rt.width,height:Rt.height},clipPathId:tt})}),Rn(se,"renderActivePoints",function(fe){var ve=fe.item,Le=fe.activePoint,Ue=fe.basePoint,tt=fe.childIndex,Ke=fe.isRange,nt=[],st=ve.props.key,Rt=ve.item.type.defaultProps!==void 0?cr(cr({},ve.item.type.defaultProps),ve.item.props):ve.item.props,Mt=Rt.activeDot,$e=Rt.dataKey,rt=cr(cr({index:tt,dataKey:$e,cx:Le.x,cy:Le.y,r:4,fill:wR(ve.item),strokeWidth:2,stroke:"#fff",payload:Le.payload,value:Le.value},xn(Mt,!1)),PA(Mt));return nt.push(he.renderActiveDot(Mt,rt,"".concat(st,"-activePoint-").concat(tt))),Ue?nt.push(he.renderActiveDot(Mt,cr(cr({},rt),{},{cx:Ue.x,cy:Ue.y}),"".concat(st,"-basePoint-").concat(tt))):Ke&&nt.push(null),nt}),Rn(se,"renderGraphicChild",function(fe,ve,Le){var Ue=se.filterFormatItem(fe,ve,Le);if(!Ue)return null;var tt=se.getTooltipEventType(),Ke=se.state,nt=Ke.isTooltipActive,st=Ke.tooltipAxis,Rt=Ke.activeTooltipIndex,Mt=Ke.activeLabel,$e=se.props.children,rt=Iu($e,Du),Ct=Ue.props,Kt=Ct.points,Je=Ct.isRange,Ze=Ct.baseLine,gt=Ue.item.type.defaultProps!==void 0?cr(cr({},Ue.item.type.defaultProps),Ue.item.props):Ue.item.props,Bt=gt.activeDot,ar=gt.hide,Er=gt.activeBar,jr=gt.activeShape,Zr=!!(!ar&&nt&&rt&&(Bt||Er||jr)),fn={};tt!=="axis"&&rt&&rt.props.trigger==="click"?fn={onClick:Q2(se.handleItemMouseEnter,fe.props.onClick)}:tt!=="axis"&&(fn={onMouseLeave:Q2(se.handleItemMouseLeave,fe.props.onMouseLeave),onMouseEnter:Q2(se.handleItemMouseEnter,fe.props.onMouseEnter)});var Xt=Jt.cloneElement(fe,cr(cr({},Ue.props),fn));function Mr(ha){return typeof st.dataKey=="function"?st.dataKey(ha.payload):null}if(Zr)if(Rt>=0){var kr,or;if(st.dataKey&&!st.allowDuplicatedCategory){var Tr=typeof st.dataKey=="function"?Mr:"payload.".concat(st.dataKey.toString());kr=IA(Kt,Tr,Mt),or=Je&&Ze&&IA(Ze,Tr,Mt)}else kr=Kt?.[Rt],or=Je&&Ze&&Ze[Rt];if(jr||Er){var Ur=fe.props.activeIndex!==void 0?fe.props.activeIndex:Rt;return[Jt.cloneElement(fe,cr(cr(cr({},Ue.props),fn),{},{activeIndex:Ur})),null,null]}if(!ei(kr))return[Xt].concat(px(se.renderActivePoints({item:Ue,activePoint:kr,basePoint:or,childIndex:Rt,isRange:Je})))}else{var zn,Fn=(zn=se.getItemByXY(se.state.activeCoordinate))!==null&&zn!==void 0?zn:{graphicalItem:Xt},Ut=Fn.graphicalItem,_n=Ut.item,ua=_n===void 0?fe:_n,da=Ut.childIndex,Yn=cr(cr(cr({},Ue.props),fn),{},{activeIndex:da});return[Jt.cloneElement(ua,Yn),null,null]}return Je?[Xt,null,null]:[Xt,null]}),Rn(se,"renderCustomized",function(fe,ve,Le){return Jt.cloneElement(fe,cr(cr({key:"recharts-customized-".concat(Le)},se.props),se.state))}),Rn(se,"renderMap",{CartesianGrid:{handler:nA,once:!0},ReferenceArea:{handler:se.renderReferenceElement},ReferenceLine:{handler:nA},ReferenceDot:{handler:se.renderReferenceElement},XAxis:{handler:nA},YAxis:{handler:nA},Brush:{handler:se.renderBrush,once:!0},Bar:{handler:se.renderGraphicChild},Line:{handler:se.renderGraphicChild},Area:{handler:se.renderGraphicChild},Radar:{handler:se.renderGraphicChild},RadialBar:{handler:se.renderGraphicChild},Scatter:{handler:se.renderGraphicChild},Pie:{handler:se.renderGraphicChild},Funnel:{handler:se.renderGraphicChild},Tooltip:{handler:se.renderCursor,once:!0},PolarGrid:{handler:se.renderPolarGrid,once:!0},PolarAngleAxis:{handler:se.renderPolarAxis},PolarRadiusAxis:{handler:se.renderPolarAxis},Customized:{handler:se.renderCustomized}}),se.clipPathId="".concat((me=ue.id)!==null&&me!==void 0?me:yx("recharts"),"-clip"),se.throttleTriggeredAfterMouseMove=a9(se.triggeredAfterMouseMove,(ge=ue.throttleDelay)!==null&&ge!==void 0?ge:1e3/60),se.state={},se}return hfe(he,K),sfe(he,[{key:"componentDidMount",value:function(){var me,ge;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(me=this.props.margin.left)!==null&&me!==void 0?me:0,top:(ge=this.props.margin.top)!==null&&ge!==void 0?ge:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var me=this.props,ge=me.children,se=me.data,fe=me.height,ve=me.layout,Le=Iu(ge,Du);if(Le){var Ue=Le.props.defaultIndex;if(!(typeof Ue!="number"||Ue<0||Ue>this.state.tooltipTicks.length-1)){var tt=this.state.tooltipTicks[Ue]&&this.state.tooltipTicks[Ue].value,Ke=QP(this.state,se,Ue,tt),nt=this.state.tooltipTicks[Ue].coordinate,st=(this.state.offset.top+fe)/2,Rt=ve==="horizontal",Mt=Rt?{x:nt,y:st}:{y:nt,x:st},$e=this.state.formattedGraphicalItems.find(function(Ct){var Kt=Ct.item;return Kt.type.name==="Scatter"});$e&&(Mt=cr(cr({},Mt),$e.props.points[Ue].tooltipPosition),Ke=$e.props.points[Ue].tooltipPayload);var rt={activeTooltipIndex:Ue,isTooltipActive:!0,activeLabel:tt,activePayload:Ke,activeCoordinate:Mt};this.setState(rt),this.renderCursor(Le),this.accessibilityManager.setIndex(Ue)}}}},{key:"getSnapshotBeforeUpdate",value:function(me,ge){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==ge.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==me.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==me.margin){var se,fe;this.accessibilityManager.setDetails({offset:{left:(se=this.props.margin.left)!==null&&se!==void 0?se:0,top:(fe=this.props.margin.top)!==null&&fe!==void 0?fe:0}})}return null}},{key:"componentDidUpdate",value:function(me){LI([Iu(me.children,Du)],[Iu(this.props.children,Du)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var me=Iu(this.props.children,Du);if(me&&typeof me.props.shared=="boolean"){var ge=me.props.shared?"axis":"item";return a.indexOf(ge)>=0?ge:v}return v}},{key:"getMouseInfo",value:function(me){if(!this.container)return null;var ge=this.container,se=ge.getBoundingClientRect(),fe=kee(se),ve={chartX:Math.round(me.pageX-fe.left),chartY:Math.round(me.pageY-fe.top)},Le=se.width/ge.offsetWidth||1,Ue=this.inRange(ve.chartX,ve.chartY,Le);if(!Ue)return null;var tt=this.state,Ke=tt.xAxisMap,nt=tt.yAxisMap,st=this.getTooltipEventType(),Rt=OU(this.state,this.props.data,this.props.layout,Ue);if(st!=="axis"&&Ke&&nt){var Mt=zg(Ke).scale,$e=zg(nt).scale,rt=Mt&&Mt.invert?Mt.invert(ve.chartX):null,Ct=$e&&$e.invert?$e.invert(ve.chartY):null;return cr(cr({},ve),{},{xValue:rt,yValue:Ct},Rt)}return Rt?cr(cr({},ve),Rt):null}},{key:"inRange",value:function(me,ge){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,fe=this.props.layout,ve=me/se,Le=ge/se;if(fe==="horizontal"||fe==="vertical"){var Ue=this.state.offset,tt=ve>=Ue.left&&ve<=Ue.left+Ue.width&&Le>=Ue.top&&Le<=Ue.top+Ue.height;return tt?{x:ve,y:Le}:null}var Ke=this.state,nt=Ke.angleAxisMap,st=Ke.radiusAxisMap;if(nt&&st){var Rt=zg(nt);return zj({x:ve,y:Le},Rt)}return null}},{key:"parseEventsOfWrapper",value:function(){var me=this.props.children,ge=this.getTooltipEventType(),se=Iu(me,Du),fe={};se&&ge==="axis"&&(se.props.trigger==="click"?fe={onClick:this.handleClick}:fe={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var ve=PA(this.props,this.handleOuterEvent);return cr(cr({},ve),fe)}},{key:"addListener",value:function(){tI.on(rI,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){tI.removeListener(rI,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(me,ge,se){for(var fe=this.state.formattedGraphicalItems,ve=0,Le=fe.length;ve<Le;ve++){var Ue=fe[ve];if(Ue.item===me||Ue.props.key===me.key||ge===cm(Ue.item.type)&&se===Ue.childIndex)return Ue}return null}},{key:"renderClipPath",value:function(){var me=this.clipPathId,ge=this.state.offset,se=ge.left,fe=ge.top,ve=ge.height,Le=ge.width;return ft.createElement("defs",null,ft.createElement("clipPath",{id:me},ft.createElement("rect",{x:se,y:fe,height:ve,width:Le})))}},{key:"getXScales",value:function(){var me=this.state.xAxisMap;return me?Object.entries(me).reduce(function(ge,se){var fe=SU(se,2),ve=fe[0],Le=fe[1];return cr(cr({},ge),{},Rn({},ve,Le.scale))},{}):null}},{key:"getYScales",value:function(){var me=this.state.yAxisMap;return me?Object.entries(me).reduce(function(ge,se){var fe=SU(se,2),ve=fe[0],Le=fe[1];return cr(cr({},ge),{},Rn({},ve,Le.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(me){var ge;return(ge=this.state.xAxisMap)===null||ge===void 0||(ge=ge[me])===null||ge===void 0?void 0:ge.scale}},{key:"getYScaleByAxisId",value:function(me){var ge;return(ge=this.state.yAxisMap)===null||ge===void 0||(ge=ge[me])===null||ge===void 0?void 0:ge.scale}},{key:"getItemByXY",value:function(me){var ge=this.state,se=ge.formattedGraphicalItems,fe=ge.activeItem;if(se&&se.length)for(var ve=0,Le=se.length;ve<Le;ve++){var Ue=se[ve],tt=Ue.props,Ke=Ue.item,nt=Ke.type.defaultProps!==void 0?cr(cr({},Ke.type.defaultProps),Ke.props):Ke.props,st=cm(Ke.type);if(st==="Bar"){var Rt=(tt.data||[]).find(function(Ct){return ile(me,Ct)});if(Rt)return{graphicalItem:Ue,payload:Rt}}else if(st==="RadialBar"){var Mt=(tt.data||[]).find(function(Ct){return zj(me,Ct)});if(Mt)return{graphicalItem:Ue,payload:Mt}}else if(lS(Ue,fe)||cS(Ue,fe)||tw(Ue,fe)){var $e=Mce({graphicalItem:Ue,activeTooltipItem:fe,itemData:nt.data}),rt=nt.activeIndex===void 0?$e:nt.activeIndex;return{graphicalItem:cr(cr({},Ue),{},{childIndex:rt}),payload:tw(Ue,fe)?nt.data[$e]:Ue.props.data[$e]}}}return null}},{key:"render",value:function(){var me=this;if(!q4(this))return null;var ge=this.props,se=ge.children,fe=ge.className,ve=ge.width,Le=ge.height,Ue=ge.style,tt=ge.compact,Ke=ge.title,nt=ge.desc,st=EU(ge,efe),Rt=xn(st,!1);if(tt)return ft.createElement(sU,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ft.createElement(kI,T0({},Rt,{width:ve,height:Le,title:Ke,desc:nt}),this.renderClipPath(),X4(se,this.renderMap)));if(this.props.accessibilityLayer){var Mt,$e;Rt.tabIndex=(Mt=this.props.tabIndex)!==null&&Mt!==void 0?Mt:0,Rt.role=($e=this.props.role)!==null&&$e!==void 0?$e:"application",Rt.onKeyDown=function(Ct){me.accessibilityManager.keyboardEvent(Ct)},Rt.onFocus=function(){me.accessibilityManager.focus()}}var rt=this.parseEventsOfWrapper();return ft.createElement(sU,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},ft.createElement("div",T0({className:li("recharts-wrapper",fe),style:cr({position:"relative",cursor:"default",width:ve,height:Le},Ue)},rt,{ref:function(Kt){me.container=Kt}}),ft.createElement(kI,T0({},Rt,{width:ve,height:Le,title:Ke,desc:nt,style:_fe}),this.renderClipPath(),X4(se,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])})(Jt.Component);Rn(Q,"displayName",o),Rn(Q,"defaultProps",cr({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},k)),Rn(Q,"getDerivedStateFromProps",function(K,he){var ue=K.dataKey,me=K.data,ge=K.children,se=K.width,fe=K.height,ve=K.layout,Le=K.stackOffset,Ue=K.margin,tt=he.dataStartIndex,Ke=he.dataEndIndex;if(he.updateId===void 0){var nt=CU(K);return cr(cr(cr({},nt),{},{updateId:0},q(cr(cr({props:K},nt),{},{updateId:0}),he)),{},{prevDataKey:ue,prevData:me,prevWidth:se,prevHeight:fe,prevLayout:ve,prevStackOffset:Le,prevMargin:Ue,prevChildren:ge})}if(ue!==he.prevDataKey||me!==he.prevData||se!==he.prevWidth||fe!==he.prevHeight||ve!==he.prevLayout||Le!==he.prevStackOffset||!P0(Ue,he.prevMargin)){var st=CU(K),Rt={chartX:he.chartX,chartY:he.chartY,isTooltipActive:he.isTooltipActive},Mt=cr(cr({},OU(he,me,ve)),{},{updateId:he.updateId+1}),$e=cr(cr(cr({},st),Rt),Mt);return cr(cr(cr({},$e),q(cr({props:K},$e),he)),{},{prevDataKey:ue,prevData:me,prevWidth:se,prevHeight:fe,prevLayout:ve,prevStackOffset:Le,prevMargin:Ue,prevChildren:ge})}if(!LI(ge,he.prevChildren)){var rt,Ct,Kt,Je,Ze=Iu(ge,ix),gt=Ze&&(rt=(Ct=Ze.props)===null||Ct===void 0?void 0:Ct.startIndex)!==null&&rt!==void 0?rt:tt,Bt=Ze&&(Kt=(Je=Ze.props)===null||Je===void 0?void 0:Je.endIndex)!==null&&Kt!==void 0?Kt:Ke,ar=gt!==tt||Bt!==Ke,Er=!ei(me),jr=Er&&!ar?he.updateId:he.updateId+1;return cr(cr({updateId:jr},q(cr(cr({props:K},he),{},{updateId:jr,dataStartIndex:gt,dataEndIndex:Bt}),he)),{},{prevChildren:ge,dataStartIndex:gt,dataEndIndex:Bt})}return null}),Rn(Q,"renderActiveDot",function(K,he,ue){var me;return Jt.isValidElement(K)?me=Jt.cloneElement(K,he):Bn(K)?me=K(he):me=ft.createElement(nS,he),ft.createElement(Gi,{className:"recharts-active-dot",key:ue},me)});var H=Jt.forwardRef(function(he,ue){return ft.createElement(Q,T0({},he,{ref:ue}))});return H.displayName=Q.displayName,H},PU=RR({chartName:"BarChart",GraphicalChild:dm,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Gy},{axisType:"yAxis",AxisComp:$y}],formatAxisMap:q7}),Mfe=RR({chartName:"PieChart",GraphicalChild:wm,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:sS},{axisType:"radiusAxis",AxisComp:aS}],formatAxisMap:mae,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),Ofe=RR({chartName:"AreaChart",GraphicalChild:ym,axisComponents:[{axisType:"xAxis",AxisComp:Gy},{axisType:"yAxis",AxisComp:$y}],formatAxisMap:q7});const Cfe=()=>{const r=[];for(let t=0;t<24;t++)r.push({hour:`${t}:00`,passengers:Math.floor(Math.random()*5e3)+2e3,security:Math.floor(Math.random()*2e3)+500,retail:Math.floor(Math.random()*1500)+300});return r},Ife=()=>[{checkpoint:"North",waitTime:8,passengers:450},{checkpoint:"South",waitTime:12,passengers:380},{checkpoint:"Main",waitTime:6,passengers:520},{checkpoint:"Express",waitTime:3,passengers:180},{checkpoint:"TSA Pre",waitTime:4,passengers:290}],Pfe=()=>[{category:"Duty Free",revenue:45e3,visitors:1200},{category:"Food",revenue:32e3,visitors:2800},{category:"Fashion",revenue:28e3,visitors:950},{category:"Electronics",revenue:18e3,visitors:620},{category:"Books",revenue:8e3,visitors:480}],Dfe=()=>[{name:"Active",value:65,color:"#39FF14"},{name:"Available",value:25,color:"#22D3EE"},{name:"Closed",value:10,color:"#F43F5E"}],Rfe=()=>[{id:1,type:"warning",message:"Security wait time > 15 min at South checkpoint",time:"2 min ago"},{id:2,type:"info",message:"Gate B12 flight delayed by 25 minutes",time:"5 min ago"},{id:3,type:"success",message:"Baggage system operating normally",time:"10 min ago"},{id:4,type:"warning",message:"High passenger volume expected at 14:00",time:"15 min ago"}];function zfe({airport:r}){const[t,o]=Jt.useState("6h"),[l,h]=Jt.useState("overview"),v=Jt.useMemo(()=>Cfe(),[]),w=Jt.useMemo(()=>Ife(),[]),a=Jt.useMemo(()=>Pfe(),[]),C=Jt.useMemo(()=>Dfe(),[]),I=Jt.useMemo(()=>Rfe(),[]),[L,k]=Jt.useState({totalPassengers:12450,securityWait:8,onTimePerformance:91,retailRevenue:128500});Jt.useEffect(()=>{const q=setInterval(()=>{k(Q=>({totalPassengers:Q.totalPassengers+Math.floor(Math.random()*50)-20,securityWait:Math.max(3,Q.securityWait+Math.floor(Math.random()*3)-1),onTimePerformance:Math.min(100,Math.max(80,Q.onTimePerformance+Math.floor(Math.random()*3)-1)),retailRevenue:Q.retailRevenue+Math.floor(Math.random()*1e3)-200}))},5e3);return()=>clearInterval(q)},[]);const G=q=>{switch(q){case"warning":return ee.jsx(L5,{"code-path":"src/components/AnalyticsDashboard.tsx:118:16",className:"w-4 h-4 text-[#F59E0B]"});case"success":return ee.jsx(ED,{"code-path":"src/components/AnalyticsDashboard.tsx:120:16",className:"w-4 h-4 text-[#39FF14]"});default:return ee.jsx(DZ,{"code-path":"src/components/AnalyticsDashboard.tsx:122:16",className:"w-4 h-4 text-[#22D3EE]"})}};return ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:127:5",className:"space-y-6",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:129:7",className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:130:9",className:"flex bg-[#111827] rounded-lg p-1",children:["overview","security","retail","gates"].map(q=>ee.jsx("button",{"code-path":"src/components/AnalyticsDashboard.tsx:132:13",onClick:()=>h(q),className:`px-4 py-2 rounded-md text-sm font-medium capitalize transition-all ${l===q?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:q},q))}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:146:9",className:"flex bg-[#111827] rounded-lg p-1",children:["1h","6h","24h"].map(q=>ee.jsx("button",{"code-path":"src/components/AnalyticsDashboard.tsx:148:13",onClick:()=>o(q),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${t===q?"bg-white/10 text-[#F3F4F6]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:q},q))})]}),l==="overview"&&ee.jsxs(ee.Fragment,{children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:167:11",className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:168:13",className:"glass rounded-xl p-5",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:169:15",className:"flex items-center justify-between mb-3",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:170:17",className:"w-10 h-10 bg-[#39FF14]/20 rounded-lg flex items-center justify-center",children:ee.jsx(II,{"code-path":"src/components/AnalyticsDashboard.tsx:171:19",className:"w-5 h-5 text-[#39FF14]"})}),ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:173:17",className:"flex items-center gap-1 text-xs text-[#39FF14]",children:[ee.jsx(G2,{"code-path":"src/components/AnalyticsDashboard.tsx:174:19",className:"w-3 h-3"}),"+12%"]})]}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:178:15",className:"text-2xl font-bold",children:L.totalPassengers.toLocaleString()}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:179:15",className:"text-xs text-[#9AA3B2]",children:"Passengers on floor"})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:182:13",className:"glass rounded-xl p-5",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:183:15",className:"flex items-center justify-between mb-3",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:184:17",className:"w-10 h-10 bg-[#22D3EE]/20 rounded-lg flex items-center justify-center",children:ee.jsx(DT,{"code-path":"src/components/AnalyticsDashboard.tsx:185:19",className:"w-5 h-5 text-[#22D3EE]"})}),ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:187:17",className:"flex items-center gap-1 text-xs text-[#F59E0B]",children:[ee.jsx(G2,{"code-path":"src/components/AnalyticsDashboard.tsx:188:19",className:"w-3 h-3"}),"+2m"]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:192:15",className:"text-2xl font-bold",children:[L.securityWait," min"]}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:193:15",className:"text-xs text-[#9AA3B2]",children:"Avg security wait"})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:196:13",className:"glass rounded-xl p-5",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:197:15",className:"flex items-center justify-between mb-3",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:198:17",className:"w-10 h-10 bg-[#8B5CF6]/20 rounded-lg flex items-center justify-center",children:ee.jsx(xW,{"code-path":"src/components/AnalyticsDashboard.tsx:199:19",className:"w-5 h-5 text-[#8B5CF6]"})}),ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:201:17",className:"flex items-center gap-1 text-xs text-[#39FF14]",children:[ee.jsx(G2,{"code-path":"src/components/AnalyticsDashboard.tsx:202:19",className:"w-3 h-3"}),"+3%"]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:206:15",className:"text-2xl font-bold",children:[L.onTimePerformance,"%"]}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:207:15",className:"text-xs text-[#9AA3B2]",children:"On-time performance"})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:210:13",className:"glass rounded-xl p-5",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:211:15",className:"flex items-center justify-between mb-3",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:212:17",className:"w-10 h-10 bg-[#F59E0B]/20 rounded-lg flex items-center justify-center",children:ee.jsx(CA,{"code-path":"src/components/AnalyticsDashboard.tsx:213:19",className:"w-5 h-5 text-[#F59E0B]"})}),ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:215:17",className:"flex items-center gap-1 text-xs text-[#39FF14]",children:[ee.jsx(G2,{"code-path":"src/components/AnalyticsDashboard.tsx:216:19",className:"w-3 h-3"}),"+8%"]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:220:15",className:"text-2xl font-bold",children:["$",(L.retailRevenue/1e3).toFixed(1),"k"]}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:221:15",className:"text-xs text-[#9AA3B2]",children:"Retail revenue (today)"})]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:226:11",className:"grid lg:grid-cols-3 gap-6",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:228:13",className:"lg:col-span-2 glass rounded-xl p-5",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:229:15",className:"flex items-center justify-between mb-4",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:230:17",className:"font-semibold",children:"Passenger Flow"}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:231:17",className:"flex items-center gap-4 text-xs",children:[ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:232:19",className:"flex items-center gap-1.5",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:233:21",className:"w-2 h-2 rounded-full bg-[#39FF14]"}),"Passengers"]}),ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:236:19",className:"flex items-center gap-1.5",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:237:21",className:"w-2 h-2 rounded-full bg-[#22D3EE]"}),"Security"]})]})]}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:242:15",className:"h-64",children:ee.jsx(X2,{"code-path":"src/components/AnalyticsDashboard.tsx:243:17",width:"100%",height:"100%",children:ee.jsxs(Ofe,{"code-path":"src/components/AnalyticsDashboard.tsx:244:19",data:v,children:[ee.jsxs("defs",{"code-path":"src/components/AnalyticsDashboard.tsx:245:21",children:[ee.jsxs("linearGradient",{"code-path":"src/components/AnalyticsDashboard.tsx:246:23",id:"colorPassengers",x1:"0",y1:"0",x2:"0",y2:"1",children:[ee.jsx("stop",{"code-path":"src/components/AnalyticsDashboard.tsx:247:25",offset:"5%",stopColor:"#39FF14",stopOpacity:.3}),ee.jsx("stop",{"code-path":"src/components/AnalyticsDashboard.tsx:248:25",offset:"95%",stopColor:"#39FF14",stopOpacity:0})]}),ee.jsxs("linearGradient",{"code-path":"src/components/AnalyticsDashboard.tsx:250:23",id:"colorSecurity",x1:"0",y1:"0",x2:"0",y2:"1",children:[ee.jsx("stop",{"code-path":"src/components/AnalyticsDashboard.tsx:251:25",offset:"5%",stopColor:"#22D3EE",stopOpacity:.3}),ee.jsx("stop",{"code-path":"src/components/AnalyticsDashboard.tsx:252:25",offset:"95%",stopColor:"#22D3EE",stopOpacity:0})]})]}),ee.jsx(gA,{"code-path":"src/components/AnalyticsDashboard.tsx:255:21",strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),ee.jsx(Gy,{"code-path":"src/components/AnalyticsDashboard.tsx:256:21",dataKey:"hour",stroke:"#9AA3B2",fontSize:10}),ee.jsx($y,{"code-path":"src/components/AnalyticsDashboard.tsx:257:21",stroke:"#9AA3B2",fontSize:10}),ee.jsx(Du,{"code-path":"src/components/AnalyticsDashboard.tsx:258:21",contentStyle:{background:"#111827",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"}}),ee.jsx(ym,{"code-path":"src/components/AnalyticsDashboard.tsx:265:21",type:"monotone",dataKey:"passengers",stroke:"#39FF14",fillOpacity:1,fill:"url(#colorPassengers)"}),ee.jsx(ym,{"code-path":"src/components/AnalyticsDashboard.tsx:272:21",type:"monotone",dataKey:"security",stroke:"#22D3EE",fillOpacity:1,fill:"url(#colorSecurity)"})]})})})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:285:13",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:286:15",className:"font-semibold mb-4",children:"Live Alerts"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:287:15",className:"space-y-3",children:I.map(q=>ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:289:19",className:"flex items-start gap-3 p-3 bg-white/5 rounded-lg",children:[G(q.type),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:294:21",className:"flex-1 min-w-0",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:295:23",className:"text-sm",children:q.message}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:296:23",className:"text-xs text-[#9AA3B2] mt-1",children:q.time})]})]},q.id))})]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:305:11",className:"grid lg:grid-cols-2 gap-6",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:307:13",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:308:15",className:"font-semibold mb-4",children:"Gate Utilization"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:309:15",className:"h-48",children:ee.jsx(X2,{"code-path":"src/components/AnalyticsDashboard.tsx:310:17",width:"100%",height:"100%",children:ee.jsxs(Mfe,{"code-path":"src/components/AnalyticsDashboard.tsx:311:19",children:[ee.jsx(wm,{"code-path":"src/components/AnalyticsDashboard.tsx:312:21",data:C,cx:"50%",cy:"50%",innerRadius:50,outerRadius:70,paddingAngle:5,dataKey:"value",children:C.map((q,Q)=>ee.jsx(qT,{"code-path":"src/components/AnalyticsDashboard.tsx:322:25",fill:q.color},`cell-${Q}`))}),ee.jsx(Du,{"code-path":"src/components/AnalyticsDashboard.tsx:325:21",contentStyle:{background:"#111827",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"}})]})})}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:335:15",className:"flex justify-center gap-4 mt-2",children:C.map(q=>ee.jsxs("span",{"code-path":"src/components/AnalyticsDashboard.tsx:337:19",className:"flex items-center gap-1.5 text-xs",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:338:21",className:"w-2 h-2 rounded-full",style:{background:q.color}}),q.name," (",q.value,"%)"]},q.name))})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:346:13",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:347:15",className:"font-semibold mb-4",children:"Quick Actions"}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:348:15",className:"grid grid-cols-2 gap-3",children:[ee.jsxs("button",{"code-path":"src/components/AnalyticsDashboard.tsx:349:17",className:"p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left",children:[ee.jsx(CD,{"code-path":"src/components/AnalyticsDashboard.tsx:350:19",className:"w-5 h-5 text-[#39FF14] mb-2"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:351:19",className:"text-sm font-medium",children:"Open Additional Lane"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:352:19",className:"text-xs text-[#9AA3B2]",children:"Security checkpoint"})]}),ee.jsxs("button",{"code-path":"src/components/AnalyticsDashboard.tsx:354:17",className:"p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left",children:[ee.jsx(II,{"code-path":"src/components/AnalyticsDashboard.tsx:355:19",className:"w-5 h-5 text-[#22D3EE] mb-2"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:356:19",className:"text-sm font-medium",children:"Deploy Staff"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:357:19",className:"text-xs text-[#9AA3B2]",children:"To high-traffic areas"})]}),ee.jsxs("button",{"code-path":"src/components/AnalyticsDashboard.tsx:359:17",className:"p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left",children:[ee.jsx(L5,{"code-path":"src/components/AnalyticsDashboard.tsx:360:19",className:"w-5 h-5 text-[#F59E0B] mb-2"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:361:19",className:"text-sm font-medium",children:"Issue Alert"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:362:19",className:"text-xs text-[#9AA3B2]",children:"Notify passengers"})]}),ee.jsxs("button",{"code-path":"src/components/AnalyticsDashboard.tsx:364:17",className:"p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors text-left",children:[ee.jsx(CA,{"code-path":"src/components/AnalyticsDashboard.tsx:365:19",className:"w-5 h-5 text-[#8B5CF6] mb-2"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:366:19",className:"text-sm font-medium",children:"Generate Report"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:367:19",className:"text-xs text-[#9AA3B2]",children:"Export analytics"})]})]})]})]})]}),l==="security"&&ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:377:9",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:378:11",className:"font-semibold mb-4",children:"Security Checkpoint Wait Times"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:379:11",className:"h-80",children:ee.jsx(X2,{"code-path":"src/components/AnalyticsDashboard.tsx:380:13",width:"100%",height:"100%",children:ee.jsxs(PU,{"code-path":"src/components/AnalyticsDashboard.tsx:381:15",data:w,layout:"vertical",children:[ee.jsx(gA,{"code-path":"src/components/AnalyticsDashboard.tsx:382:17",strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),ee.jsx(Gy,{"code-path":"src/components/AnalyticsDashboard.tsx:383:17",type:"number",stroke:"#9AA3B2",fontSize:10}),ee.jsx($y,{"code-path":"src/components/AnalyticsDashboard.tsx:384:17",dataKey:"checkpoint",type:"category",stroke:"#9AA3B2",fontSize:12,width:80}),ee.jsx(Du,{"code-path":"src/components/AnalyticsDashboard.tsx:385:17",contentStyle:{background:"#111827",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"}}),ee.jsx(dm,{"code-path":"src/components/AnalyticsDashboard.tsx:392:17",dataKey:"waitTime",fill:"#39FF14",radius:[0,4,4,0]})]})})})]}),l==="retail"&&ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:401:9",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:402:11",className:"font-semibold mb-4",children:"Retail Performance by Category"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:403:11",className:"h-80",children:ee.jsx(X2,{"code-path":"src/components/AnalyticsDashboard.tsx:404:13",width:"100%",height:"100%",children:ee.jsxs(PU,{"code-path":"src/components/AnalyticsDashboard.tsx:405:15",data:a,children:[ee.jsx(gA,{"code-path":"src/components/AnalyticsDashboard.tsx:406:17",strokeDasharray:"3 3",stroke:"rgba(255,255,255,0.05)"}),ee.jsx(Gy,{"code-path":"src/components/AnalyticsDashboard.tsx:407:17",dataKey:"category",stroke:"#9AA3B2",fontSize:12}),ee.jsx($y,{"code-path":"src/components/AnalyticsDashboard.tsx:408:17",stroke:"#9AA3B2",fontSize:10}),ee.jsx(Du,{"code-path":"src/components/AnalyticsDashboard.tsx:409:17",contentStyle:{background:"#111827",border:"1px solid rgba(255,255,255,0.1)",borderRadius:"8px"}}),ee.jsx(dm,{"code-path":"src/components/AnalyticsDashboard.tsx:416:17",dataKey:"revenue",fill:"#39FF14",radius:[4,4,0,0]}),ee.jsx(dm,{"code-path":"src/components/AnalyticsDashboard.tsx:417:17",dataKey:"visitors",fill:"#22D3EE",radius:[4,4,0,0]})]})})})]}),l==="gates"&&ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:426:9",className:"glass rounded-xl p-5",children:[ee.jsx("h3",{"code-path":"src/components/AnalyticsDashboard.tsx:427:11",className:"font-semibold mb-4",children:"Gate Activity Timeline"}),ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:428:11",className:"space-y-3",children:r.terminals.slice(0,3).map(q=>ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:430:15",className:"p-4 bg-white/5 rounded-lg",children:[ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:431:17",className:"flex items-center justify-between mb-3",children:[ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:432:19",className:"font-medium",children:q.name}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:433:19",className:"text-xs text-[#9AA3B2]",children:[q.gates.filter(Q=>Q.status==="boarding").length," boarding / ",q.gates.length," total"]})]}),ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:437:17",className:"flex flex-wrap gap-2",children:[q.gates.slice(0,8).map(Q=>ee.jsx("div",{"code-path":"src/components/AnalyticsDashboard.tsx:439:21",className:`px-2 py-1 rounded text-xs font-medium ${Q.status==="boarding"?"bg-[#39FF14]/20 text-[#39FF14]":Q.status==="occupied"?"bg-[#22D3EE]/20 text-[#22D3EE]":Q.status==="closed"?"bg-[#F43F5E]/20 text-[#F43F5E]":"bg-white/10 text-[#9AA3B2]"}`,children:Q.number},Q.id)),q.gates.length>8&&ee.jsxs("div",{"code-path":"src/components/AnalyticsDashboard.tsx:452:21",className:"px-2 py-1 rounded text-xs text-[#9AA3B2]",children:["+",q.gates.length-8," more"]})]})]},q.id))})]})]})}function Lfe({airport:r}){const[t,o]=Jt.useState("directions"),[l,h]=Jt.useState(""),[v,w]=Jt.useState(""),[a,C]=Jt.useState(""),[I,L]=Jt.useState("all"),k=[{id:"1",type:"food",name:"Starbucks",location:"Concourse A",distance:"150m",walkingTime:"2 min"},{id:"2",type:"food",name:"Chick-fil-A",location:"Concourse B",distance:"300m",walkingTime:"4 min"},{id:"3",type:"retail",name:"Duty Free Shop",location:"Concourse F",distance:"500m",walkingTime:"6 min"},{id:"4",type:"lounge",name:"Delta Sky Club",location:"Concourse A",distance:"200m",walkingTime:"3 min"},{id:"5",type:"service",name:"Charging Station",location:"Concourse C",distance:"100m",walkingTime:"1 min"},{id:"6",type:"food",name:"Five Guys",location:"Concourse B",distance:"350m",walkingTime:"5 min"},{id:"7",type:"retail",name:"Best Buy Express",location:"Concourse B",distance:"320m",walkingTime:"4 min"},{id:"8",type:"lounge",name:"Centurion Lounge",location:"Concourse E",distance:"450m",walkingTime:"6 min"}],G=[{id:"all",name:"All",icon:hb},{id:"food",name:"Food",icon:OI},{id:"retail",name:"Retail",icon:CI},{id:"lounge",name:"Lounges",icon:OA},{id:"service",name:"Services",icon:PI}],q=k.filter(H=>{const K=I==="all"||H.type===I,he=H.name.toLowerCase().includes(a.toLowerCase())||H.location.toLowerCase().includes(a.toLowerCase());return K&&he}),Q=H=>{switch(H){case"food":return ee.jsx(OI,{"code-path":"src/components/NavigationPanel.tsx:67:16",className:"w-4 h-4"});case"retail":return ee.jsx(CI,{"code-path":"src/components/NavigationPanel.tsx:69:16",className:"w-4 h-4"});case"lounge":return ee.jsx(OA,{"code-path":"src/components/NavigationPanel.tsx:71:16",className:"w-4 h-4"});case"service":return ee.jsx(PI,{"code-path":"src/components/NavigationPanel.tsx:73:16",className:"w-4 h-4"});default:return ee.jsx(hb,{"code-path":"src/components/NavigationPanel.tsx:75:16",className:"w-4 h-4"})}};return ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:80:5",className:"glass rounded-xl overflow-hidden",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:82:7",className:"px-4 py-3 border-b border-white/10 bg-white/5",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:83:9",className:"text-xs text-[#9AA3B2] uppercase tracking-wider",children:"Current Airport"}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:84:9",className:"font-medium text-sm truncate",children:r.name})]}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:88:7",className:"flex border-b border-white/10",children:[ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:89:9",onClick:()=>o("directions"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-all ${t==="directions"?"bg-[#39FF14]/20 text-[#39FF14]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:[ee.jsx(MD,{"code-path":"src/components/NavigationPanel.tsx:97:11",className:"w-4 h-4"}),"Directions"]}),ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:100:9",onClick:()=>o("poi"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-all ${t==="poi"?"bg-[#39FF14]/20 text-[#39FF14]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:[ee.jsx(hb,{"code-path":"src/components/NavigationPanel.tsx:108:11",className:"w-4 h-4"}),"Points of Interest"]})]}),t==="directions"&&ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:115:9",className:"p-4 space-y-4",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:117:11",className:"space-y-3",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:118:13",className:"relative",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:119:15",className:"absolute left-3 top-1/2 -translate-y-1/2",children:ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:120:17",className:"w-2 h-2 rounded-full bg-[#39FF14]"})}),ee.jsx("input",{"code-path":"src/components/NavigationPanel.tsx:122:15",type:"text",placeholder:"From (e.g., Gate A1)",value:l,onChange:H=>h(H.target.value),className:"w-full pl-8 pr-4 py-2.5 text-sm"})]}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:130:13",className:"relative",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:131:15",className:"absolute left-3 top-1/2 -translate-y-1/2",children:ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:132:17",className:"w-2 h-2 rounded-full bg-[#F43F5E]"})}),ee.jsx("input",{"code-path":"src/components/NavigationPanel.tsx:134:15",type:"text",placeholder:"To (e.g., Gate B12)",value:v,onChange:H=>w(H.target.value),className:"w-full pl-8 pr-4 py-2.5 text-sm"})]})]}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:145:11",className:"flex gap-2",children:[ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:146:13",className:"flex items-center gap-1.5 px-3 py-2 bg-[#39FF14]/20 rounded-lg text-xs text-[#39FF14]",children:[ee.jsx(tM,{"code-path":"src/components/NavigationPanel.tsx:147:15",className:"w-3.5 h-3.5"}),"Walking"]}),ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:150:13",className:"flex items-center gap-1.5 px-3 py-2 bg-white/5 rounded-lg text-xs text-[#9AA3B2] hover:bg-white/10",children:[ee.jsx(IZ,{"code-path":"src/components/NavigationPanel.tsx:151:15",className:"w-3.5 h-3.5"}),"Accessible"]}),ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:154:13",className:"flex items-center gap-1.5 px-3 py-2 bg-white/5 rounded-lg text-xs text-[#9AA3B2] hover:bg-white/10",children:[ee.jsx(CD,{"code-path":"src/components/NavigationPanel.tsx:155:15",className:"w-3.5 h-3.5"}),"Fastest"]})]}),l&&v&&ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:162:13",className:"p-4 bg-white/5 rounded-lg animate-fade-in",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:163:15",className:"flex items-center justify-between mb-3",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:164:17",className:"flex items-center gap-2",children:[ee.jsx(tM,{"code-path":"src/components/NavigationPanel.tsx:165:19",className:"w-5 h-5 text-[#39FF14]"}),ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:166:19",className:"font-medium",children:"Walking Route"})]}),ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:168:17",className:"text-sm text-[#9AA3B2]",children:"8 min"})]}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:170:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:171:17",className:"flex items-center gap-3 text-sm",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:172:19",className:"w-2 h-2 rounded-full bg-[#39FF14]"}),ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:173:19",children:l})]}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:175:17",className:"ml-1 pl-1 border-l-2 border-dashed border-white/20",children:ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:176:19",className:"py-2 pl-4 text-xs text-[#9AA3B2]",children:"Head north toward Concourse B"})}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:180:17",className:"flex items-center gap-3 text-sm",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:181:19",className:"w-2 h-2 rounded-full bg-[#F43F5E]"}),ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:182:19",children:v})]})]}),ee.jsx("button",{"code-path":"src/components/NavigationPanel.tsx:185:15",className:"w-full mt-4 btn-primary text-sm py-2",children:"Start Navigation"})]}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:192:11",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:193:13",className:"text-xs text-[#9AA3B2] uppercase tracking-wider mb-2",children:"Quick Destinations"}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:196:13",className:"space-y-1",children:["Security Checkpoint","Baggage Claim","Restrooms","Food Court"].map((H,K)=>ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:198:17",onClick:()=>w(H),className:"w-full flex items-center justify-between p-2 hover:bg-white/5 rounded-lg transition-colors text-left text-sm",children:[ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:203:19",children:H}),ee.jsx(rV,{"code-path":"src/components/NavigationPanel.tsx:204:19",className:"w-4 h-4 text-[#9AA3B2]"})]},K))})]})]}),t==="poi"&&ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:214:9",className:"p-4 space-y-4",children:[ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:216:11",className:"relative",children:[ee.jsx(OD,{"code-path":"src/components/NavigationPanel.tsx:217:13",className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#9AA3B2]"}),ee.jsx("input",{"code-path":"src/components/NavigationPanel.tsx:218:13",type:"text",placeholder:"Search places...",value:a,onChange:H=>C(H.target.value),className:"w-full pl-9 pr-4 py-2.5 text-sm"})]}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:228:11",className:"flex flex-wrap gap-2",children:G.map(H=>ee.jsxs("button",{"code-path":"src/components/NavigationPanel.tsx:230:15",onClick:()=>L(H.id),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs transition-all ${I===H.id?"bg-[#39FF14] text-[#0B0F17]":"bg-white/5 text-[#9AA3B2] hover:bg-white/10"}`,children:[ee.jsx(H.icon,{"code-path":"src/components/NavigationPanel.tsx:239:17",className:"w-3.5 h-3.5"}),H.name]},H.id))}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:246:11",className:"space-y-2 max-h-80 overflow-y-auto",children:q.map(H=>ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:248:15",className:"flex items-start gap-3 p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors cursor-pointer",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:252:17",className:"w-8 h-8 bg-[#39FF14]/20 rounded-lg flex items-center justify-center flex-shrink-0",children:Q(H.type)}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:255:17",className:"flex-1 min-w-0",children:[ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:256:19",className:"font-medium text-sm",children:H.name}),ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:257:19",className:"text-xs text-[#9AA3B2]",children:H.location}),ee.jsxs("div",{"code-path":"src/components/NavigationPanel.tsx:258:19",className:"flex items-center gap-3 mt-1 text-xs",children:[ee.jsxs("span",{"code-path":"src/components/NavigationPanel.tsx:259:21",className:"flex items-center gap-1 text-[#22D3EE]",children:[ee.jsx(tM,{"code-path":"src/components/NavigationPanel.tsx:260:23",className:"w-3 h-3"}),H.walkingTime]}),ee.jsx("span",{"code-path":"src/components/NavigationPanel.tsx:263:21",className:"text-[#9AA3B2]",children:H.distance})]})]}),ee.jsx("button",{"code-path":"src/components/NavigationPanel.tsx:266:17",className:"text-[#39FF14] hover:underline text-xs",children:"Go"})]},H.id))}),q.length===0&&ee.jsx("div",{"code-path":"src/components/NavigationPanel.tsx:274:13",className:"text-center py-8 text-[#9AA3B2]",children:"No places found"})]})]})}Dg.registerPlugin(wi);function Bfe(){const[r,t]=Jt.useState(v0[0]),[o,l]=Jt.useState("passenger"),[h,v]=Jt.useState([]),[w,a]=Jt.useState(!1),[C,I]=Jt.useState(""),[L,k]=Jt.useState(!1),G=Jt.useRef(null),q=Jt.useRef(null);Jt.useEffect(()=>{const H=Pd.getMockFlights(r.code);v(H);const K=Pd.subscribe(he=>{v(he)});return()=>{K(),Pd.destroy()}},[r]),Jt.useEffect(()=>{const H=Dg.context(()=>{Dg.from(".hero-title",{y:30,opacity:0,duration:1,delay:.3,ease:"power3.out"}),Dg.from(".hero-subtitle",{y:20,opacity:0,duration:.8,delay:.5,ease:"power3.out"}),Dg.from(".hero-cta",{y:20,opacity:0,duration:.8,delay:.7,ease:"power3.out"}),Dg.from(".data-pill",{x:50,opacity:0,duration:.8,stagger:.15,delay:.9,ease:"power3.out"}),Dg.from(".ticker-bar",{y:50,opacity:0,duration:.8,delay:1.1,ease:"power3.out"})},G);return()=>H.revert()},[]),Jt.useEffect(()=>{const H=()=>{q.current&&(window.scrollY>50?(q.current.classList.add("glass"),q.current.classList.remove("bg-transparent")):(q.current.classList.remove("glass"),q.current.classList.add("bg-transparent")))};return window.addEventListener("scroll",H),()=>window.removeEventListener("scroll",H)},[]);const Q=H=>{const K=document.getElementById(H);K&&K.scrollIntoView({behavior:"smooth"}),a(!1)};return ee.jsxs("div",{"code-path":"src/App.tsx:140:5",className:"min-h-screen bg-[#0B0F17] text-[#F3F4F6] overflow-x-hidden",children:[ee.jsxs("nav",{"code-path":"src/App.tsx:142:7",ref:q,className:"fixed top-0 left-0 right-0 z-50 bg-transparent transition-all duration-300",children:[ee.jsx("div",{"code-path":"src/App.tsx:146:9",className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:ee.jsxs("div",{"code-path":"src/App.tsx:147:11",className:"flex items-center justify-between h-16",children:[ee.jsxs("div",{"code-path":"src/App.tsx:149:13",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/App.tsx:150:15",className:"w-8 h-8 bg-[#39FF14] rounded-lg flex items-center justify-center",children:ee.jsx(fA,{"code-path":"src/App.tsx:151:17",className:"w-5 h-5 text-[#0B0F17]"})}),ee.jsx("span",{"code-path":"src/App.tsx:153:15",className:"text-xl font-bold font-['Sora']",children:"AeroNav"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:157:13",className:"hidden md:flex items-center gap-8",children:[ee.jsx("button",{"code-path":"src/App.tsx:158:15",onClick:()=>Q("map"),className:"text-sm text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:"Map"}),ee.jsx("button",{"code-path":"src/App.tsx:164:15",onClick:()=>Q("flights"),className:"text-sm text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:"Flights"}),ee.jsx("button",{"code-path":"src/App.tsx:170:15",onClick:()=>Q("retail"),className:"text-sm text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:"Retail"}),ee.jsx("button",{"code-path":"src/App.tsx:176:15",onClick:()=>Q("analytics"),className:"text-sm text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:"Analytics"}),ee.jsx("button",{"code-path":"src/App.tsx:182:15",onClick:()=>Q("contact"),className:"text-sm text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:"Contact"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:191:13",className:"flex items-center gap-4",children:[ee.jsxs("div",{"code-path":"src/App.tsx:193:15",className:"hidden md:flex items-center bg-[#111827] rounded-lg p-1",children:[ee.jsx("button",{"code-path":"src/App.tsx:194:17",onClick:()=>l("passenger"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${o==="passenger"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:"Passenger"}),ee.jsx("button",{"code-path":"src/App.tsx:204:17",onClick:()=>l("operations"),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${o==="operations"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2] hover:text-[#F3F4F6]"}`,children:"Operations"})]}),ee.jsx("button",{"code-path":"src/App.tsx:217:15",onClick:()=>k(!L),className:"p-2 text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:ee.jsx(OD,{"code-path":"src/App.tsx:221:17",className:"w-5 h-5"})}),ee.jsx("button",{"code-path":"src/App.tsx:225:15",onClick:()=>a(!w),className:"md:hidden p-2 text-[#9AA3B2] hover:text-[#F3F4F6] transition-colors",children:w?ee.jsx(MW,{"code-path":"src/App.tsx:229:31",className:"w-5 h-5"}):ee.jsx(iW,{"code-path":"src/App.tsx:229:59",className:"w-5 h-5"})})]})]})}),L&&ee.jsx("div",{"code-path":"src/App.tsx:237:11",className:"absolute top-full left-0 right-0 glass p-4 animate-fade-in",children:ee.jsx("div",{"code-path":"src/App.tsx:238:13",className:"max-w-2xl mx-auto",children:ee.jsx("input",{"code-path":"src/App.tsx:239:15",type:"text",placeholder:"Search gates, flights, shops...",value:C,onChange:H=>I(H.target.value),className:"w-full",autoFocus:!0})})}),w&&ee.jsx("div",{"code-path":"src/App.tsx:253:11",className:"md:hidden glass border-t border-white/10 animate-fade-in",children:ee.jsxs("div",{"code-path":"src/App.tsx:254:13",className:"px-4 py-4 space-y-2",children:[ee.jsx("button",{"code-path":"src/App.tsx:255:15",onClick:()=>Q("map"),className:"block w-full text-left px-4 py-2 text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5 rounded-lg transition-colors",children:"Map"}),ee.jsx("button",{"code-path":"src/App.tsx:261:15",onClick:()=>Q("flights"),className:"block w-full text-left px-4 py-2 text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5 rounded-lg transition-colors",children:"Flights"}),ee.jsx("button",{"code-path":"src/App.tsx:267:15",onClick:()=>Q("retail"),className:"block w-full text-left px-4 py-2 text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5 rounded-lg transition-colors",children:"Retail"}),ee.jsx("button",{"code-path":"src/App.tsx:273:15",onClick:()=>Q("analytics"),className:"block w-full text-left px-4 py-2 text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5 rounded-lg transition-colors",children:"Analytics"}),ee.jsx("button",{"code-path":"src/App.tsx:279:15",onClick:()=>Q("contact"),className:"block w-full text-left px-4 py-2 text-[#9AA3B2] hover:text-[#F3F4F6] hover:bg-white/5 rounded-lg transition-colors",children:"Contact"}),ee.jsxs("div",{"code-path":"src/App.tsx:287:15",className:"flex items-center bg-[#111827] rounded-lg p-1 mt-4",children:[ee.jsx("button",{"code-path":"src/App.tsx:288:17",onClick:()=>l("passenger"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-all ${o==="passenger"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2]"}`,children:"Passenger"}),ee.jsx("button",{"code-path":"src/App.tsx:298:17",onClick:()=>l("operations"),className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-all ${o==="operations"?"bg-[#39FF14] text-[#0B0F17]":"text-[#9AA3B2]"}`,children:"Operations"})]})]})})]}),ee.jsxs("section",{"code-path":"src/App.tsx:315:7",ref:G,className:"relative min-h-screen flex items-center justify-center overflow-hidden blueprint-bg",children:[ee.jsx("div",{"code-path":"src/App.tsx:320:9",className:"absolute inset-0 grid-bg opacity-50"}),ee.jsx("div",{"code-path":"src/App.tsx:323:9",className:"absolute inset-0 bg-gradient-radial from-[#39FF14]/5 via-transparent to-transparent"}),ee.jsx("div",{"code-path":"src/App.tsx:325:9",className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20",children:ee.jsxs("div",{"code-path":"src/App.tsx:326:11",className:"grid lg:grid-cols-2 gap-12 items-center",children:[ee.jsxs("div",{"code-path":"src/App.tsx:328:13",className:"space-y-8",children:[ee.jsxs("div",{"code-path":"src/App.tsx:329:15",children:[ee.jsxs("h1",{"code-path":"src/App.tsx:330:17",className:"hero-title text-4xl sm:text-5xl lg:text-6xl font-bold leading-tight mb-6",children:["Your terminal,"," ",ee.jsx("span",{"code-path":"src/App.tsx:332:19",className:"text-[#39FF14]",children:"decoded."})]}),ee.jsx("p",{"code-path":"src/App.tsx:334:17",className:"hero-subtitle text-lg sm:text-xl text-[#9AA3B2] max-w-lg",children:"Real-time maps, flights, and walksbuilt for passengers and the teams who run the airport."})]}),ee.jsxs("div",{"code-path":"src/App.tsx:340:15",className:"hero-cta flex flex-wrap gap-4",children:[ee.jsx("select",{"code-path":"src/App.tsx:341:17",value:r.code,onChange:H=>{const K=v0.find(he=>he.code===H.target.value);K&&t(K)},className:"bg-[#111827] border border-white/10 rounded-lg px-4 py-3 text-sm focus:border-[#39FF14] focus:outline-none",children:v0.map(H=>ee.jsxs("option",{"code-path":"src/App.tsx:350:21",value:H.code,children:[H.code," - ",H.name]},H.code))}),ee.jsxs("button",{"code-path":"src/App.tsx:356:17",onClick:()=>Q("map"),className:"btn-primary flex items-center gap-2",children:[ee.jsx(rW,{"code-path":"src/App.tsx:360:19",className:"w-4 h-4"}),"Explore the Map"]}),ee.jsxs("button",{"code-path":"src/App.tsx:364:17",onClick:()=>{l("operations"),Q("analytics")},className:"btn-secondary flex items-center gap-2",children:[ee.jsx(CA,{"code-path":"src/App.tsx:371:19",className:"w-4 h-4"}),"Operations Demo"]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:377:15",className:"flex flex-wrap gap-8 pt-4",children:[ee.jsxs("div",{"code-path":"src/App.tsx:378:17",children:[ee.jsx("div",{"code-path":"src/App.tsx:379:19",className:"text-2xl font-bold text-[#39FF14]",children:"6"}),ee.jsx("div",{"code-path":"src/App.tsx:380:19",className:"text-sm text-[#9AA3B2]",children:"Major Airports"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:382:17",children:[ee.jsx("div",{"code-path":"src/App.tsx:383:19",className:"text-2xl font-bold text-[#22D3EE]",children:"500+"}),ee.jsx("div",{"code-path":"src/App.tsx:384:19",className:"text-sm text-[#9AA3B2]",children:"Gates Mapped"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:386:17",children:[ee.jsx("div",{"code-path":"src/App.tsx:387:19",className:"text-2xl font-bold text-[#8B5CF6]",children:"Real-time"}),ee.jsx("div",{"code-path":"src/App.tsx:388:19",className:"text-sm text-[#9AA3B2]",children:"Flight Updates"})]})]})]}),ee.jsx("div",{"code-path":"src/App.tsx:394:13",className:"hidden lg:block relative",children:ee.jsxs("div",{"code-path":"src/App.tsx:395:15",className:"absolute top-0 right-0 space-y-4",children:[ee.jsxs("div",{"code-path":"src/App.tsx:396:17",className:"data-pill glass rounded-xl p-4 flex items-center gap-3 animate-pulse-glow",children:[ee.jsx("div",{"code-path":"src/App.tsx:397:19",className:"w-10 h-10 bg-[#39FF14]/20 rounded-lg flex items-center justify-center",children:ee.jsx(fA,{"code-path":"src/App.tsx:398:21",className:"w-5 h-5 text-[#39FF14]"})}),ee.jsxs("div",{"code-path":"src/App.tsx:400:19",children:[ee.jsx("div",{"code-path":"src/App.tsx:401:21",className:"text-sm font-medium",children:"Gate 42"}),ee.jsx("div",{"code-path":"src/App.tsx:402:21",className:"text-xs text-[#39FF14]",children:"Boarding"})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:406:17",className:"data-pill glass rounded-xl p-4 flex items-center gap-3",children:[ee.jsx("div",{"code-path":"src/App.tsx:407:19",className:"w-10 h-10 bg-[#22D3EE]/20 rounded-lg flex items-center justify-center",children:ee.jsx(DT,{"code-path":"src/App.tsx:408:21",className:"w-5 h-5 text-[#22D3EE]"})}),ee.jsxs("div",{"code-path":"src/App.tsx:410:19",children:[ee.jsx("div",{"code-path":"src/App.tsx:411:21",className:"text-sm font-medium",children:"Security"}),ee.jsx("div",{"code-path":"src/App.tsx:412:21",className:"text-xs text-[#22D3EE]",children:"12 min wait"})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:416:17",className:"data-pill glass rounded-xl p-4 flex items-center gap-3",children:[ee.jsx("div",{"code-path":"src/App.tsx:417:19",className:"w-10 h-10 bg-[#8B5CF6]/20 rounded-lg flex items-center justify-center",children:ee.jsx(yW,{"code-path":"src/App.tsx:418:21",className:"w-5 h-5 text-[#8B5CF6]"})}),ee.jsxs("div",{"code-path":"src/App.tsx:420:19",children:[ee.jsx("div",{"code-path":"src/App.tsx:421:21",className:"text-sm font-medium",children:"Retail"}),ee.jsx("div",{"code-path":"src/App.tsx:422:21",className:"text-xs text-[#8B5CF6]",children:"Open now"})]})]})]})})]})}),ee.jsx("div",{"code-path":"src/App.tsx:431:9",className:"ticker-bar absolute bottom-0 left-0 right-0 glass border-t border-white/10",children:ee.jsx("div",{"code-path":"src/App.tsx:432:11",className:"overflow-hidden",children:ee.jsxs("div",{"code-path":"src/App.tsx:433:13",className:"ticker flex items-center gap-8 py-3 whitespace-nowrap",children:[ee.jsxs("span",{"code-path":"src/App.tsx:434:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:435:17",className:"text-[#39FF14]",children:""})," Live updates every 5 seconds"]}),ee.jsxs("span",{"code-path":"src/App.tsx:437:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:438:17",className:"text-[#22D3EE]",children:""})," 3,412 passengers on floor"]}),ee.jsxs("span",{"code-path":"src/App.tsx:440:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:441:17",className:"text-[#8B5CF6]",children:""})," 78 departures in next 2h"]}),ee.jsxs("span",{"code-path":"src/App.tsx:443:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:444:17",className:"text-[#39FF14]",children:""})," On-time performance: 91%"]}),ee.jsxs("span",{"code-path":"src/App.tsx:446:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:447:17",className:"text-[#22D3EE]",children:""})," Avg security wait: 8 min"]}),ee.jsxs("span",{"code-path":"src/App.tsx:449:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:450:17",className:"text-[#8B5CF6]",children:""})," Retail occupancy: 87%"]}),ee.jsxs("span",{"code-path":"src/App.tsx:453:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:454:17",className:"text-[#39FF14]",children:""})," Live updates every 5 seconds"]}),ee.jsxs("span",{"code-path":"src/App.tsx:456:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:457:17",className:"text-[#22D3EE]",children:""})," 3,412 passengers on floor"]}),ee.jsxs("span",{"code-path":"src/App.tsx:459:15",className:"text-sm text-[#9AA3B2]",children:[ee.jsx("span",{"code-path":"src/App.tsx:460:17",className:"text-[#8B5CF6]",children:""})," 78 departures in next 2h"]})]})})})]}),ee.jsx("section",{"code-path":"src/App.tsx:468:7",id:"map",className:"py-20 px-4 sm:px-6 lg:px-8",children:ee.jsxs("div",{"code-path":"src/App.tsx:469:9",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:470:11",className:"mb-12",children:[ee.jsx("h2",{"code-path":"src/App.tsx:471:13",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Interactive Terminal Map"}),ee.jsx("p",{"code-path":"src/App.tsx:474:13",className:"text-[#9AA3B2] max-w-2xl",children:"Navigate the airport with real-time gate status, amenities, and services. Click on any gate to see current flight information."})]}),ee.jsxs("div",{"code-path":"src/App.tsx:480:11",className:"grid lg:grid-cols-4 gap-6",children:[ee.jsx("div",{"code-path":"src/App.tsx:482:13",className:"lg:col-span-3",children:ee.jsx(XW,{"code-path":"src/App.tsx:483:15",airport:r,flights:h})}),ee.jsx("div",{"code-path":"src/App.tsx:490:13",className:"space-y-4",children:ee.jsx(Lfe,{"code-path":"src/App.tsx:491:15",airport:r})})]})]})}),ee.jsx("section",{"code-path":"src/App.tsx:498:7",id:"flights",className:"py-20 px-4 sm:px-6 lg:px-8 bg-[#111827]/50",children:ee.jsxs("div",{"code-path":"src/App.tsx:499:9",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:500:11",className:"mb-12",children:[ee.jsx("h2",{"code-path":"src/App.tsx:501:13",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Real-Time Flight Board"}),ee.jsx("p",{"code-path":"src/App.tsx:504:13",className:"text-[#9AA3B2] max-w-2xl",children:"Live departures and arrivals with gate assignments, delays, and status updates."})]}),ee.jsx(ZW,{"code-path":"src/App.tsx:509:11",airport:r,flights:h})]})}),ee.jsx("section",{"code-path":"src/App.tsx:517:7",className:"py-20 px-4 sm:px-6 lg:px-8",children:ee.jsxs("div",{"code-path":"src/App.tsx:518:9",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:519:11",className:"mb-12",children:[ee.jsx("h2",{"code-path":"src/App.tsx:520:13",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Gate Status Overview"}),ee.jsx("p",{"code-path":"src/App.tsx:523:13",className:"text-[#9AA3B2] max-w-2xl",children:"Color-coded gate status showing boarding, occupied, available, and closed gates."})]}),ee.jsx(WW,{"code-path":"src/App.tsx:528:11",airport:r,flights:h})]})}),ee.jsx("section",{"code-path":"src/App.tsx:536:7",id:"retail",className:"py-20 px-4 sm:px-6 lg:px-8 bg-[#111827]/50",children:ee.jsxs("div",{"code-path":"src/App.tsx:537:9",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:538:11",className:"mb-12",children:[ee.jsx("h2",{"code-path":"src/App.tsx:539:13",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Retail & Dining Discovery"}),ee.jsx("p",{"code-path":"src/App.tsx:542:13",className:"text-[#9AA3B2] max-w-2xl",children:"Explore shops, restaurants, and services near your gate. See opening hours and walking distances."})]}),ee.jsxs("div",{"code-path":"src/App.tsx:548:11",className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[ee.jsxs("div",{"code-path":"src/App.tsx:550:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:551:15",className:"w-12 h-12 bg-[#F59E0B]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(TW,{"code-path":"src/App.tsx:552:17",className:"w-6 h-6 text-[#F59E0B]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:554:15",className:"text-lg font-semibold mb-2",children:"Food & Dining"}),ee.jsx("p",{"code-path":"src/App.tsx:555:15",className:"text-sm text-[#9AA3B2] mb-4",children:"Restaurants, cafes, and food courts across all terminals"}),ee.jsxs("div",{"code-path":"src/App.tsx:558:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:559:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:560:19",className:"text-[#9AA3B2]",children:"Open now"}),ee.jsx("span",{"code-path":"src/App.tsx:561:19",className:"text-[#39FF14]",children:"42 venues"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:563:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:564:19",className:"text-[#9AA3B2]",children:"Near your gate"}),ee.jsx("span",{"code-path":"src/App.tsx:565:19",className:"text-[#22D3EE]",children:"5 venues"})]})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:571:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:572:15",className:"w-12 h-12 bg-[#8B5CF6]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(CI,{"code-path":"src/App.tsx:573:17",className:"w-6 h-6 text-[#8B5CF6]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:575:15",className:"text-lg font-semibold mb-2",children:"Shopping"}),ee.jsx("p",{"code-path":"src/App.tsx:576:15",className:"text-sm text-[#9AA3B2] mb-4",children:"Duty-free, fashion, electronics, and convenience stores"}),ee.jsxs("div",{"code-path":"src/App.tsx:579:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:580:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:581:19",className:"text-[#9AA3B2]",children:"Open now"}),ee.jsx("span",{"code-path":"src/App.tsx:582:19",className:"text-[#39FF14]",children:"38 stores"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:584:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:585:19",className:"text-[#9AA3B2]",children:"Duty-free"}),ee.jsx("span",{"code-path":"src/App.tsx:586:19",className:"text-[#22D3EE]",children:"12 stores"})]})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:592:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:593:15",className:"w-12 h-12 bg-[#22D3EE]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(OA,{"code-path":"src/App.tsx:594:17",className:"w-6 h-6 text-[#22D3EE]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:596:15",className:"text-lg font-semibold mb-2",children:"Lounges"}),ee.jsx("p",{"code-path":"src/App.tsx:597:15",className:"text-sm text-[#9AA3B2] mb-4",children:"Airline lounges and premium relaxation areas"}),ee.jsxs("div",{"code-path":"src/App.tsx:600:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:601:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:602:19",className:"text-[#9AA3B2]",children:"Available"}),ee.jsx("span",{"code-path":"src/App.tsx:603:19",className:"text-[#39FF14]",children:"8 lounges"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:605:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:606:19",className:"text-[#9AA3B2]",children:"Day pass"}),ee.jsx("span",{"code-path":"src/App.tsx:607:19",className:"text-[#22D3EE]",children:"3 lounges"})]})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:613:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:614:15",className:"w-12 h-12 bg-[#39FF14]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(PI,{"code-path":"src/App.tsx:615:17",className:"w-6 h-6 text-[#39FF14]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:617:15",className:"text-lg font-semibold mb-2",children:"Services"}),ee.jsx("p",{"code-path":"src/App.tsx:618:15",className:"text-sm text-[#9AA3B2] mb-4",children:"WiFi, charging, currency exchange, and more"}),ee.jsxs("div",{"code-path":"src/App.tsx:621:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:622:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:623:19",className:"text-[#9AA3B2]",children:"Free WiFi zones"}),ee.jsx("span",{"code-path":"src/App.tsx:624:19",className:"text-[#39FF14]",children:"Full coverage"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:626:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:627:19",className:"text-[#9AA3B2]",children:"Charging stations"}),ee.jsx("span",{"code-path":"src/App.tsx:628:19",className:"text-[#22D3EE]",children:"45 locations"})]})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:634:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:635:15",className:"w-12 h-12 bg-[#F43F5E]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(JZ,{"code-path":"src/App.tsx:636:17",className:"w-6 h-6 text-[#F43F5E]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:638:15",className:"text-lg font-semibold mb-2",children:"Baggage"}),ee.jsx("p",{"code-path":"src/App.tsx:639:15",className:"text-sm text-[#9AA3B2] mb-4",children:"Claim areas, storage, and baggage services"}),ee.jsxs("div",{"code-path":"src/App.tsx:642:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:643:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:644:19",className:"text-[#9AA3B2]",children:"Carousels"}),ee.jsx("span",{"code-path":"src/App.tsx:645:19",className:"text-[#39FF14]",children:"12 active"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:647:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:648:19",className:"text-[#9AA3B2]",children:"Storage"}),ee.jsx("span",{"code-path":"src/App.tsx:649:19",className:"text-[#22D3EE]",children:"24 hours"})]})]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:655:13",className:"card p-6 card-hover",children:[ee.jsx("div",{"code-path":"src/App.tsx:656:15",className:"w-12 h-12 bg-[#F59E0B]/20 rounded-xl flex items-center justify-center mb-4",children:ee.jsx(mW,{"code-path":"src/App.tsx:657:17",className:"w-6 h-6 text-[#F59E0B]"})}),ee.jsx("h3",{"code-path":"src/App.tsx:659:15",className:"text-lg font-semibold mb-2",children:"Security"}),ee.jsx("p",{"code-path":"src/App.tsx:660:15",className:"text-sm text-[#9AA3B2] mb-4",children:"Checkpoints, TSA PreCheck, and customs"}),ee.jsxs("div",{"code-path":"src/App.tsx:663:15",className:"space-y-2",children:[ee.jsxs("div",{"code-path":"src/App.tsx:664:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:665:19",className:"text-[#9AA3B2]",children:"Checkpoints"}),ee.jsx("span",{"code-path":"src/App.tsx:666:19",className:"text-[#39FF14]",children:"6 open"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:668:17",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:669:19",className:"text-[#9AA3B2]",children:"Avg wait time"}),ee.jsx("span",{"code-path":"src/App.tsx:670:19",className:"text-[#22D3EE]",children:"8 minutes"})]})]})]})]})]})}),ee.jsx("section",{"code-path":"src/App.tsx:679:7",className:"py-20 px-4 sm:px-6 lg:px-8",children:ee.jsx("div",{"code-path":"src/App.tsx:680:9",className:"max-w-7xl mx-auto",children:ee.jsxs("div",{"code-path":"src/App.tsx:681:11",className:"grid lg:grid-cols-2 gap-12 items-center",children:[ee.jsxs("div",{"code-path":"src/App.tsx:682:13",children:[ee.jsx("h2",{"code-path":"src/App.tsx:683:15",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Relax, recharge, reset."}),ee.jsx("p",{"code-path":"src/App.tsx:686:15",className:"text-[#9AA3B2] mb-8",children:"From quiet zones to showers, spas to prayer roomsfind what you need, fast."}),ee.jsx("div",{"code-path":"src/App.tsx:690:15",className:"grid sm:grid-cols-2 gap-4",children:[{icon:OA,label:"Lounges",count:"8 locations"},{icon:CD,label:"Showers",count:"6 locations"},{icon:FZ,label:"Sleep pods",count:"4 locations"},{icon:II,label:"Prayer rooms",count:"3 locations"},{icon:OI,label:"Kids areas",count:"5 locations"},{icon:oW,label:"Business centers",count:"3 locations"}].map((H,K)=>ee.jsxs("div",{"code-path":"src/App.tsx:699:19",className:"flex items-center gap-3 p-3 glass rounded-lg",children:[ee.jsx(H.icon,{"code-path":"src/App.tsx:700:21",className:"w-5 h-5 text-[#39FF14]"}),ee.jsxs("div",{"code-path":"src/App.tsx:701:21",children:[ee.jsx("div",{"code-path":"src/App.tsx:702:23",className:"text-sm font-medium",children:H.label}),ee.jsx("div",{"code-path":"src/App.tsx:703:23",className:"text-xs text-[#9AA3B2]",children:H.count})]})]},K))}),ee.jsxs("button",{"code-path":"src/App.tsx:709:15",className:"btn-primary mt-8 flex items-center gap-2",children:["View Amenities Map",ee.jsx(LZ,{"code-path":"src/App.tsx:711:17",className:"w-4 h-4"})]})]}),ee.jsx("div",{"code-path":"src/App.tsx:715:13",className:"relative",children:ee.jsxs("div",{"code-path":"src/App.tsx:716:15",className:"aspect-video rounded-2xl overflow-hidden glass",children:[ee.jsx("img",{"code-path":"src/App.tsx:717:17",src:"https://images.unsplash.com/photo-1436491865332-7a61a109cc05?w=800&h=450&fit=crop",alt:"Airport Lounge",className:"w-full h-full object-cover"}),ee.jsx("div",{"code-path":"src/App.tsx:722:17",className:"absolute inset-0 bg-gradient-to-t from-[#0B0F17] via-transparent to-transparent"})]})})]})})}),o==="operations"&&ee.jsx("section",{"code-path":"src/App.tsx:731:9",id:"analytics",className:"py-20 px-4 sm:px-6 lg:px-8 bg-[#111827]/50",children:ee.jsxs("div",{"code-path":"src/App.tsx:732:11",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:733:13",className:"mb-12",children:[ee.jsxs("div",{"code-path":"src/App.tsx:734:15",className:"flex items-center gap-3 mb-4",children:[ee.jsx("div",{"code-path":"src/App.tsx:735:17",className:"w-10 h-10 bg-[#39FF14]/20 rounded-lg flex items-center justify-center",children:ee.jsx(CA,{"code-path":"src/App.tsx:736:19",className:"w-5 h-5 text-[#39FF14]"})}),ee.jsx("span",{"code-path":"src/App.tsx:738:17",className:"text-sm text-[#39FF14] font-medium uppercase tracking-wider",children:"Operations"})]}),ee.jsx("h2",{"code-path":"src/App.tsx:742:15",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Operations Command Center"}),ee.jsx("p",{"code-path":"src/App.tsx:745:15",className:"text-[#9AA3B2] max-w-2xl",children:"Live situational awareness for terminal teams. Monitor passenger flow, security wait times, and retail performance in real-time."})]}),ee.jsx(zfe,{"code-path":"src/App.tsx:751:13",airport:r})]})}),ee.jsx("section",{"code-path":"src/App.tsx:757:7",className:"py-20 px-4 sm:px-6 lg:px-8",children:ee.jsxs("div",{"code-path":"src/App.tsx:758:9",className:"max-w-7xl mx-auto",children:[ee.jsxs("div",{"code-path":"src/App.tsx:759:11",className:"text-center mb-12",children:[ee.jsx("h2",{"code-path":"src/App.tsx:760:13",className:"text-3xl sm:text-4xl font-bold mb-4",children:"One platform. Many airports."}),ee.jsx("p",{"code-path":"src/App.tsx:763:13",className:"text-[#9AA3B2] max-w-2xl mx-auto",children:"Compare performance, share playbooks, and manage standards across your network."})]}),ee.jsx("div",{"code-path":"src/App.tsx:768:11",className:"grid md:grid-cols-3 gap-6",children:v0.slice(0,3).map((H,K)=>ee.jsxs("div",{"code-path":"src/App.tsx:770:15",className:"card p-6 card-hover cursor-pointer",onClick:()=>t(H),children:[ee.jsxs("div",{"code-path":"src/App.tsx:775:17",className:"flex items-center justify-between mb-4",children:[ee.jsx("div",{"code-path":"src/App.tsx:776:19",className:"text-2xl font-bold",children:H.code}),ee.jsx("div",{"code-path":"src/App.tsx:777:19",className:`w-3 h-3 rounded-full ${K===0?"bg-[#39FF14]":K===1?"bg-[#22D3EE]":"bg-[#8B5CF6]"}`})]}),ee.jsx("h3",{"code-path":"src/App.tsx:782:17",className:"font-medium mb-1",children:H.name}),ee.jsxs("p",{"code-path":"src/App.tsx:783:17",className:"text-sm text-[#9AA3B2] mb-4",children:[H.city,", ",H.country]}),ee.jsxs("div",{"code-path":"src/App.tsx:785:17",className:"space-y-2 pt-4 border-t border-white/10",children:[ee.jsxs("div",{"code-path":"src/App.tsx:786:19",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:787:21",className:"text-[#9AA3B2]",children:"On-time"}),ee.jsxs("span",{"code-path":"src/App.tsx:788:21",className:"text-[#39FF14]",children:[91-K*3,"%"]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:790:19",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:791:21",className:"text-[#9AA3B2]",children:"Security wait"}),ee.jsxs("span",{"code-path":"src/App.tsx:792:21",className:"text-[#22D3EE]",children:[8+K*2," min"]})]}),ee.jsxs("div",{"code-path":"src/App.tsx:794:19",className:"flex justify-between text-sm",children:[ee.jsx("span",{"code-path":"src/App.tsx:795:21",className:"text-[#9AA3B2]",children:"Passenger load"}),ee.jsxs("span",{"code-path":"src/App.tsx:796:21",className:"text-[#8B5CF6]",children:[85-K*5,"%"]})]})]})]},H.code))})]})}),ee.jsx("section",{"code-path":"src/App.tsx:806:7",className:"py-20 px-4 sm:px-6 lg:px-8 bg-[#111827]/50",children:ee.jsx("div",{"code-path":"src/App.tsx:807:9",className:"max-w-7xl mx-auto",children:ee.jsxs("div",{"code-path":"src/App.tsx:808:11",className:"grid lg:grid-cols-2 gap-12 items-center",children:[ee.jsxs("div",{"code-path":"src/App.tsx:809:13",children:[ee.jsx("h2",{"code-path":"src/App.tsx:810:15",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Built to integrate."}),ee.jsx("p",{"code-path":"src/App.tsx:813:15",className:"text-[#9AA3B2] mb-8",children:"Maps, FIDS, sensors, and BIconnected via APIs and webhooks. Build custom solutions on top of our platform."}),ee.jsx("div",{"code-path":"src/App.tsx:818:15",className:"space-y-4",children:["Subscribe to gate changes","Query wait times","Push retail events","Access historical data","Real-time WebSocket feeds"].map((H,K)=>ee.jsxs("div",{"code-path":"src/App.tsx:826:19",className:"flex items-center gap-3",children:[ee.jsx("div",{"code-path":"src/App.tsx:827:21",className:"w-6 h-6 bg-[#39FF14]/20 rounded-full flex items-center justify-center",children:ee.jsx(rV,{"code-path":"src/App.tsx:828:23",className:"w-4 h-4 text-[#39FF14]"})}),ee.jsx("span",{"code-path":"src/App.tsx:830:21",className:"text-sm",children:H})]},K))})]}),ee.jsxs("div",{"code-path":"src/App.tsx:836:13",className:"glass rounded-xl p-6 font-mono text-sm",children:[ee.jsxs("div",{"code-path":"src/App.tsx:837:15",className:"flex items-center gap-2 mb-4 pb-4 border-b border-white/10",children:[ee.jsx("div",{"code-path":"src/App.tsx:838:17",className:"w-3 h-3 rounded-full bg-[#F43F5E]"}),ee.jsx("div",{"code-path":"src/App.tsx:839:17",className:"w-3 h-3 rounded-full bg-[#F59E0B]"}),ee.jsx("div",{"code-path":"src/App.tsx:840:17",className:"w-3 h-3 rounded-full bg-[#39FF14]"}),ee.jsx("span",{"code-path":"src/App.tsx:841:17",className:"ml-2 text-[#9AA3B2]",children:"example.js"})]}),ee.jsx("pre",{"code-path":"src/App.tsx:843:15",className:"text-[#9AA3B2] overflow-x-auto",children:`// Subscribe to gate changes
const socket = new WebSocket(
  'wss://api.aeronav.io/v1/gates/stream'
);

socket.onmessage = (event) => {
  const update = JSON.parse(event.data);
  console.log('Gate update:', update);
};

// Query flight status
const response = await fetch(
  'https://api.aeronav.io/v1/flights?airport=ATL'
);
const flights = await response.json();`})]})]})})}),ee.jsx("section",{"code-path":"src/App.tsx:866:7",id:"contact",className:"py-20 px-4 sm:px-6 lg:px-8",children:ee.jsxs("div",{"code-path":"src/App.tsx:867:9",className:"max-w-xl mx-auto text-center",children:[ee.jsx("h2",{"code-path":"src/App.tsx:868:11",className:"text-3xl sm:text-4xl font-bold mb-4",children:"Ready to transform your terminal?"}),ee.jsx("p",{"code-path":"src/App.tsx:871:11",className:"text-[#9AA3B2] mb-8",children:"Get a demo tailored to your airport."}),ee.jsx("form",{"code-path":"src/App.tsx:875:11",className:"glass rounded-2xl p-8 text-left",children:ee.jsxs("div",{"code-path":"src/App.tsx:876:13",className:"space-y-4",children:[ee.jsxs("div",{"code-path":"src/App.tsx:877:15",children:[ee.jsx("label",{"code-path":"src/App.tsx:878:17",className:"block text-sm text-[#9AA3B2] mb-2",children:"Name"}),ee.jsx("input",{"code-path":"src/App.tsx:879:17",type:"text",placeholder:"Your name",className:"w-full"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:881:15",children:[ee.jsx("label",{"code-path":"src/App.tsx:882:17",className:"block text-sm text-[#9AA3B2] mb-2",children:"Work Email"}),ee.jsx("input",{"code-path":"src/App.tsx:883:17",type:"email",placeholder:"you@company.com",className:"w-full"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:885:15",children:[ee.jsx("label",{"code-path":"src/App.tsx:886:17",className:"block text-sm text-[#9AA3B2] mb-2",children:"Airport/Organization"}),ee.jsx("input",{"code-path":"src/App.tsx:887:17",type:"text",placeholder:"Your organization",className:"w-full"})]}),ee.jsx("button",{"code-path":"src/App.tsx:889:15",type:"submit",className:"btn-primary w-full mt-4",children:"Request Demo"})]})})]})}),ee.jsx("footer",{"code-path":"src/App.tsx:898:7",className:"py-8 px-4 sm:px-6 lg:px-8 border-t border-white/10",children:ee.jsxs("div",{"code-path":"src/App.tsx:899:9",className:"max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4",children:[ee.jsxs("div",{"code-path":"src/App.tsx:900:11",className:"flex items-center gap-2",children:[ee.jsx("div",{"code-path":"src/App.tsx:901:13",className:"w-6 h-6 bg-[#39FF14] rounded-md flex items-center justify-center",children:ee.jsx(fA,{"code-path":"src/App.tsx:902:15",className:"w-4 h-4 text-[#0B0F17]"})}),ee.jsx("span",{"code-path":"src/App.tsx:904:13",className:"font-semibold",children:"AeroNav Intelligence"})]}),ee.jsxs("div",{"code-path":"src/App.tsx:907:11",className:"flex items-center gap-6 text-sm text-[#9AA3B2]",children:[ee.jsx("a",{"code-path":"src/App.tsx:908:13",href:"#",className:"hover:text-[#F3F4F6] transition-colors",children:"Privacy"}),ee.jsx("a",{"code-path":"src/App.tsx:909:13",href:"#",className:"hover:text-[#F3F4F6] transition-colors",children:"Terms"}),ee.jsx("a",{"code-path":"src/App.tsx:910:13",href:"#",className:"hover:text-[#F3F4F6] transition-colors",children:"API Docs"})]}),ee.jsx("div",{"code-path":"src/App.tsx:913:11",className:"text-sm text-[#9AA3B2]",children:" 2024 AeroNav Intelligence. All rights reserved."})]})})]})}jH.createRoot(document.getElementById("root")).render(ee.jsx(Jt.StrictMode,{"code-path":"src/main.tsx:7:3",children:ee.jsx(Bfe,{"code-path":"src/main.tsx:8:5"})}));
